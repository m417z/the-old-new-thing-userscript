<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (33)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-182213">
				<div id="div-comment-182213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/larryosterman' rel='external nofollow' class='url'>Larry Osterman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182213">
			June 10, 2004 at 7:19 am</a>		</div>

		<p>Ok, snarky history question time: Why is there only one mouse (or rather, why is there only one mouse cursor &#8211; you can have multiple mice with a single cursor, my laptop has 3 mice on it)?</p>
<p>I&#8217;m actually dead serious &#8211; why does windows support only one mouse and only one keyboard (although I&#8217;m not sure how what more than one keyboard would look like programatically).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182243">
				<div id="div-comment-182243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.digiwar.com' rel='external nofollow' class='url'>Jeroen-bart Engelen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182243">
			June 10, 2004 at 7:30 am</a>		</div>

		<p>Now if only Windows Explorer would implement this nice feature :-) Just yesterday I deleted 10,000 small files from a single directory and Explorer hung for a couple of minutes. When I had to do the same thing again, I just left the directy openend a command shell and used &quot;del.&quot;. This took 5 seconds.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182233">
				<div id="div-comment-182233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">One-armed Monkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182233">
			June 10, 2004 at 7:32 am</a>		</div>

		<p>You insensitive clod!  I only have one arm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182273">
				<div id="div-comment-182273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.joshchristie.com/weblog' rel='external nofollow' class='url'>Josh Christie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182273">
			June 10, 2004 at 7:39 am</a>		</div>

		<p>It may also be worth mentioning that you can similarly improve the performance of many Windows Forms controls by calling BeginUpdate() before you start adding lots of items and then calling EndUpdate() when you&#8217;re finished.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182283">
				<div id="div-comment-182283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182283">
			June 10, 2004 at 7:46 am</a>		</div>

		<p>I wish explorer would call LockWindowUpdate. You don&#8217;t know how many times I&#8217;ve had a selection rectangle blitted to the desktop or in a file listing window just taunting me to dirty their update rectangles.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182293">
				<div id="div-comment-182293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jpaynejm@NOSPAM.dsl.pipex.com' rel='external nofollow' class='url'>Jonathan Payne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182293">
			June 10, 2004 at 7:57 am</a>		</div>

		<p>Would it be possible to add the second half of this post to the documentation for LockWindowUpdate (although it mentioned that only one window can be locked, it didn&#8217;t have all the other useful notes).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182303">
				<div id="div-comment-182303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182303">
			June 10, 2004 at 8:08 am</a>		</div>

		<p>Jeroen-bart: Now you&#8217;re changing the subject. Explorer does use this trick to insert the original 10,000 files into the listview.</p>
<p>Deleting a file from Explorer is boatloads more than just calling DeleteFile. (Just look at that horrific feature set of SHFileOperation.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182333">
				<div id="div-comment-182333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182333">
			June 10, 2004 at 8:23 am</a>		</div>

		<p>Explorer does use it when deleting &#8211; notice that after you deleted the items from the command line, the Explorer window refreshed quickly.</p>
<p>The one-by-one you see is not the refresh cost. It&#8217;s the SHFileOperation cost.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182323">
				<div id="div-comment-182323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.digiwar.com' rel='external nofollow' class='url'>Jeroen-bart Engelen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182323">
			June 10, 2004 at 8:24 am</a>		</div>

		<p>Raymond: Okay, I updated the subject (at least of my comment) ;-). So Explorer uses it when adding, but does it also work when removing items? And does Explorer use it then as well? I see this in all kinds of applications where there are a lot of items in a listview/box. When you remove them all, it takes ages and you can actually see the position-bar (can&#8217;t recall it&#8217;s correct name) on the scrollbar grow larger. But when you minimze the window, the items are removed almost instantly. So it looks to me like it&#8217;s removing-redrawing-removing-redrawing-etc just like when adding.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182353">
				<div id="div-comment-182353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jeffdav' rel='external nofollow' class='url'>jeffdav</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182353">
			June 10, 2004 at 9:25 am</a>		</div>

		<p>Larry- I also want multiple pointers if I have multiple mice.  But it would probably confuse and break a lot of Windows.  Think of everything that calls GetCursorPos() today&#8211; which value would you return if you start supporting multiple cursors?  App compat would be difficult.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182363">
				<div id="div-comment-182363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dotnetjunkies.com/weblog/sriram' rel='external nofollow' class='url'>Sriram Krishnan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182363">
			June 10, 2004 at 9:50 am</a>		</div>

		<p>Now, how does this work in .NET WinForms land? Do we P/Invoke?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182373">
				<div id="div-comment-182373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Catatonic</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182373">
			June 10, 2004 at 10:35 am</a>		</div>

		<p>Check out &quot;Raw Input&quot; in the Platform SDK. You actually can receive separate input from multiple mice if you want to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182403">
				<div id="div-comment-182403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert McClinton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182403">
			June 10, 2004 at 11:01 am</a>		</div>

		<p>It was mentioned BeginUpdate should be used on .net controls.  Also one should not forget the AddRange method.  In my experience, the perf boost of AddRange is very noticable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182413">
				<div id="div-comment-182413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Don Kackman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182413">
			June 10, 2004 at 11:27 am</a>		</div>

		<p>Since SetWindowRedraw is a macro wrapping WM_SETREDRAW, for .NET WinForms you can do this  like so:<br />
<br />&#8211; DllImport SendMessage<br />
<br />&#8211; define as WM_SETREDRAW = 0x000B;<br />
<br />&#8211; then in some derived control:<br />
<br />public void BeginUpdate()<br />
<br />{<br />
<br />    SendMessage( this.Handle, WM_SETREDRAW, false, IntPtr.Zero );<br />
<br />}</p>
<p>public void EndUpdate()<br />
<br />{<br />
<br />    SendMessage( this.Handle, WM_SETREDRAW, true, IntPtr.Zero );<br />
<br />    Refresh();<br />
<br />}</p>
<p>cheers,</p>
<p>don</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182433">
				<div id="div-comment-182433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182433">
			June 10, 2004 at 11:52 am</a>		</div>

		<p>On the deleting 10000 Files in Explorer Issue:<br />
<br />I think there&#8217;s more to it than just the SHFileOperation cost. I think there (also) an complexity issue. If you select only the first say 5000, delete them, then select the rest and delete them, I&#8217;m quite sure it is quite a bit fastern then selecting and deleting the whole folder at once. It <em>might</em> be psychological but it certainly didn&#8217;t feel like that the last time I tried it. Perhaps I should stop watch it&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182453">
				<div id="div-comment-182453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182453">
			June 10, 2004 at 1:43 pm</a>		</div>

		<p>Just for the record: I timed it and believe it to be a memory/swapping problem. Perhaps making a list of the filenames or so. At least it becomes more apparent with long filenames.<br />
<br />eg deleting 10.000 files with the filname ca 150 characters long would take 95 seconds, 20.000 435 seconds.<br />
<br />Also I&#8217;ve noticed that there is often a very long time between the deletion has finished (ie the &quot;delting&#8230;&quot; popup closes itself) and explorer becoming responsive again:<br />
<br />20 seconds with 10.000 shortnamed files, 120 seconds with 20.000. I wasn&#8217;t patient enough to wait after trying it with 40.000 and killed explorer.exe after ca 480seconds. exlorer.exe is using all cpu it can get during this period.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182473">
				<div id="div-comment-182473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182473">
			June 10, 2004 at 2:18 pm</a>		</div>

		<p>I didn&#8217;t think it had to do with redrawing. I was being offtopic, I know.  Sorry.<br />
<br />I just pointed out that (at least for a lot of files) it takes around 4 times as long deleting twice as many files when I would expect the deletion itself to be O(n). If it removes each file individually from it&#8217;s view in response to the event, that&#8217;s not too surprising really.<br />
<br />Thanks,<br />
<br />Ben</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182503">
				<div id="div-comment-182503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182503">
			June 10, 2004 at 5:16 pm</a>		</div>

		<blockquote><p>
  The Explorer window that is viewing the folder receives the notification and then goes looking for the deleted item to remove it from the view.</p>
<p>So why not set it up such that, when Explorer deletes a large number of files, it disables updates on its view, does the delete, then reenables and refreshes the view? Also, how does this explain the much faster performance when doing a del . from a prompt?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182513">
				<div id="div-comment-182513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/tristank/' rel='external nofollow' class='url'>TristanK</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182513">
			June 10, 2004 at 5:48 pm</a>		</div>

		<p>For those .Net folk that read the blog, the Control class offers the SuspendLayout() and ResumeLayout() functions that perfom this for you.</p>
<p>In .Net land, they&#8217;re useful for just about any control where you&#8217;re individually adding a large number of items &#8211; ListView s, DataGrid s and all&#8230;</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemwindowsformscontrolclasssuspendlayouttopic.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/cpref/html/frlrfsystemwindowsformscontrolclasssuspendlayouttopic.asp</a><br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182463">
				<div id="div-comment-182463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182463">
			June 10, 2004 at 1:52 pm</a>		</div>

		<p>SHFileOperation generates a SHCNE_DELETE as it deletes each file &#8211; this goes into the change notification system and eventually pops out the other side. The Explorer window that is viewing the folder receives the notification and then goes looking for the deleted item to remove it from the view. Repeat 10,000 times. This has nothing to do with redrawing. It&#8217;s all the bookkeeping that happens *BEFORE* the redraw.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-182933">
				<div id="div-comment-182933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-182933">
			June 11, 2004 at 7:14 pm</a>		</div>

		<p>Speaking of performance of listview, what about the performance of treeview and deletes.  I have an application that has a HUGE number of elements in a treeview (40k+).  When I need to repopulate the treeview for a different data set, it takes forever to clear the treeview.  If I just delete the treeview, it takes forever.  If I close the application, it is very fast.</p>
<p>To work around the problem I ended up having to hide that treeview, create a new one and then during idle processing delete batches of elements of the old treeview.</p>
<p>Is there a fast was to delete items from a treeview?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-183033">
				<div id="div-comment-183033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183033">
			June 12, 2004 at 9:08 am</a>		</div>

		<p>uintptr_t killTree(void *tree)<br />
<br />{<br />
<br /> DestroyWindow((HWND)tree);<br />
<br /> return 0;<br />
<br />}</p>
<p>_beginthread(killTree, 0, treeWin);</p>
<p>On a sidenote, it looks like whoever writes the winapi documentation on MSDN moved on to the C runtime&#8217;s because I don&#8217;t remember it being this crappy before.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-183053">
				<div id="div-comment-183053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183053">
			June 12, 2004 at 9:28 am</a>		</div>

		<p>asdf: That doesn&#8217;t help any. Remember: Windows have thread-affinity. Destroying 40,000 items entails 40,000 TVN_DELETEITEM notifications. Just by sheer numbers that&#8217;s going to take a while.</p>
<p>40,000 items in a treeview is unusably excessive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-183063">
				<div id="div-comment-183063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">C-J Berg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183063">
			June 12, 2004 at 10:29 am</a>		</div>

		<p>Tim: You might want to check out the following CodeProject article:</p>
<p>&quot;A faster tree control&quot;<br />
<br /><a target="_new" href="http://www.codeproject.com/treectrl/rgtree.asp" rel="nofollow">http://www.codeproject.com/treectrl/rgtree.asp</a><br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-183133">
				<div id="div-comment-183133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183133">
			June 12, 2004 at 3:58 pm</a>		</div>

		<p>It is true that 40k items is pushing usability, but it isn&#8217;t like I can go to BioWare and say &quot;Hey, can you ship a game with just 5k resources?&quot;.</p>
<p>From my research, it is the TVN_DELETEITEM notifications that is slowing it down. I would love the option of telling the treeview to not worry about sending those messages.</p>
<p>Thank god the program is using dynamic tree population.  That help to minimize the problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-183223">
				<div id="div-comment-183223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183223">
			June 12, 2004 at 9:40 pm</a>		</div>

		<p>See if this works Tim:</p>
<p>LONG_PTR style = GetWindowLong(treeWin, GWL_STYLE);<br />
<br />style &amp;= ~(WS_CHILD|WS_VISIBLE);<br />
<br />style |= WS_POPUP;<br />
<br />SetWindowLong(treeWin, GWL_STYLE, style);<br />
<br />SetParent(treeWin, NULL);</p>
<p>Now delete it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-183233">
				<div id="div-comment-183233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183233">
			June 12, 2004 at 10:08 pm</a>		</div>

		<p>Unclear what you&#8217;re trying to accomplish there, asdf.  (You really shouldn&#8217;t fiddle the WS_VISIBLE style directly; use ShowWindow instead.) That still doesn&#8217;t stop the 40,000 notifications. Unlike listview (LVN_DELETEALLITEMS), treeview doesn&#8217;t have a &quot;mass delete&quot; notification.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-183263">
				<div id="div-comment-183263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183263">
			June 12, 2004 at 10:43 pm</a>		</div>

		<p>My idea was to kill the window in another thread but and since the tree control doesn&#8217;t have a parent, it doesn&#8217;t send a notification to the original thread. It can take as long as it wants to kill now, the main thread is now responsive and that&#8217;s all that matters. But now I realize what you meant by thread-affinity because it only matters which thread the window was originally created in.</p>
<p>As long as we&#8217;re here, what are some of the bad things that can happen if you toggle the visibility bit directly instead of using one of the many functions that take a SW_SHOW/SW_HIDE flag?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-183273">
				<div id="div-comment-183273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183273">
			June 12, 2004 at 11:01 pm</a>		</div>

		<p>There&#8217;s a lot of stuff that happens when you hide and show a window &#8211; if you toggle the style directly then that stuff doesn&#8217;t happen, but you tricked the window manager into thinking that it did. This messes up the internal bookkeeping.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-183523">
				<div id="div-comment-183523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.laytoncity.org' rel='external nofollow' class='url'>Michael Russell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-183523">
			June 14, 2004 at 1:11 pm</a>		</div>

		<p>TristanK, in .NET, you use SuspendLayout/ResumeLayout if you are adding/removing controls from a form or container control.</p>
<p>For ListBoxes/ComboBoxes, you use BeginUpdate/EndUpdate.</p>
<p>However, there is a warning here.  If your ListBox has the Sorted property set to True, and you use Begin/EndUpdate and only add a single item, no items will display.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-184383">
				<div id="div-comment-184383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-184383">
			June 16, 2004 at 9:02 pm</a>		</div>

		<p>I, too want multiple pointers.  GetCursorPos() could just return values appropriate for the last pointer moved.  Sounds reasonable-ish.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-184563">
				<div id="div-comment-184563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gerg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-184563">
			June 17, 2004 at 7:31 am</a>		</div>

		<p>&lt;&lt;SHFileOperation generates a SHCNE_DELETE as it deletes each file &#8211; this goes into the change notification system and eventually pops out the other side. The Explorer window that is viewing the folder receives the notification and then goes looking for the deleted item to remove it from the view. Repeat 10,000 times. &gt;&gt;</p>
<p>Ugh, if Explorer uses a linear search that makes this an n^2 operation which would explain the observed issues. Pretty silly since Explorer damn well knows what file it was trying to delete, it ought to check if that&#8217;s the notification it just got.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-184573">
				<div id="div-comment-184573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040610-00/?p=38933#comment-184573">
			June 17, 2004 at 7:37 am</a>		</div>

		<p>Explorer knows which files it was planning on deleting, but it doesn&#8217;t know which ones actually succeeded in being deleted. And if you do a &quot;select all+delete&quot; then you&#8217;re back to where you started. &quot;Okay, that file that got deleted is one of these O(n) files.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>