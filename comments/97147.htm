<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (9)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-archangelpip even thread-even depth-1 parent" id="comment-1311566">
				<div id="div-comment-1311566" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311566">
			October 6, 2017 at 11:31 am</a>		</div>

		<p>This is possibly one of those &#8220;time machine&#8221; situations where perhaps it would be nice if there was something like EnumWindowsClasses.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-yuhong-bao odd alt depth-2" id="comment-1311615">
				<div id="div-comment-1311615" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311615">
			October 7, 2017 at 12:26 pm</a>		</div>

		<p>Which also reminds me of window hooks. WIN31WH.HLP mentions that &#8220;Windows 3.1 no longer allows applications and DLLs to enumerate all the functions in a hook chain. In particular, Windows 3.1 no longer supports the HC_GETLPLPFN, HC_LPLPFNNEXT, and HC_LPFNNEXT values for the DefHookProc function. &#8220;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1311596">
				<div id="div-comment-1311596" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311596">
			October 7, 2017 at 4:00 am</a>		</div>

		<p>Along similar lines, I&#8217;ve always wondered why, having pointed out that RegisterWindowClass and RegisterClipboardFormat have the same ordinal in Windows 3.x, the book Undocumented Windows never made the leap to using GetClipboardFormatName to find out the name of a registered window message.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1311605">
				<div id="div-comment-1311605" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311605">
			October 7, 2017 at 4:03 am</a>		</div>

		<p>Sorry I meant RegisterWindowMessage of course&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1311625">
				<div id="div-comment-1311625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew Rogers (ex-MSFT)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311625">
			October 7, 2017 at 11:57 pm</a>		</div>

		<p>Darran just asked for &#8220;time travel&#8221; debugging above &#8211; your wish is Microsoft&#8217;s command! There has just been a public release of the &#8220;time travel&#8221; debugging technology that&#8217;s been available internally for some years (you can find a few references to &#8220;iDNA&#8221; peppered on the web):</p>
<p><a href="https://blogs.msdn.microsoft.com/windbg/2017/09/25/time-travel-debugging-in-windbg-preview/" rel="nofollow">https://blogs.msdn.microsoft.com/windbg/2017/09/25/time-travel-debugging-in-windbg-preview/</a></p>
<p>It&#8217;s great to see this being shared with the community: there are some caveats though &#8211;</p>
<p>* The trace files generated by it are huge, so using it over a long test may become impractical<br />
* It only records user-mode code</p>
<p>That said, it&#8217;s a lot of fun to work with, and I&#8217;m glad that everyone will be able to get the benefit of working with it now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mndos odd alt thread-odd thread-alt depth-1" id="comment-1311806">
				<div id="div-comment-1311806" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MacIn173' rel='external nofollow' class='url'>MacIn173</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311806">
			October 9, 2017 at 12:44 pm</a>		</div>

		<p>There&#8217;s some AtomMonitor tool available for it. We&#8217;ve used it once when our system failed because it got run out of atoms.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1311936">
				<div id="div-comment-1311936" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1311936">
			October 10, 2017 at 10:33 pm</a>		</div>

		<p>I&#8217;m happy that the customer followed up with you. This is a refreshing change from many of your customer stories where they never bother to do that!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1312545">
				<div id="div-comment-1312545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1312545">
			October 14, 2017 at 11:47 am</a>		</div>

		<p>For better or worse, I have seen this pattern many times, as well as a related one in a .NET HWNDWRAPPER class.  This is especially problematic in services, where you can easily deplete the desktop heap long before you run out of ATOMs.  This could have been avoided if the code registering the class used a per-instance wndproc instead of a per-instance wndclass.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1312555">
				<div id="div-comment-1312555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171006-00/?p=97147#comment-1312555">
			October 14, 2017 at 11:49 am</a>		</div>

		<p>Quick correction: I meant NotificationWindow, not HWNDWRAPPER, which was called out in this blog.  But both contain the same cause, which in my opinion, is a simple bug but not worth the risk of fixing with so many applications potentially dependent on a less than ideal behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>