<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (52)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-555453">
				<div id="div-comment-555453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">benjamin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555453">
			October 2, 2007 at 10:31 am</a>		</div>

		<p>While I&#8217;m thankful for all of your posts, I think things like these are my favorite. It amazes me the kind of braindead things application developers think they can get away with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555473">
				<div id="div-comment-555473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555473">
			October 2, 2007 at 10:51 am</a>		</div>

		<p>Although&#8230;there is something elegant about a program that requires nothing more than a copy to &quot;install&quot;. Mark Russinvich&#8217;s utilities are a great example of that. I agree it doesn&#8217;t work well for something like Microsoft Office.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555493">
				<div id="div-comment-555493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Some Guy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555493">
			October 2, 2007 at 10:59 am</a>		</div>

		<p>Yeah, I kinna have to agree. I&#8217;m beginning to be of the mindset that Any Good Program runs by just copying it. I.e. no evil registration of DLL&#8217;s or other horrendeous windows system stuff&#8230; just .exe, everything linked in, and it just freakin&#8217; runs&#8230; aaah&#8230;.. ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555503">
				<div id="div-comment-555503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.1060.org/blogxter/publish/5' rel='external nofollow' class='url'>Steve Loughran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555503">
			October 2, 2007 at 11:01 am</a>		</div>

		<p>the other thing I&#8217;d like to flag as wrong are those apps -you know who you are- who do some installation for every user (like deciding whether to add exchange support or not), installation actions that only work if the install CD is there.</p>
<p>so, months later, when you create a new user account, you run the app and suddenly it grinds away then complains the disk is missing, even if other users are correctly set up already. Or worse, I&#8217;m on a laptop and the content is not even reachable for days.</p>
<p>Maybe its the idea of late-binding installation that is at fault here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555523">
				<div id="div-comment-555523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555523">
			October 2, 2007 at 11:31 am</a>		</div>

		<p>If this blog teaches anything is that thinking things through is important. If every program were to be copy-installed the size of the binaries would likely be MUCH larger. On the order of O(N*M) with N binaries with M dependencies each. I am sure that cost would have seemed especially ridiculous in the earlier days of Windows.</p>
<p>Dijkstra&#8217;s observation strikes again:</p>
<p>The clever way to do something earlier is VERY OFTEN a huge burden later on. In fact an early (must-have) optimization often shuts many obvious avenues to future improvements. We really are terrible at planning for the future&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555543">
				<div id="div-comment-555543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://david.acz.org/' rel='external nofollow' class='url'>David Phillips</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555543">
			October 2, 2007 at 11:43 am</a>		</div>

		<p>Microsoft Office copy-installs on Mac, as do many applications. &nbsp;The typical way to install a Mac application is to simply drag it to the Applications folder.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555553">
				<div id="div-comment-555553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://3dnature.com' rel='external nofollow' class='url'>Chris 'Xenon' Hanson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555553">
			October 2, 2007 at 12:15 pm</a>		</div>

		<p>Wow, the rest of the world is coming to appreciate the mindset we&#8217;ve been espousing since like, 1994. &quot;Flat&quot; apps. Just an application EXE. There is an optional couple of DLLs for a third-party functionality that we can&#8217;t by-license static-link into our EXE, but the program late-binds those so it runs fine without them.</p>
<p>And the program keeps its settings in a file. Not in the registry. You can manage the file yourself without insanity or administrator permissions. You can back it up or replace it. Some times I think Windows 3 had it right, with INI files. At least those you could get a grip on.</p>
<p>The only time we ever touch the registry is to associate our file extension association with the current location of our EXE. We repeat this re-associating each time the app runs, in case the user moved the EXE (yes, we allow THAT too!) and we tolerate this operation failing if the user doesn&#8217;t have the rights to do so.</p>
<p>Basically, try to be NICE to the poor bugger who has to use your software and OS. If you can make their life easier, DO.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555563">
				<div id="div-comment-555563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://PerpetualHypeMachine.com' rel='external nofollow' class='url'>TravisO</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555563">
			October 2, 2007 at 12:26 pm</a>		</div>

		<p>Ever since I&#8217;ve started going non-admin on my work PC in June, I&#8217;ve been noticing some programs do this. &nbsp;I run the install as admin, but if I manually click the app&#8217;s icon, of course I&#8217;m a non-admin.</p>
<p>Although in the defense of programs that do this, many of them have a checkbox checked for &quot;Run x now&quot; which would run as admin because it&#8217;s being launched from an admin process.</p>
<p>But an autoplay EXE is the perfect example where the devs assumed incorrectly as there&#8217;s no user intervention to run it as admin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555603">
				<div id="div-comment-555603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555603">
			October 2, 2007 at 1:17 pm</a>		</div>

		<p>As far as copy-install goes, I have to say that as far as system utilties go (not user applications), I like those that don&#8217;t have to be installed.</p>
<p>The &quot;System Information for Windows&quot; (siw.exe) tool by Gabriel Topala&#8217; is incredibly useful, very small (1386 K), and doesn&#8217;t need to be installed. &nbsp;</p>
<p>It doesn&#8217;t even need to be copied &#8212; I can run it right off the USB flash drive that I have on my keychain (where I also carry around Windows XP SP2). &nbsp;Of course, if you want to be able to run it frequently on your own system, you would need to copy the EXE somewhere. &nbsp;(There are no supporting DLLs, either, at least none that don&#8217;t already appear on my system.)</p>
<p>Now THAT&#8217;S convenient.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555623">
				<div id="div-comment-555623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555623">
			October 2, 2007 at 1:23 pm</a>		</div>

		<p>Acrobat Reader 6 through 8 ask you to agree to the license when you first use the program. &nbsp;I hope you don&#8217;t have to be an admin for that.</p>
<p>I wonder why you can&#8217;t agree to the license when you install. &nbsp;(Also, I don&#8217;t know if it asks each new user to agree to the license or not.)</p>
<p>Word and Excel, at least back in Office 2000 days, ask for your initials. &nbsp;This is probably the per-user setup that doesn&#8217;t require admin, but since I used to always run as admin, I don&#8217;t really know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555653">
				<div id="div-comment-555653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555653">
			October 2, 2007 at 2:04 pm</a>		</div>

		<p>James said: &quot;There&#8217;s one application I often fight with&#8230;&quot;</p>
<p>What you mention is the fault of Windows Installer, not the particular application. It needs the original MSI file in order to uninstall the application.</p>
<p>I don&#8217;t know whose bright idea was that over there at Microsoft, but I would like Raymond to smack them in the teeth for me.</p>
<p>Yes, I know the installer needs that MSI to be able to &quot;undo&quot; the install but couldn&#8217;t that be in a separate log file somewhere instead of whole f*cking MSI or MSP file?!?</p>
<p>If you don&#8217;t understand what I am talking about check your C:WINDOWSInstaller folder.</p>
<p>If you have by any chance installed SP1 for Visual Studio 2005, then you will have 455 MB (yes, MEGABYTES!) of wasted space in there just to be able to uninstall it later.</p>
<p>Mind you, those aren&#8217;t backup copies of the replaced/updated files, just the darn stupid installer cache.</p>
<p>455 MB install log&#8230; way to go geniuses!!! Was your brain in the fridge while you were designing Windows Installer?</p>
<p>Same goes for Office 2003 SP3 &#8212; 115 MB wasted. And another 50 MB for three .Net framework patches.</p>
<p>All summed up with Microsoft&#8217;s applications being biggest (literally) offenders, Windows Installer has wasted 1.5 GB of my hard drive space just so I can uninstall some applications.</p>
<p>Delete those files and you lose ability to uninstall them and what is even worse, you lose the ability to install newer versions unless you clean up the registry manually. Truly amazing software design, NOT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555663">
				<div id="div-comment-555663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555663">
			October 2, 2007 at 2:27 pm</a>		</div>

		<p>Igor, I&#8217;ve used installshield as a dev and it is just as picky. &nbsp;It uses logs which get very prone to breaking. &nbsp;Of course, the behavior has changed so much between versions of IS that things are going to be confusing. &nbsp;Of course, one of the output types of IS is MSI, so I could be remembering the wrong thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555683">
				<div id="div-comment-555683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mikkin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555683">
			October 2, 2007 at 2:40 pm</a>		</div>

		<p>Sometimes I miss the bad old days when you just stick the floppy in the drive. Take it out and put it away when you are done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555703">
				<div id="div-comment-555703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555703">
			October 2, 2007 at 2:49 pm</a>		</div>

		<p>As a developer who has had to manage interns fresh from (and in some cases still in) college, I&#8217;m more of the mind set that things like this (requring administrator first run) is simply because the developers don&#8217;t know any better. &nbsp;When I look back on my career and try and think of all the things I didn&#8217;t know two, five, or even ten years ago, I&#8217;m amazed that people let me still work in this field.</p>
<p>One of the difficulties I have with working on the Microsoft platform (as opposed to UN*X-like platforms) is that MS must constantly innovate to sell product, and that innovation comes at a cost: constant training. &nbsp;There is so much MS technology out there that it is impossible to keep up, let alone figure out which stuff is deprecated or determine what the Best Practices are for developing an application. &nbsp;Heck, it wasn&#8217;t even until last year that I found out there are MS APIs to perform FTP! (<a href="http://msdn2.microsoft.com/en-us/library/aa383766.aspx" target=_new rel=nofollow rel="nofollow">http://msdn2.microsoft.com/en-us/library/aa383766.aspx</a>)</p>
<p>Not to point fingers, but I think the MSDN help is part of the problem. &nbsp;First, I have to say that I don&#8217;t like the new help layout since they started the re-write &#8212; it seems to make it ten times harder to find what I&#8217;m looking for; I especially don&#8217;t like the fact that the new help browsers have removed the Sync TOC button. &nbsp;Second, there isn&#8217;t anything in the documentation that says the functions are deprecated or, at the very least, &#8220;not recommended&#8221;. &nbsp;Things like DDE should be so marked. &nbsp;Also, if there are Windows Logo requirements or other sets of best practices, these should be grouped together so they are easier to find instead of spread out over different areas of the API. &nbsp;I don&#8217;t care if there are multiple references from different areas to the same document (think symbolic links) as long as the complete collection can be navigated, browsed and read. &nbsp;</p>
<p>Finally, there are some groups, like the Windows Installer group, who spend as little time as possible working on documentation with the reason being they&#8217;d rather spend time working on features. &nbsp;To me, this is a cop-out: how useful can your features be if nobody can figure out how to effectively use them? &nbsp;The Windows Installer has been particularly challenging for me as it seems the help authors assume you already know how msiexec.exe works and that you just need a refresher. </p>
<p>I realize it&#8217;s probably too big of a task to hope for, especially considering the number of Microsoft technology books on the shelves of your local book seller, but I would love to see improvements to the MSDN that highlight deprecated functions with pointers to the replacements, provide some more background on the APIs, and annoint some methods as &#8220;best practices&#8221; for developing software on the Windows platform. </p>
<div class=post>[<i>I take issue with the claim that DDE is &#8220;not recommended&#8221;. DDE works just fine and if you want to use it, then go ahead. Of course, if you don&#8217;t want to use it, feel free as well. &#8220;Not recommended&#8221; carries the connotation &#8220;Microsoft recommends that you rewrite any programs that are using this feature.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555723">
				<div id="div-comment-555723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555723">
			October 2, 2007 at 3:06 pm</a>		</div>

		<p>Igor: needing the MSI is one thing &#8211; shipping that MSI in a wrapper which uses then deletes it, making MSI look in the wrong place for a file I haven&#8217;t got, is another.</p>
<p>Remember MSI has a &#8216;repair&#8217; facility &#8211; presumably it needs to retain the full MSI file rather than just the metadata in order to support that. It is irritating, though!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555743">
				<div id="div-comment-555743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://thinstall.com' rel='external nofollow' class='url'>G&#233; van Geldorp</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555743">
			October 2, 2007 at 3:21 pm</a>		</div>

		<p>There is a solution available which allows for xcopy deployment of just about any application, see <a rel="nofollow" target="_new" href="http://thinstall.com" rel="nofollow">http://thinstall.com</a>. It will take all the individual executables, dlls and support files making up an application and stuff it into one big executable. You can then just copy that &quot;Thinstalled&quot; executable to your target machine and run the application there, without any further installation.</p>
<p>Full disclosure: I work for Thinstall.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555753">
				<div id="div-comment-555753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neville</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555753">
			October 2, 2007 at 3:56 pm</a>		</div>

		<p>Excellent point. &nbsp;I look forward to the day when Vista and future versions of Windows finally persuade developers to minimize dependencies on administrative privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555763">
				<div id="div-comment-555763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555763">
			October 2, 2007 at 4:00 pm</a>		</div>

		<p>[I take issue with the claim that DDE is &quot;not recommended&quot;. DDE works just fine and if you want to use it, then go ahead. Of course, if you don&#8217;t want to use it, feel free as well. &quot;Not recommended&quot; carries the connotation &quot;Microsoft recommends that you rewrite any programs that are using this feature.&quot; -Raymond]</p>
<p>Perhaps my words are too strong. &nbsp;I am a fan of the &quot;Raymond Chen Camp&quot;, as Spolsky likes to say, so the fact that technologies available since Windows 3.0 &#8212; like DDE &#8212; still work today is impressive. &nbsp;However, there are likely suitable replacements for the older technologies that are more interoperable with other systems or that have improved security, enough so that the older technology should probably be avoided. &nbsp;</p>
<p>P.S. Sorry to pick on DDE &#8212; it was the first thing to spring to mind. &nbsp;Thinking about it after hitting the &#8216;Submit&#8217; button, it&#8217;s probably a technology you created. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555773">
				<div id="div-comment-555773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555773">
			October 2, 2007 at 4:24 pm</a>		</div>

		<p>&quot;And the program keeps its settings in a file. Not in the registry. You can manage the file yourself without insanity or administrator permissions. You can back it up or replace it.&quot;</p>
<p>I&#8217;m agreed that generally files are better. However, the permissions problem isn&#8217;t a registry problem. For a well-written program, if you need admin permissions to modify the settings in the registry you would need admin permissions to modify the same settings in a file.</p>
<p>Programs don&#8217;t have to use HKLM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555803">
				<div id="div-comment-555803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555803">
			October 2, 2007 at 5:15 pm</a>		</div>

		<p>Igor: Thanks for pointing that out, I did indeed have nearly 1.5GB of msi&#8217;s in that folder.</p>
<p>This practice of doing administrative work on first run seems remarkably silly to me &#8211; I&#8217;m willing to wait for a slow installer (it can&#8217;t possibly take longer than Visual Studio) but if your program takes a minute to start up the first time I run it, it&#8217;s getting a black mark. I don&#8217;t care if it&#8217;s faster next time, first impressions count.</p>
<p>But then I guess whoever&#8217;s writing these programs isn&#8217;t bothered about what users might think of their software, or they&#8217;d have made more effort in the first place, right? :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555813">
				<div id="div-comment-555813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sir_Derlin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555813">
			October 2, 2007 at 5:17 pm</a>		</div>

		<p>I remember that Visio 4.0 could run of the CD, without any local installation. &nbsp;This was before Microsoft bought the company that produced it. &nbsp;Isn&#8217;t no-installation-required one of the U3 USB stick innitiative&#8217;s goals?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555463">
				<div id="div-comment-555463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555463">
			October 2, 2007 at 10:48 am</a>		</div>

		<p>Uh, clearly they *can* get away with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555823">
				<div id="div-comment-555823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dgt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555823">
			October 2, 2007 at 6:05 pm</a>		</div>

		<p>one still needs to keep in mind that there are servicing problems with &quot;local copy&quot; applications. if you ship with local copy of, well, shell32, then if there is a bug found and fixed in real shell32 nobody&#8217;s going to update your local copy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555843">
				<div id="div-comment-555843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.martialdevelopment.com/blog/' rel='external nofollow' class='url'>Chris @ Martial Development</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555843">
			October 2, 2007 at 6:21 pm</a>		</div>

		<p>What makes you think this sort of thing is intended as an optimization? &nbsp;</p>
<p>This happens when the application development environment is well-documented and familiar, and the installer toolset is neither. &nbsp;Devs implement installation tasks in the app because that is the path of least resistance.</p>
<p>I am not defending the practice&#8211;but a certain company who failed to deliver an easy-to-use MSI authoring tool should bear some responsibility here.</p>
<div class=post>[<i>Whenever you find that programming is hard, it&#8217;s always safe to blame Microsoft for not making it easier. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-zian even thread-even depth-1" id="comment-555863">
				<div id="div-comment-555863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Zian+Choy' rel='external nofollow' class='url'>Zian Choy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555863">
			October 2, 2007 at 7:21 pm</a>		</div>

		<p>@Chris</p>
<p>Bingo!</p>
<p>Many years ago, when I wrote an app that had to register a file extension, I shoveled the code for it into the program instead of the installer because I couldn&#8217;t figure out how to make it happen during the install process.</p>
<p>Looking back, I realize that it would run quite well in LUA because the registration does not automatically happen; the user has to ask for it later. 1 less program for Microsoft appcompat to worry about. :)</p>
<p>(Yes, I realize that if the user did try to register the extension, he would have to elevate the app for a moment.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555573">
				<div id="div-comment-555573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555573">
			October 2, 2007 at 12:27 pm</a>		</div>

		<p>Steve: I&#8217;d say that&#8217;s just about fair enough *if* that dependency has changed (for example, if you&#8217;ve installed an Exchange server since the app was originally installed, so installing Exchange support makes sense now where it didn&#8217;t before) &#8211; but in most cases, that&#8217;s a big pain for me as well.</p>
<p>There&#8217;s one application I often fight with which ships as an EXE file containing an MSI package; after anything changes, it wants that MSI file &#8211; in the original location, a randomly-named subdirectory of %TEMP% which has long since been deleted. Weird, not to mention infuriating!</p>
<p>There&#8217;s another application here which appears to do exactly what Raymond is complaining about, too: first, it &quot;installs&quot; (fair enough; I run the installer as Administrator when first setting the machine up) &#8211; then the first user to run any component triggers some other MSI action. For now, I&#8217;ve worked around that by taking an InstallRite snapshot of that first-run activity and running that as part of the system setup, but it&#8217;s a bit of a nasty hack!</p>
<p>(There also seems to be a nasty interaction with mandatory profiles: something for that app needs to be done every single time a user tries to run it having just logged on, presumably a user-specific registry thing which gets overwritten every login, thanks to the mandatory profile. Irritating.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555873">
				<div id="div-comment-555873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jamie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555873">
			October 2, 2007 at 7:29 pm</a>		</div>

		<p>&quot;path of least resistance&quot; is an optimization for shipping a product.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555633">
				<div id="div-comment-555633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555633">
			October 2, 2007 at 1:25 pm</a>		</div>

		<p>I don&#8217;t mind apps that you have to install, but only if they allow you to install into your profile directory if you are not an administrator and thus don&#8217;t have access to Program Files.</p>
<p>There are lots of apps which fall into this category, though it&#8217;s often accidental. To satisfy this requirement you must:</p>
<p> * Allow the user to choose an installation path in the setup process.</p>
<p> * Only install files under the user-selected installation path.</p>
<p> * Only save ancillary information such as settings in the HKEY_CURRENT_USER registry key or in the user&#8217;s Application Data directory.</p>
<p>I would like it if in the future per-user non-administrator installation was the *default*, and system-wide installations were a crazy option that administrators could twiddle in the installation process.</p>
<p>Of course, users would always have the option of running the installer themselves to install their own local copy to use in place of the supplied one, so apps would have to be designed to keep the settings for these separate instances distinct. No reason really why per-user installations can&#8217;t just keep their settings in the application&#8217;s own directory. </p>
<p>This doesn&#8217;t seem like too hard a problem to solve technically: just have alongside each installation a path to the directory where its configuration settings live. The global one will use %%USERPROFILEDIR%% (or similar), while the local ones would just have a path relative to the directory the executable is in. It&#8217;d be up to the installer to set the correct value depending on whether it&#8217;s doing a user-local or global install.</p>
<p>In fact, now that I&#8217;ve written that all out I don&#8217;t really know why more apps aren&#8217;t designed this way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555883">
				<div id="div-comment-555883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555883">
			October 2, 2007 at 9:09 pm</a>		</div>

		<p>[Whenever you find that programming is hard, it&#8217;s always safe to blame Microsoft for not making it easier. -Raymond]</p>
<p>Programming in general isn&#8217;t that hard. It requires getting used to; but isn&#8217;t hard. Now, programming to Microsoft APIs is a whole &#8216;nother can of worms.</p>
<div class=post>[<i>&#8220;Hm, I&#8217;m writing the setup program, I guess I should put the code that needs to run at setup time in setup.cpp.&#8221; No APIs here—just programming. And yet it&#8217;s somehow Microsoft&#8217;s fault that some people find this distinction hard to make. I&#8217;m not talking about MSI, just &#8220;writing a setup program.&#8221; (People made this mistake long before MSI&nbsp;was available.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555713">
				<div id="div-comment-555713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Morten</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555713">
			October 2, 2007 at 2:55 pm</a>		</div>

		<p>James said: &quot;If every program were to be copy-installed the size of the binaries would likely be MUCH larger&quot;</p>
<p>Erm&#8230; I don&#8217;t get it. Why care? I mean, my system partition is already filled with gunk as Igor says so space is wasted anyhow. Why not waste it productively? Besides, at the price gigabytes are going at now I really wouldn&#8217;t mind apps taking up a ton of space if it meant their behavior was predictable &#8211; the extra cost would be insignificant compared to the price tag of most serious software. Put it on separate USB keys even, JUST MAKE IT WORK! Autoplay *has* to be good for something&#8230; (remember, you saw it here first ;-) )</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555733">
				<div id="div-comment-555733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555733">
			October 2, 2007 at 3:10 pm</a>		</div>

		<p>Programs which require admin rights were already incompatible with Windows XP, in my opinion, but I guess the authors never tested it with a non-admin account. (Or, in this case, ran it at least once with an admin account after installation.)</p>
<p>I think a lot of developers (and users for that matter) have only used machines like their own, where they are always the administrator, so they don&#8217;t appreciate how much stuff was *already* broken for corporate (or security conscious) users running with limited accounts.</p>
<p>It bugs me when people (not here) complain about having to change their apps for Vista. They moan about both the effort and the fact they can no longer save settings files into Program Files, ignoring the fact that doing so has been a bad idea since NT4, both in terms of shared vs private configuration and in terms of non-admin accounts.</p>
<p>I for one am glad Vista has forced people to get this stuff right since it now affects so many machines (and probably their own machine unless they turned off UAC, which is another rant entirely) that it&#8217;s impossible to ignore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555933">
				<div id="div-comment-555933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian Porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555933">
			October 2, 2007 at 10:52 pm</a>		</div>

		<p>I agree that it is frustrating. However, since the problem does not lie with Microsoft, I do not think that Microsoft should try to &#8220;fix&#8221; this.</p>
<p>Sure, people will try to blame Microsoft. So publish a detailed document describing the reasons why it fails and let the original developers handle it. If they are not around anymore, then the application was never designed or verified for Vista and should not be supported in the first place.</p>
<div class="post">[<i>Choose one: &#8220;There goes Microsoft, blaming other people for its own problems.&#8221; or &#8220;Microsoft intentionally made Program XYZ from its competitor company ABC stop working on Vista. Blatant anti-competitive behavior.&#8221; or the argument used in these comments: &#8220;It&#8217;s Microsoft&#8217;s own fault for making such a complicated operating system.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555953">
				<div id="div-comment-555953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">carlos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555953">
			October 3, 2007 at 12:09 am</a>		</div>

		<p>I&#8217;ve just buy a thinkpad with vista, it has the vista logo and all that but when i turn it on i get a message saying that a program(system update of thinkpad) is trying to show a dialog in session 0&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555963">
				<div id="div-comment-555963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555963">
			October 3, 2007 at 1:00 am</a>		</div>

		<p>David Walker: Remember, some of us uses clone system that you don&#8217;t necessary have gone through the install process, and some company have I.T. people to install the software for you, so you users don&#8217;t necessary have clicked &quot;I Agree&quot; at the EULA page of installer. (It&#8217;s sensible to think we should get the User to click on an &quot;User Agreement&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555973">
				<div id="div-comment-555973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">foxyshadis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555973">
			October 3, 2007 at 4:10 am</a>		</div>

		<p>I guess a lot of people miss the fact that you can just extract a small program during/after install to do all of the heavy lifting for you. It even works with repair, although it took some research.</p>
<p>Dan, InstallShield makes MSI much less painful, I assume most software that doesn&#8217;t use VS&#8217;s built-in support will use a 3rd party. It&#8217;s more of a case of Microsoft supplying the technology and other companies supplying the interface and integration, just like volume shadow copy.</p>
<p>I know exactly what XYZ you mean, though, and it&#8217;s frustrated me repeatedly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555893">
				<div id="div-comment-555893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">reader</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555893">
			October 2, 2007 at 9:12 pm</a>		</div>

		<p>Given there&#8217;s something call regedit in Windows, which can export and import registry settings through text files, I&#8217;m not sure it&#8217;s really *that* much easier to manage settings kept in a text file vs. in the registry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555913">
				<div id="div-comment-555913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555913">
			October 2, 2007 at 10:04 pm</a>		</div>

		<p>Windows Installer has always struck me as being broken somehow. &nbsp;Maybe it&#8217;s just me, maybe it&#8217;s the individual application devs who are using it wrong. &nbsp;But the problems I have had with programs using Windows Installers? &nbsp;With NSIS I can only recall one installer problem, which was clearly caused by whoever made it (the installer checked for a prerequisite incorrectly. &nbsp;I had it, but the installer didn&#8217;t think I did) &nbsp;Just observation here.</p>
<p><font color="red">Product XYZ</font>. &nbsp;The devs are at least partly responsible for my misery there. &nbsp;A Windows Installer packaged INSIDE an NSIS installer? PICK ONE for heaven&#8217;s sake! &nbsp;Plus it suffers from the problem Igor describes&#8230; it places the MSI installer in a folder on the desktop. &nbsp;Why would I NOT delete such a folder once it was done? &nbsp;Whenever I went to upgrade it asked for the old MSI&#8230; fortunately I found Microsoft&#8217;s Windows Installer Clean Up. &nbsp;It makes Windows Installer forget a program is installer&#8230; very handy in these cases.</p>
<p>But it gets worse. &nbsp;<font color="red">Product XYZ</font> used to do some late configuration with Windows Installer on it&#8217;s first run, which required the MSI! &nbsp;So I&#8217;d have to download the entire thing AGAIN if I forgot and deleted it before running it the first time.</p>
<p>Now a more recent example. &nbsp;.NET 2.0 exploded or something. &nbsp;Probably <font color="red">Product ABC</font>&#8216;s fault (I&#8217;m not gonna use that ever again.) &nbsp;.NET 2.0 apps would crash when run. &nbsp;Visual Studio&#8230; the only .NET 2.0 app NOT to crash&#8230; would cheerfully tell me it&#8217;s main component had crashed and then disable every useful function.</p>
<p>.NET 2.0 repair/uninstall? &nbsp;Crashed as soon as I tried to repair or uninstall. &nbsp;Downloading the .NET 2.0 installer and trying to use THAT to uninstall/repair produced the same result.</p>
<p>Fortunately I found an MS KB article on how to manually rip out .NET 2.0. &nbsp;Reinstalled, updated, and everything magically works again.</p>
<p>It doesn&#8217;t help my feelings about MSI that with NSIS all you gotta do is download NSIS and you get everything you need to build installers out of scripts (granted, I&#8217;m a programmer so I picked up their scripting language easily). &nbsp;With Windows Installer&#8230; well I&#8217;m sure there are comparative ways to make Windows Installers (I was just reading a blog entry about WiX, which sounds about right) but I dunno&#8230; I suppose I just don&#8217;t *know* of any standard way (well, apart from Visual Studio, but considering that&#8217;s not a free*, separate tool I won&#8217;t count it in my comparison) so I&#8217;m not going to say anything more. &nbsp;I suppose final judgment has to wait until I work someplace that forces me to learn MSI.</p>
<p>PS: Every installer for every Windows hotfix and service pack doesn&#8217;t even go into Installers&#8230; check C:Windows$*</p>
<p>* &#8211; I know about express but you don&#8217;t want to get express if you just want to build an installer for something you already made.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555923">
				<div id="div-comment-555923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TraumaPony</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555923">
			October 2, 2007 at 10:11 pm</a>		</div>

		<p>reader said: &quot;Given there&#8217;s something call regedit in Windows, which can export and import registry settings through text files, I&#8217;m not sure it&#8217;s really *that* much easier to manage settings kept in a text file vs. in the registry.&quot;</p>
<p>You obviously haven&#8217;t used the Settings Designer in .net.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555943">
				<div id="div-comment-555943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bcthanks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555943">
			October 3, 2007 at 12:06 am</a>		</div>

		<p>&#8220;[Choose one: &#8220;There goes Microsoft, blaming other people for its own problems.&#8221; or &#8230;]&#8221;</p>
<p>You (Microsoft) just can&#8217;t win. Most of us don&#8217;t want you to. :=)</p>
<p>The people who take cheap shots at you will continue. You can&#8217;t change that. The rest of us ding you because there are layers of *hidden* APIs and compat fixes that we don&#8217;t see or understand.</p>
<p>If you at least publish a list of offending apps and root causes (you&#8217;ve already done the debugging work, right?) then at least we can ding you (or the vendor) for the right reasons, instead of thinking MS is full of incompetent VB weenies. :=)</p>
<p>You&#8217;re going to get bashed no matter what you do&#8230; so at least ruffle some vendors, name some names, so those of us with a clue get a chance to learn how *not* to do things.</p>
<div class="post">[<i>There is no upside to naming names. It just leads to a nonproductive bout of name-calling and blame-shifting (and a possible libel lawsuit). You can already see it here. &#8220;It&#8217;s Microsoft&#8217;s fault for not making Windows programming easier.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-555983">
				<div id="div-comment-555983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-555983">
			October 3, 2007 at 8:44 am</a>		</div>

		<p>It&#8217;s surprising how many people who don&#8217;t actually know how to program try to create installers. I use a certain freeware installer and frequent it&#8217;s newsgroups, and there&#8217;s at least one person a month asking how to install a program they have no idea how it works (and at least 1 person a week asking how to not install the program to Program Files on Vista because that breaks their program).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-556003">
				<div id="div-comment-556003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://rhymeswithgeek.com/blogs/someone_else' rel='external nofollow' class='url'>RobM</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556003">
			October 3, 2007 at 10:25 am</a>		</div>

		<p>&quot;I&#8217;ve just buy a thinkpad with vista, it has the vista logo and all that but when i turn it on i get a message saying that a program(system update of thinkpad) is trying to show a dialog in session 0&#8230;&quot;</p>
<p>Then return the product as faulty and get a refund. OEMs producing custom machine builds that don&#8217;t work or don&#8217;t work well is a big problem, and only because people put up with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-556013">
				<div id="div-comment-556013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://rhymeswithgeek.com/blogs/someone_else' rel='external nofollow' class='url'>RobM</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556013">
			October 3, 2007 at 10:29 am</a>		</div>

		<p>This sort of problem shows up quite well with machines that are centrally managed on a large network with software distributed by policies, or whatever.</p>
<p>In fact quite a lot of programs fall down quite badly in this sort of scenario.</p>
<p>Newsflash&#8230; Developers: Hoping that your product will be picked up and purchased by large &quot;thousands of seats&quot; corporations? Then try actually testing your product in the typical locked down deployment and usage scenarios typically in use in such businesses. Remember, it doesn&#8217;t matter how much I like your product, if I can&#8217;t automatically install it onto my thousands of PCs from one central console I&#8217;ve got no choice but to reject your product in favour of the one from your competitor that is a bit more considerate&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-556023">
				<div id="div-comment-556023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CGomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556023">
			October 3, 2007 at 10:47 am</a>		</div>

		<p>Installation programs have had these issues long before there was a registry or COM, or even OLE.</p>
<p>What about setup programs for DOS apps that might try and set up extended ram in your autoexec.bat? &nbsp;Bet you hated those because it would be incompatible with some other program.</p>
<p>Copy-and-it-runs installs are great. &nbsp;If you can make that work with your application, then that&#8217;s fantastic. &nbsp;Sometimes you can&#8217;t. &nbsp;Plenty of people write fantastic installers and uninstallers, too.</p>
<p>Unfortunately, the ones that don&#8217;t are usually the ones that don&#8217;t have to. &nbsp;Seems to me the most popular products tend to perform the worst at proper installation, uninstallaion, and running as non-admin. &nbsp;This is not because it is hard to code this way (it is actually simpler). &nbsp;It is more because they don&#8217;t have to care. &nbsp;You&#8217;ll use the app no matter what and MSFT will have to support it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-556113">
				<div id="div-comment-556113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556113">
			October 3, 2007 at 11:56 am</a>		</div>

		<p>Cheong: &quot;Remember, some of us uses clone system that you don&#8217;t necessary have gone through the install process, and some company have I.T. people to install the software for you, so you users don&#8217;t necessary have clicked &quot;I Agree&quot; at the EULA page of installer. (It&#8217;s sensible to think we should get the User to click on an &quot;User Agreement&quot;)&quot;</p>
<p>Why do you think that&#8217;s sensible? &nbsp;In such a case as you describe, it&#8217;s the company not the individual users who are agreeing to the terms of the EULA. &nbsp;It shouldn&#8217;t matter whether or not the end user sees them.</p>
<p>Also, I see no reason to believe an EULA shown <em>after</em> installation is legally enforceable. &nbsp;An EULA is a contract, and contracts require consideration (i.e., something of value that is given in exchange for agreement). &nbsp;The consideration would normally be the license to install the software on your computer (an act protected by copyright), but if the installation has already taken place I don&#8217;t really see what consideration can be given. &nbsp;You don&#8217;t need a license to use software, only to make copies of it&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-556143">
				<div id="div-comment-556143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Dougherty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556143">
			October 3, 2007 at 12:46 pm</a>		</div>

		<p>It&#8217;s easy to see how this happens. &nbsp;Here is how it happened to me. &nbsp;Our install requires admim privileges. After you install the app, you test it, right? &nbsp;And during that first test MFC is adding OLE/file associations, which requires admin mode. &nbsp;I had expected admins to always do a quick test before handing the machine over to the user, so the app was running when the admin logged out.</p>
<p>I did not notice this until Vista. &nbsp;Only the install EXE gets the elevation prompt, and the app is left running as a standard user. &nbsp;Now those admin operations were failing! &nbsp;Ouch.</p>
<p>Moral: because of Vista&#8217;s elevation prompt feature, the only admin mode opportunity you are likely to see is in the install.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-556273">
				<div id="div-comment-556273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.martialdevelopment.com/blog/' rel='external nofollow' class='url'>Chris @ Martial Development</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556273">
			October 3, 2007 at 4:28 pm</a>		</div>

		<p>[Whenever you find that programming is hard, it&#8217;s always safe to blame Microsoft for not making it easier. -Raymond]</p>
<p>When you find app compatibility is hard, it&#8217;s always safe to blame *those stupid developers* for not implementing your obscure MSI technology.</p>
<p>Pot, have you met kettle?</p>
<p>When smart people want cooperation, they make it easy to do the right thing and hard to do the wrong thing. &nbsp;So, I guess we both wish more programmers were smart.</p>
<div class=post>[<i>I wasn&#8217;t the one who brought up MSI. The problem I described is independent of whether you use MSI or not. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-556503">
				<div id="div-comment-556503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556503">
			October 4, 2007 at 12:21 pm</a>		</div>

		<p>MS said: &quot;Of course, one of the output types of IS is MSI&quot;</p>
<p>James said: &quot;Remember MSI has a &#8216;repair&#8217; facility &#8211; presumably it needs to retain the full MSI file rather than just the metadata in order to support that. It is irritating, though!&quot;</p>
<p>Yes, but there is an option of <em>not</em> putting <em>everything</em> into the MSI.</p>
<p>I am not against MSI in particular, just against its misuse.</p>
<p>It is irritating when an application has a single gigantic MSI/MSP file and you have to keep a complete copy in C:WINDOWSInstaller just to be able to uninstall or repair.</p>
<p>Remember, I HAVE NOT ASKED IT TO CACHE THOSE FILES. Furthermore, I wasn&#8217;t presented with an option during setup which says &quot;[x] DO NOT BLOAT MY WINDOWS FOLDER&quot;.</p>
<p>I believe that fundamental problem here is that people expect setup.exe to be a swiss army knife with a GPS, pocket calculator, and a flashlight when in reality the only thing setup.exe should do is provide INSTALL and UNINSTALL features.</p>
<p>One particular MSI feature I am extremely pissed off with is what Adober Reader setup is doing &#8212; optimizing performance by defragmenting during setup!!!</p>
<p>Who in their right mind decided that defragmentation should be exposed to setup programs?!?</p>
<ol>
<li>It doesn&#8217;t ask the user, it just does it.</li>
<li>
<p>It may take a long time depending on the current fragmentation level and the machine load.</p>
</li>
<li>
<p>It supposedly defragments only its own files (haven&#8217;t checked this).</p>
</li>
<li>
<p>It uses built-in defragmentation algorithm. What if I want to defragment on my own using 3rd party defragmenter?</p>
</li>
<li>
<p>It wastes my time, I either ran the setup to be able to use the program immediately or I ran it while installing bunch of other things and I plan to defragment when I finish installing everything.</p>
</li>
<li>
<p>It actually tries to cover for Adobe Reader bloatness and slowness by defragmenting.</p>
</li>
</ol>
<p>There is no way in hell you could look at it positively, and yet someone thought it was a &quot;nice feature&quot; and decided to enable it.</p>
<p>In my opinion, it shows long-term software industry trend &#8212; &quot;do as much as you can at the expense of the user&quot;.</p>
<p>Adobe got complaints from their customers, they wanted faster startup time. Instead of trying to improve application startup performance they decided to defragment our HDDs. Talk about brute force.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-556653">
				<div id="div-comment-556653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556653">
			October 4, 2007 at 2:41 pm</a>		</div>

		<p>bcthanks: &quot;You (Microsoft) just can&#8217;t win. Most of us don&#8217;t want you to. :=)&quot;</p>
<p>Most of us? &nbsp;Really?</p>
<p>You want MS to go away completely? &nbsp;The world would be worse off then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-556663">
				<div id="div-comment-556663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-556663">
			October 4, 2007 at 2:46 pm</a>		</div>

		<p>Paul Doughtery:</p>
<p>&quot;After you install the app, you test it, right? &nbsp;And during that first test MFC is adding OLE/file associations, which requires admin mode.&quot;</p>
<p>The RIGHT time to do file associations is during the install! &nbsp;You&#8217;re setting the associations at the wrong time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557063">
				<div id="div-comment-557063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-557063">
			October 5, 2007 at 3:03 pm</a>		</div>

		<p>&#8220;The RIGHT time to do file associations is during the install! &nbsp;You&#8217;re setting the associations at the wrong time.&#8221;</p>
<p>The right time to do per-user file associations is during the install phase? &nbsp;Really? &nbsp;How exactly do you expect the installer to manage that, when it only has access to the registry for the currently-logged-in user?</p>
<div class=post>[<i>No fair taking sentences out of context. This was in the context of systemwide changes, not per-user changes. Per-user changes don&#8217;t need administrative privileges, so the point is moot.-Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557303">
				<div id="div-comment-557303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dean Earley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-557303">
			October 8, 2007 at 10:28 am</a>		</div>

		<p>Chris &#8216;Xenon&#8217; Hanson:</p>
<p>I hope you only &quot;update&quot; the association when it is already pointing at an &quot;old&quot; path to your app.</p>
<p>If not, it will (incorrectly) clobber any changes the USER has made to THEIR file associations.</p>
<p>(whether this is an extension that you think is only used by your app is irrelevant)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557423">
				<div id="div-comment-557423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071002-00/?p=24933#comment-557423">
			October 8, 2007 at 5:14 pm</a>		</div>

		<p>Raymond, I didn&#8217;t take that statement out of context. &nbsp;There was no other context. &nbsp;That was David&#8217;s entire comment. &nbsp;It&#8217;s the one right before mine (since you told us recently that you see our comments in isolation on the moderation page, I assume this was the cause of your confusion.)</p>
<div class=post>[<i>It was in the context of a program that deferred its administrative work (setting system-wide file associations) until first-run. You&#8217;re the one who brought up per-user file associations as if that&#8217;s what we were talking about all along. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>