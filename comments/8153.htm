<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (74)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-970303">
				<div id="div-comment-970303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970303">
			March 7, 2012 at 7:08 am</a>		</div>

		<p>It would also be nice if MS would follow the &quot;program filescompanyproduct&quot; layout and not just clutter the program files root with new folder(s) for each installed product&#8230;</p>
<div class="post">[<i>Wait, so you&#39;re saying that Microsoft should <a href="http://msdn.microsoft.com/en-us/library/ms997548.aspx" rel="nofollow">ignore its own guidelines</a>? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970313">
				<div id="div-comment-970313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970313">
			March 7, 2012 at 7:22 am</a>		</div>

		<p>@WndSks: I don&#39;t mind the fact too much that each Microsoft program has its own directory within Program Files; what does annoy me is that each directory begins with &quot;Microsoft&quot; (&quot;Microsoft Office&quot;, &quot;Microsoft SDKs&quot;, &quot;Microsoft Visual Studio 10.0&quot;, etc.).</p>
<p>This makes it require excessive typing when trying to navigate to one of those directories by keyboard &#8212; instead of just typing &quot;v&quot; and a couple of letters or up/down strokes to get to Visual Studio, I have to type &quot;microsoft v&quot; to get there (or type &quot;n&quot; and go up many times).</p>
<p>So actually I take it back, putting all of that in a Microsoft directory would be great, if they also removed the Microsoft prefix from the product subdirectories.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970323">
				<div id="div-comment-970323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AdamWu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970323">
			March 7, 2012 at 7:33 am</a>		</div>

		<p>I remember for a couple of versions of Office, it uses hard coded short name &quot;progra~1&quot; in the registry, so that if the &quot;program files&quot; directory happens to have &quot;progra~2&quot; as its short name, a lot of things fail to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970333">
				<div id="div-comment-970333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">P Wright</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970333">
			March 7, 2012 at 7:35 am</a>		</div>

		<p>I wonder what readers of this blog think about Google Chrome&#39;s default (i.e., non-MSI) installer installing into %APPDATA%. Always felt &#39;wrong&#39; to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970343">
				<div id="div-comment-970343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob Hir</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970343">
			March 7, 2012 at 7:40 am</a>		</div>

		<p>I was under the impression that one of benefits of the logo requirements of &quot;Program Files&quot; was that apps would required to be compatible with a path with a space in the name. Of course some sneaks tried getting by with progra~1, but the intention was good.</p>
<p>per Google and %APPDATA%, it was my impression that they did this to allow for non-admin installs of thier apps, because c:program files was locked from non-admins writing to it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970353">
				<div id="div-comment-970353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970353">
			March 7, 2012 at 7:42 am</a>		</div>

		<p>I seriously hate the Program Files folder. I prefer my stuff on another partition so I usually change the folder manually when installing things. However, especially some microsoft programs installing shared files, still put them into Program Files cluttering my system drive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970363">
				<div id="div-comment-970363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970363">
			March 7, 2012 at 7:45 am</a>		</div>

		<p>If memory serves, wasn&#39;t another reason that you could only have 255 directory entries in the root folder in FAT, and since every 12 characters of a long file name was a directory entry in FAT this could make you run out of root folder file entries pretty quick?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970373">
				<div id="div-comment-970373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ralph</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970373">
			March 7, 2012 at 7:47 am</a>		</div>

		<p>@P Wright A cunning ploy to allow users without admin rights to install the browser? Installing to program files gets me a UAC pop-up, but I can stick an executable in appdata and a shortcut on my desktop no problem. Ofcourse if your box is properly locked down by corporate overlords they should block executing random stuff downloaded from the internet anyway.</p>
<p>I don&#39;t mind that behaviour, but the installer should really try and get permission to put it in program files before resorting to the users appdata.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-970383">
				<div id="div-comment-970383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970383">
			March 7, 2012 at 8:02 am</a>		</div>

		<p>There is another program I recently tried, but I uninstalled it. &nbsp;It insisted on installing its program files to %APPDATA%, just like Google Chrome. &nbsp;The developers of this program claimed that installing program files into %APPDATA% does follow guidelines, and also that this is the only way to allow non-admins to update a program. &nbsp;They also said &quot;if it&#39;s good enough for Google Chrome, it&#39;s good enough for us&quot;.</p>
<p>I am not sure I believe that. &nbsp;Isn&#39;t there a way for non-admins to update, even if the program is installed in Program Files?</p>
<p>Anyway, I hate programs installing to non-standard locations, which is why I uninstalled the program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-970393">
				<div id="div-comment-970393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970393">
			March 7, 2012 at 8:09 am</a>		</div>

		<p>By the way, there is one drawback to the default &quot;C:Program FilesCompanyNameApplicationName&quot;. &nbsp;Companies sell applications to each other all the time, and companies get bought out and renamed. &nbsp;For example, the Act contact management program has been owned by Contact Software International, and Sales Logix, and Symantec, and Interact, and Sage Software, and maybe one or two other companies owned it at one time or another in its tortured corporate life. &nbsp;</p>
<p>This makes for scattered entries in Program Files and also in the registry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970413">
				<div id="div-comment-970413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Italian programs failure</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970413">
			March 7, 2012 at 8:12 am</a>		</div>

		<p>As an aside &#8211; many italian programs in the late nineties failed to run on almost any non-italian version because they were tested only if installed in &quot;C:programmi&quot; and thus happened to work by chance even not supporting spaces in paths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970423">
				<div id="div-comment-970423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970423">
			March 7, 2012 at 8:18 am</a>		</div>

		<p>We followed that for years and had to bail out because Microsoft introduced mass breakage with folder redirection. It turned out our program was so sensitive to folder redirection that even on Windows Server 2003 x64, we had to install to Program Files (x86) even though we were .NET AnyCPU, so we were not really surprised that the folder redirection that came with UAC broke us completely.</p>
<p>We now install to C:Programs and will not change back. Microsoft brought this one on themselves.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-970433">
				<div id="div-comment-970433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970433">
			March 7, 2012 at 8:18 am</a>		</div>

		<p>Why on 64-bit Windows was the Program Files directory not kept as C:Program Files and for 64-bit programs, a C:Program Files (x64) directory introduced? Why C:Program Files has to be for native 64-bit and 32-bit programs going to C:Program Files (x86)?. Because of this, there is no drive-letter independent way to always xcopy deploy or define paths to the 32-bit Program Files. %ProgramFiles% and %SystemDrive%Program Files differs depending on whether it&#39;s 32-bit Windows or 64-bit Windows and %ProgramFiles(x86)% doesn&#39;t exist on 32-bit Windows.</p>
<div class="post">[<i>You should be able to guess the answer. Hint: 32-bit application compatibility. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970453">
				<div id="div-comment-970453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wyatt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970453">
			March 7, 2012 at 8:29 am</a>		</div>

		<p>Writing to %LOCALAPPDATA% was an option listed in a Microsoft White Paper for patching frequently updated game software:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ee418715(v=vs.85).aspx" rel="nofollow">msdn.microsoft.com/&#8230;/ee418715(v=vs.85).aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970463">
				<div id="div-comment-970463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970463">
			March 7, 2012 at 8:29 am</a>		</div>

		<p>@xpclient: xcopy install doesn&#39;t go to Program Files anyway because of different issues.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-brunopitrus odd alt thread-odd thread-alt depth-1" id="comment-970473">
				<div id="div-comment-970473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kinokijuf' rel='external nofollow' class='url'>kinokijuf</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970473">
			March 7, 2012 at 8:43 am</a>		</div>

		<p>Why did NT4 allow Everyone full access to Program Files?</p>
<div class="post">[<i><a href="http://technet.microsoft.com/en-us/magazine/hh824683.aspx" rel="nofollow">Explained here</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970483">
				<div id="div-comment-970483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil (SM)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970483">
			March 7, 2012 at 8:46 am</a>		</div>

		<p>@WndSks:</p>
<p>The reason I don&#39;t like the &nbsp;&quot;program filescompanyproduct&quot; layout is it makes it harder to find some program directories. Especially considering how often I have to go digging in the Program Files directories (relatively not much).</p>
<p>For example if I want to putz with some files for a program called &quot;MusicPaint,&quot; I just look for the MusicPaint directory. &nbsp;If it used the company layout, I would first look for MusicPaint not find it. So then either I&#39;d start digging in other directories, or would need to go back to the program and figure out it&#39;s published by Xyzzy Systems Inc, then look for it in the Xyzzy Systems directory.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970493">
				<div id="div-comment-970493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970493">
			March 7, 2012 at 8:50 am</a>		</div>

		<p>Another nice thing about &quot;Program Files&quot; is that it sped up the process of software properly handling spaces in paths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970513">
				<div id="div-comment-970513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970513">
			March 7, 2012 at 8:59 am</a>		</div>

		<p>Wow. I knew Power Users had write permission to program files. I didn&#39;t know they could install unsigned drivers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970523">
				<div id="div-comment-970523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970523">
			March 7, 2012 at 9:13 am</a>		</div>

		<p>If I had a time machine, I&#39;d have requested that instead of &quot;Program Files&quot;, they just went with &quot;Programs.&quot;</p>
<p>It&#39;s not just the spaces in filenames, but the length of the path.</p>
<p>I much prefer Vista/7&#39;s &quot;c:users&quot; to 2000/XP&#39;s &quot;c:documents and settings&quot; for the same reason.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970543">
				<div id="div-comment-970543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christopher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970543">
			March 7, 2012 at 9:42 am</a>		</div>

		<p>@Ray:</p>
<p>I agree. I tend to install to Applications rather than Program Files on my home PC, a practice which I started when I had a separate OS partition but continue because I&#39;m not that fond of the &quot;Program Files&quot; name.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970553">
				<div id="div-comment-970553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeremy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970553">
			March 7, 2012 at 9:44 am</a>		</div>

		<p>Is there a recommended location for user-local installations (that don&#39;t require admin privileges to install)? &nbsp;For instance, Google Chrome installs to %LOCALAPPDATA%GoogleChromeApplication &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970573">
				<div id="div-comment-970573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970573">
			March 7, 2012 at 9:53 am</a>		</div>

		<p>Sorry Raymond, I just realized that you tend to not like mentions of specific products; I shouldn&#39;t have put that in my previous post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970583">
				<div id="div-comment-970583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/evacchi_4000_live.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>evacchi@live.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970583">
			March 7, 2012 at 10:03 am</a>		</div>

		<p>given the fast pace of updates in Chrome, I like that it doesn&#39;t require elevation and it just silently updates on its own; that&#39;s the same reason for which I installed Firefox and Thunderbird in %UserProfile%Apps. I have many portable application sitting there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970593">
				<div id="div-comment-970593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Caron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970593">
			March 7, 2012 at 10:05 am</a>		</div>

		<p>I don&#39;t know why everyone is so concerned about moving Program Files to another partition. I guess it&#39;s so that they don&#39;t have to re-install everything if they have to wipe C:? Except, you still do since every application has its registry settings, DLL registrations, etc etc that aren&#39;t stored in Program Files anyway.</p>
<p>In face, the only thing I /do/ bother moving on a new install is my User Profile, since the contents of that folder WOULD work in a new install.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970603">
				<div id="div-comment-970603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970603">
			March 7, 2012 at 10:12 am</a>		</div>

		<blockquote><p>
  We now install to C:Programs and will not change back.
</p></blockquote>
<p>What software is this, please? &nbsp;I&#39;d like to be sure I don&#39;t ever even think about installing something whose developers seem proud of violating system convention.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970613">
				<div id="div-comment-970613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970613">
			March 7, 2012 at 10:36 am</a>		</div>

		<p>@dave: What would you consider a rational response to &quot;program does not work if installed to a folder where some programs on the system see a different view than other programs&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970633">
				<div id="div-comment-970633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bla</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970633">
			March 7, 2012 at 11:01 am</a>		</div>

		<p>@Evan</p>
<p>That does not make sense. The OS then boots fast, but the programs you use start slow?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970643">
				<div id="div-comment-970643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970643">
			March 7, 2012 at 11:21 am</a>		</div>

		<p>@bla:</p>
<p>it still means you can selectively install your priority apps to your SSD, if it&#39;s too small to contain all your programs. &nbsp;Also, the OS can cache programs; the reverse is not true</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970653">
				<div id="div-comment-970653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RichardDeeming</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970653">
			March 7, 2012 at 11:23 am</a>		</div>

		<p>I think we need something similar to stop programs dumping all over our user profiles.</p>
<p>For example, prior to Vista, &quot;My Documents&quot; was a top-level folder. On my computer today, it contains 47 folders, of which I created 5. That&#39;s 42 useless folders created by other programs cluttering up &quot;my&quot; folder, most of which should be in AppData. Microsoft is far from blameless &#8211; every version of Visual Studio adds a new folder; SQL Management Studio adds a new folder; Expression Studio adds a new folder; etc.</p>
<p>Since Vista, the user profile replaced &quot;My Documents&quot; as the top-level folder. Today, my user profile contains 21 folders, of which I created 3. Again, Microsoft is the primary culprit &#8211; &quot;Lync Recordings&quot;, &quot;Tracing&quot;, &quot;VSWebCache&quot;. etc.</p>
<p>Maybe I should just ignore my profile directory and switch to libraries. I&#39;d have to remove the &quot;My&quot; folders though, since they&#39;re obviously not mine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970663">
				<div id="div-comment-970663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970663">
			March 7, 2012 at 11:37 am</a>		</div>

		<p>@bla: &quot;The OS then boots fast, but the programs you use start slow?&quot;</p>
<p>The OS still accesses a bunch of stuff in its own directory after it boots, you know.</p>
<p>And &quot;boot fast&quot; is still better than &quot;everything slow.&quot; I&#39;m not at home so can&#39;t check it, but my Program Files directory is almost certainly over 100 GB. An SSD that can hold both my boot &amp; program partitions is out of my price range. An SSD that can hold just my boot partition is rather more attractive.</p>
<p>I still am sort of with you though &#8212; which is why I haven&#39;t gotten one for my boot drive yet. I have a &quot;working set&quot; that is just too large. (At least if I have to manually manage what goes on SSD and what doesn&#39;t. Something like the SSD caching in whatever Intel chipset that supports it sounds really attractive, but again, an upgrade isn&#39;t really in the cards.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970693">
				<div id="div-comment-970693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DosFreak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970693">
			March 7, 2012 at 4:01 pm</a>		</div>

		<p>If you want Chrome to install to Program Files you can install &quot;Google Chrome for Business&quot;</p>
<p>We use SRP to block all executables except Program Files and Windows directories.</p>
<p>So when a user complains that Chrome doesn&#39;t work I know right off the bat why and I just email them the link to Chrome for Business ;)</p>
<p>Since we implemented SRP incidents of malware have pretty much gone to 0 on domain joined machines. (Except for the cases where users actually download malware themselves manually and run it as admin :( &nbsp;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970703">
				<div id="div-comment-970703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970703">
			March 7, 2012 at 4:34 pm</a>		</div>

		<p>Visual Studio 6.0 (or maybe some of it&#39;s SPs) installs, and registers, com dlls in the TEMP directory if it cannot write to progra~1.</p>
<p>Also, it&#39;s easy to install Chrome the old way, download the offline installer:</p>
<p><a rel="nofollow" target="_new" href="http://support.google.com/chrome/bin/answer.py?answer=126299" rel="nofollow">support.google.com/&#8230;/answer.py</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970713">
				<div id="div-comment-970713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970713">
			March 7, 2012 at 4:37 pm</a>		</div>

		<p>I hate that Chrome installs itself to %APPDATA%. I recently needed to go to the installation folder (something to do with an extension) and I looked in Program Files and it wasn&#39;t there. I lost an hour trying to search the Program Files folder for various combinations of Google, Chrome and Chromium.</p>
<p>I also hate it when software (usually games) installs itself in Program FilesCompanyProduct. Usually I only have one software package from any given company so it results in a lot of folders with just one subfolder and nothing else. I can just imagine the bloated ego of the developers: our software is so awesome, everyone&#39;ll want everything we make so we need our own folder!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970563">
				<div id="div-comment-970563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970563">
			March 7, 2012 at 9:49 am</a>		</div>

		<p>@P Wright: &quot;I wonder what readers of this blog think about Google Chrome&#39;s default (i.e., non-MSI) installer installing into %APPDATA%. Always felt &#39;wrong&#39; to me.&quot;</p>
<p>That&#39;s one reason I don&#39;t use Chrome. I install programs to a separate partition. Occasionally I&#39;ll run across a program that doesn&#39;t like that, or will stick a bunch of crap in &quot;c:Program Files&quot; anyway. Such a program has to be very compelling for me to use it&#8230; Chrome isn&#39;t.</p>
<p>@DWalker: &quot;By the way, there is one drawback to the default &quot;C:Program FilesCompanyNameApplicationName&quot;. &nbsp;Companies sell applications to each other all the time, and companies get bought out and renamed.&quot;</p>
<p>NeilSM already said this, but I typed it out too so I&#39;m leaving it. :-) There&#39;s another drawback: a lot of the time, I don&#39;t know or care what company made a piece of software. Just the other day I had reason to look through the folder of SecureCRT for something. I had to go to the start menu, right click its entry, open the property sheet, and look at the path it was starting because I didn&#39;t know that it would be in &#39;C:Program FilesVanDyke Software&#39;.</p>
<p>I actually often *remove* company names like that.</p>
<p>@Ray: &quot;If I had a time machine, I&#39;d have requested that instead of &quot;Program Files&quot;, they just went with &quot;Programs.&quot;&quot;</p>
<p>As others have pointed out, the space in the path had the benefit of &quot;forcing&quot; things to work with spaces. So it&#39;s nice that they did that, IMO. Though I do sort of wish that Vista had changed %ProgramFiles% to Programs, similar to the Users thing.</p>
<p>@xpclient: &quot;Why on 64-bit Windows was the Program Files directory not kept as C:Program Files and for 64-bit programs, a C:Program Files (x64) directory introduced?&quot;</p>
<p>Actually I never really understood why there are separate directories in the first place. Is it so that you could happily install both versions of a program (perhaps something like Tortoise* that has a shell extension) side-by-side even if they weren&#39;t built for that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-970733">
				<div id="div-comment-970733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970733">
			March 7, 2012 at 6:50 pm</a>		</div>

		<p>@DWalker: Agreed. If it&#39;s that way, I might have trouble finding the Crystal Report and Java executables. (kidding)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970623">
				<div id="div-comment-970623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970623">
			March 7, 2012 at 10:53 am</a>		</div>

		<p>@Mike Caron: &#39;I don&#39;t know why everyone is so concerned about moving Program Files to another partition.&#39;</p>
<p>There are a variety of reasons. I do it mostly in case that partition fills up, you can copy the contents of that partition to another a lot easier than copying the boot partition. (Or at least it sounds to me like the latter could be fraught with difficulty.) Also if it fills up, it&#39;s less likely to mess around with the system.</p>
<p>A *very* convincing reason would be so you can put your boot partition (and thus Windows) on an SSD.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970743">
				<div id="div-comment-970743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970743">
			March 7, 2012 at 8:18 pm</a>		</div>

		<blockquote><p>
  I wonder what readers of this blog think about Google Chrome&#39;s default (i.e., non-MSI)</p>
<p>  installer installing into %APPDATA%. Always felt &#39;wrong&#39; to me.
</p></blockquote>
<p>That&#39;s because anyone can scribble into %AppData%, while %ProgramFiles% requires an Admin and entails actual computer management, with policies and so on. &nbsp;Using %AppData% is easier for Google than doing the &#39;cacls +everyone=everything %ProgramFiles%&#39; that would otherwise have been necessary.</p>
<p>(Google&#39;s approach to security under Windows is pretty dire. &nbsp;After how many years of complaints, have they finally fixed Picasa so it doesn&#39;t simply die if you&#39;re not Admin?).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970753">
				<div id="div-comment-970753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970753">
			March 7, 2012 at 8:21 pm</a>		</div>

		<blockquote><p>
  (Google&#39;s approach to security under Windows is pretty dire. &nbsp;After how many years of complaints,</p>
<p>  have they finally fixed Picasa so it doesn&#39;t simply die if you&#39;re not Admin?).
</p></blockquote>
<p>From some quick Googling, at least as late as 2011, it still simply died if you weren&#39;t Admin. &nbsp;Mind you it&#39;s only been ten years, I guess we just have to wait a bit longer for them to get this fixed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970763">
				<div id="div-comment-970763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970763">
			March 7, 2012 at 10:26 pm</a>		</div>

		<p>Uhm, could be me, but isn&#39;t %APPDATA% simply where click-once installed applications end up? And isn&#39;t click-once (supported) by Microsoft? So how exactly is Google doing things wrong here?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-andycadley2 even thread-even depth-1" id="comment-970783">
				<div id="div-comment-970783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/AndyCadley' rel='external nofollow' class='url'>AndyCadley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970783">
			March 8, 2012 at 2:43 am</a>		</div>

		<p>%LOCALAPPDATA%Programs is the location Per-User installations are supposed to use as of Windows 7, so Chrome is almost following guidelines. Windows Installer knows about these on Windows 7 too, which finally fixed one of the biggest problems with trying to author per-user installs in previous versions of Windows.</p>
<p>I&#39;m fascinated by Raymond&#39;s link in the first comment though, I don&#39;t think I&#39;ve seen a single application in all my years with Windows that has followed the advice of putting all dlls in a &quot;System&quot; subdirectory under the application&#39;s folder. Which probably says as much about how little Microsoft does to push this advice out as it does about how many devs ignore it!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970793">
				<div id="div-comment-970793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ooh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970793">
			March 8, 2012 at 2:43 am</a>		</div>

		<p>@Joshua: &quot;program does not work if installed to a folder where some programs on the system see a different view than other programs&quot;</p>
<p>I&#39;d say that program is extremely fragile and buggy, and desperately needs to be fixed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970803">
				<div id="div-comment-970803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970803">
			March 8, 2012 at 2:46 am</a>		</div>

		<p>@dave: Apparently you run into this issue when using a 32-bit installer to install a 64-bit or mixed-mode application, because it will always redirect from Program Files to Program Files (x86).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970813">
				<div id="div-comment-970813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Yates</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970813">
			March 8, 2012 at 2:53 am</a>		</div>

		<p>(trouble posting comments &#8211; sorry if this appears multiple times)</p>
<p>For those who want to have some programs on their boot drive and others on another drive, instead of moving C:program files all the way to D: (or wherever), simply use symbolic links. &nbsp;I still need to use Delphi v7 for some of our development and instead of installing it the usual way and leaving it (after reconfiguring the several hundred control libraries, extensions, compiler batch scripts, etc) I</p>
<p>a) did the installation</p>
<p>b) made a folder called D:Delphi</p>
<p>c) moved the contents of my Delphi7 folder to D:delphi</p>
<p>d) made 2x symbolic links</p>
<p>&nbsp; C:program filesborlanddelphi7 points to D:delphi</p>
<p>&nbsp; C:program files (x86)borlanddelphi7 also points to D:delphi</p>
<p>This way I installed Delphi the &quot;normal&quot; way with the installer but then just overwrote the D:delphi folder with the contents from my old PC and brought over the HKLM and HKCU registry keys. &nbsp;This has worked for 2x laptop migrations so far without a hitch :)</p>
<p>I&#39;ve done it for the visual studio installations and also have a similar thing going when SharePoint 2010 first came out &#8211; a symbolic link was created at c:program files..blah..12 to point to c:program files..blah..14 &nbsp;(SharePoint 2010 was a &quot;wave 14&quot; product). &nbsp;This increased compatibility with a lot of 2007 extensions that assumed the &quot;12&quot; folder name.</p>
<p>The main reason for the Delphi trickery (I also did it for visual studio and several other apps)&#8230; &nbsp;My new laptop has 2x 500GB HDDs (they&#39;re the Seagate XT things with 4GB of SSD as a cache) and I figured I&#39;d like to upgrade to an SSD in the future. &nbsp;Testing the software when first installed with symlinks allowed me to be certain that should I replace my boot drive with an SSD I can move files off it to the slower HDD and move some from the D: HDD back to C: if I want them to be fast. &nbsp;I haven&#39;t had any compat issues yet (after 12 months)</p>
<p>I tend to do database work for a week or two, then move to some Delphi maintenance, and, if I ever get time, new work in Visual Studio. &nbsp;I don&#39;t know if it would be worth it, but I could move things around if I wanted them to be fast for a while without too much effort. &nbsp;I also use my machine for some demos when we&#39;re at trade shows &#8211; demoing a 2GB SQL analysis services cube and an accompanying 20GB SQL database on the SSD temporarily would be nicer than saying &quot;your server will run this better &#8211; please believe me&quot; :)</p>
<p>For those who don&#39;t know about symlinks, Raymond&#39;s written about them plenty of times in the past. &nbsp;Run mklink from an elevated command prompt &#8211; it&#39;s easy to try out with a couple of test folders. &nbsp;There&#39;s also a shell extension which I&#39;ve installed but haven&#39;t really used called Link Shell Extension available at <a rel="nofollow" target="_new" href="http://schinagl.priv.at/nt/hardlinkshellext/hardlinkshellext.html" rel="nofollow">schinagl.priv.at/&#8230;/hardlinkshellext.html</a>. &nbsp;It&#39;s free and the documentation tells you just about everything you&#39;d ever want to know about junctions, links, etc. &nbsp;The versioning of files you can do with it (Delorean copy) seems pretty neat</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970823">
				<div id="div-comment-970823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970823">
			March 8, 2012 at 4:08 am</a>		</div>

		<p>@Neil</p>
<blockquote><p>
  Apparently you run into this issue when using a 32-bit installer to install a 64-bit or mixed-mode application</p>
<p>  &gt; This is 2012 for pete&#39;s sake, this developer needs to pick up a copy of WiX and take 1 hour to learn the easy to pick up syntax.
</p></blockquote>
<p>I second the opinion expressed here, whats the name of this software so I can avoid using/purchasing it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970833">
				<div id="div-comment-970833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970833">
			March 8, 2012 at 4:11 am</a>		</div>

		<p>@640k</p>
<blockquote><p>
  Visual Studio 6.0 (or maybe some of it&#39;s SPs) installs, and registers, com dlls in the TEMP directory if it cannot write to progra~1.</p>
<p>  &gt; So because of a mistake made in 1998 (14 years ago) this needs to be perpetuated today?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970843">
				<div id="div-comment-970843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970843">
			March 8, 2012 at 5:22 am</a>		</div>

		<p>| Hint: 32-bit application compatibility. -Raymond</p>
<p>Really? Just consider the following case: a 32-bit application uses batch files to perform some sophisticated tasks. All paths in these batch files use &quot;C:Program Files&#8230;program.exe&quot; or &quot;%ProgramFiles%&#8230;program.exe&quot; to run the different application programs, and stop working on x64.</p>
<p>Hint: the batch interpreter is a native x64 application.</p>
<p>Hint2: *.LNK which are created with &quot;%ProgramFiles%&#8230;&quot; suffer the same problem: the shell is a native x64 application.</p>
<div class="post">[<i>Presumably the batch file asks LitWare 2000 where it was installed, and LitWare 2000 says &quot;I am located at C:Program Files (x86)LitWare 2000LitWare.exe&quot;. I find it interesting that people who hate file system redirection are suddenly demanding it. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970903">
				<div id="div-comment-970903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random User 435668</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970903">
			March 8, 2012 at 7:57 am</a>		</div>

		<p>@Stefan, Joseph</p>
<p>I freely admit I may be remembering this wrong, but I seem to recall: when I ran into something like this, the 32bit app ended up launching the 32bit version of of command interpreter (cmd), which went on it&#39;s merry way running the batch script. All 32bit, all references to &quot;Program Files&quot; properly virtualized. (Obviously, if you were expecting the 32bit app to go mess with the 64bit folder, then this might be considered a bug.)</p>
<p>As for shortcuts, I&#39;ve not messed with those. If they are created with whatever appropriate API, instead of blindly copying them between systems, does it not adjust the path during the create?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-970943">
				<div id="div-comment-970943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970943">
			March 8, 2012 at 8:27 am</a>		</div>

		<p>@Ooh: A program that assumes the classical model of filesystems is buggy? Really?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970983">
				<div id="div-comment-970983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970983">
			March 8, 2012 at 9:14 am</a>		</div>

		<p>All the people complaining about chrome not installing into Program Files clearly don&#39;t use FF or chrome (installed into Program Files), because if they did they would understand the reasoning at the first update (so in chromes case probably 10minutes after install ;) ).</p>
<p>Having to have admin rights to update a browser makes for horrible design. Having the browser auto update itself is the best thing to protect the average user from malware &#8211; not being able to do so (or having to give them admin rights) completely defeats that..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-zamescurran even thread-even depth-1" id="comment-970993">
				<div id="div-comment-970993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/James+Curran' rel='external nofollow' class='url'>James Curran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970993">
			March 8, 2012 at 9:16 am</a>		</div>

		<p>I had assumed at least one of the reasons for &quot;Program Files&quot; was to aid backups &#8212; the &quot;My Documents&quot; folder needed to be backed-up regularly, while the &quot;Program Files&quot; folder needed to be backup only after a new installation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jader3rd odd alt thread-odd thread-alt depth-1" id="comment-971003">
				<div id="div-comment-971003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/jader3rd' rel='external nofollow' class='url'>jader3rd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971003">
			March 8, 2012 at 9:46 am</a>		</div>

		<p>@voo,</p>
<p>Gotta disagree with you there. I&#39;ve seen too many hijacked installs of Chrome to think that running internet facing program from a non-admin installed location could possibly be a good idea. In addition to Google being able to update Chrome binaries, malware also has to the ability to &quot;update&quot; the Chrome binaries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971013">
				<div id="div-comment-971013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971013">
			March 8, 2012 at 10:04 am</a>		</div>

		<p>| I find it interesting that people who hate file system redirection are suddenly demanding it. -Raymond</p>
<p>Have I demanded file system redirection anywhere, anytime?</p>
<p>NEVER! File system redirection is the dumbest idea ever introduced in Windows.</p>
<p>Examples: try to open &quot;%SystemRoot%System32filename.ext&quot; with a 32-bit application that is associated with .EXT. OUCH! Or drag&amp;drop that file onto a 32-bit executable. OUCH!</p>
<p>Or type the name of your 32-bit executable in a (32- or 64-bit) command processor window and complete the command line with drag&amp;drop of the pathname. OUCH!</p>
<p>| Presumably the batch file asks LitWare 2000 where it was installed</p>
<p>This wasn&#39;t necessary before with Windows x86, and Windows x64 is said to be compatible to Windows x86.</p>
<p>But let&#39;s assume the batch file does so: which command provides this kind of information?</p>
<p>The batch file needs to know the path to &quot;LitWare 2000&quot; to be able to ask it. So: back to square 0!</p>
<p>@Random &#8230;</p>
<p>Start the batch in Windows Explorer.</p>
<div class="post">[<i>The batch file needed to do this even on an all-x86 machine, because there&#39;s no guarantee that LitWare is installed into C:Program FilesLitWare 2000 if the user customized the installation directory. Maybe it&#39;s on D:Program Files, as so many commenters wish would be the default. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971033">
				<div id="div-comment-971033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971033">
			March 8, 2012 at 10:18 am</a>		</div>

		<p>I suspect Stefen Kanthak has far enough out of his way to ensure this will always be true (this is possible in a corporate environment) but was not expecting x64 to use Program Files (x86) for 32 bit programs having never seen it before writing the admin batch files.</p>
<p>There really should be an alias for program files like there is sysnative for system32. Hmmm I wonder if a symlink can do that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971043">
				<div id="div-comment-971043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971043">
			March 8, 2012 at 10:30 am</a>		</div>

		<p>&quot;Having to have admin rights to update a browser makes for horrible design&quot;</p>
<p>At work I ran into a problem with an older Firefox install, which was unable to update itself because Program Files was locked down and would get stuck into an infinite loop of failing to update and automatically restarting and failing again. Took a call to IT to get it fixed. Later I found out how they avoided this problem for remote field installs: by simply not patching Firefox at all. For the next several years. They ultimately lost the install package, thank gods.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971053">
				<div id="div-comment-971053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971053">
			March 8, 2012 at 11:19 am</a>		</div>

		<p>| The batch file needed to do this even on an all-x86 machine, because there&#39;s no guarantee that LitWare is installed into C:Program FilesLitWare 2000 if the user customized the installation directory. Maybe it&#39;s on D:Program Files, as so many commenters wish would be the default. -Raymond</p>
<p>&quot;LitWare 2000&quot; can only be (or is always) installed in &quot;%ProgramFiles%&quot;.</p>
<p>This happens to be on D: if %SystemDrive% is D: (or my WINNT.SIF relocated &quot;ProgramFiles&quot; to &quot;D:Program Files&quot;).-P</p>
<p>@Joshua:</p>
<p>No, I expect x64 to be compatible with x86.</p>
<p>This includes batch files, scripts etc. too.</p>
<p>Remember: the Windows Explorer is a 64-bit application. A batch file started from there needs to use %ProgramFiles(x86)% to address the directory which was well-known as %ProgramFiles% in x86 environment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kwadwomi even thread-even depth-1" id="comment-971083">
				<div id="div-comment-971083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Master+Programmer' rel='external nofollow' class='url'>Master Programmer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971083">
			March 8, 2012 at 1:56 pm</a>		</div>

		<p>@voo</p>
<p>The solution isn&#39;t to make the binaries writable by everyone but to have a background service that can update the executables. That way the service can verify that the updates are safe and trusted, and then updates the binaries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-970853">
				<div id="div-comment-970853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joseph Koss</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-970853">
			March 8, 2012 at 6:06 am</a>		</div>

		<p>@Stefan</p>
<p>I agree with you. Raymonds comment didnt make sense with regard to 32-bit compatibility. If the 32-bit location remained Program Files and the 64-bit location was Program Files (x64) then its hard to imagine that that creates *more* comparability issues than the current system, which also frustrates the users because what he see is sometimes no longer what he gets.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971093">
				<div id="div-comment-971093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971093">
			March 8, 2012 at 2:54 pm</a>		</div>

		<p>@jader3rd Hmm personally I see only two variants at the moment: Give my users (well, people whom I fix their PCs, say parents, I don&#39;t do that stuff for work) admin rights and firefox, or let them use chrome. Firefox without admin rights means they will run ancient versions of it (I&#39;ve seen similar things as MR there), which is bad, and I really don&#39;t want to give them the admin rights..</p>
<p>@Master Programmer Yeah sounds like a good solution, but why oh why aren&#39;t the firefox guys implementing this? Seems simple enough that I&#39;m sure there must be some catch (well we&#39;d still need admin rights to install the browser, which chrome doesn&#39;t need, but that&#39;s much less of a problem than needing the rights at every update).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971103">
				<div id="div-comment-971103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jojo Man</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971103">
			March 8, 2012 at 4:35 pm</a>		</div>

		<p>The UNIX system made more sense with system software paths and local software paths. There is no reason why Windows does not have system/global program files and per-user program files. That way when installing a program the user can choose whether to install it for just themselves or for everyone on the machine. Software that is meant to be used by the system or everyone can mandate that it be installed to the system/global location if desired.</p>
<p>Most people I know do not have multiple user accounts on their Windows PCs so nothing would change much if most applications like browsers installed to the per-user program files directory (UNIX equivalent of something like ~/programs). It definitely would make patching/upgrades doable for non-admin users and would also allow per-user licensing to be respected for software on machines that do have multiple user users/user-accounts.</p>
<p>Plus its so much easier to type ~/documents or ~/programs to get to your documents and programs respectively than &quot;c:documents and settingssomeusermy documents&quot; and &quot;c:program files&quot; or &quot;C:Documents and SettingssomeuserApplication DataPrograms&quot; or something like that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971113">
				<div id="div-comment-971113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971113">
			March 8, 2012 at 5:28 pm</a>		</div>

		<p>@Joshua: I&#39;m puzzled by the issue you describe, because WOW64 doesn&#39;t do any file redirection for the Program Files directory, so all applications should see the same view as far as that is concerned.</p>
<p>UAC redirection should only kick in if your application misbehaves by writing into the program directory at runtime.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971133">
				<div id="div-comment-971133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971133">
			March 8, 2012 at 7:59 pm</a>		</div>

		<p>@Harry Johnston: The fault was caused by UAC redirection applied to some other application we invoked by out-of-process COM. After discovering that the necessary manifest varied by version of the other program (something we had no control over) that was end-game.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971153">
				<div id="div-comment-971153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971153">
			March 8, 2012 at 9:55 pm</a>		</div>

		<p>@JoJo Man: &quot;The UNIX system made more sense with system software paths and local software paths.&quot;</p>
<p>I&#39;m not sure what you mean by that, because Unix doesn&#39;t have any standard for local software paths, and almost no package managers support installation as non-root. (/usr/local/bin, for the Unixes that use that, is different.) You can still do it if you go through the configure/make sequence yourself (for almost any program), but then again you can also install anywhere you like when installing a Windows program, including choosing something other than Program Files (for almost any program).</p>
<p>Now, there is a difference in that Windows seems to automatically elevate most installers, so you can&#39;t even run them if you don&#39;t have the equivalent of sudo rights, but that&#39;s independent of file system layout. Nor is it universal; plenty of software runs under your credentials at the start, asks whether you want to install it for just your or any user, and elevates only if necessary.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971183">
				<div id="div-comment-971183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971183">
			March 9, 2012 at 12:57 am</a>		</div>

		<p>Regarding Program Files: it&#39;s not part of WoW64 redirection &#8211; 32bit programs can access C:Program Files just fine.</p>
<p>As for batch files, 32-bit process will run them in 32bit cmd.exe (unless it specifically knows how to invoke the 64bit one), and %PROGRAMFILES% in 32-bit cmd.exe expands to C:Program Files (x86) (other affected environment variables are %CommonProgramFiles% and %PROCESSOR_ARCHITECTURE%).</p>
<p>And speaking of installing programs with Windows Installer: it&#39;s not possible to create a single MSI file that would install either 32 or 64-bit version of a program, depending on the host OS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971203">
				<div id="div-comment-971203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971203">
			March 9, 2012 at 2:20 am</a>		</div>

		<p>@Stefan Kanthak</p>
<p>I guess the batch file needs to be updated then. Just remember to check the %PROCESSOR_ARCHITECTURE% and %PROCESSOR_ARCHITEW6432% environment variables. If you check %PROCESSOR_ARCHITECTURE% and it is x86 then it is either an x86 version of Windows or a WoW64 version of cmd, you should just do what you normally do. If you care to tell the difference, check for %PROCESSOR_ARCHITEW6432%. If this is set then it is a WoW64 version of cmd, but normally you shouldn&#39;t care.</p>
<p>The real problem is when %PROCESSOR_ARCHITECTURE% is set to AMD64. This means you have a native 64 bit version of the command prompt and thus everything will just direct you to the normal 64 bit locations. This means you have to deal with it in one of two ways, first explicitly access the (x86) versions of the environment variables or secondly, %systemroot%syswow64cmd /c &lt;path to your batch file&gt;. It will launch your batch file with the 32 bit version of the shell and so everything should work fine.</p>
<p>But to make one thing clear, 32 bit compatability means that applications will run without modification while they stick to the 32 bit world, and that means staying in WoW64 processes. As soon as you venture outside of this then you are out for pain. Your batch file is proof of this. You are claiming that WoW isn&#39;t there for 32 bit compatability, but it is more likely that you are running it in a 64 bit copy of cmd and so it isn&#39;t a 32 bit process, so why would 32 bit compatability apply there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-971423">
				<div id="div-comment-971423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971423">
			March 9, 2012 at 11:29 am</a>		</div>

		<p>The recommendation (and the trend) to install programs into %UserProfile%Apps is a security issue. &nbsp;The Microsoft guidance page that Raymond pointed to in the first comment mentions this. &nbsp;Yes, it&#39;s easier to let non-elevated users update programs there, and yes, it&#39;s easier to let malware update programs there.</p>
<p>When programs are installed to the user Apps folder, malware has a known target &#8212; it replace an executable file that has a known name, in a known location (like Chrome.exe in the user&#39;s Apps folder), without the restrictions that are in place against updating files that are in the &quot;Program Files&quot; folder.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971223">
				<div id="div-comment-971223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971223">
			March 9, 2012 at 5:08 am</a>		</div>

		<p>@ender</p>
<p>| 32bit programs can access C:Program Files just fine.</p>
<p>32bit programs^Wbatch files can&#39;t use neither &quot;%ProgramFiles%&quot; nor &quot;%ProgramFiles(x86)%&quot; to access that path WITHOUT knowledge of the drive letter etc. of the resp. Windows installation. See &lt;<a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/976039&gt;" rel="nofollow">support.microsoft.com/&#8230;/976039&gt;</a></p>
<p>There is also no CSIDL (see 16422, 16426, 16427 and 16428) that may serve that purpose.</p>
<p>| As for batch files, 32-bit process will run them in 32bit cmd.exe</p>
<p>A *.CMD, *.VBS, *.JS, *.PS1 etc. started from the Explorer runs in 64bit, not 32bit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971513">
				<div id="div-comment-971513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971513">
			March 9, 2012 at 2:35 pm</a>		</div>

		<p>@DWalker: Wow. Turing completeness leads to recursive insecurity.</p>
<p>Not that I&#39;m surprised. It turns out that Turing completeness requires on some large scale self-modifying code (the Harvard Architecture is only complete by emulating a machine that has Von Neumann Architecture), and perfect virus detection is a known unsolvable problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971553">
				<div id="div-comment-971553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971553">
			March 9, 2012 at 11:26 pm</a>		</div>

		<p>| and perfect virus detection is a known unsolvable problem.</p>
<p>Strike out &quot;perfect&quot;: even simple virus detection is an unsolvable problem!</p>
<p>That&#39;s why antivirus programs and the like are useless: they can&#39;t protect against malware.</p>
<p>To protect yourself and your users you need a restrictive system configuration, without administrative rights for users (no UAC doesn&#39;t work for that purpose), plus SAFER a.k.a. software restriction policies that allow execution only in %SystemRoot% (with exceptions for the user-writable subdirectories), %ProgramFiles% and %ProgramFiles(x86)%.</p>
<p>Bonus: there is no more security issue with anything &quot;installed&quot; in %UserProfile%!</p>
<p>JFTR: &quot;installing&quot; programs in user-writable locations in COMPLETE NONSENSE!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-971603">
				<div id="div-comment-971603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971603">
			March 11, 2012 at 12:09 pm</a>		</div>

		<p>Stefan Kanthak: &quot;File system redirection is the dumbest idea ever introduced in Windows&quot;.</p>
<p>Well said. Can&#39;t agree more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-971723">
				<div id="div-comment-971723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-971723">
			March 12, 2012 at 9:00 am</a>		</div>

		<p>@Stefan Kanthak: Congratulations. Developing for the platform now requires cross-compiling from a platform without those restrictions, and viruses are still possible as interpreted languages will still run.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis odd alt thread-odd thread-alt depth-1" id="comment-972263">
				<div id="div-comment-972263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-972263">
			March 13, 2012 at 11:25 am</a>		</div>

		<p>I&#39;m surprised that no one has mentioned that Oracle still requires that their stuff be installed to C:Oracle and that the app won&#39;t work if installed to a path containing spaces. &nbsp;(It&#39;s been 17 years since they first saw Windows 95, and 16 since NT4.)</p>
<p>I disagree wholeheartedly with the &quot;dumbest idea&quot; assertions about file system redirection. &nbsp;UAC&#39;s file/registry redirection (&quot;virtualization&quot;) enables lots of apps to run on Vista/7 that required admin rights on XP. &nbsp;And when a 32-bit process wants to load gdi32.dll, it needs to get the 32-bit GDI; if it tries to load the 64-bit, it will fail. &nbsp;Redirection is the only way to make that happen. &nbsp;And how often does a 32-bit app need to open a &quot;filename.ext&quot; in the System32 folder? &nbsp;Why is that file in the System32 folder? &nbsp;Does it really belong there?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis even thread-even depth-1" id="comment-972273">
				<div id="div-comment-972273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-972273">
			March 13, 2012 at 11:28 am</a>		</div>

		<p>@Adam Rosenfield: &nbsp;Here&#39;s what I did today when I needed to navigate to the &quot;Microsoft SDKs&quot; folder: &nbsp;navigate down to &quot;Program Files&quot; (or the x86 if you&#39;re going there), then press &quot;*SDK*&quot; and press Tab. &nbsp;Cmd.exe figures out which folders match *SDK* and cycle through those &#8211; or just pick the one that matches.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-972393">
				<div id="div-comment-972393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120307-00/?p=8153#comment-972393">
			March 14, 2012 at 2:54 am</a>		</div>

		<p>Well, if you *need* to have C:Program Files on a seperate HDD you could *try* mounting the partition as an NTFS path with name C:Program Files (never tried, though).</p>
<p>Of course you should copy all folders already in there to the new partition before you do so :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>