<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1076563">
				<div id="div-comment-1076563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076563">
			September 9, 2013 at 7:27 am</a>		</div>

		<p>You can use the wonderful new feature of Visual C, and save your source file as Unicode, so you don&#39;t have to enter non-ASCII characters by their hex codes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1076583">
				<div id="div-comment-1076583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076583">
			September 9, 2013 at 8:50 am</a>		</div>

		<p>alegr1: and then it stops displaying properly on some terminals, doesn&#39;t round trip through some command-line programs and mail clients, and makes it awkward to reason about the memory contents. Better to pull the strings out into a separate file if you want to edit them that way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1076593">
				<div id="div-comment-1076593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JDP </cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076593">
			September 9, 2013 at 9:43 am</a>		</div>

		<p>is that a for-if loop I spy, Raymond? :o) </p>
<p>I know, little program, example purposes only &#8212; but once you explained that as an anti-pattern, it was like a switch being flipped in my head, and I wind up doing my best to make any for-ifs that I find more sensible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1076613">
				<div id="div-comment-1076613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076613">
			September 9, 2013 at 9:49 am</a>		</div>

		<p>hopefully that doesnt have the nasty side effect with txxx tags that has been in there since 2009&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1076623">
				<div id="div-comment-1076623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076623">
			September 9, 2013 at 9:49 am</a>		</div>

		<p>The for-if antipattern looks like this:</p>
<p>for (i = some range of values) {</p>
<p>____ if (i == some specific value) { do something with i }</p>
<p>}</p>
<p>This can be replaced with the more performant</p>
<p>do something with (the specific value)</p>
<p>That is not the case in this example. What we have here is:</p>
<p>for (i = some range of values) {</p>
<p>____ if (array[i] == some specific value) { do something with i }</p>
<p>}</p>
<p>There is no way to replace this with a single statement. If we were guaranteed that the &quot;composers&quot; array were sorted we could do a binary search instead of a linear search, but no such guarantee exists.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1076653">
				<div id="div-comment-1076653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jodi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076653">
			September 9, 2013 at 2:23 pm</a>		</div>

		<p>I think he meant not seeing the general usefulness of it due to unsupported formats that are commonly used.</p>
<p>Then again he might have confused it with the metadata stored in alternative streams or with metadata locked in to individual user accounts. Dealing with COM, metadata can mean a lot of things. Like sending your boss that photoshopped picture of him that you made. Lovely bugs and office installed. I&#39;ve run windows 7 for years I never knew it supported flac. I just tested it. I&#39;m surprised. Must be something I installed, surely. It do still however not support mkv or ogg. As for me I did go nutsy, windows media player, ugh, unusable and slow! After that episode I installed an open source player.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1076633">
				<div id="div-comment-1076633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076633">
			September 9, 2013 at 12:14 pm</a>		</div>

		<p>// Swap in the new name</p>
<p>PWSTR pszOld = rgpszComposers[ulPos];</p>
<p>rgpszComposers[ulPos] = L&quot;Dvox0159x00E1k, Antonx00EDn&quot;;</p>
<p>&#8230;</p>
<p>// Swap it back so we can free it</p>
<p>rgpszComposers[ulPos] = pszOld;</p>
<p>Swapping pointers to allocated memory make me nervous.</p>
<p>Swapping a pointer with static string when talking to com makes me worried</p>
<p>rgpszComposers[ulPos] = L&quot;Dvox0159x00E1k, Antonx00EDn&quot;;</p>
<p>&quot;but it illustrates what you need to do to do something more useful in general.&quot;</p>
<p>No, I&#39;m not seeing it. An example would have been nice.</p>
<p>I only see problems: Since when can windows read flac and mkv metadata? Can it even read ogg?</p>
<p>Windows version of &quot;metadata&quot;, *cough* time wasting lock-in *cough* is not compatible when you move the files to another computer eg Linux or even sometimes another windows machine.</p>
<div class="post">[<em>This was a quick and dirty app, so it cuts a lot of corners, such as editing the array in place. I&#39;m not sure what you mean by &quot;I&#39;m not seeing it.&quot; I showed how you can read and modify the Composers property of an audio file. What&#39;s not to see? (Windows stores it in the ID3 field of the mp3 file. Isn&#39;t that widely recognized? And if you want to write a flac or mkv property provider, go nutsy.) -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1076673">
				<div id="div-comment-1076673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076673">
			September 9, 2013 at 7:28 pm</a>		</div>

		<p>@Jodi:</p>
<p>The formats are third party, so Windows doesn&#39;t support them out of the box.</p>
<p>There is, however, nothing stopping third party developers from providing the same level of integration to these formats that the likes of MP3 and WMA have.</p>
<p>For Direct Show, LAV Filters provides splitters and filters for a lot of out of box formats like flac/mkv/ogg and more. This doesn&#39;t add general support for the tags that these formats use though. As Raymond said, someone needs to write a property provider for these formats, and that is just something that people haven&#39;t done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1076683">
				<div id="div-comment-1076683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">parkrrrr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076683">
			September 10, 2013 at 6:49 am</a>		</div>

		<p>How appropriate that the Classical Music Library Free Download of the Week for this week (or week-like period) is Dvořák&#39;s Symphony No. 9.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1076763">
				<div id="div-comment-1076763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1076763">
			September 10, 2013 at 10:22 am</a>		</div>

		<p>&gt; &quot;but it illustrates what you need to do to do something more useful in general.&quot;</p>
<p>&gt; No, I&#39;m not seeing it. An example would have been nice.</p>
<p>As an example of a practical use of this technique, here&#39;s a tool I use to groom the audio metadata in my collection (mostly to set the album title on content which spans multiple CDs.)</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/matthew_van_eerde/archive/2013/09/10/shellproperty-exe-set-read-string-properties-on-a-file-from-the-command-line.aspx">blogs.msdn.com/&#8230;/shellproperty-exe-set-read-string-properties-on-a-file-from-the-command-line.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1077023">
				<div id="div-comment-1077023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NitpickersParadise</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1077023">
			September 11, 2013 at 9:24 am</a>		</div>

		<p>ITT: People complaining that relatively obscure* formats are not supported out of the box by Windows. Oh the humanity! How will I ever properly tag my APE files now?</p>
<p>*In sheer numbers MP3 will be here today, here tomorrow, here forever. The wise-man however always archives with FLAC then transcodes to the flavor of the week, but how many people are that forward thinking?</p>
<p>The solution, as usual is to look the the wide world of third party utilities that are what makes the Windows Ecosystem the Goliath it has been for years in the desktop world. Personally I enjoy Mp3Tag.de which supports *some* of these obscure formats.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1077863">
				<div id="div-comment-1077863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bulletmagnet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130909-00/?p=3293#comment-1077863">
			September 16, 2013 at 4:17 am</a>		</div>

		<p>Did you actually roll dice, or did you use <a rel="nofollow" target="_new" href="http://xkcd.com/221/">http://xkcd.com/221/</a> ?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>