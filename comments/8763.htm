<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (5)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-955913">
				<div id="div-comment-955913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111230-00/?p=8763#comment-955913">
			December 30, 2011 at 7:39 am</a>		</div>

		<p>I can count the number of times I&#39;ve wished for the ability to rearrange menu items on zero hands. &nbsp;It&#39;s interesting, I guess, but aside from something like the Start menu it doesn&#39;t seem very useful (and even then only marginal). &nbsp;In fact, I can&#39;t recall ever seeing any program with a rearrangeable menu; it just doesn&#39;t strike me as a very intuitive or discoverable feature. &nbsp;Maybe I just don&#39;t get out that much.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-955923">
				<div id="div-comment-955923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111230-00/?p=8763#comment-955923">
			December 30, 2011 at 7:42 am</a>		</div>

		<p>Exercise: &nbsp;Because you created CEmptyDataObject with one reference.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-955953">
				<div id="div-comment-955953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111230-00/?p=8763#comment-955953">
			December 30, 2011 at 8:18 am</a>		</div>

		<p>James:</p>
<p>One of the rules of a well behaved COM object is that on failure the QueryInterface will guarantee that the pointer is set to null. So even if it is uninitialised there, after the QI call, if it failes then it will be null.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-956003">
				<div id="div-comment-956003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">wqw</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111230-00/?p=8763#comment-956003">
			December 30, 2011 at 2:40 pm</a>		</div>

		<p>1. keeping track of g_pdtoDrag: ROT or other cross-process marshaling</p>
<p>2. use punk after releasing it: pdto is keeping base object alive</p>
<div class="post">[<i>Even if you needed to put it in a cross-process marshaller (which you don&#39;t), that just replaces one question with an equivalent question: Where do you put the ROT cookie? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-955933">
				<div id="div-comment-955933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111230-00/?p=8763#comment-955933">
			December 30, 2011 at 7:51 am</a>		</div>

		<p>Very interesting little demo. You didn&#39;t mention of any more drag and drop demos coming. Please continue on the same subject.</p>
<p>Do i dare to suggest a topic ? Take it as a compliment of me asking you. You do a much better job of showing how to use windows functions correctly than msdn ever have done so far. (Poor description and buggy demos)</p>
<p>I learn by watching how it&#39;s used so this is great. More microsoft employee&#39;s should do this.</p>
<p>1. Right-click dropping.</p>
<p>2. How to use IDropTarget with IDropTargetHelper correctly. (connected with 1.)</p>
<p>&quot;Exercise: Since this is a demo program, the object is just a global variable. What is the correct way of keeping track of g_pdtoDrag?&quot;</p>
<p>As a per window object. For example using SetProp or in the windows own class object (c++ version). </p>
<p>&quot;Exercise: Why is it okay to use punk after releasing it?&quot;</p>
<p>You are only comparing the location of where the object resides.</p>
<p>But it makes me very nervous. Due to &quot;IUnknown *punk;&quot; shouldn&#39;t it be &quot;IUnknown *punk = nullptr;&quot; or is that set in QueryInterface ?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>