<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1116013">
				<div id="div-comment-1116013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">VIMH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116013">
			March 27, 2014 at 7:15 am</a>		</div>

		<p>&quot;But I burned a favor for you guys.&quot;</p>
<p>And we are grateful for that, Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1116023">
				<div id="div-comment-1116023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Another Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116023">
			March 27, 2014 at 8:06 am</a>		</div>

		<p><a href="mailto:RaoR@CronusVentures.com">RaoR@CronusVentures.com</a></p>
<p>The people need to know.</p>
<div class="post">[<em>Good. You too can <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/01/18/10116870.aspx">be somebody</a>. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1116033">
				<div id="div-comment-1116033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116033">
			March 27, 2014 at 8:41 am</a>		</div>

		<p>Could it be that the GetXxxRgn functions aren&#39;t allowed to run out of memory?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1116043">
				<div id="div-comment-1116043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116043">
			March 27, 2014 at 8:46 am</a>		</div>

		<p>Alternatively, looking at the Word 1.1a code (which is now public), all calls to CreateRectRgn are done in init functions and appear to be long-lived, so perhaps the assumption of freeing it up isn&#39;t true?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1116053">
				<div id="div-comment-1116053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116053">
			March 27, 2014 at 8:50 am</a>		</div>

		<p>More like that the GetXxxRgn function aren&#39;t allowed to run out of handles.</p>
<p>The size of region data depends a lot on the geometry of the region. So worst case is that you rotate a rectangle geometry: Original could be stored in a single RECT structure. The output however is a list of rectangles (internally probably handled as bitmap mask).</p>
<p>(And no. Region Data is NOT vector data, no matter that this is what you would expect it to be on first sight)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1116063">
				<div id="div-comment-1116063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre Lebeaupin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116063">
			March 27, 2014 at 9:06 am</a>		</div>

		<p>Far be it from me to have the intent to start a flamewar, but the trail might even go up to Bill Atkinson, since QuickDraw region functions share that pattern.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1116133">
				<div id="div-comment-1116133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Willie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116133">
			March 27, 2014 at 12:16 pm</a>		</div>

		<p>This is the type of content that drew me to this blog. &nbsp;It&#39;s so interesting to see the history behind these well known products.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1116143">
				<div id="div-comment-1116143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Just a guess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116143">
			March 27, 2014 at 1:25 pm</a>		</div>

		<p>This behavior is arisen in the dark era of insufficient RAM combined with &quot;primitive&quot; memory management. Intensive creating and destroying objects has probably fragmented the heap way too fast. The memory (de)allocation has never been really cheap operation, so performance difference might also become a part of the motivation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1116073">
				<div id="div-comment-1116073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">zonk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116073">
			March 27, 2014 at 9:23 am</a>		</div>

		<p>Isn&#39;t it just naming convention, that Create**** calls always need corresponding Release**** call, and Get**** just shows you something not yours?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1116183">
				<div id="div-comment-1116183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116183">
			March 28, 2014 at 5:26 am</a>		</div>

		<p>This reminds me of an undocumented function (which presumably no longer exists anyway) that I used in a screen-capturing program that I wrote; the function returned the internal region object corresponding to the visible part of a window, which was handy when I wanted to work out what I could capture. (Obviously it would have been a very bad idea to pass this region to one of the Get functions.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1116403">
				<div id="div-comment-1116403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140327-00/?p=1383#comment-1116403">
			March 31, 2014 at 8:39 am</a>		</div>

		<p>@Neil: My experiments on Win9x indicated that visibility of a window was handled directly as a set of rectangles and multiple WM_PAINT methods were generated: one for each visible rectangle.</p>
<p>For the program that allowed me to notice I&#39;m really glad I implemented the code for only repainting the visible region rather than the whole window (.5 seconds to repaint whole window is slooow).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>