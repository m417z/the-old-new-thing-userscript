<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-911303">
				<div id="div-comment-911303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911303">
			May 5, 2011 at 7:24 am</a>		</div>

		<blockquote><p>
  And long name/short name is really just a special case of a single file having multiple names.
</p></blockquote>
<p>Conceptually this is true, but practically there is a difference. &nbsp;Short file names are automatically generated by the operating system and you don&#39;t really have any control over them. &nbsp;For operating system components this probably isn&#39;t a problem, but for 3rd party software it can be. &nbsp;Foo~1.dll may point to FooA.dll on one machine and FooB.dll on another machine. &nbsp;There is a lot of software out there, and in an 8.3 world there are only so many unique file names.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911313">
				<div id="div-comment-911313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911313">
			May 5, 2011 at 7:33 am</a>		</div>

		<p>John: This is why short files names are intended as a compatibility hack for 16-bit Windows apps mainly, and shouldn&#39;t be relied on for modern apps (IIRC I had one that assumed C:Progra~1) was Program Files, except that I had reinstalled Windows and so it was C:Progra~2). &nbsp;You should always specify the &quot;real&quot; filename when hardcoding (and of course, never hardcode system paths anyway; there are APIs for those for a reason).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911323">
				<div id="div-comment-911323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911323">
			May 5, 2011 at 7:34 am</a>		</div>

		<p>Not being a hardcore Win32 developer, I wonder, what ramifications would it have, if the loader would be modified to translate short filenames to their long counterparts and THEN load the files. Therefore loading the same file by short or long filename would be the same.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911333">
				<div id="div-comment-911333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mathieu Garstecki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911333">
			May 5, 2011 at 8:29 am</a>		</div>

		<p>@Vilx-: not an expert on that, but I think the loader runs with the rights of the executing user, so the &quot;directory you cannot access&quot; point blocks that approach.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911343">
				<div id="div-comment-911343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911343">
			May 5, 2011 at 8:38 am</a>		</div>

		<p>Don&#39;t you wish x64 should have gotten rid of short names for Win32 subsystem altogether? Like never return them for FindFileFirst, and ignore them for CreateFile.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911353">
				<div id="div-comment-911353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911353">
			May 5, 2011 at 8:40 am</a>		</div>

		<p>I suggest that in Windows 8 short name creation be disabled by default. Screw those idiots who use them. If there is a big corporation that rins those crappy apps, they can reenable it by policies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911363">
				<div id="div-comment-911363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911363">
			May 5, 2011 at 8:40 am</a>		</div>

		<p>The way to avoid that terrible glitch that lead to this problem is to compare by device &amp; inode numbers. Device number in Windows is in fact a string (X: or \SERVERSHARE except for the need to resolve local mappings) while inode number is available via GetFileInformationByHandle.</p>
<p>My compliments to Microsoft for designing 8 byte inode numbers in 1993.</p>
<div class="post">[<i>Resolving local mappings isn&#39;t enough. What if a server has shared DOCUMENTS=C:Documents and BUDGETS=C:DocumentsBudgets? They are the same device but have different share names. And then there&#39;s DFS. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911373">
				<div id="div-comment-911373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Clovis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911373">
			May 5, 2011 at 9:42 am</a>		</div>

		<p>&quot;And then there&#39;s DFS&quot; &#8211; I know just what you mean. Their adverts are way more irritating and dispiriting than anything the Windows loader gets up to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911383">
				<div id="div-comment-911383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PhilDW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911383">
			May 5, 2011 at 10:10 am</a>		</div>

		<p>@Alex, I was thinking the same thing. There&#39;s an argument that native 64-bit doesn&#39;t need to carry the legacy Win32/16 stuff. Maybe x64 NTFS is only? &nbsp;I think that kind of thing has been done in some cases, but I can&#39;t actually think of one right now ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-leo-davidson odd alt thread-odd thread-alt depth-1" id="comment-911423">
				<div id="div-comment-911423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Leo+Davidson' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911423">
			May 5, 2011 at 3:29 pm</a>		</div>

		<p>You&#39;d be surprised by how much breaks if you turn off short names on your local filesystem.</p>
<p>Short names are still useful when you need an ANSI filename to pass to some dumb component that can&#39;t handle Unicode properly. We can wish all we want but the dumb components won&#39;t go away and we&#39;ll still find times when we need to interface with them.</p>
<p>Some very successful, ubiquitous components/technologies are incredibly poorly written&#8230; I&#39;m not sure MS or Windows would look good, even to developers, if it took away the tools that help us work around other people&#39;s stupidity.</p>
<p>And most of the time you can forget the short names exist. They don&#39;t cause many problems. The only big problem I&#39;m aware of is the change-notification code in Windows randomly sending long or short names, including for deleted files (where if you didn&#39;t cache both names of every file you might care about being deleted you have no way to map the name you receive).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911453">
				<div id="div-comment-911453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911453">
			May 5, 2011 at 4:43 pm</a>		</div>

		<p>@Leo: Yeah, I&#39;ve used that to pass filenames with spaces to a component that didn&#39;t like them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911463">
				<div id="div-comment-911463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911463">
			May 5, 2011 at 4:44 pm</a>		</div>

		<p>@Leo: Yeah, I&#39;ve used short names to pass file names with spaces to components that didn&#39;t like spaces in filenames.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911473">
				<div id="div-comment-911473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Sowul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911473">
			May 5, 2011 at 5:25 pm</a>		</div>

		<p>Short paths can also be used to get around MAX_PATH, so it probably isn&#39;t worth getting rid of them.</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/michkap/archive/2006/12/13/1275292.aspx" rel="nofollow">blogs.msdn.com/&#8230;/1275292.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911483">
				<div id="div-comment-911483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911483">
			May 5, 2011 at 5:57 pm</a>		</div>

		<p>Nine paragraphs in that blog entry and only ten instances of the word &quot;asinine&quot;?!</p>
<p>C&#39;mon, we can inspire more than that! (It&#39;s Friday where I live :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-leo-davidson even thread-even depth-1" id="comment-911433">
				<div id="div-comment-911433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Leo+Davidson' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911433">
			May 5, 2011 at 3:32 pm</a>		</div>

		<p>Native 64-bit code still needs to pass filenames to 32-bit programs, some of which may require short names.</p>
<p>It would be ridiculous if 64-bit apps had *more* things hidden from, and *fewer* abilities, than their 32-bit counterparts on a 64-bit OS. And the short names would still be there so what would you be solving, exactly? Nothing. You&#39;d just be making life harder for people compiling 64-bit code, and forcing people to proxy out to 32-bit processes more often than they already have to.</p>
<p>Unless you&#39;re starting fresh with a whole new OS, I can&#39;t see short names going anywhere, sadly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911513">
				<div id="div-comment-911513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911513">
			May 6, 2011 at 3:21 am</a>		</div>

		<p>Short names are disabled by default on SBS 2008. (I don&#39;t have access to any other comparable versions.) And yes, we have customers who want to be able to launch DOS applications from network paths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911523">
				<div id="div-comment-911523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911523">
			May 6, 2011 at 5:47 am</a>		</div>

		<p>I&#39;m not sure how DFS works, but I would assume that using a combination of 32-bit volume ID and 64-bit file ID would work to detect duplicate DLLs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911613">
				<div id="div-comment-911613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911613">
			May 6, 2011 at 9:13 am</a>		</div>

		<p>Will this be fixed in time for 128-bit windows or do we have to wait for 256-bit windows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-911663">
				<div id="div-comment-911663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Dietz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911663">
			May 6, 2011 at 9:50 am</a>		</div>

		<p>Short name generation can be disabled in the NTFS file system. &nbsp;Its a good test to run in fact before shipping any application. &nbsp;Install it without short names. &nbsp;If it doesn&#39;t work, you are in fact being asinine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-911743">
				<div id="div-comment-911743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/stikves_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>stikves@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110505-00/?p=10733#comment-911743">
			May 7, 2011 at 1:10 am</a>		</div>

		<p>@Joe Dietz: What about the components yo use? Will you be willing to replace/rewrite them if they depend on sfn functionality?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>