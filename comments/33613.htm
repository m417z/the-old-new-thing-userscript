<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (100)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-315833">
				<div id="div-comment-315833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315833">
			October 26, 2005 at 10:05 am</a>		</div>

		<p>I would replace the animation with a picture of a finger flying across the screen pulling a banner that reads.</p>
<p>&quot;You buy software made by morons.&quot;</p>
<p>Now forgive me while I go change some in house software that did this very thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315843">
				<div id="div-comment-315843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315843">
			October 26, 2005 at 10:08 am</a>		</div>

		<p>Wow &#8230; the lengths for compatibility. Here is a question; what factors go into deciding whether an app will be flagged in the user&#8217;s face at Vista install time as incompatible? Or when the app installs later? For example, if you install SQL 2000 on Win2003, it warns you. Perhaps this is in order? Otherwise, sigh, keep the old animation. Or dumb it down like you did the icons.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315853">
				<div id="div-comment-315853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315853">
			October 26, 2005 at 10:09 am</a>		</div>

		<p>The most backwards-compatible solution, of course, would be to just leave the old animation in there. I suspect that&#8217;s what you&#8217;d end up doing.</p>
<p>So, what&#8217;s the documented way to display the system&#8217;s file copy animation? Is it easy to find?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315863">
				<div id="div-comment-315863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315863">
			October 26, 2005 at 10:15 am</a>		</div>

		<p>Ooh, I know, it&#8217;s the file copy animation for SpyBot when it checks for updates!  I need a hobby.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rosyna even thread-even depth-1" id="comment-315873">
				<div id="div-comment-315873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rosyna</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315873">
			October 26, 2005 at 10:15 am</a>		</div>

		<p>Sometimes I wonder what is being sacrificed for the sake of compatibility with third party developers using completely undocumented methods of doing things. Especially since it creates code paths that can not be tested any longer.</p>
<p>Anywho, my suggestion is that you return an ugly, 2-bit international NO symbol for any resource that doesn&#8217;t exist. Although the program will not crash, it will be obvious that there is something wrong and it means you&#8217;d only have to encode the ugly NO once.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rosyna odd alt thread-odd thread-alt depth-1" id="comment-315883">
				<div id="div-comment-315883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rosyna</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315883">
			October 26, 2005 at 10:17 am</a>		</div>

		<p>Bah, forgot something. I also strongly suggest that if so many people need these animations, make a public, supported, well-rounded API for doing this (if one doesn&#8217;t exist already).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315893">
				<div id="div-comment-315893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zabkat.com' rel='external nofollow' class='url'>nikos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315893">
			October 26, 2005 at 10:17 am</a>		</div>

		<blockquote><p>
  So, what&#8217;s the documented way to display<br />
  <br />&gt; the system&#8217;s file copy animation</p>
<p>answer: there isn&#8217;t any!<br />
  <br />so ms has to share the blame for what&#8217;s going on with current programs</p>
<p>on the same topic, ms have in the past (a bit grudgingly) &quot;documented&quot; some shell stuff as part of the settlement with US anti-monopoly &#8230; thingy whatever it&#8217;s called :)</p>
<p>many of these functions/API cary the disclaimer &quot;this works for the current windows but may stop working in a future version&quot;</p>
<p>raymond, are you planning any articles on this topic? Exactly what will stop working in Vista, especially shell related?</p>
<p>thanks
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315903">
				<div id="div-comment-315903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315903">
			October 26, 2005 at 10:20 am</a>		</div>

		<p>The sad part is that these vendors probably thought they were doing the right thing.  By reaching into the a DLL to get an icon or animation rather than making their own, they probably figured they would always appear up-to-date with the latest look and feel changes.</p>
<p>I say break them.  If it&#8217;s a vendor that doesn&#8217;t exist anymore, c&#8217;est la vie.  If it&#8217;s Game of the Year and a popular spyware program, they&#8217;ll issue updates, and learn that they committed a no-no.</p>
<p>Another idea would be to offer to ship the patches for these vendors with the Vista CDs.  When a user upgrades a machine to Vista, it can check to see if it has patches for any of the installed programs and offer to apply them.  That may sound complicated and expensive&#8211;it probably is&#8211;but so is having layers of backward compatibility shims adding complexity to the Windows code base over time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315923">
				<div id="div-comment-315923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.kryogenix.org/' rel='external nofollow' class='url'>Stuart Langridge</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315923">
			October 26, 2005 at 10:29 am</a>		</div>

		<p>The option of adding a &quot;backwards-compatibility icon&quot; which is blank seems to follow through quite neatly into other areas, like the shell32.dll animation. That seems to strike the balance well between wanting to keep apps working (and avoid the &quot;MS broke my apps!&quot; shriek) and not wanting to encourage people to rely on bad behaviour. It might be better to do something other than blankness, though, since blankness doesn&#8217;t immediately mean &quot;wrong&quot;, it just means &quot;something odd is going on&quot;. While I wouldn&#8217;t recommend having a &quot;coded by morons&quot; flag, and obviously you wouldn&#8217;t take that solution seriously, perhaps something akin to the &quot;broken image&quot; icon? So when the app&#8217;s manufacturers test it (!) on Vista they&#8217;ll note the problem, but it doesn&#8217;t kill their app and annoy them and their customers.</p>
<p>One other thing, and this is where you laugh hysterically because I don&#8217;t know what I&#8217;m talking about; can you make shell32.dll not include the animation but instead load another DLL (in AppPatch or similar) if something tries to use it? So shell32 isn&#8217;t bulked up with a backward compatibility patch? Like I say, this is probably totally impossible and ridiculous, but be gentle with me, I&#8217;m a web guy. :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315933">
				<div id="div-comment-315933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315933">
			October 26, 2005 at 10:38 am</a>		</div>

		<p>OK, the vendors have no excuse for this &#8212; everybody knows you should just copy the icon/animation if it&#8217;s not documented!</p>
<p>I say you teach them a lesson. Keep the animation there, but make it look really stupid. Like make the files dance instead of elegantly float.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315943">
				<div id="div-comment-315943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315943">
			October 26, 2005 at 10:47 am</a>		</div>

		<p>If icon resources are supposed to be private implementation details, why does Windows Explorer (and previously Program Manager) allow users to select shortcut icons from arbitrary files?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315953">
				<div id="div-comment-315953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Almost Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315953">
			October 26, 2005 at 10:59 am</a>		</div>

		<p>&quot;Should we declare these programs broken and make the people who bought them go back to their vendors for upgrades?&quot;</p>
<p>Yes.  Ok, maybe not.  But it&#8217;s not a bad idea really!</p>
<p>&quot;What if there is no vendor?&quot;</p>
<p>Then the app is perminently dead.  So sad.  Programs do not have to survive forever.</p>
<p>&quot;Should we carry the original animation in shell32.dll as junk?&quot;</p>
<p>No.  Make it blank.</p>
<p>&quot;If I told you that one of the programs that did this won &quot;Game of the Year&quot; recently, would that change your answer?&quot;</p>
<p>a) They will release a patch.<br />
<br />b) Someone at the game company is going to get a good talking to.</p>
<p>&quot;What if another turned out to be a top-rated anti-spyware program?&quot;</p>
<p>a) They will release a patch.<br />
<br />b) Someone at the game company is going to get a good talking to.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315963">
				<div id="div-comment-315963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315963">
			October 26, 2005 at 11:01 am</a>		</div>

		<p>Give us a standard API to load system resources! give us standard save/open/copy/paste/print/etc. icons, standard animations, etc.!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315973">
				<div id="div-comment-315973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315973">
			October 26, 2005 at 11:02 am</a>		</div>

		<p>Well, give us a standard API to load (and customize!) system resources, then. Like standard toolbar icons, standard animations, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315983">
				<div id="div-comment-315983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">michkap</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315983">
			October 26, 2005 at 11:10 am</a>		</div>

		<p>Mike Gunderloy once used an animation of a small piglet flying out of a pair of buttocks (to help symbolize the feeling that a particular program would only work when pigs flew out of our butts). That would teach people, putting in an animation like that!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis odd alt thread-odd thread-alt depth-1" id="comment-316013">
				<div id="div-comment-316013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316013">
			October 26, 2005 at 11:22 am</a>		</div>

		<p>Microsoft introducing bugs and anomalies into Windows is an excellent way for us software vendors to persuade people to carry on paying their support subscriptions.<br />
<br />I would cite (in recent months): the disabling of access to help files held on a network file server; the setting of the Kill bit for PSDispatch (that object is needed for Windows Scripting to work); and a change in file sharing that caused programs for older versions of Windows to complain that the SHARE command needed to be run.<br />
<br />The nice thing is that Windows Update installs these bugs automatically so we don&#8217;t have to worry about some users not needing our help.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316023">
				<div id="div-comment-316023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.gibixonline.com' rel='external nofollow' class='url'>Gibwar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316023">
			October 26, 2005 at 11:23 am</a>		</div>

		<p>I have to agree with some of those above comments&#8230; its time to start moving forward faster and stop supporting programs that don&#8217;t have vendors anymore. With any luck, there will already be a newer and better program to take its place.<br />
<br />I also agree with the replacing of the images with one catch-all &quot;No&quot; symbol &#8211; something along those lines&#8230; its time developers started following the rules rather than snooping around and getting into undocumented stuff.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis odd alt thread-odd thread-alt depth-1" id="comment-316033">
				<div id="div-comment-316033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316033">
			October 26, 2005 at 11:29 am</a>		</div>

		<p>To answer your question, though: if the programmer was doing something in an undocumented way when a documented way existed then do what you can to keep compatibility (or at least avoid crashes) but don&#8217;t bust a gut doing it.<br />
<br />But if the programmer had to do something in an undocumented way because no documented way existed, then work night and day to keep compatibility, and if you can&#8217;t make a future version of Windows compatible, cancel that version of Windows.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316043">
				<div id="div-comment-316043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sandy WIlbourn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316043">
			October 26, 2005 at 11:32 am</a>		</div>

		<p>Okay, if I understand it, Vista isn&#8217;t a released product yet. In that case, I would go back to the vendor and indicate that they should change the behavior.  That gives them fair warning.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316053">
				<div id="div-comment-316053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316053">
			October 26, 2005 at 11:33 am</a>		</div>

		<p>In this situation, what is the right thing to do? Is it legal to copy the animation used by the shell and include it as a resource within the application? Doesn&#8217;t seem like it to me, even though everyone rips off the XP icons for their own websites and reuses them. At least in this case using undocumented resources in your application doesn&#8217;t seem as illegal even if the end result is the same: presenting someone else&#8217;s work as your own. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316073">
				<div id="div-comment-316073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ytram</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316073">
			October 26, 2005 at 11:48 am</a>		</div>

		<p>&quot;I am a developer, not an artist. My file copy animation attempts are not fit for public consumption. &quot;</p>
<p>I never said that YOU should make it personally.  That&#8217;s why God made graphic artists.  As for consistency, I would say to feel free to copy the dialog, but don&#8217;t access it in a way that is not documented, and therefore may be changed without notice.</p>
<p>As far as I&#8217;m concerned, it&#8217;s just as bad as hard-coding a path to a file that exists, and you  just keep assuming it&#8217;s going to be there for every new version.  You wouldn&#8217;t do that, so why would you hard-code to the resource in a DLL?  (I am of course referring to undocumented resources, it should be safe to assume documented resources will continue to be available, and that microsoft should bust their ass to always make it available in future releases).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316083">
				<div id="div-comment-316083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">raduking</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316083">
			October 26, 2005 at 12:18 pm</a>		</div>

		<p>The problem with icons is that there&#8217;s no straight forward way of getting a shell icon for a file type given the size wanted&#8230; there&#8217;s always the shell size and icons look pixelated even though my dll provided all sizes including 256&#215;256&#8230;</p>
<p>IExtractIcon just doesn&#8217;t work as it should, so that&#8217;s one reason why a lot of developers just loaded the icons directly from DLLs&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316093">
				<div id="div-comment-316093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316093">
			October 26, 2005 at 12:19 pm</a>		</div>

		<blockquote><p>
  &gt; Another idea would be to offer to ship the patches for these vendors with the Vista CDs. When a user upgrades a machine to Vista, it can check to see if it has patches for any of the installed programs and offer to apply them.</p>
<p>From my experience, most people do a clean install of the new OS instead of an upgrade install.  So if you did patch misbehaving programs, you couldn&#8217;t just do it at install time, you&#8217;d have to keep something around to monitor every program that&#8217;s installed to see if it needs patched.  That&#8217;s more gunk in the system than just leaving the animation in would be.  :)</p>
<p>But I say, do what Apple does:  If the program&#8217;s undocumented, break it.  If you need to run a big PR campaign to tell people why their software doesn&#8217;t work, do.  PLEASE do SOMETHING to fix the horrible, horrible quality of the average Windows application, though!  Anything!
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-316103">
				<div id="div-comment-316103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316103">
			October 26, 2005 at 12:21 pm</a>		</div>

		<p>1) Come up with an API for accessing animations of this kind.</p>
<p>2) Inform the vendors of the new API.</p>
<p>3) Break the apps with a clear conscience.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316113">
				<div id="div-comment-316113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316113">
			October 26, 2005 at 12:22 pm</a>		</div>

		<blockquote><p>
  I&#8217;m not sure what we&#8217;re going to do about the animation resource problem. Suggestions anyone?</p>
<p>Simple &#8211; keep the pre-Vista animations in their original locations, using the original compression schemes. Put the new animations in separate locations.</p>
<p>Sure, you&#8217;ll &quot;waste&quot; a few KB by including two versions of the animations. But considering the average Vista PC will probably have 1 GB of RAM, does it matter?</p>
<p>&gt; Should we develop a shim and hope that those four are the only programs that need it?</p>
<p>There are definitely more than four &#8212; and I&#8217;m just going by the programs I&#8217;ve seen with my own eyes.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316133">
				<div id="div-comment-316133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316133">
			October 26, 2005 at 12:38 pm</a>		</div>

		<p>The sad thing here is that Microsoft creates these nice user interface widgets but then doesn&#8217;t bother making them available to developers, forcing the developers to either waste time trying to recreate them (and match the Microsoft &quot;standard&quot;) or else hack into the Microsoft implementation.</p>
<p>Microsoft that needs a &quot;widget czar&quot; that watches for icons, animations, menus, controls, etc. in operating systems and major products (especially Office) and makes sure that these are properly and &quot;officially&quot; exposed to developers.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316143">
				<div id="div-comment-316143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wang-Lo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316143">
			October 26, 2005 at 12:38 pm</a>		</div>

		<p>&quot;Should we carry the original animation in shell32.dll as junk?&quot;</p>
<p>Yes.  This is the philosophy that made Microsoft Windows the most commercially successful software product in history.  It is way too late to start thinking about a clean architecture now.</p>
<p>-Wang-Lo.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316183">
				<div id="div-comment-316183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lpetr.org/blog/' rel='external nofollow' class='url'>Leons Petrazickis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316183">
			October 26, 2005 at 12:53 pm</a>		</div>

		<p>} If it&#8217;s Game of the Year and a popular spyware program,<br />
<br />} they&#8217;ll issue updates, and learn that they committed<br />
<br />} a no-no.</p>
<p>If a Game of the Year is using a file copy animation, it&#8217;s probably doing so in its installer. Installers tend to come on write-only media, and are accordingly hard to patch.;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316193">
				<div id="div-comment-316193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">â—‹</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316193">
			October 26, 2005 at 12:55 pm</a>		</div>

		<p>The real problem is that it seems that any program is an abusing bunch of stuff in the eyes of the author, except for the programs he wrote himself of course.</p>
<p>Fact is, most applications used that animation because there was no documented way to do that without redesigning the animation yourself (no you cannot copy it without going into licensing issues). So the solution is to use some article you find on the net (probably even on MSDN) which tells you how to do that. You can cry out loud about abusive applications developers all the time you want, but it&#8217;s your fault for having some thing which does not have an API. </p>
<p>All this except of course Microsoft applications which have neither the undocumented nor the licensing problem.</p>
<p>These articles about how third party software is bad and forces us to adapt are getting boring.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316203">
				<div id="div-comment-316203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frederik Slijkerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316203">
			October 26, 2005 at 1:00 pm</a>		</div>

		<p>It should be possible to create a dummy animation that a) is really small and b) shows that something is not quite right, and put that in shell32.dll as a replacement.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jeff-parker even thread-even depth-1" id="comment-316223">
				<div id="div-comment-316223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316223">
			October 26, 2005 at 1:07 pm</a>		</div>

		<p>Well my vote on this would maybe create a dll with animations and stuff for developers to use. Kind of like the Icons that comes with Visual studio, While the icons are kind of lame and if you want something better then you need to create your own they are a nice handy way to get this kind of thing. So create a library, and not a huge library or common things like animations, icons and stuff for developers to use and then make it well known. Spyware guys and so on are always going to try to dig into the system32. Thier software changes weekly to try to avoid detection. In reality I would love to see a breaking change to spyware. Game of the year, those developers should have known better. But due to backwards compatability I think you have to leave that in there hence leaving more people to complain about code bloat but I would change it to a lower res or slightly different. But I would come up with a common resource library for developers to use and document it well. </p>
<p>One of the things us developer do to make our apps acceptable to the users is follow the Microsoft Design guidlines which even Raymond has posted back to. When those designs change over the years <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2004/07/28/199589.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/07/28/199589.aspx</a> We hope that the changes in the Microsoft culture reflect automatically in our own apps.</p>
<p>Also I noticed a comment I made back in another of Raymonds post where he was point out the windows design specs is <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2004/07/29/200653.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/07/29/200653.aspx</a> I think that is why game of the year might be game of the year. They didn&#8217;t try to reinvent the wheel, they realized, windows was doing something and they just wanted to reuse it. Apps that totally try to reinvent the wheel usually fall flat on thier face because users are confy in going app to app seeing a familiar UI. There are a few exceptions though like <a rel="nofollow" target="_new" href="http://downloads.theregister.co.uk/Windows/Utilities/Launchers/jet-toolbar.html" rel="nofollow">http://downloads.theregister.co.uk/Windows/Utilities/Launchers/jet-toolbar.html</a> Jet tool bar I think is much better than windows start bar. Again though only my opinion on that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-316233">
				<div id="div-comment-316233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316233">
			October 26, 2005 at 1:09 pm</a>		</div>

		<p>::looks at feet::</p>
<p>Guilty as charged.  My setup program uses the SysAnimate control, displaying the file copy animation for intallation, and the file delete animation for uninstallation.  I guess this serves as fair warning that I may need to change my app for Vista.</p>
<p>I guess there&#8217;s no reason to not use private copies &#8212; in total, the two animations are just 28 KB.  (I believe some editions of Visual Studio include the animation files.)  It just means potentially less consistency with Windows, depending on their version.</p>
<p>Hopefully, if the resources aren&#8217;t there, the SysAnimate control will degrade gracefully, so the worst that would happen is no animation showing.  If that&#8217;s all that happens, then &quot;breaking&quot; apps is surely the way to go.</p>
<p>If the resources are there and but using a new compression scheme&#8230; well, hopefully the SysAnimate control is being updated to support the new compression scheme.</p>
<p>(To jd regarding a &quot;widget czar&quot; &#8212; hear hear! That would be awesome.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316253">
				<div id="div-comment-316253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316253">
			October 26, 2005 at 1:14 pm</a>		</div>

		<p>To all of the people saying that old applications should die, please bear in mind that there&#8217;s a lot of custom-developed software out there in the business world that was made by some overpaid consultant five or ten years ago but continues to do its job. The company using the software has no desire to pay again to have it altered, and so their only recourse is not to upgrade to Windows Vista.</p>
<p>With all that said, I think a good compromise would be to make a smaller version of the animation which perhaps skips some frames or whatever and include that in the place of the old video resource. Of course, this assumes that there are no applications out there relying on the video being a certain framerate or having a certain number of frames, and it wouldn&#8217;t surprise me to find that assumption invalid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316273">
				<div id="div-comment-316273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.fleeb.com' rel='external nofollow' class='url'>Trey Van Riper</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316273">
			October 26, 2005 at 1:30 pm</a>		</div>

		<p>I like Jeff Parker&#8217;s idea, except instead of a DLL somewhere, I think it would make more sense as a new API of some kind.</p>
<p>Why?</p>
<p>Well, it might be nice for users to be able to set up &#8216;themes&#8217; for these sort of things, so that (for example) the file copy animation could be customized (maybe even for an OEM).</p>
<p>If you do this via DLL, you can&#8217;t as easily or flexibly alter or extend the visual element in question.</p>
<p>Downside, of course, is that it might require a lot more work than a simple DLL.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316283">
				<div id="div-comment-316283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thespoke.net/blogs/travisowens/' rel='external nofollow' class='url'>Travis Owens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316283">
			October 26, 2005 at 1:32 pm</a>		</div>

		<p>I totally feed into the whole &quot;we need backward compatibility&quot; and the &quot;no junk&quot; mantras.</p>
<p>I say take the middle group and impliment an empty animation, even if it&#8217;s a static image that says &quot;copying&quot;.</p>
<p>Considering 2 of the 4 programs are highly visible/popular apps even more reason to at least support it.  Keep in mind, the average person is going to run the bits from the CD, they aren&#8217;t going to patch and reburn their game so hoping the vendor fixes their coding mistake (on an old game, good luck!) is pointless.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316293">
				<div id="div-comment-316293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://amotif.blogspot.com' rel='external nofollow' class='url'>amotif</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316293">
			October 26, 2005 at 1:38 pm</a>		</div>

		<p>Breaking old apps&#8211;or declaring them broken&#8211;in Vista makes Vista a less valuable platform and increases consumer resistence to upgrading to Vista. Some would label that &quot;bad.&quot;</p>
<p>Or have I simplified too much? :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316303">
				<div id="div-comment-316303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scot Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316303">
			October 26, 2005 at 1:45 pm</a>		</div>

		<p>Change Vista&#8217;s DLL to Shell64 and leave Shell32 alone?</p>
<p>Oh, and make the animations in Vista available through a public API so people don&#8217;t steal them?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316313">
				<div id="div-comment-316313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.rblevin.net/podcasts.xml' rel='external nofollow' class='url'>RBL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316313">
			October 26, 2005 at 1:53 pm</a>		</div>

		<p>I&#8217;ve always used the resources, GUI and otherwise, included with the IDE. When I needed an aninated icon or other trendy GUI candy, I used those that shipped with the IDE, or bought a third-party resource.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316323">
				<div id="div-comment-316323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Carlos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316323">
			October 26, 2005 at 2:07 pm</a>		</div>

		<p>Various people have grumbled that there&#8217;s no documented way of doing this.  In fact, the animations can be found here:<br />
<br />C:Program FilesMicrosoft Visual Studio .NET 2003Common7Graphicsvideos</p>
<p>The &quot;ooh but I wanted to get new animations automatically&quot; argument is very weak.  If MS updated the UI, the chances of the animation being even the same size were pretty slim.</p>
<p>But my vote is don&#8217;t break the apps.  Make them ugly.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316353">
				<div id="div-comment-316353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">&#176;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316353">
			October 26, 2005 at 2:41 pm</a>		</div>

		<p>Various people have grumbled that there&#8217;s no documented way of doing this. In fact, the animations can be found here:<br />
<br />C:Program FilesMicrosoft Visual Studio .NET 2003Common7Graphicsvideos </p>
<p>Yes!! Of course everyone develops ONLY with VS.NET 2003. Just. Plain. Dumb.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316363">
				<div id="div-comment-316363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">&#176;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316363">
			October 26, 2005 at 2:43 pm</a>		</div>

		<blockquote><p>
  &gt; just extract the resource and use your own local copy</p>
<p>What is the license of that animation for a non VS.NET owner (which may be a mingw one or a paying Delphi one or C++ Builder or any other non-Microsoft product)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316373">
				<div id="div-comment-316373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.MichealTeper.com' rel='external nofollow' class='url'>Michael Teper</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316373">
			October 26, 2005 at 2:49 pm</a>		</div>

		<p>I can see both sides of the compatibility debate, and I would lean towards impairing w/o breaking (i.e. a NO animation).</p>
<p>What I really think MS should spend some time on is trying to figure out ways to prevent this sort of thing from happening going forward. I realize there will always be a way to dig into system code, but if that path can be made sufficiently difficult (and therefore VERY VERY OBVIOUSLY unsupported), it may be easier to make future decisions about breaking compatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316393">
				<div id="div-comment-316393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316393">
			October 26, 2005 at 3:38 pm</a>		</div>

		<p>&quot;What if there is no vendor?&quot;</p>
<p>Then the app is perminently dead. So sad. Programs do not have to survive forever.<br />
<br />===</p>
<p>Actually, some do.  There are programs and devices out there that are too expensive or useful to replace.  There&#8217;s been companies willing to pay big money to replace a 286 that died because it&#8217;s the system designed to run with a very expensive piece of hardware.</p>
<p>The solution, as I see it, is to figure out how to use virtual machines to easily run previous versions of the OS.  I have to wonder if it would be worthwhile to do so.</p>
<p>If you&#8217;re going to break compatibility to remove the bloat from the code (and add some OS-level security?), phase in the changes slowly over time like NT did.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316403">
				<div id="div-comment-316403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316403">
			October 26, 2005 at 3:46 pm</a>		</div>

		<p>My uneducated two cents: </p>
<p>1) So you look in the dll, you see a resource&#8230; how do you tell if it&#8217;s supported?</p>
<p>If the only way to discover that something is undocumented is to read the entirety of the documentation and find it&#8217;s not in there, then you will get this kind of problem with every single resource you ever include.</p>
<p>So if it&#8217;s possible, I&#8217;d say to mark all unsupported can-change-at-any-time resources as such, /by name/. So, &quot;file copy animation&quot; is not a suitable name for an unsupported animation. But &quot;file copy animation, internal use only&quot; is.</p>
<p>2) When a resource becomes deprecated, visually mark it as such. Make the animation display the animation grayed out, with text over it saying &quot;Deprecated animation, see MSDN article XYZ&quot;. Modify audio resources so that there is speech over the audio, saying something similar. Replace text resources with something similar. And so on.</p>
<p>It does not HAVE to be user friendly. It just needs a message they can type into google and find that the authors of their program screwed up. And it has to still work, just giving that warning without changing the program functionality in any way.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316433">
				<div id="div-comment-316433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316433">
			October 26, 2005 at 5:08 pm</a>		</div>

		<p>Text and speech need to be localized, and there&#8217;s no way MS will do that on animations and sound files.</p>
<p>Also realize that a) people whose programs don&#8217;t work when they upgrade Windows blame Windows, not the program. Thus MS gets a bad rep.</p>
<p>b) vendors don&#8217;t like to patch (especially games) because it costs them money to develop and distribute them</p>
<p>Inevitably I suspect this will have to end up like the shell folders registry key (kept forever because of bad programs!)</p>
<p>However I do agree that there should be documented ways to do everything that people end up doing through kludge.  I know you can&#8217;t anticipate everything, but past experience with situations like this should give you clues.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315913">
				<div id="div-comment-315913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spaces.msn.com/members/jdanielsmith/' rel='external nofollow' class='url'>J. Daniel Smith</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-315913">
			October 26, 2005 at 10:26 am</a>		</div>

		<p>Yes, what is the documented way?  I&#8217;m not sure there is one&#8230;</p>
<p>While I &quot;feel your pain&quot;, in this case (and others) I think it&#8217;s partly self-inflicted.</p>
<p>Everybody sees that copy annimation and thinks &quot;I&#8217;ll use that myself!&quot;.  But what if it changes? (folder colors, slightly different annimation, etc.) I don&#8217;t want to have to update that in *my* app&#8230;and what if it&#8217;s different on NT and XP?  Then I&#8217;ve got to maintain two annimation resources too.  It&#8217;s &quot;much easier&quot; just to grab whichever one the Shell is using.</p>
<p>You&#8217;ve got to assume that just about anything Microsoft wants to do in its applications (especially widely used ones like Office and Explorer) developers will also want to do in their apps.  So give them a documented solution from day-one or be stuck supporting the undocumented hacks.</p>
<p>Yes, I realize it&#8217;s not that simple as that&#8230;the code has to ship at some point.  That&#8217;s why it&#8217;s &quot;Software Engineering&quot;, not just &quot;Programming&quot; :-)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316453">
				<div id="div-comment-316453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://musingmarc.blogspot.com' rel='external nofollow' class='url'>Marc Brooks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316453">
			October 26, 2005 at 5:31 pm</a>		</div>

		<p>You should<br />
<br />A) Create a new ShellVista.dll with all the new stuff.<br />
<br />B) Change the Vista SDK link libraries to point people at ShellVista.dll<br />
<br />C) Create a shim Shell32.dll which has the identified resources and shim exports needed by all PreVista applications.</p>
<p>In otherwords, you should play be the same rules we have to :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316473">
				<div id="div-comment-316473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NBC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316473">
			October 26, 2005 at 5:47 pm</a>		</div>

		<p>i&#8217;d say break them :)<br />
<br />like win64 needs new drivers<br />
<br />and ship with a free virtual pc :p</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316493">
				<div id="div-comment-316493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">aran</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316493">
			October 26, 2005 at 6:13 pm</a>		</div>

		<p>I&#8217;d argue that the old programs shouldn&#8217;t break in any way. If it&#8217;s not technically infeasible, have the animation become something that fits with the Vista look and feel. Perhaps a version of the new animation in an XP format?</p>
<p>Stop thinking about business cases and proper corporate practices and proper programming practices and blame and who&#8217;s responsible for the mess&#8230; Instead, focus on the user experience. The user experience is using a program in Windows Vista with a Vista look and feel. End of story.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316003">
				<div id="div-comment-316003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ytram</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316003">
			October 26, 2005 at 11:19 am</a>		</div>

		<p>&quot;answer: there isn&#8217;t any!<br />
<br />so ms has to share the blame for what&#8217;s going on with current programs &quot;</p>
<p>Why should Microsoft be blamed for a third party using resources in an unintended, *undocumented* way?  If you want to use an animation, make it yourself!</p>
<p>Although, I do think that it is very courteous of MS to put in fixes so the programs at least function, I don&#8217;t think it&#8217;s anything more than that: a courtesy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316063">
				<div id="div-comment-316063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316063">
			October 26, 2005 at 11:39 am</a>		</div>

		<p>Ytram: &quot;Why should Microsoft be blamed for a third party using resources in an unintended, *undocumented* way? If you want to use an animation, make it yourself!&quot;</p>
<p>Well,<br />
<br />1. I am a developer, not an artist. My file copy animation attempts are not fit for public consumption.<br />
<br />2. I belive a consistent end user UI experience is good: For exactly the same reason that I (or any other developer) would choose to use the GetOpenFileName common dialog, I&#8217;d choose to use the standard file copy animation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316523">
				<div id="div-comment-316523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316523">
			October 26, 2005 at 7:18 pm</a>		</div>

		<p>Simple answer is to replace the icons and animations with something similar to the IE &quot;broken image&quot; icon.</p>
<p>That way, app developers will see that there is something wrong with their app.<br />
<br />And users will see it too and understand what it means.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-316243">
				<div id="div-comment-316243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316243">
			October 26, 2005 at 1:14 pm</a>		</div>

		<p>Jeff Parker &#8212; Raymond mentioned an *anti* spyware app, not spyware itself&#8230;</p>
<p>Regarding a DLL for animations &amp; stuff &#8212; Vista has a new dll called &quot;imageres.dll&quot; that contains new icons.  And there are some new functions in the Vista SDK shell header files that appear to be ways to load these new icons.  So maybe they can expand this to animations as well&#8230;</p>
<p>Well there&#8217;s always a chance. :-/</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis odd alt thread-odd thread-alt depth-1" id="comment-316543">
				<div id="div-comment-316543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316543">
			October 26, 2005 at 8:43 pm</a>		</div>

		<p>No-one is going to use Windows Vista &#8211; any more than anyone is currently using Windows XP. People use Windows, full stop. Anything more specific is technical mumbo-jumbo as far as they&#8217;re concerned.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316333">
				<div id="div-comment-316333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://gefvert.blogspot.com/' rel='external nofollow' class='url'>Mats Gefvert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316333">
			October 26, 2005 at 2:33 pm</a>		</div>

		<p>The downside with all of this &quot;let the apps break&quot; and &quot;they should have known better&quot; is that there&#8217;s a lot of people out there that doesn&#8217;t really actually *know* better; and finding all this information about what to do or what not to do in the tidal wave of API&#8217;s, fixes, articles, help files and blogs from Microsoft isn&#8217;t the easiest thing in the world &#8212; provided that you actually take time to sift through it all in the first place. For most of these &quot;secret Linux admirers but works in the Win32 world because everyone else does&quot;-programmers (like many of my colleagues), that&#8217;s mostly wishful thinking.</p>
<p>What will probably happen is that a lot of developers notice their programs just broke (again), and their response will typically not be &quot;oops, I must have done something wrong&quot;, but rather &quot;those darn *** at Microsoft changed it all again!&quot; Either way, MS gets the blame.</p>
<p>Not everyone reads Raymond Chen&#8217;s blog. It&#8217;s been a wakeup call for me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316343">
				<div id="div-comment-316343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris knott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316343">
			October 26, 2005 at 2:39 pm</a>		</div>

		<p>&gt; (I believe some editions of Visual Studio include the animation files.)</p>
<p>PatriotB has it right. Most of these were included in Visual Studio. </p>
<p>Even if you can&#8217;t afford Visual Studio (say you are using gcc and one of the free tool chains) and you just *have* to use the animation or icon, just extract the resource and use your own local copy.</p>
<p>*Sigh* laziness kills you every time.</p>
<p>IMHO, Vista will need a shim Shell32.dll.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316573">
				<div id="div-comment-316573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316573">
			October 26, 2005 at 10:57 pm</a>		</div>

		<p>My call will be: If the program won&#8217;t hang by the lack of icon, just let it be. Otherwise, mark the application in the incompatability list and call the software house to tell them release a new version that fix this.</p>
<p>Actually, what&#8217;s the &quot;Compatable with /Design for Windows whatever version&quot; label for if you can&#8217;t fail them because they&#8217;re using &quot;hacks&quot; that is never supported? I&#8217;ll agree that all &quot;supported&quot;/&quot;documented&quot; feature must not be broken, for anything else it&#8217;s the software house&#8217;s responsibility.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316583">
				<div id="div-comment-316583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316583">
			October 26, 2005 at 11:24 pm</a>		</div>

		<p>Here&#8217;s my take</p>
<p>1. Break it. Let vendors know about it, post a TID.</p>
<p>2. Create a new API. This has shown you there is need for one. rather than being annoyed by this example of vendors hacking, realize that it SHOWS you a speciic need.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316593">
				<div id="div-comment-316593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316593">
			October 26, 2005 at 11:32 pm</a>		</div>

		<p>Dewi Morgan:</p>
<p>    But why the resources are to be renamed? Aren&#8217;t &quot;Everything is undocumented unless it&#8217;s documented&quot; logical? If you don&#8217;t see it documented, make you own version or you risk it may not work in the future versions. I think this is fair.</p>
<p>    People are not supposed to &quot;steal&quot; features out of Windows unless it&#8217;s stated &quot;you can use it if you like&quot;. If your program enjoyed undocumented NT kernel functions, blame noone when you program broke when Microsoft later change it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316443">
				<div id="div-comment-316443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.guyswithtowels.com' rel='external nofollow' class='url'>Tim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316443">
			October 26, 2005 at 5:15 pm</a>		</div>

		<p>Ok, as I understand it:</p>
<p>[1] The animations are not in the DLL.<br />
<br />[2] Vista is not yet shipping.<br />
<br />[3] Hence the original animations (in the original format) could be put back in the DLL for compatibility reasons, using the original IDs (because Vista hasn&#8217;t shipped, so no hard-coded usage of these DLL/resource IDs exists in Vista).<br />
<br />[4] These animations are pretty small (yes?)<br />
<br />[5] Vista has monster system requirements.<br />
<br />[6] In conclusion, no-one will notice if you just put the animations back where they were.<br />
<br />[7] In summary, JFDI.</p>
<p>Am I missing something?  Or is it just the usual Microsoft &quot;implement some standard part of Shell/UI, and then don&#8217;t provide devs with a way to reproduce it in their apps if they want to be consistent?&quot; thing?</p>
<p>Job #1 would be to *learn* from this.  At the very least, all such resources should be available for devs to use just by downloading them from the MS site so they can use them if they want, without resorting to system hacks.  No need to buy VS.net/VC etc &#8211; just give them away.</p>
<p>In other words, don&#8217;t repeat this in Vista by implementing some fancy UI for a core feature (like *copying data*! gee, no program other than Explorer would *ever* want to do that, surely?) without providing a way for devs to use it too.</p>
<p>Or else just accept that people will hack around your new stuff too :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316603">
				<div id="div-comment-316603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matthew Jackson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316603">
			October 27, 2005 at 12:44 am</a>		</div>

		<p>Wow, just checking my favourite programming language, Delphi 7, Borland have been kind enough to provide a TAnimate control on the tool palate.  I have checked the source code for this control (which Borland also supply with their wonderful tools) and lo and behold, this control grabs the resource from shell32.dll when you use the one of the standard animations.  I am guessing that most programs with animations built using the Borland VCL will encounter this problem.</p>
<p>This is not the programmerâ€™s fault, rather the fault of Microsoft for not providing a standard API for these animations so that Borland could leverage this work and build it into its tools.</p>
<p>It goes to show that Microsoft should be very careful when they introduce new features to include APIâ€™s and documentation.</p>
<p>PatriotB is not right, not everyone uses Microsoft tools to develop windows applications, and hence do not have access to these resources.  These animations are the types of this that have become standard to represent common operations, and they should be provided by the OS.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316503">
				<div id="div-comment-316503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric E</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316503">
			October 26, 2005 at 6:25 pm</a>		</div>

		<p>All gripes aside, if the system was reorganized to have the animations removed, let that decision stay. If the vendor no longer exists, well, do you really want software not designed for Vista to run on Vista? I realize how vital compatibility is to Windows&#8217; adoption in many places, but this is Windows 6.0, not 5.3. Take a stand and show that Vista is the *new* Windows, not an upgraded Server 03 by any means. Of course, if you don&#8217;t already have an API for an app to use system animations, make one available. It will only help give Windows a visual coherency that will only be appreciated. </p>
<p>I understand your usual stance on compatibility, but in this case I would look forward arrogantly and leave these bugs to the vendor, extant or not. With Windows being the world-class software it is, it needs to look good too. Know why people like OS X so much? Well, look at it! Besides its technical features/accomplishments, it&#8217;s visually pleasing to use, and I believe MS is moving in the right direction to make Vista look like a 21st century OS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316613">
				<div id="div-comment-316613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316613">
			October 27, 2005 at 2:05 am</a>		</div>

		<p>On the flipside, how is Microsoft addressing this issue so it won&#8217;t happen again?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-316623">
				<div id="div-comment-316623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316623">
			October 27, 2005 at 2:44 am</a>		</div>

		<p>asdf: How do you propose preventing people from doing undocumented things? There was already a documented and supported mechanism (using the animations that came with Visual Studio), so &quot;provide a documented alternative&quot; already failed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316643">
				<div id="div-comment-316643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Nahr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316643">
			October 27, 2005 at 3:42 am</a>		</div>

		<p>There is no documented alternative! There would be if using Visual Studio was a requirement for developing a Windows application, but it&#8217;s not. And while I haven&#8217;t looked at the animations that came with VS 2003, I recall that its icons were ancient and ugly, compared to what Windows provided. If the animations were of a similarly low quality they were no real alternative anyway.</p>
<p>Those animations are a part of Windows, and it&#8217;s a very reasonable desire to use consistent animations for common tasks in your own applications. Consistency is one of the fundamentals of Microsoft&#8217;s own GUI guidelines, after all.</p>
<p>Usually I agree with blaming developers for using undocumented features, but not here.<br />
<br />In this case, the fault lies clearly with the OS team for failing to provide a public API to access those resources. You might as well expect developers to write their own Open File dialogs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316673">
				<div id="div-comment-316673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Big Stew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316673">
			October 27, 2005 at 5:55 am</a>		</div>

		<p>If Microsoft make changes to their OS, that break mis-behaving applications, users will see this as Microsoft&#8217;s fault. Infact it is the problem of the applications&#8217; developers, but users will normally unfairly blame MS first.<br />
<br />&quot;My_favourite_app worked in Window 2000, but now it doesn&#8217;t work in Vista. Therefore MS broke it&quot;. This is how people think.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316683">
				<div id="div-comment-316683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://hallvards.blogspot.com/' rel='external nofollow' class='url'>Hallvard Vassbotn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316683">
			October 27, 2005 at 6:17 am</a>		</div>

		<p>&quot;There was already a documented and supported mechanism (using the animations that came with Visual Studio), so &quot;provide a documented alternative&quot; already failed. &quot;</p>
<p>Eh &#8211; well, you know there are other development tools than Microsoft&#8217;s own, like Borland&#8217;s&#8230; </p>
<p>I agree with that the original problem here is the lack of an API to use the animations.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316693">
				<div id="div-comment-316693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">marcus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316693">
			October 27, 2005 at 6:30 am</a>		</div>

		<p>Hallvard: Although this might be nitpicking, the animations are actually included in most (if not all) of Borlands tools, atleast since Delphi 3. It&#8217;s actually even a VCL component.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316703">
				<div id="div-comment-316703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://runesbike.com/' rel='external nofollow' class='url'>Rune Moberg</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316703">
			October 27, 2005 at 7:55 am</a>		</div>

		<p>marcus: That was the gist of Hallvard&#8217;s comment.</p>
<p>For frontend applications (or probably any app that won&#8217;t benefit from Win64, seeing as Win64 sadly won&#8217;t be supported by blundering Borland until 2007), Borland Delphi is the <em>best</em> dev tool there is. VS doesn&#8217;t come close. Shame really that MS don&#8217;t use Borland tools (but rather hire their people instead).</p>
<p>Raymond&#8217;s suggestion that filecopy animations are included with VS (presumably a copy rather than loading the OS resource like Delphi does), misses the mark, because the goal is to use the OS&#8217; animation, not a copy of a legacy OS&#8217; animation! Vista users expect apps to use the identical animations as the shell uses.</p>
<p>I enjoy reading Raymond&#8217;s blog, but a general trend seems to be Raymond saying &quot;don&#8217;t do this&quot;, but then fail to come up with good suggestions on how to implement it properly. E.g. his entries concerning system dialog &#8212; so which font are we supposed to use? Searching MSDN for &quot;MS Shell Dlg 2&quot; returns some rather confusing documentation. (don&#8217;t worry, I&#8217;ll find the answer)</p>
<p>Sadly, this topic is certainly no exception. :(</p>
<p>&#8212;<br />
<br />Rune</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316733">
				<div id="div-comment-316733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316733">
			October 27, 2005 at 10:07 am</a>		</div>

		<p>&quot;My abstracting default look/feel graphics into a public API&#8230;&quot;</p>
<p>Heh&#8230; I meant &quot;By abstracting default look/feel graphics into a public API&#8230;&quot; Sorry. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316793">
				<div id="div-comment-316793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John C. Kirk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316793">
			October 27, 2005 at 11:58 am</a>		</div>

		<p>One aspect of this that nobody else has touched on yet: presumably the &quot;get video clip&quot; function returns an HRESULT (or similar), so a well-written program should test for failure rather than assuming success?</p>
<p>So, if the app does that test (and handles failure sensibly), removing the video clip shouldn&#8217;t cause any major problems. Conversely, if the app doesn&#8217;t do that test, then the programmers have done more wrong than just &quot;stealing&quot; the clip (opinions seem to vary on whether that&#8217;s good/bad), and should get less sympathy.</p>
<p>As for the specific question, I&#8217;d echo other people&#8217;s views &#8211; tell the companies about the problem, and replace the video with a less flattering one in Vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316803">
				<div id="div-comment-316803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reinder Verlinde</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316803">
			October 27, 2005 at 12:07 pm</a>		</div>

		<p>Michael Teper said:<br />
<br />&quot;I realize there will always be a way to dig into system code&quot;</p>
<p>I am not sure about that. I may be overlooking something, but I think one can do run-time enforcement of the &#8216;MS Windows&#8217;-other stuff layer by introducing two different kinds of entry point: public ones and &#8216;for internal use only&#8217; ones. A way to achieve that is as follows:<br />
<br />&#8211; digitally sign all Windows DLLs with a &#8216;made by Microsoft&#8217; key<br />
<br />&#8211; Introduce a &#8216;for MS internal use only&#8217; bit, either on a per-DLL basis or on a per-DLL entry point (function, resource, whatever) basis.<br />
<br />&#8211; Make the linker/loader obey that bit, by only allowing DLLs signed by  the &#8216;made by Microsoft&#8217; key to link with or load resources with the &#8216;for MS internal use only&#8217; bit.<br />
<br />&#8211; Allow only Windows Update to install DLLs signed by the &#8216;made by Microsoft&#8217; key<br />
<br />&#8211; Have the OS refuse to launch executables that are signed by the &#8216;made by Microsoft&#8217; key (side effect would be that the Windows team can guarantee that the Office team does not use any &#8216;side entry&#8217; into the OS) </p>
<p>Hacking around this would involve one of the following:<br />
<br />&#8211; have your installer toggle the &#8216;for MS internal use&#8217; bit in a DLL<br />
<br />&#8211; crack the &#8216;made by Microsoft&#8217; key, and sign your own DLLs with the key<br />
<br />I think it should not be hard too prevent either of those from happening accidentally. If someone does this on purpose, (s)he deserves his app to break on an update.</p>
<p>For extra safeguards, split the System32 directory into two: one with external entry points (for use by MS applications and third parties), and one with DLLs containing all &#8216;for MS internal use only&#8217; stuff, seriously locking the second one. You might want to introduce a third one for 3rd party DLLs.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-316833">
				<div id="div-comment-316833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316833">
			October 27, 2005 at 12:40 pm</a>		</div>

		<p>Reinder: Hacking around your proposal is much easier.<br />
<br />&#8211; parse the PE header of the DLL and extract the procedure address manually, then call it.</p>
<p>Windows 95&#8217;s kernel32.dll had a similar trick to prevent non-OS components from linking to the internal-only exports. It didn&#8217;t stop people for very long.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-316883">
				<div id="div-comment-316883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316883">
			October 27, 2005 at 1:53 pm</a>		</div>

		<p>John C. Kirk said: &quot;One aspect of this that nobody else has touched on yet: presumably the &quot;get video clip&quot; function returns an HRESULT (or similar), so a well-written program should test for failure rather than assuming success?&quot;</p>
<p>Documentation for the relevant window message is at: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/animation/messages/acm_open.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/animation/messages/acm_open.asp</a></p>
<p>The function &quot;returns nonzero if successful, or zero otherwise&quot;.  So, there is a way for a developer to test for failure.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-316933">
				<div id="div-comment-316933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316933">
			October 27, 2005 at 3:44 pm</a>		</div>

		<p>Bryan: Even if you isolate the internal functions, that internal DLL needs to talk to the &quot;external&quot; DLL through&#8230; an internal function! So the external DLL needs to expose an internal function anyway -&gt; You&#8217;re back where you started.</p>
<p>Even if you manage to keep internal functions out of the external DLL, an app doesn&#8217;t need to load the internal DLL directly. It can load an external DLL that in turn loads the internal DLL. Now the internal DLL is in memory as code and the app can call it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316723">
				<div id="div-comment-316723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316723">
			October 27, 2005 at 10:05 am</a>		</div>

		<p>Well, looks like I get to re-iterate what others have said.</p>
<p>1) Don&#8217;t break old apps &#8212; backwards compatibility is one of the major reasons why Windows maintains its dominance of the OS market. </p>
<p>2) Fix the *reason* behind the problem. Folks want their UI to be consistent with the newest/latest/greatest version of the OS. *Users*, I mean, not programmers. My abstracting default look/feel graphics into a public API that could be used by programmers, users can retain known visual cues like, say, the file copy animation, regardless of the program or the version of the OS being used. The overall effect is a better experience for the user, which can only help Microsoft in general. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316993">
				<div id="div-comment-316993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cooperpx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316993">
			October 27, 2005 at 6:48 pm</a>		</div>

		<p>The phrase &quot;It just works&quot; actually represents people going to great lengths to accomplish this task seemingly simple task.</p>
<p>Unfortunately, if your company uses the phrase and doesn&#8217;t go the distance, &quot;It JUST works&quot; is what you end up with.</p>
<p>My opinion is that [you] go the distance: Honor their original desire to keep their app looking up to date by replacing the resource with one that looks good and fits in with Vista&#8217;s Theme.</p>
<p>Then, I would draft up a Theme-like API for System Animations and Icons. Then I would draft up an internal API / File structure to load these resources from disk. It&#8217;s not anti-trust if you let people use the resource, but control how and when it&#8217;s used.</p>
<p>This solves the problem of today and tomorrow. And I would thank [you].</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316853">
				<div id="div-comment-316853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316853">
			October 27, 2005 at 1:17 pm</a>		</div>

		<p>But you have to load the DLL first, right?  (LoadLibrary or something similar.)  Otherwise the code won&#8217;t be there to run.  LoadLibrary could check the signed-status of the calling code.</p>
<p>Doing it in LoadLibrary would mean you&#8217;d have to separate internal-use functions and resources from external-use ones, and put the internal ones in a separate DLL.  At that point, the bit makes more sense if it&#8217;s put in the file header instead of per function.</p>
<p>Well, I suppose there&#8217;s still one way around it: if the program opens the file using the normal OpenFile/CreateFile/whatever APIs, and reads the data into memory, then tries to call the in-memory address.  But that *should* be preventable if the OS marks data pages non-executable (DEP on), and doesn&#8217;t let the program override that.  (If a program could override that, then so could malware if the user ran it directly, so it&#8217;s pretty pointless.)</p>
<p>This won&#8217;t prevent the EXE from using a resource &#8212; like an animation &#8212; though, because that&#8217;s just data.  Not sure how to get around that one; there may not be any technical way.</p>
<p>(This may raise other issues too &#8212; some people may take it as a monopolistic type of action.  They might claim that the office team, for instance, might be able to get its executables signed with this key, so they could use internal stuff, but outside developers (obviously) wouldn&#8217;t be able to do that.  Even though we&#8217;re proposing that only a small number of MS teams would be able to get their code signed, that may not be the perception in the outside world.  That&#8217;s a question for the MS legal people to look at, I think, not Raymond.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-316873">
				<div id="div-comment-316873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316873">
			October 27, 2005 at 1:23 pm</a>		</div>

		<p>And as for what Reinder said about not launching EXEs that have been signed at all &#8212; that may not be possible.  A stock Windows install stuffs in a lot of services that are contained in EXEs, and these are quite internal.  I am guessing that at least some of them would need access to the internal APIs.</p>
<p>cmd.exe *might* be another exception.  Explorer too, *possibly*.</p>
<p>Oooh, wait a minute.  If MS did this, it would force them to document any APIs or resources or whatever that Explorer, cmd, these services, and whatever else use.  This would remove the cause of this particular issue (because either the animation resource would be non-internal, or there&#8217;d be a non-internal way of getting at it, which Explorer would use).  So maybe it is possible.  (Whether that documentation would be possible is another issue, though.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-316983">
				<div id="div-comment-316983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotgeek.blogspot.com/' rel='external nofollow' class='url'>Duncan Bayne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-316983">
			October 27, 2005 at 6:32 pm</a>		</div>

		<p>&gt; What I really think MS should spend some time<br />
<br />&gt; on is trying to figure out ways to prevent<br />
<br />&gt; this sort of thing from happening going<br />
<br />&gt; forward. I realize there will always be a way<br />
<br />&gt; to dig into system code, but if that path<br />
<br />&gt; can be made sufficiently difficult (and<br />
<br />&gt; therefore VERY VERY<br />
<br />&gt; OBVIOUSLY unsupported), it may be easier to<br />
<br />&gt; make future decisions about breaking<br />
<br />&gt; compatibility.</p>
<p>You&#8217;re assuming that the cost will be identical for all developers, and I think you&#8217;re wrong in all but the initial case.</p>
<p>The cost for the first developer *will* be high.  He&#8217;ll likely be a hacker (let&#8217;s call him Hacker Fred) of the E.S.R. school, who enjoys fiddling with OS internals.  He&#8217;ll spend hours or days tinkering and testing, in order to make a particularly arcane undocumented API work the way he wants it to.</p>
<p>Once he&#8217;s done, Hacker Fred will post a blog article explaining in simple steps how he did what he did, because it&#8217;s &#8216;kewl&#8217; &#8230; without necessarily explaining why it&#8217;s bad, or what the limitations are.  That&#8217;s because he assumes that anyone using it would take the care to understand how it all works &#8211; or, perhaps, he just doesn&#8217;t care what it&#8217;d be used for &#8211; it was fun to do, and that&#8217;s what counts for him.</p>
<p>Then along comes Drone Joe, without the requisite skill or experience to understand exactly how Hacker Fred did what he did.  He  will see the article, think &quot;hey, that&#8217;s a cool trick&quot;, and implement it in his production code without giving it a moment&#8217;s more thought.</p>
<p>What Microsoft needs to do isn&#8217;t try to obfuscate the way DLLs work or APIs are named &#8211; but provide a clear set of documented APIs, and explain that using APIs outside the documented set is likely to cause problems with future releases of Windows.</p>
<p>Oh wait, it does just that already.</p>
<p>Really, this isn&#8217;t a problem caused by Microsoft, it&#8217;s a problem caused by unprofessional developers, but which Microsoft gets the blame for &amp; has to fix in order to maintain the fantastic reputation for backwards compatibility that Windows has achieved.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-317073">
				<div id="div-comment-317073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317073">
			October 28, 2005 at 4:45 am</a>		</div>

		<p>I&#8217;m curious about something.  I&#8217;m not a GUI programmer so animations are waaay out of my league.  I have seen several posts about how various animations are included with VS.NET 2003 in C:Program FilesMicrosoft Visual Studio .NET 2003Common7Graphicsvideos.</p>
<p>My question is &#8211; how would I, starting from pretty much zero knowlege, find out about those files and that location?  I can&#8217;t find anything in the MSDN included with VS.NET about it.  So unless I&#8217;m missing something (quite possible since I&#8217;ve only spent a few minutes looking), it seems to me that the animations included with VS.NET are also undocumented.  You just have to happen to stumble on them or have someone in-the-know tell you.</p>
<p>If I search for &quot;animations&quot; I get way to many hits.</p>
<p>A search on &quot;common animation&quot; gets me a close hit (out of 216) for &quot;Using an Animation Control (MFC)&quot; &#8211; but that doesn&#8217;t have a pointer to the actual location of the AVI files or even a hint that such a thing exists.</p>
<p>And finally, a direct search for the answer &#8211; &quot;common7 graphics videos&quot; &#8211; nets zero hits.</p>
<p>How exactly is this &#8216;documented&#8217; (leaving aside the question of trying this using non VS tools based only on the SDK)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-317103">
				<div id="div-comment-317103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317103">
			October 28, 2005 at 8:46 am</a>		</div>

		<p>mikeb &#8212; I googled for &quot;visual studio image library&quot;, and got this link:</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/ms247035.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/ms247035.aspx</a></p>
<p>It&#8217;s short, but directly to the point.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-317113">
				<div id="div-comment-317113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317113">
			October 28, 2005 at 9:00 am</a>		</div>

		<p>Hmm.  Raymond, you&#8217;re right, that would make it hard.  If it were possible, I think it&#8217;d be a pretty nice way around the issue.  But oh well, I suppose.</p>
<p>mikeb &#8212; I make it a habit to look around in the VS commonX directory whenever I install a new version of VS.  But that&#8217;s only because a few years ago, I happened to see some icons and bitmaps in there when I installed an older version of VS; if I hadn&#8217;t seen that, I wouldn&#8217;t know it existed.</p>
<p>Randolpho &#8212; is that only for VS.Net 2005 (beta only, I believe)?  I don&#8217;t see it in my VS.Net 2003.  It looks like a good thing to have, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-317123">
				<div id="div-comment-317123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317123">
			October 28, 2005 at 9:04 am</a>		</div>

		<p>Raymond, I understand that Microsoft has a large interest in keeping existing and prior customers happy, but it seems that Microsoft is also constantly getting beaten up by a second audience for the crufty hacks it has to implement to ostensibly appease the former.  Look at what Apple does.  It sells you a box that &quot;just works&quot;.  The price is that when supreme commander decides it should all work differently, out goes your box and you have to buy, essentially, new physical hardware and new software (yes I realize this is changing recently but go with me).  Now that has a lot of value to /new/ customers.</p>
<p>At some point I think Microsoft really needs to abandon backwards, arguably bug, compatibility.  Otherwise it risks stagnation.  It&#8217;s hard to innovate when you are chained to a mountain of history.  I for one would gladly accept intentionally, purposefully, and obnoxiously breaking applications that do Stupid Things &#8211; I may have to upgrade some apps (or use that as a reason to switch apps), but if this is not done, the responsibility of each app is just dispersed into the operating system.  I realize there are probably a lot of users of Microsoft software that will be unable to make a distinction, but I think at some point you just have to let it go.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-317413">
				<div id="div-comment-317413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317413">
			October 28, 2005 at 4:09 pm</a>		</div>

		<blockquote><p>
  &gt; Various people have grumbled that there&#8217;s no documented way of doing this.<br />
  <br />&gt; &gt; In fact, the animations can be found here:<br />
  <br />&gt; &gt; C:Program FilesMicrosoft Visual Studio .NET 2003Common7Graphicsvideos<br />
  <br />&gt;<br />
  <br />&gt; Yes!! Of course everyone develops ONLY with VS.NET 2003. Just. Plain. Dumb.</p>
<p>At a former employer, I wanted to use the file copy animation in one of our dialogs. My manager/boss wouldn&#8217;t let me just grab the animation from Shell32.dll (he said that if it wasn&#8217;t documented, it couldn&#8217;t be relied on), so I was about to remove it and redo the layout of my dialog when I discovered that the animation shipped on one of the Visual Studio 6 CDs, and was redistributable.</p>
<p>Incidentally, the same guy who stopped me from making this blunder fairly recently ported a device driver he wrote from 32-bit Windows to 64-bit Windows. Well, I say ported &#8212; he actually just recompiled it and it worked without modification. Following the documentation is the One True Way.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-317463">
				<div id="div-comment-317463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317463">
			October 28, 2005 at 7:54 pm</a>		</div>

		<p>Regarding some responses to how would I know about the VS animation library&#8217;s existence&#8230;</p>
<p>Randolpho: &gt;&gt; I googled for &quot;visual studio image library&quot;, and got this link &lt;&lt;</p>
<p>This seems like cheating a few ways:</p>
<p>   1) it seems like Googling after knowing the answer; I, for one, would probably have never thought to use those keywords<br />
<br />   2) I don&#8217;t find any hits for VS products before VS 2005, so you can hardly fault someone who developed something a couple of years ago from missing that document.<br />
<br />   3) If I search using those keywords in VS 2003 (using the July 2005 MSDN), I get 500 hits, which &#8211; at first glance anyway &#8211; are not helpful.  Do we have to rely on Google for documentation on programming for MS platforms?  Proabably not a bad idea in practice, but surely it shouldn&#8217;t be the definitive source.</p>
<p>On the other hand, this does now seem to be actually documented in VS 2005, as opposed to just some files that you might happen to stumble on. </p>
<p>Bryan: &gt;&gt; I make it a habit to look around in the VS commonX directory&#8230; &lt;&lt;</p>
<p>    This is surely a good idea, but is it &#8216;documentation&#8217;?</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-317553">
				<div id="div-comment-317553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xazzy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317553">
			October 29, 2005 at 2:09 am</a>		</div>

		<p>I think those that are going to be hit hardest are Borland Delphi users.  Included in the VCL is a component called TAnimate for displaying animated AVI&#8217;s.  One &quot;feature&quot; is a property called &quot;CommonAVI&quot; described in the documentation as:</p>
<p>&quot;Indicates whether the animation control displays a one of the common Windows AVI clips provided in Shell32.dll&quot;</p>
<p>I.e. by setting a single property you can display the Windows copy, deletion or other animation.</p>
<p>No indication is given in their documentation that they have accessed an undocumented Windows resource.</p>
<p>I&#8217;m sure many developers, like myself, assumed that Delphi was simply wrapping a standard windows control and such usage was quite valid.</p>
<p>I guess I will wait for Vista to see whether i need to implement a custom animation ;-)</p>
<p>For the record, I think it is obviously in everyone&#8217;s best interest that Windows provides a standard set of animations and graphics for reuse by developers, because:</p>
<p>&#8211; Apps will look more consistent with Windows<br />
<br />&#8211; Newer windows versions can improve the styling of the library and instantly give all applications a face lift<br />
<br />&#8211; Developers can spend more time improving their software rather than creating their own crappy looking animations<br />
<br />&#8211; Smaller downloads because extra resources are not included in the installer (less internet traffic)</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-edge odd alt thread-odd thread-alt depth-1" id="comment-317573">
				<div id="div-comment-317573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317573">
			October 29, 2005 at 5:59 am</a>		</div>

		<p>My vote is keep compatibility by keeping the old animations. For new animations/UI gimmickry, please be sure to provide an API so this situation can be avoided better in the future. =)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-317593">
				<div id="div-comment-317593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">video</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317593">
			October 29, 2005 at 2:05 pm</a>		</div>

		<p>Why are you removing codecs from windows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-317613">
				<div id="div-comment-317613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317613">
			October 29, 2005 at 3:34 pm</a>		</div>

		<p>The problem isn&#8217;t due to codec removal; quite the opposite. The Windows Vista animation uses a *new* codec that the old programs don&#8217;t support.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-317693">
				<div id="div-comment-317693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317693">
			October 30, 2005 at 3:59 pm</a>		</div>

		<p>I discussed the limitations of the SysAnimate control earlier this year: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/02/16/374397.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/02/16/374397.aspx</a></p>
<p>Remember also that there are multiple versions of the common controls library, so even if the version 7 common controls library supports the new codec, the old version 5&#8217;s still won&#8217;t.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-317703">
				<div id="div-comment-317703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317703">
			October 30, 2005 at 6:15 pm</a>		</div>

		<p>&lt;quote&gt;But if the programmer had to do something in an undocumented way because no documented way existed, then work night and day to keep compatibility, and if you can&#8217;t make a future version of Windows compatible, cancel that version of Windows.&lt;/quote&gt;</p>
<p>But there IS a documented way! Make your own animation. Oh, you want a documented way to get the MS animation? Well, there is no documented way for that since (drumroll) it is undocumented!</p>
<p>There are lots of ways to show animations in Windows. You can&#8217;t blame this on MS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-317713">
				<div id="div-comment-317713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317713">
			October 30, 2005 at 6:23 pm</a>		</div>

		<p>&lt;quote&gt;<br />
<br />There is no documented alternative! There would be if using Visual Studio was a requirement for developing a Windows application, but it&#8217;s not. And while I haven&#8217;t looked at the animations that came with VS 2003, I recall that its icons were ancient and ugly, compared to what Windows provided. If the animations were of a similarly low quality they were no real alternative anyway.<br />
<br />&lt;/quote&gt;</p>
<p>You may not LIKE the alternative. But it is there. And no-one said you couldn&#8217;t solve it another way (by getting animations from elsewhere).</p>
<p>&lt;quote&gt;<br />
<br />Those animations are a part of Windows, and it&#8217;s a very reasonable desire to use consistent animations for common tasks in your own applications. Consistency is one of the fundamentals of Microsoft&#8217;s own GUI guidelines, after all.<br />
<br />&lt;/quote&gt;</p>
<p>Think it through. If you apply this logic, MS could never change anything.</p>
<p>&lt;quote&gt;<br />
<br />Usually I agree with blaming developers for using undocumented features, but not here.<br />
<br />In this case, the fault lies clearly with the OS team for failing to provide a public API to access those resources.<br />
<br />&lt;/quote&gt;</p>
<p>They don&#8217;t provide one since THEY DON&#8217;T WANT YOU TO DO IT. How complex is this folks?</p>
<p>&lt;quote&gt;<br />
<br />You might as well expect developers to write their own Open File dialogs.<br />
<br />&lt;/quote&gt;</p>
<p>The fact remains, whether it was a good idea or not, they never said &#8216;YOU ARE ALLOWED TO DO THIS&#8217;. In fact, they said &#8216;DO THIS INSTEAD&#8217;.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-drpizza odd alt thread-odd thread-alt depth-1" id="comment-317723">
				<div id="div-comment-317723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dr+Pizza' rel='external nofollow' class='url'>Dr Pizza</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317723">
			October 30, 2005 at 9:08 pm</a>		</div>

		<p>&quot;Should we develop a shim and hope that those four are the only programs that need it?&quot;</p>
<p>If you develop a shim administrators and MS themselves can easily add applications to the &quot;need shimming&quot; list.  Shimming is the best solution by far.  The AppCompat database could be stuck on Windows Update and updated monthly or quarterly to add new fixes and expand the database of known fix requirements (in fact, I suspect that something like this is already done, as XPSP2, for example, has different AppCompat fixes than XP RTM).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-317663">
				<div id="div-comment-317663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317663">
			October 30, 2005 at 3:40 pm</a>		</div>

		<p>&quot;The Windows Vista animation uses a *new* codec that the old programs don&#8217;t support.&quot;</p>
<p>But, surely the SysAnimate control will support the new codec?</p>
<p>(I can understand that people who read the resource and try to interpret its bytes manually will run into problems, but if you merely pass the HINSTANCE and Resource ID to ACM_OPEN, I would hope that it would still work&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-317943">
				<div id="div-comment-317943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-317943">
			October 31, 2005 at 2:21 pm</a>		</div>

		<p>&quot;I discussed the limitations of the SysAnimate control earlier this year: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/02/16/374397.aspx&quot;" rel="nofollow"></a><a href="http://blogs.msdn.com/oldnewthing/archive/2005/02/16/374397.aspx&#038;quot" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/02/16/374397.aspx&#038;quot</a>;</p>
<p>There&#8217;s no reason those limitations can&#8217;t be lifted for Vista.  If Vista&#8217;s shell animations are now more complex, then the shell&#8217;s animation control should be upgraded to handle it.  (At least, that&#8217;s the way I would have done it.  Of course I&#8217;m not on the team so my opinion is just based on what I know/surmise :-)</p>
<p>&quot;Remember also that there are multiple versions of the common controls library, so even if the version 7 common controls library supports the new codec, the old version 5&#8217;s still won&#8217;t.&quot;</p>
<p>Dang.  Side-by-side is one of those things that seems good at the time, but here&#8217;s a classic example of where forward compatibility would be the way to go.  (Nick Kramer was just talking about this earlier today: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/nickkramer/archive/2005/10/31/487151.aspx" rel="nofollow">http://blogs.msdn.com/nickkramer/archive/2005/10/31/487151.aspx</a>)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-318183">
				<div id="div-comment-318183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-318183">
			November 1, 2005 at 6:37 pm</a>		</div>

		<p>PatriotB: Yikes! Whoever wrote that MSDN article should be given a really stern talking-to&#8230; It&#8217;s already broken in Windows Vista (no shdoclc.dll).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-318143">
				<div id="div-comment-318143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray Trent</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-318143">
			November 1, 2005 at 3:47 pm</a>		</div>

		<p>&quot;Aren&#8217;t &quot;Everything is undocumented unless it&#8217;s documented&quot; logical?&quot;.</p>
<p>Not really for a number of reasons. This line of reasoning is one of the things that gets Microsoft into trouble time and time again.</p>
<p>In fact, the way the world works is that developers will assume everything is documented unless you tell them it isn&#8217;t. Gigabytes of documentation will do that to you.</p>
<p>As counter-intuitive as this may seem, I think Microsoft needs to do a vastly better job of documenting which things are &quot;undocumented&quot;. </p>
<p>A prominant list of things not to count on staying there would go a long way. Then it would be *documented* that someone is breaking the rules and there would be significantly less angst over whether to just break them when those things do change. </p>
<p>Of course, at the same time, it would be polite to provide a hyperlink to documentation of an *alternate* way to achieve similar functionality, and/or documentation promising to break things only in particular ways in the future.</p>
<p>Actually, the word &quot;undocumented&quot; is itself a cowards way out. What they should call these features is &quot;unsupported&quot; or &quot;subject to change&quot;. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-318163">
				<div id="div-comment-318163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-318163">
			November 1, 2005 at 6:12 pm</a>		</div>

		<p>One MSDN article which has always intrigued me is &quot;WebBrowser Customization&quot; (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/workshop/browser/hosting/wbcustomization.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/workshop/browser/hosting/wbcustomization.asp</a>).  In it, it talks about loading strings and menus directly from SHDOCLC.DLL&#8211;doing stuff that surely isn&#8217;t kosher and surely won&#8217;t be the same with Vista.</p>
<p>&quot;The WebBrowser Control gets its shortcut menu resources from Shdoclc.dll. That knowledge and a few #defines gives you a chance to manipulate the browser&#8217;s menu&#8230;&quot;  Hmm&#8230; those #defines aren&#8217;t documented *any*where, except for that article.  If nothing else, this article encourages the kind of mucking around that this blog entry discourages.</p>
<p>That article is one that raises more questions than it answers.  How much other stuff is there that should be documented but isn&#8217;t?</p>
<p>Anyways, looks like this article is headed for the scrap heap with Vista&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-409873">
				<div id="div-comment-409873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/08/17/704232.aspx' rel='external nofollow' class='url'>The Old New Thing : Don't trust the return address, no really</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051026-44/?p=33613#comment-409873">
			August 17, 2006 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/08/17/704232.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/08/17/704232.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>