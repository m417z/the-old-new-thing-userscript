<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (21)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-koldude even thread-even depth-1 parent" id="comment-1282265">
				<div id="div-comment-1282265" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282265">
			February 2, 2017 at 7:15 am</a>		</div>

		<p>The source OS of Win2003 didn&#8217;t surprise me so much as the target. If you&#8217;re going to update a program to work on a new OS&#8230; why not just go to the latest? Going to an OS that is no longer in mainstream support seems counter-intuitive to me. I realize that there is always an issue of Time, Money, People in getting things ported&#8230; but still.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1282285">
				<div id="div-comment-1282285" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programmerman.net' rel='external nofollow' class='url'>Nick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282285">
			February 2, 2017 at 7:51 am</a>		</div>

		<p>If we&#8217;re very lucky, it&#8217;s because they&#8217;re taking small steps rather than one giant leap and that this is just the beginning of their modernization process. I doubt we&#8217;re that lucky though and look forward to the blog post in 2022 talking about migrating away from Windows Server 2008 R2 to Windows Server 2012 R2.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-koldude even depth-3" id="comment-1282286">
				<div id="div-comment-1282286" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282286">
			February 2, 2017 at 7:54 am</a>		</div>

		<p>Once you make it past Server 2008 you&#8217;ve already made the NT6.0 leap and that&#8217;s the big one. The rest shouldn&#8217;t be too hard in theory. Is it marginally more than NT6.1? Yes, but not enough to justify holding yourself back when the overall benefit is much larger. But I suspect you&#8217;re correct and they are doing this out of an overabundance of caution.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3 parent" id="comment-1282325">
				<div id="div-comment-1282325" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282325">
			February 2, 2017 at 8:39 am</a>		</div>

		<p>Porting an old version of our app form Windows Server 2003 to Windows Server 2008 R2 required exactly 1 hitpoint provided you were willing to turn UAC completely off. Windows Server 2008 R2 is the last OS on which you can do that reasonably without breaking too much.</p>
<p>We did eventually track down the UAC problems one by one. The final solution was don&#8217;t install in program files anymore to keep away from folder redirection. (Even that ancient version already didn&#8217;t require any privileges; however it still depends pretty hard on the classical model of filesystems, that is all programs see exactly the same version of the disk.) We were forced out of Program Files on Windows Server 2003 x64 for the same reason.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1282355">
				<div id="div-comment-1282355" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282355">
			February 2, 2017 at 10:22 am</a>		</div>

		<p>Yuck.  I would hate to have to rely on programs that don&#8217;t work well when things are installed in Program Files directory (or the x86 one). </p>
<p>I recently dealt with a program that wanted to install into the root of C, requiring a path with no spaces (and even documenting this fact, like &#8220;We don&#8217;t understand how to use paths properly and we can&#8217;t be bothered to learn&#8221;).  I decided not to use that program at all.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1282405">
				<div id="div-comment-1282405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282405">
			February 2, 2017 at 5:27 pm</a>		</div>

		<p>The problem *is* folder redirection. The program gets upset when it hands off files to other arbitrary programs and they can&#8217;t find them because they have manifests that result in different folder redirections. I asked for a flag I could set on a folder to exempt it (like registry has) and was refused.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-koldude even depth-4 parent" id="comment-1282456">
				<div id="div-comment-1282456" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282456">
			February 3, 2017 at 6:01 am</a>		</div>

		<p>Use handles, then folder redirection isn&#8217;t an issue? Regardless you&#8217;ll still have to deal with the problem. Moving things around is just delaying the inevitable, better to fix it properly now particularly since Server 2008 R2 only has 3 years of support left.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1282475">
				<div id="div-comment-1282475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282475">
			February 3, 2017 at 8:25 am</a>		</div>

		<p>Try convincing Microsoft and Adobe to make a way to open documents given a handle. Go ahead, just try it.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-4 parent" id="comment-1282675">
				<div id="div-comment-1282675" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282675">
			February 6, 2017 at 3:49 am</a>		</div>

		<p>How does (not) installing to Program Files affect folder redirection? System32 will be redirected to SysWow64 for 32-bit programs regardless of where they&#8217;re installed (there&#8217;s no redirection for Program Files), and folder virtualization only affects programs that don&#8217;t have Vista manifest.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1282895">
				<div id="div-comment-1282895" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282895">
			February 6, 2017 at 12:23 pm</a>		</div>

		<p>Easy. I don&#8217;t place any files in system32 or syswow64. Folder redirection works fine for OS-provided files.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1282296">
				<div id="div-comment-1282296" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282296">
			February 2, 2017 at 7:55 am</a>		</div>

		<p>My guess is they have a park of servers with different OS. The fact that Server 2003 is no longer supported is probably what is forcing them to upgrade that program. I&#8217;d guess they kept the old servers around for so long because that program would not run on newer versions. Now, they decided they have to face the music a figure out what was the source of the incompatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe85d3fad1 odd alt thread-odd thread-alt depth-1" id="comment-1282335">
				<div id="div-comment-1282335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Solimano' rel='external nofollow' class='url'>David Solimano</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282335">
			February 2, 2017 at 9:43 am</a>		</div>

		<p>I was once asked step in on a project to migrate a networking process written in C++ from a 2000 box to 2008. The process would always stop exchanging networking traffic after a few minutes on the new box.  Investigations revealed that the original programmer seemed to take MSDN&#8217;s &#8220;don&#8217;t do this&#8221; warnings as a best practices guide, and it wasn&#8217;t clear how the networking code worked at all, except by pure dumb luck.  At least it was easy to fix.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1282337">
				<div id="div-comment-1282337" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282337">
			February 2, 2017 at 10:19 am</a>		</div>

		<p>And the customer decided RECENTLY to move to Windows Server 2008 R2, which is also an older operating system?  There are newer server operating systems!  Server 2008 R2 has only about 3 more years of extended support; mainstream support has already ended. </p>
<p>They could have gone to Windows Server 2012&#8230;  if their programs would have run, that is.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1282346">
				<div id="div-comment-1282346" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282346">
			February 2, 2017 at 10:20 am</a>		</div>

		<p>&#8230; And, of course, there&#8217;s always Windows Server 2016&#8230; now that we are in the year 2017&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1282356">
				<div id="div-comment-1282356" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Topping</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282356">
			February 2, 2017 at 10:36 am</a>		</div>

		<p>If DDE messages are async, wouldn&#8217;t that be a reason to use them over WM_COPYDATA in applications where asynchronicity is desired?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1282365">
				<div id="div-comment-1282365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282365">
			February 2, 2017 at 11:42 am</a>		</div>

		<p>IIRC if any other DDE user misbehaves it will freeze your instance even if bad apple is not target.<br />
There might be other problems including performance.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1282485">
				<div id="div-comment-1282485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MarcK4096</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282485">
			February 3, 2017 at 9:25 am</a>		</div>

		<p>Given how some of Raymond&#8217;s posts discuss events that occurred way in the past, I didn&#8217;t think twice about the reference to Server 2003.  I just assumed this was a story from 2009.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1282935">
				<div id="div-comment-1282935" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282935">
			February 6, 2017 at 1:28 pm</a>		</div>

		<p>Not really free to stop using DDE if you are depending on stuff that use DDE, like parts of windows, please remove it altogether, asap.</p>
<p>Can other mail app developers also request new messages that will be added to the OS?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1282955">
				<div id="div-comment-1282955" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1282955">
			February 6, 2017 at 2:34 pm</a>		</div>

		<p>Explorer stopped requiring DDE over two decades ago.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1283065">
				<div id="div-comment-1283065" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1283065">
			February 6, 2017 at 11:29 pm</a>		</div>

		<p>ShellExecuteEx still rely on DDE.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-4" id="comment-1283175">
				<div id="div-comment-1283175" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170202-00/?p=95325#comment-1283175">
			February 7, 2017 at 7:07 am</a>		</div>

		<p>ShellExecute uses DDE when the application being launched says, &#8220;Please use DDE.&#8221; It will not use DDE if it isn&#8217;t explicitly requested. And you aren&#8217;t required to use DDE to interact with the shell. Your app can continue to pretend that DDE simply doesn&#8217;t exist.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>