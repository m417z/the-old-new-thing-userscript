<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (39)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-650713">
				<div id="div-comment-650713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650713">
			July 30, 2008 at 10:40 am</a>		</div>

		<p>Does anyone know what this setting is good for? I&#8217;m just curious. The excel help didn&#8217;t contain any hints&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-650733">
				<div id="div-comment-650733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rune</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650733">
			July 30, 2008 at 10:43 am</a>		</div>

		<p>That option seems a bit ill-conceived and I doubt many users will see the connection.</p>
<p>I guess the Excel team will reconsider it? Alternatively switch the .xls registration to use an old-fashioned command-line parameter rather than DDE? (at least if that option has been set)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-650773">
				<div id="div-comment-650773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.joycode.com/jiangsheng' rel='external nofollow' class='url'>jiangsheng</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650773">
			July 30, 2008 at 10:51 am</a>		</div>

		<p>Isn&#8217;t DDE deprecated? I thought Microsoft would migrate more smoothly, replacing ddeexec with something like mutex and IPC methods. It seems the product only get the job half done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-650823">
				<div id="div-comment-650823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steve.thresher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650823">
			July 30, 2008 at 10:58 am</a>		</div>

		<p>I&#8217;m not convinced that is the only answer. I&#8217;ve experienced the problem detailed in today&#8217;s post and I did not have the &#8216;ignore DDE requests&#8217; option ticked. I also get the same problem from Word which doesn&#8217;t have that option and a similar error message from outlook 2007 opening a hyperlink even though the hyperlink is successfully opened.</p>
<p>Any chance you could point me at a copy of ddespy so I can investigae further. I&#8217;ve tried searching but the results are either spyware reports on the exe itself or dead-end visual C++ 6 documents with no download link. It looks like the tool has been withdrawn.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-650883">
				<div id="div-comment-650883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mathieu Garstecki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650883">
			July 30, 2008 at 11:03 am</a>		</div>

		<p>I often got this error with Word too, but never touched this option&#8230; Maybe it gets activated automatically in some cases ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-650923">
				<div id="div-comment-650923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650923">
			July 30, 2008 at 11:12 am</a>		</div>

		<p>I find (with I think Office 2000, it may have been fixed in later versions) that it&#8217;s usually due to Windows Installer. The first time that an Office app tries to run under a user account, it wants to do some installation stuff for some reason. But if you don&#8217;t have the installation disk handy, you can click Cancel on each of the Windows Installer dialogs and then the program starts and appears to function normally.</p>
<p>But if the reason you opened it was double-clicking a file, the Windows Installer stuff seems to intercept the DDE call, so the file doesn&#8217;t open (and I think Explorer gives a message about there being an error opening the file). But once the program then opens, you can double-click the file and have it open fine.</p>
<p>So, my mom is resigned to double-clicking a file, clicking cancel a few times, and then double-clicking the file again every time she wants to open something, until we find our Office 2000 disk.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-650973">
				<div id="div-comment-650973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://baljemmett.livejournal.com/' rel='external nofollow' class='url'>Ben A L Jemmett</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650973">
			July 30, 2008 at 11:20 am</a>		</div>

		<p>I see the same thing with Visual C++ 6.0 in two circumstances: if the machine is busy so loading the workspace takes a long time, or if it asks me a question whilst loading (e.g. &quot;save changes to previous workspace?&quot;).</p>
<p>Presumably this is a timeout kicking in somewhere &#8212; if the handling application hasn&#8217;t acknowledged (completion of?) the request within X seconds, presume there was a problem and return an error to Explorer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-650983">
				<div id="div-comment-650983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.vacant-nebula.com/' rel='external nofollow' class='url'>Kip</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-650983">
			July 30, 2008 at 11:22 am</a>		</div>

		<p>I get a similar problem from time to time with VS 2005. &nbsp;I&#8217;ll check out a .cpp file from the command line, and then paste the path to that file into the command line and hit enter. &nbsp;Most of the time, VS opens up and the file is displayed. &nbsp;Every so often, VS will open up but no file is loaded (and there is no error message). &nbsp;When I started reading this post I was hoping it would have an explanation. &nbsp;Oh well, it&#8217;s not that big of a hassle to just paste it to the command line again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651023">
				<div id="div-comment-651023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">divil5000@hotmail.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651023">
			July 30, 2008 at 11:28 am</a>		</div>

		<p>I thought DDE was deprecated when Windows 95 came along.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651093">
				<div id="div-comment-651093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651093">
			July 30, 2008 at 11:39 am</a>		</div>

		<p>Speaking of double-clicking in Explorer &#8211; when I try to open a shortcut to a folder, sometimes Explorer navigates to it in the same window, sometimes it opens a new window. I can&#8217;t find any logic behind it. Maybe DDE is at fault here?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651113">
				<div id="div-comment-651113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rupert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651113">
			July 30, 2008 at 11:46 am</a>		</div>

		<p>I was baffled by the same problem, so many thanks for finding a fix. I haven&#8217;t been near that DDE option so it must get switched on as a side-effect of something else.</p>
<p>I do have a vague memory of a prompt about inter-operating with other office apps</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651123">
				<div id="div-comment-651123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651123">
			July 30, 2008 at 11:49 am</a>		</div>

		<p>This happened to me as well. Since I was migrating to a new machine a week later I didn&#8217;t bother too much. I never touched any Excel DDE options, and as I recall the whole thing started after Microsoft Update delivered patches.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651153">
				<div id="div-comment-651153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651153">
			July 30, 2008 at 11:56 am</a>		</div>

		<p>I get it a lot &#8211; especially with large spreadsheets. In fact &#8211; it rarely (if ever) happens with small spreadsheets. And I don&#8217;t have &quot;ignore other apps&quot; checked.</p>
<p>On a side note, the option is listed as &quot;ignore other applications&quot; in the options dialog &#8211; without a reference of DDE (only when diving into the help function you&#8217;re told about that).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651163">
				<div id="div-comment-651163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ethermal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651163">
			July 30, 2008 at 11:57 am</a>		</div>

		<p>Just want to pipe in saying that I too see this alot around our office. &nbsp;And in all cases the DDE options is not set. It&#8217;s almost like the DDE system has crashed in the background(it hasn&#8217;t and there isn&#8217;t one) When this happens it&#8217;s not just word or excel but acrobat or any other type of application that you launch through double clicking on files. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651263">
				<div id="div-comment-651263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.koroirc.com/' rel='external nofollow' class='url'>Koro</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651263">
			July 30, 2008 at 12:30 pm</a>		</div>

		<p>What&#8217;s up with all the MS apps using ddeexec to open associated files? What&#8217;s so bad about simply taking it from the command line, calling FindWindow to find a previous application windows, WM_COPYDATA it the filename, then exiting?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651383">
				<div id="div-comment-651383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian Oney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651383">
			July 30, 2008 at 1:05 pm</a>		</div>

		<p>Aha, this got me too! It started happening roughly around the time the Office service pack came down (that could be a coincidence of course)</p>
<p>I&#8217;m fairly certain I didn&#8217;t click this myself. It&#8217;s a mystery to me as to what enabled it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651423">
				<div id="div-comment-651423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.parkscomputing.com/' rel='external nofollow' class='url'>Paul M. Parks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651423">
			July 30, 2008 at 1:13 pm</a>		</div>

		<p>Me Too(TM). I had this same problem and I&#8217;m fairly certain I didn&#8217;t fiddle with that setting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651493">
				<div id="div-comment-651493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651493">
			July 30, 2008 at 1:26 pm</a>		</div>

		<p>I get the same error in Word periodically, and have to change the explorer settings for the .doc file type. &nbsp;It&#8217;s a pain to remember what setting it is. &nbsp;It&#8217;s even more ridiculous that it needs to be done at all.</p>
<p>What bothers me more about this blog post is the tone of the &quot;it&#8217;s all explorer&#8217;s fault&quot;. &nbsp;No, it&#8217;s MICROSOFT&#8217;s fault. &nbsp;They own Windows (and Explorer). They own Office. &nbsp;They are supposed to work together. stop blaming each other!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651503">
				<div id="div-comment-651503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.parkscomputing.com/' rel='external nofollow' class='url'>Paul M. Parks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651503">
			July 30, 2008 at 1:37 pm</a>		</div>

		<p>I suppose I should clarify my &quot;Me Too&quot; post. When I installed Office 2007 on my 32-bit Vista machine everything worked fine, but somewhere along the way the exact problem you described in this post started happening, and I don&#8217;t know how or why. I certainly don&#8217;t recall ever changing the option you describe, since I would expect that to do just what you said it did. I never managed to fix the problem until I installed 64-bit Vista on the machine and subsequently re-installed Office.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651533">
				<div id="div-comment-651533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651533">
			July 30, 2008 at 1:52 pm</a>		</div>

		<p>I&#8217;ve seen similar behavior when an Excel add-in throws up a dialog box during Excel start-up.</p>
<p>This happens even if I dismiss the dialog bow right away.</p>
<p>However, there is no error message. I simply get Excel without any documents open.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651623">
				<div id="div-comment-651623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BOFH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651623">
			July 30, 2008 at 2:28 pm</a>		</div>

		<blockquote><p>
  steve.thresher</p>
<p>  Any chance you could point me at a copy of ddespy so I can investigae further.
</p></blockquote>
<p>ddespy.exe is a part of Visual Studio V6.0, I have it installed into this folder:</p>
<p>C:Program FilesMicrosoft Visual StudioCOMMONToolsWinNT</p>
<p>I checked the computer of a developer at work who has all versions of visual studio .net, and ddespy.exe is not included in any of them.</p>
<p>As for the actual problem, I too have encountered it on many occasions.</p>
<p>Although it was years ago now since the last time I recall having seen it.</p>
<p>I remember it as one of the signs Windows will sometimes give you that it&#8217;s time to save your work and reboot before something worse happens&#8230;</p>
<p>I also remember that a system service that should be running but no longer is, could possibly cause this, but I may be confusing this with some other problem, it&#8217;s been a while.</p>
<p>This was in the Windows 2000 era.</p>
<p>I also have a recollection of some virus or malware causing this problem back in that timeframe.</p>
<p>You can reproduce the problem of not being able to open Office documents by double-clicking them, by killing the svchost that runs rpcss.</p>
<p>Windows wants to reboot if you do that, but you can abort that by running &quot;shutdown -a&quot; before the timer runs out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651683">
				<div id="div-comment-651683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651683">
			July 30, 2008 at 3:09 pm</a>		</div>

		<p>Pcooper:: &nbsp;I recommend that you ALWAYS install all software by copying the whole CD to a folder on a local drive, then install the software from there. &nbsp;That way, you&#8217;ll always have the installation source available for just these kinds of issues. &nbsp;(Assuming you have modern hard drives of 40 or 100 or 500 gigabytes or so.)</p>
<p>When software like Office comes preinstalled, I still copy the CD to a local folder as soon as I unpack the computer. &nbsp;(The newer computers generally have done this for you.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651693">
				<div id="div-comment-651693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651693">
			July 30, 2008 at 3:11 pm</a>		</div>

		<p>Adrian Oney: &nbsp;Might be related to KB article 821136, which might mess with the DDE setting (it&#8217;s not clear).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651813">
				<div id="div-comment-651813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651813">
			July 30, 2008 at 4:04 pm</a>		</div>

		<p>Wow, aren&#8217;t you an arrogant asshole, just the kind Microsoft wants working for them (That&#8217;s for this blog, but posting was disabled there: <a href="http://blogs.msdn.com/oldnewthing/archive/2008/04/14/8389268.aspx" target=_new rel=nofollow rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2008/04/14/8389268.aspx</a> )</p>
<div class=post>[<i>Comments are closed for a reason. If you want to call me an arrogant asshole, it has to be for something that happened within the last two weeks. Don&#8217;t worry, you still have a lot of choices. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-651873">
				<div id="div-comment-651873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt [C++ MVP]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651873">
			July 30, 2008 at 4:23 pm</a>		</div>

		<p>It IS an explorer (or shell API) bug.</p>
<p>Explorer mistakenly told the user &#8220;Windows cannot find &#8216;FilePathFileName&#8217;, Make sure you typed the name correctly, and then try again.&#8221;</p>
<p>Would it be so difficult to distinguish between &#8220;The executable doesn&#8217;t exist&#8221;, &#8220;The executable failed to run&#8221;, &#8220;The executable ran but didn&#8217;t accept the (DDE) open request&#8221;, and &#8220;The document doesn&#8217;t exist&#8221;? &nbsp;The problem is the attitude of &#8220;our users are too stupid to understand the problem and fix it&#8221;. &nbsp;The reality is that you owe users an accurate error message, preferably in plain language not programmer-ese, so that the ones who do understand, and the IT-knowledgable friends of the ones who don&#8217;t, have a head start actually resolving the problem.</p>
<div class=post>[<i>Okay, what error code would you return from ShellExecute, then? And what will you do when returning something other than 2 causes application compatibility problems? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-651953">
				<div id="div-comment-651953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651953">
			July 30, 2008 at 5:10 pm</a>		</div>

		<p>Isn&#8217;t that for MS to figure out? :) It would make it a better user experience no?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-steveshe even thread-even depth-1" id="comment-651993">
				<div id="div-comment-651993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Steve+Sheppard+-+Microsoft' rel='external nofollow' class='url'>Steve Sheppard - Microsoft</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-651993">
			July 30, 2008 at 6:20 pm</a>		</div>

		<p>@Mike: They did figure it out, you just don&#8217;t like the answer. Simply saying &quot;It sucks and should be better&quot; is not helpful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-652023">
				<div id="div-comment-652023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652023">
			July 30, 2008 at 6:28 pm</a>		</div>

		<p>Somebody else must have asked this, but here goes&#8230;</p>
<p>Why on earth is there an option for that in the first place? It seems like it was just begging for something like this, since there&#8217;s no way this user is going to understand the connection between DDE and &quot;my file doesn&#8217;t open&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-652033">
				<div id="div-comment-652033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lothar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652033">
			July 30, 2008 at 6:31 pm</a>		</div>

		<p>This happened on a few of our workstations some time ago on a wednesday morning. I remember using windbg, process explorer, filemon and regmon to troubleshoot the problem, to no avail. In the end I got angry and started exporting and importing office registry keys from a working office installation. That fixed it.</p>
<p>It might have been related to dde , although I do not believe 20 users simultaneously enabled this option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-652133">
				<div id="div-comment-652133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frohicke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652133">
			July 30, 2008 at 8:50 pm</a>		</div>

		<p>Thank you, thank you, thank you. One of my computers has been doing this since shortly after Office 2007 came out, and I&#8217;ve been to hell and back with the associations.</p>
<p>I don&#8217;t think I&#8217;d ever have changed that option (Excel options? Why!?) so perhaps some add-in did at some point (then again, I can&#8217;t remember installing any add-ins either)&#8230;</p>
<p>Anyway, thank you once more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-652233">
				<div id="div-comment-652233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652233">
			July 31, 2008 at 1:49 am</a>		</div>

		<p>@Lothar: If you can remember the date better, it may be due to one Office patch or another. Wednesday morning would be the day after Patch Tuesday. I&#8217;m guessing one patch flubbed the registry setting accidentally.</p>
<p>And it might make sense given the number of people having the same issue. Word may not have the option, but the registry version equivalent might just be the ticket.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-652293">
				<div id="div-comment-652293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stefang</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652293">
			July 31, 2008 at 4:22 am</a>		</div>

		<p>I agree with Ben Voigt!</p>
<p>The real problem here is that Explorer is displying a misleading error message which leads to a very unpleasant user experience.</p>
<p>Raymond is probably right that there is no easy fix for this issue, I suppose the shell has valid reasons for using ShellExecute when the user double-clicks a file, and I suppose that ShellExecute has valid reasons for returning a misleading error code. This is probably hard to fix.</p>
<p>But, this does not mean that it is impossible to improve the situation. If this issue was given enough priority, I am sure that some smart Microsoft people could come up with a much better solution than what we have today.</p>
<p>The only real question is how important this issue is relative to everything else that needs fixing.</p>
<p>In my opinion this is very important. Double-clicking documents is the primary way users (especially naive users) open documents in windows. If the computer gives misleading error messages in this situation, the user will get angry and frustrated:</p>
<p>Computer: &quot;Make sure you typed the name correctly, and then try again&quot;</p>
<p>Angry user: stupid computer, I did not type the name at all &#8211; I double-clicked a file! Why do you try to blame me when it is your own fault. Stupid microsoft crap &amp;%&amp;%/&amp;#&#164;</p>
<p>So, at the very least, explorer could display a different error message when double-clicking a file than when the user manually types a file.</p>
<p>It might even be possible to have ShellExecute collect some detailed diagnostics that a power user could display by clicking a link in the error message dialog.</p>
<p>Raymond, you say that &quot;A misconfigured copy of Excel resulted in an error message that by all indications looked like an Explorer bug&quot; &#8211; it IS an explorer bug! Resolving the issue by reconfiguring excel misses the point: The real problem is that the error message is misleading!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-652303">
				<div id="div-comment-652303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anil Adireddi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652303">
			July 31, 2008 at 4:22 am</a>		</div>

		<p>I face a similar problem with Powerpoint ppts. Whenever I double click on a ppt which has animations set, the slideshow starts and does not allow any user inputs. The slide show continues at a very slow pace.</p>
<p>Because of this constrain I have to manually open all ppts in Powerpoint</p>
<p>Any Help :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-652513">
				<div id="div-comment-652513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.parkscomputing.com/' rel='external nofollow' class='url'>Paul M. Parks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652513">
			July 31, 2008 at 10:14 am</a>		</div>

		<p>stefang: &quot;The real problem here is that Explorer is displying a misleading error message which leads to a very unpleasant user experience.&quot;</p>
<p>I&#8217;ve seen Raymond discuss psychic debugging, but I still haven&#8217;t seen him mention psychic software. How, exactly, was Explorer supposed to return an error message when it was Excel that was failing to recognize the command that the shell sent to it?</p>
<p>Quoting Raymond: &quot;So far as the shell was concerned, it was sending the command that Excel registered as the &#8216;Please send me this command when you want to open a document,&#8217; and yet when Explorer sent that very command, Excel responded with &#8216;Huh? What are you talking about?&#8217;&quot;</p>
<p>Why blame a bit of software for doing it&#8217;s job? I get this sort of thing from clients of libraries for which I&#8217;m responsible, and some of my days are spent explaining why my software can&#8217;t predict the future or patch other processes or guess what the client really intended to do when it called my API incorrectly. I&#8217;m beginning to develop the interpersonal skills of a thermonuclear device as a result.</p>
<p>PMP</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-652553">
				<div id="div-comment-652553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stefang</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-652553">
			July 31, 2008 at 10:42 am</a>		</div>

		<p>PMP: Unless I am totally mistaken, Explorer is displaying the error message &#8211; not Excel. </p>
<p>* The user double-clicks a document in explorer</p>
<p>* explorer uses shellexecute to open the document in the associated program. </p>
<p>* This fails because excel is improperly configured. </p>
<p>* ShellExecute returns an error code meaning &quot;File not found&quot;</p>
<p>* Explorer displays a message to the user that he should make sure that he is typing the name correctly.</p>
<p>* The user gets pissed off because the offensive and clearly incorrect error message.</p>
<p>There is no need for any psychic software. Explorer knows that the user double-clicked a document. Explorer knows that the operation failed. Explorer can definitely display a better error message than it does today.</p>
<p>The only issue is if it is worth the time and effort to improve the error message in this situation.</p>
<p>I believe that it is extremely important to get these kinds of error messages right &#8211; blaming the user for a problem that is clearly not his fault creates a very bad impression.</p>
<p>Note that I am not talking about error codes returned from a library &#8211; I am talking about the plain english error message displayed to the end user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-653023">
				<div id="div-comment-653023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bulletmagnet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-653023">
			August 1, 2008 at 4:34 am</a>		</div>

		<p>I place the blame on ShellExecute().</p>
<p>I think SE_ERR_DDEFAIL (The DDE transaction failed.) would have been a much more helpful error code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-653103">
				<div id="div-comment-653103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lawrence</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-653103">
			August 1, 2008 at 10:12 am</a>		</div>

		<p>I&#8217;m certain I didn&#8217;t select that option, and yet I had this same problem. &nbsp;Thanks for the solution.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-653673">
				<div id="div-comment-653673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DDE = TOO OLD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-653673">
			August 2, 2008 at 6:33 pm</a>		</div>

		<p>Why does a program from 2007 still use frickin oldskool DDE? That is like the &quot;The Old Old Thing&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kjkhyperion even thread-even depth-1" id="comment-654363">
				<div id="div-comment-654363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080730-00/?p=21423#comment-654363">
			August 6, 2008 at 8:45 am</a>		</div>

		<p>When you hear DDE was &quot;deprecated&quot;, you need to remember DDE was more than just fancy window messages: DDE was the predecessor to OLE and COM. In *that* sense it&#8217;s deprecated. But DDE for shell commands is just too convenient compared to the alternative (making your document type only accessible as an OLE document), not to mention all existing protocols based on DDE that will stay DDE &#8211; the Netscape DDE protocol, still supported by all major browsers; the Program Manager protocol for installers, still supported by the shell; etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>