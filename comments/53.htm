<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (26)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1148483">
				<div id="div-comment-1148483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BOFH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148483">
			September 8, 2014 at 8:17 am</a>		</div>

		<p>I do a lot of work in the Command Prompt, mangling snippets of data with Perl and regex, this piping stdout directly into Notepad is something I have been thinking of for a long time.</p>
<p>I&#39;m just a BOFH with programming experience from C on MS-DOS in the 90s, how do I build this C# thingy in Visual Studio?</p>
<p>I have access to a machine with Visual Studio 2010 Ultimate, I created a C# Console App and pasted in the code into Program.cs.</p>
<p>The build stops on this error:</p>
<p>The type or namespace name &#39;Windows&#39; does not exist in the namespace &#39;System&#39; (are you missing an assembly reference?)</p>
<p>I found the References list and the .Net tab, but there is no System.Windows in the list, what am I supposed to do to make the build work?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148503">
				<div id="div-comment-1148503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CarlD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148503">
			September 8, 2014 at 8:25 am</a>		</div>

		<p>@BOFH You need to add a reference to uiautomationclient.dll. &nbsp;See <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/system.windows.automation.automationelement(v=vs.85).aspx">msdn.microsoft.com/&#8230;/system.windows.automation.automationelement(v=vs.85).aspx</a>.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148513">
				<div id="div-comment-1148513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148513">
			September 8, 2014 at 8:25 am</a>		</div>

		<p>@BOFH: From the Add references dialog, select the .NET tab, then add a reference to the UIAutomationClient component.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148523">
				<div id="div-comment-1148523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BOFH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148523">
			September 8, 2014 at 8:56 am</a>		</div>

		<p>I had tried that, but it produced other errors instead so I backed out from that route.</p>
<p>CarlD&#39;s link clarifies that it is the way to go so I looked more closely at those errors and realized that I need to add UIAutomationTypes as well to make it work.</p>
<p>Thanks! :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148563">
				<div id="div-comment-1148563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148563">
			September 8, 2014 at 9:32 am</a>		</div>

		<p>This functionality is incredibly useful.</p>
<p>I wrote a GUI text editor years ago that accepts piped input and I still use it almost daily.</p>
<p>You can build Raymond&#39;s app without Visual Studio thus:</p>
<p>Save the source from above in a file called 2np.cs and, at a command-prompt in the same directory, run</p>
<p>set FW=C:WindowsMicrosoft.NETFramework64v4.0.30319</p>
<p>%FW%csc /lib:%FW%WPF /r:UIAutomationClient.dll /r:UIAutomationTypes.dll 2np.cs</p>
<p>The FW path may well be a bit different on your computer, but you want the folder containing &quot;csc.exe&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148583">
				<div id="div-comment-1148583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148583">
			September 8, 2014 at 9:56 am</a>		</div>

		<p>If you don&#39;t mind an extra step, Windows comes with a &quot;clip&quot; utility that you copies its stdin to the clipboard. This is what I do when I want to get some data from a command line program into Excel or a text editor.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148603">
				<div id="div-comment-1148603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148603">
			September 8, 2014 at 10:12 am</a>		</div>

		<p>@BOFH: Always read error messages that you get. If you miss UIAutomationTypes, the message is pretty clear:</p>
<p>The type &#39;System.Windows.Automation.AutomationProperty&#39; is defined in an assembly that is not referenced. You must add a reference to assembly &#39;UIAutomationTypes, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&#39;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148623">
				<div id="div-comment-1148623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">notebatch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148623">
			September 8, 2014 at 10:34 am</a>		</div>

		<p>I used notepad to write a batch file that does sorta kinda the same thing. Usage is &quot;whatever.bat command&quot;.</p>
<p>@ECHO OFF</p>
<p>FOR /F &quot;delims=:. tokens=1-4&quot; %%t IN (&quot;%TIME: =0%&quot;) DO (SET FILENAME=&quot;%TEMP%foo-%%t%%u%%v%%w&quot;)</p>
<p>%1 &gt; %FILENAME%</p>
<p>notepad %FILENAME%</p>
<p>DEL /F &nbsp;%FILENAME% 2&gt;NUL</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148643">
				<div id="div-comment-1148643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148643">
			September 8, 2014 at 10:42 am</a>		</div>

		<p>I just noticed that 2np doesn&#39;t properly work with Unicode text (characters are replaced by &quot;?&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148653">
				<div id="div-comment-1148653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio &amp;amp;#39;Grijan&amp;amp;#39;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148653">
			September 8, 2014 at 10:57 am</a>		</div>

		<p>This program can be replaced with just a simple 2-line batch file:</p>
<p>@findstr &quot;^&quot; &gt; %temp%2np.txt</p>
<p>@start notepad %temp%2np.txt</p>
<p>It accepts input from the pipeline (or even the keyboard!), just as Raymond&#39;s program:</p>
<p>dir /b | 2np</p>
<div class="post">[<em>There is a race condition in the batch file, and it isn&#39;t thread-safe, and if you instinctively hit Ctrl+S to save, it saves it back to the temporary file that is probably not what you wanted. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148713">
				<div id="div-comment-1148713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148713">
			September 8, 2014 at 11:50 am</a>		</div>

		<p>It would be sweet if we could host these code samples on a git repo. &nbsp;That way improvements could be published to them, and everyone enjoys the benefits.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman odd alt thread-odd thread-alt depth-1" id="comment-1148743">
				<div id="div-comment-1148743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148743">
			September 8, 2014 at 12:29 pm</a>		</div>

		<p>@Mike: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2011/01/18/10116870.aspx">blogs.msdn.com/&#8230;/10116870.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148763">
				<div id="div-comment-1148763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148763">
			September 8, 2014 at 1:21 pm</a>		</div>

		<p>I started with something similar a long time ago. &nbsp;I&#39;ve since added the ability to keep text coming in from the pipe to Notepad in near-realtime with EM_SETSEL and EM_REPLACESEL, and deal with oddball tools that output different line endings.</p>
<p>It&#39;s incredibly useful for a host of things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148813">
				<div id="div-comment-1148813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio &amp;amp;#39;Grijan&amp;amp;#39;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148813">
			September 8, 2014 at 4:37 pm</a>		</div>

		<p>@Raymond: these things are right, but I don&#39;t think they affect the most frequent use of the command: capturing the (long) output of a command so you can read it slowly, search it for keywords and maybe copy portions of it. The race condition doesn&#39;t matter too much in practice because this command is interactive in nature, so it isn&#39;t probable to run it twice at the same time. If you need to capture a second command&#39;s output before closing the first Notepad, you can do that, as far as you understand that the temporary file is, well, temporary, and can be overwritten without warning. And if you want to save the full output to a file (it would have been simpler to use a &gt;file.txt redirection in the first place!), after pressing Ctrl+S and noticing the Save As dialog didn&#39;t show, I&#39;d realize I had to use the Save As command.</p>
<p>I understand the purpose of all this is to have a nice exercise in GUI programming and adding a tool to our toolset. I was just showing an alternative to your code, even if the batch file doesn&#39;t do everything that your C# program do.</p>
<div class="post">[<em>I guess my workflow is not the same as yours. I use Notepad windows to keep track of things in progress (like notes taken during debugging or a list of files that need to be checked). If I hit Ctrl+S, I assume that my notes have been saved. I don&#39;t stop and think, &quot;Oh wait, did I create this with 2np? Rats, that didn&#39;t actually save it anywhere permanent.&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148823">
				<div id="div-comment-1148823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148823">
			September 8, 2014 at 6:24 pm</a>		</div>

		<p>Can we be sure that Notepad (or Wordpad, for that matter) properly updates all of its state variables when other programs manipulate its internal controls? Don&#39;t turn this Little Program into a Big Program unless you know. CreateWindow(L&quot;EDIT&quot;, everything, &#8230;) is probably easier and safer.</p>
<div class="post">[<em>Actually, we know that it doesn&#39;t. Close the Notepad window without editing anything: You are not prompted to save. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148833">
				<div id="div-comment-1148833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148833">
			September 8, 2014 at 11:21 pm</a>		</div>

		<p>Use a real operating system, and this is just somecommand | gvim &#8211;</p>
<p>&lt;/flamebait&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148853">
				<div id="div-comment-1148853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Smeargle235</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148853">
			September 9, 2014 at 12:35 am</a>		</div>

		<p>I&#39;ve been using something like this that I wrote for years, only instead of notepad, it writes the input to a text file and opens it in the default web browser.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148893">
				<div id="div-comment-1148893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GreyCloud</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148893">
			September 9, 2014 at 3:20 am</a>		</div>

		<p>Hum got a weird message about a shim error on Windows 8.1 64bit compiling under .net 4.5. (might be something to do with copying the exe to System32 folder?) &nbsp; Changed project to .net 3.5 and all is well :)</p>
<p>thanks for this &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148903">
				<div id="div-comment-1148903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148903">
			September 9, 2014 at 3:56 am</a>		</div>

		<p>@rs: Have you heard of that fancy &quot;event queue&quot; invention of recent years? Coupled with an innovative &quot;event loop&quot; technique, and given that &quot;event queue&quot; is maintained by the timesharing operating system you use, and the &quot;event loop&quot; is employed by an application run under supervision of the said TS/OS, one can maintain confidence&#8230; okay, I am tired of writing this.</p>
<p>Although, seriously, it&#39;s just sending a WM_SETTEXT message to a window. Even X-Windows can do something like this more or less reliably and without causing chaos.</p>
<p>@Chris: Yep, the whole Windows is defective because its core system component, namely Notepad, doesn&#39;t read data from STDIN.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1148923">
				<div id="div-comment-1148923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148923">
			September 9, 2014 at 6:45 am</a>		</div>

		<p>So what&#39;s the difference between somecommand | gvim &#8211; on a real OS and somecommand | 2np on some other OS again?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1148973">
				<div id="div-comment-1148973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Innocent Bystander</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1148973">
			September 9, 2014 at 7:16 am</a>		</div>

		<p>Lot&#39;s of people posting saying how incredibly useful this is. Why? What&#39;s the advantage over just piping to a file or just displaying in the command prompt? </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1149053">
				<div id="div-comment-1149053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Casual Passerby</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1149053">
			September 9, 2014 at 8:06 am</a>		</div>

		<p>@Innocent Bystander: here are a few things you can do more easily in a text editor. Long output can be scrolled and searched more easily. You can cut and paste some or all of the output; this is nice if you are answering a support question by email. You can annotate the text to aid in debugging or explaining. You can save the text for future reference.</p>
<p>The reason I will use this though is that selecting and copying text in the Windows command prompt just works weird (for good reasons no doubt). Even after years of using it I still cut off content on the right side because it does a block select. This just works better. </p>
<p>@Tim: thanks for the clipboard trick.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1149563">
				<div id="div-comment-1149563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DebugErr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1149563">
			September 10, 2014 at 1:49 am</a>		</div>

		<p>Windows.Automation, eh? Never heard of it. But it looks very interesting. Wonder if I get this working with my other favourite editor, Notepad++.</p>
<div class="post">[<em>I&#39;ve used the automation namespace <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/02/17/10500645.aspx">in</a> <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/03/03/10504441.aspx">the</a> <a href="http://blogs.msdn.com/b/oldnewthing/archive/2014/02/24/10502479.aspx">past</a>, and expect to see again in the future. It&#39;s really handy for this sort of thing. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1149583">
				<div id="div-comment-1149583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1149583">
			September 10, 2014 at 4:32 am</a>		</div>

		<p>I wonder why you did not use the value pattern to set the text? The value pattern would also update the internal state of the notepad so it would ask you to save when you exit.</p>
<p>Or were there a hidden agenda to show how to use SendMessage with a string parameter?</p>
<div class="post">[<em>I really wanted to use the value pattern, but it turns out that multi-line edit controls don&#39;t support the value pattern. Curses! -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1149703">
				<div id="div-comment-1149703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1149703">
			September 10, 2014 at 8:28 am</a>		</div>

		<p>@Raymond: Ok, I were looking at notepad in Windows 7: there the control type is Edit, not Document, and it does support the value pattern.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1150663">
				<div id="div-comment-1150663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stephen yeadon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140908-00/?p=53#comment-1150663">
			September 12, 2014 at 9:20 am</a>		</div>

		<p>To your example:</p>
<p>dir | 2np</p>
<p>You could try:</p>
<p>dir | clip | notepad</p>
<p>ctrl V will paste the results into the open notepad window.</p>
<div class="post">[<em>At the cost of wiping out whatever was on your clipboard already. And you have to sit and wait for the &quot;dir&quot; to complete. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>