<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (73)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-229233">
				<div id="div-comment-229233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">biril</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229233">
			November 24, 2004 at 7:03 am</a>		</div>

		<p>Very interesting error message. It actually describes the right way to do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229243">
				<div id="div-comment-229243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229243">
			November 24, 2004 at 7:11 am</a>		</div>

		<p>I believe the answer is that many applications have multiple drop targets inside their &quot;main window&quot;. For example explorer has a folder tree on the left and file list on the right, both of which are drop targets. If I drop a file onto an explorer taskbar button, how would it know where exactly I was dropping the file?</p>
<p>Obviously I am smarter than Raymond Chen!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229253">
				<div id="div-comment-229253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229253">
			November 24, 2004 at 7:26 am</a>		</div>

		<p>Remember guys, Microsoft engineers aren&#8217;t human!  They should be able to answer any question on right off the top of their head!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229263">
				<div id="div-comment-229263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamesatuncw.com/blog' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229263">
			November 24, 2004 at 7:50 am</a>		</div>

		<p>Raymond,</p>
<p>I agree with your guess.  I can already see an e-mail virus doing just what your guess describes.</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229273">
				<div id="div-comment-229273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229273">
			November 24, 2004 at 8:05 am</a>		</div>

		<p>I thought this came from the age of MDI, where you had a bunch of windows behind the one application icon and you had to have the window open to choose one to drop on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229283">
				<div id="div-comment-229283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Kitchen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229283">
			November 24, 2004 at 8:06 am</a>		</div>

		<p>For G&#8217;s usability reason&#8230; cool, but a program could define a default drop target or function (paste into a new image in photoshop for example).</p>
<p>For Raymond&#8217;s guess, sounds very plausible but this dates back quite far and would predate the last few years high awareness of security.</p>
<p>I would think it was definately a cost issue when it came down to it&#8230; that the cost of creating the framework necessary to allow drop targets and default behaviour was too great and it was considered an edge case scenario&#8230; so a clear error message was considered the better solution.</p>
<p>When you approach milestone 3 of a 3 milestone project and faced with the Adds and Cuts phase, you&#8217;d be surprised how many useful things get put into the Cuts if they&#8217;re not considered core to the project or cheap to implement.</p>
<p>As the error message shows that the solution is simply to pause and continue the drag&#8230; I would guess that this was simply considered to not be a high priority or core piece of functionality.</p>
<p>My 2c.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229293">
				<div id="div-comment-229293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://gauss.dynalias.net/blog' rel='external nofollow' class='url'>Luke Stevens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229293">
			November 24, 2004 at 8:10 am</a>		</div>

		<p>Getting an IDropTarget is probably akin to the problem of getting an IHTMLDocument2 from a browser window (see Q249232). I think it was originally assumed that you would only ever need to get an HWND from an ActiveX object (e.g. via IOleWindow::GetWindow) and not the other way around, since if you cared about ActiveX interfaces you would start with one and not let it go, and it need not be a one-to-one relationship anyway. </p>
<p>But why couldn&#8217;t the taskbar just forward a WM_DROPFILES message?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229303">
				<div id="div-comment-229303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229303">
			November 24, 2004 at 8:12 am</a>		</div>

		<p>@biril &#8216;Very interesting error message. It actually describes the right way to do it.&#8217;</p>
<p>In some ways that made it even more infuriating: &#8216;Dammit Windows you know what I want to do &#8211; why don&#8217;t you just do it!?&#8217; ;)</p>
<p>Anyway nice one to bring up Raymond &#8211; it&#8217;s one of those that always puzzled me. I&#8217;ve always hoped that the Explorer people weren&#8217;t trying to thwart my drop attempts on purpose and then taunt me with the error message.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229313">
				<div id="div-comment-229313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.cataraxia.com/' rel='external nofollow' class='url'>Kristoffer Henriksson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229313">
			November 24, 2004 at 8:13 am</a>		</div>

		<p>I&#8217;m surprised that this functionality still is not implemented. It seems like something a computer novice would do and with all the usability testing Microsoft has done it is a bit puzzling why nobody has gotten around to implementing dropping on a taskbar button.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229323">
				<div id="div-comment-229323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.grack.com' rel='external nofollow' class='url'>Matthew Mastracci</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229323">
			November 24, 2004 at 8:19 am</a>		</div>

		<p>You can actually get a DropTarget from a Window, but this method will tick Raymond off when he has to debug your code in 15 years:</p>
<p>(IDropTarget *) GetProp((HWND)hWnd, &quot;OleDropTargetInterface&quot;);</p>
<p>Yet another thing that they&#8217;ll have to maintain backwards compatibility with post-Win32.  ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229343">
				<div id="div-comment-229343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229343">
			November 24, 2004 at 8:21 am</a>		</div>

		<p>&quot;But why couldn&#8217;t the taskbar just forward a WM_DROPFILES message?&quot;</p>
<p>Um, OLE drag/drop is much more complicated than a WM_DROPFILES message. You can drag things that aren&#8217;t files, the drop target can give interactive feedback (remember the copy/move/shortcut article a few days ago?), the drop target can change behavior based on which button you&#8217;re dragging with. None of this can be done with WM_DROPFILES.</p>
<p>&quot;&#8230; why nobody has gotten around to implementing dropping on a taskbar button.&quot;  Um, I explained why. Because it can&#8217;t be done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229353">
				<div id="div-comment-229353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229353">
			November 24, 2004 at 8:23 am</a>		</div>

		<p>I think that dropping onto the taskbar would be a very ambiguous situation for any drop target. Imagine an application that needed to know exactly where you were dragging an item, for example between a &quot;delete this file&quot; icon and an &quot;Load this file&quot; icon. How would a user know, without being able to see the window, what the resultant or default action would be?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229363">
				<div id="div-comment-229363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Weiss</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229363">
			November 24, 2004 at 8:41 am</a>		</div>

		<p>I agree with Tom M.<br />
<br />Drop Tagets I&#8217;ve done were very sensitive to location. For example a TreeView that allows files to be dropped on what it considers &quot;folders&quot; in it&#8217;s tree, but not other types of nodes (&quot;files&quot;, &quot;the magic root item&quot;).<br />
<br />If dropped on or dragged over a task bar button the drop target would have to be informed (or have a way to find out) during all those &quot;feedback&quot; calls and such of this special case.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229373">
				<div id="div-comment-229373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229373">
			November 24, 2004 at 8:52 am</a>		</div>

		<p>About inability to obtain IDropTarget from HWND: the system clearly knows how to do that, even if the technique is not publicly documented. After all, DoDragDrop has to be able to do it.</p>
<p>About position sensitivity: many (most?) applications that support DnD allow dropping on the title bar. If I were to try and forward a drop from the taskbar button to the application, I&#8217;d pretend a drop occurred on the title bar, e.g. at (0, 0) or maybe immediately to the right of the icon.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229383">
				<div id="div-comment-229383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">camillo vezzoli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229383">
			November 24, 2004 at 8:56 am</a>		</div>

		<p>There&#8217;s also the case when applications are grouped in the same button. To which application the object should be dropped to?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229393">
				<div id="div-comment-229393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229393">
			November 24, 2004 at 9:00 am</a>		</div>

		<p>&quot;After all, DoDragDrop has to be able to do it.&quot;</p>
<p>But that doesn&#8217;t mean that free and open access should be given to it. Consider the consequences of the &quot;forgot to release it&quot; scenario I described in my article.</p>
<p>After all, the operating system knows how to read raw data from the pagefile, but you don&#8217;t want anybody other than the OS itself to be able to do that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229403">
				<div id="div-comment-229403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris T</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229403">
			November 24, 2004 at 9:08 am</a>		</div>

		<p>There was a time in Disneyland when the maintenance people wanted to put up a fence around a particular flowerbed because people kept walking through it. Walt Disney said, &quot;hell, no, if that many people are walking through the flowerbed, you can bet they&#8217;ve got a good reason to do it.&quot; He had them pave the path through the flowers instead.</p>
<p>I get error messages all the time in Windows telling me the right way to do something; well, why don&#8217;t you do it for me, then, computer? It&#8217;s 2004, hello!</p>
<p>The Mac follows the Disney way. There aren&#8217;t any of these sorts of error messages. If we&#8217;re telling the user how to do something, we know that we could just as easily do what they&#8217;re expecting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229413">
				<div id="div-comment-229413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://firasd.org' rel='external nofollow' class='url'>Firas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229413">
			November 24, 2004 at 9:10 am</a>		</div>

		<p>biril: I think it&#8217;s a bad error message&#8211;I&#8217;ve seen it before, and I read it, and applied what it said (when trying to drag an mp3 onto the winamp button), but I really had to be patient! How about:</p>
<p>&#8216;Hold the item on the button. The program window will open; drop it there.&#8217;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229423">
				<div id="div-comment-229423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://firasd.org' rel='external nofollow' class='url'>Firas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229423">
			November 24, 2004 at 9:13 am</a>		</div>

		<p>And you can have a &#8216;more info&#8217; button on the dialog, which expands the box to explain that the current action can&#8217;t be done, what holding means, how to drop, etc.</p>
<p>Bah, I missed my calling.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229433">
				<div id="div-comment-229433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229433">
			November 24, 2004 at 9:42 am</a>		</div>

		<p>&quot;Disneyland&quot; &#8211; What if the flowers were protected as an endangered species? The taskbar can&#8217;t break the laws of OLE, and Disneyland can&#8217;t break the laws the United States.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229443">
				<div id="div-comment-229443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229443">
			November 24, 2004 at 10:09 am</a>		</div>

		<p>&quot;Disneyland can&#8217;t break the laws of the United States&quot;</p>
<p>Bad analogy there :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229453">
				<div id="div-comment-229453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tringali.org' rel='external nofollow' class='url'>Scott Tringali</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229453">
			November 24, 2004 at 10:12 am</a>		</div>

		<p>Sure, there may be multiple drop targets in the destination window.  But for most of the apps I use there is only one, or one I know of, or only one useful one: dragging a file into the window meaning &quot;open this file please&quot;. </p>
<p>For example, Finale is stupid: if you double-click on a file when the app is open, it raises the app, but doesn&#8217;t open the new file.  Dragging it in, however, works.  Dragging the file anywhere in the UI opens the file.  So, there&#8217;s only one target.  If I could drag it onto the taskbar, then would mean the same thing.</p>
<p>This is unlike Wordpad, where dragging the file in to the menu/tool bar means &quot;open this file&quot;, and into the document area means &quot;embed the document&quot; &#8212; the latter of which makes techincal sense, but serves no useful purpose to me.</p>
<p>I don&#8217;t know very much about Windows programming, but have done drag and drop for other UIs.  If you define a drop area that covers the entire main window, then probably the task bar should accept that too.  At least, it seems like a good default.  Even better would be a way for the app to somehow define what a taskbar drop meant for special situtations.</p>
<p>Anyway, the metaphor to Disneyland is bit different &#8211;   the laws of OLE and the taskbar are both owned by the same company. ;)</p>
<p>Or think of this this way: Disney has lobbyists, so they can simply buy new laws.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229463">
				<div id="div-comment-229463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229463">
			November 24, 2004 at 10:40 am</a>		</div>

		<p>&quot;The laws of OLE and the taskbar are both owned by the same company.&quot;</p>
<p>That&#8217;s like saying that the laws of Oregon and Californa are owned by the same country. Sure, they both belong to a single larger entity, but they have their own separate laws.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229473">
				<div id="div-comment-229473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229473">
			November 24, 2004 at 10:45 am</a>		</div>

		<blockquote><p>
  &gt; After all, DoDragDrop has to be able to do it.&quot;</p>
<p>&gt; But that doesn&#8217;t mean that free and open access should be given to it. Consider the consequences of the &quot;forgot to release it&quot; scenario I described in my article. </p>
<p>Taskbar implementation is part of the OS. You don&#8217;t need free and open (in other words, public and documented) access. That would not be the first undocumented technique Windows shell uses.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229483">
				<div id="div-comment-229483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229483">
			November 24, 2004 at 11:09 am</a>		</div>

		<p>&quot;Taskbar implementation is part of the OS.&quot;</p>
<p>Great. Go lobby the OLE team to give the taskbar a way to do this. It&#8217;s their API, they get to decide.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229493">
				<div id="div-comment-229493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229493">
			November 24, 2004 at 11:23 am</a>		</div>

		<p>Chris T,</p>
<p>&quot;The Mac follows the Disney way&#8230; we could just as easily do what they&#8217;re expecting&quot;</p>
<p>OK Mr. Mac fanboy, if I drop a file onto Windows Explorer taskbar button, is it going to paste the file into the right pane or the left pane? What did I mean for it to do? Oh wait.. let me guess. the Mac Finder thing only has one pane.. Mac users cant handle multiple panes, just like they cant handle 2 mouse buttons!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229503">
				<div id="div-comment-229503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229503">
			November 24, 2004 at 11:26 am</a>		</div>

		<p>What about GetProp(hWnd, &quot;OleDropTargetInterface&quot;) mentioned earlier (assuming it indeed works)? You (as in &quot;the shell team&quot;) have access to Windows source code &#8211; it should not be too difficult to see how RegisterDragDrop works. I wouldn&#8217;t be overly surprised if it&#8217;s as simple as SetProp.</p>
<p>Like I said, this wouldn&#8217;t be the first time Windows shell uses undocumented techniques or relies on implementation details of other parts of Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229513">
				<div id="div-comment-229513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://banana@livejournal.com' rel='external nofollow' class='url'>J</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229513">
			November 24, 2004 at 11:31 am</a>		</div>

		<p>In Windows 3.1 you could do the equivalent thing. For example, you could open Notepad, minimise it, open File Manager, drag a text file and drop it on the Notepad icon at the bottom of the screen. Notepad opened the file. Nowadays the user interface is different but only superficially and the functionality has gone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229533">
				<div id="div-comment-229533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shawn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229533">
			November 24, 2004 at 11:56 am</a>		</div>

		<p>With my developer hat on, I understand the problems re: different teams, drop location ambiguity, resource management, etc. </p>
<p>With my user hat on, I can only see Windows, and I don&#8217;t care about who owns what API, I just want it to do what I want it to do when I drop the thing on the button &#8211; some default action like open the file, or put up the &quot;NO&quot; cursor if there is no such thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229543">
				<div id="div-comment-229543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/larryosterman' rel='external nofollow' class='url'>Larry Osterman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229543">
			November 24, 2004 at 12:34 pm</a>		</div>

		<p>Shawn,<br />
<br />  In many ways, you&#8217;re right.  But people would get ticked off if only the applications that shipped within Windows worked and those that didn&#8217;t ship within windows didn&#8217;t.  Because Microsoft documented how OLE drag&amp;drop worked, and set forward guidelines.  Applications then wrote code to work with those guidelines, so any revisions of those guidelines will likely break applications (at a minimum, they&#8217;re not going to be able to take advantage of the new feature).</p>
<p>If the rules were changed, then this would work with some apps, and not with others.  Leading to even MORE user confusion: &quot;What do you mean that I can&#8217;t drag&amp;drop an item to my word processor, but I can to my email program?What kind of a lame-o operating system are you idiots building anyway?&quot;</p>
<p>And worse, Microsoft would undoubtedly be blamed for breaking applications.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229553">
				<div id="div-comment-229553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229553">
			November 24, 2004 at 1:31 pm</a>		</div>

		<p>Igor: Good luck being able to do anything with that thing you think is an IDropTarget (it&#8217;s in the wrong address space for one thing).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229573">
				<div id="div-comment-229573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229573">
			November 24, 2004 at 2:19 pm</a>		</div>

		<p>Note that many programs accept drops only on subwindows, not on the outer window. For example, you can drop a file into an email message, but you can&#8217;t drop it onto the outer window; you have to drop it into the message body. Therefore, it&#8217;s possible that GetDropTargetFromWindow returns NULL even though there are droppable sections of the window.</p>
<p>You might say, &quot;Well, then that&#8217;s the app&#8217;s fault for not having a generic drop target&quot;. To the end user, this manifests as inconsistent and confusing behavior.</p>
<p>Your taskbar button is labelled &quot;Today&#8217;s meeting agenda&quot;.  It is an email message. What do you want to happen when you drop a word onto it that you dragged out of Wordpad? Add it to the &quot;To&quot; line? Add it to the &quot;Cc&quot; line? Change the message subject? Add the text to the message body?</p>
<p>Sure the &quot;Foo&quot; folder case is &quot;obvious&quot;. But most cases aren&#8217;t as clear-cut. And computers have yet to develop intuition.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229583">
				<div id="div-comment-229583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229583">
			November 24, 2004 at 2:55 pm</a>		</div>

		<p>Raymond &#8211; search Windows sources for GetInterfaceFromWindowProp</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229593">
				<div id="div-comment-229593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dean Harding</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229593">
			November 24, 2004 at 3:03 pm</a>		</div>

		<p>&quot;And computers have yet to develop intuition.&quot;</p>
<p>Well there&#8217;s your problem!  You&#8217;ve got all these really smart guys over in MS research looking into better ways to render text or writing extensions to C#, when in fact they /should/ be coming up with computerized ESP!!</p>
<p>With the aid of hindsight we can probably see that with a bit of extra effort there may have been a solution to the problem (i.e. this hypothetical &quot;default&quot; drop target for a window could have been used when dropping on a taskbar button &#8211; though who knows?  Maybe there&#8217;s problems with that that we haven&#8217;t thought about).  But the problem is not whether it could have been done when the drag and drop interfaces were being conceived, but whether it can be retro-fitted onto them /now/.  The answer is and unfortunate no.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229603">
				<div id="div-comment-229603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229603">
			November 24, 2004 at 3:20 pm</a>		</div>

		<p>&quot;Search Windows sources for&#8230;&quot; Just because the function exists doesn&#8217;t mean that OLE folks have given the shell team permission to call it. And it still doesn&#8217;t fix the &quot;nested drop target&quot; problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229613">
				<div id="div-comment-229613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229613">
			November 24, 2004 at 4:21 pm</a>		</div>

		<p>I think of taskbar buttons as title bars. It should open a file if possible. Whatever a titlebar drop does that&#8217;s what a taskbar button drop does.</p>
<p>Plus Drag Drop needs to be implemented on Installer Shortcuts. How was that missed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229623">
				<div id="div-comment-229623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229623">
			November 24, 2004 at 4:28 pm</a>		</div>

		<p>&quot;How was that missed.&quot; Beats me. Ask somebody on the Installer team.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229643">
				<div id="div-comment-229643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">George Bailey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229643">
			November 24, 2004 at 6:24 pm</a>		</div>

		<p>Maybe it&#8217;s because it&#8217;s a bad idea. You drag something to the taskbar and it just gets swallowed up, without proper feedback and interaction. And without the feedback there&#8217;s no way to notice a mistake. If you accidentally dropped it on the wrong button, then what you dropped is now in the wrong place, but you don&#8217;t know it. So you continue on your merry way dragging and (mis)dropping. Then next week you notice all your files are &quot;gone.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229663">
				<div id="div-comment-229663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://andyandy.sprayblogg.no' rel='external nofollow' class='url'>Andreas H&#228;ber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229663">
			November 24, 2004 at 7:54 pm</a>		</div>

		<p>First when I tried to drag something on a taskbar button I found it quite strange. </p>
<p>But it&#8217;s a lot easier that the window pops up instead of having some &#8216;default drop target&#8217;. I guess a lot of people will have a different idea of what the default should be then. </p>
<p>For example the e-mail example Raymond wrote in an earlier comment. Most obvious would be to have the message body set as the &#8216;default drop target&#8217;, but a lot of times you&#8217;d wish it was the subject field instead&#8230; and then you  wish the window would pop up instead ;)</p>
<p>I&#8217;m happy with how it works in XP today.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229673">
				<div id="div-comment-229673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RV</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229673">
			November 24, 2004 at 8:03 pm</a>		</div>

		<p>&quot;The laws of OLE and the taskbar are both owned by the same company.&quot; </p>
<p>&quot;That&#8217;s like saying that the laws of Oregon and Californa are owned by the same country. Sure, they both belong to a single larger entity, but they have their own separate laws.&quot; </p>
<p>Isn&#8217;t that synonymous to &quot;Microsoft is too disorganized/unfocsed to make obvious improvements to their products in a timely manner?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229683">
				<div id="div-comment-229683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229683">
			November 24, 2004 at 8:06 pm</a>		</div>

		<p>It means that each group within Microsoft is given a high degree of autonomy to make their own decisions. (And there are many things that seem &quot;obvious&quot; but which have hidden gotchas that turn it into &quot;a bad idea&quot;.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229563">
				<div id="div-comment-229563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229563">
			November 24, 2004 at 2:10 pm</a>		</div>

		<p>G,</p>
<p>&quot;OK Mr. Mac fanboy, if I drop a file onto Windows Explorer taskbar button, is it going to paste the file into the right pane or the left pane? What did I mean for it to do?&quot;</p>
<p>Now you&#8217;re just inventing problems.</p>
<p>Let&#8217;s see.. my taskbar button is labeled &#8216;Foo&#8217;. Foo is a folder. What do *you* think I want to do?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229693">
				<div id="div-comment-229693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229693">
			November 25, 2004 at 12:37 am</a>		</div>

		<p>on Mac OS X, dragging something onto an application in the Dock does nothing, unless the object is a file &#8211; in which case the icon will darken if the computer believes the application can open the file.  dropping the file on an application that darkens will either open the file or do certain special actions dependent on the application in question (in Terminal, the absolute path to the file is copied to the command line, for instance).</p>
<p>Which is to say: Mac OS X doesn&#8217;t even bother telling you that it doesn&#8217;t do much, it just shows the drag-failure animationoid (the stuff being dragged speeds back to its original position)</p>
<p>Vorn</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229703">
				<div id="div-comment-229703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229703">
			November 25, 2004 at 12:40 am</a>		</div>

		<p>But surely the shell team gets consulted on things like SHORTCUTS.</p>
<p>And you can harras them today. I have to swim for a couple of years (and dodge the US coast guard) to harrass them.</p>
<p>Maybe cmd needs to be removed from MS employee&#8217;s computers so they need to eat their own cat food (sorry I believe in non speciesist language &#8211; if MS want to refer to computer people as HER (as if) then &#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229723">
				<div id="div-comment-229723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229723">
			November 25, 2004 at 2:07 am</a>		</div>

		<p>Raymond,</p>
<p>why does Windows show the message in the first place? Why does the Taskbar give the cue that dropping is possible, to later tell &quot;oops, sorry, you can&#8217;t do that&quot;? There are plenty of places where you can&#8217;t drop stuff on, and where the mouse cursor just becomes a &quot;prohibited&quot; sign &#8212; BEFORE the user releases the drop button. Isn&#8217;t it strange that the Taskbar doesn&#8217;t follow this practice?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229653">
				<div id="div-comment-229653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229653">
			November 24, 2004 at 6:30 pm</a>		</div>

		<p>The intuition thing is actually possible.  What you have to do is work out the action that is most likely most of the time and do it.  Seperately you *must* have a way of always being able to do an undo, and it must be a complete undo so that state is exactly what it was beforehand.</p>
<p>And I&#8217;ll be the first to raise my hand to say my code doesn&#8217;t have *any* undo at the moment, but I am working on it :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229733">
				<div id="div-comment-229733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229733">
			November 25, 2004 at 2:32 am</a>		</div>

		<p>Isn&#8217;t it obvious? Because you <em>can</em> do something, you just have to wait 5-10 seconds for it to happen. (I wish it was shorter, but oh well.) There&#8217;s no good solution to the problem; what it does now is as good as anything else. Dean&#8217;s answer is very true.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229743">
				<div id="div-comment-229743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.divil.co.uk/net' rel='external nofollow' class='url'>Tim Dawson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229743">
			November 25, 2004 at 2:44 am</a>		</div>

		<p>It <em>does</em> follow that practice &#8211; I get the &quot;you can&#8217;t drop here&quot; cursor while hovering over taskbar buttons.</p>
<p>My opinion is that there should be some &quot;default&quot; drop target for a window. Clearly it&#8217;s too late to do anything about that now, but at least it would lessen frustration when [i]some[/i] buttons could be dropped on to. For the ones that can&#8217;t, an equally helpful message could be displayed &quot;this program requires you to drop items within its window as there are several drop targets&quot; (only in a more user friendly way).</p>
<p>Obviously such behaviour cannot be added to OLE in retrospect (as least not easily). What a good thing you&#8217;re writing a completely new presentation framework for Longhorn and rewriting explorer in managed code to go along with it. I&#8217;m sure this behaviour will be implemented on this clean slate.</p>
<p>Right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229753">
				<div id="div-comment-229753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229753">
			November 25, 2004 at 3:03 am</a>		</div>

		<p>I like the way when Microsoft makes things work automagically, people complain. On the other hand when they say &quot;Please do it this way instead&quot; everyone is still complains. Oh, and when they have a default, everyone complains that they want to be able to alter it to the opposite. And when there isn&#8217;t a default because it&#8217;s too hard to choose which default to have, everyone complains that there should be a default. </p>
<p>Ingrates!</p>
<p>Actually once you know the rule about not releasing the mouse button, it seems to work ok.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229763">
				<div id="div-comment-229763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">h.u.j</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229763">
			November 25, 2004 at 4:12 am</a>		</div>

		<p>Where&#8217;s Norman Diamond? I bet his bitching on this would be best so far :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229773">
				<div id="div-comment-229773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.blacksun.org.uk/' rel='external nofollow' class='url'>Paul</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229773">
			November 25, 2004 at 5:22 am</a>		</div>

		<p>To be honest, given that none of the options available are particularly great, I think Microsoft have in this case chosen the lesser of many weevils. </p>
<p>Okay, it&#8217;s not ideal, but the message describes the problem and tells you what to do instead. I wish all error messages were as helpful!</p>
<p>(Before someone takes that the wrong way, I mean &quot;all messages from all apps and operating systems&quot;, not &quot;all Windows messages&quot;. Although there&#8217;s that too.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229783">
				<div id="div-comment-229783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Petr Kadlec</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229783">
			November 25, 2004 at 5:38 am</a>		</div>

		<p>Oh, come on, people! Do you <em>really</em> believe that completely disallowing a functionality just because some applications wouldn&#8217;t be able to use it is good? (Why is there anything like DnD? Some applications are not able to receive dropped files. &quot;To the end user, this manifests as inconsistent and confusing behavior.&quot; So we should remove DnD from Windows altogether, shouldn&#8217;t we?)</p>
<p>The mere existence of the big message box that has to explain the situation to the user is an evidence that this is wrong.</p>
<p>Of course, there is probably nothing we can do about it now (backwards compatibility etc. etc.), but pretending that this behaviour is correct&#8230;? I don&#8217;t get it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229793">
				<div id="div-comment-229793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229793">
			November 25, 2004 at 6:24 am</a>		</div>

		<p>Speak for yourself, Raymond. On my OS (W2K) the application is restored and I can drop my file there. This is, IMO, the correct thing to do. A message box is&#8230;err&#8230;&quot;sub-optimal&quot;.</p>
<p>Or are you talking about something else entirely? Or just checking whether we are awake or not? (BTW, on Win 98 I think the behaviour is as you describe, but I don&#8217;t have it here to check.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229813">
				<div id="div-comment-229813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229813">
			November 25, 2004 at 6:42 am</a>		</div>

		<p>Raymond &#8211; I&#8217;m not agruing that it must be done, or even that it&#8217;s a good idea. However, I&#8217;ve taken issue with your claim that it is technically impossible to do, that the only thing stopping the shell team from implementing this feature is lack of GetDropTargetFromWindow function or equivalent.</p>
<p>I believe I have shown that it is indeed possible, and not even particularly onerous, to retrieve an IDropTarget from the window the taskbar button represents, and to use it in such a way that dragging over and dropping onto a taskbar button is equivalent to dragging over and dropping onto the title bar of the corresponding window.</p>
<p>Now, there may well be other reasons not to do it this way, e.g. from usability standpoint, some of which have been advanced in this thread. I&#8217;m only stating that in my humble opinion the explanation you gave in the article, citing technical limitations, is meritless.</p>
<p>I don&#8217;t know what you mean by &quot;nested drop target&quot;. I&#8217;m unfamiliar with the term, and so is MSDN.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229823">
				<div id="div-comment-229823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229823">
			November 25, 2004 at 6:49 am</a>		</div>

		<p>@Igor &#8216;in my humble opinion the explanation you gave in the article, citing technical limitations, is meritless.&#8217;</p>
<p>To be fair to Raymond he did say that HE WAS JUST GUESSING &#8211; AND IN BOLD LETTERS!!!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229843">
				<div id="div-comment-229843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">beuges</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229843">
			November 25, 2004 at 7:10 am</a>		</div>

		<p>Moi, the application is only restored after a brief pause.  If you drag something to the taskbar and release the mouse as soon as you are over a taskbar button, you get the error message.</p>
<p>Igor, Raymond&#8217;s already mentioned that the method you described above of obtaining an IDropTarget is in the wrong address space to start off with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229863">
				<div id="div-comment-229863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229863">
			November 25, 2004 at 7:31 am</a>		</div>

		<p>beuges &#8211; ok, ta. I think I&#8217;ve just got so used to the behaviour over the years I&#8217;d forgotten that!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229873">
				<div id="div-comment-229873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229873">
			November 25, 2004 at 7:36 am</a>		</div>

		<p>Right. I&#8217;m not trying to insult Raymond or anything like that. I don&#8217;t see how my comment could be construed this way, but if it comes across as offensive, I&#8217;m truly sorry, this definitely was not my intention.</p>
<p>Raymond made a claim, however tentative. I challenged it, believing it to be incorrect. Raymond defended his position, I defended mine. I don&#8217;t see anything wrong with it. Now somebody reading this thread can have all the facts in front of them and make their own informed decision.</p>
<p>I guess I&#8217;m just pedantic &#8211; I find it difficult to pass by an undotted &#8216;i&#8217; or an uncrossed &#8216;t&#8217;. Please feel free to disregard my rants.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229903">
				<div id="div-comment-229903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Tandetnik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229903">
			November 25, 2004 at 7:41 am</a>		</div>

		<p>beuges: &quot;Raymond&#8217;s already mentioned that the method you described above of obtaining an IDropTarget is in the wrong address space to start off with&quot;.</p>
<p>&#8230; and I responded by showing a way to marshal the pointer to the right address space, which happens to be the same technique DoDragDrop API uses.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-229913">
				<div id="div-comment-229913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229913">
			November 25, 2004 at 7:43 am</a>		</div>

		<p>And I responded that the shell team was not given permission by the OLE team to use their internal interface.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229963">
				<div id="div-comment-229963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.divil.co.uk/net/' rel='external nofollow' class='url'>Tim Dawson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-229963">
			November 25, 2004 at 8:26 am</a>		</div>

		<p>Do different teams always ask permission before using an api or feature that isn&#8217;t well documented, or documented at all?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230053">
				<div id="div-comment-230053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230053">
			November 25, 2004 at 10:50 am</a>		</div>

		<p>Tim: Duh, that&#8217;s just good engineering practice. If you&#8217;re writing a linux kernel module, do you just go call the memory manager&#8217;s internal functions without permission?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230143">
				<div id="div-comment-230143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230143">
			November 25, 2004 at 1:53 pm</a>		</div>

		<p>foxyshadis &#8212; d&#8217;oh! didn&#8217;t even know that something would happen after such a long time. Now the current policy makes a lot of sense to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230263">
				<div id="div-comment-230263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230263">
			November 25, 2004 at 10:57 pm</a>		</div>

		<p>11/25/2004 4:12 AM h.u.j</p>
<p>&gt; Where&#8217;s Norman Diamond? I bet his bitching<br />
<br />&gt; on this would be best so far :) </p>
<p>Sorry to disappoint you  ^_^  I have no complaint about sometimes being unable to drop, and here&#8217;s why:</p>
<p>As mentioned a few days ago, with rare exceptions, I do not intentionally do drag-and-drop.  Exceptions are rare things such as relocating items on the start menu (actually unrelocating them after they were automatically misrelocated during installation of new programs).  Otherwise I do not intentionally do drags and drops.  90% of the time when my fingers do a drag-and-drop operation it was something I didn&#8217;t want to do.  I would like to set an option to always bring up a menu so I can always cancel whatever was going to happen.</p>
<p>In Windows Explorer I often use Ctrl-C (or Ctrl-X) and then Ctrl-V.  When a Ctrl-C keystroke didn&#8217;t reach Windows Explorer the results can be irritating, but at least I see what happens.  When an unintended drag-and-drop occurs, I might or might not notice that something unexpected happened, then figure out what it was and undo it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230313">
				<div id="div-comment-230313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.divil.co.uk/net' rel='external nofollow' class='url'>Tim Dawson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230313">
			November 26, 2004 at 1:57 am</a>		</div>

		<p>Raymond: Probably. I don&#8217;t know, that&#8217;s why I asked. There is no need to be insulting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230323">
				<div id="div-comment-230323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230323">
			November 26, 2004 at 2:46 am</a>		</div>

		<p>I reckon I should be made CEO of MS for 6 months to fix their organisational structures.</p>
<p>Raymond &#8211; You canb go write wordperfect convertors for the office team.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230423">
				<div id="div-comment-230423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230423">
			November 26, 2004 at 7:44 am</a>		</div>

		<blockquote><p>
  Do different teams always ask permission before<br />
  <br />&gt;using an api or feature that isn&#8217;t well<br />
  <br />&gt;documented, or documented at all?</p>
<p>Yeah, it&#8217;s not like Microsoft to have, and/or use undocumented APIs now, is it?</p>
<p>Especially for internal use.</p>
<p>David
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230503">
				<div id="div-comment-230503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.gregcons.com/kateblog' rel='external nofollow' class='url'>Kate Gregory</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230503">
			November 26, 2004 at 10:18 am</a>		</div>

		<p>I want to drag onto the taskbar because the place I want to drop is hidden behind other windows. I don&#8217;t drag onto the taskbar any more, ever, because I know a trick that will spare you from it. That&#8217;s right, never again will I wait with the mouse button held down for a window to rise up from the taskbar:</p>
<p><a target="_new" href="http://www.gregcons.com/kateblog/CommentView.aspx?guid=b81c5b4e-f3df-4d54-9c3f-befd30157435" rel="nofollow">http://www.gregcons.com/kateblog/CommentView.aspx?guid=b81c5b4e-f3df-4d54-9c3f-befd30157435</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230613">
				<div id="div-comment-230613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-230613">
			November 26, 2004 at 10:18 pm</a>		</div>

		<p>So let me get this straight, you actually want MS to start using <em>more</em> undocumented internal APIs that thus become known APIs and backwards compatibility problems so that when Windows makes a leap to, say, 64-bit, DnD slows down to quarter speed because they were forced to keep a 32-bit data structure that the API returns? (or, say, endianness.)</p>
<p>Maybe it&#8217;s already past that stage, and the API is psuedo-public at this point, but even if it is by what logic is making bad news worse a good idea?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231513">
				<div id="div-comment-231513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-231513">
			December 1, 2004 at 4:18 am</a>		</div>

		<p>The actual reason that you can&#8217;t do this is that Apple patented this behaviour.</p>
<p>Obviously it wouldn&#8217;t be hard to at least do the right thing in the (common) easy cases.</p>
<p>Yay for software patents!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-232043">
				<div id="div-comment-232043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Showman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-232043">
			December 2, 2004 at 1:43 pm</a>		</div>

		<p>&quot;Yeah, it&#8217;s not like Microsoft to have, and/or use undocumented APIs now, is it? Especially for internal use.&quot;</p>
<p>APIs at MS come in 3 flavors: public, MS internal, and component internal. &quot;Undocumented&quot; APIs that are called across Windows components still require a contract (not in the legal sense) between teams, so that team A will continue supporting every MS-internal API that team B is using, or else will work with team B directly when making a breaking change to an API. This is just a common-sense reality in a large organization like Windows.</p>
<p>Think of it like this: my wife has the ability to remove the fourth stair from my staircase, but if she did it without telling me I would break my neck some night while walking down the stairs. Just because a team has the technical capability to call another team&#8217;s private APIs doesn&#8217;t mean it&#8217;s a good idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-233613">
				<div id="div-comment-233613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Severian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-233613">
			December 9, 2004 at 2:08 am</a>		</div>

		<p>Though I remember being irritated by this behavior in the past, on my WinXP SP2 system here at home, it takes less than 1/2 second for the app to restore &#8212; usually before I drop. The only thing I have to remember is that I can&#8217;t drop it &lt;strong&gt;here&lt;/strong&gt;, I have to move the mouse and drop it &lt;strong&gt;there&lt;/strong&gt;, into the place in the application it belongs. It only took a few times to learn this when the behavior changed!</p>
<p>One way forward would be for applications to be notified when a file is dropped directly on the taskbar, so they can either perform their only option, or provide a menu to request a specific action/place to drop.</p>
<p>However, that would be complicated because the droppee both has to know &lt;strong&gt;where&lt;/strong&gt; and &lt;strong&gt;how&lt;/strong&gt; to drop it. How could these two selections be handled without a lot of extra DnD/OLE code?</p>
<p>My suggestion: Applications should be able to declare their &lt;strong&gt;task bar icons&lt;/strong&gt; as DnD targets. It should be made clear to us developers that doing this implies a single drop target: applications with multiple windows that can receive objects (or trees/lists that can receive them at different locations) should be discouraged, since they don&#8217;t have ESP about their users&#8217; intentions.</p>
<p>For my application, I would have no qualms providing the obvious &lt;strong&gt;non-destructive&lt;/strong&gt; default: display the object if possible: exactly what happens when you drag to my title bar. For other apps, it might be more problematic.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-233623">
				<div id="div-comment-233623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Severian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041124-00/?p=37213#comment-233623">
			December 9, 2004 at 2:09 am</a>		</div>

		<p>Sorry about the tags; I will read before I post again. I&#8217;m too used to places that know what HTML is.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>