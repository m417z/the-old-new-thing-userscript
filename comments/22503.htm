<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (24)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-625443">
				<div id="div-comment-625443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625443">
			May 1, 2008 at 10:11 am</a>		</div>

		<p>Limitations?</p>
<p>1) Just because it&#8217;s a &quot;dialog&quot; doesn&#8217;t mean it&#8217;s a modal dialog. &nbsp;Someone could have created a &quot;dialog&quot; as a tool window just to use dialog resources, and you wouldn&#8217;t know the difference. &nbsp;And you can&#8217;t just check by seeing if the parent&#8217;s disabled, because that could be because a real model dialog is up as well.</p>
<p>2) Some real dialogs will subclass the dialog window class. &nbsp;This will not find those.</p>
<p>3) Related to number 1, anyone can use a dialog in any way that they want to, so even if you know something &quot;is&quot; a dialog, it doesn&#8217;t mean that you can manipulate it like standard dialogs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625473">
				<div id="div-comment-625473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625473">
			May 1, 2008 at 11:24 am</a>		</div>

		<p>How do I get the atom for an existing class?</p>
<p>In my case I want to know if a control is a combo box and I want to avoid GetClassName.</p>
<p>GetClassInfo doesn&#8217;t return the atom, and GetClassLong requires an already created window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625493">
				<div id="div-comment-625493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625493">
			May 1, 2008 at 12:11 pm</a>		</div>

		<p>a (standard) combo box has a known class name.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-eric-brown odd alt thread-odd thread-alt depth-1" id="comment-625503">
				<div id="div-comment-625503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Eric+C+Brown' rel='external nofollow' class='url'>Eric C Brown</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625503">
			May 1, 2008 at 12:30 pm</a>		</div>

		<p>Ivo &#8211; how are you locating the control without also getting the window?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-625533">
				<div id="div-comment-625533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625533">
			May 1, 2008 at 1:29 pm</a>		</div>

		<p>@Jack Mathews:</p>
<p>4) CreateDialogIndirect/DialogBoxIndirect allow you to use a DLGTEMPLATEEX structure, which allows you to specify your own window class for your shiny new dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625553">
				<div id="div-comment-625553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625553">
			May 1, 2008 at 1:42 pm</a>		</div>

		<p>Another use for the atom returned by RegisterClass:</p>
<p>CreateWindow((LPCTSTR)(ULONG)RegisterClass(&#8230;), &#8230;);</p>
<p>Note the casts, needed because just a cast to LPCSTR would put DS in the high word in 16-bit Windows.</p>
<div class=post>[<i>Wait I thought I already mentioned that. Yes, the entire first half of the article. Not sure what your point is. Maybe you just like hearing yourself talk. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625563">
				<div id="div-comment-625563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625563">
			May 1, 2008 at 1:57 pm</a>		</div>

		<p>[Wait I thought I already mentioned that. Yes, the entire first half of the article. Not sure what your point is. Maybe you just like hearing yourself talk. -Raymond]</p>
<p>I mean you can&#8217;t do this with strings.</p>
<div class=post>[<i>Not sure what &#8220;this&#8221; is. All you did was expand the MAKEINTATOM macro. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625573">
				<div id="div-comment-625573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625573">
			May 1, 2008 at 1:58 pm</a>		</div>

		<p>Because you don&#8217;t return a pointer as a return value often, because what about the memory used, while with an atom you don&#8217;t have to worry about that.</p>
<div class=post>[<i>Not sure what that has to do with expanding the MAKEINTATOM macro inline. Please do not post multiple comments in rapid succssion &#8211; it&#8217;s a violation of the ground rules. You&#8217;re the only person who violates it regularly. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625603">
				<div id="div-comment-625603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625603">
			May 1, 2008 at 3:33 pm</a>		</div>

		<p>Lets rewrite this code as:</p>
<p>CreateWindow(MAKEINTATOM(RegisterClass(&#8230;)), &#8230;);</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625613">
				<div id="div-comment-625613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625613">
			May 1, 2008 at 3:35 pm</a>		</div>

		<p>expanding the MAKEINTATOM macro inline is not my point.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625633">
				<div id="div-comment-625633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ens</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625633">
			May 1, 2008 at 4:00 pm</a>		</div>

		<p>I&#8217;m a bit confused about what your point actually is. &nbsp;If it&#8217;s not the MAKEINTATOM macro, then what remains is you&#8217;re inlining RegisterClass and not explicity storing a variable (relying on compiler magic to take care of the mean old nested function call). &nbsp;Oh, and made it less readable. &nbsp;I guess if it helps you remember the format of your one-off hwnds, then alright.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625643">
				<div id="div-comment-625643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625643">
			May 1, 2008 at 4:07 pm</a>		</div>

		<p>&#8220;what remains is you&#8217;re inlining RegisterClass and not explicity storing a variable (relying on compiler magic to take care of the mean old nested function call).&#8221;</p>
<p>That is exactly my point, and you can&#8217;t do this with strings.</p>
<div class=post>[<i>That point has nothing to do with the article. Oh, and you can inline strings too: </p>
<pre>PCTSTR pszClassName = TEXT(&#8220;Scratch&#8221;);
CreateWindow(pszClassName, &#8230;);

</pre>
<p>becomes </p>
<pre>CreateWindow(TEXT(&#8220;Scratch&#8221;), &#8230;)

</pre>
<p>Woo-hoo, I inlined the string. What this has to do with the article I have no idea. All you did was perform by hand what the compiler does automatically. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625653">
				<div id="div-comment-625653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625653">
			May 1, 2008 at 4:24 pm</a>		</div>

		<p>I am not talking about inlining strings, I am talking about inlining a function call.</p>
<div class=post>[<i>I give up. Woo-hoo, you can inline a function call. I would never have thought of that. You&#8217;re so smart. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625673">
				<div id="div-comment-625673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625673">
			May 1, 2008 at 5:42 pm</a>		</div>

		<p>My mind has just been boggled.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625713">
				<div id="div-comment-625713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625713">
			May 1, 2008 at 5:59 pm</a>		</div>

		<p>@Eric Brown: I have a window (HWND). I want to check if it is a combo box or not. I can call GetClassName and see if it returns WC_COMBOBOX. I can also call GetWindowWord(GWW_ATOM) and compare it with the atom for the combo box, which is hopefully faster. But how to get the atom corresponding to WC_COMBOBOX?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625733">
				<div id="div-comment-625733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrismcb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625733">
			May 1, 2008 at 6:40 pm</a>		</div>

		<p>@Ivo: As Eric stated a combo box has a standard class name. So call FindAtom on that name?</p>
<p>@Yuhong yeah you can&#8217;t do it with strings because RegisterClass doesn&#8217;t return a string. But so what? What did you save?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625743">
				<div id="div-comment-625743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">IUnknown</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625743">
			May 1, 2008 at 6:55 pm</a>		</div>

		<p>There&#8217;s more! You can actually inline functions!</p>
<p>inline BOOL isNull( const INT_PTR x )</p>
<p>{</p>
<p>&nbsp; &nbsp;return x == 0;</p>
<p>}</p>
<p>(That&#8217;s probably the most useless function I wrote, ever.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-madq42 odd alt thread-odd thread-alt depth-1" id="comment-625753">
				<div id="div-comment-625753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MadQ1' rel='external nofollow' class='url'>MadQ1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625753">
			May 1, 2008 at 8:36 pm</a>		</div>

		<p>Ivo: You can use Active Accessibility to find out if a window is a combobox, but this only works for windows that have already processed the WM_CREATE message. The nice thing is that it also works for superclassed windows (hi, Windows Forms! ;) Oh, and make sure to never try this with windows that do not have the WS_CHILD style.</p>
<p>if( 65536+5 == SendMessage(hWnd, WM_GETOBJECT, NULL, OBJID_QUERYCLASSNAMEIDX) )</p>
<p>&nbsp; &nbsp;then it&#8217;s a combobox;</p>
<p>See ms-help://MS.MSDNQTR.v90.en/msaa/msaapndx_5at4.htm if you have the VS 2008 MSDN library, or <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/ms697642" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms697642</a>(vs.85).aspx</p>
<p>Erm, and lest I be &quot;mostly wrong anyway&quot; again, I should say something on topic&#8230; you see, this way you don&#8217;t even have to mess with ATOMs, thereby avoiding any of the Exercise&#8217;s limitations.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625773">
				<div id="div-comment-625773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625773">
			May 1, 2008 at 10:51 pm</a>		</div>

		<p>chrismcb: FindAtom is exactly what I need. Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-625813">
				<div id="div-comment-625813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">scorpion007</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625813">
			May 2, 2008 at 1:11 am</a>		</div>

		<p>Raymond, it seems that GetWindowWord is deprecated in favour of GetWindowLong, and GetWindowLong&#8217;s documentation don&#8217;t mention GWW_ATOM or anything similar.</p>
<p>Should we still rely on it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-625903">
				<div id="div-comment-625903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-625903">
			May 2, 2008 at 1:11 pm</a>		</div>

		<p>@Yuhong Bao: I am not talking about inlining strings, I am talking about inlining a function call.</p>
<p>No, you&#8217;re not even talking about that &#8211; you&#8217;re talking about *nested* function calls, which like every other post you make here has nothing to do with Raymond&#8217;s original subject.</p>
<p>Are you just really dense? Or are you just *trying* to be annoying and irritating?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-626063">
				<div id="div-comment-626063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johann Gerell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-626063">
			May 4, 2008 at 5:43 pm</a>		</div>

		<p>@ IUnknown:</p>
<blockquote><p>
  (That&#8217;s probably the most useless function I wrote, ever.)
</p></blockquote>
<p>Nooooo. You&#8217;ve just turned a blackbox expression to an easy testable nugget. Just toss in an ASSERT before the return!</p>
<p>;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-626243">
				<div id="div-comment-626243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">IUnknown</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-626243">
			May 5, 2008 at 4:17 pm</a>		</div>

		<p>@Johann: Wow, I never thought of that! Yeah, lets crash on null pointers! For free! :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-626773">
				<div id="div-comment-626773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Napalm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080501-00/?p=22503#comment-626773">
			May 6, 2008 at 11:54 pm</a>		</div>

		<p>For those of you who dont want to use the depreciated call GetWindowWord(hwnd, GWW_ATOM) you can use GetClassLong(hwnd, GCW_ATOM) instead. I am not too sure why Raymond didn&#8217;t choose this in the first place. Maybe it was his love of 16bit Windows?</p>
<p>@Raymond: Please tell us.</p>
<p>Napalm</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>