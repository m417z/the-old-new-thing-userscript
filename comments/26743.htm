<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (469)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-269833">
				<div id="div-comment-269833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://chuchuva.com' rel='external nofollow' class='url'>Pavel Chuchuva</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-269833">
			April 12, 2005 at 12:15 am</a>		</div>

		<p>How about DLL details? I&#8217;m interesting in history of DLL&#8217;s and the way you use them. What&#8217;s the difference between dllimport and dllexport? Why dllimport in declaration of method that will be used others?</p>
<p>Thank you.</p>
<div class="post">[<i>The difference is that they are completely unrelated. Here&#8217;s<br />
<a href="http://blogs.msdn.com/oldnewthing/archive/2006/07/26/679044.aspx" mce_href="http://blogs.msdn.com/oldnewthing/archive/2006/07/26/679044.aspx" rel="nofollow">what dllimport does</a> and here&#8217;s <a href="http://blogs.msdn.com/oldnewthing/archive/2004/01/12/57833.aspx" mce_href="http://blogs.msdn.com/oldnewthing/archive/2004/01/12/57833.aspx" rel="nofollow">what dllexport does</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-270733">
				<div id="div-comment-270733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig Ward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-270733">
			April 15, 2005 at 3:05 am</a>		</div>

		<p>What form do application hacks usually take in Windows? Are there statememts like the following littered throughout the source-code: </p>
<p>if (&lt;app caption&gt; == &#8220;BuggyButPopularProgram&#8221;) { <br />// do something&#8230; <br />}</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#408419" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-270743">
				<div id="div-comment-270743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig Ward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-270743">
			April 15, 2005 at 3:06 am</a>		</div>

		<p>Does Microsoft internally use MFC for writing Windows apps? How about VB?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/01/15/1471731.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-270953">
				<div id="div-comment-270953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dominicself.co.uk' rel='external nofollow' class='url'>Dominic Self</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-270953">
			April 15, 2005 at 11:39 am</a>		</div>

		<p>I&#8217;ve always wanted to know why Control Panel applets don&#8217;t show up on the taskbar. It&#8217;s very easy to lose track of them &#8211; I don&#8217;t use Alt+Tab so I have to minimise all my windows to find them sometimes. Was there a good reason for this once upon a time?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2005/06/08/426720.aspx" rel="nofollow">Topic accepted</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271033">
				<div id="div-comment-271033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271033">
			April 15, 2005 at 5:25 pm</a>		</div>

		<p>PathFileExists() seems obvious. But it doesn&#8217;t work for a remote drive without a drive letter. <br />(Why is it so, BTW ? What&#8217;s the problem with UNCs ?) <br />Failure of GetFileAttributes() remains the method I use but I have never been comfortable with it. </p>
<p>TIA.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#408725" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271113">
				<div id="div-comment-271113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert M. Shaw</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271113">
			April 16, 2005 at 11:17 am</a>		</div>

		<p>Dear Raymond,</p>
<p> I get a kick out watching self appointed education Gods.</p>
<p>For your information under Title 20 of the U S Eduation Code 1093 Distance Learning and Diminstration Programs are legal.</p>
<p> In fact the U S Goverment like the idea so much they created Western Gobernors University just to monitor the programs.</p>
<p> I also noted that you seem to think Kennedy-Western University is a DEgree Mill?</p>
<p>Would you please note that the Oregon State Education Dept also thought so and Kennedy-Western sued them and won the case.</p>
<p> I to enjoy people that display their ignorance in frount of all of us.<br />
<br />Robert M. Shaw</p>
<div class="post">[<i>First, I never claimed that diploma mills are illegal. Second, I never claimed that distance learning was bogus. Furthermore, unlike Kennedy-Western, Western Governors University is accredited (and as far as I can tell, was not created by the US government, as you claimed). Third, Kennedy-Western did not win the case. The case was settled out of court. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271153">
				<div id="div-comment-271153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://david.acz.org/' rel='external nofollow' class='url'>David Phillips</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271153">
			April 17, 2005 at 4:33 pm</a>		</div>

		<p>There seems to be very little documentation for handling multiple monitors. For example, I wrote a program that randomly changes the desktop wallpaper and I would like it to able to set a different one for each monitor. Ultramon is able to do it: <a href="http://www.realtimesoft.com/ultramon/tour/wallpaper.asp" target=_new rel=nofollow rel="nofollow">http://www.realtimesoft.com/ultramon/tour/wallpaper.asp</a> </p>
<p>Is there a supported way to do this with Win32, or does that program use fancy tricks?</p>
<div class=post>[<i>The program is pulling some <a href="http://blogs.msdn.com/oldnewthing/archive/2007/09/24/5083738.aspx" rel="nofollow">sort of trick</a> because the built-in wallpaper support uses the same wallpaper on all monitors. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271643">
				<div id="div-comment-271643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.gsection.com' rel='external nofollow' class='url'>cmonachan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271643">
			April 20, 2005 at 5:58 am</a>		</div>

		<p>Could you perhaps explain why CPropertySheet::DoModal() has documented &#8220;it may cause a first-chance exception&#8221;? </p>
<p>I&#8217;m assuming this is another backward compatibility fix, where people are passing in dialog resources of the wrong style and wanting them to work?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/01/08/1434501.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271863">
				<div id="div-comment-271863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mikepetry.blogspot.com/' rel='external nofollow' class='url'>Mike Petry</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271863">
			April 20, 2005 at 6:59 pm</a>		</div>

		<p>Why can you dereference a COM interface pointer and pass it to a function with a Com interface reference. </p>
<p>The call. <br />OutputDebugString(_T(&#8220;IntfByRef::Execute &#8211; Beginn&#8221;)); <br />BadBoy badone; <br />CComPtr&lt;IDoer&gt; Doer; <br />Doer.CoCreateInstance(CLSID_Doer, NULL, CLSCTX_INPROC_SERVER); </p>
<p>// created a raw pointer &#8211; maybe the <br />// smart pointer was effecting it some how. <br />IDoer* Doer2; <br />Doer.CopyTo(&amp;Doer2); </p>
<p>badone.stupid_method(*Doer2); <br />Doer2-&gt;Release(); <br />// no still works. </p>
<p>The function called. </p>
<p>void stupid_method(IDoer&amp; IDoerRef) <br />{ <br />IDoerRef.Do(); <br />CComQIPtr&lt;IDispatch&gt; WatchIt(&amp;IDoerRef); </p>
<p>if( WatchIt ) <br />OutputDebugString(_T(&#8220;QI the address of the ref works &#8211; this is weirdn&#8221;)); <br />else <br />OutputDebugString(_T(&#8220;At least trying to QI the address of the ref failsn&#8221;)); <br />} </p>
<p>I found some code written like this during a code review. It is wrong but it seems to work.</p>
<div class=post>[<a href="http://blogs.msdn.com/oldnewthing/archive/2007/03/26/1949002.aspx" rel="nofollow">Response</a>. -Raymond]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271903">
				<div id="div-comment-271903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com/blog' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271903">
			April 21, 2005 at 5:12 am</a>		</div>

		<p>According to the docs of the API, UNCs are not supported even though remote mounted drives are. </p>
<p>What makes UNCs so special ? </p>
<p>What is the alternative to check for existence of a file given a UNC path ? <br />I used to check that GetFileAttributes() fails, but it looks like a dirty trick at best. </p>
<p>TIA.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#408725" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271913">
				<div id="div-comment-271913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-271913">
			April 21, 2005 at 5:14 am</a>		</div>

		<p>Oops! Sorry for the duplicate. I, too, start to recycle my old suggestions ! :-D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272183">
				<div id="div-comment-272183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-272183">
			April 21, 2005 at 4:31 pm</a>		</div>

		<p>Why are the copy/cut/paste buttons not disabled when there&#8217;s nothig to copy/cut/paste ? </p>
<p>Why do different buttons have different behaviours ? e.g.: The back and forward buttons <em>are</em> disabled when you can&#8217;t go back/forward, as opposed to the copy/cut/paste buttons.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/01/22/1508494.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274653">
				<div id="div-comment-274653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Spoon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-274653">
			May 7, 2005 at 2:34 pm</a>		</div>

		<p>I would really like to see how to focus a window without bringing it to the top. I&#8217;ve learned that I can send a WM_NCACTIVATE to my windows to change their window borders to active or inactive. However, I can&#8217;t see to figure out how to actually chance the focus. As far as I can tell, there is no API call in Windows to focus a window without bringing it to top. <br />Thanks.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#415403" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274663">
				<div id="div-comment-274663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://kisrael.com/' rel='external nofollow' class='url'>Kirk Israel</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-274663">
			May 7, 2005 at 2:35 pm</a>		</div>

		<p>A while back I wrote up a list of grievences against the new(ish) file-search-as-sidebar paradigm and implementation in Windows explorer&#8230;I tried to be detailed and clear when I was just being subjective and I hoped as a UI / Windows internals guy you could speak about some of this&#8230; </p>
<p>1. You lose your place. Often, I&#8217;m still interested in keeping the current explorer view open when I hit Ctrl-F to conduct a search, but now my whole window becomes dedicated to this one search task. <br />2. Often in NT2K it takes a few seconds for the &#8220;Look in&#8221; field to be automatically field in with the location of the current Folder. Type in a quick search term, hit return, you get a message &#8220;A valid folder name must be entered&#8221; <br />3. The only way to know if you&#8217;re looking at a &#8220;real folder&#8221; or search results is to look at the window caption. And even when the caption indicates &#8220;Search Results&#8221;, it gives you no hint of what you were searching for. (Admittedly, a detailed description could get wordy, but still, having 3 windows that say &#8220;Search Results&#8221; in the task bar isn&#8217;t that useful in refinding a specific window.) <br />4. To get your normal explorer view again you have to hit an IE like &#8220;back&#8221; button. This seems like a broken paradigm to me, that viewing a folder is one &#8220;task location&#8221;, viewing search results is another &#8220;task location&#8221;. To my mental model, an explorer view represents a &#8220;noun&#8221;, and a search is more of a &#8220;verb&#8221;, results and all. It&#8217;s not like search results are really making up a &#8220;virtual folder&#8221;. <br />5. When you hit &#8220;back&#8221; to return to your folder view, the sidebar stays up. But the &#8220;Look in&#8221; field doesn&#8217;t get filled in with the new folder location unless you close the sidebar and reopen it. Conversely, if you close the sidebar, your search results remain&#8230;it looks just like a regular folder though! Also, the &#8220;Look in &#8221; field changes, but the main search fields remain filled with the old data, which is useful but inconsistent. <br />6. To start a search you either have to know the Ctrl-F mnemonic or use a graphical icon, there doesn&#8217;t seem to be a regular menu option for it. <br />7. If you accidentally hit &#8220;Up Folder&#8221; instead of &#8220;Back&#8221;, you get taken to a folder view of the Desktop. Why isn&#8217;t the &#8220;Folder Up&#8221; option greyed out while conducting a search? It&#8217;s not like it&#8217;s an easy way of backing up to the parent folder to redo the current search&#8230;that requires all the steps I outline in complaint 5&#8230; <br />8. Don&#8217;t get me started on XP&#8217;s default &#8220;File Searching For Dummies&#8221; mode. Maybe it&#8217;s good for novice users, and it can be turned off, but for exerienced users it&#8217;s just a pain in the butt, and we become amazed that other people who seem otherwise to be pretty bright always use it&#8230;or even worse, with the goofy animated assistant. </p>
<p>I suppose my main problem is I don&#8217;t share the idea I describe in complaint 4, and I really miss the old &#8220;hit Ctrl-F to launch a seperate simple find application that keeps your place here&#8221; . And maybe it&#8217;s sightly easier for them to give the options to view details, thumbnails, etc in the results. (Though Photo thumbnails are often very sluggish to load.) </p>
<p>Maybe they were looking for a way of letting someone repeat a carefully constructed search from a different location (hence the inconsistency in complaint 5) but it seems like a poor tradeoff to me. </p>
<p>This app is something I use on a daily basis, and not liking its forced browser model (probably some offshoot of that whole &#8220;oh but you can&#8217;t seperate the browser from the OS!&#8221;) is a constant low-level thorn in my side. </p>
<p>If anyone knows a way of getting back the old behavior when I hit ctrl-F, I&#8217;d love to hear about it. Even some registry setting that causes a Ctrl-F search to open up a new window rather than overtaking the current one would be a HUGE improvement. </p>
<p>&#8212; <br />since I wrote that, I also ran into the thing where you have to fiddle with a registry setting in order to get it to search through all files, not just file types explorer kind of knows about. I hate firing up textpad just to go hunting for a string in a directory tree!</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#415404" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274683">
				<div id="div-comment-274683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-274683">
			May 8, 2005 at 7:06 am</a>		</div>

		<p>Not exactly a GUI programming question, but I&#8217;m curious as to whether you have any insight on the &#8220;tooltips underneath other windows&#8221; problem. As an example, quite often (for no apparent reason), status icons will display their tooltips underneath the taskbar. Turning &#8220;always on top&#8221; for the taskbar off and then on again sometimes fixes it, but not always. Sometimes the tooltips get &#8216;stuck&#8217; under other windows. It is very frustrating, with a small enough tip string it can appear that tooltips are not working at all.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#415490" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274723">
				<div id="div-comment-274723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://runesbike.com/' rel='external nofollow' class='url'>Rune Moberg</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-274723">
			May 9, 2005 at 8:43 am</a>		</div>

		<p>I&#8217;ve already nagged about this via private e-mail (sorry! :) ), but I&#8217;ll post here as well in case you feel like attacking this topic. </p>
<p>While giving 64-bit Windows a spin, I decided to test some of its limitations. In 32-bit Windows, the default DesktopHeapSize is 3MB. In 64-bit it is 20MB (!). So far so good. (excellent in fact! Very happy camper right now) </p>
<p>Then I checked out the USERProcessHandleQuota value. It is still 10000, but can now be set to a much higher value (max used to be 18000 in XPSP2). I mistakenly thought that this was because the system limit used to be 65536 handles, but after testing I came up with a slightly different answer. </p>
<p>Creating 20000 invisible windows is <em>fast</em>, but the trouble starts when destroying those handles. I tried two ways: Call DestroyWindow() myself or simply leak the handles and leave the cleanup to the OS. </p>
<p>The first way is extremely slow. I tried with 30000 handles and using Task Manager I could see it count down slowly from 30000. Roughly 30 handles per second were released. </p>
<p>The second way is also slow, but faster than alternative #1. The downside is that instead of making the UI sluggish, it completely stalled UI interaction for a solid half minute (this time testing only 20000 handles). </p>
<p>My test rig was a dual Xeon. It kept on servicing network requests fine, but the UI went AWOL. Task Manager showed no spike afterwards and simply pretended nothing had ever happened. (I used to think TM could be trusted &#8212; but it clearly has limitations of its own) </p>
<p>The sweet spot is somewhere between 10000 and 18000 handles. Any more than that and the window manager goes bananas. </p>
<p>So I guess my question is: Why is it so hard to release 30000 window handles? (significantly harder than creating them in the first place!) :) </p>
<p>&#8212; <br />Rune</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/07/18/3926581.aspx" rel="nofollow">Topic</a> <a href="http://blogs.msdn.com/oldnewthing/archive/2007/07/19/3945339.aspx" rel="nofollow">and again</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275213">
				<div id="div-comment-275213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mantra</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-275213">
			May 10, 2005 at 9:15 pm</a>		</div>

		<p>SendInputSendKeys works on a window that has focus. In general, SetFocus and SendInputSendKeys isn&#8217;t considered as a reliable way. Is it possible to pump keys to a specific window without going thru SendInput etc?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2005/05/30/423202.aspx" rel="nofollow">Old topic</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275433">
				<div id="div-comment-275433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Quirk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-275433">
			May 11, 2005 at 12:19 pm</a>		</div>

		<p>How exactly does Windows compute which windows appear in the ALT+TAB list?  I have never found any documentation on this.  I have seen alot of problems involving a window owned by a dummy window sometimes disappearing from the list.</p>
<p>For example, if you have window A owns window B owns window C, they are all visible, and C is modal to the rest, then suddenly all three disappear from the ALT+TAB.</p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/08/5351207.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275653">
				<div id="div-comment-275653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Darren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-275653">
			May 12, 2005 at 12:28 pm</a>		</div>

		<p>I&#8217;m curious &#8211; are there still lurking parts of the Windows OS that don&#8217;t grok long filenames? If you look in System32, even in Server 2003, the system DLLs still have 8.3 filenames. Since every long filename has a corresponding short filename for backward compatibility, why do we need this restriction? Even the .NET bootstrap DLL (mscoree.dll or something) is an 8.3 name. Is this superstition on the part of Microsoft, or is there some good reason to hang on to 8.3 for backwards compatibility? I just noticed that even the Office programs for Office 2003 are 8.3 &#8211; &#8220;Winword.exe&#8221;, &#8220;Powerpnt.exe&#8221; etc.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/04/02/2008357.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-276053">
				<div id="div-comment-276053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kokorozashi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-276053">
			May 14, 2005 at 10:59 pm</a>		</div>

		<p>In response to the previous suggestion about 8.3 filenames, I&#8217;ve been thinking about this issue lately as well. With regard to files in the boot hierarchy, it would seem that all the file systems from which XP can boot do support long filenames (even FAT16, to my surprise). On the other hand, I would not envy the person tasked with scouring all the code in the OS for buffers which assume 8.3 filenames. And I&#8217;m not talking about the parts of the system which manage volumes; obviously those must support long filenames. I mean all the little utility apps and various higher-level APIs which scan a directory for DLLs and what-have-you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-278063">
				<div id="div-comment-278063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart Willems</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-278063">
			May 26, 2005 at 5:32 pm</a>		</div>

		<p>As a suggestion for a short item: why isn&#8217;t there some sort of 5-minute timer in the power-off dialog. You know, when you power off and one of your programs is still open, you&#8217;ll get the dialog &#8220;are you sure you want to shut down&#8221;. &#8211; and why does it override standby/hibernate? </p>
<p>I&#8217;ve had a couple of times where I&#8217;ve clicked on &#8220;Power Off&#8221; on my laptop, and when it&#8217;s starting to shut down I&#8217;ll close it and put it in my bag (I don&#8217;t always have the luxury to wait three minutes for the power down) &#8211; only to get home with a laptop that resembles an iron since it&#8217;s been running all that time waiting for my reply &#8211; or the same for getting home after a night out and finding the computer still on. </p>
<p>If the question isn&#8217;t answered in a few minutes, then the user obviously went away assuming the PC powered down, right?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/04/16/2148139.aspx" rel="nofollow">Vista does this</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-278293">
				<div id="div-comment-278293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gareth</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-278293">
			May 27, 2005 at 10:05 am</a>		</div>

		<p>I&#8217;m using SystemParametersInfo to set the scroll bar width when our application starts (we support a touch screen interface we need big fat scroll bars), but when we use this on an XP pc using XP themes calling the API also enlarges the system tray icons and several other height settings (even if when we reset the scrollbar width to the original value when the application closes). Any ideas why it does this? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/04/09/2056478.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-278453">
				<div id="div-comment-278453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kishorep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-278453">
			May 27, 2005 at 5:38 pm</a>		</div>

		<p>I would like to know if you can post any samples on how to implement Context Menu handlers for IE. </p>
<p>My scenario is that I would like to extend the context menu such that, whenever a text is selected, the popup menu shown on right click &#8211; has a menu &#8211; Save to a specified location. </p>
<p>How can I implement this feature so as to enable by scenario in IE.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#422727" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-278663">
				<div id="div-comment-278663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ont@mirality.co.nz' rel='external nofollow' class='url'>Gavin Lambert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-278663">
			May 31, 2005 at 1:21 am</a>		</div>

		<p>In the comments on <a href="http://blogs.msdn.com/oldnewthing/archive/2005/02/22/378018.aspx" target="_new" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/02/22/378018.aspx</a>, you said you&#8217;d discuss the difference between manually posting WM_QUIT and calling PostQuitMessage.</p>
<p>I have renewed curiosity about this, because I&#8217;ve just found an app where PostQuitMessage doesn&#8217;t work, but PostMessage(WM_QUIT) does&#8230;.. (and of course the docs say not to use PostMessage, but not why&#8230;)</p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2005/11/04/489028.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280243">
				<div id="div-comment-280243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JF Lefebvre</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-280243">
			June 6, 2005 at 12:39 pm</a>		</div>

		<p>Hi. <br />I would like to know more about how the dialog manager handle the default key (ENTER) when a dialog box contains a modeless child dialog. It seems to me that even when the focus is on a child dialog&#8217;s button, the default key is still send to the parent dialog. </p>
<p>I would like to know why it works this way? And what is the clean way to redirect the message to the child window. </p>
<p>Thanks!</p>
<div class=post>[<i>I covered this in <a href="http://channel9.msdn.com/Showpost.aspx?postid=116704" rel="nofollow">my PDC 2005 talk</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-282363">
				<div id="div-comment-282363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-282363">
			June 13, 2005 at 1:56 am</a>		</div>

		<p>Not a topic suggestion, but a suggestion for improving your weblog: </p>
<p>The post categories are pretty useless. There are no &#8220;next page&#8221; links, so you see only the last 20 posts in that category and can&#8217;t access any more. Browsing through old topics using the date links is tedious. </p>
<p>There used to be a way to list all of the post titles in a category, and that was really great for browsing.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#428487" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-282523">
				<div id="div-comment-282523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://grouper.com/' rel='external nofollow' class='url'>piers</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-282523">
			June 13, 2005 at 6:02 pm</a>		</div>

		<p>here&#8217;s a simple question related to explorer drag/drop: </p>
<p>I&#8217;m a DropSource and the user is dragging items to explorer. how can i found out where they dragged them to? </p>
<p>the items the user is dragging aren&#8217;t files (yet) they&#8217;re just virtual representations of files. when the user drags the items out of my application i want to start a long-running process that wil eventually create the files in the location he specified. </p>
<p>the only way i can find to do this is to create a uniquely-named folder in the temp directory, and use an ICopyHook to cancel explorer&#8217;s SHFileOperation and notify my app of the location of the copy. </p>
<p>there /has/ to be a better way to do such a simple thing, doesn&#8217;t there?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/05/07/2453927.aspx" rel="nofollow">Response</a> -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-282543">
				<div id="div-comment-282543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://grouper.com/' rel='external nofollow' class='url'>piers</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-282543">
			June 13, 2005 at 6:39 pm</a>		</div>

		<p>I should add that I&#8217;d like a way to do this so that user can quit my application between doing the drag and the completion of the copy operation and have the copy operation complete some time after restarting the application. The TYMED_ISTREAM method obviously isn&#8217;t going to work here&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-282553">
				<div id="div-comment-282553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Francisco Moraes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-282553">
			June 13, 2005 at 8:05 pm</a>		</div>

		<p>Can the SendInput function be used to cause a DirectX application that reads the keyboard via DirectInput notice the simulated key typing?</p>
<p>Francisco</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-282563">
				<div id="div-comment-282563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan Leo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-282563">
			June 13, 2005 at 10:00 pm</a>		</div>

		<p>Hello, have there been any changes in behaviour in DialogBox/DialogBoxParam between windows server 2003 service pack 1 and windows xp service pack 2?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-283053">
				<div id="div-comment-283053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spaces.msn.com/members/esteewhy/' rel='external nofollow' class='url'>estee</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-283053">
			June 16, 2005 at 11:42 am</a>		</div>

		<p>Raymond, once you&#8217;ll be in a philosophical mood, could you please tell some words regarding MSF, MOF and the like? Thank you</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#429811" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-283283">
				<div id="div-comment-283283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-283283">
			June 16, 2005 at 8:29 pm</a>		</div>

		<p>Several times you&#8217;ve blogged about how the shell finds programs to execute (and how each other part of Windows has its own separate inconsistent set of rules). Pathnames in the registry should be full path names and should have quotation marks around them for obvious reasons. </p>
<p>Well, then there&#8217;s: <br />HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionControl PanelCpls <br />containing values: <br />Internet Connection Firewall <br />NetSetupWizard <br />Speech </p>
<p>I thought I was going to prove a security risk in the value of the Speech value by creating a program C:Program.exe &#8230; hmm, maybe by creating a link C:Program.lnk that points to the actual program &#8230; hmm, so much for those experiments. How come Control Panel always opened the actual Speech applet instead of executing the program that I put at the place where the registry said to look? </p>
<p>I can kind of figure out why the other two items aren&#8217;t security risks, since the default paths now have the System32 directory ahead of other places where the shell would look. </p>
<p>By the way the reason I was poking around that neighbourhood is that a driver signed by Microsoft creates values in the Run key that also don&#8217;t specify full pathnames, and I thought that was going to be a security risk, but now wonder if maybe it isn&#8217;t. </p>
<p>Also a ton of subkeys of App Paths have pathnames with embedded blanks but without quotation marks. How come they avoid executing a Trojan C:Program something or other.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/05/15/2636224.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-283313">
				<div id="div-comment-283313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pete</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-283313">
			June 17, 2005 at 2:56 am</a>		</div>

		<p>I just had some trouble creating a thread from a DLL. In the process of banishing said trouble, I scoured Google Groups. I searched for CreateThread and DLL. Over and over and over and over again I saw people trying to call CreateThread from DllMain, which doesn&#8217;t work because DllMain is serialized and CreateThread implies DLL_THREAD_ATTACHED. It seemed like a common enough error that it&#8217;d be worth describing.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/09/04/4731478.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-283323">
				<div id="div-comment-283323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pete</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-283323">
			June 17, 2005 at 3:06 am</a>		</div>

		<p>Oh, and my problem? I managed to inflict a subtler variant on myself. I had declared a global instance of a class whose constructor was calling CreateThread, which means the CRT was calling me during DllMainCRTStartup, which of course is the caller of DllMain and of which I was unaware until tonight.</p>
<p>One thing I still don&#8217;t understand is that calling CreateThread from DllMain (or, presumably, DllMainCRTStartup) is supposed to deadlock according to Usenet. All I saw was that my thread entry proc was never called.</p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/09/04/4731478.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-283563">
				<div id="div-comment-283563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom Grelinger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-283563">
			June 17, 2005 at 4:35 pm</a>		</div>

		<p>I&#8217;ve quickly scanned some of the topics (found by doing an initial Google search), and I&#8217;m curious if there has been information on the following: if I have a modal CDialog that is visible and usable to the user. Let&#8217;s say I receive an event somewhere else in the program and I call DestroyWindow on the modal CDialog from within the event. I notice that the OnDestroy is called on the CDialog, but DoModal never exits until a WM_QUIT is posted to the modal&#8217;s message pump. What are the pitfalls to this? Unfortunately, there is really no way to avoid this situation.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/05/21/2757223.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-283903">
				<div id="div-comment-283903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alanjmcf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-283903">
			June 20, 2005 at 2:12 pm</a>		</div>

		<p>On why 109 audit records are logged when Explorer opens a folder with audit enabled. <br />&lt;<a href="http://www.sysinternals.com/blog/2005/06/explosion-of-audit-records.html%3E" target=_new rel=nofollow rel="nofollow">http://www.sysinternals.com/blog/2005/06/explosion-of-audit-records.html%3E</a> </p>
<div class=post>[<i>Mark answered that question <a href="http://blogs.technet.com/markrussinovich/archive/2005/06/15/an-explosion-of-audit-records.aspx" rel="nofollow">in a comment to that same entry on 6/24/2005</a> so I don&#8217;t have to. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-284003">
				<div id="div-comment-284003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Hall</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-284003">
			June 21, 2005 at 6:31 am</a>		</div>

		<p>Two suggestions, sorry if they&#8217;ve been covered before;</p>
<p>1) Why does Windows start services in the correct order yet not shut them down in the reverse order?</p>
<p>2) Why is it that the &#8220;hide the least used programs&#8221; feature on the Start Menu tends to hide programs I *do* use :)</p>
<div class="post">[<i>Here&#8217;s <a href="http://blogs.msdn.com/oldnewthing/archive/2007/06/11/3215739.aspx" rel="nofollow">the start of a two-week series for you</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-284963">
				<div id="div-comment-284963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.shorthike.com' rel='external nofollow' class='url'>Kai Backman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-284963">
			June 21, 2005 at 3:09 pm</a>		</div>

		<p>My space station game does a cute waltz with a friendly utility named HotCopy. The game is self-patching over the net and needs to change it&#8217;s running executable so it does a: start process &#8211; wait for finish &#8211; copy files &#8211; restart exe. But that&#8217;s not the point.</p>
<p>The point is that changing the executable messes up the icon cached by the Shell. I use a separate icon file for the standard shortcuts, but my lovely players tend to run the game so often that it ends up in the &quot;most frequently used&quot; programs list. And duly has a non-descript icon on it.</p>
<p> Eveything gets OK after a while, but I sense a hidden mystery here. I&#8217;d like to make this right and just give the Shell a nice hint that the cache needs updating. There is the Shell_GetCachedImageIndex, which seems like a hackish way of reloading the image into the cache (using GIL_DONTCACHE). The official documentation claims Win2000 but unofficial tells me it&#8217;s been around since 95. What&#8217;s going on here? Can an app refresh an entry programmatically? What&#8217;s the proper way?</p>
<p>I&#8217;m intrigued .. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-285103">
				<div id="div-comment-285103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.madprops.org/mabster' rel='external nofollow' class='url'>mabster</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-285103">
			June 21, 2005 at 6:30 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>I found out today that Window-D does the same thing (show desktop/minimize all windows) as Window-M.</p>
<p>Or does it?</p>
<p>Is there a reason that both key combinations exist?</p>
<p>Cheers,<br />
<br />Matt</p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2004/05/27/143042.aspx" rel="nofollow">I already covered this topic last year</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-286003">
				<div id="div-comment-286003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">macbirdie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-286003">
			June 23, 2005 at 1:40 am</a>		</div>

		<p>Here&#8217;s the situation. Some Important App is doing something more or less important in the background. I&#8217;m typing something in some other app. Then suddenly a dialog pops up from the Important App giving me options of Yes, No and Cancel. But the millisecond the dialog pops up and gains focus, it so happens that the &#8220;n&#8221; key on my keyboard is already on its way to be pressed and eventually I end up hitting &#8220;No&#8221; in the Important Background App, not the one I&#8217;m typing in. Was such case ever considered during Windows UI design? If not, why? If yes, why wasn&#8217;t it implemented? Thanks! </p>
<div class=post>[<i>The foreground lock timeout is supposed to prevent this. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-286523">
				<div id="div-comment-286523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GreekGoddess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-286523">
			June 23, 2005 at 5:59 pm</a>		</div>

		<p>On keyboards with an &#8220;AltGr&#8221; key that translates to a simultaneous keypress of Ctrl+Alt, why doesn&#8217;t AltGr+Del show the task manager?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#432038" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-289923">
				<div id="div-comment-289923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ThalesC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-289923">
			July 8, 2005 at 6:30 pm</a>		</div>

		<p>I&#8217;d like to know how dlls linked as &#8220;delay loaded&#8221; get unloaded by the application and other dlls.</p>
<div class=post>[<i>I don&#8217;t know. But you should be smart enough to figure this out on your own. (Hint: Read the documentation.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-289933">
				<div id="div-comment-289933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://woodart.free.fr' rel='external nofollow' class='url'>woodart</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-289933">
			July 8, 2005 at 8:43 pm</a>		</div>

		<p>Hi Raymond, </p>
<p>I remember a while back when I was messing with Windows settings a software called &#8220;Xteq X-setup&#8221; that had this surprising &#8220;setting&#8221; described as follows: <br />&#8220;Windows includes a &#8220;feature&#8221; (?) that lets you blue-screen (crash) the OS simply by holding the right CTRL key and pressing the &#8220;Scroll Lock&#8221; key twice. </p>
<p>After activating this option, reboot your system. Then hold the right CTRL key and press the &#8220;Scroll Lock&#8221; key twice. </p>
<p>Windows will react with a nice MANUALLY_INITIATED_CRASH (0xE2) blue-screen&#8230; </p>
<p>Enjoy!&#8221; </p>
<p>I&#8217;d like to hear the story behind it if you happen to know anything. </p>
<p>I discovered your log recently (read today, shame on me :p) and I like it very much, keep the nice stories coming :)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/07/30/4123208.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-290023">
				<div id="div-comment-290023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ramesh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-290023">
			July 10, 2005 at 3:57 am</a>		</div>

		<p>Hi Raymond,</p>
<p>Is it possible to programatically determine / change the Folder type (template) setting for a particular folder in XP?</p>
<p>Thanks<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-290033">
				<div id="div-comment-290033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">macbirdie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-290033">
			July 10, 2005 at 4:20 am</a>		</div>

		<p>Hey, <br />I&#8217;ve been always tought that using &#8220;goto&#8221; statements in C/C++ is just bad and ugly. What&#8217;s with all those goto&#8217;s doing in many, many MSDN C code examples? <br />Thanks!</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#437226" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-290143">
				<div id="div-comment-290143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.lab49.com/' rel='external nofollow' class='url'>Daniel Chait</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-290143">
			July 11, 2005 at 2:04 pm</a>		</div>

		<p>Hi Raymond, </p>
<p>Was wondering &#8211; what&#8217;s the reason for some messages being prefixed with WM_ and others with EM_ ? The logic is opaque to me (especially looking at things like EM_UNDO vs. WM_UNDO). </p>
<p>Thanks! &#8211; Daniel </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/09/11/4857870.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-290243">
				<div id="div-comment-290243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-290243">
			July 12, 2005 at 12:16 pm</a>		</div>

		<p>SHMessageBoxCheck places a key in HKEY_CURRENT_USER for every user who checks the &#8220;don&#8217;t show this dialog again&#8221; checkbox. However, suppose we have an all-users install of a program and 4 of the users check the box. If one of the users uninstalls the program, we cannot remove the registry key for the other 3 users during the uninstall. </p>
<p>I don&#8217;t understand what anyone can do about this scenario without leaking registry keys. Am I missing something, or is this behavior as designed?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/09/17/4948130.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-290293">
				<div id="div-comment-290293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-290293">
			July 12, 2005 at 7:17 pm</a>		</div>

		<p>Hey Raymond, </p>
<p>I&#8217;m wondering why windows doesn&#8217;t ship multilingual. Resource files can &#8211; as most people know &#8211; contain several languages, and depending on the user&#8217;s preference the system could appear in his or her native language. It&#8217;d help a lot in multilingual environments where people from all sort of countries logon with their own profile and get their familiar environment. Also, it&#8217;s difficult to obtain a copy of windows in your native language when living abroad. </p>
<p>So, why doesn&#8217;t MS just ship multilingual versions of windows? This is one of the things that I really don&#8217;t understand. </p>
<p>&#8211; Mike</p>
<div class=post>[<i>Um, Windows has done this since 2000. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-290993">
				<div id="div-comment-290993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.fileformat.info/tip/microsoft/enter_unicode.htm' rel='external nofollow' class='url'>Andrew M</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-290993">
			July 16, 2005 at 10:44 pm</a>		</div>

		<p>Raymond: <br />I was hoping you could address how to properly code Unicode character input. It seems like a lot of applications don&#8217;t support it correctly. <br />Andrew</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/22/5586861.aspx" rel="nofollow">Response</a> -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-291013">
				<div id="div-comment-291013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dingo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291013">
			July 17, 2005 at 5:43 pm</a>		</div>

		<p>I&#8217;ve always been curious why Windows shortcuts are such a pain to handle programmatically (comparing to unix links).</p>
<div class=post>[<i><a href="http://technet.microsoft.com/en-us/magazine/2006.09.windowsconfidential.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-291053">
				<div id="div-comment-291053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vig</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291053">
			July 18, 2005 at 6:35 am</a>		</div>

		<p>Dear Raymond <br />What are your suggestions for students who have just joined their Bachelors course in computer science or about to complete the course. <br />What books do you suggest are good for becoming a good software engineer? What courses to take etc? can you please share some advice? Thanks </p>
<div class=post>[<i>My suggestions are to read the &#8220;Topics I&#8217;m not inclined to cover&#8221; in the base article. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-291333">
				<div id="div-comment-291333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vitaly</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291333">
			July 19, 2005 at 2:03 am</a>		</div>

		<p>Could you explain why Windows start browser if file name passing to ShellExecute is starting from &#8220;home&#8221;. You can test it just by pressing Win-R and then typing home&lt;anything&gt;. Just &lt;anything&gt; or just &#8220;home&#8221; will result an error message, but &#8220;home&lt;anything&gt;&#8221; will open browser with that page. </p>
<p>Why?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2006/01/13/512503.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-291363">
				<div id="div-comment-291363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.buddhike.net' rel='external nofollow' class='url'>Buddhike de Silva</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291363">
			July 19, 2005 at 9:44 am</a>		</div>

		<p>I&#8217;ve been trying to write an application which allows to drag and drop documents from lotus notes. If I just drag and drop a document from lotus notes to Windows explorer, it creates a .shb file (regular windows document link file). Therefore I think it is possible to simulate this in a custom application as well. </p>
<p>BTW: I found that lotus notes uses following list of clipboard formats for OLE drag drop. <br />Notes Private Data <br />Notes Private Link <br />Link Source Descriptor <br />Link Source </p>
<p>I also think only the last two formats will be enough for the task I want to accomplish. In fact they are more likely to be windows OLE clipboard formats. However, these clipboard formats are not documented. </p>
<p>I would be grateful if you could send me the definitions of data structures I could use to access data from these CFs. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/11/12/6122832.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-291463">
				<div id="div-comment-291463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">praful</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291463">
			July 19, 2005 at 1:49 pm</a>		</div>

		<p>If you drag My Computer to the Start button in XP, you get an expanding menu that lets you see all files and folders as submenus. </p>
<p>1. Is this menu available to applications via an API, or do you have to build it yourself? For example, can an application have a pop-up menu, with the My Computer menu in it? </p>
<p>2. If the My Computer menu is available as an API, is it customisable so that, for example, only folders are displayed and items can be added to the menu? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/11/19/6383774.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-291783">
				<div id="div-comment-291783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291783">
			July 21, 2005 at 4:36 am</a>		</div>

		<p>Not sure if this is within your ambit of interest, but: I&#8217;d be interested in some comment as to why INI files &amp; so on were deprecated in favour of the registry, but then it all changed back; ie. the registry is now deprecated in favour of XML files, or whatever. </p>
<p>The reason I ask is that I have been relatively blind-sided by this; I only realized it a short time ago! So I&#8217;ll have to change my app accordingly. It&#8217;s easy to say &#8220;read the guidelines&#8221;, but as a 1-man shop, I have little enough time to write the code in the first pace! </p>
<p>Cheers, <br />TC </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/11/26/6523907.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-291793">
				<div id="div-comment-291793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291793">
			July 21, 2005 at 4:44 am</a>		</div>

		<p>(hoping this stays immediately below my other post)</p>
<p>My question is in relation to application-specific values (currently stored below HKLM/Software/MyCorp/MyProd).</p>
<p>TC</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-291883">
				<div id="div-comment-291883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Quirk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-291883">
			July 21, 2005 at 12:42 pm</a>		</div>

		<p>Why can&#8217;t you call SetFocus() on a window in another thread?</p>
<div class=post>[<i>This is one of the five things every Win32 programmer should know. I consider it a prerequisite for reading this blog. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-292043">
				<div id="div-comment-292043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihir Gore</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-292043">
			July 22, 2005 at 2:59 am</a>		</div>

		<p>I implemented the IContextMenu using Visual Studio 2003.Net by creating a ATL project. In the QueryContextMenu interface I add three menu items but only the first one is visible.</p>
<p>If use the same piece of code with a project created using Visual Studio 6.0 , it works&#8230;<br />
<br />If I import the same project in Visual Studio 2003 it works.. but If I create something from scratch it does not&#8230; I am pasting the code which I use to create the menus<br />
<br />if (CMF_DEFAULTONLY &amp; uFlags)<br />
<br />        return MAKE_HRESULT(SEVERITY_SUCCESS,FACILITY_NULL,0);<br />
<br />    UINT currentCmdIdx = 0;<br />
<br />    UINT idCmdCurrent = iCmdFirst;<br />
<br />    BOOL bSuccess;<br />
<br />    bSuccess = InsertMenu(hMenu,indexMenu,MF_STRING | MF_BYPOSITION,iCmdFirst,__TEXT(&quot;First menu&quot;));<br />
<br />    currentCmdIdx++;<br />
<br />    bSuccess = InsertMenu(hMenu,indexMenu+1,MF_STRING | MF_BYPOSITION,iCmdFirst + 1,__TEXT(&quot;Second menu&quot;));<br />
<br />    currentCmdIdx++;<br />
<br />    bSuccess = InsertMenu(hMenu,indexMenu+2,MF_STRING | MF_BYPOSITION,iCmdFirst + 2,__TEXT(&quot;Third menu&quot;));<br />
<br />return MAKE_HRESULT(SEVERITY_SUCCESS,0,3);</p>
<p>Any help will be very useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-292333">
				<div id="div-comment-292333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sean</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-292333">
			July 24, 2005 at 12:31 am</a>		</div>

		<p>I keep on getting people saying that Win9x is merely an extension over dos. Is this true? and how much of Win95 is still based on dos?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/12/24/6849530.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-292763">
				<div id="div-comment-292763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ltearno.free.fr/wibrain' rel='external nofollow' class='url'>Arno</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-292763">
			July 26, 2005 at 11:35 am</a>		</div>

		<p>Hi !<br />
<br />The problem I got is the following :<br />
<br />* I have an application with its main window and a modal dialog box activated.<br />
<br />* I have another application that manages the other and sent a WM_DESTROY to it.</p>
<p>The application crashes when WM_DESTROY is received while the modal is on.<br />
<br />Obviously it hangs in the code after the call to the modal box creation because all resources where released in the WM_DESTROY treament of the main window.</p>
<p>How can I avoid this problem ? I mean, what is the standard way for an application to close wheter it has a modal box or not ?</p>
<p>Should I send an application message different from WM_DESTROY to the main window (in order just to call PostQuitMessage) &#8211; but in this case, when will I be called for the WM_DESTROY ???</p>
<p>Thank you, my mind is a littlely shaked !</p>
<p>Thanks you for your wonderful blog I follow since two years now</p>
<p>Arnaud TOURNIER<br />
<br />Paris, FRANCE</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-293093">
				<div id="div-comment-293093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-293093">
			July 27, 2005 at 8:03 pm</a>		</div>

		<p>Here&#8217;s some fun insanity: it&#8217;s generally accepted (by keyboard manufacturers, computer manufacturers, etc) to be IMPOSSIBLE to disable or remap the power/sleep/suspend buttons under Win32. </p>
<p>Why is this?</p>
<p>This knowledgebase article has a link to code for a filter driver that would solve this problem. However, there is no trustworthy compiled version of this software anywhere on the net, so far as I can see.</p>
<p><a rel="nofollow" target="_new" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q302092#kb1" rel="nofollow">http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q302092#kb1</a></p>
<p>The control panel gives you the option to change the actions of these keys, between &quot;Standby, Hibernate or Power Off&quot; &#8211; there is no &quot;disable&quot; option, nor an &quot;open &#8216;shut down&#8217; dialog&quot; option. However, closing a laptop screen CAN be mapped to &quot;nothing&quot;, so clearly this would have been possible.</p>
<p>So what is the solution that everyone has adopted? Physically remove the keys. Or buy a new keyboard without those keys (increasingly difficult nowadays).</p>
<p>These keys tend to be internal, rather than keycaps, which means opening the keyboard. Removing these keys hae been responsible for more keyboard warranty voidings than any other cause.</p>
<p>WHY? Sure, remapping them is tricky, because ACPI is handled at a lower level than the scan codes. But it&#8217;s not a remapping issue: it&#8217;s an &quot;ACPI options&quot; issue.</p>
<p>If we could make them do &quot;nothing&quot; for the ACPI, then we could also remap their scancodes to perform useful functions.</p>
<p>But as it is, these keys simply perform an undesired and actively dangerous action: shutting down the machine and all applications without saving anything, and without ANY PROMPTING WHATSOEVER.</p>
<p>Evil, I say.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-293123">
				<div id="div-comment-293123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-293123">
			July 27, 2005 at 9:00 pm</a>		</div>

		<p>Update to my prior note, I found a for-pay tool here:<br />
<br /><a rel="nofollow" target="_new" href="http://www.bytegems.com/ihatethiskey.shtml" rel="nofollow">http://www.bytegems.com/ihatethiskey.shtml</a> &#8230; but who wants to pay for something that should just BE THERE?</p>
<p>And there&#8217;s <a rel="nofollow" target="_new" href="http://eugeb.narod.ru/Keyboards.zip" rel="nofollow">http://eugeb.narod.ru/Keyboards.zip</a> claims to be a compiled version of the MS driver code. But for my USB keyboard, it caused all keys EXCEPT the ACPI ones to stop working. Good thing changing the driver back can be done completely by mouse :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-293573">
				<div id="div-comment-293573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hexar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-293573">
			July 29, 2005 at 12:21 pm</a>		</div>

		<p>When you maximize a window in a multiple-monitor environment, how does windows know which monitor to maximize it to, especially when the window overlaps monitor boundaries?  Does it compute the pixel area of the part of the window overlapping each monitor, and pick the one with the biggest area?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-295093">
				<div id="div-comment-295093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295093">
			August 6, 2005 at 8:09 am</a>		</div>

		<p>In the article &quot;Why do files and directories with no time/date mess up sorting in Explorer?&quot;, you commented that &quot;you need the help of an external file system&quot; to cause the sorting problem to happen.</p>
<p>I thought you&#8217;d be interested that it can happen without such a system&#8230; I was able to achieve similar results by installing XP on a system with a buggy BIOS that had the year set to 16,488 yet displayed it as 2004 in the settings screen.  This seemingly resulted in dates being written to the XP file system that were apparently correct but outside of the range that could be handled by explorer&#8217;s date handling, so it fell back on &#8216;no last modified&#8217; time for these.  The dates could be seen on the properties pages of the files, but were conspicuously missing from the &#8216;details&#8217; view.  The file sorting bug you mention appeared, and I was also unable to persuade .NET applications to run (they threw an exception in their startup code because the date of one of the system files they examined was out of range).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-295123">
				<div id="div-comment-295123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sandor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295123">
			August 6, 2005 at 2:56 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>We&#8217;re developing an win32 application where the safety of a password input field is critical. I googled around but haven&#8217;t found any comprehensive description about how can you make password input safe from keyloggers. Any advices on this topic?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-295133">
				<div id="div-comment-295133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/kevinpilchbisson' rel='external nofollow' class='url'>Kevin Pilch-Bisson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295133">
			August 6, 2005 at 4:15 pm</a>		</div>

		<p>I&#8217;ve often wondered why it&#8217;s not possible to use drag and drop to re-arrange the order applications are shown in the Taskbar.</p>
<p>I like to keep certain applications that I <em>always</em> have running at the left, and in a certain order.  (Applications like Outlook, bug tracking software, Visual Studio, a TS session to a test machine, etc).</p>
<p>After that I tend to have a lot of what I think of as &quot;transient windows&quot; things like cmd prompts, IE windows, etc.</p>
<p>The problem is that if I ever need to shutdown and restart one of the long running applications, I also need to shut down all of the transient windows in order to get the newly started long running application back into it&#8217;s normal place.  A lot of other people I&#8217;ve spoken to work in the same way, and are also frustrated by the fact that you can&#8217;t re-arrange the applications in the Taskbar.</p>
<p>What is the reasoning behind not allowing apps to be re-ordered in the Taskbar?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-295153">
				<div id="div-comment-295153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Luther</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295153">
			August 7, 2005 at 5:54 am</a>		</div>

		<p>You often talk about Dialog Boxes. I am building a window in code (not via RC or dialog templates) and attaching edit controls to it. There may be 10 windows with 25 edit controls each when I&#8217;m done. </p>
<p>Within each window (one displayed at a given time) I&#8217;d like to TAB between the edit controls. Unfortunately, the only examples I can find on the net (<a href="http://blogs.msdn.com/oldnewthing/archive/2003/10/21/55384.aspx" target=_new rel=nofollow rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/10/21/55384.aspx</a>) <br />want me to change my message loop to something like this: </p>
<p>if (IsDialogMessage(hwnd, &amp;msg)) { <br />/* Already handled by dialog manager */ <br />} else { <br />TranslateMessage(&amp;msg); <br />DispatchMessage(&amp;msg); <br />} </p>
<p>My message loop is in a completely different C++ file/class. For this to work as described, I&#8217;d need to pass the application (or make it global) to every single EDIT control &#8211; and I&#8217;d have to keep updating the &#8220;hwnd&#8221; used in the IsDialogMessage method above every time focus changed since that method works on a specific EDIT control at a time &#8230; </p>
<p>Is that really necessary? I&#8217;ve built the EDIT controls with WS_TABSTOP style, and naturally, they are eating the TAB key. I can manually catch and GetNextDlgTabItem myself, but I wasn&#8217;t sure if that was normal. </p>
<p>Is there a cleaner way I&#8217;ve overlooked? </p>
<p>Many thanks, </p>
<p>-Luther</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#448697" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-295163">
				<div id="div-comment-295163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bouzouki Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295163">
			August 7, 2005 at 3:57 pm</a>		</div>

		<p>I&#8217;d love to hear your thoughts about Vista&#8217;s break in backwards compatability wrt OpenGL 2.0. Aren&#8217;t you concerned about user perceptions, given that OpenGL 2.0 apps that worked fine on XP and 2000 will suddenly refuse to run on Vista?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-295293">
				<div id="div-comment-295293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295293">
			August 8, 2005 at 11:26 am</a>		</div>

		<p>The forum link at &#8220;Contact Me&#8221; has an extra char tagged at the end causing it to 404.</p>
<div class="post">[<i>Hm, works for me. Maybe it got fixed in the meantime. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-295393">
				<div id="div-comment-295393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">FigBug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-295393">
			August 8, 2005 at 7:36 pm</a>		</div>

		<p>Two topics I&#8217;d like to see covered: </p>
<p>What goes on inside a call to MessageBox/DialogBox and why you should ever call MessageBox from inside a message handler that is re-entrant. I&#8217;m having a hard time explaining to people that it isn&#8217;t a blocking call. </p>
<p>Why you can click on Explorer (to drag a file) and it doesn&#8217;t come to the foreground. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-296203">
				<div id="div-comment-296203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-296203">
			August 10, 2005 at 3:45 pm</a>		</div>

		<p>Speaking of errors, could you talk about handling errors generated by the Windows API? For example, according to MSDN, a list box can return LB_ERR or LB_ERRSPACE if LB_ADDSTRING fails. LB_ERRSPACE I assume is handled like a malloc error, but what about LR_ERR? What could cause an add to fail? What could I do to recover if it fails? Should I pop up an error message? What should the error message say? &#8220;I&#8217;m sorry, Windows refuses to add an item to a list box on your screen&#8221; doesn&#8217;t seem appropriate. </p>
<p>Another example would be fclose or CloseHandle. Aside from passing it an invalid handle, what kind of situation could arise that would make that operation fail? </p>
<p>I hope I&#8217;m not suggesting something you&#8217;ve covered already, but I don&#8217;t think you&#8217;ve covered this. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/01/07/7011066.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-296843">
				<div id="div-comment-296843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arno</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-296843">
			August 15, 2005 at 6:33 pm</a>		</div>

		<p>You have covered both ShellExecute (don&#8217;t use anything else to launch IE) and modal dialogs and the need to pass a owner HWND to ShellExecute. But in the first article you don&#8217;t do the latter. So do I need to pass a window to ShellExecute or not? When is it used? Yeah, when UI is displayed, but when does this happen, modally? Is UI suppressed if I pass NULL? Help!</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-297563">
				<div id="div-comment-297563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-297563">
			August 16, 2005 at 9:09 pm</a>		</div>

		<p>Is there some way to use Explorer&#8217;s filename sort function? Now that files are sorted based on their interpretation as integers, there is no simple way to meet user expectations of the order files should show up. </p>
<p>Similarly, is there any historical reason for why files dragged from Explorer are not passed to the dropee in the order in which they&#8217;re selected or listed?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-297613">
				<div id="div-comment-297613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-297613">
			August 17, 2005 at 12:27 am</a>		</div>

		<p>I&#8217;d love to read a series on how you got into this job in the first place. How you ended up at Microsoft, your history there, etc. What it&#8217;s actually like working at Microsoft. How accurate was &quot;Microserfs&quot;, etc..</p>
<p>Not a full life history but a few articles along those lines would be really interesting!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-298123">
				<div id="div-comment-298123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-298123">
			August 18, 2005 at 12:39 pm</a>		</div>

		<p>Hi Raymond, </p>
<p>I&#8217;d like to know if there is any way to sleep (or yield or have an event signalled) with a granularity under 1 millisecond under windows <br />xp. </p>
<p>Thanks, <br />Brien </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-298653">
				<div id="div-comment-298653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-298653">
			August 19, 2005 at 11:44 am</a>		</div>

		<p>Why isn&#8217;t SMB_COM_COPY implemented?  It&#8217;s documented in the specification, why isn&#8217;t it actually implemented?</p>
<p>To copy a file around inside a share, explorer drags the file down to the local host only to send it right back to the remote host.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-299363">
				<div id="div-comment-299363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alberto Martinez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-299363">
			August 20, 2005 at 3:03 pm</a>		</div>

		<p>I always was a bit curious about why the tray&#8230; I mean, notification area icons were limited to only 16 colors in Win9x/2000. Also, I heard of patches for allowing 256 color icons in that systems, but I never liked the idea of patch or replace explorer.exe (I dont&#8217;t like the idea of having explorer.exe crashing). </p>
<p>But this week I found a page that in addition to offering a patch, it also offered the list of bytes you need to change (for suspicious minds like me). I was shocked after discovering that after changing only 3 bytes from 0x1 to 0x11 you can get 256 color icons in Win2000. So I fired up an hex editor, changed the bytes, killed explorer.exe, replaced it, and voila, a nice Winamp notify icon in Win2000 (apart from the logical protests of Windows File Protection). </p>
<p>I always thought that the patches added some code to explorer, or that replaced some structures, but if you only have to change 3 bytes it leads me to think that the feature was always available but disabled for some reason. Maybe a strange compatibiliby issue behind this?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-299513">
				<div id="div-comment-299513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.budja.net/blog' rel='external nofollow' class='url'>Andrej Budja</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-299513">
			August 22, 2005 at 4:44 am</a>		</div>

		<p>Do you have any details why cmd.exe is not themed in Windows XP? There a KB 306509 on this, but it&#8217;s very short: <br />&#8221; <br />The Command Prompt window runs under the Client Server Runtime System (CSRSS), which cannot be themed. &#8221; </p>
<p>Do you have more details on this?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/12/31/6909007.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-300003">
				<div id="div-comment-300003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-300003">
			August 22, 2005 at 3:41 pm</a>		</div>

		<p>I would like to know why WinXP&#8217;s winlogon.exe has open handles on &#8220;C:Program Filesmicrosoft frontpageversion3.0bin&#8221;, &#8220;C:Program FilesFichiers communsMicrosoft Sharedweb server extensions40isapi_vti_adm&#8221; and other folders that do not seem to belong to winlogon&#8217;s business&#8230; </p>
<p>(Found that with sysinternal&#8217;s ProcessExplorer after wondering why i couldn&#8217;t remove FrontPage&#8217;s &#8220;bin&#8221; folder even after uninstalling FrontPage)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2004/11/16/258220.aspx" rel="nofollow">Old topic</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-300273">
				<div id="div-comment-300273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-300273">
			August 23, 2005 at 12:02 pm</a>		</div>

		<p>Why does CTRL-Scroll Lock cancel dialogs? Or, at least, regular Windows dialogs? (Office&#8217;s, for instance, are unaffected, despite their support for things like the double-click radio button behavior.) I don&#8217;t see it listed in KB301583 and couldn&#8217;t find it documented elsewhere. And are there any other weird keyboard shortcuts like this one?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/02/11/7596539.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-301193">
				<div id="div-comment-301193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">carlos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-301193">
			August 25, 2005 at 3:49 pm</a>		</div>

		<p>Would it be too much for you to take a look at the problem described at <a rel="nofollow" target="_new" href="http://www.digitalmars.com/drn-bin/wwwnews?digitalmars.D/28073" rel="nofollow">http://www.digitalmars.com/drn-bin/wwwnews?digitalmars.D/28073</a> ? Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-301413">
				<div id="div-comment-301413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fredrik Hesse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-301413">
			August 26, 2005 at 6:39 am</a>		</div>

		<p>How about explaining this: <br />If I start an application, let&#8217;s take notepad as an example, and then move part of it off of the desktop (so only half of it is visible). And then lock my workstation, when I later unlock it, the entire window has been moved into the desktop, why is that? A precaution so you won&#8217;t have any not-visible windows?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-301883">
				<div id="div-comment-301883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kuhr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-301883">
			August 30, 2005 at 4:07 pm</a>		</div>

		<p>Raymond, </p>
<p>I would like to know if Raymond uses _alloca for smallish stack based copies of some string or some such. VS2005 with prefast turned on discourages the use of _alloca. I think this is because you never know if memory can really be committed. How do user land developers at MS cope with stack space possibly not being committed? </p>
<p>&#8212; <br />Stefan </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-302003">
				<div id="div-comment-302003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dotnetjunkies.com/WebLog/stefandemetz/' rel='external nofollow' class='url'>stefan demetz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-302003">
			August 31, 2005 at 2:52 am</a>		</div>

		<p>taken from <a href="http://www.itjungle.com/tlb/tlb083005-story02.html" target=_new rel=nofollow rel="nofollow">http://www.itjungle.com/tlb/tlb083005-story02.html</a> </p>
<p>&#8220;Windows can only handle 64 threads&#8221; </p>
<p>In other Itanium news, Intel confirmed that the future &#8220;Tukwila&#8221; Itanium, due about 2007 or so, would indeed have four cores and would employ a new architecture. This is the Itanium chip that will plug into the same Reidland Xeon platforms that are being called &#8220;Richford&#8221; when an Itanium chip plugs in. Tukwila will have HyperThreading, by the way, because those extra virtual threads mean something to customers deploying databases on Itanium iron. While this is true, the fact is Intel just retrofitted it onto Montecito, and taking it out in the Tukwila design would probably cost as much as putting it into Montecito in the first place. Considering that Windows can only handle 64 threads, a four-socket Tukwila box will be maxxed out on the thread count, which means Microsoft (and indeed other operating system suppliers) had better get their operating systems tweaked to support more threads. Because more threads are indeed coming than they can now use. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-306973">
				<div id="div-comment-306973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Williams</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-306973">
			September 19, 2005 at 3:54 am</a>		</div>

		<p>Two niggling questions: <br />1. Why does Explorer often show a + tree expander button next to folders that don&#8217;t have any subfolders? And why doesn&#8217;t clicking it make it go away? </p>
<p>2. If I&#8217;m renaming a file in Explorer, why does it lose focus (and any mid-edit changes) if Explorer finishes another task? Isn&#8217;t the UI multi-threaded?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/02/18/7761976.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-307313">
				<div id="div-comment-307313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Diego</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-307313">
			September 19, 2005 at 7:41 pm</a>		</div>

		<p>Hi</p>
<p>The more I&#8217;ve thinking about it&#8230;.so we will have soon dualcore CPUs everywhere (Good)&#8230;but then, there&#8217;s a problem: programming drivers for multiprocessor machines. Not easy to program, not always easy to reproduce and find that kind of bugs, very easy to hang a box if not done well&#8230;.</p>
<p>I wanted to as you: Do you expect dualcore boxes to become a new world blue screens? Of course, people who writes drivers for win2003 etc. cares about this&#8230;but consumers? I bet my ass that many windows setups will die as soon as you put a s*itty driver on them. I don&#8217;t bet&#8230;I know! I had a windomodem which deadlocked on my face (I had to remove one cpu to be able to dialup and update the driver &#8211; I didn&#8217;t knew about /onecpu then! ;)</p>
<p>IOW: Have you had some interesting, anecdotical experience with this issue? Do you expect this to become a problem for microsoft? (everyone will blame microsoft for it even if they don&#8217;t do the drivers, etc&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-307393">
				<div id="div-comment-307393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roland Persson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-307393">
			September 20, 2005 at 9:59 am</a>		</div>

		<p>I&#8217;d be interested to get an account of the interesting aspects of DLL/EXE loading (as you see them). </p>
<p>Especially things related to bad performance due to relocation, paging etc. I&#8217;m currently building something rather large. The build process basically invokes a compiler a large number of times and when looking with performance monitor the average CPU privileged time is 75%. So I guess this means the system is only doing &#8220;useful&#8221; work (such as actually compiling) 25% of the time. </p>
<p>The disk does not appear to be really strained and there is a lot of free memory. </p>
<p>How does windows handle an executable that is started repeatedly but always terminates in between runs. If it needs relocation (maybe this cannot happen?) will that relocation be cached somehow? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-307823">
				<div id="div-comment-307823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-307823">
			September 21, 2005 at 12:27 am</a>		</div>

		<p>This is probably not in your sphere of interest, but: how about telling us why Access 97 does not register itself correctly (in the registry) if the PC has the Hattenschweiler font installed?(!) It seems like such a goofy problem; surely this appeals to you! One of my users just got it recently, which reminded me. It is issue <a rel="nofollow" target="_new" href="http://support.microsoft.com/?id=141373" rel="nofollow">http://support.microsoft.com/?id=141373</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-308063">
				<div id="div-comment-308063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-308063">
			September 21, 2005 at 5:34 pm</a>		</div>

		<p>You mentioned that Win32 always passes null for hprevinst to winmain ( <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2004/06/15/156022.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/06/15/156022.aspx</a> )</p>
<p>However, VB6 still has this functionality in 32 bit windows. If the topic sparks your interest at all, I would enjoy a post about this.</p>
<p>OT: I love your blog so much that I want to have your man-babies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-308163">
				<div id="div-comment-308163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-308163">
			September 22, 2005 at 2:45 am</a>		</div>

		<p>Heavens! There&#8217;s devotion for you!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-308633">
				<div id="div-comment-308633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-308633">
			September 23, 2005 at 7:19 pm</a>		</div>

		<p>Dear sir,<br />
<br />  This is probably the dumbest question listed in this suggestion box, however, I have not been using the Windows API for very long and some things still vex me.  I am writing a DLL which is to be used as an extension to an interpreted scripting language called &quot;Dialect&quot;.  To make a long story short, I am trying to create a PEN object (on Windows 98) that uses a bitmap.  I have done many a search using &quot;bitmap&quot;, &quot;bs_pattern&quot;, &quot;extcreatepen&quot;, etc, etc..<br />
<br />  So far the most successful attempt has been to create a geometric pen, create a pattern brush, begin a path, draw the line, then use WidenPath and FillPath.  When I say it was successful, I meant that the bitmap was, indeed, used and the line was drawn exactly as I had wanted it&#8230;  HOWEVER.. the bitmap used still appears to be 8&#215;8.  The API documentation has the following quote:<br />
<br />&quot;Windows 98/Me and Windows NT/2000/XP: Brushes can be created from bitmaps or DIBs larger than 8 by 8 pixels&quot;<br />
<br />Is that an error in the documentation (does Win98 suffer the same restriction, or only certain versions of Win98)?  I only ask because every attempt that I have made results in the bitmap being no larger than 8&#215;8.  By the way, if it matters, I am using LoadImage to make the bitmap (with the LR_LOADFROMFILE and LR_VGACOLOR flags), CreatePatternBrush and ExtCreatePen.  I know that this is a simple question that you may never have the time to answer, but, I thank you, anyway;  the time and information you have provided here has been so much more useful than you may ever know.</p>
<p>-Jason<br />
<br /><a href="mailto:moffittj@mailbox.darton.edu">moffittj@mailbox.darton.edu</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-308643">
				<div id="div-comment-308643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-308643">
			September 23, 2005 at 8:52 pm</a>		</div>

		<p>I made a mistake in my previous post.  What I meant to say was &quot;does Win98 suffer the same restrictions as Win95, or do only certain versions of Win98, if any&quot;.  I realize that bitmaps larger than 8&#215;8 CAN be used, but will they always be clipped (or is it shrunken, I cannot tell) to 8&#215;8 (I am using Win98 second edition to test this, by the way).  Also, to clarify things, it does not matter what values I use in LoadImage for the width and height (unless I use extreme positive or negative values, of course&#8230; ;)).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-308703">
				<div id="div-comment-308703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-308703">
			September 25, 2005 at 1:06 am</a>		</div>

		<p>Hm, from the top of this page:</p>
<p>&quot;Topics I am not inclined to cover: &#8230; Debugging a specific problem. (Not of general interest.)&quot;</p>
<p>Jason, try asking here:</p>
<p>   <a rel="nofollow" target="_new" href="http://groups.google.com/groups/dir?q=microsoft.public.programmer.gdi" rel="nofollow">http://groups.google.com/groups/dir?q=microsoft.public.programmer.gdi</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-308713">
				<div id="div-comment-308713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-308713">
			September 25, 2005 at 1:09 am</a>		</div>

		<p>Sorry, I meant:  <a rel="nofollow" target="_new" href="http://groups.google.com/group/microsoft.public.win32.programmer.gdi" rel="nofollow">http://groups.google.com/group/microsoft.public.win32.programmer.gdi</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310633">
				<div id="div-comment-310633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.radioactivecode.com' rel='external nofollow' class='url'>Diego Barros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-310633">
			October 4, 2005 at 8:24 am</a>		</div>

		<p>Hi Raymond,</p>
<p>Recently while dealing with some VB code I found out that VB does not have short-circuit evaluation by default. I didn&#8217;t believe this at first. It just doesn&#8217;t make sense to my. Why would I want to <em>not</em> have it?</p>
<p>I posted about it here: <a rel="nofollow" target="_new" href="http://www.radioactivecode.com/?p=20" rel="nofollow">http://www.radioactivecode.com/?p=20</a></p>
<p>I was wondering if you knew anything as to why it is the way it is?</p>
<p>Great blog.</p>
<p>Regards,<br />
<br />Diego</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310923">
				<div id="div-comment-310923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programme.luckie-online.de' rel='external nofollow' class='url'>Michael Puff</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-310923">
			October 4, 2005 at 9:25 pm</a>		</div>

		<p>The UpAndDown Control. </p>
<p>I mean this control with which you can increment or decrement numbers in an edit control. Hasn&#8217;t anybody at Microsoft yet noticed that it isn&#8217;t working the way you expect it to work? If I click the &#8220;up&#8221; arrow button, I expect the numbers to increment: up, upwards, increase, numbers getting bigger. Well, the guys at Microsoft didn&#8217;t seem to share this expectation, because the numbers are decremented if you click the &#8220;up&#8221; arrow button. And if you click the &#8220;down&#8221; arror button they become bigger and increment. It&#8217;s like as if the buttons in a lift where numbered up side down: First story: &#8216;#25&#8217;, last story &#8216;#1&#8217; of a 25 story building. </p>
<p>I just realised it, when I used such an control in a dialog resource with the properties &#8216;Auto&#8217; and &#8216;SetBuddy&#8217; set to True. </p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2005/12/22/506725.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-311683">
				<div id="div-comment-311683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://orcmid.com/blog' rel='external nofollow' class='url'>orcmid</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-311683">
			October 7, 2005 at 1:53 pm</a>		</div>

		<p>I remember that you had this nice collection of spam statistics, and I thought you might be delighted by something I stumbled on over a year ago and gave up reporting to people.  It came up again in a note I wrote, and I mentioned you, so here it is.</p>
<p> &#8211; &#8211; &#8211; &#8211; Easy Phish Detection &#8211; &#8211; &#8211; &#8211;</p>
<p>There is a particularly sneaky kind of phish message that takes advantage of HTML formatted mail, GIF images of what appear to be legitimate notices, and some image-map bugs for hiding the hook.</p>
<p>Oddly, these messages also give themselves away.</p>
<p>First, if you can look at the SMTP headers, there is usually something amiss with the routing and the origination of the messages.  (My mail reader lets me see those by clicking View | Options.)  And many times, of course, the phisher impersonates an institution for which you have no account or for which you do not use the email address that the phish is sent to.</p>
<p>But, even funnier is the fact that the messages have material in them that completely gives them away.  And it takes about two key-clicks to see the gimmick, as explained at &lt;<a rel="nofollow" target="_new" href="http://orcmid.com/blog/2004/08/candling-phish.asp&gt;" rel="nofollow"></a><a href="http://orcmid.com/blog/2004/08/candling-phish.asp&#038;gt" rel="nofollow">http://orcmid.com/blog/2004/08/candling-phish.asp&#038;gt</a>;.  Why the mystery text?  Is it phisher bragging rights or what?  Well, no, it is a lame effort to confuse any spam filter and have the phish make it into your in box.  This is a kind of catch-22 problem for phishers.</p>
<p>Most of the phish that I have received lately (I&#8217;ve been getting one a day pretending to be from amazon.com, and now a round of eBay and PayPal ones are showing up) are very lame.  There seems to be decreasing effort at disguising the origin of the message.  And when viewed in plaintext, as my email always shows them to me, the hook, the URL that links to the bogus site, is apparent.  These are easy to report to the appropriate security centers, and I&#8217;ve been doing that.</p>
<p>It&#8217;s not quite so simple, however, with the one that I received yesterday and promptly forwarded to eBay.  In this case, the image map trick was accomplished in a way where the exploit was not visible in the plaintext that Outlook 2003 showed me.  I had to view in HTML, save the message in HTML, and then display the HTML in Notepad as text.  It&#8217;s very simple and appears to be based on a browser bug, but I can&#8217;t be sure.  Here&#8217;s the text, which isn&#8217;t much without the GIF file that is used to cover it all over:</p>
<p>(HTML follows. Not sure what this comment form will do with it.)</p>
<p>  &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;<br />
<br />  &lt;HTML&gt;&lt;HEAD&gt;<br />
<br />  &lt;META http-equiv=Content-Type content=&quot;text/html; charset=us-ascii&quot;&gt;&lt;MAP<br />
<br />  name=oyijmf&gt;&lt;AREA shape=RECT coords=0,0,646,569<br />
<br />    href=&quot;<a rel="nofollow" target="_new" href="http://2xx.6y.1zz.1q:680/rock/eBayIsap/&quot;&gt;&lt;/MAP&gt;" rel="nofollow"></a><a href="http://2xx.6y.1zz.1q:680/rock/eBayIsap/&quot;&gt;&lt;/MAP&#038;gt" rel="nofollow">http://2xx.6y.1zz.1q:680/rock/eBayIsap/&quot;&gt;&lt;/MAP&#038;gt</a>;<br />
<br />  &lt;META content=&quot;MSHTML 6.00.2900.2722&quot; name=GENERATOR&gt;&lt;/HEAD&gt;<br />
<br />  &lt;BODY&gt;&lt;B&gt;From:&lt;/B&gt; eBay [custservice_ref_8455227744846@ebay.com]&lt;BR&gt;&lt;B&gt;Sent:&lt;/B&gt;<br />
<br />  Thursday, October 06, 2005 02:02&lt;BR&gt;&lt;B&gt;To:&lt;/B&gt;<br />
<br />  <a href="mailto:orcmid@xxyyzz.qqq">orcmid@xxyyzz.qqq</a>&lt;BR&gt;&lt;B&gt;Subject:&lt;/B&gt; Update Your Account Records [Thu, 06<br />
<br />  Oct 2005 02:03:26 -0700]&lt;BR&gt;<br />
<br />  &lt;P&gt;&lt;FONT face=Arial&gt;&lt;A<br />
<br />  href=&quot;<a rel="nofollow" target="_new" href="https://signin.ebay.com/ws/eBayISAPI.dll?SignIn&amp;amp;sid=verify&amp;amp;co_partnerId=2&amp;amp;siteid=0&quot;&gt;&lt;IMG" rel="nofollow">https://signin.ebay.com/ws/eBayISAPI.dll?SignIn&#038;amp;sid=verify&#038;amp;co_partnerId=2&#038;amp;siteid=0&quot;&gt;&lt;IMG</a><br />
<br />  src=&quot;cid:part1.07010605.05090703@support_ref_2672388@ebay.com&quot; useMap=#oyijmf<br />
<br />  border=0&gt;&lt;/A&gt;&lt;/A&gt;&lt;/FONT&gt;&lt;/P&gt;<br />
<br />  &lt;P&gt;&lt;FONT color=#fffff9&gt;Let&#8217;s face facts. Cliff Notes driving at? in 1986 Mac<br />
<br />  &lt;/FONT&gt;&lt;/P&gt;&lt;/BODY&gt;&lt;/HTML&gt;</p>
<p>I have neutered the hook, using IP address 2xx.6y.1zz.1q in place of the actual one.  What&#8217;s nasty is that when you mouse over the image, you&#8217;ll see the https URL, but if you click on the image, the link in the &lt;MAP&gt; is the one that is used.  You can also see the anti-spam text near the end and how it is made invisible (but not to Select All).  I don&#8217;t know where they get these.  They are all pretty funny.</p>
<p>Of course, the fact that the phish is entirely in an image is a giant giveaway to start with.  And the Edit | Select All will make that apparent too, if cursor shape-changing doesn&#8217;t attract your notice first.</p>
<p>Now, I detected this over a year ago and I&#8217;ve reported it to some security authorities, but I have never seen it discussed except on my blog.  I wonder about that.  I think it is a phenomenon that Feynman loved to observe.  Technologists have eyes only for technological solutions, and simple things seem uninteresting.  (I should have sent this to Raymond Chen.  He&#8217;d get it.)  We don&#8217;t think of simple kitchen science (O-rings in ice water, for example) and there are many other ways that we overlook the obvious.  I do that too.  What I liked about this is that anyone can do it.  You can candle all the phish you want.  You won&#8217;t catch them all, and you do need to be suspicious enough at the outset.  Maybe that&#8217;s the key.</p>
<p> &#8211; orcmid<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-311793">
				<div id="div-comment-311793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-311793">
			October 7, 2005 at 11:53 pm</a>		</div>

		<p>TC,</p>
<p>    I was already aware of the Google newsgroups, but thank you for<br />
<br />the effort to help me, anyway.  I followed your link (the correct one);<br />
<br />unfortunately, it was one of the many threads that I have already read<br />
<br />on the subject (which is not really that important in the first place).</p>
<p>    I did, indeed, read the &quot;topics I am not inclined to cover&quot; list.<br />
<br />Maybe I did not express myself clearly enough, or perhaps I used the wrong<br />
<br />terminology;  I was not looking to debug a specific problem. </p>
<p>    The MSDN documentation states the following:<br />
<br />&quot;Windows 98/Me and Windows NT/2000/XP Brushes can be created from bitmaps<br />
<br />or DIBs larger than 8 by 8 pixels&quot;.  I, however, always end up with an<br />
<br />8&#215;8 sample of whatever bitmap I try to use.</p>
<p>    I was not sure if I was reading the documentation wrong, if there<br />
<br />were some mistake in the documentation, or if this was just some common Win32<br />
<br />knowledge that I lack.  It is true that I was looking for some clarification on that<br />
<br />statement.  It is also true that it was &quot;specific&quot; b/c I gave my own situation<br />
<br />as an example.  I was not, however, looking for anyone to debug for me.</p>
<p>    This is a &quot;suggestion box&quot;.  Given the lack of information<br />
<br />I was able to find with my search, I accept the fact that I have probably been<br />
<br />doing something wrong.  I simply thought that my example, or<br />
<br />lack of knowledge, might provide anyone more knowledgeable on the subject<br />
<br />of the Win32 GDI with something to write about.  I apologize for wasting anyone&#8217;s time.</p>
<p>-Jason</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-311813">
				<div id="div-comment-311813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-311813">
			October 8, 2005 at 12:30 pm</a>		</div>

		<p>Dear Raymond Chen, </p>
<p>I&#8217;m a developer from Hungary, Europe. I would like to read some stories about what Apple &#8220;copied&#8221; from Microsoft and what Microsoft &#8220;copied&#8221; from Apple (in the Windows 95 era, etc). There&#8217;s a growing Apple community in my country but they became extra-fanatic as time goes on. Sometimes it&#8217;s very hard to discuss exact topics with them because they think everything was invented in Cupertino&#8230; it&#8217;s very hard to find good resources. <br />If you won&#8217;t tell anything it&#8217;s ok. I understand. It&#8217;s not really interesting i know.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-312133">
				<div id="div-comment-312133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Darren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-312133">
			October 12, 2005 at 1:20 am</a>		</div>

		<p>I remember in a post a while back you had been asked a question about how to hide files and folders from Explorer. You mentioned how that wouldn&#8217;t be very good because it would allow malicious users to hide things very effectively. </p>
<p>I recently noticed that in the Office suite, it saves temporary files to&#8230; C:Documents and Settings&lt;myusername&gt;Local SettingsTemporary Internet FilesOLKD (varies). </p>
<p>When I open up Windows Explorer and go down to the Temporary Internet Files directory, I cannot see the OLKD folder anywhere unless I type it directly in the Address bar, which proves that the folder exists. </p>
<p>Question is&#8230;. How does Office hide OLKD from me? I&#8217;ve unchecked hide hidden folders/files and hide system protected files. Is there another mystery switch somewhere to allow everything to be seen?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-312823">
				<div id="div-comment-312823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-312823">
			October 13, 2005 at 11:31 pm</a>		</div>

		<p>There are some problems, not that common, where cut and paste stop working. I thought about it and came to the conclusion that an app has opened but not closed the clipboard. So I wrote a program to examine the clipboard. I didn&#8217;t know how to test it (I don&#8217;t have that problem) so I wrote some programs to open and close the clipboard and confirmed that symptons people report match that of a locked clipboard (in notepad copy is available but does nothing and paste in not available). </p>
<p>Because VB is such a UI dog and you won&#8217;t tell us the correct size of UI elements in pixels (VB makes everything wrong sizes and dlg units are useless) I tend to write windowless programs (because I&#8217;m really tired of counting pixels in paint of screenshots). This lead to a discovery (and the discovery gives me this excuse to rant). </p>
<p>If a invalid hwnd (and GetActiveWindow is invalid in this sense but not GetDesktopWindow() but this might be because I&#8217;m passing someone&#8217;s else&#8217;s hwnd) is passed to openclipboard() then any attempt by another program to open it will fail but will unlock the clipboard so a second call will work. </p>
<p>I have a sense and so do others that one frequently has to copy data twice. </p>
<p>Do you know anything about this? </p>
<p>* All references to lock is the state of the clipboard not memory lock functions a la 16 bit clipboard.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-313153">
				<div id="div-comment-313153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-313153">
			October 16, 2005 at 10:24 am</a>		</div>

		<p>What do the stars mean? </p>
<p>What&#8217;s the deal here between PSDK docs on RichEdit Hex to Unicode IME and XP&#8217;s Help and Support. Does XP&#8217;s apply to non richedit 3 (so wouldn&#8217;t apply to Wordpad) and PSDK to RE3. </p>
<p>I had thought prior to XP that it was 3 digit or 4 digit the IBM/ANSI. Is this still true. Will we get in trouble for calling it IBM. </p>
<p>Do all these rules resolve to the same thing. </p>
<p>From Hex to Unicode IME topic <br />============================= <br />2nd paragrapgh. <br />The second method involves the number pad. Here the user types ALT+NumPad numbers (with values greater than 255) to enter Unicode characters using decimal values. This method is not as useful as the first method because you cannot see what hexadecimal digits you typed. Also, you cannot correct them except by reentering them all again. </p>
<p>Platform SDK Release: August 2001 What did you think of this topic? <br />Let us know. Order a Platform SDK CD Online <br />(U.S/Canada) (International) </p>
<p>FROM HELP </p>
<p>If the first digit you type is 0, the value is recognized as a code point, or character value, in the current input language. For example, when your current input language is US-English (Code page 1252: Windows Latin-1), pressing ALT and then typing 0163 on the numeric keypad produces £, the pound sign (U+00A3). When your current input language is Russia (code page 1251: Windows Cyrillic), the same key sequence produces the Cyrillic capital letter JE (U+0408). <br />If the first digit you type is any number from 1 through 9, the value is recognized as a code point in the system&#8217;s OEM code page. The result differs depending on the Windows system language specified in Regional and Language Options in Control Panel. For example, if your system language is English (US), the code page is 437 (MS-DOS Latin US), so pressing ALT and then typing 163 on the numeric keypad produces ú (U+00FA, Latin lowercase letter U with acute). If your system language is Greek (OEM code page 737 MS-DOS Greek), the same sequence produces the Greek lowercase letter MU (U+03BC). </p>
<p>I came across this while trying to confirm that Insert (vs Overtype) is not a global state. Why don&#8217;t gui apps change the caret like terminal windows (command/cmd/any dos prog).</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-314953">
				<div id="div-comment-314953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.slcdug.org/esaputra' rel='external nofollow' class='url'>Erwien Saputra</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-314953">
			October 22, 2005 at 11:41 am</a>		</div>

		<p>I would like to know the history behind the earth map at the Date and Time properties, at the Time Zone tab. <br />I cannot click the map to change the time zone, there is no feedback whenever I change the Time Zone through the combo box. <br />It seems that the Map is there for cosmetic purpose.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315003">
				<div id="div-comment-315003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ivan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-315003">
			October 22, 2005 at 7:26 pm</a>		</div>

		<p>Is there a way to get the current full path from an explorer window?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-315023">
				<div id="div-comment-315023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dhiren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-315023">
			October 23, 2005 at 4:54 am</a>		</div>

		<p>Erwien:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/08/22/54679.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/08/22/54679.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-315043">
				<div id="div-comment-315043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan Baker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-315043">
			October 23, 2005 at 5:28 pm</a>		</div>

		<p>Hello, Raymond. I have been curious for a while now about why API functions seem to always use signed values, even when the value cannot logically ever be a negative number. Not just APIs, but also data structures (since when can a queue have a negative length?) and that sort of thing. <br />Maybe this question isn&#8217;t deep enough to warrant a post of its own, but it is something I have been curious about. <br />Thanks, <br />Nathan</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-318873">
				<div id="div-comment-318873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.TheSpoke.net/blogs/TravisOwens/' rel='external nofollow' class='url'>Travis Owens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-318873">
			November 3, 2005 at 2:50 pm</a>		</div>

		<p>What ever happened to the ram drive? </p>
<p>I&#8217;m sure there&#8217;s a great reason why ram drive was removed around the time Windows 95 shipped, but being DOS based, why was the ramdrive commant removed? </p>
<p>I know they serve more as a nerd toy for specific problems back in the day (ex: a small program that had to do excessive read/writes would get a huge boost from using a ram drive) but at times I&#8217;ve thought they could be usefull on a small scale. </p>
<p>So, why did ramdrive get the axe after DOS?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/08/25/8880082.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-319153">
				<div id="div-comment-319153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://qstuff.blogspot.com/' rel='external nofollow' class='url'>Justin Olbrantz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-319153">
			November 4, 2005 at 4:45 pm</a>		</div>

		<p>This may be too much like &#8220;topics I&#8217;m not inclined to cover&#8221;, but I figured I should ask just in case. I just learned about Singularity <a href="http://research.microsoft.com/os/singularity/" rel="nofollow">http://research.microsoft.com/os/singularity/</a> yesterday, and read some of the overview white paper <a>ftp://ftp.research.microsoft.com/pub/tr/TR-2005-135.pdf</a>. I think it looks really interesting and promising, and I was wondering what you think about it.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-320223">
				<div id="div-comment-320223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-320223">
			November 9, 2005 at 3:44 pm</a>		</div>

		<p>I don&#8217;t know if it&#8217;s caused by other applications or not, but it just happened to me now (just after the boot), so I am curious about this: </p>
<p>Is there a particular reason why, sometimes, a left click (on the desktop, but maybe in other applications) is interpreted as a right click and pops up a context menu. It persists for every left clicks until you decide to right click (to make the computer understand the difference, of course! :) ), then everything is in order again. </p>
<p>Is there a specific code (a workaround for something else maybe) that is triggered by error and cause the button &#8216;permutation&#8217;? <br />If so, what is its purpose?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-321353">
				<div id="div-comment-321353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.sencer.de' rel='external nofollow' class='url'>Sencer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-321353">
			November 11, 2005 at 7:52 am</a>		</div>

		<p>It looks like the defragmentation programs available for WinXP are worse than those for Win98. See this discussion (with comments from Vendors): </p>
<p><a href="http://www.experts-exchange.com/Operating_Systems/WinXP/Q_20323201.html" target=_new rel=nofollow rel="nofollow">http://www.experts-exchange.com/Operating_Systems/WinXP/Q_20323201.html</a> </p>
<p>I remember using Defragmentation Software on Win98 and having consolidated free space (in one big large chunk). But I, too, have made the observation, that with WinXP this is not possible anymore. Since I have a lot of Cygwin and Java related stuff installed, which uses many, many directories and small files, it seems I can never consolidate the 4 GB free space of my 15 GB partition. There are always the &#8220;folders&#8221; all over the free space fragmenting it into small pieces. </p>
<p>Is it true (as suggested in the link above) that Software for Win98 used to &#8220;lie&#8221;? Or did it in fact become (practically) <em>impossible</em> in WinXP to move all olders together and thus consolidate all free space into one chunk?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-321573">
				<div id="div-comment-321573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codinghorror.com/blog/' rel='external nofollow' class='url'>Jeff Atwood</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-321573">
			November 11, 2005 at 12:55 pm</a>		</div>

		<p>In reference to your post about how Calc and Notepad barely change.. </p>
<p><a href="http://blogs.msdn.com/oldnewthing/archive/2004/05/25/141253.aspx" target=_new rel=nofollow rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/05/25/141253.aspx</a> </p>
<p>Why not buy and bundle the &#8220;lite&#8221; versions of popular third-party solutions? Very little MS coding time (some QA), much happier customers: </p>
<p><a href="http://www.codinghorror.com/blog/archives/000441.html" target=_new rel=nofollow rel="nofollow">http://www.codinghorror.com/blog/archives/000441.html</a></p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/02/25/7885570.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322343">
				<div id="div-comment-322343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-322343">
			November 15, 2005 at 5:17 pm</a>		</div>

		<p>Windows XP lets me do pretty much anything I want to the system: install applications, delete files, move files, etc. and it never asks for my user account password&#8230; except when I create a new task using the Task Scheduler and then it asks for a password. I&#8217;ve often wondered about this&#8230;</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/03/03/7994005.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322403">
				<div id="div-comment-322403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PiersH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-322403">
			November 15, 2005 at 11:12 pm</a>		</div>

		<p>How can I get the Aero glass effect to extend into the client area of my app (like IE &amp; Explorer on vista#5231)? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322473">
				<div id="div-comment-322473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Radhakrishnan Mukkai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-322473">
			November 16, 2005 at 9:25 am</a>		</div>

		<p>When we have a dual monitor setup, why doesn&#8217;t the taskbar (at the bottom of the screen) span across both the screens?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-324423">
				<div id="div-comment-324423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-324423">
			November 25, 2005 at 9:43 am</a>		</div>

		<p>Two things that I&#8217;ve always wondered about. 1 &#8211; Why does the desktop loose track of the icons, so it has to refresh them? </p>
<p>And 2 &#8211; Why in the shell connected to explorer. If explorer crashes, then the shell restarts. Oh, and not all the tray icons reappear. Who thought that was a good idea??</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-325413">
				<div id="div-comment-325413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-325413">
			November 28, 2005 at 9:07 pm</a>		</div>

		<p>You&#8217;ve had a blog about &#8220;What causes a program to be marked as &#8220;new&#8221; on the Start menu?&#8221;&#8230; how about an under-the-hood look at the Windows Vista Start menu? Is it still shortcut file/folder based, or is it finally managed and tightly integrated with program installation? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326153">
				<div id="div-comment-326153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jojjo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-326153">
			November 30, 2005 at 2:26 pm</a>		</div>

		<p>Hi Raymond! </p>
<p>Do you have any insights into the evolution of WinHelp? How integrated with the developement of Windows is the developement of the help system? </p>
<p>On a related note, I have found it harder and harder to get help from inside Windows applications during the last ten years. When I want to know how to use a program today I tend to use Google or MSN Search instead. Is it just me, or are other users doing the same thing? Are application writers not paying as much attention to their help systems anymore or is the Web just a better way of finding information quickly?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-327763">
				<div id="div-comment-327763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-327763">
			December 5, 2005 at 5:34 pm</a>		</div>

		<p>If you&#8217;re ever bored, pull down the source for the win32 version of SWT. SWT is a Java GUI toolkit closely associated with the Eclipse IDE and is available as a standalone download from eclipse.org.</p>
<p>There are different versions of SWT for each platform the toolkit is available on &#8211; e.g. there&#8217;s a win32 version, linux/gtk version, etc.</p>
<p>The comments in the source code for the win32 version are pretty interesting. Search for &quot;bug in windows&quot; &#8211; just about every low-level class that interacts with the Win32 API has this comment, many in multiple places. It usually prefaces a long comment block explaining the &quot;bug&quot; in the Win32 API the following code is attempting to work around.</p>
<p>Are these really bugs? Or just nuances of the Win32 API the authors of SWT didn&#8217;t understand? Either way, these comment blocks indicate some of the more subtle aspects of the windows API, and discussions of them would make for some interesting blog posts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-328773">
				<div id="div-comment-328773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-328773">
			December 8, 2005 at 8:47 am</a>		</div>

		<p>Do you know why there is a GetDlgItemInt and a SetDlgItemInt but not a GetDlgItemFloat and a SetDlgItemFloat. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/03/10/8080067.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-328843">
				<div id="div-comment-328843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Deeming</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-328843">
			December 8, 2005 at 12:50 pm</a>		</div>

		<p>I&#8217;ve noticed that Internet Explorer (and WinZip, although that&#8217;s not something you can comment on) downloads data to a temporary file and then copies the file to its final location, before deleting the original. </p>
<p>Given that this results in 2x the disk space to copy, I don&#8217;t understand why the file isn&#8217;t simply moved? (Particularly if the source and destination locations are on the same partition!) </p>
<p>The other effect of this is that the copy obviously takes longer than the move, so the user (i.e. Me) has an additonal delay. </p>
<p>I&#8217;m sure there&#8217;s a weird, yet sensible, reason. <br />But what is it? </p>
<p>Thanks, <br />Jon.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-328913">
				<div id="div-comment-328913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">zd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-328913">
			December 8, 2005 at 9:56 pm</a>		</div>

		<p>Why can&#8217;t you rename the Recycle Bin? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/03/17/8080154.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-329833">
				<div id="div-comment-329833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-329833">
			December 13, 2005 at 1:32 am</a>		</div>

		<p>Hi, </p>
<p>I remember back in the times of DOS 2.11, there were plenty of warnings in the user guide to &#8220;never rename a COM file to .EXE or vice versa&#8221;. However, if you did, the system still happily ran the file with no problem. </p>
<p>Was some sort of hack added to prevent dumb users from doing exactly that? How did the DOS loader recognize the binary format? (Because, I assume, it could be possible to have a .COM file whose 2 first instructions would give &#8216;MZ&#8217;, so just checking for these bytes is not enough)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/03/24/8332730.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-329933">
				<div id="div-comment-329933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Moulton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-329933">
			December 13, 2005 at 12:20 pm</a>		</div>

		<p>Raymond, </p>
<p>Back in the Win95 &amp; 98 days, we had winipcfg to manage DHCP leases on the client. Additionally, we had an app (I think it was netmon) to let you view people currently accessing your shares. </p>
<p>Now, we have ipconfig on the command line and nothing like netmon. </p>
<p>I&#8217;d be interested in hearing why those tools weren&#8217;t retained.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/04/07/8364033.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-330023">
				<div id="div-comment-330023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Greg Webb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-330023">
			December 13, 2005 at 10:36 pm</a>		</div>

		<p>After doing an Internet search on &#8216;Windows Dialog Resources&#8217; I found your four part article on &#8216;The Evolution of Dialog Templates&#8217;. </p>
<p>What I would like to do is edit some of the dialog templates used by Outlook. I continually find that the space for the information that has to be displayed is not big enough. </p>
<p>I know about comdlg32, shell32 and user32 but none of these contain the tempaltes Outlook is using. Can you tell me where the the Outlook dialog templates are stored? </p>
<p>A suggestion for a future topic is, Customising dialogs for popular Microsoft software.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-330063">
				<div id="div-comment-330063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Greg Webb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-330063">
			December 14, 2005 at 12:56 am</a>		</div>

		<p>Okay, I&#8217;ve solved it. The dialogs are in:</p>
<p>      c:Program FilesMicrosoft OfficeOffice111033outllibr.dll</p>
<p>Dialog numbers:<br />
<br />      2098 &#8211; Categories<br />
<br />      2099 &#8211; Master Category List</p>
<p>My suggestion for future topic stands, although my discovery allows me to make my own way on this now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-331503">
				<div id="div-comment-331503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evgeny Krivosheev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-331503">
			December 20, 2005 at 5:37 am</a>		</div>

		<p>Some time ago I was got problem with WSUS server that not worked because anonymous user was not allowed to access specified directory. <br />I was found error source and solved it, but I spend lot of time to find problem source. </p>
<p>Source was interesting: Settings in one of domain policies was not specified anonymous users in list of users that have &#8220;Bypass traverse checking&#8221; right and anonymous users also do not have proper rights in one of parent directories. </p>
<p>Why I spend so much time to this problem? Because only error that I can get is ACCESS_DENIED. I was used lot of tools to find source of problem (one of most helpful was FileMon from Mark Rusinovich) but when I go deeper &#8211; I always stopped by too short error message. Using tools that I have or can find I cannot determine who is blocking user access. For sure I was checked ACL&#8217;s and restrictions in policies. I was checked IIS settings many times too. But for long time I have no idea &#8211; what is real source of deny message. </p>
<p>Maybe you find this theme interesting for you: it is exists any calls to find more information for ACCESS DENIED errors? After solving problem I also spend some time to search for answer, but cannot find anything interesting.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-333253">
				<div id="div-comment-333253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Praful</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-333253">
			December 29, 2005 at 8:17 pm</a>		</div>

		<p>In your post &#8220;How to host an IContextMenu, part 10&#8221; (<a href="http://blogs.msdn.com/oldnewthing/archive/2004/10/06/238630.aspx" target="_new" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/10/06/238630.aspx</a>), you mentioned the need to check if there&#8217;s room between idCmdFirst and idCmdLast. I have some questions related to do this for context menu shell extensions:</p>
<p>1. What happens if there&#8217;s not enough room? Are you not supposed to activate your shell extension?</p>
<p>2. I&#8217;m developing a shell extension that when called by Explorer, adds one top level menu item on the context menu and five sub menu items (a bit like WinZip). These submenu items have submenus defined &#8211;  so they can be expanded dynamically. I listen for WM_INITMENUPOPUP messages in HandleMenuMsg2 to expand the submenus. When I get a message I expand one of the five submenu items. The actual number of menu items is not predictable. Therefore, what should I return to Explorer when it calls QueryContextMenu since I don&#8217;t know how many menu IDs I&#8217;ll eventually require (could be several hundred since there are many cascading submenus)? If I return 6 (one top level + 5 submenu items), Explorer eventually stops firing WM_INITMENUPOPUP. I&#8217;ve noticed that if Explorer gives me a narrow range for idCmdFirst and idCmdLast (eg 31085 and 31226, as it did while testing), I can&#8217;t add that many items since WM_INITMENUPOPUP is not fired. How do I tell Explorer that I may add, say, 500 menu items eventually?</p>
<p>Thanks</p>
<div class="post">[<i>I decline to answer this question because the answer is boring. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-333623">
				<div id="div-comment-333623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-333623">
			January 3, 2006 at 8:46 am</a>		</div>

		<p>When using the &#8220;dir&#8221; command in DOS and Windows (command.com) there appears to be a pause after listing a directory the first time it is done. If you know, would you care to comment on what&#8217;s happening there? Is it a free space calculation?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335313">
				<div id="div-comment-335313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://rolfhub.de/de/' rel='external nofollow' class='url'>Rolf Viehmann</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-335313">
			January 7, 2006 at 8:33 pm</a>		</div>

		<p>There&#8217;s one limitation to the normal windows explorer, that bugs me quite much: It seems as if the windows explorer prevents the user from naming files as he / she wants to, even if the underlying file system is perfectly capable to store the name the user entered. </p>
<p>For example, you can&#8217;t name a file &#8220;.htaccess&#8221; (without the quote marks of course), or you can&#8217;t have &#8220;.NET Framework SDK&#8221;. The problem in both cases seems to be the first character (the dot), but if you name the file any different (without the leading dot or whatever), then use any other program that is capable of renaming files / folders, it&#8217;s not problem at all for the filesystem (and all programs) to accept the name with the leading dot. For example, you could just use the normal cmd.exe, or any FTP/SCP-program (most of them are capable to rename files on lokal dirs, too). </p>
<p>I would really like to know the rationale behind this nonsensical behaviour. </p>
<p>I wouldn&#8217;t mind a warning &#8220;file names with leading dots may make some problems with old software, do you know what you are doing [YES][NO(default button)]&#8221;, but simply disallowing the user to use the name seems to be a bad idea for me &#8230; </p>
<p>If you could shed some light on this issue, that would be great. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/04/14/8389268.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335353">
				<div id="div-comment-335353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-335353">
			January 8, 2006 at 9:24 am</a>		</div>

		<p>A few topic requests (two copied forward from the previous suggestion box). </p>
<p>An explanation of the correct use of ScrollWindowEx. </p>
<p>When you have (e.g.) a dialog containing controls which are outside of its client area, it makes sense to use ScrollWindowEx when you want to scroll them into view. Whenever I&#8217;ve tried this in the past, I&#8217;ve had to do some arcane tricks to get proper painting to occur without leaving glitches and artifacts &#8211; and I&#8217;ve heard the same story from many others. Of course, doing a full repaint misses the point &#8211; which is, scrolling the DC so that you don&#8217;t need to repaint everything. There has to be a correct way to use this API :) </p>
<p>(The following were copied from the previous box:) <br />A couple of topics (one I&#8217;ve brought up before, another that someone else brought up in the NCCALCSIZE discussion in Feb. but you haven&#8217;t returned to yet). </p>
<p>1. Window Activation &#8211; how it works (and why you need to do the whole message-eating modal loop for FakeMenu). </p>
<p>2. WS_EX_TRANSPARENT &#8211; what does this really do? For example, using GroupBoxes on a dialog with WS_CLIPCHILDREN enabled, you need WS_EX_TRANSPARENT on the group box or else its background is painted incorrectly. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-336153">
				<div id="div-comment-336153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave Anderson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-336153">
			January 11, 2006 at 11:32 am</a>		</div>

		<p>I have just sent a frustrated letter to the Microsoft exec team and the SBA team. For those who do not know, Microsoft Small Business Accounting is a recent addition to the Office Suite. </p>
<p>The essence of the letter is that SBA is the first example (IMHO) of one of the &#8220;new .NET products&#8221; that clearly demonstrates how losing the WIN32 API war is affecting true developers. The product is essentially unusable for a developer! </p>
<p>It certainly should not be listed as an Office component because it does not interoperate with other Office components when one talks about the core of any accounting system (i.e. transactions). I could not believe that transactions cannot be moved from Excel to SBA! </p>
<p>The UI clearly breaks Microsoft&#8217;s own guidelines which we have been faithfully following for the last 20 years. Try using keystrokes to accomplish SBA functionality and you will quickly run into a brick wall. </p>
<p>The COM interfaces that Office uses to provide developer power are gone with SBA. Even the ADO interfaces are missing to allow open interfaces with other components. </p>
<p>I can only imagine that the SBA team are part of the &#8220;we don&#8217;t care about developers&#8221; team. There seems to be no effort at interoperability, component interchange, power users, accessibility or any of the other important concepts that have drawn developers to Microsoft. </p>
<p>If this is the future, then we might as well give up being developers which is a truly frightening prospect (for me anyway). I have been working with Microsoft products since the start and have always enjoyed working with them. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-336473">
				<div id="div-comment-336473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Kankowski</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-336473">
			January 12, 2006 at 3:20 am</a>		</div>

		<p>Why does not Windows XP send WM_CLOSE and WM_DESTROY messages to open windows during shutdown? I have found that it sends the following messages: <br />1) WM_ACTIVATE with wParam == WA_ACTIVE, <br />2) WM_SETFOCUS, <br />3) uMsg == 0x3B with wParam == 11 (have no idea what is it; there is no such message in WinUser.h), <br />4) WM_QUERYENDSESSION, <br />5) uMsg == 0x3B with wParam == 9, <br />5) WM_ENDSESSION. </p>
<p>But there is no WM_CLOSE or WM_DESTROY! There are some widely-used applications that fail to handle shutdown; e.g., they &#8220;forget&#8221; to save window position, because they expect WM_CLOSE message and put saving configuration in the WM_CLOSE message handler. Why not send them WM_CLOSE and WM_DESTROY? Thank you in advance.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/04/21/8413175.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-336513">
				<div id="div-comment-336513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com/' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-336513">
			January 12, 2006 at 5:32 am</a>		</div>

		<p>Why does Windows now also clear the Start menu Run history when you clear the list of recently opened documents? Windows 95 and NT 4.0 just used to clear the Recent Documents menu and left the Run history alone.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/04/28/8433345.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-336533">
				<div id="div-comment-336533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-336533">
			January 12, 2006 at 6:56 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://winhistory.de/more/386/xpmini_eng.htm" rel="nofollow">http://winhistory.de/more/386/xpmini_eng.htm</a></p>
<p>An interesting attempt to find out what the mininum hardware Windows XP can run on. </p>
<p>Includes plenty of screenshots. Just thought you might like it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337323">
				<div id="div-comment-337323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.itimdp4.com' rel='external nofollow' class='url'>Alun Williams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337323">
			January 13, 2006 at 12:20 pm</a>		</div>

		<p>I came across your article about DeferWindowPos() today. I have found this API can cause leaks. If you get return value of 0 with Error 87 (Invalid parameter) and then you SHOULD call EndDeferWindowPos() with the previous HDWP, because, at least on XP and 2000, the user object BeginDeferWindowPos() allocated has not been freed. Since this is against the documentation I am going to give up on the API and call SetWindowPos instead. <br />Why do I get error 87? I have no idea. All the parameters are valid for the function but I sometimes get a failure on the very first call to DeferWindowPos(). </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/05/05/8459022.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-337343">
				<div id="div-comment-337343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.itimdp4.com' rel='external nofollow' class='url'>Alun Williams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337343">
			January 13, 2006 at 12:21 pm</a>		</div>

		<p>SHOULD call EndDeferWindowPos() with the previous HDWP, because, at least on XP and 2000, the user object BeginDeferWindowPos() allocated has not been freed. Since this is against the documentation I am going to give up on the API and call SetWindowPos instead.<br />
<br />Why do I get error 87? I have no idea. All the parameters are valid for the function but I sometimes get a failure on the very first call to DeferWindowPos().<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337693">
				<div id="div-comment-337693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dirk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337693">
			January 14, 2006 at 9:17 pm</a>		</div>

		<p>Who wrote this code?</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/timers/usingtimers.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/timers/usingtimers.asp</a></p>
<p>while (GetMessage(&amp;msg, // message structure<br />
<br />            NULL,           // handle to window to receive the message<br />
<br />            NULL,           // lowest message to examine<br />
<br />            NULL)          // highest message to examine<br />
<br />           != 0 &amp;&amp; GetMessage(&amp;msg, NULL, NULL, NULL) != -1)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-337743">
				<div id="div-comment-337743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337743">
			January 15, 2006 at 1:57 pm</a>		</div>

		<p>I&#8217;ve recently been panicking [sic] about being obsolete. Can you discuss win32 and Vista? Or least point us to forum that does? Thanks.<br />
<br />benya at dandy dot net</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337853">
				<div id="div-comment-337853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johann Scheepers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337853">
			January 16, 2006 at 5:29 am</a>		</div>

		<p>From what I understand you are the TweakUI author, so I want to ask why the &#8220;Prevent applications from stealing focus&#8221; option doesn&#8217;t work (for IM programs that generally flash on the taskbar until you click them) if I set it to &#8220;Flash taskbar button x times&#8221;. Instead, it flashes indefinitely. </p>
<p>Is this tweak broken because of the IM programs themselves? Surely this would override the IM program&#8217;s settings?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/05/12/8490184.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-337863">
				<div id="div-comment-337863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com/blog' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337863">
			January 16, 2006 at 5:39 am</a>		</div>

		<p>Hi Raymond, </p>
<p>When a dialog control is hidden (I mean WS_VISIBLE cleared, as opposed to coordinates outside dialog client area), it can still be &#8216;triggered&#8217; (not sure &#8216;focused&#8217; would be the right word here) using its mnemonic key. <br />For example, a push-button can be pushed by striking Alt+mnemonic key. </p>
<p>It looks pretty confusing/dangerous: An action can be triggered even though the button is hidden. </p>
<p>What&#8217;s the rationale behind this behaviour ? </p>
<p>TIA.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/06/02/8568490.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337903">
				<div id="div-comment-337903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-337903">
			January 16, 2006 at 10:03 am</a>		</div>

		<p>Not sure if this is exactly shell related, but it&#8217;d be nice to know the reason behind the XP regression regarding the conflict between mapping a network drive and plugging in a removable USB-mass-storage device.</p>
<p>(If you haven&#8217;t heard: The USB device chooses the first letter after the fixed disk drives (and perhaps CD-ROM), whether it&#8217;s in use as a network drive or not.  2000&#8217;s USB driver skipped any network drives that it found, so it works.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-338183">
				<div id="div-comment-338183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-338183">
			January 16, 2006 at 6:04 pm</a>		</div>

		<p>Find out why the search box on your blog isn&#8217;t working correctly. For example, search for &#8220;Katamari Damacy&#8221; and you get no hits. However this page does exist: <a href="http://blogs.msdn.com/oldnewthing/archive/2005/10/04/476848.aspx" target=_new rel=nofollow rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/10/04/476848.aspx</a></p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-338253">
				<div id="div-comment-338253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dandabass</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-338253">
			January 17, 2006 at 2:23 am</a>		</div>

		<p>Mr. Raymond!</p>
<p>Hi, I don&#8217;t really remember how or when I started reading your blog, but I find your point of views pretty much down to earth and interesting, and I just feel there&#8217;s a lot to learn from you!</p>
<p>So, I was unistalling a program, and after a pop-up message i asked myself:</p>
<p>What was Windows thinking when throwing this kind of questions to home users??!:</p>
<p>e.g.:<br />
<br />&quot;The file C:WINDOWSsystem32mfc70enu.dll may no longer be needed by any application.  You can delete this file, but doing so may prevent other applications from running correctly.  Select Yes to delete the file.&quot;</p>
<p>I mean, from a usability point of view, picture a home user, unistalling this software at around 3am&#8230; and he had never seen the mfc70enu.dll in his life!.. what kind of choices can he make? &#8216;It MAY no longer be needed bay any app, BUT! other apps my not run correctly&#8217;??</p>
<p>I guess the questions are:  How are this kind of messages thought? What&#8217;s the point of showing them? (keeping in mind Windows&#8217; target audience)  What department is responsible for making these kind of decisions?  What kind of reactions are expected from users?</p>
<p>Thanks a lot for your blog!</p>
<p>Dan.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-338263">
				<div id="div-comment-338263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-338263">
			January 17, 2006 at 8:52 am</a>		</div>

		<p>In the context of an ansi (not unicode) app: How do the common controls (listview for example) decide which code page to use when translating multibyte to widestring? </p>
<p>I had to debug an ansi app that was displaying corrupt strings on a traditional chinese system because the dialog font was causing the listview to use a codepage other than the system ACP when translating multibyte to widechar.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/06/16/8602155.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-339383">
				<div id="div-comment-339383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig Ringer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-339383">
			January 20, 2006 at 11:17 pm</a>		</div>

		<p>Pavel&#8217;s suggestion on DLLs is a good one. I&#8217;d be interested in hearing a bit about how the win32 DLL interface came about and how it evolved. That could be extremely helpful as well as interesting. </p>
<p>It&#8217;d also be interesting to hear a quick explanation of, or pointers to information about, win32 DLL symbol import/export, since it&#8217;s clear many people &#8211; even win32 developers &#8211; don&#8217;t understand this, and good information on it is hard to find. </p>
<p>To me the most interesting topic of all would be cross-DLL memory management, especially in a mixed code environment (two different c++ compilers with different runtime libraries; 32bit and 64bit DLLs; etc) . These mixed environments are almost inescapable on Windows, and finding decent information about working with them has been nigh impossible thus far. </p>
<p>I&#8217;m a UNIX guy helping with the win32 port of an app I work on. Information on these issues has been hard to come by &#8211; and even knowing the background of why win32 DLLs work how they do would be useful and interesting. I&#8217;m not sure if it&#8217;s really your area, but I&#8217;d be very surprised if you didn&#8217;t have a few gems about the DLL interface&#8217;s beginnings.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-339423">
				<div id="div-comment-339423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Ashton (cashto)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-339423">
			January 21, 2006 at 8:51 pm</a>		</div>

		<p>I came across an interesting bug this weekend that I’ve never seen described anywhere else, I thought it might be good fodder for your blog. </p>
<p>What do you suppose the following code does? </p>
<p>CComBSTR bstr; <br />bstr = ::SysAllocStringLen(NULL, 100); </p>
<p>a) Allocates a BSTR 100 characters long. <br />b) Leaks memory and, if you’re really lucky, opens the door for an insidious memory corruption. </p>
<p>Obviously I’m writing here, so the answer cannot be A. It is, in fact, B. </p>
<p>The key is that CComBSTR is involved here, so operator= is being invoked. And operator=, as you might recall, does a deep copy of the entire string, not just a shallow copy of the BSTR pointer. But how long does operator= think the string is? Well, since BSTR and LPCOLESTR are equivalent (at least as far as the C++ compiler is concerned), the argument to operator= is an LPCOLESTR – so operator= naturally tries to use the wcslen length of the string, not the SysStringLen length. And in this case, since the string is uninitialized, wcslen often returns a much smaller value than SysStringLen would. As a result, the original 100-character string is leaked, and you get back a buffer that can only hold, say, 25 characters. </p>
<p>The code you REALLY want here is: </p>
<p>CComBSTR bstr; <br />bstr.Attach(::SysAllocStringLen(NULL, 100)); </p>
<p>Or: </p>
<p>CComBSTR bstr(100); </p>
<p>I’m still a big fan of smart pointers (surely the hours spent finding this bug would have been spent finding memory leaks caused by other incautious programmers), but this example gives pause – CComBSTR and some OLE calls just don’t mix. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/06/23/8640472.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-339453">
				<div id="div-comment-339453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Whatever</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-339453">
			January 23, 2006 at 4:18 am</a>		</div>

		<p>What is the story behind the LOADPARMS32 structure? It takes a mix of C-style (NULL terminated) and Pascal (leading byte length) strings, and has a paramter which &#8220;must be 2&#8221;. What a mess!</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/06/23/8640472.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-339743">
				<div id="div-comment-339743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.Sax.net/live' rel='external nofollow' class='url'>Mike Sax</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-339743">
			January 23, 2006 at 4:12 pm</a>		</div>

		<p>How does the Task Manager determine that an application is &quot;Not responding&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-340543">
				<div id="div-comment-340543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotgeek.blogspot.com/' rel='external nofollow' class='url'>Duncan Bayne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-340543">
			January 24, 2006 at 8:09 pm</a>		</div>

		<p>One of the things I like about coding in the GNU environment is the availability of clear guidelines (now, if only people would follow them &#8230;)</p>
<p>I remember starting off coding for Linux and thinking &quot;how should I best go about this?&quot;, trotting off to the FSF site and finding the GNU Coding Standards, a copy of which I still have lying around in the off chance I ever find myself coding in C again ;-)</p>
<p>Now, what would be great would be a Windows equivalent.  It could be a post to your blog, it could be a static page on the Microsoft site, whatever works.  But it should contain:</p>
<p> &#8211; how to pay &#8216;taxes&#8217; (i.e. the things different types of apps need to get right on the Windows platform)</p>
<p> &#8211; UI standards (not just GUI standards, but guidelines for CLI apps, services, etc.)</p>
<p> &#8211; Best practices for Windows components like WMI, Event Log, etc. </p>
<p> &#8211; Coding standards for particular languages, and verfication tools (e.g. C# and FxCop)</p>
<p>Microsoft often complains, justifiably, that a lot of complaints about Windows in fact have their origins in poorly behaved Windows applications.</p>
<p>This would be a way of fixing that, while creating a &#8216;buzz&#8217; amongst developers.  It&#8217;d also make it easier to attract new developers to the platform, and it&#8217;d make my job a whole heap easier too :-)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-341513">
				<div id="div-comment-341513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-341513">
			January 27, 2006 at 8:45 pm</a>		</div>

		<p>hello</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-341653">
				<div id="div-comment-341653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-341653">
			January 30, 2006 at 9:11 am</a>		</div>

		<p>When installing a font with the control panel, why does it have that retro windows 3.1 look? I&#8217;ve even seen the directory box suddenly use only capital chars (when changing the current drive, doesnt always work and i dont know the exact steps to reproduce), like it would back in 1992 or earlier. It&#8217;s even in server 2k3! <br />Then, when it goes ahead and install the fonts, the copy dialog looks cool too. </p>
<p>Like if no-one ever wants to install a font :D</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/07/14/8730046.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-341673">
				<div id="div-comment-341673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-341673">
			January 30, 2006 at 10:29 am</a>		</div>

		<p>Is it possible to use a loaded icon resource from another DLL (loaded with LOAD_LIBRARY_AS_DATAFILE) with MessageBoxIndirect? I have succesfully used FindResourceEx, SizeofResource, CreateIconFromResourceEx and CopyIcon to obtain a &#8220;local&#8221; copy of the icon, so I can then use FreeLibrary and then use it with WM_SETICON and STM_SETICON (ofcourse checking all the return values in the process, except in places where it doesnt make sense trying to handle the error like with FreeLibrary). </p>
<p>Can I somehow use the HMODULE handle from LoadLibraryEx to point MessageBoxIndirect to the right place? Is there another trick to it (one that doesn&#8217;t involve copying the icon to a file on disk, and pointing to that, because that&#8217;s an awfully sloppy method, and my program should not expect write access, because it should be capable of running as Guest). </p>
<p>It would be very much appreciated in my current (free) application, for consistency. Ofcourse when showing error messages, warnings and such i use the system provided icons. </p>
<p>Much thanks in advance.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/07/21/8760127.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-341683">
				<div id="div-comment-341683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-341683">
			January 30, 2006 at 10:29 am</a>		</div>

		<p>Is it possible to use a loaded icon resource from another DLL (loaded with LOAD_LIBRARY_AS_DATAFILE) with MessageBoxIndirect? I have succesfully used FindResourceEx, SizeofResource, CreateIconFromResourceEx and CopyIcon to obtain a &quot;local&quot; copy of the icon, so I can then use FreeLibrary and then use it with WM_SETICON and STM_SETICON (ofcourse checking all the return values in the process, except in places where it doesnt make sense trying to handle the error like with FreeLibrary).</p>
<p>Can I somehow use the HMODULE handle from LoadLibraryEx to point MessageBoxIndirect to the right place? Is there another trick to it (one that doesn&#8217;t involve copying the icon to a file on disk, and pointing to that, because that&#8217;s an awfully sloppy method, and my program should not expect write access, because it should be capable of running as Guest).</p>
<p>It would be very much appreciated in my current (free) application, for consistency. Ofcourse when showing error messages, warnings and such i use the system provided icons.</p>
<p>Much thanks in advance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-341743">
				<div id="div-comment-341743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-341743">
			January 30, 2006 at 1:21 pm</a>		</div>

		<p>Oops, sorry for the double post. The first one gave back an error, so I hit the back button and resubmitted.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342233">
				<div id="div-comment-342233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-342233">
			January 31, 2006 at 7:57 pm</a>		</div>

		<p>I recently wrote a little tool for scanning the Import address table for all Windows-processes in memory to compare it with the IAT of the binary file on disk in order to catch nasty userland API-hookers.<br />
<br />When scanning explorer.exe in Windows 2000, I noticed, that the following functions which are imported from kernel32.dll point outside the location where the kernel32.dll is mapped to explorer.exe&#8217;s memory:<br />
<br />&#8211; CreateProcessW</p>
<p>&#8211; LoadLibraryW<br />
<br />&#8211; GetProcAddress<br />
<br />&#8211; FreeLibrary<br />
<br />&#8211; LoadLibraryA<br />
<br />When searching the Internet, I found out that I&#8217;m not the only person who discovered this<br />
<br />interesting behaviour. The following sites also contain a note about it:</p>
<p><a rel="nofollow" target="_new" href="http://www.phrack.org/show.php?p=62&amp;a=12" rel="nofollow">http://www.phrack.org/show.php?p=62&#038;a=12</a><br />
<br /><a rel="nofollow" target="_new" href="http://indian-hackers.net/print.php?sid=273&amp;MDPROSID=19710ea969355ff0ca5e2b128945be0e" rel="nofollow">http://indian-hackers.net/print.php?sid=273&#038;MDPROSID=19710ea969355ff0ca5e2b128945be0e</a> </p>
<p>Now I thought that you may know the reason, why those IAT-entries are replaced when loading and what explorer.exe does here. It would be really interesting to know. Maybe there is an intersting story behind this.</p>
<p>Thanks in advance!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342363">
				<div id="div-comment-342363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://diegocg.blogspot.com' rel='external nofollow' class='url'>Diego Calleja</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-342363">
			February 1, 2006 at 10:34 am</a>		</div>

		<p>I realized that in XP users can&#8217;t install themes. In fact, it seems that you need to have your themes signed to be able to use them &#8211; there&#8217;re some utilities that overwrite a dll to get rid of this &quot;limitation&quot; though</p>
<p>I was somewhat surprised that there&#8217;s such limitation. But after thinking a while, a conspiration theory came to my mind: part of the windows graphics subsystem is inside the kernel, and the themes may be being run with system privileges? I suppose that Longhorn will get rid of this limitation? (I&#8217;ve heard that part of the graphcis subsystem is going to userspace again)</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342513">
				<div id="div-comment-342513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.knowing.net' rel='external nofollow' class='url'>Larry O'Brien</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-342513">
			February 1, 2006 at 5:13 pm</a>		</div>

		<p>How do you manipulate the taskbar&#8217;s position programmatically? </p>
<p>There&#8217;s no ABM_SETTASKBARPOS message and the taskbar seems to ignore SetWindowPos() commands. Well, more accurately, it seems to obey them <em>once</em> after the shell is started and then ignore them subsequently.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342823">
				<div id="div-comment-342823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com/blog' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-342823">
			February 3, 2006 at 7:11 am</a>		</div>

		<p>Hi Raymond,</p>
<p>How does one prevent the background image of a listview control (set using ListView_SetBkImage()) to move when user scrolls the list.</p>
<p>The image used by Windows Explorer correctly stays in the lower right corner. But my experience (including all the reports I&#8217;ve found) is that the image scrolls whan uer scrolls the list :-(</p>
<p>Also, what is the purpose of the undocumented flag LVBKIF_TYPE_WATERMARK ?</p>
<p>TIA,</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-343103">
				<div id="div-comment-343103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AnotherMatt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-343103">
			February 4, 2006 at 5:54 am</a>		</div>

		<p>Why don&#8217;t console programs under Win32 support SIGINT? That&#8217;s&#8230;.lame. :-) </p>
<p>&#8220;Note SIGINT is not supported for any Win32 application including Windows NT and Windows 95. When a CTRL+C interrupt occurs, Win32 operating systems generate a new thread to specifically handle that interrupt. This can cause a single-thread application such a UNIX [sic], to become multithreaded, resulting in unexpected behavior.&#8221; &#8211; MSDN under signal() </p>
<p>I&#8217;ve run into this problem where I&#8217;m using CLisp, which is a console-based programming environment, and I hit Ctrl+C to stop the Lisp program, and it stops, but what I&#8217;m assuming is this &#8220;extra thread&#8221; will ask me &#8220;Terminate batch job [Y/N]?&#8221; (I usually run CLisp from a batch file) and if I hit &#8216;N&#8217; it will start alternating between the CLisp prompt and the DOS prompt. Strange! </p>
<p>I think the problem is with SIGINT, but I must admit I&#8217;m not totally positive. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/07/28/8781423.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-343183">
				<div id="div-comment-343183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-343183">
			February 5, 2006 at 10:56 am</a>		</div>

		<p>I thought ^C sends a SIGABRT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-solrac29 even thread-even depth-1" id="comment-343223">
				<div id="div-comment-343223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Carlos+hm' rel='external nofollow' class='url'>Carlos hm</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-343223">
			February 5, 2006 at 2:56 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>Did you know about it?<br />
<br /><a rel="nofollow" target="_new" href="http://blogs.msdn.com/carloshm/archive/2006/02/05/525246.aspx" rel="nofollow">http://blogs.msdn.com/carloshm/archive/2006/02/05/525246.aspx</a></p>
<p>I didn&#8217;t find any article related to this bug?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-343273">
				<div id="div-comment-343273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fred Fenster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-343273">
			February 6, 2006 at 4:55 am</a>		</div>

		<p>Why when you sort icons &#8216;by name&#8217; on the desktop My Documents appears above My Computer? I&#8217;m assuming &#8216;by name&#8217; means alphabetical, but evidentally not.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/08/04/8824356.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-343293">
				<div id="div-comment-343293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-343293">
			February 6, 2006 at 8:39 am</a>		</div>

		<p>8: No, Ctrl-C sends SIGINT. &nbsp;Unless you mess with your Unix terminal driver, anyway.</p>
<p>SIGABRT is sent by the abort() syscall.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-343363">
				<div id="div-comment-343363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://apipes.blogspot.com' rel='external nofollow' class='url'>Tim Lesher</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-343363">
			February 6, 2006 at 11:04 am</a>		</div>

		<p>How about a little history on wsprintf()? </p>
<p>Today a coworker asked me why wsprintf() wasn&#8217;t formatting his string correctly, even though he was using it for a wide (Unicode) string. &nbsp;I told him that 1) the &#8216;w&#8217; in wsprintf doesn&#8217;t mean &#8220;wide&#8221;, and 2) wsprintf has never supported the floating point values he was trying to format. </p>
<p>I went into the historical reasons wsprintf exists in its current form (old C runtime limitations, memory models, and FPU support, as I recall), but I&#8217;m not sure I got all the details right. It would be nice to have another old-schooler back me up&#8230;</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/03/10/8080067.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-344333">
				<div id="div-comment-344333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sean.cyberwang.net' rel='external nofollow' class='url'>Sean Bryant</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-344333">
			February 8, 2006 at 5:38 pm</a>		</div>

		<p>Alright, I&#8217;ve managed to do this but with great hackery. I have to custom draw the control myself manage the locations entirely by hand. Each control has to be handeld in its own proc or have a hook of some sort. I did handle this by wrapping the entire control into C++ class (static proc that gives itself up to an internal proc). And even still there are odd little drawing bugs. Lets say I embedd a bitmap button. Now the problem I encounter is when you click the button drawing for the rest of the control stops which is obviously a problem because you can click-hold drag the mouse of the treeview and you&#8217;ll have a nice white space. Now when you do let go everything is drawn but the button when you mose over shows its still pressed! </p>
<p>With more hackery I could handle the not redrawing while being help with threads. Or If I&#8217;m really lazy I can handle this with a run once low resolution timer to draw the button in the background. &nbsp;</p>
<p>There has to be something a bit better than what I&#8217;m currently doing. And I&#8217;m sure Raymond can shed some light on embedding controls in other controls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-344833">
				<div id="div-comment-344833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Silk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-344833">
			February 9, 2006 at 11:48 pm</a>		</div>

		<p>[my goodness there is alot of suggestions here; this is mine to add to the pile :)]</p>
<p>Why doesn&#8217;t programmatic access to Mapped Network Drives attempt a connection if the drive is &quot;Disconnected&quot;?</p>
<p>I&#8217;ve found I have to manually double-click the drive and force it to connect before my programs (in this case Apache) will recognise that the drive is, in fact, valid and connected.</p>
<p>I&#8217;d like to know why this is the case.</p>
<p>Thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-344893">
				<div id="div-comment-344893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com/blog' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-344893">
			February 10, 2006 at 5:17 am</a>		</div>

		<p>Why don&#8217;t console windows have the XP look ?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/12/31/6909007.aspx" rel="nofollow">Dup</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-344993">
				<div id="div-comment-344993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.immergetech.com' rel='external nofollow' class='url'>Joshua Blake</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-344993">
			February 10, 2006 at 11:14 am</a>		</div>

		<p>My suggestion is from a simple thing a lot of us have probably seen but never given a second thought to: </p>
<p>In Word, when you print a document it says in the status bar &#8220;Word is preparing to background print the document&#8230;&#8221; &nbsp;The term &#8220;background print&#8221; seems to imply there are or used to be other types of printing like foreground, maybe harking back to the Win95 or *gasp* Win3.11 or DOS days. &nbsp;I&#8217;d like to hear if you have any insight into the old days of printing, or whether this is just an odd status message. </p>
<p>Thanks! Love the blog and your insights.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/12/01/9159146.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-345303">
				<div id="div-comment-345303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Demeli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-345303">
			February 12, 2006 at 7:46 am</a>		</div>

		<p>Why does winlogon take down the entire system when you attach a debugger to it? (drwtsn32 -p &lt;pid of winlogon&gt;</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/10/13/8969404.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-345323">
				<div id="div-comment-345323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AnotherMatt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-345323">
			February 12, 2006 at 11:08 am</a>		</div>

		<p>Tim Lesher: He&#8217;s probably looking for swprintf(), where the &quot;w&quot; does mean &quot;wide&quot;.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-345383">
				<div id="div-comment-345383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamessummerlin.blogspot.com' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-345383">
			February 12, 2006 at 11:58 pm</a>		</div>

		<p>Mr. Chen, </p>
<p>Earlier today, some &#8220;classmates&#8221; (using the term very loosely here) got into a big debate (read: heated argument) about the new One Care antivirus system MS will soon be releasing. &nbsp;All of my &#8220;classmates&#8221; criticized me horribly for MS releasing such technology at $50 a pop (I&#8217;m the only MS supporter in the group). &nbsp;They all said things like, &#8220;MS should just fix their shit so viruses and crap can&#8217;t infiltrate the system to begin with instead of just once again finding a way to rape the customer&#8217;s wallet.&#8221; </p>
<p>Is there any way I can talk you into making a post or two about this? &nbsp;I&#8217;m certain there is a perfectly reasonable explanation for all this. &nbsp;There has been for everything else so far. </p>
<p>Regards, <br />James</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/09/11/8942473.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-345663">
				<div id="div-comment-345663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dhiren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-345663">
			February 14, 2006 at 1:52 am</a>		</div>

		<p>Hi Raymond, </p>
<p>Any idea why the address bar in Explorer randomly decides to reset itself while you&#8217;re typing in it? &nbsp;I&#8217;ve noticed it seems to happen mostly when accessing remote machines, but sometimes when typing local paths as well. &nbsp;e.g. I&#8217;m in my downloads directory, I copy a file, and then Alt+D to the address bar and start typing &#8216;<a rel=nofollow target=_new rel="nofollow">ftp://user@servername/public_html</a>&#8216; but before I get even half-way through, Explorer decides to reset the contents of the address bar back to &#8216;D:Downloads&#8217;, all highlighted, so the end result is something like &#8216;ame/public_html&#8217;. </p>
<p>Is this something to do with the address bar&#8217;s auto-complete?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/12/15/9216764.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346103">
				<div id="div-comment-346103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-346103">
			February 15, 2006 at 9:42 pm</a>		</div>

		<p>Hi, </p>
<p>I am currently coding an application for which I&#8217;m doing an x86 (ANSI and Unicode) and x64 (Unicode only) build. </p>
<p>At runtime, the installer (NSIS) detects the Windows version and copies the right build. However, when run on an x64 computer, since the installer is 32-bit, it detects the &#8220;C:Program Files (x86)&#8221; path as the %ProgramFiles% directory. </p>
<p>But since on x64 it copies x64 executables, it would make sense to copy them in the x64 program files directory. </p>
<p>I could just strip the &#8221; (x86)&#8221; tag, but I&#8217;m pretty sure you would frown upon that. So my question is, what is the way of finding the x64 Program Files directory from a 32-bit application?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2008/12/22/9244582.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346163">
				<div id="div-comment-346163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stewart Tootill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-346163">
			February 16, 2006 at 7:15 am</a>		</div>

		<p>I don&#8217;t know if you&#8217;re the right person to ask, but you&#8217;re the only person I can think of who might even know the answer, and even if you don&#8217;t, maybe you could pass it on to someone who does. If not ignore me.</p>
<p>Anyway, here goes. I&#8217;m writing a socket library and using BindIoCompletionCallback to bind my sockets to the system worker pools IO completion port. When I get my completion callbacks, I&#8217;m getting NTSTATUS error codes instead of WIN32 codes, and yet if I do it the way I used to (using GetQueuedCompletionStatus) I get WIN32 error codes.</p>
<p>The documentation doesn&#8217;t mention this, and I can&#8217;t seem to include ntstatus.h to get the defines.</p>
<p>Does this mean a) I shouldn&#8217;t be doing it this way, or b) there is a bug in windows which I have to work around?</p>
<p>Can I safely define my own constants for the NTSTATUS codes that I care about, or should I avoid this (I suppose that since they are not strictly documented (not in the PSDK anyway) that they could change from release to release but I think (hope:)) that this wouldn&#8217;t happen.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347053">
				<div id="div-comment-347053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-347053">
			February 17, 2006 at 1:40 am</a>		</div>

		<p>Suppose an application wants to receive each character press on a keyboard. &nbsp;For example when F1 is pressed, case WM_KEYDOWN will recognize that F1 is pressed, and then if it cares about shift states it can go look at them. &nbsp;Same for F2. &nbsp;Same for F12. &nbsp;Different for F10. </p>
<p>OK, Microsoft has two Knowledge Base articles explaining why F10 is different, but they don&#8217;t say what to do about it. &nbsp;I guess the answer is WM_SYSKEYDOWN. &nbsp;And then I have to start handling a bunch of keys that really are system keys, that I didn&#8217;t want to bother with. </p>
<p>Do you have any opinion on the correct way to handle it? &nbsp;Also maybe the MSDN page on WM_KEYDOWN should say how an application can handle it? &nbsp;The MSDN page mentions F10 as an exception down in the Remarks section, but the first line describes nonsystem keys with no exceptions which doesn&#8217;t entirely make it obvious. </p>
<p>By the way a colleague was using an application that didn&#8217;t even have a menu bar when he found F10 behaving strangely, so we didn&#8217;t even have any visual feedback that F10 was intentionally intercepted by Windows.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/01/05/9274857.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347603">
				<div id="div-comment-347603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">moby_steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-347603">
			February 18, 2006 at 1:00 am</a>		</div>

		<p>How to do continuous drawing to a window (say for a game) during the idle time of a Move/Size modal loop.<br />
<br />Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347653">
				<div id="div-comment-347653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bav016</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-347653">
			February 18, 2006 at 9:50 am</a>		</div>

		<p>I do not understand how PostQuitMessage and some other functions (like SetTimer with hWnd == NULL) &#8220;know&#8221; about the thread that their messages intended for. InvalidateRect, for example, accepts hWnd as a parameter so WM_PAINT will be posted to the thread that associated with this hWnd. But PostQuitMessage does not accept hWnd or some other parameter that can tell what thread must accept WM_QUIT. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/01/12/9306611.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347733">
				<div id="div-comment-347733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dominicself.co.uk' rel='external nofollow' class='url'>Dominic Self</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-347733">
			February 19, 2006 at 7:31 am</a>		</div>

		<p>Why is screen resolution a global setting in Windows XP rather than being able to be set per user?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/01/19/9339091.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347973">
				<div id="div-comment-347973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-347973">
			February 20, 2006 at 11:52 am</a>		</div>

		<p>I would be interested in your comments on the following:</p>
<p><a href="http://blogs.msdn.com/ie/archive/2006/02/16/533586.aspx#534741" target="_new" rel="nofollow">http://blogs.msdn.com/ie/archive/2006/02/16/533586.aspx#534741</a></p>
<p>Some discussion of cleartype in IE7, and then someone claims that MSDN claims that MS uses a horrible not-thread-safe way of implementing per-application cleartype.</p>
<p>Quoting from the IE7 blog comments:</p>
<p>Saturday, February 18, 2006 10:02 AM by Xepol </p>
<p>Ed -&gt; Regardless of your system settings, IE 7 uses cleartype. &nbsp;To turn it off, you must go to your internet options, go to the advanced tab, scroll down to multimedia and uncheck cleartype. &nbsp; Then close all instances of IE and it should be gone. </p>
<p>Then you can join the rest of us pestering MS to honour the system-wide cleartype setting instead of adding their own app specific setting, rendering the system-wide setting a bad joke (esp. if the trend expands and more apps follow suit). </p>
<p>Sadly, according to the MSDN site, the mechanism to turn on cleartype for just 1 application is not multi-threading friendly as it actually sets the system wide flag while it renders and then sets it back to whatever it was pre-rendering. &nbsp;This means that a context switch while rendering could cause artifacting in other applications. &nbsp;Cleartype settings per applicaiton aren&#8217;t just a bad idea, but can cause undesirable, random artifacting (even if the chances are very low that it could happen, it CAN happen). </p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2006/06/14/630864.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-348683">
				<div id="div-comment-348683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thozie.de' rel='external nofollow' class='url'>Thomas Ziegler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-348683">
			February 22, 2006 at 8:33 am</a>		</div>

		<p>I have a GUI thread and a worker thread producing items very fast and PostMessage()-ing them back to the GUI to be inserted into a tree. Now as the producer is faster as the consumer, the worker hits from time to time ERROR_NOT_ENOUGH_QUOTA errors on PostMessage(). What is the best way to cope with this? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/01/26/9375457.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-349143">
				<div id="div-comment-349143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-349143">
			February 23, 2006 at 4:50 am</a>		</div>

		<p>Not long ago someone asked in a newsgroup: &#8220;Is there a way, programmatically, to set the taskbar to auto-hide and to show the quick launch toolbar?&#8221; </p>
<p>Now, the hiding part was easy (SHAppBarMessage with ABM_SETSTATE). <br />The &#8220;Quick Launch&#8221; part does not seam that easy. <br />I managed to get a IShellFolderBand <br />(with CLSID_QuickLinks and IID_IShellFolderBand), but I am not sure what to do with it or if this is the right thing to begin with. </p>
<p>Thanks, <br />Mihai</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/02/9388941.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-349903">
				<div id="div-comment-349903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">c_e_pizano</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-349903">
			February 24, 2006 at 9:56 pm</a>		</div>

		<p>What is the purpose of they HKLMSoftwareMicrosoftWindowsCurrentVersionApp Paths&lt;some exe&gt;RunAsCommand ?? </p>
<p>Thanks, </p>
<p>CPU </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/09/9407713.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-350223">
				<div id="div-comment-350223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hayden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-350223">
			February 27, 2006 at 5:37 am</a>		</div>

		<p>Anyone who has taken a train in the Mumbai area recently may well recognise the intro tone for platform announcements. It&#8217;s the &#8220;eee-doo&#8221; noise from Outlook. Now &#8211; did the Indian railways steal &nbsp;it from Microsoft, or was the Outlook engineer responsible for this bit Indian?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-350353">
				<div id="div-comment-350353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Francisco Moraes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-350353">
			February 27, 2006 at 2:47 pm</a>		</div>

		<p>Hi, </p>
<p>Is there any API way of retrieving the command line of other processes? It seems that the only possible way of doing this is by retrieving the PEB from the desired process and calling ReadMemory to get the _RTL_USER_PROCESS_PARAMETERS. It seems like WMI could get you the data, but it doesn&#8217;t retrieve the command line for some processes. </p>
<p>This solution works well as long you are not mixing 32-bit and 64-bit applications, where it fails miserably. </p>
<p>Is there a real solution to this that would work no matter if the application is 32-bit and the target process is 64-bit or vice-versa? </p>
<p>Francisco</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/23/9440784.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-350473">
				<div id="div-comment-350473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hayden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-350473">
			February 28, 2006 at 7:17 am</a>		</div>

		<p>To Thomas Ziegler: </p>
<p>Easy. Rather than having the producer madly sending items one at a time &#8211; there are various ways round this. <br />1) Producer sends lists of things. Consumer sends &nbsp;&#8220;Im done&#8221; messages back. Producer sends a single message with a list of all the outsanding items. <br />2) Make it work like async sockets. Producer sends a single message to say &#8220;stuff to do&#8221;. Consumer calls read function to gets items. Producer sends another &#8220;stuff to do&#8221; when the consumer has read all of the items that were notifed last time. <br />3) Use a semaphore. Add one in the producer when the producer has a pending list of items. producer sets count to 0 when there is nothing. The consumer should loop reading items until the semaphore becomes 0. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/01/26/9375457.aspx" rel="nofollow">See also</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351223">
				<div id="div-comment-351223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-351223">
			March 2, 2006 at 1:51 pm</a>		</div>

		<p>Appologies but I can&#8217;t resist sending this to Raymond. &nbsp;Prehaps the link is doing the rounds at MS? &nbsp; <br />This is a parody video that asks &#8220;What if Microsoft had designed the iPod packaging?&#8221; </p>
<p><a href="http://video.google.com/videoplay?docid=4313772690011721857&amp;q=ipod+microsoft" rel=nofollow target=_new rel="nofollow">http://video.google.com/videoplay?docid=4313772690011721857&#038;q=ipod+microsoft</a></p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/03/02/9453317.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351563">
				<div id="div-comment-351563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Quirk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-351563">
			March 3, 2006 at 5:18 pm</a>		</div>

		<p>Why does MoveWindow() not send WM_GEMINMAXINFO?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/03/09/9466834.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351783">
				<div id="div-comment-351783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Quirk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-351783">
			March 6, 2006 at 11:52 am</a>		</div>

		<p>I meant WM_GETMINMAXINFO. </p>
<p>Also, why is there a repaint parameter for MoveWindow()? &nbsp;Shouldn&#8217;t the OS be able to figure out if the window needs to be repainted? </p>
<p>You know, MoveWindow() is just a weird function. I guess it&#8217;s easier to call than SetWindowPos(), but that&#8217;s the only thing it seems to have going for it.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/03/23/9500125.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353553">
				<div id="div-comment-353553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Filteau</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-353553">
			March 10, 2006 at 8:57 am</a>		</div>

		<p>Could you explain the implementation of WM_PRINTCLIENT ? </p>
<p>It seems that even MS got it wrong in the LISTBOX control. </p>
<p>Try to AnimateWindow a window that as a LISTBOX control as a child. &nbsp;The LISTBOX displays correctly if it is NOT empty. &nbsp;However, if it is empty&#8230; &nbsp;nothing is drawn. </p>
<p>I got a similar problem when embedding an Internet Explorer control. </p>
<p>Thanks. </p>
<p>-mf </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/03/30/9517659.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353843">
				<div id="div-comment-353843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/fbouma' rel='external nofollow' class='url'>Frans Bouma</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-353843">
			March 11, 2006 at 5:38 am</a>		</div>

		<p>Why is the text of a treenode chopped off when you switch the font from normal to bold? <br /><a href="http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_frm/thread/79297a46ef22f520/a51c76da39b1437a?lnk=st&amp;q=TreeNode+font+bold+chopped+off&amp;rnum=2#a51c76da39b1437a" rel=nofollow target=_new rel="nofollow">http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_frm/thread/79297a46ef22f520/a51c76da39b1437a?lnk=st&#038;q=TreeNode+font+bold+chopped+off&#038;rnum=2#a51c76da39b1437a</a> </p>
<p>It apparently is for backwards compatibility but I fail to see why this is necessary for backward compatibility&#8230; </p>
<p>(the reason I ask this is because .NET (not what you want to cover, but it&#8217;s related) winforms uses the win32 controls underneath and &nbsp;therefore run into this issue. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/04/06/9532674.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353983">
				<div id="div-comment-353983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Serge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-353983">
			March 13, 2006 at 4:15 am</a>		</div>

		<p>How it was accepted by QA that Windows Installer writes &#8220;Time remaining: 0 seconds&#8221; and crunches hdd for additional ten minutes? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-354013">
				<div id="div-comment-354013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tuniverse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-354013">
			March 13, 2006 at 7:33 am</a>		</div>

		<p>Aloha Raymond &#8212;</p>
<p>Can you discuss why WM_NCPAINT doesn&#8217;t always get called when a window changes its activation state and the NC area is repainted (so says Spy++)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tzagotta even thread-even depth-1" id="comment-354033">
				<div id="div-comment-354033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tzagotta</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-354033">
			March 13, 2006 at 8:11 am</a>		</div>

		<p>Hi Raymond,</p>
<p>Here&#8217;s a question that seems to come up a lot, and generates a lot of controversy: If I have a lot of RAM, can I disable then WinXP pagefile (virtual memory) to improve performance?</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-354093">
				<div id="div-comment-354093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mailto:nekto2@gmail.com' rel='external nofollow' class='url'>Nekto2</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-354093">
			March 13, 2006 at 10:33 am</a>		</div>

		<p>Why there is no mouse action &#8220;both buttons click&#8221; or &#8220;move mouse with both buttons pressed&#8221; ? :) Only one button at a time is used for UI. Only Opera used combination of &#8220;LeftMB then RightMB = &nbsp;go forward, RightMB then LeftMB = go Back&#8221; </p>
<p>Is there some reason or just none try to? :) </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/04/13/9546604.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-355453">
				<div id="div-comment-355453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-355453">
			March 16, 2006 at 10:11 am</a>		</div>

		<p>Why, when I destroy the window with the focus when I get a WM_ACTIVATEAPP (with fActivate set to 0, so it&#8217;s a deactivate message), do I not get any WM_ACTIVATEAPP message at all when my program gets reactivated? &nbsp;(According to Spy++, anyway.) </p>
<p>If I subsequently switch away from the program, I do get a deactivate message, and at as long as I don&#8217;t destroy a window, I get all subsequent activate messages. </p>
<p>Is it illegal (or undefined) to destroy a window inside the WM_ACTIVATEAPP handler (like the &#8220;don&#8217;t set focus inside WM_KILLFOCUS&#8221; thing)? &nbsp;Is there something else going on here inside the window manager? </p>
<p>Thanks for any insight!</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/04/20/9556039.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-355753">
				<div id="div-comment-355753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mailto:enf@pobox.com' rel='external nofollow' class='url'>Eric Fischer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-355753">
			March 16, 2006 at 2:46 pm</a>		</div>

		<p>In your article &quot;Why is the line terminator CR+LF?&quot; (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2004/03/18/91899.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/03/18/91899.aspx</a>) you say that &quot;the implicit CR before LF is a unix invention, probably as an economy, since it saves one byte per line.&quot; &nbsp;The full history is much more complicated. &nbsp;I would comment there but comments are closed so I will post here instead.</p>
<p>Early in the development of ASCII the demand for control characters came almost entirely from the telegraph industry. &nbsp;American computer industry representatives intended to continue to store text in fixed-size records of 6-bit bytes, padded at the end with spaces. &nbsp;European computer industry representatives did see a demand for a few control characters and intended to replace the first several printing characters (!, &quot;, #, $, %, &amp;, &#8216;) in their 6-bit set with the block of core control characters (HT, LF, VT, FF, CR, SO, SI) from the 7-bit set. &nbsp;The Europeans would have preferred a single NL character to the CR+LF pair, but the telegraph interests insisted on the separation. &nbsp;The compromise was to include CR and LF separately but with a footnote that LF could be used standalone as NL if sender and recipient agreed. &nbsp;LF was chosen for this role instead of CR because if the sender doesn&#8217;t know about NL but the recipient does, CR+(CR+LF) has the same net effect as CR+LF but (CR+LF)+LF skips an extra line.</p>
<p>However, publication of the ISO standard was delayed for several years while additional issues (lower case, most significantly) were hammered out. &nbsp;The American standard was published right away, and did not mention the NL compromise because neither American computer interests nor American communications interests cared about it. &nbsp;So when American computers, contrary to expectations, did begin to use control characters, there was no reference for how they were intended to be used in computers and the makers had to guess. &nbsp;DEC in particular adopted bare CR as line terminator. &nbsp;Multics developers, on the other hand, had an insider&#8217;s view into the standardization process and knew that the ISO standard and the 1968 US standard would permit bare LF as NL, so that was what they adopted. &nbsp;Multics conventions were carried forward into Unix and from Unix into C.</p>
<p>You mention a 1996 revision of ASCII that allows the NL interpretation. &nbsp;I think you are actually thinking of the 1986 revision, which deprecated the interpretation. &nbsp;The published US standards are 1963 (CR+LF only), 1967 (CR+LF only), 1968 (CR+LF or LF by convention), 1977 (CR+LF or LF by convention), 1986 (CR+LF, LF deprecated).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-355843">
				<div id="div-comment-355843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/kdente' rel='external nofollow' class='url'>Kevin Dente</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-355843">
			March 16, 2006 at 6:15 pm</a>		</div>

		<p>Is it possible to put a folder on the Start Menu Pin list and have it cascade?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/04/27/9570300.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-356413">
				<div id="div-comment-356413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-356413">
			March 20, 2006 at 10:53 am</a>		</div>

		<p>I have a request: </p>
<p>In Windows XP, MS added a &#8220;system tray&#8221; icon for new hardware detection. &nbsp;What is the purpose of this icon? </p>
<p>Furthermore, why doesn&#8217;t this icon work like a &#8220;normal&#8221; system try icon? <br />&#8211; It doesn&#8217;t have any tooltips. <br />&#8211; Clicking on it doesn&#8217;t do anything. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/05/04/9585032.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-357243">
				<div id="div-comment-357243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.yahoo.com' rel='external nofollow' class='url'>Aggravated</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-357243">
			March 21, 2006 at 2:19 pm</a>		</div>

		<p>Situation: <br />A developer uses his laptop&#8217;s screen in conjunction with another monitor through a docking station. <br />When the developer then goes to use the laptop by itself, applications he closed on the second monitor are now orphaned and cannot be used until he re-docks the computer and moves the window back to the primary monitor. </p>
<p>Can&#8217;t this be fixed? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/05/11/9601136.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-357363">
				<div id="div-comment-357363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skeets Norquist</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-357363">
			March 21, 2006 at 5:04 pm</a>		</div>

		<p>When subclassing a window how do you determine if the original wndproc handled the message? &nbsp;CallWindowProc() always seems to return an LRESULT of 0.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/05/18/9624611.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-366713">
				<div id="div-comment-366713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.agi.com' rel='external nofollow' class='url'>Kevin Eshbach</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-366713">
			April 5, 2006 at 6:11 pm</a>		</div>

		<p>Can you do an post on why you cannot programatically change the text centering style of an edit control from say ES_LEFT to ES_RIGHT (or ES_CENTER, etc.) after the edit control has been created?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/05/25/9639553.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-368123">
				<div id="div-comment-368123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fredrik Hesse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-368123">
			April 10, 2006 at 4:35 am</a>		</div>

		<p>Ok, here&#8217;s a little peculiarity that would be interesting to hear the rationalization behind. <br />When I log on to the domain (on my Windows XP) I get prompted to change password because my current one will expire in a couple of days, so I change the password. <br />Later I lock my computer, when I return I can still use my old password to unlock the computer (as many times as I want) UNTIL I once use my new password to unlock the computer, after that I can no longer use my old one to unlock it. <br />I guess this is due to the password cache:ing, but why isn&#8217;t the cache updated when I change my password?? </p>
<div class=post>[<i><a href="http://technet.microsoft.com/en-us/magazine/2009.07.windowsconfidential.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-369033">
				<div id="div-comment-369033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hayden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-369033">
			April 12, 2006 at 9:14 am</a>		</div>

		<p>Under good ol&#8217; Win3.1, File Manager could be set to ask for confirmation on file move/copy/delete. With Windows Explorer, I have several times ( more than 0 times, and that&#8217;s enough) suffered a &quot;finger spasm&quot; as I move the mouse over a file tree, and relocated a chunk of drive contents elsewhere. Really bad stuff happens if its Program Files&#8230;..<br />
<br />Why wasn&#8217;t the ability to request confirmation added to Explorer?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-371073">
				<div id="div-comment-371073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ritchie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-371073">
			April 18, 2006 at 10:53 am</a>		</div>

		<p>I&#8217;ve got a question about CreateProcess(). In the MSDN documentation (<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/createprocess.asp" rel=nofollow target=_new rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/createprocess.asp</a>) , it states that the parameter lpCommandLine should not be const, as the Unicode version CreateProcessW can modify the contents of the buffer. Furthermore, it says that attempting to call CreateProcess() when lpCommandLine is const might cause an access violation on Windows 2000, XP and 2003 Server. I was wondering if there was a particular design or backwards compatibility decision made at some point that introduced this behaviour? It seems a bit strange that only the Unicode version of the function is affected. It&#8217;s not causing me any problems, I&#8217;m just curious to how this came about.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/06/01/9673254.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-371513">
				<div id="div-comment-371513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Trey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-371513">
			April 19, 2006 at 12:32 pm</a>		</div>

		<p>In general if you have a function and you<br />
<br />would like to have that function execute<br />
<br />only on a specific frequency what is the best<br />
<br />way under Windows to do this?</p>
<p>One example is that I have an Update() function<br />
<br />that communicats with a peripherial device<br />
<br />through USB. The device does not need to have<br />
<br />Update called more frequently than 100ms.</p>
<p>Since I writing the library other programmers<br />
<br />are going to use I have no control on how<br />
<br />frequently they will call Update. It seems to<br />
<br />me the easist thing is for me to throttle<br />
<br />the frequency of how often Update in the<br />
<br />library and that way I can enforce how<br />
<br />frequently Update actually executes, and<br />
<br />the programmers that use the library don&#8217;t have<br />
<br />to worry about calling the function too often.</p>
<p>It is a forgone conclusion that infrequent<br />
<br />calls are not a problem.</p>
<p>To me there seems to be 3 ways one might<br />
<br />accomplish this.</p>
<p>1. Wrap Update with timeGetTime calls and see<br />
<br /> &nbsp; how much time has passed. If deltaTime &gt;100<br />
<br /> &nbsp; then you execute the code in Update.</p>
<p>2. Calculate the frequency of the processor<br />
<br /> &nbsp; and use RDTSC to get the time delta. I would<br />
<br /> &nbsp; think this might be faster than using<br />
<br /> &nbsp; timeGetTime, but getting the freq of the<br />
<br /> &nbsp; processor can be difficult with current<br />
<br /> &nbsp; power saving modes that can alter the<br />
<br /> &nbsp; freq of the processor.</p>
<p>3. You could just Sleep(100) and that way you<br />
<br /> &nbsp; are guarnteed that you will always be called<br />
<br /> &nbsp; with the right freq, but this is just wrong.<br />
<br /> &nbsp; I think you should always return as quickly<br />
<br /> &nbsp; as possible from a function call.</p>
<p>I am open to all ideas, critisims, etc.</p>
<p>Thanks,</p>
<p>Trey</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-373663">
				<div id="div-comment-373663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-373663">
			April 26, 2006 at 3:21 pm</a>		</div>

		<p>My life&#8217;s been pretty dull recently. Shrug. My mind is like a void. I haven&#8217;t gotten anything done lately. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-374643">
				<div id="div-comment-374643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-374643">
			April 28, 2006 at 11:17 am</a>		</div>

		<p>Not much on my mind right now, but it&#8217;s not important. I&#8217;ve just been letting everything happen without me. I just don&#8217;t have anything to say right now.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375173">
				<div id="div-comment-375173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://wendyhome.com' rel='external nofollow' class='url'>::Wendy::</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-375173">
			April 29, 2006 at 1:27 pm</a>		</div>

		<p>For example &#8220;Security Center&#8221; rather than &#8220;Security Centre&#8221;. &nbsp;Surely a larger proportion of potential Windows customers use the spellings established prior to the US language was formalised? &nbsp;My UK friends and family persistently complain about US linguistic imperialism through hollywood films (slang, &nbsp;phraseology) and software most notably microsoft products. &nbsp;I&#8217;m guessing its just CHEAPER to employ local (no Visa required) US writers and then not bother to &#8216;translate&#8217; into one or multiple other versions of English.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/06/08/9705183.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375413">
				<div id="div-comment-375413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-375413">
			April 30, 2006 at 5:36 pm</a>		</div>

		<p>I haven&#8217;t been up to much today. I&#8217;ve just been letting everything happen without me. Basically nothing seems worth bothering with. I&#8217;ve just been hanging out doing nothing. I just don&#8217;t have anything to say right now. More or less nothing happening.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375613">
				<div id="div-comment-375613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jen Kilmer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-375613">
			May 1, 2006 at 1:46 pm</a>		</div>

		<p>Have you talked about using mimicing Eliza to &quot;help&quot; others debug issues?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375643">
				<div id="div-comment-375643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-375643">
			May 1, 2006 at 2:18 pm</a>		</div>

		<p>Not much on my mind lately. My life&#8217;s been completely boring these days. I&#8217;ve just been hanging out not getting anything done. So it goes.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375803">
				<div id="div-comment-375803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Oscar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-375803">
			May 1, 2006 at 6:40 pm</a>		</div>

		<p>Raymond, </p>
<p>Do you have any idea why an application hosting iwebbrowser2 does not necessarily use the JVM specified in IEs options? </p>
<p>For instance, on a system that has the MS-JVM installed, if you look at: </p>
<p><a href="http://www.javatester.org/version.html" rel=nofollow target=_new rel="nofollow">http://www.javatester.org/version.html</a> </p>
<p>with IE it says its using Sun&#8217;s JVM </p>
<p>However, if you look at it with an iwebbrowser2 hosted app, it reverts to the <br />older MS-JVM &#8211; even tho the options have Sun&#8217;s VM checked. </p>
<p>If the MS-JVM is not installed, both browsers report they are using the Sun JVM. Even more freakish, if you rename the iwebbrowser2 hosted app IExplore.exe it works correctly. </p>
<p>Pretty odd eh? </p>
<p>Thanks! </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375983">
				<div id="div-comment-375983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-375983">
			May 2, 2006 at 8:59 am</a>		</div>

		<p>I haven&#8217;t been up to much lately. I&#8217;ve basically been doing nothing , but it&#8217;s not important. I can&#8217;t be bothered with anything recently. I&#8217;ve just been letting everything happen without me lately.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-376283">
				<div id="div-comment-376283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bruno</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-376283">
			May 2, 2006 at 5:52 pm</a>		</div>

		<p>Being a command prompt enthusiast (I like to type more than I like using the mouse) I keep wondering why the DOS Command Prompt is so ugly and limited. Even in Vista it&#8217;s still ugly. </p>
<p>Why doesn&#8217;t the Command Prompt allow you to at least change the font to something other than Lucida Console and Raster Fonts? </p>
<p>Thanks, <br />Bruno. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/05/16/2659903.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-376333">
				<div id="div-comment-376333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-376333">
			May 2, 2006 at 10:50 pm</a>		</div>

		<p>I haven&#8217;t been up to anything recently, but so it goes. Such is life. What can I say? Pretty much not much exciting going on to speak of. I haven&#8217;t gotten much done lately, but I don&#8217;t care.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-376663">
				<div id="div-comment-376663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-376663">
			May 4, 2006 at 2:47 am</a>		</div>

		<p>I haven&#8217;t gotten anything done recently. I&#8217;ve just been hanging out doing nothing. I haven&#8217;t been up to anything these days, but it&#8217;s not important. Today was a total loss.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-377393">
				<div id="div-comment-377393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-377393">
			May 4, 2006 at 9:15 pm</a>		</div>

		<p>I haven&#8217;t been up to much today. I&#8217;ve just been letting everything happen without me. Basically nothing seems worth bothering with. I&#8217;ve just been hanging out doing nothing. I just don&#8217;t have anything to say right now. More or less nothing happening.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-377703">
				<div id="div-comment-377703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-377703">
			May 6, 2006 at 12:57 am</a>		</div>

		<p>I can&#8217;t be bothered with anything these days, but shrug. I just don&#8217;t have anything to say recently. I haven&#8217;t gotten much done recently. Nothing seems worth thinking about.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-377813">
				<div id="div-comment-377813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-377813">
			May 6, 2006 at 4:45 pm</a>		</div>

		<p>I just don&#8217;t have much to say recently. Such is life. I&#8217;ve basically been doing nothing. Basically nothing seems worth bothering with. Oh well.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-377823">
				<div id="div-comment-377823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-377823">
			May 6, 2006 at 5:37 pm</a>		</div>

		<p>I&#8217;ve just been staying at home not getting anything done. I&#8217;ve basically been doing nothing worth mentioning. My life&#8217;s been pretty unremarkable these days. Eh.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-377893">
				<div id="div-comment-377893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-377893">
			May 7, 2006 at 3:55 pm</a>		</div>

		<p>Not much on my mind lately. My life&#8217;s been completely boring these days. I&#8217;ve just been hanging out not getting anything done. So it goes.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-378433">
				<div id="div-comment-378433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-378433">
			May 9, 2006 at 9:12 am</a>		</div>

		<p>I just don&#8217;t have much to say recently. Such is life. I&#8217;ve basically been doing nothing. Basically nothing seems worth bothering with. Oh well.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-378803">
				<div id="div-comment-378803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-378803">
			May 9, 2006 at 5:02 pm</a>		</div>

		<p>Basically nothing noteworthy happening right now, but eh. Today was a complete loss. I haven&#8217;t been up to much recently. I&#8217;ve pretty much been doing nothing worth mentioning.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-379863">
				<div id="div-comment-379863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-379863">
			May 11, 2006 at 2:50 pm</a>		</div>

		<p>[Test] Just trying to post here since I couldn&#8217;t post in the MI3 post</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-379943">
				<div id="div-comment-379943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-379943">
			May 11, 2006 at 11:40 pm</a>		</div>

		<p>I haven&#8217;t been up to anything today. I can&#8217;t be bothered with anything recently. Nothing seems worth thinking about. I haven&#8217;t gotten anything done recently, but oh well. Not much noteworthy going on worth mentioning.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-380023">
				<div id="div-comment-380023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Buschbeck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-380023">
			May 12, 2006 at 8:30 am</a>		</div>

		<p>I&#8217;ve set my Recycle Bin to use 5% of my harddisk capacity, which translates to something about 3 GB of data. &nbsp;I rarely empty the Bin (it gives me a sense of security that I can simply delete anything and give that decision the test of time before the deleted file expires eventually), and so it currently contains about 2,300 files and folders.</p>
<p>However, the first time I move something to the Bin (even just the tiniest Start menu item some reckless installer has sullied my Start menu with) or open the Bin, it takes ages to complete the deletion or open the Explorer window with the Bin&#8217;s contents, all the while my poor notebook&#8217;s harddisk thrashes around like crazy.</p>
<p>Joel Spolksy suspects that there&#8217;s a &quot;Shlemiel the painter&#8217;s algorithm&quot; hidden somewhere in the Recycle Bin&#8217;s code [1]. Can you shed some light on why the Bin is behaving that way?</p>
<p>Thanks,<br />
<br />Michael</p>
<p>[1] <a rel="nofollow" target="_new" href="http://www.joelonsoftware.com/articles/fog0000000319.html" rel="nofollow">http://www.joelonsoftware.com/articles/fog0000000319.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-380543">
				<div id="div-comment-380543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-380543">
			May 13, 2006 at 10:34 am</a>		</div>

		<p>Pretty much nothing seems worth thinking about. My life&#8217;s been completely dull , not that it matters. I&#8217;ve just been staying at home waiting for something to happen.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-380983">
				<div id="div-comment-380983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-380983">
			May 15, 2006 at 9:41 pm</a>		</div>

		<p>I just don&#8217;t have much to say recently. Such is life. I&#8217;ve basically been doing nothing. Basically nothing seems worth bothering with. Oh well.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-381203">
				<div id="div-comment-381203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-381203">
			May 16, 2006 at 1:12 pm</a>		</div>

		<p>Why is it some file APIs (like SetFileTime) take a handle to an open file whereas other APIs (like SetFileAttributes) take a path to the file. &nbsp;I would expect the APIs to be consistent. &nbsp;Ideally I would like two set of APIs, one for handles and one for paths, put maximum flexibility into the hands of the programmer. </p>
<p>P.S. &nbsp;Awesome blog! &nbsp;Keep up the great work. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/06/15/9751659.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-381923">
				<div id="div-comment-381923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-381923">
			May 18, 2006 at 12:10 am</a>		</div>

		<p>My life&#8217;s been pretty dull recently. Shrug. My mind is like a void. I haven&#8217;t gotten anything done lately. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-381983">
				<div id="div-comment-381983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-381983">
			May 18, 2006 at 5:16 am</a>		</div>

		<p>I just don&#8217;t have anything to say , but shrug. So it goes. Not much on my mind recently. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-382223">
				<div id="div-comment-382223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://drv.nu/' rel='external nofollow' class='url'>Daniel</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382223">
			May 18, 2006 at 5:25 pm</a>		</div>

		<p>Why does a flashing taskbar button cause fullscreen DOS apps (and fullscreen cmd.exe) to lose focus? &nbsp;This is very annoying when using full-screen grahpical DOS software. &nbsp;Is there any way to turn it off (or any reasoning for making it work this way)? </p>
<p>Code to reproduce: </p>
<p>Add the following code to WM_KEYDOWN or similar of a Win32 GUI app: </p>
<p>Sleep(1000); <br />FlashWindow(hWnd, TRUE); <br />Sleep(500); <br />FlashWindow(hWnd, FALSE); </p>
<p>Run cmd.exe, run the Windows app and activate the FlashWindow sequence, and hit Alt-Enter on the cmd window to enter full-screen mode. &nbsp;As soon as the first Sleep expires, the GUI app&#8217;s taskbar button will be highlighted and the cmd window will be sent back to non-fullscreen mode. &nbsp;This is not so bad for text-mode DOS apps, but graphical apps get minimized. </p>
<p>This brings me to a separate, tangential question. &nbsp;What happened to the support for running DOS apps in windowed mode from Windows 95? &nbsp;It seems like this could be done with a VDD (or inside the VDM) by hooking the standard VGA framebuffer areas and the VGA registers. &nbsp;It certainly wouldn&#8217;t be trivial, but apparently it was done in Win95&#8230; &nbsp;Perhaps this has to do with the differences in the architectures of Win9x and NT? </p>
<p>If I remember correctly, running in windowed mode only worked with programs that used standard modes (set through int 0x10) and didn&#8217;t do sneaky things with the VGA registers. &nbsp;It was pretty slow, but my memories of Windows 95 involve a 486, so perhaps things would be better on today&#8217;s hardware. &nbsp;Plus, it was a great way to get screenshots without some shady TSR. :)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/06/22/9796531.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-382313">
				<div id="div-comment-382313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382313">
			May 18, 2006 at 11:06 pm</a>		</div>

		<p>Basically nothing noteworthy happening right now, but eh. Today was a complete loss. I haven&#8217;t been up to much recently. I&#8217;ve pretty much been doing nothing worth mentioning.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-382323">
				<div id="div-comment-382323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WendyHome</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382323">
			May 18, 2006 at 11:16 pm</a>		</div>

		<p>use exactly 30 words, &nbsp;no syllable requirement.</p>
<p>No more than 4 full stops (periods), 4 comma&#8217;s, and two pairs of brackets.</p>
<p>If i give this description to a 12 year old that has never seen a raw carrot, &nbsp;they should not respond by<br />
<br />a) crying<br />
<br />b) swearing and becoming abusive<br />
<br />d) any variation of &#8216;huh what?&#8217;</p>
<p>just a suggestion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-382583">
				<div id="div-comment-382583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lahosken.san-francisco.ca.us/' rel='external nofollow' class='url'>Larry Hosken</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382583">
			May 20, 2006 at 1:17 am</a>		</div>

		<p>As near as I can tell, a bunch of students in Sweden run a big puzzle hunt, and it&#8217;s called Rebusrally. &nbsp;They solve puzzles and zip around in vans. &nbsp;I say &quot;As near as I can tell&quot; because, unlike some people, I can&#8217;t understand Swedish. Who can bridge the gap of understanding here? &nbsp;Who can deliver a report on the activities of these exotic forign puzzlers based upon a loose translation of some of their web pages? &nbsp;Raymond, America&#8217;s Puzzle Huntists look to you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-382593">
				<div id="div-comment-382593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382593">
			May 20, 2006 at 9:05 am</a>		</div>

		<p>My life&#8217;s been basically bland today. More or less nothing seems worth thinking about. My mind is like an empty room. I&#8217;ve more or less been doing nothing to speak of. Not much on my mind recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-382683">
				<div id="div-comment-382683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382683">
			May 20, 2006 at 6:03 pm</a>		</div>

		<p>I haven&#8217;t been up to much these days. Today was a loss. Nothing seems important. I&#8217;ve just been letting everything happen without me these days.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-382703">
				<div id="div-comment-382703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382703">
			May 21, 2006 at 4:28 am</a>		</div>

		<p>My mind is like a bunch of nothing, but I guess it doesn&#8217;t bother me. I haven&#8217;t been up to anything recently. I&#8217;ve pretty much been doing nothing to speak of.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-382783">
				<div id="div-comment-382783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-382783">
			May 22, 2006 at 5:37 am</a>		</div>

		<p>I haven&#8217;t been up to anything recently, but so it goes. Such is life. What can I say? Pretty much not much exciting going on to speak of. I haven&#8217;t gotten much done lately, but I don&#8217;t care.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-383263">
				<div id="div-comment-383263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-383263">
			May 23, 2006 at 6:15 am</a>		</div>

		<p>xcc</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-383753">
				<div id="div-comment-383753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-383753">
			May 23, 2006 at 2:43 pm</a>		</div>

		<p>I&#8217;ve just been staying at home waiting for something to happen. Whatever. Not much on my mind lately. I guess it doesn&#8217;t bother me.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384053">
				<div id="div-comment-384053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://matthew.chaboud.com' rel='external nofollow' class='url'>Matthew Chaboud</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-384053">
			May 23, 2006 at 9:16 pm</a>		</div>

		<blockquote><p>
  {?I&#8217;m trying to figure out how to reserve the virtual address space below 4GB that isn&#8217;t already allocated (the loaded exe, loaded dlls, and allocations already in place are fine where they are, but I&#8217;m sure I could re-base them). </p>
<p>I can (and already have) used VirtualAlloc in combination with HeapAlloc (to take up the pre-reserved heap) to block off everything up to 4GB in virtual address space, but it seems like there should be a cleaner way to do this. </p>
<p>If you want the code to do what I&#8217;ve already done, just email me. </p>
<p>Thanks for the great resource, <br />Matt </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/06/29/9807826.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-384573">
				<div id="div-comment-384573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-384573">
			May 24, 2006 at 6:51 pm</a>		</div>

		<p>I haven&#8217;t been up to anything these days. So it goes. I can&#8217;t be bothered with anything these days.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384653">
				<div id="div-comment-384653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-384653">
			May 24, 2006 at 11:15 pm</a>		</div>

		<p>I haven&#8217;t gotten anything done today. I feel like a fog, but what can I say? I&#8217;ve just been letting everything wash over me lately, not that it matters. Shrug.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-385083">
				<div id="div-comment-385083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-385083">
			May 25, 2006 at 9:13 pm</a>		</div>

		<p>My life&#8217;s been basically bland today. More or less nothing seems worth thinking about. My mind is like an empty room. I&#8217;ve more or less been doing nothing to speak of. Not much on my mind recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-385143">
				<div id="div-comment-385143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-385143">
			May 26, 2006 at 12:29 am</a>		</div>

		<p>Not much on my mind these days, but what can I say? It&#8217;s not important. I just don&#8217;t have much to say lately. I&#8217;ve just been letting everything pass me by recently, but eh.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-385443">
				<div id="div-comment-385443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Herb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-385443">
			May 26, 2006 at 1:51 pm</a>		</div>

		<p>A newly installed piece of s/w comes with a FAQ, an item of which reads (names changed to protenct myself): </p>
<p>Question 5: Will AmazingWare&#8217;s performance be enhanced when running on a 64-bit operating system like Windows XP x64 Edition? </p>
<p>Answer: Yes. While AmazingWare is a 32-bit application, it will use all of your system&#8217;s available physical memory (above the 32-bit Windows limit of 4GB) for storing model data when running under 64-bit operating systems. This can enhance AmazingWare&#8217;s performance particularly when working on large models if you have more than 4G of physical memory on your 64-bit workstation. </p>
<p>&#8212;&#8211; </p>
<p>How&#8217;s this possible?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/07/06/9818299.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-385653">
				<div id="div-comment-385653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-385653">
			May 27, 2006 at 1:05 am</a>		</div>

		<p>Basically nothing seems worth thinking about. I haven&#8217;t been up to much these days. I just don&#8217;t have much to say right now. I can&#8217;t be bothered with anything , but whatever.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-385673">
				<div id="div-comment-385673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-385673">
			May 27, 2006 at 6:12 am</a>		</div>

		<p>I feel like a complete blank, but I don&#8217;t care. Pfft. I&#8217;ve pretty much been doing nothing worth mentioning.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386103">
				<div id="div-comment-386103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-386103">
			May 29, 2006 at 7:15 pm</a>		</div>

		<p>I just don&#8217;t have anything to say , but shrug. So it goes. Not much on my mind recently. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-386173">
				<div id="div-comment-386173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sigbus.net/' rel='external nofollow' class='url'>nolan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-386173">
			May 30, 2006 at 12:58 am</a>		</div>

		<p>Perhaps this is slightly outside your usual domain, but back in the win95 days, there was a winsock bug that caused a blue-screen whenever you attempted to resolve a FQDN that was exactly 13 characters (including periods) that didn&#8217;t exist. &nbsp;Any other length worked fine, and if the host existed in the DNS it worked fine as well. </p>
<p>So for the past 10 years or so, I&#8217;ve been wondering exactly how one could write code with that bug. &nbsp;Please elighten us! &nbsp;Any bug that weird has to have a great story behind it. </p>
<p>See: <br /><a href="http://attrition.org/security/denial/w/winsk20.dos.html" rel=nofollow target=_new rel="nofollow">http://attrition.org/security/denial/w/winsk20.dos.html</a> <br />for the advisory.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/07/13/9830732.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386603">
				<div id="div-comment-386603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-386603">
			May 31, 2006 at 12:20 am</a>		</div>

		<p>I just don&#8217;t have much to say recently. Such is life. I&#8217;ve basically been doing nothing. Basically nothing seems worth bothering with. Oh well.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-386653">
				<div id="div-comment-386653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-386653">
			May 31, 2006 at 4:52 am</a>		</div>

		<p>Not much on my mind these days, but what can I say? It&#8217;s not important. I just don&#8217;t have much to say lately. I&#8217;ve just been letting everything pass me by recently, but eh.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386913">
				<div id="div-comment-386913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-386913">
			May 31, 2006 at 6:25 pm</a>		</div>

		<p>My life&#8217;s been pretty dull recently. Shrug. My mind is like a void. I haven&#8217;t gotten anything done lately. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-387343">
				<div id="div-comment-387343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387343">
			June 2, 2006 at 3:52 am</a>		</div>

		<p>I feel like a complete blank, but I don&#8217;t care. Pfft. I&#8217;ve pretty much been doing nothing worth mentioning.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-387523">
				<div id="div-comment-387523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387523">
			June 2, 2006 at 3:17 pm</a>		</div>

		<p>I can&#8217;t be bothered with anything these days, but such is life. I don&#8217;t care. So it goes. More or less nothing seems worth thinking about. I&#8217;ve just been hanging out waiting for something to happen, but that&#8217;s how it is.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-387573">
				<div id="div-comment-387573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ngiap.com/blogs/stevenyong' rel='external nofollow' class='url'>steven</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387573">
			June 2, 2006 at 9:08 pm</a>		</div>

		<p>I&#8217;m a regular reader of The Old New Thing. I wonder is there any reason why in most cases does Windows have to be restarted after software installation while Linux doesn&#8217;t have to? May you blog something about this?</p>
<div class=post>[<i><a href="http://technet.microsoft.com/en-us/magazine/2008.11.windowsconfidential.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-387643">
				<div id="div-comment-387643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387643">
			June 3, 2006 at 12:44 pm</a>		</div>

		<p>I haven&#8217;t been up to anything these days. So it goes. I can&#8217;t be bothered with anything these days.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-387713">
				<div id="div-comment-387713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387713">
			June 4, 2006 at 10:59 am</a>		</div>

		<p>I haven&#8217;t gotten anything done today. I feel like a fog, but what can I say? I&#8217;ve just been letting everything wash over me lately, not that it matters. Shrug.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-387723">
				<div id="div-comment-387723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387723">
			June 4, 2006 at 4:28 pm</a>		</div>

		<p>I just don&#8217;t have much to say these days, but so it goes. Today was a total loss. I guess it doesn&#8217;t bother me.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-387803">
				<div id="div-comment-387803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-387803">
			June 5, 2006 at 6:49 am</a>		</div>

		<p>I can&#8217;t be bothered with anything these days, but such is life. I don&#8217;t care. So it goes. More or less nothing seems worth thinking about. I&#8217;ve just been hanging out waiting for something to happen, but that&#8217;s how it is.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-388093">
				<div id="div-comment-388093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-388093">
			June 5, 2006 at 9:21 pm</a>		</div>

		<p>Not much on my mind. I don&#8217;t care. I&#8217;ve just been letting everything happen without me , but shrug. Whatever. I feel like a void.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-388103">
				<div id="div-comment-388103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-388103">
			June 5, 2006 at 11:19 pm</a>		</div>

		<p>I haven&#8217;t gotten anything done today. I feel like a fog, but what can I say? I&#8217;ve just been letting everything wash over me lately, not that it matters. Shrug.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-388373">
				<div id="div-comment-388373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-388373">
			June 6, 2006 at 3:15 pm</a>		</div>

		<p>I can&#8217;t be bothered with anything these days, but shrug. I just don&#8217;t have anything to say recently. I haven&#8217;t gotten much done recently. Nothing seems worth thinking about.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-388443">
				<div id="div-comment-388443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-388443">
			June 6, 2006 at 6:08 pm</a>		</div>

		<p>I learned windows back in the 16-bit days. &nbsp; <br />When switching to Win32, as everyone knows MoveTo was gone and replaced with MoveToEx. &nbsp;Everyone had to either change code or use a macro. </p>
<p>Delete a function from the API? How could this happen? &nbsp;Did someone want to force me to save the previous pen position? Was a code review skipped :D </p>
<p>I tried to google an answer for this, but it&#8217;s hard to find anythign &#8212; and of course it&#8217;s water under the bridges now. &nbsp;But it stills bugs me. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/07/20/9840597.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-388653">
				<div id="div-comment-388653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-388653">
			June 7, 2006 at 3:29 am</a>		</div>

		<p>I can&#8217;t be bothered with anything these days, but such is life. I don&#8217;t care. So it goes. More or less nothing seems worth thinking about. I&#8217;ve just been hanging out waiting for something to happen, but that&#8217;s how it is.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-388923">
				<div id="div-comment-388923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-388923">
			June 7, 2006 at 5:40 pm</a>		</div>

		<p>I&#8217;ve just been hanging out not getting anything done. What can I say? I&#8217;ve basically been doing nothing worth mentioning, but pfft. Not that it matters. Pretty much nothing exciting happening to speak of. I haven&#8217;t been up to much these days.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390553">
				<div id="div-comment-390553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-390553">
			June 13, 2006 at 10:05 am</a>		</div>

		<p>I haven&#8217;t been up to anything today. I don&#8217;t care. I&#8217;ve just been staying at home not getting anything done. Basically not much happening right now. Maybe tomorrow. I guess it doesn&#8217;t bother me.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390903">
				<div id="div-comment-390903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-390903">
			June 13, 2006 at 2:51 pm</a>		</div>

		<p>My appologies, I posted this before here, but I don&#8217;t see it &#8211; perhaps I pressed the wrong button.</p>
<p>I would like to know if there was an interesting story behind 16-bit GDI&#8217;s MoveTo being dropped for MoveToEx in Win32. &nbsp;It&#8217;s very rare that any API is being dropped like this! &nbsp;Plus, a function that would be in most non-MFC Win16 apps.</p>
<p>Could it be because it conflicted with another library? &nbsp;Source code that&#8217;s 10 years old is littered with #define of MoveTo to MoveToEx</p>
<p>p.s. : the CR/NL post above is really interesting!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391203">
				<div id="div-comment-391203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391203">
			June 13, 2006 at 10:06 pm</a>		</div>

		<p>I&#8217;ve just been staying at home not getting anything done. I guess it doesn&#8217;t bother me. Shrug. I haven&#8217;t been up to anything. I haven&#8217;t gotten much done today.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391213">
				<div id="div-comment-391213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pavel Vozenilek</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391213">
			June 13, 2006 at 10:12 pm</a>		</div>

		<p>Perhaps you may write something about popularity of this blog. When I googled for it now (using &#8220;Raymond Chen&#8221; keyword) the only text add shown was &#8220;Job at Google&#8221; directly from Google Inc ;) This is kind a black belt level for a blogger, isn&#8217;t it? </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2006/06/26/647366.aspx" rel="nofollow">Topic accepted</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391243">
				<div id="div-comment-391243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391243">
			June 13, 2006 at 11:10 pm</a>		</div>

		<p>My life&#8217;s been pretty dull recently. Shrug. My mind is like a void. I haven&#8217;t gotten anything done lately. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391483">
				<div id="div-comment-391483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.knowledgeisbeing.com' rel='external nofollow' class='url'>Patrick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391483">
			June 14, 2006 at 11:47 am</a>		</div>

		<p>Can you write something about how seemingly random strings break notepad? &nbsp;It seems like it is confusing notepad and making it guess the wrong encoding? </p>
<p>See: </p>
<p><a href="http://digg.com/software/_this_app_can_break_Are_there_any_other_forbidden_strings_in_Notepad_" rel=nofollow target=_new rel="nofollow">http://digg.com/software/_this_app_can_break_Are_there_any_other_forbidden_strings_in_Notepad_</a> </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391523">
				<div id="div-comment-391523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391523">
			June 14, 2006 at 12:03 pm</a>		</div>

		<p>I&#8217;ve just been staying at home waiting for something to happen. Whatever. Not much on my mind lately. I guess it doesn&#8217;t bother me.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391793">
				<div id="div-comment-391793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Francois Boucher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391793">
			June 14, 2006 at 7:30 pm</a>		</div>

		<p>Sleep() + flag vs WaitForSingle(Event) </p>
<p>Which scenario is better? &nbsp;The first one uses only 1 handle for the thread. &nbsp;The second one will use 2. &nbsp;But is the first scenario wasting more thread time? &nbsp;Is it worth using the event (kernel object)? </p>
<p>The event and the flag signal tell the thread to exit. </p>
<p>while( fKeepGoing ) <br />{ <br />&nbsp;//Check something <br />&nbsp;Sleep(50); <br />} </p>
<p>or </p>
<p>do <br />{ <br />&nbsp;//Check the same thing <br />} <br />while( WaitForSingle(hEvent, 50) == WAIT_TIMEOUT ); </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/07/27/9849503.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391803">
				<div id="div-comment-391803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Francois Boucher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391803">
			June 14, 2006 at 7:42 pm</a>		</div>

		<p>When in a thread, is it better to check an exit boolean flag and Sleep(N) or loop and wait on an alertable event handle every N ms?</p>
<p>Is it worth using the extra kernel object?</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391863">
				<div id="div-comment-391863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-391863">
			June 15, 2006 at 12:34 am</a>		</div>

		<p>I&#8217;ve just been staying at home waiting for something to happen, but I don&#8217;t care. Basically nothing seems worth thinking about. I can&#8217;t be bothered with anything recently.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393653">
				<div id="div-comment-393653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-393653">
			June 20, 2006 at 9:12 pm</a>		</div>

		<p>Not much on my mind. I don&#8217;t care. I&#8217;ve just been letting everything happen without me , but shrug. Whatever. I feel like a void.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393863">
				<div id="div-comment-393863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-393863">
			June 21, 2006 at 7:39 pm</a>		</div>

		<p>Not much on my mind right now, but it&#8217;s not important. I&#8217;ve just been letting everything happen without me. I just don&#8217;t have anything to say right now.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393873">
				<div id="div-comment-393873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RuleZ023</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-393873">
			June 21, 2006 at 10:12 pm</a>		</div>

		<p>I just don&#8217;t have much to say recently. Such is life. I&#8217;ve basically been doing nothing. Basically nothing seems worth bothering with. Oh well.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-394413">
				<div id="div-comment-394413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://apipes.blogspot.com' rel='external nofollow' class='url'>Tim Lesher</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-394413">
			June 22, 2006 at 2:04 pm</a>		</div>

		<p>These might be outside your realm, but:</p>
<p>1. Before DirectShow, there was Video for Windows&#8230; but before that, was Clockwork (which looked a lot like what became ActiveMovie). Any comments on the history of these technologies, and how Clockwork-&gt;Quartz-&gt;ActiveMovie-&gt;DirectShow happened?</p>
<p>2. The little-known DrawDib API was the answer to many programmers&#8217; image-drawing needs (after Windows 95 came out, with VfW built-in). Why didn&#8217;t it ever seem to get any respect from within Microsoft?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395133">
				<div id="div-comment-395133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://wendyhome.com' rel='external nofollow' class='url'>::wendy::</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-395133">
			June 23, 2006 at 4:29 pm</a>		</div>

		<p>without messing-up the display of the whole post (xref today&#8217;s article on the usability of conference name tags)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/08/03/9855911.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-395193">
				<div id="div-comment-395193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codexxi.com' rel='external nofollow' class='url'>asmguru62</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-395193">
			June 23, 2006 at 7:23 pm</a>		</div>

		<p>I have come across the issue: </p>
<p>1. Main window created (WS_OVERLAPPEDWINDOW) </p>
<p>2. Child control created: multiline edit control </p>
<p>3. When parent is resized &#8211; edit control also resized to take some room on the main (parent) window </p>
<p>4. EM_SETRECT used on a child to provide some margings for a text typed in the control </p>
<p>5. The next MoveWindow() in WM_SIZE message resets the margins back to default values </p>
<p>Just wondering, if it is a real issue or it was designed to work that way. I am used to the thought, that if some property applied to HWND &#8211; this HWND should retain the property until HWND will be destroyed. Seems logical, but not the case here. </p>
<p>P.S. I have a small test application which shows this</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2009/08/17/9871887.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395413">
				<div id="div-comment-395413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-395413">
			June 26, 2006 at 7:32 am</a>		</div>

		<p>Why does the stat function in MS C library return times dependant on the &#8220;Automatically adjust clock for daylight saving changes&#8221; setting? This introduces some problems when porting software fron *nix (and also explains why CVS updates take longer after the winter/summer time transition).</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-395943">
				<div id="div-comment-395943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-395943">
			June 27, 2006 at 10:19 am</a>		</div>

		<p>Is there a documented way to retrieve the usable rectangle inside balloon (TTS_BALLOON) tooltips? NMCUSTOMDRAW::rc contains coordinates which fail outside the balloon region.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396023">
				<div id="div-comment-396023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamessummerlin.blogspot.com' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-396023">
			June 27, 2006 at 4:14 pm</a>		</div>

		<p>Mr. Chen,</p>
<p>I was wondering if I might request that we see more posts about Microsoft history and why things are the way they are in Windows. &nbsp;For example, I totally loved your article in TechNet Magazine about Fat32.</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-396203">
				<div id="div-comment-396203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ubercode.com' rel='external nofollow' class='url'>Will Rayer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-396203">
			June 28, 2006 at 8:52 am</a>		</div>

		<p>Hello &#8211; I have an article suggestion, which is the degree to which &#8216;plain vanilla&#8217; C Windows API code works under Vista with the native look and feel.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396243">
				<div id="div-comment-396243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sarathc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-396243">
			June 28, 2006 at 10:14 am</a>		</div>

		<p>Hi Raymond, </p>
<p>I&#8217;m real enthusiastic of your blog. </p>
<p>Let me introduce myself. My name is Sarath, I&#8217;m working as Software <br />Engineer in India. </p>
<p>My Skill sets are MFC and C++ (Application, GUI). I&#8217;d like to build my <br />career in that area and also I&#8217;d like to be part of Microsoft. For that <br />my knowledge is not enough. In which way I should go? Managed C++ can be <br />a future for me? Please suggest some books or website(of course your <br />blog is one of the key resource). How could I improve myself? It would <br />be helpful for me, if you give me some tips. </p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-396303">
				<div id="div-comment-396303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zeegrid.com' rel='external nofollow' class='url'>David</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-396303">
			June 28, 2006 at 1:27 pm</a>		</div>

		<p>Why is there an apparent lack of development for new controls that use the same programming methods as the basic edit control or listbox control? &nbsp;It seems that there must have been a decision to only develop COM controls after the invention of COM.</p>
<p>Many COM controls could have been implemented as Win32 controls. &nbsp;I have personally developed grid controls, and image display controls that are compatible with Win32, so I know it&#8217;s possible to do, but why hasn&#8217;t Microsoft developed these and made them standard controls with the operating system?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396693">
				<div id="div-comment-396693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian McCarthy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-396693">
			July 2, 2006 at 12:44 pm</a>		</div>

		<p>Can you to create an information context for the display? &nbsp;For a printer, I can use CreateIC(), using paramters from the device manager. &nbsp;For the<br />
<br />display I can call CreateDC() with &quot;DISPLAY&quot;, but the documentation suggests that won&#8217;t work with CreateIC(). &nbsp;Perhaps that wouldn&#8217;t generalize for a multi-monitor display with different settings on each screen.</p>
<p>I&#8217;m trying to avoid constantly creating and destroying DCs when all I need to do is measure strings, check color depth, dpi, etc. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-396773">
				<div id="div-comment-396773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sarathc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-396773">
			July 3, 2006 at 9:49 am</a>		</div>

		<p>Hi Raymond,<br />
<br />how we could implement a custom scrollbar as windows do? what is the logic behind the thumb size and position calculation calculation and all? how we could dynamically manage it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-401193">
				<div id="div-comment-401193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401193">
			July 15, 2006 at 7:32 pm</a>		</div>

		<p>Raymond,</p>
<p>Love the blog. Helps wake my brain up in the morning :)</p>
<p>I just wondered if the idea of creating an Explorer UI element for NTFS hardlink support (as demonstrated by fsutil) was ever thrown around, and if so, why it hasn&#8217;t been implemented. I suppose it could cause some havoc for less knowledgeable users who don&#8217;t understand the concept, but it seems a shame to let a good feature of NTFS go to waste.</p>
<p>Thanks for any insight.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-401713">
				<div id="div-comment-401713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401713">
			July 18, 2006 at 11:44 am</a>		</div>

		<p>Please check this to see how many good programming practices are broken in a single Windows DLL.</p>
<p>I was about to send a small windowshot via email so I rightclicked a .gif file and selected Send To|Mail Recipient&#8230;</p>
<p>#1 &#8211; Spamming user with dialog which can&#8217;t be turned off</p>
<p>Much to my amazement I got an option to resize the picture to make it smaller. But wait, it was ~430&#215;490 and I can size it _down_ to the 640&#215;480?!?</p>
<p>#2 &#8211; Confusing wording</p>
<p>Apart from awkward wording which says &quot;Make *ALL* my pictures smaller&quot; (I wouldn&#8217;t like that thank you), it appeared that Windows doesn&#8217;t check for image size.</p>
<p>#3 &#8211; No checking for image size</p>
<p>So I fired up disassembler and checked sendmail.dll (SP1, offsets are different in SP2) for oddities and I found this:</p>
<p>5CDC3F63 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call &nbsp; &nbsp;_PathIsImage@4<br />
<br />5CDC3F68 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; test &nbsp; &nbsp;eax, eax<br />
<br />5CDC3F6A &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jz &nbsp; &nbsp; &nbsp;loc_5CDC414E</p>
<p>Aha, its image, lets offer to resize it no matter if it is already small just for the sake of annoying the user!</p>
<p>#4 &#8211; No checking for real file content</p>
<p>That is not all mind you, PathIsImage() only checks the extension and not the actual file content!!! Just for fun rename zip archive to .jpg and try to send it this way.</p>
<p>#5 &#8211; Poor error handling/signalization</p>
<p>I bet it would recover nicely from an error&#8230; if there was actually error handling code in there. Instead it just skips silently to the next file unless a SHILCreateFromPath() shows some dialog box which would also be another bad practice.</p>
<p>text:5CDC3F78 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call &nbsp; &nbsp;ds:__imp__SHILCreateFromPath@12<br />
<br />text:5CDC3F7E &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov &nbsp; &nbsp; edi, eax<br />
<br />text:5CDC3F80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp &nbsp; &nbsp; edi, ebx<br />
<br />text:5CDC3F82 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jl &nbsp; &nbsp; &nbsp;loc_5CDC414E</p>
<p>Which then does:</p>
<p>lea &nbsp; &nbsp; ecx, [ebp+74h+var_3C]<br />
<br />call &nbsp; &nbsp;?Next@CFileEnum@@QAEPAUMRFILEENTRY@@XZ<br />
<br />mov &nbsp; &nbsp; esi, eax<br />
<br />cmp &nbsp; &nbsp; esi, ebx<br />
<br />jnz &nbsp; &nbsp; loc_5CDC3F44</p>
<p>Perhaps you could check if they fixed it in Vista?</p>
<p>I temporarily &quot;fixed&quot; mine by putting xor instead of test because I didn&#8217;t want my files to be discriminated.</p>
<p>And please check this picture of a Vista start menu:<br />
<br /><a rel="nofollow" target="_new" href="http://www.gamepc.com/images/labs/vista/rev-xpfinal-smprogsLG.jpg" rel="nofollow">http://www.gamepc.com/images/labs/vista/rev-xpfinal-smprogsLG.jpg</a></p>
<p>And tell them to remove all those Windows&#8217; repeating endlessly there.</p>
<p>IMO, only two names are really justified &#8212; Windows Update and Windows Defender. Others are pure nonsense. I mean, Windows Contacts?!? Aren&#8217;t they actually ours?</p>
<p>And finally I am sorry if all this sounded as a rant. I like reading your blog very much.<br />
<br />Best regards,<br />
<br />Igor<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-401833">
				<div id="div-comment-401833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401833">
			July 18, 2006 at 6:48 pm</a>		</div>

		<p>Why doesn&#8217;t the taskbar extend across multiple monitors?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-401893">
				<div id="div-comment-401893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401893">
			July 19, 2006 at 3:10 am</a>		</div>

		<p>Regarding the upcoming &quot;talk about import libraries in more detail&quot; that you mention in your July 18 post, would it be possible for you to find out and mention why import libraries are even /necessary/, and why the build-time linker can&#8217;t &quot;link&quot; against the .dll, extracting the info it needs from there?</p>
<p>If the answer to this is &quot;because the .dll doesn&#8217;t contain all the informtion the linker needs&quot; &#8211; the question becomes &quot;why don&#8217;t .dlls contain all the information needed to link against them?&quot;</p>
<p>It&#8217;s something that&#8217;s always seemed a little weird to me, but I&#8217;ve never been able to figure out &quot;why&quot;, despite a number of google searches over the years. The &quot;whys&quot; never seem to be documented anywhere.</p>
<p>Cheers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-401953">
				<div id="div-comment-401953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401953">
			July 19, 2006 at 6:14 am</a>		</div>

		<p>I&#8217;ve often wished that applications in Windows run completely sandboxed. &nbsp;By this I mean the user gives them a directory to which they install, and the only HD access they have is to this directory and My Documents, Temp and other specific folders. &nbsp;If they try to add keys to the registry, they are really added to a registry &#8216;patch&#8217; in the app&#8217;s directory, not the real registry. &nbsp;If they try to put files in Windowssystem32, they are really added to a &#8216;virtual&#8217; Windowssystem32 inside the app&#8217;s directory. &nbsp;Start menu shortcuts are also in the app&#8217;s directory, and upon install the user is asked whether to insert &#8216;hooks&#8217; into the Start menu code to pick these up. &nbsp;The app runs in a memory sandbox with no access outside of it. &nbsp;Any access to anything outside of its user-allocated areas is prompted &#8211; even things like .NET runtime which would be required by other apps.</p>
<p>I feel that this would seriously prevent viruses/spyware from being as effective, and apps would not be able to dump files all over the users&#8217; HD (which almost all apps do). &nbsp;Furthermore, uninstalling an app would be 99% just deleting the folder in which the app was installed &#8211; that would take the Start menu shortcuts, registry keys etc with it automatically.</p>
<p>I hope I&#8217;ve explained this well enough, I have more detail on how certain obvious problems would be resolved but I&#8217;ll refrain from writing it here due to space. &nbsp;Has this approach ever been discussed for Windows? &nbsp;What are the insurmountable reasons (if any) why it wouldn&#8217;t work?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-401963">
				<div id="div-comment-401963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401963">
			July 19, 2006 at 6:15 am</a>		</div>

		<p>I&#8217;ve often wished that applications in Windows run completely sandboxed. &nbsp;By this I mean the user gives them a directory to which they install, and the only HD access they have is to this directory and My Documents, Temp and other specific folders. &nbsp;If they try to add keys to the registry, they are really added to a registry &#8216;patch&#8217; in the app&#8217;s directory, not the real registry. &nbsp;If they try to put files in Windowssystem32, they are really added to a &#8216;virtual&#8217; Windowssystem32 inside the app&#8217;s directory. &nbsp;Start menu shortcuts are also in the app&#8217;s directory, and upon install the user is asked whether to insert &#8216;hooks&#8217; into the real Start menu so that it can pick these up. &nbsp;The app runs in a memory sandbox with no access outside of it. &nbsp;Any access to anything outside of its user-allocated areas is prompted &#8211; even things like .NET runtime which would be required by other apps.</p>
<p>I feel that this would seriously prevent viruses/spyware from being as effective, and apps would not be able to dump files all over the users&#8217; HD (which almost all apps do). &nbsp;Furthermore, uninstalling an app would be 99% just deleting the folder in which the app was installed &#8211; that would take the Start menu shortcuts, registry keys etc with it automatically.</p>
<p>I hope I&#8217;ve explained this well enough, I have more detail on how certain obvious problems would be resolved but I&#8217;ll refrain from writing it here due to space. &nbsp;Has this approach ever been discussed for Windows? &nbsp;What are the insurmountable reasons (if any) why it wouldn&#8217;t work?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-401973">
				<div id="div-comment-401973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401973">
			July 19, 2006 at 6:16 am</a>		</div>

		<p>I&#8217;ve often wished that applications in Windows run completely sandboxed. &nbsp;By this I mean the user gives them a directory to which they install, and the only HD access they have is to this directory and My Documents, Temp and other specific folders. &nbsp;If they try to add keys to the registry, they are really added to a registry &#8216;patch&#8217; in the app&#8217;s directory, not the real registry. &nbsp;If they try to put files in Windowssystem32, they are really added to a &#8216;virtual&#8217; Windowssystem32 inside the app&#8217;s directory. &nbsp;Start menu shortcuts are also in the app&#8217;s directory, and upon install the user is asked whether to insert &#8216;hooks&#8217; into the real Start menu so that it can pick these up. &nbsp;The app runs in a memory sandbox with no access outside of it. &nbsp;Any access to anything outside of its user-allocated areas is prompted &#8211; even things like .NET runtime which would be required by other apps.</p>
<p>I feel that this would seriously prevent viruses/spyware from being as effective, and apps would not be able to dump files all over the users&#8217; HD (which almost all apps do). &nbsp;Furthermore, uninstalling an app would be 99% just deleting the folder in which the app was installed &#8211; that would take the Start menu shortcuts, registry keys etc with it automatically.</p>
<p>I hope I&#8217;ve explained this well enough, I have more detail on how certain obvious problems would be resolved but I&#8217;ll refrain from writing it here due to space. &nbsp;Has this approach ever been discussed for Windows? &nbsp;What are the insurmountable reasons (if any) why it wouldn&#8217;t work?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-401983">
				<div id="div-comment-401983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-401983">
			July 19, 2006 at 6:16 am</a>		</div>

		<p>I&#8217;ve often wished that applications in Windows run completely sandboxed. &nbsp;By this I mean the user gives them a directory to which they install, and the only HD access they have is to this directory and My Documents, Temp and other specific folders. &nbsp;If they try to add keys to the registry, they are really added to a registry &#8216;patch&#8217; in the app&#8217;s directory, not the real registry. &nbsp;If they try to put files in Windowssystem32, they are really added to a &#8216;virtual&#8217; Windowssystem32 inside the app&#8217;s directory. &nbsp;Start menu shortcuts are also in the app&#8217;s directory, and upon install the user is asked whether to insert &#8216;hooks&#8217; into the real Start menu so that it can pick these up. &nbsp;The app runs in a memory sandbox with no access outside of it. &nbsp;Any access to anything outside of its user-allocated areas is prompted &#8211; even things like .NET runtime which would be required by other apps.</p>
<p>I feel that this would seriously prevent viruses/spyware from being as effective, and apps would not be able to dump files all over the users&#8217; HD (which almost all apps do). &nbsp;Furthermore, uninstalling an app would be 99% just deleting the folder in which the app was installed &#8211; that would take the Start menu shortcuts, registry keys etc with it automatically.</p>
<p>I hope I&#8217;ve explained this well enough, I have more detail on how certain obvious problems would be resolved but I&#8217;ll refrain from writing it here due to space. &nbsp;Has this approach ever been discussed for Windows? &nbsp;What are the insurmountable reasons (if any) why it wouldn&#8217;t work?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-403143">
				<div id="div-comment-403143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-403143">
			July 25, 2006 at 9:22 am</a>		</div>

		<p>Apologies for the triple post above &#8211; not sure how that happened.</p>
<p>How would you go about creating a special toolbar to sit on the taskbar like the Windows Media Player 10 minimised toolbar (which has play control buttons on the toolbar button itself)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-404073">
				<div id="div-comment-404073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-404073">
			July 27, 2006 at 3:01 pm</a>		</div>

		<p>Raymond,</p>
<p>You should probably follow up on the Floyd Landis drug scandal. It&#8217;s still breaking news at the moment, but I&#8217;m sure more will follow:</p>
<p><a rel="nofollow" target="_new" href="http://seattletimes.nwsource.com/html/sports/2003156267_weblandis27.html" rel="nofollow">http://seattletimes.nwsource.com/html/sports/2003156267_weblandis27.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404153">
				<div id="div-comment-404153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-404153">
			July 27, 2006 at 8:04 pm</a>		</div>

		<p>I suggest you move the &#8216;suggestion box&#8217; link to the top of the nav bar (perhaps between &#8216;search&#8217; and &#8216;archives&#8217;) and maybe even make it bigger or in a different font or something. &nbsp;I only found it by using Ctrl+F</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-404483">
				<div id="div-comment-404483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">charless</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-404483">
			July 28, 2006 at 2:58 pm</a>		</div>

		<p>So after all of these informative articles about DLL import and export, I am more curious than every why shlwapi.dll imports a nonexistant function from mpr.dll (on WinXP sp2 at least). You see this in Dependency Walker quite often. (e.g. View Dependencies on C:windowsexplorer.exe and notice the warning and it source.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405283">
				<div id="div-comment-405283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://wgocki@wp.pl' rel='external nofollow' class='url'>Wacek</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-405283">
			August 1, 2006 at 11:41 am</a>		</div>

		<p>Hi Raymond<br />
<br />I&#8217;ve been reading your blog for a long time, since times it was just a web page not a blog.<br />
<br />Thanks for a lot of fun and interesting time spent on reading your posts.<br />
<br />And my suggestion is:</p>
<p>Don&#8217;t you want to be a Windows Code Pope ?</p>
<p><a rel="nofollow" target="_new" href="http://www.pcmag.com/article2/0,1895,1993524,00.asp" rel="nofollow">http://www.pcmag.com/article2/0,1895,1993524,00.asp</a></p>
<p>I would vote for you if there would be an election. </p>
<p>Regards </p>
<p>Wacek</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-406023">
				<div id="div-comment-406023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://cs.usu.edu.ru/home/skrobov/' rel='external nofollow' class='url'>A. Skrobov</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-406023">
			August 4, 2006 at 12:03 pm</a>		</div>

		<p>I&#8217;m really curious about the blog stats, like which portion of the entire blogs.msdn.com traffic is yours, what are the top referrers, what search requests lead to the blog, and the like.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406233">
				<div id="div-comment-406233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://foddrick.com' rel='external nofollow' class='url'>Mark Reid</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-406233">
			August 6, 2006 at 9:59 pm</a>		</div>

		<p>Hi Raymond,<br />
<br />I&#8217;ve never been able to work out why a windowed console window that is outputting a lot of data makes the UI so unresponsive while it is showing.<br />
<br />The problem doesn&#8217;t occur when the window is not visible (eg another window is on top of it)<br />
<br />thanks<br />
<br />Mark</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-410493">
				<div id="div-comment-410493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.outofhanwell.com/blog/' rel='external nofollow' class='url'>Matthias Miller</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-410493">
			August 17, 2006 at 9:57 pm</a>		</div>

		<p>With your recent posts on DLLs and libraries, what is the meaning of the signatures in the library entries? Why do exported functions use IMAGE_FILE_MACHINE_UNKNOWN and 0xffff?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-410523">
				<div id="div-comment-410523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-410523">
			August 18, 2006 at 1:44 am</a>		</div>

		<p>I&#8217;d love to see you do a series on random or obvious to you but probably not obvious to everyone PSDK tidbits like WINVER, _WIN32_WINDOWS, WIN32_LEAN_AND_MEAN, multimon-like backwards compatible stuff, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-410533">
				<div id="div-comment-410533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-410533">
			August 18, 2006 at 1:44 am</a>		</div>

		<p>I&#8217;d love to see you do a series on random or obvious to you but probably not obvious to everyone PSDK tidbits like WINVER, _WIN32_WINDOWS, _WIN32_WINNT, WIN32_LEAN_AND_MEAN, multimon-like backwards compatible stuff, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-412043">
				<div id="div-comment-412043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-412043">
			August 22, 2006 at 9:50 am</a>		</div>

		<p>I was just implementing an event logging system using mailslots and I came across a frankly unbelievable detail on the &quot;About Mailslots&quot; page of the Interprocess communication section of the MSDN docs. </p>
<p>&quot;Messages smaller than 425 bytes are sent using datagrams. Messages larger than 426 bytes are sent using a connection-oriented transfer over an SMB session. Connection-oriented transfers are limited to one-to-one communication from one client to one server. Therefore, you lose the ability to broadcast a message from one client to many servers. Note that Windows does not support messages that are 425 or 426 bytes. &quot;</p>
<p>I&#8217;d love to know whether or not there&#8217;s a good reason why 425 or 426 byte long messages are not allowed.</p>
<p>According to the &quot;About Mailslots&quot; page of the Interprocess communication section of the platform SDK</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-414083">
				<div id="div-comment-414083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sfilippov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-414083">
			August 28, 2006 at 11:12 am</a>		</div>

		<p>Resource compiler issues a warning if the text length in a static control exceedes 256 characters: &quot;warning RC4206 : title string too long; truncated at 256&quot;.<br />
<br />AFAIK dialog template has no such a limit. Is this warning just a 16-bit legacy?</p>
<p>This was not an issue until now &#8211; we always were able to rephrase a text to fit it in 256 limit. Now we are localizing our product. After translating to German and French the length of the text in many controls became longer &nbsp;than 256 chars and resource compiler thruncates it to 256.</p>
<p>Of course your answer will not solve the problem, but I just wonder is any chance that in a future this limit will be eliminated?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414273">
				<div id="div-comment-414273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-414273">
			August 28, 2006 at 3:04 pm</a>		</div>

		<p>Why was the &quot;Start&quot; label removed from the Start button in Vista? As you&#8217;ve talked about, that label was a great affordance in telling newbie users what to click on first.<br />
<br />How are the help and tech support folks going to refer to the button? &quot;The round windows logo in the corner&quot; doesn&#8217;t have quite the same ring to it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-414433">
				<div id="div-comment-414433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BrianK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-414433">
			August 28, 2006 at 9:37 pm</a>		</div>

		<p>What compiler do you and other developers use? Are you using VS2005 yet?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414933">
				<div id="div-comment-414933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roland Persson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-414933">
			August 29, 2006 at 6:19 pm</a>		</div>

		<p>There seems to be a limit on the total path of filenames to be less than 256 characters. This limit is enforced by the shell when naming files for example.</p>
<p>You can trick the checks though by renaming a directory above the file and get a full filename that is longer than the limit.</p>
<p>For example:<br />
<br />1. create c:mydir<br />
<br />2. put a file in mydir and give it the longest possible name the shell allows.<br />
<br />3. rename c:mydir to something longer, like mydir_long</p>
<p>Although the limit is pretty high it does happen that users manage to reach it inadvertently. Typically by people who like to organize stuff and have deep directory hierarchys with descriptive names for everything.</p>
<p>If you create such a file and it is associated to a program and then doubleclick the file the filename sent to the launched program as an argument will be cut before the limit is reached. </p>
<p>In the above case &quot;c:mydir_long&quot; would be given as an argument to the launched program.</p>
<p>Why is this? And wouldn&#8217;t it be better to pass the whole filename eventhough it&#8217;s too long? The command line length is no longer a problem in these cases is it?</p>
<p>And if that is not better wouldn&#8217;t it be better to do nothing at all? Or to tell the user that the filename is too long and that they need to rename it (although that&#8217;s not so easy as the shell wont allow them to, they have to shorten the path first).</p>
<p>Any workarounds for this that can be implemented in the launched program itself?</p>
<p>This is observed on WinXP SP2.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-415163">
				<div id="div-comment-415163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bod J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-415163">
			August 30, 2006 at 9:43 am</a>		</div>

		<p>How to encrypt autologon password in registry. I know powertool does this, but haven&#8217;t found a way to do this myself. </p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415303">
				<div id="div-comment-415303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jamie Gordon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-415303">
			August 30, 2006 at 12:35 pm</a>		</div>

		<p>I do a lot of low level process manipulation and I find the documentation on certain aspects quite scant so a lot of it turns out to be trial and error. I&#8217;ve listed some things I have had difficulty with lately, I thought they might make nice blog topics, simply because the answers would interest me (from a &quot;I like to know how things work under the hood&quot; viewpoint).</p>
<p>When using the BeginUpdateResource (et al) functions, why must the resource section in an image be called &quot;.rsrc&quot;, and why is IMAGE_DIRECTORY_ENTRY_RESOURCE ignored otherwise? Although Explorer still appears able to display the resources if you only have IMAGE_DIRECTORY_ENTRY_RESOURCE set, EndUpdateResource (on XP) does some strange things if the resource section is not called &quot;.rsrc&quot;. What is the original cause of this behaviour? (As I understand it [vaguely], it&#8217;s not a bug in the API but a throwback to behaviour in something else. Or maybe the API is just broken after all, and I just hoped the answer might be more interesting than that. heh)</p>
<p>What contitutes a valid Win32 application to the loader, as distinct from just a file that has MZ and PE in the right locations? Specifically, I had an image that appeared to be valid but which the loader refused to load. I fixed it by making sure SizeOfHeaders, SizeOfCode, SizeOfInitializedData and &nbsp;SizeOfUninitializedData total the same as SizeOfImage (which wasn&#8217;t strictly how it actually was, but it made it work). But I have seen other images where this is definietly not the case but the loader does still load them.</p>
<p>What rules does the loader use for data appended to an image but which is not in a section. I have seen compilers place data (which it seems ought really to be placed in a section) in both the header itself and appended to the end of an image. The appended data was also referenced by an entry in the DataDirectory so I assume it was even needed at runtime. So does the loader place such data in memory, what is it supposed to do (if there is a spec.), and if it ends up in memory how does it protect the memory given the absense of any section characteristics?</p>
<p>Thanks for a great blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-416133">
				<div id="div-comment-416133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">eric johnson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-416133">
			September 1, 2006 at 7:13 pm</a>		</div>

		<p>i hate working with the mouse and much prefer the keyboard. &nbsp;i wish the &quot;repeat rate&quot; setting in the keyboard control panel would go higher. &nbsp;my googling around on the topic has left me with no great solution.</p>
<p>might be interesting to hear about how the keyboard control panel does what it does and why one can&#8217;t go higher.</p>
<p>keyboard king (<a rel="nofollow" target="_new" href="http://bandwidthcontroller.com/Keyboard%20King/" rel="nofollow">http://bandwidthcontroller.com/Keyboard%20King/</a>) gets me closer, but it has some quirky behavior &nbsp;possibly triggered by it stuffing events into the event queue.</p>
<p>-eric</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416273">
				<div id="div-comment-416273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-416273">
			September 3, 2006 at 5:12 am</a>		</div>

		<p>[Commenting on the article &quot;Applications and DLLs don&#8217;t have privileges; users do&quot;]</p>
<p>How about not granting debug privileges on the user? This will make bypassing the protection impossible. But that will prohibit legalmate debugging, so how about separate the dangerous activities from the non-dangerous activities, or better, only allow approved programs to do the dangerous activities?<br />
<br />The dangerous activities are:<br />
<br />Calling WriteProcessMemory on the process<br />
<br />Changing the processor context</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-416533">
				<div id="div-comment-416533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arno Schoedl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-416533">
			September 5, 2006 at 7:39 am</a>		</div>

		<p>One would think that GetDC(hwnd) and GetDCEx(hwnd, NULL, 0) do the same thing. Not so. I had an <em>iconized</em> MDI window with CS_OWNDC (to be precise, an Excel 2000 document window). GetDC retrieved some DC different from the own DC, while GetDCEx retrieved the own DC. ???</p>
<p>Arno</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417373">
				<div id="div-comment-417373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fredrik Ullner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-417373">
			September 7, 2006 at 5:00 am</a>		</div>

		<p>When hovering over the &#8216;Start&#8217; button, a tooltip appear. However, if you hover long enough, the tooltip will go away. If you move the mouse, and then hover the &#8216;Start&#8217; button again, the tooltip doesn&#8217;t display.<br />
<br />But, if you click on the &#8216;Start&#8217; button, the tooltip will then display when you again hover the &#8216;Start&#8217; button. </p>
<p>Why doesn&#8217;t the tooltip re-appear if you don&#8217;t press the button?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-417413">
				<div id="div-comment-417413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-417413">
			September 7, 2006 at 6:51 am</a>		</div>

		<p>That is probably AWE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417423">
				<div id="div-comment-417423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-417423">
			September 7, 2006 at 6:55 am</a>		</div>

		<p>Before Windows XP, yes, but not anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-417443">
				<div id="div-comment-417443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-417443">
			September 7, 2006 at 7:01 am</a>		</div>

		<p>Well, first the DOS inside Win9x is started and then it starts win.com, which is a DOS application. Basically it is like Win3.1 in 386 enhanced mode which is also more like an OS than a DOS frontend.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417453">
				<div id="div-comment-417453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-417453">
			September 7, 2006 at 7:01 am</a>		</div>

		<p>Well, first the DOS inside Win9x is started and it starts win.com, which is a DOS application. Basically it is like Win3.1 in 386 enhanced mode which is also more like an OS than a DOS frontend.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-419543">
				<div id="div-comment-419543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.co.uk' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-419543">
			September 13, 2006 at 5:51 am</a>		</div>

		<p>&#8230;if you aren&#8217;t writing device drivers?</p>
<p>You have written on several occasions about the stuff that goes into a new version of Windows to avoid breaking existing apps. My perception is that on many occasions the app was actually broken even when it was written, which means the whole sorry tale could have been avoided, if only they&#8217;d known.</p>
<p>Now, the checked build could (and does) in some (many?) cases, contain code to spot obvious abuses and report them to developers. Its a kind of hot line between two groups of people who (on your blog&#8217;s evidence) really need to talk more. :)</p>
<p>However, my perception is that the checked build is woefully underused. I&#8217;ve been running check builds on my test systems for years and there are major apps out there (hello, InstallShield) that display &quot;you goofed, abort retry ignore&quot; message boxes on checked builds. (In fact, there are device drivers that simply blue-screened on boot, but I did exclude driver development just now, so I&#8217;ll say no more.) It is hard to believe that such code has ever had ever the most cursory &quot;start it up&quot; testing on a checked build, far less a complete test program under the application verifier.</p>
<p>So why don&#8217;t MS support and promote the checked builds more? It doesn&#8217;t get protection from Windows Update and Windows Installer 3.1 (which is *required* for VS2005) refuses to install, so as I write these words the checked build is unusable with VS2005.</p>
<p>Am I simply mis-understanding what MS intend the checked build for? Do *they* see it as just a driver tool?</p>
<p>Afterthought: Each time MS add something evil for compatibility, they could make it conditional on &quot;if (!IsDebuggerPresent())&quot;, which would mean end-users got the protection (this is commercially essential) but the descendants of the original developers didn&#8217;t, but had the precise nature of the error and the fix explained to them instead. Nice or nasty?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420203">
				<div id="div-comment-420203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andres</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-420203">
			September 14, 2006 at 12:08 pm</a>		</div>

		<p>Why doesn&#8217;t Windows Explorer show the Folders size when in &quot;Details&quot; mode?</p>
<p>Andres</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-420373">
				<div id="div-comment-420373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-420373">
			September 14, 2006 at 3:08 pm</a>		</div>

		<p>You ran an article once about illogical pricing at the Microsoft cafeteria. &nbsp;Here&#8217;s a similar topic on Starbucks&#8217; &quot;ghetto latte&quot;:</p>
<p><a rel="nofollow" target="_new" href="http://freepressblog.org/2006/09/06/gaming-starbucks-the-ghetto-latte/" rel="nofollow">http://freepressblog.org/2006/09/06/gaming-starbucks-the-ghetto-latte/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420873">
				<div id="div-comment-420873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://raymond.shpeley@gmail.com' rel='external nofollow' class='url'>Ray S</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-420873">
			September 15, 2006 at 3:16 pm</a>		</div>

		<p>Back on November 16, 2004 you posted &quot;What is this Xerox directory doing in Program Files?&quot;</p>
<p>No need to rehash that blog, it turned out to be very informative (thanks, by the way). The only problem is on searching all of the Microsoft websites I found no hits for &quot;nwwia&quot;, including this one (probably due to archiving).</p>
<p>The problem I still have with this is that there&#8217;s no Microsoft document about the xerox/nwwia folders.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-421203">
				<div id="div-comment-421203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.castledragmire.com' rel='external nofollow' class='url'>Jeffrey Riaboy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-421203">
			September 17, 2006 at 1:48 pm</a>		</div>

		<p>I noticed you&#8217;ve been posting a lot of DLL stuff, so I thought i&#8217;d throw a question converning them your way. &nbsp;In a dll made in MSVC with a def file for exporting the functions, I tried renaming the functions, and then other projects dont pick them up through the lib file.<br />
<br />For example:<br />
<br />EXPORT<br />
<br />MC_Dispose=?Dispose@MyClass@@QAEAAV1@XZ</p>
<p>Then when importing the lib into another project, it reports that &quot;?Dispose@MyClass@@QAEAAV1@XZ&quot; is not found.</p>
<p>It would only pick it up if I had named the function &quot;Dispose&quot;.</p>
<p>If you get the urge to email me about it, I can be reached at jeff at dakusan dot com. &nbsp;Otherwise, I hopefully look forward to a blog post on it :).</p>
<p>Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-421213">
				<div id="div-comment-421213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.castledragmire.com' rel='external nofollow' class='url'>Jeffrey Riaboy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-421213">
			September 17, 2006 at 1:49 pm</a>		</div>

		<p>I noticed you&#8217;ve been posting a lot of DLL stuff, so I thought I&#8217;d throw a question concerning them your way. &nbsp;In a DLL made in MSVC with a def file for exporting the functions, I tried renaming the functions, and then other projects don’t pick them up through the lib file.<br />
<br />For example:<br />
<br />EXPORT<br />
<br />MC_Dispose=?Dispose@MyClass@@QAEAAV1@XZ</p>
<p>Then when importing the lib into another project, it reports that &quot;?Dispose@MyClass@@QAEAAV1@XZ&quot; is not found.</p>
<p>It would only pick it up if I had named the function &quot;Dispose&quot;.</p>
<p>If you get the urge to email me about it, I can be reached at jeff at dakusan dot com. &nbsp;Otherwise, I hopefully look forward to a blog post on it :).</p>
<p>Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-421453">
				<div id="div-comment-421453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-421453">
			September 18, 2006 at 12:58 pm</a>		</div>

		<p>Can you explain why the clipboard APIs still require GlobalAlloc and friends?<br />
<br />Why is there not a SetClipboardDataEx or something that does what SetClipboardData does but without needing to call GlobalAlloc?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-421673">
				<div id="div-comment-421673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-421673">
			September 19, 2006 at 7:29 am</a>		</div>

		<p>I&#8217;ve been trying to google this after a discussion here at work &#8230; why is the default date for OLE/ADO &quot;30 Dec 1899&quot;, rather than 1 Jan 1900 (SQL Server origin), 1 Jan 1970 (UNIX epoch).</p>
<p>It seems a strange choice of date &#8211; not at the beginning or end of a year/decade/century, but the day before new-years eve. </p>
<p>Any chance of enlightenment?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422243">
				<div id="div-comment-422243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-422243">
			September 20, 2006 at 5:55 am</a>		</div>

		<p>I would like to mention that sometimes during system start up and heavy CPU load, Shell_NotifyIcon fails without any apparent reason.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422473">
				<div id="div-comment-422473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://pplu_____at______capside.com' rel='external nofollow' class='url'>Pplu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-422473">
			September 21, 2006 at 6:49 am</a>		</div>

		<p>Hi,</p>
<p> &nbsp; Keep up the good work on the blog! It&#8217;s very nice.</p>
<p> &nbsp; When I work in multimonitor mode i have noticed that programs tend to run more slowy.<br />
<br />If I swith to single monitor mode, applications tend to run faster.</p>
<p> I was curious if this is because of windows internal implementation, or its the drivers fault (bad multimonitor implementation). Or am I just a little paranoid all together? How does Windows treat multimonitor mode? </p>
<p> I suspect multimonitor mode is not that mature (or tested by manufacturers). I&#8217;ve seen DirectX Games resize the second monitor on startup (although they execute on the primary monitor). Glitches on my screen when in multimonitor (I suspect of the driver). I think its a great feature, and use it on a daily basis at work, and am curious to know what kwirks and curiosities are behind the multimonitor implementation.</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-423483">
				<div id="div-comment-423483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://cs.usu.edu.ru/home/skrobov/' rel='external nofollow' class='url'>A. Skrobov</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-423483">
			September 24, 2006 at 5:37 am</a>		</div>

		<p>Regarding <a href="http://blogs.msdn.com/oldnewthing/archive/2006/08/31/733521.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/08/31/733521.aspx</a>, why is in imposible to superclass WC_DIALOG?<br />
When I register my own class under this atom, and leave NULL in WNDCLASS.hInstance, Windows fills it in for me.<br />
Then I have two distinct classes registered: (0,WC_DIALOG) and (hMyInstance,WC_DIALOG), and DialogBox functions all use the first one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-424053">
				<div id="div-comment-424053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperBK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-424053">
			September 25, 2006 at 4:01 pm</a>		</div>

		<p>Whats the proper way to add keyboard support to a Dialog box? For example, I have a button called &quot;Add&quot;, that is mapped to a handler called &quot;OnAddRecord&quot;. &nbsp;I want to do the same thing when a user presses &quot;Insert&quot; on the keyboard. What I have been doing is overriding PreTranslateMessage (this is MFC) and then checking if the message is WM_KEYDOWN and if so if the key is VK_INSERT. If all that was TRUE I called my button handler directly? &nbsp;I recently got into trouble when I forgot to return TRUE for PreTranslateMessage to stop further processing. Is there a better way to do this? You will probably say to use a keyboard accellerator, but I find Pretranslate give me finer control by allowing me to check which control has the focus.</p>
<p>Here&#8217;s an example:</p>
<p>BOOL CMyDialogDialog::PreTranslateMessage(MSG* pMsg)<br />
<br />{<br />
<br />    if (pMsg-&gt;message == WM_KEYDOWN)<br />
<br />    {<br />
<br />        switch (pMsg-&gt;wParam)<br />
<br />        {<br />
<br />        case VK_INSERT:<br />
<br />            OnAddRecord();<br />
<br />            return TRUE;    // stop further processing<br />
<br />        case VK_RETURN:<br />
<br />            // check if the list box has the focus then call function<br />
<br />            if (GetFocus() == GetDlgItem(IDC_GRIDCTRL))<br />
<br />            {<br />
<br />                OnModRecord();<br />
<br />                return TRUE;<br />
<br />            }<br />
<br />            break;<br />
<br />        case VK_DELETE:<br />
<br />            OnDeleteRecord();<br />
<br />            return TRUE;    // stop further processing<br />
<br />        case VK_F5:<br />
<br />            OnButtonRefresh();<br />
<br />            return TRUE;    // stop further processing<br />
<br />        default:<br />
<br />            break;<br />
<br />        }<br />
<br />    }<br />
<br />    return CResizableDialog::PreTranslateMessage(pMsg);<br />
<br />}<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-424123">
				<div id="div-comment-424123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kokorozashi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-424123">
			September 25, 2006 at 7:38 pm</a>		</div>

		<p>ShowWindow is documented as ignoring its first parameter the first time it&#8217;s called if GetStartupInfo produces an instance of STARTUPINFO whose dwFlags member has its STARTF_USESHOWWINDOW bit set. In this case, ShowWindow is supposed to behave as if the caller had passed the wShowWindow member of STARTUPINFO. However, I don&#8217;t see this occurring. Despite my verifying the relevant bit is indeed set, ShowWindow seems to happily honor the parameter I pass. What&#8217;s the real story, and, assuming the documentation is out of date, what is the history behind the change?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-424193">
				<div id="div-comment-424193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian Reiter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-424193">
			September 26, 2006 at 1:01 am</a>		</div>

		<p>I&#8217;m interested in a particular oddity of the Windows Explorer task bar tool tips. I&#8217;m not sure when I became aware of this issue, it may be very old and go all the way back to Win95. On every Windows XP and Windows Server 2003 box I have used the tool tips on the task bar buttons and system notification area icons are eventually placed in a z-order behind the task bar itself. They start out normal at the beginning of a session but invariably after a while become unreadable because they pop behind the task bar. I haven&#8217;t been able to figure out why this happens or a way to prevent it from happening except by choosing to disable the standard &#8220;Keep the taskbar on top of other windows&#8221; option, but that has the side effect of having the taskbar not be on top of other windows. The only way to restore normal tool tip behavior is to do &#8220;taskkill /f /im explorer.exe &amp;&amp; start explorer.exe&#8221; or log of and log back on. Nobody has ever been able to provide me with a satisfactory explanation for why this happens. Maybe there&#8217;s an interesting story behind it. Any idea what is going on?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/01/5216600.aspx#415490" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-424223">
				<div id="div-comment-424223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">shankarg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-424223">
			September 26, 2006 at 3:01 am</a>		</div>

		<p>Is there a programmatic way to check for the real microsoft windows?</p>
<p>If I want my program to run only under microsoft windows how do I do that?</p>
<p>Is there any registry key like HKEY_LOCAL_COMPUTERSOFTWAREMicrosoftWindows that can&#8217;t be legally implemented by wine because that would violate microsoft&#8217;s trademarks?</p>
<p>Thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425653">
				<div id="div-comment-425653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wyatt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-425653">
			September 29, 2006 at 9:20 am</a>		</div>

		<p>CreateRemoteThread, how does it work and why is it there/what is it ussed for.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-425833">
				<div id="div-comment-425833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-425833">
			September 29, 2006 at 11:55 am</a>		</div>

		<p>Probably not the right place, but I&#8217;d sure like to know why both the on and offline versions of the MSDN assume I&#8217;m interested in Windows CE. There&#8217;s got to be a way to filter those documents out, no?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427693">
				<div id="div-comment-427693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://xperiencexp.blogspot.com/2006/07/powertoy-calca-strange-error-in.html' rel='external nofollow' class='url'>Eric</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-427693">
			October 5, 2006 at 11:19 am</a>		</div>

		<p>There is an error in the PowerToy Calculator converting miles per hour to feet per hour. Here are details:</p>
<p><a rel="nofollow" target="_new" href="http://xperiencexp.blogspot.com/2006/07/powertoy-calca-strange-error-in.html" rel="nofollow">http://xperiencexp.blogspot.com/2006/07/powertoy-calca-strange-error-in.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-428533">
				<div id="div-comment-428533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-428533">
			October 6, 2006 at 5:50 pm</a>		</div>

		<p>I&#8217;d like to see an in-depth discussion of the use of the shell&#8217;s new Desktop Window Manager (Dwm*) functions in Win32, in non-managed good old-fashioned hard-compiled C code, with an eye towards what it takes to make existing Win32 code &quot;play nicely&quot; with Vista&#8217;s new styles and special effects. &nbsp;There doesn&#8217;t seem to be much documentation or sample code on using these beyond the reference documentation in MSDN, and none of it targets existing unmanaged C code.</p>
<p>Discussion of both the use of these functions as well as best practices would be really helpful for a large class of developers who want to make their existing software look good on Vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428743">
				<div id="div-comment-428743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel Cheng</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-428743">
			October 9, 2006 at 2:58 am</a>		</div>

		<p>I think you may be interested in this&#8230;..</p>
<p>This guy use his psychic power to remove malware and computer virus:</p>
<p><a rel="nofollow" target="_new" href="http://www.clearwisdom.net/emh/articles/2001/12/14/16758.html" rel="nofollow">http://www.clearwisdom.net/emh/articles/2001/12/14/16758.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-429493">
				<div id="div-comment-429493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart van der Werf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-429493">
			October 11, 2006 at 9:19 am</a>		</div>

		<p>I was wondering why UTF8 is not a choice for the ACP in XP ?</p>
<p>It would allow older applications that treat ACP correctly in regards to MCBS to be multilingual.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-429673">
				<div id="div-comment-429673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://levicki.blogspot.com/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-429673">
			October 12, 2006 at 12:41 am</a>		</div>

		<p>Raymond,</p>
<p>I am wondering why the Explorer doesn&#8217;t listen to the user preferences?</p>
<p>For example, I set it to delete files directly instead to Recycle Bin and not to show any confirmation dialog. For one thing, I still get dialog and what is more annoying is that Recycler folder which keeps popping up even though it has no function if I don&#8217;t use the Recycle Bin.</p>
<p>Is there any way to prevent recreating of this folder apart from patching the explorer (or more likely shell32.dll)?</p>
<p>IMO, Recycle Bin config should be located in Control Panel and it should allow the user to remove the icon from desktop when it decides that it doesn&#8217;t want to use its functionality. It should also remove Recycler folders on all drives and stop creating them unless you reactivate the Recycle Bin.</p>
<p>Same goes for System Volume Information. If one doesn&#8217;t use System Restore, Indexing and Shortcut Tracking services then the System Volume Information folder should be a goner too.</p>
<p>I am really interested in your opinion or at least explanation here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tom-kirby-green even thread-even depth-1" id="comment-429703">
				<div id="div-comment-429703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom Kirby-Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-429703">
			October 12, 2006 at 9:33 am</a>		</div>

		<p>I know it&#8217;s deeply untrendy but I&#8217;d like to know why I&#8217;d want to use &#8216;COINIT_DISABLE_OLE1DDE&#8217;. I mention it because I see it used in some sample code over on the shellreleaved.com web site.</p>
<p><a rel="nofollow" target="_new" href="http://shellrevealed.com/files/folders/code_samples/entry4073.aspx" rel="nofollow">http://shellrevealed.com/files/folders/code_samples/entry4073.aspx</a></p>
<p>Is this a flag we should be routinely |&#8217;ing in these days &#8211; assuming we&#8217;re not having to target down stream platforms?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-430393">
				<div id="div-comment-430393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://levicki.blogspot.com/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-430393">
			October 15, 2006 at 6:35 pm</a>		</div>

		<p>Regarding my previous suggestion (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#818292" rel="nofollow">http://blogs.msdn.com/oldnewthing/pages/407234.aspx#818292</a>) &#8212; never mind, I figured it out on my own and I even wrote two articles on my blog:</p>
<p>How to get rid of Recycled and Recycler folders permanently?</p>
<p><a rel="nofollow" target="_new" href="http://levicki.blogspot.com/2006/10/how-to-get-rid-of-recycled-and.html" rel="nofollow">http://levicki.blogspot.com/2006/10/how-to-get-rid-of-recycled-and.html</a></p>
<p>How to get rid of System Volume Information folder permanently?</p>
<p><a rel="nofollow" target="_new" href="http://levicki.blogspot.com/2006/10/how-to-get-rid-of-system-volume.html" rel="nofollow">http://levicki.blogspot.com/2006/10/how-to-get-rid-of-system-volume.html</a></p>
<p>It is an ugly hack but it works until someone in Microsoft decides to implement some way to disable those features in more down to Earth fashion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-430663">
				<div id="div-comment-430663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-430663">
			October 16, 2006 at 1:43 pm</a>		</div>

		<p>There is an article on MSDN about using VirtualAlloc to reserve then commit memory pages. Here is the link: <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/memory/base/reserving_and_committing_memory.asp" target=_new rel=nofollow rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/memory/base/reserving_and_committing_memory.asp</a></p>
<p>The article demonstrates a use of SEH to handle a page fault and then commit the appropriate page at runtime. My question: is SEH being used for performance reasons? I mean alternatively we could write a special allocator function that checks the allocation range and commits new pages when necessary without triggering a page fault. Of course such code would be run for every allocation, whether or not it actually required a new page to be committed.</p>
<p>Can you elaborate?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/larryosterman/archive/2006/10/16/so-when-is-it-ok-to-use-seh.aspx" rel="nofollow">You asked Larry Osterman the same question</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-431233">
				<div id="div-comment-431233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.vacant-nebula.com/' rel='external nofollow' class='url'>kip</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-431233">
			October 17, 2006 at 4:35 pm</a>		</div>

		<p>For most users, 80-90 percent of the time they right click on something it is to subsequently click on Properties. &nbsp;Since double-click of the right mouse button doesn&#8217;t do anything, I&#8217;ve always thought it should open the properties dialog of the object being clicked. &nbsp;I know Alt+double-click does the same thing, as does Alt+Enter&#8230; I&#8217;ve sent this suggestion to Microsoft before, years ago&#8230; maybe I shouldn&#8217;t have posted it here.. if so, sorry I&#8217;ve wasted 30 seconds of your life. :-/</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-432043">
				<div id="div-comment-432043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-432043">
			October 19, 2006 at 10:01 am</a>		</div>

		<p>In a recent blog concerning Vista minimum resolution you said this:</p>
<p>&lt;i&gt;&gt; Sometimes servers are run at 640&#215;480, where you have a rack of them in the datacentre and one shared popup LCD or legacy CRT monitor to work with.</p>
<p>Why would you ever do this? Am I just spoiled by serial consoles that can be run in a quiet office somewhere else?&lt;/i&gt;</p>
<p>I think the answer is .. yes, you are spoiled by them!</p>
<p>Please tell us more about them, what type you use, how you get it going, what tips and pitfalls to watch for, and other &#8216;this is cool and its about time more people were made aware of it&#8217; type things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-432073">
				<div id="div-comment-432073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BhavanaP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-432073">
			October 19, 2006 at 10:21 am</a>		</div>

		<p>Hi,</p>
<p>I am trying to add a query on this site. But i do not get any link where I can post it.</p>
<p>Please Help.</p>
<p>Bhavana.Poladia</p>
<p>Magnet Technologies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-438153">
				<div id="div-comment-438153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MontagFTB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-438153">
			November 1, 2006 at 2:44 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>We have a win32 implementation of a widget factory that includes the creation of the top-level dialog window to which all the children will be bound. However, the attachment of the child widgets to the parent takes place at a time *after* the CreateWindowEx routine has been called. Because of this, we temporarily create the dialog&#8217;s child widgets to an invisible window first. Later we use SetParent to move the widget from the invisible dialog to its final resting place in the visible dialog. However, when we try to process events for the child widget, we find many times that events are still getting sent to the invisible window for the children it used to have, but have since been moved to the visible dialog.</p>
<p>Further investigation reveals this subtle fact: That the parent specified in CreateWindowEx is both the parent of the window and the owner of the window, but when you call SetParent it only sets the parent of the window, not the owner. Thus, some events that need to go to the parent will fetch the &quot;parent&quot; of the window to send certain events (in which case the event goes to the correct [visible] dialog), and others will fetch the &quot;owner&quot; of the window, and the event will go to the wrong [invisible] dialog.</p>
<p>Is there a way to set the owner of a win32 window after it has been created by CreateWindowEx?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-439023">
				<div id="div-comment-439023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://h4ck3r.net/' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-439023">
			November 2, 2006 at 11:27 pm</a>		</div>

		<p>In cmd.exe, with a working directory of &quot;c:abcd&quot;:</p>
<p>&quot;start ..&quot; opens an Explorer window in c:abc, as expected.</p>
<p>&quot;start &#8230;.&quot; however, also opens an Explorer window in c:abc. From then on, adding additional &quot;..&quot; will move back one additional directory. &quot;start &#8230;.&quot;, however (i.e. with the trailing ), always works correctly.</p>
<p>Is this just a boring old bug, or is there some crazy compatibility reason for this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-439173">
				<div id="div-comment-439173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://n/a' rel='external nofollow' class='url'>robroy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-439173">
			November 3, 2006 at 3:08 pm</a>		</div>

		<p>given a menu handle, how do you find out what window(handle) is actually showing the menu and receiving messages from the menu?</p>
<p>and why on earth is the windows menu system so incredibly counterproductive? if implemented properly, it would make it possible to clean up the user interface with unneccessary superflous buttons and visual fluff and actually be a productive and quick way of accessing functions in the user interface without having to move the mouse too much around the screen. this is probably the 1 thing that bugs me the most about windows. help me with my first q and i might be able to help myself! :)</p>
<p>and why is most of the juicy menu messaging and goings-on hidden from developers? if you have a good source of info, please post a link.</p>
<p>ciao</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-439803">
				<div id="div-comment-439803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Iain Heath</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-439803">
			November 6, 2006 at 10:00 pm</a>		</div>

		<p>Hey Raymond, I&#8217;d love to hear your comments on this new thread on the Vista UI forum&#8230;</p>
<p> &nbsp; &nbsp;<a rel="nofollow" target="_new" href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=855446&amp;SiteID=1" rel="nofollow">http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=855446&#038;SiteID=1</a></p>
<p>In short: Why did the Shell team feel it was necessary to tinker with the appearance of combo-boxes in Vista so that CBS_DROPDOWNLIST combos now look like menu pushbuttons, making them inconsistent with how CBS_DROPDOWN combos look (which hasn&#8217;t changed)? What were you guys thinking?!</p>
<p>What techniques can we ISV&#8217;s use to force CBS_DROPDOWNLIST combos in our apps to retain the *proper* look and feel when run on Vista, so that our forms and dialogs don&#8217;t look a mess and our users don&#8217;t freak out.</p>
<p>Is there some magic window style we can slap on combos to get the old look back (but without un-theming them)?</p>
<p>iain</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-441933">
				<div id="div-comment-441933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">erangi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-441933">
			November 13, 2006 at 3:57 am</a>		</div>

		<p>Hello Raymond,</p>
<p>In one of his posts to the Shell: revealed site, Christopher Davis describes the undocumented error messages returned by SHFileOperation. According to the post, the function was written during the pre-win32 era, thus returns codes that are not included in winerror.h. The post contains a list of those codes, which is really great.</p>
<p>In the codes list, two errors have caught my attention: DE_DEST_IS_DVD (0x83) and DE_SRC_IS_DVD (0x87). According to wikipedia, the first DVD players were sold on 1996. The error codes have been there before Win95, i.e. 1995. So, have someone with a great vision anticipated the use of DVDs several years before they were sold? If so, how was this error tested? Or, was this error added to the list later, even though winerror.h was already available? Or is it the post that is wrong?</p>
<p>The post can be found here: <a rel="nofollow" target="_new" href="http://shellrevealed.com/blogs/shellblog/archive/2006/09/11/Common-Questions-Concerning-the-SHFileOperation-API_3A00_-Part-1.aspx" rel="nofollow">http://shellrevealed.com/blogs/shellblog/archive/2006/09/11/Common-Questions-Concerning-the-SHFileOperation-API_3A00_-Part-1.aspx</a></p>
<p>Eran</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443193">
				<div id="div-comment-443193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BrianK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-443193">
			November 16, 2006 at 2:32 pm</a>		</div>

		<p>The history of Sysedit. I noticed that its still in XP. Does anybody really still any 16 bits apps?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-443673">
				<div id="div-comment-443673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Viagra</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-443673">
			November 20, 2006 at 8:18 am</a>		</div>

		<p>Generic Viagra Generic Viagra Generic Viagra Ringtones Ringtones Ringtones</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443883">
				<div id="div-comment-443883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Viagra</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-443883">
			November 20, 2006 at 5:08 pm</a>		</div>

		<p>Generic Viagra Generic Viagra Generic Viagra Credit Cards Credit Cards Credit Cards Ringtones Ringtones Ringtones</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-443923">
				<div id="div-comment-443923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Viagra</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-443923">
			November 20, 2006 at 7:15 pm</a>		</div>

		<p>Generic Viagra Generic Viagra Credit Cards Credit Cards Credit Cards Ringtones Ringtones Ringtones</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444003">
				<div id="div-comment-444003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-444003">
			November 21, 2006 at 4:00 am</a>		</div>

		<p>Hi Raymond!</p>
<p>A topic I am particulary interested in is the naming of controls, how it works&#8230;</p>
<p>-&gt;Every control gets a name from a developer&#8230;via the IDE (e.g btnOK)</p>
<p>When using this function: GetWindowLong(handle,GWL_ID) it doesn&#8217;t return the name itself but mostly a number or nothing.</p>
<p>What is GWL_ID, the documentation isn&#8217;t very clear on this.</p>
<p>How does this whole system work, what are these numbers and where are the &#8216;real&#8217; names?</p>
<p>PS: Thanks for this great site! You do a great job on explaining the topics and keeping it up-to-date!</p>
<p>Best Regards,</p>
<p>Nick</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-444183">
				<div id="div-comment-444183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-444183">
			November 21, 2006 at 2:30 pm</a>		</div>

		<p>Hi</p>
<p>I have signed up for receiving emails when you add new articles (&quot;Send me emails for new posts and articles only&quot;), but i haven&#8217;t received any email so far (you have added several new articles since i&#8217;ve signed up)</p>
<p>What did I do wrong?</p>
<p>TY</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444213">
				<div id="div-comment-444213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-444213">
			November 21, 2006 at 4:23 pm</a>		</div>

		<p>I have a question related to this post:</p>
<p><a href="http://blogs.msdn.com/oldnewthing/archive/2006/11/20/1109012.aspx" target=_new rel=nofollow rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/11/20/1109012.aspx</a></p>
<p>I also asked a similar question in the comment, but this may be worth a blog post.</p>
<p>Okay, here goes:</p>
<p>A lot of your blog commenters are critical of Microsoft&#8217;s efforts to maintain backwards compatibility. &nbsp;Certainly being backwards compatible helps you sell moe copies of Windows.</p>
<p>However, one of the issues that the critics raise is: &#8220;all of this backwards compatibility stuff slows Windows down&#8221;. &nbsp;I can certainly understand that line of reasoning. &nbsp;If every Windows library is filled with checks to see if the calling program is buggy, that can slow down things for every application that calls the library.</p>
<p>So, my suggestion for a topic is this:</p>
<p>1. How much do these backwards compatibility &#8220;hacks&#8221; cost us in terms of CPU cycles and memory? &nbsp;Have you done any profiling on them? &nbsp;If not, what&#8217;s your gut feeling? &nbsp;If you made a version of Windows with all of the &#8220;hacks&#8221; removed, would it be significantly smaller/faster?</p>
<p>2. What kinds of techniques you used (if any) to minimize the negative impacts of these &#8220;hacks&#8221;.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/07/23/4003873.aspx" rel="nofollow">Topic</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-444303">
				<div id="div-comment-444303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nick_journals@hotmail.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-444303">
			November 22, 2006 at 2:09 am</a>		</div>

		<p>Hi Raymond!</p>
<p>A topic I am particulary interested in is the naming of controls, how it works&#8230;</p>
<p>-&gt;Every control gets a name from a developer&#8230;via the IDE (e.g btnOK)</p>
<p>When using this function: GetWindowLong(handle,GWL_ID) it doesn&#8217;t return the name itself but mostly a number or nothing.</p>
<p>What is GWL_ID, the documentation isn&#8217;t very clear on this.</p>
<p>How does this whole system work, what are these numbers and where are the &#8216;real&#8217; names?</p>
<p>Best Regards,</p>
<p>Nick</p>
<p>PS: Thanks for this great site! You do a great job on explaining the topics and keeping it up-to-date!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444973">
				<div id="div-comment-444973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.canoo.com' rel='external nofollow' class='url'>sandra</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-444973">
			November 25, 2006 at 9:19 am</a>		</div>

		<p>General interest topic:</p>
<p>Online German language resource site at <a rel="nofollow" target="_new" href="http://www.canoo.net" rel="nofollow">http://www.canoo.net</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-445823">
				<div id="div-comment-445823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-445823">
			November 28, 2006 at 9:56 am</a>		</div>

		<p>When using a memory mapped file, is all the content that the application has written to the mapped view of the file in memory flushed to disk if the application is then terminated abnormally ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-445913">
				<div id="div-comment-445913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-445913">
			November 28, 2006 at 11:57 am</a>		</div>

		<p>How about something on your blog saying who you are. &nbsp;Apparently you&#8217;re called Raymond, as many comments seem to say, perhaps you&#8217;re really famous &nbsp;and I should already know who you are, but on a quick scan I see no attribution on any post and no &quot;who am I&quot; type link. &nbsp;It would help people like me who stumble upon your blog to decide whether we think it may be worth reading. &nbsp;Perhaps it&#8217;s here somewhere, but it&#8217;s not obvious.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-446563">
				<div id="div-comment-446563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tod weitzel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-446563">
			November 29, 2006 at 3:15 pm</a>		</div>

		<p>Raymond,</p>
<p>One thing I always wondered since most of my day is spent reinstalling XP for one reason or another:</p>
<p>Why does the XP installer always start at an estimate of 39 minutes, then go to 23 minutes (IIRC) after the first reboot? It seems to always use those numbers regardless of the machine it installs on.</p>
<p>I am certain there must be a story behind that, and as your knowledge of windows history is quite voluminous, hopefully you know the answer :)</p>
<p>-t</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449223">
				<div id="div-comment-449223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Pritchard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-449223">
			December 5, 2006 at 3:41 pm</a>		</div>

		<p>Maybe you could shed light on the strange history of the edit control, and one oddity in particular: text alignment. Originally it wasn&#8217;t allowed, then only in multiline edits, now in all edits, but not dynamically, unless you have a language pack installed, in which case there&#8217;s a hook via lpk.dll which adds this special ability (presumably related to right-to-left scripts).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449313">
				<div id="div-comment-449313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.aaronlerch.com/' rel='external nofollow' class='url'>Aaron Lerch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-449313">
			December 5, 2006 at 5:30 pm</a>		</div>

		<p>Can a non-administrator retrieve/evaluate environment variables as they would appear for another user? Admins can scrape the registry (yuck), but if LocalService wanted to periodically clear log files (hypothetically) stored in user-defined paths, can the windows service get the data?</p>
<p>(And yes, I know the natural answer is &quot;why would you do that?&quot; :) )</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451333">
				<div id="div-comment-451333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://vlivviewer.free.fr/vliv.htm' rel='external nofollow' class='url'>Frederic Delhoume</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-451333">
			December 8, 2006 at 4:33 am</a>		</div>

		<p>I have not found a simple example of code that switches an application from windowed to fullscreen, as IE or Irfan Views with Enter key.</p>
<p>So I have come to my own solution, but as it involves reparenting and setting style, I am not sure it is correct in all cases</p>
<p>&lt;verbatim&gt;</p>
<p>BOOL fullscreen = FALSE;</p>
<p>void SwitchFullscreen() {</p>
<p>&nbsp; &nbsp;WINDOWPLACEMENT wplacement;</p>
<p>&nbsp; &nbsp;wplacement.length = sizeof(WINDOWPLACEMENT);</p>
<p>&nbsp; &nbsp;GetWindowPlacement(vlivview, &amp;wplacement );</p>
<p>&nbsp; &nbsp;if (fullscreen == FALSE) {</p>
<pre><code>ShowWindow(mainwindow, SW_HIDE);

SetWindowLong(vlivview, GWL_STYLE, WS_HSCROLL | WS_VSCROLL | WS_CLIPCHILDREN | WS_VISIBLE);

SetParent(vlivview, 0);

wplacement.showCmd = SW_SHOWMAXIMIZED;

SetWindowPlacement(vlivview, &amp;amp;wplacement);

SetWindowPos(vlivview, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE | SWP_FRAMECHANGED); 

fullscreen = TRUE;
</code></pre>
<p>&nbsp; &nbsp;} else {</p>
<pre><code>SetParent(vlivview, mainwindow);

SetWindowLong(vlivview, GWL_STYLE, WS_HSCROLL | WS_VSCROLL | WS_CHILD | WS_CLIPCHILDREN | WS_VISIBLE);

wplacement.showCmd = SW_SHOWNORMAL; 

SetWindowPlacement(vlivview, &amp;amp;wplacement ); 

SetWindowPos(vlivview, 0, 0, 0, 0, 0, SWP_NOMOVE|SWP_NOSIZE|SWP_NOZORDER|SWP_FRAMECHANGED);

ShowWindow(mainwindow, SW_SHOW);

fullscreen = FALSE;
</code></pre>
<p>&nbsp; &nbsp;}</p>
<p>}</p>
<p>&lt;/verbatim&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-451413">
				<div id="div-comment-451413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-451413">
			December 8, 2006 at 8:14 am</a>		</div>

		<p>I always wondered why the wireless dialog asks you to insert your passphrase twice when connecting to a network. Is there an actual point to confirming a passphrase that already exists?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451713">
				<div id="div-comment-451713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BrianK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-451713">
			December 8, 2006 at 6:31 pm</a>		</div>

		<p>Why can&#8217;t programs running in a non-aminstrator account use raw sockets in Windowx XP? If they can, how do you enable it. &nbsp;None of the settings found on the net seem to work,</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-453163">
				<div id="div-comment-453163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-453163">
			December 14, 2006 at 1:08 pm</a>		</div>

		<p>The following code implements a simple keylogger. It prints out everything that is typed on the system to stdout. However the seemingly useless line &#8216;GetKeyState(0);&#8217; is required for it to work. If that is not there the information that GetKeyboardState returns is never updated (and so it loses track of caps lock, etc.). According to the documentation GetKeyboardState is only updated when you remove keyboard messages from your queue. It is supposed to be the same for GetKeyState, so how come calling that function causes the buffer to be updated? Is there some subtlety I have missed or is this an obscure bug?</p>
<p>#include &lt;windows.h&gt;</p>
<p>#include &lt;cstdio&gt;</p>
<p>LRESULT CALLBACK LowLevelKeyboardProc(int nCode, WPARAM wParam, LPARAM lParam) {</p>
<p>if(nCode == HC_ACTION &amp;&amp; wParam == WM_KEYDOWN) {</p>
<p>KBDLLHOOKSTRUCT* key = (KBDLLHOOKSTRUCT*)lParam;</p>
<p>GetKeyState(0);</p>
<p>BYTE keyState[256];</p>
<p>GetKeyboardState(keyState);</p>
<p>WORD chars;</p>
<p>if(ToAscii(key-&gt;vkCode, key-&gt;scanCode, keyState, &amp;chars, 0)) {</p>
<p>if((char)chars == &#8216;r&#8217;) putchar(&#8216;n&#8217;);</p>
<p>else putchar(chars);</p>
<p>}</p>
<p>}</p>
<p>return CallNextHookEx(NULL, nCode, wParam, lParam);</p>
<p>}</p>
<p>int main(int argc, char** argv) {</p>
<p>HHOOK hhk = SetWindowsHookEx(WH_KEYBOARD_LL, LowLevelKeyboardProc, GetModuleHandle(NULL), 0);</p>
<p>MSG msg;</p>
<p>while(GetMessage(&amp;msg, NULL, 0, 0) &gt; 0);</p>
<p>UnhookWindowsHookEx(hhk);</p>
<p>return 0;</p>
<p>}</p>
<div class=post>[<i><a href="http://blogs.msdn.com/michkap/archive/2006/12/20/1332470.aspx" rel="nofollow">Michael Kaplan answers this one</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453303">
				<div id="div-comment-453303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cl&#225;udio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-453303">
			December 15, 2006 at 10:42 am</a>		</div>

		<p>Hi,</p>
<p>(Congrats on the book I will definitely read it)</p>
<p>Could you blog on the deferent techniques supported by windows for reading a file:</p>
<p>(Memory Mapped; Read Async; Read Async NoBuffering)</p>
<p>I’ve been implementing a system that reads a lot files and due to this I’ve been trying to improve the performance of its main task, reading files.</p>
<p>My first choice was Read Async NoBuffering but when I hit the 64Meg consecutive read chunk I changed to the Memory Mapped because I ended up being a simpler implementation.</p>
<p>Although I’m still interested in improving it, and I would like to see your opinion on it! And by the way why is there the 64Meg barrier?</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-453763">
				<div id="div-comment-453763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-453763">
			December 18, 2006 at 9:54 am</a>		</div>

		<p>Why is there no TryEnteryCriticalSection that loops for the spincount specified with InitializeCriticalSectionAndSpinCount</p>
<p>but does not release its timeslice to the OS if it fails to get it while spinning ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455823">
				<div id="div-comment-455823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ashish shah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-455823">
			December 23, 2006 at 12:46 pm</a>		</div>

		<p>Hi,</p>
<p>I am looking for VC++ (win32) sample code for interrupt driven communication with COM port. Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-455833">
				<div id="div-comment-455833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-455833">
			December 23, 2006 at 4:09 pm</a>		</div>

		<p>Windows Media Player (and several other software) insert an entry into the right-click Context menu of explorer. &nbsp;The entry I&#8217;m referring to is &quot;Add to windows media player list&quot;.</p>
<p>Reading the file association documentation in MSDN it tells us that in Windows XP, a new file association interface has been implemented that allows a program to receive a list of multiple files at once using the IDropTarget COM interface.</p>
<p>I haven&#8217;t found any documentation on how this actually works. &nbsp;Must you use an ActiveX DLL that implements this interface, or can this somehow be used directly through my main program&#8217;s EXE file?</p>
<p>I&#8217;m referring to this documentation:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_verbs.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_verbs.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-459373">
				<div id="div-comment-459373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">duggie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-459373">
			January 7, 2007 at 8:12 am</a>		</div>

		<p>In XP, sometimes after I play a game the cursor speed gets messed up. I have found that clicking the Start button fixes it. Why does this work?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-459543">
				<div id="div-comment-459543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johan Alm&#233;n</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-459543">
			January 8, 2007 at 1:00 pm</a>		</div>

		<p>What was the rationale behind the decision to let Excel empty the clipboard when launched?</p>
<p>(Yes, this is an Office question of sorts, but the clipboard is a part of Windows&#8230; &nbsp;;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-460403">
				<div id="div-comment-460403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Really16</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-460403">
			January 11, 2007 at 10:55 pm</a>		</div>

		<p>How 32-bit was win 3.11 when running in protected mode with win32s? Why is 3.11 called 16-bit windows when it required a 32-bit cpu an runned i 32-bit protected mode?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-460583">
				<div id="div-comment-460583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matthew Douglass-Riley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-460583">
			January 14, 2007 at 2:01 pm</a>		</div>

		<p>I&#8217;m curious as to the history and current status of the &quot;What&#8217;s This?&quot; context option in dialog boxes, and the associated button in the title bar. &nbsp;Are new applications in-house still being developed with this feature? &nbsp;What will it / does it look like in Vista?</p>
<p>I ask because it seems to a (very) casual observer that the feature had its time but has since gone out of favor both in and out of Microsoft. &nbsp;I notice it&#8217;s still supported in the Common Dialog library and in (some) Windows Explorer dialogs. &nbsp;One particular counterexample (only for illustrative purposes, not at all an indictment) is the &quot;Choose Details&#8230;&quot; window under &quot;View&quot; in Windows Explorer. &nbsp;It has the button but, at least on Windows XP SP2, has no associated help text for any of the buttons on the right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-460753">
				<div id="div-comment-460753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Merit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-460753">
			January 15, 2007 at 2:18 pm</a>		</div>

		<p>Why can&#8217;t I stretch the windows task bar across multiple monitors? &nbsp;Why don&#8217;t windows maximize to &nbsp;both monitors?</p>
<p>I know there are third party tools to do this, and some drivers have a span mode that presents both monitors as one large screen to Windows, but why isn&#8217;t this built in functionality?</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-461103">
				<div id="div-comment-461103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Filteau</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-461103">
			January 16, 2007 at 8:51 am</a>		</div>

		<p>Hi Raymond,</p>
<p>I just received my copy of your book from Amazon. &nbsp;It&#8217;s great and I&#8217;m having a lot of fun reading it!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-463623">
				<div id="div-comment-463623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sys64738</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-463623">
			January 20, 2007 at 10:44 am</a>		</div>

		<p>I read on Bjarne Stroustrup&#8217;s web site that:</p>
<p>&lt;cite&gt;</p>
<p>Literally everything at Microsoft is built using various flavors of Visual C++ &#8211; mostly 6.0 and 7.0 but we do have a few holdouts still using 5.0 :-(</p>
<p>&lt;/cite&gt;</p>
<p>&lt;<a rel="nofollow" target="_new" href="http://www.research.att.com/~bs/applications.html&gt;" rel="nofollow"></a><a href="http://www.research.att.com/~bs/applications.html&#038;gt" rel="nofollow">http://www.research.att.com/~bs/applications.html&#038;gt</a>;</p>
<p>Is it real that you are still using Visual C++ 6 and 5?</p>
<p>Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-463633">
				<div id="div-comment-463633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sys64738</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-463633">
			January 20, 2007 at 12:08 pm</a>		</div>

		<p>Hi,</p>
<p>Do you think is a good C/C++ programming style to add IN and OUT to</p>
<p>function prototypes? e.g.</p>
<p>void ScrambleString(</p>
<p>&nbsp;IN &nbsp;LPCTSTR str,</p>
<p>&nbsp;IN &nbsp;LPCTSTR key,</p>
<p>&nbsp;OUT LPTSTR &nbsp;outBuffer</p>
<p>);</p>
<p>Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-463743">
				<div id="div-comment-463743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://chester.blog.br' rel='external nofollow' class='url'>Chester</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-463743">
			January 21, 2007 at 10:53 pm</a>		</div>

		<p>Hi, Raymond! First of all, thank you for the great work you have been doing on your blog &#8211; it&#8217;s amazing to have so many things (historical and technical) explained by an insider.</p>
<p>I would like to inquire if you can clarify the reason that makes so many people receive the &quot;Are you sure you want to delete &#8216;WINDOWS&#8217;&quot; message when there is something wrong with their Recycle Bins (ex.: <a rel="nofollow" target="_new" href="http://www.herrodius.com/blog/?p=46" rel="nofollow">http://www.herrodius.com/blog/?p=46</a>, but you can find dozens more by searching for &quot;are you sure you want to delete windows&quot;).</p>
<p>I know that it&#8217;s a shell functionality, not directly related to kernel stuff, but maybe there is some interesting aspect (i.e., &quot;old new thing material&quot;) that can be highlighted by investigating this curioius (from an user standpoint) behavior &#8211; just a guess.</p>
<p>Thank you and have a nice day!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-464543">
				<div id="div-comment-464543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hardcode.ro' rel='external nofollow' class='url'>Andrei</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-464543">
			January 24, 2007 at 5:00 am</a>		</div>

		<p>Hi Raymond!</p>
<p>I couldn&#8217;t find any useful resource for the radio buttons bug that happens when I try to make them (the text) transparent using WM_CTLCOLORSTATIC: instead of the radio button now there&#8217;s a black background.</p>
<p>Please shed some light on this.</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-465923">
				<div id="div-comment-465923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-465923">
			January 28, 2007 at 2:53 am</a>		</div>

		<p>We&#8217;ve been able to drop files on the command prompt to paste their paths for as long as I can remember. (Something you mentioned back in 2003, as it happens: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/11/24/55833.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/11/24/55833.aspx</a>)</p>
<p>This was really handy but in Vista it seems to be gone. The command prompt is no longer a drop target.</p>
<p>Why is this? Is there a way to turn it back on? If it&#8217;s a security feature, couldn&#8217;t drops have remained enabled for non-admin prompts, at least?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-466443">
				<div id="div-comment-466443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cory</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-466443">
			January 30, 2007 at 4:39 pm</a>		</div>

		<p>Great work!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-466453">
				<div id="div-comment-466453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-466453">
			January 30, 2007 at 4:40 pm</a>		</div>

		<p>Well done!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-466463">
				<div id="div-comment-466463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-466463">
			January 30, 2007 at 4:40 pm</a>		</div>

		<p>Well done!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-466573">
				<div id="div-comment-466573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-466573">
			January 31, 2007 at 12:19 am</a>		</div>

		<p>What were the MFC 2.53 that John Elliott mentioned in one of his blog comments in this blog entry:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/01/06/510066.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/01/06/510066.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-466603">
				<div id="div-comment-466603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">performance-guy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-466603">
			January 31, 2007 at 9:29 am</a>		</div>

		<p>Care to do one more on PAE and 3GB? In particular, how it interacts with LargeSystemCache?</p>
<p>I am building a dedicated file server. The hardware has 4 GB of memory, so of course we have PAE enabled so that the available mem is 4,193,296 rather than 3,538,128.</p>
<p>The reason for this amount of memory is for caching, so of course I have LargeSystemCache enabled. The docs would lead one to expect 4,012,744 K for caching (max memory less 172 MB for the kernel and 4 MB).</p>
<p>However, of course, this is more than the 2 GB available for user mode. So, the most the system will cache is 2,097,068 (according to NtQuerySystemInformation). The only way I see to get 4,012,744 is by enabling 3GB.</p>
<p>This, of course, presents a problem because now both PAE and 3GB are enabled, conflicting with each other.</p>
<p>Is there a good way out? Or should I simply settle for a 2 GB NTFS-CIFS cache?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-468063">
				<div id="div-comment-468063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-468063">
			February 2, 2007 at 9:36 pm</a>		</div>

		<p>I apologize for posting this off-topic in another area of your blog. &nbsp;But I&#8217;m just about at my wits end and desperate for anyone who can possibly figure it out.</p>
<p>I just recently noticed that one of my XP machines i acting in a very frustrating manner. Normally, if you minimize an application and then press alt-tab, that application is the last one on the list. This has been the behavior forever and still is on my laptop. However, on my desktop it now puts the minimized app in SECOND position. This means if I minimize an app and hit alt-tab, I&#8217;m back at the minimized app. Turns out to be a very useless way of doing things. I&#8217;ve found several other unanswered reports in usenet and on blogs from other people with the same problem. I also have another person at my office so afflicted.</p>
<p>I&#8217;m only referring to WELL-BEHAVED applications. &nbsp;This happens even if the test windows are just notepad and calc windows. &nbsp;These aren&#8217;t special topmost ones or anything else.</p>
<p>Does anyone know if there&#8217;s setting I obliviously tweaked that screwed me over? Any idea how to fix this problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-468373">
				<div id="div-comment-468373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-468373">
			February 4, 2007 at 10:35 am</a>		</div>

		<p>I just recently noticed that one of my XP machines i acting in a very frustrating manner. Normally, if you minimize an application and then press alt-tab, that application is the last one on the list. This has been the behavior forever and still is on my laptop. However, on my desktop it now puts the minimized app in SECOND position. This means if I minimize an app and hit alt-tab, I&#8217;m back at the minimized app. Turns out to be a very useless way of doing things. I&#8217;ve found several other unanswered reports in usenet and on blogs from other people with the same problem. I also have another person at my office so afflicted. Nothing is different service pack wise or anything else. &nbsp;Does anyone know if there&#8217;s setting I obliviously tweaked that screwed me over? Any idea how to fix this problem?</p>
<p>I&#8217;m only referring to WELL-BEHAVED applications. &nbsp;This happens even if the test windows are just notepad and calc windows. &nbsp;These aren&#8217;t special topmost ones or anything else.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-468503">
				<div id="div-comment-468503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-468503">
			February 5, 2007 at 5:54 am</a>		</div>

		<p>In Windows XP, synchronizing the clock when your date is set incorrectly fails citing a security risk:</p>
<p>&quot;An error occurred while Windows was synchronizing with time.windows.com. For security reasons, Windows cannot synchronize with the server because your date does not match. Please fix the date and try again.&quot;</p>
<p>I&#8217;m interested to hear what this security risk is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-468723">
				<div id="div-comment-468723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert May</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-468723">
			February 5, 2007 at 12:54 pm</a>		</div>

		<p>Is there any good reason that a groupbox is implemented as part of the &quot;Button&quot; class rather than part of the &quot;Static&quot; class.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-468733">
				<div id="div-comment-468733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert May</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-468733">
			February 5, 2007 at 12:57 pm</a>		</div>

		<p>Is there any penalty to pay for using WS_CLIPSIBLINGS when the sibling windows are not overlapping?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-469733">
				<div id="div-comment-469733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://xenon.arcticus.com' rel='external nofollow' class='url'>Chris 'Xenon' Hanson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-469733">
			February 6, 2007 at 1:03 pm</a>		</div>

		<p>How about a reminder that while most widget classes work fine by toggling their WS_DISABLED style with SetWindowLong(), Edit controls in particular won&#8217;t change their visual state unless they are altered via EnableWindow(). Edit controls <em>act</em> disabled, but don&#8217;t <em>look</em> disabled. I suspect it has to do with EnableWindow() sending WM_ENABLE and SetWindowLong() not doing so, but it can trap people who aren&#8217;t paying attention.</p>
<p>I think I filed a suggestion on MSDN2.microsoft.com&#8217;s suggestion box to advise people not to fiddle with the WS_DISABLED flag at runtime via SetWindowLong() since it seems like a viable route if you don&#8217;t know otherwise.</p>
<p>Here&#8217;s someone else who ran into it:</p>
<p><a rel="nofollow" target="_new" href="http://www.codeguru.com/forum/showthread.php?t=55945" rel="nofollow">http://www.codeguru.com/forum/showthread.php?t=55945</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-470543">
				<div id="div-comment-470543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J-F</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-470543">
			February 7, 2007 at 3:15 pm</a>		</div>

		<p>A friend was asking why non-admin in XP could be easier, such as installers automatically prompting for admin credential (even I forget to do Run as manually, many times). I found out even any file can be renamed to &quot;setup.exe&quot; and it will bring up the &quot;Install program as other user&quot; dialog.</p>
<p>What reason was it made that only files name &quot;setup.exe&quot; brought up a Run as dialog, and isn&#8217;t there any code or API to do with without naming it &quot;setup.exe&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-470783">
				<div id="div-comment-470783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-470783">
			February 8, 2007 at 1:24 am</a>		</div>

		<p>Do you know that the Novell behavior described in &quot;Not all short filenames contain a tilde&quot; came from HPFS? The LONG namespace in NetWare originally were called the OS2 namespace, and so it emulated HPFS. It was only renamed to the the LONG namespace because the Windows 95 client used the OS2 namespace to support LFNs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-471243">
				<div id="div-comment-471243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">powerbib@hotmail.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-471243">
			February 9, 2007 at 9:44 pm</a>		</div>

		<p>Hello Raymond,</p>
<p>I made an application which creates a splash screen on a secondary thread while the main thread loads data. I create and then destroy this splash screen window just before creating and displaying the main window.</p>
<p>I noticed that my main window is not shown correctly after destroying the splash window. I noticed that the app kind of looses the &#8216;foreground&#8217; and is actually shown behind other windows. I went throught the MSDN doc and found that calling SetForegroundWindow() makes it work. If I comment out the code for the splash screen creation/destruction, the main window is always shown correctly.</p>
<p>Is there an explanation for this behavior?</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-472093">
				<div id="div-comment-472093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-472093">
			February 14, 2007 at 12:11 pm</a>		</div>

		<p>Can you give a time ? I investigated the partition type for FAT32 on MBR (Master Boot Record, located on sector 0 of disk). &nbsp;Some partition set it to 0x0C but, some one set it to 0x0B. The ResKit for XP describes why two values exists, supporting for BIOS INT 13h extension for 0x0C. however, other document, for example, BSD OS, describes supporting CHS for 0x0B, LBA for 0x0C. Furture more, Windows 95 picks 0x0C for some removable disk when formatting, while Windows XP set 0x0B for them. &nbsp;what reason does exist in behind of these curious two partition type values and behavior ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-472343">
				<div id="div-comment-472343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Achaemenes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-472343">
			February 15, 2007 at 11:06 am</a>		</div>

		<p>Hello! &nbsp;It is interestig site. Keep working!</p>
<p>soma 350</p>
<p>cheap soma</p>
<p>cheap phone cards</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-472353">
				<div id="div-comment-472353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Achates</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-472353">
			February 15, 2007 at 11:06 am</a>		</div>

		<p>Hello! &nbsp;It is interestig site. Keep working!</p>
<p>soma 350</p>
<p>cheap soma</p>
<p>cheap phone cards</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-472533">
				<div id="div-comment-472533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Francisco Moraes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-472533">
			February 15, 2007 at 4:30 pm</a>		</div>

		<p>Hello, Raymon.</p>
<p>I am trying to connect to a remote computer from a service with WNetAddConnection2W. It works if I run the code from the command line or if the service logs in as a user. When running under the LocalSystem account, the WNetAddConnection2W returns the error ERROR_NO_SUCH_LOGON_SESSION.</p>
<p>I guess the problem is that LocalSystem doesn&#8217;t really have a full account on the system and that&#8217;s causing the failure as I know that the user/password supplied are correct.</p>
<p>Francisco</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-472633">
				<div id="div-comment-472633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Accius</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-472633">
			February 16, 2007 at 1:15 am</a>		</div>

		<p>Hello! &nbsp;It is interestig site. Keep working!</p>
<p>soma 350</p>
<p>cheap soma</p>
<p>cheap phone cards</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-473273">
				<div id="div-comment-473273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">winhelp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-473273">
			February 16, 2007 at 8:03 pm</a>		</div>

		<p>I&#8217;d love to know why winhelp.exe has disappeared from Vista: there are plenty of applications still using it, and in 32-bit Vista there&#8217;s still support for 16-bit applications where it&#8217;s the only option. (Plus some applications prefer to use it to stay compatible with Windows 95).</p>
<p>What really strikes me it that Vista&#8217;s installation size is about 5 GB, and all-winhelp-related stuff if less then 1 MB. It&#8217;s not a component that is loaded permanently, it&#8217;s not kernel mode, it&#8217;s not a liability, it wouldn&#8217;t cause &quot;support cost&quot;. Enlighten me on the reasons for its removal, please :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-473333">
				<div id="div-comment-473333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Markello</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-473333">
			February 17, 2007 at 2:33 pm</a>		</div>

		<p>Thank you.nice site! orderpaxil</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-473363">
				<div id="div-comment-473363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">properdon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-473363">
			February 17, 2007 at 7:21 pm</a>		</div>

		<p>Thank you.nice site! paxil tankless preventive</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-473463">
				<div id="div-comment-473463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-473463">
			February 18, 2007 at 9:05 pm</a>		</div>

		<p>Very useful and interesting site, thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-473713">
				<div id="div-comment-473713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.messagingreminder.com/' rel='external nofollow' class='url'>MattCho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-473713">
			February 19, 2007 at 4:32 pm</a>		</div>

		<p>What about an overview of the AVICAP*.dll? &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-473743">
				<div id="div-comment-473743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-473743">
			February 19, 2007 at 5:44 pm</a>		</div>

		<p>In XP and 2000, if you run as non-admin and run a file specifically named &quot;setup.exe&quot;, it will bring up the Run as dialog. I thought there was an API to bring up that dialog in case non-admin users wanted to install a program, so it would automatically prompt.</p>
<p>But it turns out that dialog only appears because of the fact that a file is named &quot;setup.exe&quot;. Even a blank text file renamed to setup.exe would trigger it. Do you know anything behind this design quirk?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474763">
				<div id="div-comment-474763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">//@</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-474763">
			February 22, 2007 at 7:34 am</a>		</div>

		<p>How about you guys fix the toolbar bugs and its ability to lock menu and/or the app.</p>
<p>As the simplest example, set your mouse over a toolbar button, right click and hold it, left click, move over to another button and keep holding that right button, left click on another button etc.. Do you see it?</p>
<p>Try this on IE or WordPad or many other apps such as winzip, your apps, your cousin&#8217;s apps, chose your lick :).</p>
<p>In most cases you will be very lucky to have the menu available but in some instances you must change focus to another app to get your command bar back.</p>
<p>Guess what? Office and VS.NET don&#8217;t have this problem mostly because they popup a context menu or similar but still:</p>
<p>My OS and I feel pretty embarassed about this feature, for a long time now.</p>
<p>M _</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475043">
				<div id="div-comment-475043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy Visser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-475043">
			February 22, 2007 at 12:59 pm</a>		</div>

		<p>On LockWindowUpdate. &nbsp;I&#8217;ve found that the start bar seems to behave like it may be using this call incorrectly. &nbsp;I put my start bar on the left hand side of the screen. &nbsp;When I try to resize the bar (dragging its edge left and right), the system tray will dynamically move icons (based on tray width), seemingly disregarding the lock. &nbsp;The rest of the bar waits until MouseUp to redraw.</p>
<p>What gives?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475823">
				<div id="div-comment-475823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-475823">
			February 23, 2007 at 5:58 pm</a>		</div>

		<p>Why not implement delay-loading by having a flag in the import entry</p>
<p>specifying that Windows should mimic the Windows 3.1 behavior for</p>
<p>resolving that import?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-476193">
				<div id="div-comment-476193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Twisted Combo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-476193">
			February 26, 2007 at 3:19 am</a>		</div>

		<p>I read this article, how to set the combobox height.</p>
<p><a rel="nofollow" target="_new" href="https://blogs.msdn.com/oldnewthing/archive/2006/03/10/548537.aspx" rel="nofollow">https://blogs.msdn.com/oldnewthing/archive/2006/03/10/548537.aspx</a></p>
<p>But how do I *get* the dropped down height?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-476603">
				<div id="div-comment-476603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sahab Yazdani</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-476603">
			February 26, 2007 at 3:34 pm</a>		</div>

		<p>I was wondering why a Console Window doesn&#8217;t get visual styles like other Windows. In Windows XP, all other windows will have a Luna style border (or Royale in MCE), but the Console Windows (cmd.exe, command.com, Application Consoles, etc.) will have Windows classic borders. I believe this has been a happening since Windows 95 (i.e. if you use WindowBlinds on a Win95 &#8211; WinXP system, it will be able to take control of drawing for all windows except consoles). Not sure about the behaviour under 2003 and Vista since I haven&#8217;t used those ones yet.</p>
<p>Or maybe a deeper question: Why can&#8217;t Console Windows be hooked using the SetWindowsHookEx and family of functions?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-477043">
				<div id="div-comment-477043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arno Schoedl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-477043">
			February 27, 2007 at 5:53 am</a>		</div>

		<p>Just a little OT, but given all the problems with backward compatibility Microsoft is facing, could not a lot of it be solved by simply declaring (via manifest?) the earliest and latest version of Windows a program has been tested to run on? I understand that there are a few redistributables which have separate versioning, but the Windows version certainly covers the largest part of API differences. Windows could then change its behavior according to what the application expects, and Microsoft would be freeer to change things around in new versions, because the new stuff does not have to seamlessly fit with the old stuff. I recently had a case where obviously a feature, which I now happen to need, has not been fully implemented out of fear of breaking old code, a fact confirmed by the MS developer who did the feature.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-477373">
				<div id="div-comment-477373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Unknown' rel='external nofollow' class='url'>Unknown</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-477373">
			February 27, 2007 at 7:54 pm</a>		</div>

		<p>Hello! &nbsp;It is informative interesting site!</p>
<p>carisoprodol cheapes</p>
<p>carisoprodol discount</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-477383">
				<div id="div-comment-477383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Unknown' rel='external nofollow' class='url'>Unknown</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-477383">
			February 27, 2007 at 7:54 pm</a>		</div>

		<p>Hello! &nbsp;It is informative interesting site!</p>
<p>carisoprodol cheapest</p>
<p>carisoprodol discount</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-477973">
				<div id="div-comment-477973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">...</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-477973">
			March 1, 2007 at 5:56 am</a>		</div>

		<p>Very nice site! Good work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478363">
				<div id="div-comment-478363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-478363">
			March 1, 2007 at 2:06 pm</a>		</div>

		<p>Tell us more about the Archive of Computers that you mentioned in the story on the dead Alpha server</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478683">
				<div id="div-comment-478683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dirk Declercq</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-478683">
			March 2, 2007 at 4:53 am</a>		</div>

		<p>Can you explain what&#8217;s the (historical) reason</p>
<p>that the origin of a client-area (default without transforamtion) is at the upper-left corner and not at the lower-left corner ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479583">
				<div id="div-comment-479583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-479583">
			March 5, 2007 at 6:11 pm</a>		</div>

		<p>Can you explain the reason why the &quot;hide file extensions for known file types&quot; setting exists (and is still turned on by default, even now)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479783">
				<div id="div-comment-479783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dean Earley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-479783">
			March 6, 2007 at 7:50 am</a>		</div>

		<p>Why is there a &quot;current directory&quot; AND an current drive?</p>
<p>Why not merge them?</p>
<p>I have to set both the dir and drive if i want a specific working dir.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484113">
				<div id="div-comment-484113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Unknown' rel='external nofollow' class='url'>Unknown</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-484113">
			March 20, 2007 at 8:25 pm</a>		</div>

		<p>Hello! &nbsp;It is nice, interesting site!</p>
<p>abc internet tv</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-485663">
				<div id="div-comment-485663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CreateProcessEx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-485663">
			March 26, 2007 at 8:53 am</a>		</div>

		<p>What is &quot;CreateProcessEx()&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-485783">
				<div id="div-comment-485783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.cwcsoftware.com' rel='external nofollow' class='url'>Jeff Bean</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-485783">
			March 26, 2007 at 2:44 pm</a>		</div>

		<p>On the Page Setup common dialog the Printer button is hidden on Windows Vista. I am referring to the button that appeared on the bottom right of the page setup dialog in earlier versions of Windows &#8212; see this URL in the MSDN library: <a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/ms646962.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/ms646962.aspx</a></p>
<p>Why was the button hidden?</p>
<p>The Page Setup dialog isn&#8217;t used by a lot of applications &#8212; most use the Printer Setup dialog instead. But it is used by Wordpad and by my application of course (otherwise I wouldn&#8217;t be writing this).</p>
<p>The button wasn&#8217;t actually removed, just hidden. They forgot to remove the ampersand from the button text when they hid it, so you can actually still operate the hidden button by entering Alt-P.</p>
<p>My application has a customized version of the Page Setup dialog. I used a customized dialog because I needed to add two or three new controls and also needed to remember the margin settings for more printers than just the default printer. With the printer button gone, the user is no longer able to set the margins for anything but the default printer. I was able to work around this by creating a second Printer button with a different control ID that is placed exactly underneath the normal Printer button in our customized dialog. When Vista hides the normal Printer button my second button is revealed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-485863">
				<div id="div-comment-485863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.surfulater.com' rel='external nofollow' class='url'>Neville Franks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-485863">
			March 26, 2007 at 8:39 pm</a>		</div>

		<p>I&#8217;m doing a lot of work on multiple selection in a tree and have noticed that ctrl+click and shift+click behave differently in the MS Tree Control and Windows Explorer.</p>
<p>Shift takes affect on left button down whereas Ctrl takes affect on left button up. Further Ctrl takes affect if you start a drag operation. That is, it behaves as if left button up occurred.</p>
<p>I&#8217;m curious if there is a particular reason for the difference in behaviour here and if I should be emulating this in my custom written tree control.</p>
<p>I&#8217;ve looked in my somewhat dated &quot;The Windows Interface&quot; guidelines book and others and so far haven&#8217;t found anything helpful re. multiple selection.</p>
<p>PS. Thoroughly enjoyed the Podcast with Scott Hanselman.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-486523">
				<div id="div-comment-486523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-486523">
			March 28, 2007 at 1:43 am</a>		</div>

		<p>I&#8217;m going to ask a bunch of questions here, but I think each one is valid. &nbsp;I can&#8217;t find any of the answers in MSDN, and even an answer to one doesn&#8217;t make answers to others obvious.</p>
<p>Unless failures occur, the DialogBox function doesn&#8217;t return until the new dialog&#8217;s DialogProc calls EndDialog. &nbsp;It starts its own message loop. &nbsp;During this time the hwndParent (i.e. owner not parent) window is disabled. &nbsp;However, disabling doesn&#8217;t prevent delivery of some kinds of messages to the parent window&#8217;s WindowProc or DialogProc, and doesn&#8217;t prevent delivery of any messages to the application&#8217;s main message loop, right? &nbsp;So aren&#8217;t there two or more message loops running in parallel?</p>
<p>If the application&#8217;s main message loop gets a message, calls IsDialogMessage, and gets TRUE back, then the result is the same as if the dialog&#8217;s message loop got the message and handled it, right? &nbsp;Well, sometimes, right?</p>
<p>Now, suppose the application&#8217;s main message loop calls GetMessage and/or PeekMessage with different parameters than a dialog&#8217;s message loop does. &nbsp;Then won&#8217;t the results sometimes be scrambled?</p>
<p>Can we know if a dialog&#8217;s message loop gets WM_TIMER messages? &nbsp;I can&#8217;t find the answer to this in MSDN. &nbsp;If the application&#8217;s main message loop calls GetMessage to pick off WM_TIMER and calls IsDialogMessage, but the dialog&#8217;s message loop does things differently, can&#8217;t the results get scrambled? &nbsp;Now sure there are better ways to do timers, such as CreateWaitableTimer if we don&#8217;t have to run on Windows CE, but the example still stands.</p>
<p>When a DialogProc calls DialogBox, as far as I can tell, all three message loops (main, first dialog, and second dialog) might all get some kinds of messages. &nbsp;So doesn&#8217;t the first DialogProc have to call IsDialogMessage to find out if the message really belonged to the second dialog?</p>
<p>Can the first DialogProc call GetMessage to pick off WM_TIMER, call IsDialogMessage to let the second dialog handle it but ignore (or maybe act on) the result, and then finally handle the message that the first dialog&#8217;s message loop handed to it in the parameters to DialogProc?</p>
<p>MSDN states what these APIs do and I am not handing invalid parameters to them, so these are not relying on undocumented behaviour. &nbsp;But these stunts smell pretty bad and I&#8217;m not sure they&#8217;re relying on documented behaviour either. &nbsp;MSDN doesn&#8217;t say yes and doesn&#8217;t say no.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491223">
				<div id="div-comment-491223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Courtney Mewton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-491223">
			April 9, 2007 at 6:27 pm</a>		</div>

		<p>One thing I have always been curious about is the titlebar of the command prompt in XP. &nbsp;It seems that the icon folks updated the command prompt icon in Windows XP to have the newer luna-theme titlebar and red &#8220;close&#8221; button, but the actual titlebar used by the program is different to the XP &#8220;luna&#8221; titlebar. &nbsp;Is there an interesting tale to tell behind the command prompt titlebar?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#454412" rel="nofollow">Dup</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493013">
				<div id="div-comment-493013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">littleguru</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-493013">
			April 14, 2007 at 1:55 pm</a>		</div>

		<p>Why does the End Now button (that&#8217;s in the dialog that&#8217;s shown on an application that Windows thinks it&#8217;s hung) not kill the process immediately?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-494513">
				<div id="div-comment-494513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=849112&#038;SiteID=1' rel='external nofollow' class='url'>ac</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-494513">
			April 17, 2007 at 9:20 pm</a>		</div>

		<p>Why was context help (aka &quot;Whats this?&quot;) removed from vista, this was a very useful feature</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-494923">
				<div id="div-comment-494923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frank Jacobs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-494923">
			April 18, 2007 at 2:40 pm</a>		</div>

		<p>I would like to suggest a topic on Windows &quot;low-level console I/O.&quot; Specifically, I&#8217;m curious about the lack of an API for listening to low-level console I/O events such as user input or characters written to the screen.</p>
<p>For example, it is difficult to write a Command Prompt replacement since there appears to be no way to receive these events. The SourceForge project Console (<a rel="nofollow" target="_new" href="http://sourceforge.net/projects/console/" rel="nofollow">http://sourceforge.net/projects/console/</a>) has gotten around this problem by using a polling technique. This technique appears to be the only option if one wishes to implement a Command Prompt replacement. However, polling won&#8217;t always work reliably if the events come in significantly more quickly then the one&#8217;s polling interval. Being able to listen for these events instead of having to poll would be more reliable.</p>
<p>If you have any comments, insight, or history on &nbsp;Windows low-level console I/O, I&#8217;d love to hear it. Thanks so much for your daily posts &#8212; it is something to look forward to every day!</p>
<p>More discussion on what I&#8217;m talking about can be found here: <a rel="nofollow" target="_new" href="http://homepages.tesco.net/~J.deBoynePollard/FGA/capture-console-win32.html" rel="nofollow">http://homepages.tesco.net/~J.deBoynePollard/FGA/capture-console-win32.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-498333">
				<div id="div-comment-498333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://netnerds.net' rel='external nofollow' class='url'>Chrissy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-498333">
			May 1, 2007 at 7:26 pm</a>		</div>

		<p>Hello Raymond,</p>
<p>I just read your article titled &quot;Determining what is frequently used&quot; in TechNet magazine. I have observed what seems to be a bias towards Microsoft products, especially in older versions of Windows. Can you confirm one way or the other?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-498343">
				<div id="div-comment-498343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://junkmail@mdxi.com' rel='external nofollow' class='url'>Jim Mack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-498343">
			May 1, 2007 at 8:02 pm</a>		</div>

		<p>How about a non-Windows &#8212; but still geekish &#8212; question or two?</p>
<p>What do international dialing codes (you know, like +44 for UK) have to do with Huffman coding?</p>
<p>In a similar vein, the original US telephone area codes were partly assigned so as to keep similar (confusable) codes from serving adjacent areas. &nbsp;But some of the codes have an additional assignment property which has since been rendered obsolete. Once you know what it is, it&#8217;s obvious what rendered it obsolete.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-498513">
				<div id="div-comment-498513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-498513">
			May 2, 2007 at 10:41 am</a>		</div>

		<p>Is there a way to change the behavior of the CMD.EXE window? I don&#8217;t know if this falls under your &quot;shell&quot; category. I would like to add a status line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-499963">
				<div id="div-comment-499963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">webcyote</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-499963">
			May 4, 2007 at 7:11 pm</a>		</div>

		<p>In &quot;Dynamic Link Library Data&quot; (<a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/ms682594.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/ms682594.aspx</a>) there&#8217;s a note at the bottom that says __declspec(thread) fails when using LoadLibrary unless you&#8217;re running Vista. Vista &quot;fixes&quot; __declspec(thread) by giving each DLL its own copies of TLS variables declared using __declspec(thread), whereas 95/NT4/2000/XP/2003 share all variables (that is, the EXE and all DLL files get only one shared set instead of each having their own set). Programs that depend upon the old behavior will break in Vista; what happened to backward compatibility?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-500953">
				<div id="div-comment-500953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WikiServerGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-500953">
			May 8, 2007 at 4:50 am</a>		</div>

		<p>@Norman Diamond</p>
<p>Well, I try to answer a couple&#8230;</p>
<blockquote><p>
  So aren&#8217;t there two or more message loops running in parallel?
</p></blockquote>
<p>From my understanding, just the one DialogBox uses. I.E. it is blocking and no other message loops are running.</p>
<blockquote><p>
  If the application&#8217;s main message loop gets a message, calls IsDialogMessage, and gets TRUE back, then the result is the same as if the dialog&#8217;s message loop got the message and handled it, right? &nbsp;Well, sometimes, right?
</p></blockquote>
<p>Except the DialogBox loop doesn&#8217;t call IsDialogMessage for your own dialogs &#8211; it is a known issue that are articles for. Generally you need to setup a windows hook and call IsDialogMessage there for your own dialogs if you are going to show more than one top-level one so that they can handle tab key entries etc.</p>
<p>@James Risto</p>
<p>Here are couple links that probably answer your question:</p>
<p><a rel="nofollow" target="_new" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true" rel="nofollow">http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true</a></p>
<p>(This one seems to be down, but you can still see the google cache for it etc.)</p>
<p>obieda.com/blog/2007/03/29/making-cmdexe-act-more-like-a-linux-shell/</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-500963">
				<div id="div-comment-500963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WikiServerGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-500963">
			May 8, 2007 at 4:55 am</a>		</div>

		<p>@Myself</p>
<blockquote><p>
  Except the DialogBox loop doesn&#8217;t call IsDialogMessage for your own dialogs
</p></blockquote>
<p>I meant except for the DialogBox uses of course :). Applies to MessageBox etc. as well&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-501033">
				<div id="div-comment-501033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-501033">
			May 8, 2007 at 6:47 am</a>		</div>

		<p>Raymond, could you shed some light on Get/SetMessageExtraInfo? It&#8217;s almost like nobody on earth used them, ever, and I can&#8217;t get some sample code</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-501653">
				<div id="div-comment-501653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-501653">
			May 8, 2007 at 4:50 pm</a>		</div>

		<p>Regarding IsBadReadPtr and IsBadWritePtr: I jsut read this:</p>
<p>&quot;In earlier Windows versions, the IsBadReadPtr and IsBadWritePtr functions were used to validate parameters. These functions are now banned on Windows Vista and Windows Server Codename &quot;Longhorn.&quot;</p>
<p>Also, applications that rely on Windows components using these functions to validate parameters will find that Windows no longer uses them.</p>
<p>Applications should not rely on Windows to do any parameter validation (a check for null is done and the application fails if it is a bad pointer).&quot;</p>
<p>From <a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/aa480152.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/aa480152.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-502363">
				<div id="div-comment-502363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Greg Williams</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-502363">
			May 9, 2007 at 6:24 pm</a>		</div>

		<p>I&#8217;m curious about using TrackMouseEvent for hover tracking while responding to a DoDragDrop interactions in a TreeView. &nbsp;My suspicion is that DoDragDrop monopolizes the window so that a WM_MOUSEHOVER message is never posted, so it won&#8217;t end up being useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-502843">
				<div id="div-comment-502843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nektar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-502843">
			May 10, 2007 at 12:10 pm</a>		</div>

		<p>Could you comment on how the remaining time displayed to the user when performing a file operation in Explorer, e.g. copying, is calculated and why many times it seems to me to be unreliable, i.e. the time jumps from 5 mins to 30 secs and back to 2 mins and it is usually wrong?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2004/01/06/47937.aspx" rel="nofollow">Old topic</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503253">
				<div id="div-comment-503253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tanveer Badar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-503253">
			May 11, 2007 at 7:51 am</a>		</div>

		<p>I have two questions.</p>
<p>This one has already been asked. Why does &quot;hide file extensions for known file types&quot; exist in the first place? I have seen many people (both users and dumb programmers) bitten by this when they try to open the file they see without any extension?</p>
<p>Secondly, file/directory property dialog has an advanced button, on that dialog there are two check boxes if the file system is ntfs, one for encryption and one for compression. But ntfs supports either compressing a file/directory or encrypting a file/directory at a time. Why not have two radio buttons instead of these silly check boxes?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503893">
				<div id="div-comment-503893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-503893">
			May 13, 2007 at 3:18 am</a>		</div>

		<p>On the topic of GlobalWire:</p>
<p>GlobalWire in Windows 3.x often returned memory in the first megabyte. In Windows 95, this changed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503903">
				<div id="div-comment-503903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-503903">
			May 13, 2007 at 3:38 am</a>		</div>

		<p>This should be interesting:</p>
<p><a rel="nofollow" target="_new" href="http://cd.textfiles.com/cica9308/UNZIPPED/NT/APPCMP/APPCMP.DOC" rel="nofollow">http://cd.textfiles.com/cica9308/UNZIPPED/NT/APPCMP/APPCMP.DOC</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504063">
				<div id="div-comment-504063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Emil T</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504063">
			May 14, 2007 at 9:46 am</a>		</div>

		<p>One of my favorite shortcut features in windows formfields is Ctrl+Backspace. Which deletes the word to the left of the cursor.</p>
<p>But in some cases it doesn&#8217;t work, and it inserts some control character instead. Particularly the &#8220;password edit&#8221;!</p>
<p>What&#8217;s the deal with that?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/11/5395501.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-504163">
				<div id="div-comment-504163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504163">
			May 14, 2007 at 11:36 am</a>		</div>

		<p>You can&#8217;t get something for nothing&#8230;</p>
<p>I was reminded of this again recently. &nbsp;One of my office computers is a SQL development machine. &nbsp;It runs a SQL server and not much else. &nbsp;I rarely use it directly (from the keyboard), but sometimes I do.</p>
<p>I was mucking around in the SQL server settings, and saw the option to &quot;Boost SQL Server priority&quot;. &nbsp;This makes the SQL server session run at priority &quot;High&quot;. &nbsp;</p>
<p>I thought this change would magically make the SQL queries run faster on that machine. &nbsp;No, the only effect was to make actually using that machine from the keyboard, painfully slow, since the interactive session (and almost everything else except SQL) is at normal priority.</p>
<p>The SQL queries on that machine generally have almost 100% of the cycles on that machine anyway, since nothing else runs there.</p>
<p>I was trying to circumvent the laws of physics, I think, by keeping interactive sessions fast while making SQL queries faster. &nbsp;Heck, why not set everything to high priority?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504393">
				<div id="div-comment-504393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504393">
			May 15, 2007 at 5:19 am</a>		</div>

		<p>What happened to the return code from WinMain in a Windows 3.1 app? (GetExitCodeProcess() didn&#8217;t exist in 3.x days)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mzygmunt odd alt thread-odd thread-alt depth-1" id="comment-504493">
				<div id="div-comment-504493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mzygmunt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504493">
			May 15, 2007 at 12:41 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>It is maybe not a suggestion but a kind of a question I think you may know how to answer it.</p>
<p>I am particulary interested in a way to implement &quot;multiple focuses&quot; (like: one person is working on one application /ex. notepad/ and the second /remote/ can help the first person during his/her work but without interrupting him/her).</p>
<p>What I am trying to do is to simulate two or more focuses on one desktop and doing this not by using SendInput (which changes application focus) but just simulating &quot;actions&quot; by sending plain messages using SendMessage/PostMessage directly to the control/window I want.</p>
<p>I can do this with keystrokes and HTCLIENT region but I am not able to simulate WM_NCLBUTTONDOWN.</p>
<p>Can you tell us maybe how SendInput is internally implemented that we can use it to simulate only part of the actions (like without accuiring focus) ?</p>
<p>Thanks you,</p>
<p>Michal Zygmunt</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504533">
				<div id="div-comment-504533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">4134uwzoa9</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504533">
			May 15, 2007 at 1:53 pm</a>		</div>

		<p>zy9jgajy48jvj excf732qvtym889kd mjo1kzw86l1eihv uv1uh0ast26</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-504543">
				<div id="div-comment-504543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">4134uwzoa9</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504543">
			May 15, 2007 at 1:53 pm</a>		</div>

		<p>zy9jgajy48jvj mjo1kzw86l1eihv uv1uh0ast26</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504743">
				<div id="div-comment-504743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nektar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-504743">
			May 16, 2007 at 4:49 am</a>		</div>

		<p>Is there a historic or compatibility reason for not being able to use the spacebar for selecting check boxes and radio button elements in a menu. Currently I need to press enter and the menu closes. This makes selecting multiple menu items, e.g. enabling multiple toolbars, more difficult than it should, since the user needs to enter and re-enter the menu and navigate to the correct spot for every check box or radio button element that he/she needs to select.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-505333">
				<div id="div-comment-505333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-505333">
			May 17, 2007 at 2:13 am</a>		</div>

		<p>Maybe you need to repeat a blog posting about this:</p>
<p><a rel="nofollow" target="_new" href="http://kernelmustard.com/2007/04/05/dtm-install-has-a-button-whacker/" rel="nofollow">http://kernelmustard.com/2007/04/05/dtm-install-has-a-button-whacker/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-508203">
				<div id="div-comment-508203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KTamas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-508203">
			May 25, 2007 at 1:14 am</a>		</div>

		<p>A historic question: where does the feature come from that lets you copy-paste the content of a messagebox? Was it for debugging? or something else? It&#8217;s just kinda weird :)</p>
<div class=post>[<i>Alas I don&#8217;t know either&#8230; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-508553">
				<div id="div-comment-508553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ane</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-508553">
			May 27, 2007 at 6:33 am</a>		</div>

		<p>If you have a string such as test:string? in the clipbard and you are renaming a file and you try paste it, the usual warning about invalid characters pops up (OK), but the clipbard&#8217;s contents are destroyed in the process (the invalid characters are removed from the clipbard too!). Why does this happen?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-508663">
				<div id="div-comment-508663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bezalel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-508663">
			May 28, 2007 at 1:33 pm</a>		</div>

		<p>How does Windows determine what the capabilities of an optical drive are?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-509603">
				<div id="div-comment-509603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ulianov.ca' rel='external nofollow' class='url'>Vladimir Cotfas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-509603">
			May 30, 2007 at 7:37 pm</a>		</div>

		<p>Raymond,</p>
<p>I bought your book 6 month ago and now it exhibits a peculiar bug: newer articles of interest to me don&#8217;t show up in it ;-P</p>
<p>Nice selection for the book.</p>
<p>-Vlad</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-509763">
				<div id="div-comment-509763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-509763">
			May 31, 2007 at 7:01 am</a>		</div>

		<p>The search function returns results from the old weblogs.asp.net address (try searching for &#8216;PulseEvent&#8217;, for example). Replacing it with blogs.msdn.com works just fine, as the archive URLs are apparently the same.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-510623">
				<div id="div-comment-510623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pagetable.com/' rel='external nofollow' class='url'>Myria</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-510623">
			June 4, 2007 at 12:56 am</a>		</div>

		<p>I found a bug in AddVectoredExceptionHandler that came up when I tried to debug why the memset() in my handler was corrupting the stack.</p>
<p>When an exception occurs, KiUserExceptionDispatcher does not clear the direction flag. &nbsp;RtlCallVectoredExceptionHandlers calls the vectored handlers while in this state. &nbsp;Because the Windows x86-32/64 ABI requires that the direction flag be cleared before calling a function, compilers inline a &quot;rep stosd&quot; for memset() without bothering to clear the direction flag first.</p>
<p>The exception that triggered my handler was inside a call to memmove() that happened to be doing a forward move by copying backward. &nbsp;The direction flag was still set while in the exception handler. &nbsp;The inlined &quot;rep stosd&quot; therefore went backward and clobbered other variables on the stack.</p>
<p>This was fixed in Vista &#8211; KiUserExceptionDispatcher&#8217;s first instruction on x86-32 and x86-64 is now &quot;cld&quot;. &nbsp;__except_handler* in the CRT already had a &quot;cld&quot; presumably for the same reason with normal exception handlers.</p>
<p>This isn&#8217;t a UI topic, but it still might be interesting for this journal.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-548303">
				<div id="div-comment-548303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.lab49.com/archives/1371' rel='external nofollow' class='url'>Lab49 Blog &raquo; Blog Archive &raquo; WM_UNDO vs EM_UNDO</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-548303">
			September 11, 2007 at 10:59 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.lab49.com/archives/1371" rel="nofollow">http://blog.lab49.com/archives/1371</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-571123">
				<div id="div-comment-571123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.nikvoronin.com/2007/11/27/pochemu-ini-fajly-ustareli-a-reestr-net/' rel='external nofollow' class='url'>Klatu! Veratu! Ni&#8230;khm-khm! &raquo; Blog Archive &raquo; ???????????? INI-?????????? ????????????????, ?? ???????????? ???????</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-571123">
			November 27, 2007 at 7:26 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.nikvoronin.com/2007/11/27/pochemu-ini-fajly-ustareli-a-reestr-net/" rel="nofollow">http://www.nikvoronin.com/2007/11/27/pochemu-ini-fajly-ustareli-a-reestr-net/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-640113">
				<div id="div-comment-640113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/michkap/archive/2008/06/19/8620349.aspx' rel='external nofollow' class='url'>Sorting it all Out : How do[es what] the common controls [call ]convert between ANSI and Unicode?</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-640113">
			June 19, 2008 at 7:24 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/michkap/archive/2008/06/19/8620349.aspx" rel="nofollow">http://blogs.msdn.com/michkap/archive/2008/06/19/8620349.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666823">
				<div id="div-comment-666823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.coldacid.net/blog/2008/09/11/raymond-chen-has-issue-i-can-only-dream-havinghellip' rel='external nofollow' class='url'>coldacid dot net</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-666823">
			September 11, 2008 at 8:19 pm</a>		</div>

		<p>Lately seen on The Old New Thing: I want to see your blog stats.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-705253">
				<div id="div-comment-705253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.depon.net/index.php?/archives/579-Der-Krieg-um-den-Windows-Desktop.html' rel='external nofollow' class='url'>TheUndeadable entwickelt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070523-00/?p=26743#comment-705253">
			February 2, 2009 at 1:09 pm</a>		</div>

		<p>Nett zu lesen mit welchen Anfragen Microsoft zu tun hat: Does the Windows XP Add/Remove Programs control panel expose a scriptable object model? We want our program to open the Add/Remove Programs control panel and uninstall the programs of our compe</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>