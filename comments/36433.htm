<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-256083">
				<div id="div-comment-256083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Manip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256083">
			February 16, 2005 at 7:28 am</a>		</div>

		<p>But where does this leave VBA programmers with no access to the MCIWnd class?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256093">
				<div id="div-comment-256093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256093">
			February 16, 2005 at 7:30 am</a>		</div>

		<p>Makes sense&#8211;the shell animation control was designed to support the direct needs of the Win95 shell.</p>
<p>An interesting thing that was pointed out on this site: <a target="_new" href="http://ian.winprog.org/archives/000024.html" rel="nofollow">http://ian.winprog.org/archives/000024.html</a></p>
<p>The control is (or was, as of PDC 2003) being enhanced to play DirectX mesh file animations.  The shell was going to display 3D animations; again, the control is designed to support the direct needs of the shell.  Will be interesting to see if this feature remains.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256123">
				<div id="div-comment-256123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.contentsaver.com' rel='external nofollow' class='url'>Roland Siegert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256123">
			February 16, 2005 at 7:57 am</a>		</div>

		<p>Why does the Animation Control of Common Controls 6 (WinXP themed apps) no longer support a seperate thread for displaying the animation? This is a major drawback!</p>
<p>As a result, you can notice that many animations in themed apps no longer run smoothly. For example, you can sometimes even see delays in the File Copy animation in Windows Explorer or the Empty Recycle Bin animation of Outlook 2003 (Outlook versions earlier than 2003 are not themed and thus show no delay).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256143">
				<div id="div-comment-256143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256143">
			February 16, 2005 at 10:27 am</a>		</div>

		<p>And here&#8217;s where there&#8217;s a gap between two groups at Microsoft: there are requirements on the part of the Shell control, and there are properties availible in the Shell, and they don&#8217;t match up. I just did a find of all the .AVI files on my machine, and did a &quot;Properties&quot; on the official Microsoft ones.  Of the five required properties of an AVI file to show in the control, perhaps two are exposed in the &quot;Properties&quot; pane.</p>
<p>Those two are:<br />
<br />Audio Duration (which even the official Microsoft &#8216;FileMove&#8217; etc AVI files have: this either means that an AVI file can have Audio and it just doesn&#8217;t play or that the results on the Property Pane are wrong)</p>
<p>Video Compression (but the official FileMove.AVI is MS-RLE which doesn&#8217;t match the list that Raymond gave)</p>
<p>Upshot: there&#8217;s no built-in way to tell if any given AVI file is suitable for the shell control or not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256163">
				<div id="div-comment-256163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256163">
			February 16, 2005 at 10:35 am</a>		</div>

		<p>The Properties page is not for geeks. The requirements for AVIs in the common animation control are geeky. Use a geeky property viewer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256173">
				<div id="div-comment-256173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lots of threads</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256173">
			February 16, 2005 at 10:45 am</a>		</div>

		<p>I wish the IE COM control (shdocw.dll) also did remove some of it&#8217;s threads. It usually has 6-7 threads running (while displaying a already loaded page).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256193">
				<div id="div-comment-256193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256193">
			February 16, 2005 at 12:48 pm</a>		</div>

		<p>&quot;Note   MCIWnd is not available on 64-bit operating systems.&quot;</p>
<p>Looks like our old friend is being put to rest.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256233">
				<div id="div-comment-256233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256233">
			February 16, 2005 at 2:49 pm</a>		</div>

		<p>Chris: Nope, it&#8217;s not good enough to just try it on my machine.  Microsoft, like all real companies, upgrades its components regularly.  If I want to write code that works on a large number of machines (and usually I do), then I have to keep within the (hopefully documented) confines of the API and not stray into uncharted waters.  Ergo, I need to verify that my AVI files match the requirements.</p>
<p>Raymond: A quick web search for &quot;geeky property viewer&quot; comes up with no hits :-)  A quick download of several freeware AVI editors shows that none of the ones I downloaded tell me those properties.  This includes the &quot;Movie Maker&quot; that comes with XP and the &quot;Media Player&quot;.</p>
<p>The property pages for AVI files do show some pretty geeky information (bit rate, encoding, and frames per second spring to mind).  They just don&#8217;t show the right geeky information.</p>
<p>Don&#8217;t forget that of the two properties that are mentioned in the property page, neither is completely correct.  The AVI encoding ireported by the Property Page does not match the official list of supported encodings in MSDN and the Property Page mentions an audio track that according to MSDN should make the AVI unusable in the component.</p>
<p>The component is no longer simple because it&#8217;s now hard to determine if any particular AVI meets the documented requirements (and it&#8217;s also hard to know if the documented requirements are even correct).  Now to use the control in any other than toys for my own computer I have to consider agressive testing: will each and every AVI that I ship work with each and every version of Windows I want to support?  Or should I just &quot;hope for the best&quot;?</p>
<p>It&#8217;s hardly the sort of decision that a &quot;simple&quot; component should make anyone make!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256243">
				<div id="div-comment-256243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256243">
			February 16, 2005 at 2:55 pm</a>		</div>

		<p>I would expect your AVI creation tool to let you specify interleaving, how many streams to save, what compression format to use, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256263">
				<div id="div-comment-256263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spaces.msn.com/members/andyandyx' rel='external nofollow' class='url'>Andreas H&#228;ber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256263">
			February 16, 2005 at 5:05 pm</a>		</div>

		<p>Peter: &quot;Windows Media Player&quot; and &quot;Windows Movie Maker&quot; aren&#8217;t exactly geeky tools either :) Try some of the tools at [1] and you&#8217;ll probably get enough information about the video files.</p>
<p>[1] <a target="_new" href="http://www.divx-digest.com/software/index3.html#encoding_edit" rel="nofollow">http://www.divx-digest.com/software/index3.html#encoding_edit</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256183">
				<div id="div-comment-256183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256183">
			February 16, 2005 at 11:08 am</a>		</div>

		<p>@Peter:  If you want to play an animation in your program, it&#8217;s not really *that* difficult just to test a particular avi file to see if it&#8217;s suitable, right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256223">
				<div id="div-comment-256223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeka.com/blogs/' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256223">
			February 16, 2005 at 2:27 pm</a>		</div>

		<p>&quot;If you want to play an animation in your program, it&#8217;s not really *that* difficult just to test a particular avi file to see if it&#8217;s suitable, right?&quot;</p>
<p>Alternatively, you shouldn&#8217;t be playing other people&#8217;s AVIs in your app anyway, so you should be able design your own to match the requirements ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256353">
				<div id="div-comment-256353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dashslot.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256353">
			February 17, 2005 at 9:06 am</a>		</div>

		<p>&quot;The AVI must be non-interleaved. The AVI must have exactly one video stream. The AVI may not have an audio stream.&quot;</p>
<p>I&#8217;d say that it doesn&#8217;t actually support AVI files at all &#8212; the A in AVI is for audio and the I is for interleaved so it can actually only play V files. (Sorry, I&#8217;ll get my coat&#8230; :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256473">
				<div id="div-comment-256473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256473">
			February 17, 2005 at 3:29 pm</a>		</div>

		<p>@Dean Harding: My comment came out more snarky than I wanted it to, sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256463">
				<div id="div-comment-256463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050216-00/?p=36433#comment-256463">
			February 17, 2005 at 3:25 pm</a>		</div>

		<p>@Peter:  You&#8217;ll notice that I never suggested that you *only* try it on your machine.  What I suggested was that if you are worried about whether or not a particular AVI file will play, test it out (on ALL platforms you will be supporting).  What&#8217;s that?  You don&#8217;t test your program on all the platforms you will be supporting?  Wow, that&#8217;s unfortunate for your users.</p>
<p>As for API updates, do you recall seeing any of Raymond&#8217;s posts about backward compatibility?  If you try your AVIs out on base installs of all the operating systems you want to support, I doubt Microsoft is going to break them with an update.</p>
<p>As for generating the AVI correctly in the first place, follow the docs, if it doesn&#8217;t work, try reducing the complexity of the AVI.  I mean, putting a few video frames into an AVI file is not that difficult (especially with the API).</p>
<p>@Dean Harding:<br />
<br />&gt;Alternatively, you shouldn&#8217;t be playing other people&#8217;s AVIs in your app anyway, so you should be able design your own to match the requirements</p>
<p>Uh, where did I suggest that he should use somebody else&#8217;s AVIs in his own program. ???</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>