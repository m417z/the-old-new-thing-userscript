<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1360375">
				<div id="div-comment-1360375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360375">
			September 12, 2018 at 8:27 am</a>		</div>

		<p>Do I detect a hint of disdain for this customer?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1360395">
				<div id="div-comment-1360395" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360395">
			September 12, 2018 at 9:55 am</a>		</div>

		<p>I seriously suspect the customer don&#8217;t know (or haven&#8217;t hired someone who knows) how to write a program without the precious framework.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1360435">
				<div id="div-comment-1360435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">guest</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360435">
			September 12, 2018 at 10:46 am</a>		</div>

		<p>So&#8230; this is the programming equivalent of &#8220;ask your mom&#8221;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matteo odd alt thread-odd thread-alt depth-1 parent" id="comment-1360445">
				<div id="div-comment-1360445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360445">
			September 12, 2018 at 11:39 am</a>		</div>

		<p>Uh that was a bit&#8230; underwhelming. This is done routinely by anybody doing sysadmin-like work, how could the customer be so helpless to require help straight from Microsoft from something so trivial?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1360485">
				<div id="div-comment-1360485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360485">
			September 12, 2018 at 5:37 pm</a>		</div>

		<p>It probably involves some stuff about the start menu and quite possibly application pinning. We still have our .NET framework app that if you pin it it doesn&#8217;t start. The WinForms library doesn&#8217;t have any methods at all to change the pin launch data.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt depth-2" id="comment-1360515">
				<div id="div-comment-1360515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360515">
			September 13, 2018 at 1:37 am</a>		</div>

		<p>FYI, there are a lot of questions in MSDN forums that ask for &#8220;best practice&#8221; of doing something trival (or not).</p>
<p><a href="https://www.google.com/search?q=%22best+practice%22+site%3Asocial.msdn.microsoft.com&#038;oq=%22best+practice%22+site%3Asocial.msdn.microsoft.com" rel="nofollow">https://www.google.com/search?q=%22best+practice%22+site%3Asocial.msdn.microsoft.com&#038;oq=%22best+practice%22+site%3Asocial.msdn.microsoft.com</a></p>
<p>Not necessarily because they&#8217;re newbie or too lazy to figure out, but sometimes the overhelming number of ways avaliable makes you wonder which one is the best, and sometime it&#8217;s because the subject is too trival that someone may already have builtin way to do so.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even depth-2" id="comment-1360535">
				<div id="div-comment-1360535" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360535">
			September 13, 2018 at 1:43 am</a>		</div>

		<p>Try search for &#8220;best practice&#8221; on MSDN forums.</p>
<p>Sometimes there&#8217;s overhelming number of ways to do &#8220;trival&#8221; things so you wonder what is best, other time you found something too trival that problem someone has written builtin way to do it.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1360475">
				<div id="div-comment-1360475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360475">
			September 12, 2018 at 4:51 pm</a>		</div>

		<p>That&#8217;s too simple. The Right Way would be to binary edit the framework&#8217;s DLL (or the main executable if it&#8217;s static linked) to change the import of KERNEL32.DLL to something like FIZZKRNL.DLL, which is a DLL which forwards everything to the real KERNEL32.DLL except when it&#8217;s one of the CreateFile calls looking for the configuration files, in which case it replaces the passed file name on the fly, or when it&#8217;s a GetEnvironmentVariable looking for FIZZBIN, in which case it returns the correct value directly.</p>
<p>(Yes, I did have to do something like that once. No, a helper program wouldn&#8217;t have helped in that particular case.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-odd thread-alt depth-1" id="comment-1360525">
				<div id="div-comment-1360525" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360525">
			September 13, 2018 at 1:40 am</a>		</div>

		<p>//sigh</p>
<p>Whenever I include a link to, say, Google, the comment box eat all the contents.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1360555">
				<div id="div-comment-1360555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360555">
			September 13, 2018 at 3:36 am</a>		</div>

		<p>This is probably the only scenario where <code>exec</code> becomes useful, because then the helper program doesn&#8217;t require any additional assumptions. (If the calling and called programs are well written then they won&#8217;t mind an interposed helper program but you can&#8217;t always rely on that.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kirbyfcf2 even thread-odd thread-alt depth-1" id="comment-1360885">
				<div id="div-comment-1360885" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Kirby+FC' rel='external nofollow' class='url'>Kirby FC</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1360885">
			September 13, 2018 at 6:44 pm</a>		</div>

		<p>Q:  How do I get the system to run my program in this very special way?</p>
<p>A:  I would suggest Peter Frampton  (Show Me The Way)  or possibly Genesis (Your Own Special Way).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jernej-ms-live odd alt thread-even depth-1" id="comment-1361355">
				<div id="div-comment-1361355" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/ender9' rel='external nofollow' class='url'>ender9</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1361355">
			September 17, 2018 at 3:07 am</a>		</div>

		<p>I&#8217;d have used a batch file :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf even thread-odd thread-alt depth-1" id="comment-1362805">
				<div id="div-comment-1362805" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1362805">
			September 24, 2018 at 2:29 am</a>		</div>

		<p>I remember doing this kind of helper for a game that tended to randomly crash on multicore processors. A simple call to SetProcessAffinityMask() before launching the program&#8230; (or, well, Process.GetCurrentProcess().ProcessorAffinity, since that computer didn&#8217;t have an IDE but did have the .Net Framework installed)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aegis03 odd alt thread-even depth-1" id="comment-1363015">
				<div id="div-comment-1363015" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/dmex' rel='external nofollow' class='url'>dmex</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180912-00/?p=99705#comment-1363015">
			September 25, 2018 at 1:18 am</a>		</div>

		<p>This works for simple autostart entries but won&#8217;t work for services. Let&#8217;s say you have myservice.exe launched via the service control manager (with a ServiceMain entry point). If you change the service configuration to start a different binary which configures the &#8216;special requirements&#8217; then proceeds to CreateProcess myservice.exe and exit then Windows spews event id 7039 in the event log and terminates the service.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>