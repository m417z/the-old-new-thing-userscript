<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (43)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-129963">
				<div id="div-comment-129963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-129963">
			November 3, 2003 at 12:53 pm</a>		</div>

		<p>So which is worse â€” when they try to find out the right location the wrong way, or when they just hardcode the wrong location?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129973">
				<div id="div-comment-129973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-129973">
			November 3, 2003 at 3:28 pm</a>		</div>

		<p>I have to admit, at one time I did read from the Shell Folders key directly. I think I was aware of SHGetSpecialFolderLocation but found it too clumsy to use, unaware that it didn&#8217;t simply read the values but also created them. Perhaps it would be wise to mention this in the docs for SHGetSpecialFolderLocation and friends.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129983">
				<div id="div-comment-129983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Catatonic</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-129983">
			November 3, 2003 at 3:31 pm</a>		</div>

		<p>I would say hardcoding the location is worse, because then it will be correct for only one language. This bit me once when I hardcoded the &quot;Programs&quot; folder on the start menu.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129993">
				<div id="div-comment-129993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-129993">
			November 3, 2003 at 3:31 pm</a>		</div>

		<p>By the way, how did the four programs which read the &quot;Shell Folders&quot; key ever work, since the values in the key aren&#8217;t created until SHGetSpecialFolderLocation is called? Were a select few values pre-created when Windows was installed?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130003">
				<div id="div-comment-130003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KC Lemson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130003">
			November 3, 2003 at 4:47 pm</a>		</div>

		<p>Fascinating! I confess that as a user, I&#8217;ve long been setting the Personal/My Documents shell folders reg key to a fileshare (on my laptop). I also muck with the desktop and Favorites ones to have them point to a separate location on the drive. Unfortunately an API just doesn&#8217;t work for me. But thus far, I haven&#8217;t had a problem with it &#8211; crossing my fingers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130013">
				<div id="div-comment-130013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meme</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130013">
			November 3, 2003 at 4:50 pm</a>		</div>

		<p>The whole error was in allowing those four programs&#8217; programmers to be lazy in the first place. That key should just be done away with since windows was still in testing anyway. Also, I&#8217;d like to point out that many developers don&#8217;t have access to documentation and have to search the registry as a last resort. At least in 1995.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130023">
				<div id="div-comment-130023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geary.com/' rel='external nofollow' class='url'>Michael Geary</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130023">
			November 3, 2003 at 5:21 pm</a>		</div>

		<p>On my XP system, the Shell Folders key includes values for all kinds of new shell folders such as CD Burning and My Pictures. I&#8217;m curious why these are present if the registry key exists only to take care of four ancient programs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130033">
				<div id="div-comment-130033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">runtime</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130033">
			November 3, 2003 at 5:34 pm</a>		</div>

		<p>Those four naughty programs were using a new feature introduced in a Windows 95 BETA. Presumably those four programs were released AFTER Windows 95 RTM. If that feature was removed before RTM, then the programs could have been fixed without breaking backwards compatibility. Sometimes Microsoft tries a little TOO hard to maintain backwards compatibility..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130043">
				<div id="div-comment-130043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.com/raymondc/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130043">
			November 3, 2003 at 8:39 pm</a>		</div>

		<p>Those four programs shipped on the same day as Windows 95 RTM &#8211; they were part of the &quot;Wow, isn&#8217;t Windows 95 so awesome, look at all these apps written for it ALREADY!&quot; So it was important that they continue to run.  I suspect that we just told them &quot;Stick this call to SHGetSpecialFolderLocation into your setup program, and that will seed the registry key for your main program, which you don&#8217;t have time to fix before Windows 95 RTM.&quot;  The fact that other registry values also get auto-generated (beyond the handful needed by those four apps) was more an artifact of the compatibility hack than a design feature.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130053">
				<div id="div-comment-130053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130053">
			November 4, 2003 at 12:30 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130063">
				<div id="div-comment-130063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.com/robmen/' rel='external nofollow' class='url'>Rob Mensching</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130063">
			November 4, 2003 at 1:26 am</a>		</div>

		<p>And if you&#8217;re using the Windows Installer to install your application, you shouldn&#8217;t need to call ::SHGetSpecialFolderLocation() because the Installer creates a whole slew of &quot;standard Properties&quot; that point to the correct location on the machine, no matter if its in the user profile that was redirected when on a Terminal Services machine or a per-machine location when installing as such.</p>
<p>Per-user/per-machine stuff is tricky and using the standard APIs instead of trying to reverse engineer data out of private data stores (like the Registry) is always going to provide a better experience for the end user (especially when your app is installed on the &quot;next OS&quot; where it was probably never tested).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130073">
				<div id="div-comment-130073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130073">
			November 4, 2003 at 1:46 am</a>		</div>

		<p>How about the feature that was done so <em>one</em> app ran on Win 95 gold? msdos.sys has some junk at the end that reads<br />
;The following lines are required for compatibility with other programs<br />
;Do not remove them (MSDOS.SYS needs to be &gt;1024 bytes).<br />
;xxxxxx<br />
and so on. That junk was added for Norton AntiVirus, which still expected msdos.sys to be executable code (like in DOS 6) and it had a hard-coded size check of &gt;= 1K for whatever reason. If the file was smaller, NAV assumed it had been corrupted by a virus.<br />
We removed that size check in the following rev, but the junk comments in msdos.sys stuck around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130083">
				<div id="div-comment-130083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130083">
			November 4, 2003 at 5:31 am</a>		</div>

		<p>I love how Mike names names. ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130093">
				<div id="div-comment-130093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Wexler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130093">
			November 4, 2003 at 12:22 pm</a>		</div>

		<p>Thanks, this was a fun read&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130103">
				<div id="div-comment-130103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Guy Gervais</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130103">
			November 4, 2003 at 12:35 pm</a>		</div>

		<p>Since many programmers won&#8217;t take the time to search the documentation before using those registry entries, would it not make sense to add a &quot;(ReadMe!)&quot; key saying &quot;Do not use these keys in your applications, see SHGetSpecialFolderLocation in the Shell API&quot; or something to that effect?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130113">
				<div id="div-comment-130113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Guy Gervais</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130113">
			November 4, 2003 at 12:35 pm</a>		</div>

		<p>Since many programmers won&#8217;t take the time to search the documentation before using those registry entries, would it not make sense to add a &quot;(ReadMe!)&quot; key saying &quot;Do not use these keys in your applications, see SHGetSpecialFolderLocation in the Shell API&quot; or something to that effect?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130123">
				<div id="div-comment-130123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.com/raymondc/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130123">
			November 4, 2003 at 4:32 pm</a>		</div>

		<p>Hey, Guy, how did you get access to my ToDo list?  I plan to do exactly that for Longhorn!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130133">
				<div id="div-comment-130133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130133">
			November 4, 2003 at 8:39 pm</a>		</div>

		<p>Huh, actually opened comments to post exactly what Guy Gervais already wrote. Raymond, your ToDo list seems to be known to everyone :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130143">
				<div id="div-comment-130143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130143">
			November 5, 2003 at 2:55 pm</a>		</div>

		<p>And then someone smart finds it and starts discussing with his neighbor how Microsoft is again bloating everything :) Next week everyone starts writing small utilities to find and delete all such readmes, and they screw up their registries in the process. Or they see that some registry keys are documented and demand that for all keys, and that, as we all know, is impossible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130153">
				<div id="div-comment-130153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nekto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130153">
			November 6, 2003 at 7:35 am</a>		</div>

		<p>Isn&#8217;t it better to patch regedt32 and rededit utilites just to show some more help on registry keys? Most of people will use these utils and this info will not be deleted as a key. You could even include big red sign near that keys &#8211; &quot;Warning &#8211; deprecated!&quot; :)</p>
<p>Or may be some addition to VC++ &#8211; &quot;scan code for deprecated fucntion calls and registry keys&quot; wich will be turned on by default.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130163">
				<div id="div-comment-130163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130163">
			November 6, 2003 at 9:57 am</a>		</div>

		<p>I can&#8217;t imagine why so many people opted to use the registry key other than the delightfully elegant and easy-to-use &quot;SHGetSpecialFolderLocation&quot; API call.</p>
<p>In case you can&#8217;t tell I&#8217;m being sarcastic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130173">
				<div id="div-comment-130173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://greggman.com' rel='external nofollow' class='url'>GMan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130173">
			November 7, 2003 at 8:58 am</a>		</div>

		<p>Well, I just installed VC++.NET.  I search for shortcut (trying to find out how to read a link to see what it points to) and guess what I find</p>
<p>ms-help://MS.VSCC/MS.MSDNVS/dnmgmt/html/msdn_shellnk1.htm</p>
<p>The example PROVIDED BY MICROSOFT IN VC++.NET READS THE REGISTRY!!!!!</p>
<p>So I guess you could say nobody is following any hacks, they are following the instructions Microsoft is STILL GIVING.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130183">
				<div id="div-comment-130183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.com/raymondc/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130183">
			November 7, 2003 at 2:20 pm</a>		</div>

		<p>The page appears to have been removed from MSDN in the meantime, at least I can&#8217;t find it.  I think the article you refer to is from Nancy Cluts, who did much of her work based on Windows 95 betas (back when the registry key was the valid way to get the information).</p>
<p>Note that not all content on microsoft.com was tech-reviewed by the people responsible for the technology the article is about. For example, magazine articles are just magazine articles. I&#8217;ve seen magazine articles reprinted on MSDN that tell people to do the most horrible unsupported things&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130193">
				<div id="div-comment-130193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://greggman.com' rel='external nofollow' class='url'>GMan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130193">
			November 9, 2003 at 1:11 am</a>		</div>

		<p>Microsoft does a great job of having lots of documentation.  Maybe if these kinds of issues effect Microsoft&#8217;s bottom line, like maybe if continuing to support that registry location costs money, then maybe it should be someone&#8217;s job to fix/remove old bad docs and articles distrubuted by ms regardless of the original author.  You could setup an internal (and external?) special mail address or form where internal (and external?) people could send in fixes, revisions, corrections and MS could fix this stuff faster and make it less likely that people would continue to get bad info.  It could be at the bottom of each page on MSDN (and in the offline help as well)</p>
<p>Just a suggestion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130203">
				<div id="div-comment-130203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.whirlingdervishes.com' rel='external nofollow' class='url'>Henk Devos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130203">
			November 10, 2003 at 4:01 am</a>		</div>

		<p>I sympathize with you, raymond&#8230;<br />
This is an example of something that should not have been kept compatible.<br />
A good solution would have been to write a little utility that creates the registry values, and ask the 4 programmers to call this utility at  setup.<br />
I realize how hard all this stuff is.<br />
But some things should absolutely be kept compatible, while some other things should not.<br />
As an example, i agree that the folder tasks should not be kept compatible. It&#8217;s only some bad guys like me who use this and we should live with the consequences.<br />
However when i hear the fixed icon indices that have been around since Win95 will change this sounds like a very bad idea to me. I know lots of developers depending on this.<br />
Maybe it would be a good idea to talk to some developers when trying to decide if something should be kept compatible or not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-130213">
				<div id="div-comment-130213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130213">
			December 10, 2003 at 3:52 am</a>		</div>

		<p>Here&#8217;s an example of an application that uses a hard-coded pathname instead of calling SHGetSpecialFolderLocation().  The application is Visual Studio .Net 2003 Prerequisites.  The installation program for Visual Studio .Net 2003 requires the Prequisites CD to be inserted early in the installation sequence.  It creates a shortcut in the &quot;Programs&quot; folder in the Start Menu, with &quot;Programs&quot; named in English.  (Fortunately the rest of Visual Studio gets shortcuts installed into the normal Programs folder with whatever name it really has in whatever language version of Windows.)</p>
<p>Here are a few other examples, though less recent.  Windows 98 with either W98 SP1 or an IE SP, I forgot which.  Windows anything with Office 97 and an upgrade to Word 2000.  Etc.  These would put multiple entries in the main Start Menu itself and/or in names of folders in it.  One entry would be a word written in zenkaku (full-width) katakana and one entry would be a word written in hankaku (half-width) katakana.  Unlike case insensitivity, Windows has no such thing as width-insensitivity, so these installers created new entries instead of overwriting existing entries.</p>
<p>&#8216;Course this garbage isn&#8217;t as bad as time bombs and other mass data destroyers (an example of a time bomb being Windows 95 FDISK creating overlapping logical drives on SCSI disks).  But still, some of this stuff is laughable.  No matter how much we read about Microsoft doing massive amounts of testing, we see that Microsoft obviously never even tested the thing once.  Install an upgrade, do a reboot, what&#8217;s the first thing you do?  Click on the Start Button and see this new garbage.  How could anyone miss it?  Obviously by never even having tested it once.</p>
<p>Anyway, you want people to call SHGetSpecialFolderLocation(), you&#8217;d better start by informing your co-workers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-130223">
				<div id="div-comment-130223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.com/raymondc/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-130223">
			December 10, 2003 at 11:32 am</a>		</div>

		<p>I knew about Visual Studio&#8217;s setup program, but I don&#8217;t name names as a general rule.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-143333">
				<div id="div-comment-143333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Todor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-143333">
			February 13, 2004 at 2:56 pm</a>		</div>

		<p>I think I&#8217;m going to have to use the registry values&#8230; The reason is that I don&#8217;t want to link to shell32.dll because it slows down my program and the shared memory that my program has access to due to this call, counts toward my program when viewed with the Windows task manager (and users will think that my program uses more memory than it actually does). So if I can avoid linking to a DLL, I do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-143343">
				<div id="div-comment-143343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-143343">
			February 13, 2004 at 3:04 pm</a>		</div>

		<p>That&#8217;s great for you but not good for the future of Windows. So next time you complain that Windows UI never changes radically: Remember, it&#8217;s because of you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-161583">
				<div id="div-comment-161583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Horacio Lopez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-161583">
			April 7, 2004 at 10:25 am</a>		</div>

		<p>It was an interesting story.<br />
<br />Still, a dependency on shell32.dll is not desirable in some cases.</p>
<p>What if a particular application needed a different shell other than Windows Explorer ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-161663">
				<div id="div-comment-161663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-161663">
			April 7, 2004 at 8:30 pm</a>		</div>

		<p>You can still use shell32.dll if your shell isn&#8217;t explorer.exe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-165193">
				<div id="div-comment-165193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Homer Meyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-165193">
			April 19, 2004 at 5:10 pm</a>		</div>

		<p>Since this seems active, I&#8217;ll post here. I&#8217;ve got a problem that maybe you can help me with. I need to get the location of the common documents folder under Windows NT SP6.  I&#8217;ve tried using SHGetSpecialFolderLocation, but that returns an error result saying that the parameter is incorrect.  I assume this is talking about the CSIDL_COMMON_DOCUMENTS parameter.  This code works fine under Win2k and WinXP, but I need to get it to work for WinNT.</p>
<p>I noticed that the registry value for the common documents folder under &quot;User Shell Folders&quot; is correct for Windows NT.  Would I be ok in reading the value from the registry under Windows NT?  I&#8217;ll use SHGetSpecialFolderLocation normally, but make a special case for Windows NT to read from the registry.</p>
<p>This is for a Windows Installer installation, but the properties that Windows Installer sets are no help here because the common documents location isn&#8217;t one of those properties.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-165203">
				<div id="div-comment-165203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-165203">
			April 19, 2004 at 5:28 pm</a>		</div>

		<p>This is what shfolder.dll is for &#8211; to provide support for new CSIDL values on older OSs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-165553">
				<div id="div-comment-165553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Homer Meyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-165553">
			April 20, 2004 at 9:43 am</a>		</div>

		<p>I tried that too.  It returned an error also.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-165583">
				<div id="div-comment-165583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Homer Meyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-165583">
			April 20, 2004 at 9:53 am</a>		</div>

		<p>Hmm.. what I was trying was using the shfolder.dll that is already on the WinNT system.  Is it allowed for me to install a newer shfolder.dll?  I&#8217;m searching for one that I can distribute on MSDN, but I haven&#8217;t found it yet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-165593">
				<div id="div-comment-165593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-165593">
			April 20, 2004 at 10:00 am</a>		</div>

		<p><a target="_new" href="http://www.microsoft.com/downloads/details.aspx?FamilyID=6AE02498-07E9-48F1-A5D6-DBFA18D37E0F" rel="nofollow">http://www.microsoft.com/downloads/details.aspx?FamilyID=6AE02498-07E9-48F1-A5D6-DBFA18D37E0F</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-165633">
				<div id="div-comment-165633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Homer Meyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-165633">
			April 20, 2004 at 10:51 am</a>		</div>

		<p>Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-169743">
				<div id="div-comment-169743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">LK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-169743">
			April 30, 2004 at 2:19 am</a>		</div>

		<p>With a little batch script and reg.exe it&#8217;s easy to retrieve the user&#8217;s &quot;special folders&quot;, so it&#8217;s very handy to have this information inside the registry. So I&#8217;m very happy about the programmers of these four legacy apps :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-176203">
				<div id="div-comment-176203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burt Harris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-176203">
			May 22, 2004 at 5:27 pm</a>		</div>

		<p>One thing that&#8217;s caused me additional grief is the fact that the Shell Folders key (no matter how you access it) seems to default to putting temp files (both normal temp files, and internet temporary files) into the user&#8217;s profile. This ends up with loads of cached data of little value mixed right in with the users&#8217; most critical documents and settings, making rational backup procedures complicated.</p>
<p>Sure, you can change it indivdually, but on a machine with multiple users this ends up being a real pain, and I&#8217;ve yet to figure how to change the defult setting for new users.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-184893">
				<div id="div-comment-184893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-184893">
			June 17, 2004 at 4:03 pm</a>		</div>

		<p>Commenting on this article has been closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-229223">
				<div id="div-comment-229223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/11/24/269158.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-229223">
			November 24, 2004 at 6:19 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-554783">
				<div id="div-comment-554783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://at-the-water-cooler.com/blog/2007/09/27/finding-more-winxp-special-folders/' rel='external nofollow' class='url'>at-the-water-cooler.com &raquo; Blog Archive &raquo; Finding more WinXP special folders</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-554783">
			September 28, 2007 at 1:39 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://at-the-water-cooler.com/blog/2007/09/27/finding-more-winxp-special-folders/" rel="nofollow">http://at-the-water-cooler.com/blog/2007/09/27/finding-more-winxp-special-folders/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-742843">
				<div id="div-comment-742843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://aareet.com/2009/05/29/wine-additional-configuration/' rel='external nofollow' class='url'>Wine additional configuration &laquo; aareet</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031103-00/?p=41973#comment-742843">
			June 7, 2009 at 12:49 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://aareet.com/2009/05/29/wine-additional-configuration/" rel="nofollow">http://aareet.com/2009/05/29/wine-additional-configuration/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>