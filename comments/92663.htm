<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1 parent" id="comment-1219651">
				<div id="div-comment-1219651" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219651">
			December 17, 2015 at 7:14 am</a>		</div>

		<p>It could be part of a sort of &#8220;social engineering&#8221; attack:</p>
<p>&#8211; User deletes a file<br />
&#8211; Malware edits the recycle bin to say it came from C:\WINNT<br />
&#8211; User changes his mind and decides to restore the file<br />
&#8211; Windows asks for the administrator password<br />
&#8211; User trusts the UAC prompt because he trusts Windows, and the prompt is clearly for the operation he just requested<br />
&#8211; Profit!</p>
<p>If it weren&#8217;t able to show a UAC prompt, I&#8217;d agree that messing with your own recycle bin could not be considered a vulnerability. But IMHO UAC changes the rules a bit.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-dwalker-wk odd alt depth-2 parent" id="comment-1219681">
				<div id="div-comment-1219681" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219681">
			December 17, 2015 at 7:43 am</a>		</div>

		<p>@Cesar, that sounds, perhaps, a bit far-fetched.  It&#8217;s possible, but any time you trick a user into replying to the UAC prompt, then anything can happen.  Interesting scenario, though.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1219692">
				<div id="div-comment-1219692" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ross Presser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219692">
			December 17, 2015 at 8:19 am</a>		</div>

		<p>The Malware itself could start the deletion, throw up a window like &#8220;now deleting all .DOCX files in My Documents&#8221;, then move the DOCX files to the Recycle Bin, messing with one of them along the way. The panicked user goes to the Recycle Bin, breathes a sigh of relief, selects all his DOCX files and tells Windows to restore them. &#8220;Huh? A UAC prompt? Oh well, whatever, as long as it gives me back my resumés and cover letters!&#8221;   And, boom.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1220001">
				<div id="div-comment-1220001" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Y</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1220001">
			December 21, 2015 at 4:07 am</a>		</div>

		<p>As Raymond is fond of saying, if malware is running on the users machine, it&#8217;s already on the other side of the airtight hatchway.  It&#8217;s not likely that UAC is going to slow it down much at this point.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2 parent" id="comment-1219691">
				<div id="div-comment-1219691" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219691">
			December 17, 2015 at 8:13 am</a>		</div>

		<p>If you are able to execute code as the user (i.e. because you are a malware able to edit the users recycle bin) there are many ways to trick the user into confirming the UAC dialog. You could &#8211; for example &#8211; just wait for the user to download some .exe file that looks like an installer and replace it by your own code. A user who has the right to become Admin is likely to install some piece of Software sooner or later.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bob-rao odd alt depth-3 parent" id="comment-1219751">
				<div id="div-comment-1219751" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Vulpini' rel='external nofollow' class='url'>Vulpini</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219751">
			December 17, 2015 at 3:15 pm</a>		</div>

		<p>The security-conscious user (ha!) would look at the Publisher field, assuming the original installer was signed correctly.</p>
<p>Then again, the security-conscious user would also notice that the restore target in the elevation request (it&#8217;s listed there, I checked) is not where they might expect.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1219761">
				<div id="div-comment-1219761" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219761">
			December 17, 2015 at 3:20 pm</a>		</div>

		<p>You know the security-conscious user? Who is he? Is he actually real? Can you give me his phone number?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1219852">
				<div id="div-comment-1219852" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ron O</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219852">
			December 18, 2015 at 3:47 am</a>		</div>

		<p>&gt; Can you give me his phone number?</p>
<p>I could, but his security prevents me from doing so.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1219931">
				<div id="div-comment-1219931" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219931">
			December 18, 2015 at 12:43 pm</a>		</div>

		<p>Every security-conscious administrator sets up protection for his unsuspecting and not so security-concious users:<br />
0. he disables any temptation through UAC (see <a href="https://technet.microsoft.com/en-us/dd835564.aspx" rel="nofollow">https://technet.microsoft.com/en-us/dd835564.aspx</a>):<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]<br />
&#8220;ConsentPromptBehaviorUser&#8221;=dword:0<br />
&#8220;EnableInstallerDetection&#8221;=dword:0<br />
1. he creates &#8220;standard&#8221; user accounts for them;<br />
2. he sets up SAFER: see <a href="http://home.arcor.de/skanthak/SAFER.html" rel="nofollow">http://home.arcor.de/skanthak/SAFER.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1219771">
				<div id="div-comment-1219771" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219771">
			December 17, 2015 at 3:59 pm</a>		</div>

		<p>Not to mention that the UAC prompt and admin rights in general aren&#8217;t a serious target anymore. You can encrypt everything a user has and extort hundreds of dollars without ever needing admin rights, unless someone uses separate accounts for everything they do on a PC.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1219662">
				<div id="div-comment-1219662" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">brianvan (@brianvan)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219662">
			December 17, 2015 at 7:32 am</a>		</div>

		<p>Sure but what about automated attacks that operate on arbitrary files in the Recycle Bin without the user&#8217;s knowledge? It&#8217;s a low-chance thing, but the user may restore a file and make assumptions about its contents being benign, without knowing about the substitution. </p>
<p>If I were to leverage this, I would probably put some really nasty stuff in any .doc or .docx file that landed in the Bin database. The user would then be surprised to find a macro trying to run when they opened their restored document, and there&#8217;s again a non-zero chance that someone who hasn&#8217;t had their morning coffee yet will click &#8220;yes&#8221; on a dialog box not really thinking of the implications. </p>
<p>That said, there are likely much more reliable ways to put the moves on someone who hasn&#8217;t had their morning coffee&#8230;</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1220051">
				<div id="div-comment-1220051" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1220051">
			December 21, 2015 at 12:28 pm</a>		</div>

		<p>Much more reliable would be to change the &#8220;Microsoft Word&#8221; shortcut (or some other popular app) on the Start menu to point to a Trojan horse app.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1219701">
				<div id="div-comment-1219701" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219701">
			December 17, 2015 at 8:21 am</a>		</div>

		<p>[There is no elevation because the Restore operation will not be able to drop the file anywhere the user doing the restoring doesn’t already have write access to.]</p>
<p>This. I wish certain people would think before submitting vulnerabilities.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-jeremytais odd alt depth-2" id="comment-1219744">
				<div id="div-comment-1219744" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/SimonRev' rel='external nofollow' class='url'>SimonRev</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219744">
			December 17, 2015 at 1:39 pm</a>		</div>

		<p>I don&#8217;t.  I enjoy these occasional light pokes at overzealous &#8220;researchers.&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1219721">
				<div id="div-comment-1219721" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219721">
			December 17, 2015 at 10:56 am</a>		</div>

		<p>People sure are desperate to prove that they have pwned Microsoft.</p>
<p>Also, wow Firefox: &#8216;pwned&#8217; is in your spell check dictionary?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command odd alt depth-2" id="comment-1219821">
				<div id="div-comment-1219821" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219821">
			December 18, 2015 at 1:42 am</a>		</div>

		<p>Desperate? Microsoft&#8217;s immense monetary award is enough motive for non-desperate people too.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1 parent" id="comment-1219791">
				<div id="div-comment-1219791" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219791">
			December 17, 2015 at 6:50 pm</a>		</div>

		<p>Off topic post about the blogging site: Seems Raymond&#8217;s auto posting program started posting to the old blog site again. The articles of past few days appears in my RSS reader (IE11) and transfers to the old site without comments. :P</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1219841">
				<div id="div-comment-1219841" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219841">
			December 18, 2015 at 2:27 am</a>		</div>

		<p>Worse, this article didn&#8217;t appear in my RSS reader, so I had to manually navigate to it&#8230;</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-3" id="comment-1219971">
				<div id="div-comment-1219971" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219971">
			December 19, 2015 at 2:19 am</a>		</div>

		<p>This article did appear on my RSS feed but today, three old posts with the old not-so-pleasant theme and no comment section appeared. Links are different, so I am still able to navigate to the old topics with this new theme.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1219801">
				<div id="div-comment-1219801" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151217-00/?p=92663#comment-1219801">
			December 17, 2015 at 6:54 pm</a>		</div>

		<p>I think it can probably be problematic for someone who is mandated to use EFS (say officers of government bodies which process sensitive data) if the Recycle folder is not encrypted with the user&#8217;s credential.</p>
<p>Not sure if that&#8217;s the case, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>