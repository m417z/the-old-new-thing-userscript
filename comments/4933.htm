<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1045523">
				<div id="div-comment-1045523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045523">
			March 18, 2013 at 7:39 am</a>		</div>

		<p>Presumably you&#39;d use something less likely to change than the name of the shortcut, such as the target&#39;s full path (minus command line parameters), or some other field (do shortcuts get an internal unique ID? &nbsp;I don&#39;t know much about these things).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045533">
				<div id="div-comment-1045533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045533">
			March 18, 2013 at 7:41 am</a>		</div>

		<p>Alternatively, depending on what use case this tool is for, you may also want to extend your program to backup the entire contents of the user&#39;s Desktop folder (and perhaps the shared Desktop folder) elsewhere along with the icon position information, and restore it later. &nbsp;In which case renamed shortcuts aren&#39;t a problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045613">
				<div id="div-comment-1045613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeffrey Bosboom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045613">
			March 18, 2013 at 10:50 am</a>		</div>

		<p>I&#39;m surprised programmatic access to desktop icon arrangement is supported, given the potential for evil applications to insist their icon appear in a particular location. &nbsp;Though I guess programs would try to move files off the desktop, create their icon, then (hopefully) move the files back to the desktop &#8212; so perhaps just letting them move their icon is a harm reduction strategy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045623">
				<div id="div-comment-1045623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">C1</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045623">
			March 18, 2013 at 11:31 am</a>		</div>

		<p>For those trying to mess with their coworkers, spView-&gt;SetCurrentFolderFlags(FWF_AUTOARRANGE | FWF_SNAPTOGRID, 0); requires IFolderView2 only available on Vista or later.</p>
<p>Funny that this doesn&#39;t require elevation to mess with the desktop.</p>
<div class="post">[<em>Non-issue because <code>SWC_DESKTOP</code> already requires Vista or higher. And this doesn&#39;t require elevation because non-administrators are allowed to customize their desktop icon positions. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045633">
				<div id="div-comment-1045633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045633">
			March 18, 2013 at 12:11 pm</a>		</div>

		<p>@C1: I would think that the &quot;airtight hatchway&quot; rule applies to desktop icon positioning.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045663">
				<div id="div-comment-1045663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RE: desktop icon position</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045663">
			March 18, 2013 at 3:31 pm</a>		</div>

		<p>I wished for something like this in the XP days, so that icons could be properly restored after resolution changes. At one point when I attempted my multiple desktops app, I thought of this to allow different icon layout per desktop&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1045693">
				<div id="div-comment-1045693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045693">
			March 18, 2013 at 11:24 pm</a>		</div>

		<p>I&#39;ll suggest to put the &quot;reminder&quot; thing inside the code as comment. So if the code somehow ends in some production code, the people following the code can have a chance to know what should be done with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045713">
				<div id="div-comment-1045713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1045713">
			March 19, 2013 at 4:19 am</a>		</div>

		<p>The solution to the exercise is to create and serialise shortcuts to all of the desktop items. The shell will then track the shortcuts&#39; targets for you. More information is available in a handy blog post from 24th February, 2011.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gregm even thread-even depth-1" id="comment-1046013">
				<div id="div-comment-1046013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/GregM' rel='external nofollow' class='url'>GregM</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1046013">
			March 19, 2013 at 8:01 pm</a>		</div>

		<p>&quot;More seriously, we can we put the two pieces together to make a program that saves and restores desktop icon positions.&quot;</p>
<p>I was very happy when I got to this sentence. &nbsp;This was exactly what I thought of when I read the article title.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1046233">
				<div id="div-comment-1046233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1046233">
			March 20, 2013 at 12:33 pm</a>		</div>

		<p>&quot;Non-issue because SWC_DESKTOP already requires Vista or higher. And this doesn&#39;t require elevation because non-administrators are allowed to customize their desktop icon positions.&quot;</p>
<p>But annoyingly, they can&#39;t remove shared desktop icons. &nbsp;Which makes sense from a security standpoint (no access to remove the shortcut) but not a UX standpoint (imo Explorer should simply hide the file if it can&#39;t remove it because of that type of issue).</p>
<div class="post">[<em>True, but then you have the problem of where to store this &quot;files that have been hidden&quot; state and what to do about it when the profile roams. (Since the shared desktop does not roam, but the user desktop does.) It&#39;s bad enough when icon positions are reset when your profile roams, imagine if files magically unhid too. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis even thread-even depth-1" id="comment-1046313">
				<div id="div-comment-1046313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1046313">
			March 20, 2013 at 8:39 pm</a>		</div>

		<p>This post reminds me of the time years ago when a customer requested that we build a custom solution that would ensure that the organization&#39;s logo in their mandated desktop wallpaper would never be obscured by an icon. &nbsp;If a new icon were created or a user moved an existing icon such that it obscured part of the logo, desktop monitoring software would move it someplace else. &nbsp;That still ranks as the single dumbest customer request I can remember ever receiving. &nbsp;(And that&#39;s saying something.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf odd alt thread-odd thread-alt depth-1" id="comment-1046363">
				<div id="div-comment-1046363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933#comment-1046363">
			March 21, 2013 at 7:13 am</a>		</div>

		<p>Wait, you can use CSIDLs in place of PIDLs? I always thought they only worked with SHGet[Special]FolderLocation/Path&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>