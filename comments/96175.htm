<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (64)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1296396">
				<div id="div-comment-1296396" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296396">
			May 17, 2017 at 7:09 am</a>		</div>

		<p>Of course, TRWTF is that Program X is continually trying to set itself as the default handler, without asking the user if that&#8217;s what they wanted.</p>
<p>We know this is the case because, if Program X <em>did</em> ask the user for confirmation, the user could just say &#8220;no&#8221; and keep the preference they&#8217;d made in the &#8220;Set Default Programs&#8221; control panel &#8211; which was Program X!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt thread-odd thread-alt depth-1 parent" id="comment-1296405">
				<div id="div-comment-1296405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296405">
			May 17, 2017 at 7:15 am</a>		</div>

		<p>So Program X is overwriting the HKCU FileExts preference values even if it is already the default? I guess the lesson is, only be evil when you need to be, being evil all the time gets you in trouble. </p>
<p>(I&#8217;m kidding of course, the user should always be in control of their machine and its preferences)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1296425">
				<div id="div-comment-1296425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296425">
			May 17, 2017 at 7:23 am</a>		</div>

		<p>Program X thinks that the registry setting is corrupted (because it&#8217;s expecting the pre-Windows 10 format), so it helpfully &#8220;fixes&#8221; it. &#8220;No need to thank me. Just doing my job.&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks odd alt depth-3 parent" id="comment-1296435">
				<div id="div-comment-1296435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296435">
			May 17, 2017 at 7:37 am</a>		</div>

		<p>IApplicationAssociationRegistration::QueryCurrentDefault has been around since Vista so there is no excuse for using hacks for the detection part of this evil operation.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-iboyd even depth-4 parent" id="comment-1296795">
				<div id="div-comment-1296795" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296795">
			May 18, 2017 at 10:53 am</a>		</div>

		<p>That API, IApplicationAssociationRegistration::QueryCurrentDefault says it&#8217;s not intended for Windows 8. What would be the correct API to register file associations? MSDN documents the registry keys that must be manipulated directly in order to register an application with a file type.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks odd alt depth-5" id="comment-1296845">
				<div id="div-comment-1296845" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296845">
			May 18, 2017 at 3:14 pm</a>		</div>

		<p>You need to read a little between the lines here. The interfaces &#8220;root&#8221; page says &#8220;Note  As of Windows 8, the only functionality of this interface that is supported is QueryCurrentDefault.&#8221; and some intern probably got carried away with the copy and paste. On Windows 10 you can use the Assoc* API and ASSOCSTR_PROGID if that makes you feel better.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-3" id="comment-1296535">
				<div id="div-comment-1296535" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296535">
			May 17, 2017 at 9:33 am</a>		</div>

		<p>Unfortunately the current recommendation is broken. The UI cannot add a new file association that requires a command line argument. Also, that UI is pretty clunky; a program whose sole purpose is to edit file associations should be able to exist.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1296465">
				<div id="div-comment-1296465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296465">
			May 17, 2017 at 8:38 am</a>		</div>

		<p>I suspect that Program X is writing to the registry on it&#8217;s startup.  Many programs have a &#8220;check to see if I&#8217;m the default&#8221; setting within their options.  This program likely is checking the file association due to that option being set, finding the program association to be &#8220;corrupted&#8221;, and &#8220;fixing&#8221; it.  If my guess is correct, then clearing the &#8220;check to see if I&#8217;m the default&#8221; option should also help.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1296685">
				<div id="div-comment-1296685" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296685">
			May 18, 2017 at 4:56 am</a>		</div>

		<p>If that were the case, I expect Raymond would have suggested that as one of the customer choices.</p>
<p>That he doesn&#8217;t implies to me that Program X is one of those user-hostile programs that just assumes it&#8217;s the best thing ever, and always unconditionally tries to set itself as the default handler for every filetype it knows how to handle &#8211; and probably a few that it doesn&#8217;t.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1296825">
				<div id="div-comment-1296825" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296825">
			May 18, 2017 at 11:55 am</a>		</div>

		<p>We won&#8217;t know if that was the case for Program X, because we don&#8217;t know it&#8217;s identity.  The general point is worth remembering for these types of cases.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf even depth-2 parent" id="comment-1296656">
				<div id="div-comment-1296656" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296656">
			May 18, 2017 at 2:37 am</a>		</div>

		<p>Which reminds me, I&#8217;ve always wondered how the FileExts system interacts with the other association systems (such as HK??\Software\Classes, and I&#8217;m not sure there isn&#8217;t a third one somewhere), and which one was actually recommended nowadays.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks odd alt depth-3 parent" id="comment-1296665">
				<div id="div-comment-1296665" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296665">
			May 18, 2017 at 4:08 am</a>		</div>

		<p>The classes key has been the documented location since forever (The Applications key and the Default Programs registration also play a role). FileExts has never been documented AFAIK and is used to store &#8220;discovered&#8221; open-with entries and their order and other file type user preferences, applications should not write there. The shell will write there for the user.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fredericmagnyf even depth-4" id="comment-1296675">
				<div id="div-comment-1296675" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296675">
			May 18, 2017 at 4:52 am</a>		</div>

		<p>Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1296715">
				<div id="div-comment-1296715" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296715">
			May 18, 2017 at 7:46 am</a>		</div>

		<p>Yes, the user should be in control of their machine and its preferences.  However, if the user puts something into the registry in the wrong format, shouldn&#8217;t Windows revert it?  (Which is basically what Raymond is saying here.)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1296415">
				<div id="div-comment-1296415" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296415">
			May 17, 2017 at 7:20 am</a>		</div>

		<p>So, how do you set the system-default handler if you were a user encountering this issue?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-entegygmail-com odd alt depth-2" id="comment-1296485">
				<div id="div-comment-1296485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296485">
			May 17, 2017 at 8:55 am</a>		</div>

		<p>You would need to set it with an account that has admin access on the machine.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1296445">
				<div id="div-comment-1296445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AMX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296445">
			May 17, 2017 at 7:49 am</a>		</div>

		<p>How about changing the permissions on the registry key, so Program X can&#8217;t corrupt it any more?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1296475">
				<div id="div-comment-1296475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296475">
			May 17, 2017 at 8:44 am</a>		</div>

		<p>I can see two problems with blocking it via registry ACLs: 1, the user wouldn&#8217;t be able to set their own preferences via the Control Panel for that file type; 2, who knows how Program X will react if it can&#8217;t mess with the file associations?  Best case, it&#8217;ll handle it gracefully and ignore the error, or display a message box; worst case, it&#8217;ll go unresponsive and crash or require killing the process.  Given the hacky nature of their file association routines, I&#8217;m not betting on it handling things gracefully.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1296646">
				<div id="div-comment-1296646" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AMX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296646">
			May 18, 2017 at 12:02 am</a>		</div>

		<p>Re 1, it would be rather circuitous (un-protect key, possibly requiring an admin; change default; re-protect key, again possibly requiring an admin) but changing your defaults is not exactly a daily task&#8230;</p>
<p>Re 2, you have a good point there.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4 parent" id="comment-1296815">
				<div id="div-comment-1296815" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296815">
			May 18, 2017 at 11:52 am</a>		</div>

		<p>Changing the defaults <i>is</i> a daily task with Program X on Windows 10.  That&#8217;s kind of the point of the article.  And why make a task more difficult even if it&#8217;s not an everyday task?</p>
<p>You&#8217;re also presuming that the user has permissions to change the ACLs on the relevant reg keys.  If the user is not admin &#8211; which they shouldn&#8217;t be &#8211; then they can&#8217;t unblock the reg keys.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1296875">
				<div id="div-comment-1296875" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AMX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296875">
			May 18, 2017 at 11:23 pm</a>		</div>

		<p>But it&#8217;s only a daily task because the program keeps corrupting the registry key &#8211; if you prevent it from doing that, it becomes a one-time task.</p>
<p>No, I&#8217;m not &#8211; that&#8217;s why I have &#8220;possibly requiring an admin&#8221; in there&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1296926">
				<div id="div-comment-1296926" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296926">
			May 19, 2017 at 7:54 am</a>		</div>

		<p>@AMX: and if &#8220;possibly requiring an admin&#8221; involves calling IT to perform the task, then you&#8217;ve just made the task many times more difficult for yourself.  That&#8217;s not terribly helpful.<br />
Also, consider the case that Program X is not actually essential to the users&#8217; workflow.  That was a core assumption on Raymond&#8217;s part, but in many cases, X can be replaced with Program Y, Z, A, whatever, or the user just wants to try a new PDF program.  Then they set the default to be Program Y, except that they can&#8217;t; they have to call up IT to make the change for them.  Repeat for Program Z, A, B, etc.<br />
It&#8217;s best not to mess with ACLs on system registry keys.  Doing so usually invites a support nightmare and unintended consequences for yourself.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2 parent" id="comment-1296636">
				<div id="div-comment-1296636" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296636">
			May 17, 2017 at 10:25 pm</a>		</div>

		<p>*Programs* don&#8217;t have permissions, *users* do. I&#8217;m sure Raymond has explained this himself in the past.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1296645">
				<div id="div-comment-1296645" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AMX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296645">
			May 17, 2017 at 11:41 pm</a>		</div>

		<p>I don&#8217;t see how that&#8217;s relevant?<br />
Once the file association has been configured, the user does not need write permission for the reg key any more, so you can set it to read-only to protect it from any programs running in that user&#8217;s context.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1296855">
				<div id="div-comment-1296855" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.bio/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296855">
			May 18, 2017 at 3:33 pm</a>		</div>

		<p>Users might want to change the default, say, if the current default program is uninstalled, which might include the case where the current default program is updated and the new version has a different ProgId for the handler. Another case is when the user installs another software that he wants to be the new default.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1296885">
				<div id="div-comment-1296885" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AMX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296885">
			May 18, 2017 at 11:25 pm</a>		</div>

		<p>Uninstalling the program would make the workaround unnecessary.</p>
<p>Adding another program is a scenario I had not considered, yes.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1296446">
				<div id="div-comment-1296446" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296446">
			May 17, 2017 at 7:52 am</a>		</div>

		<p>How is &#8220;setting the system default handler to program X&#8221; different than using &#8220;set default programs&#8221; to set the handler to Program X?  </p>
<p>I might be able to figure this out, but I didn&#8217;t know that we could change the DEFAULT handler for a program.  At least, not without mucking around in the registry.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1296455">
				<div id="div-comment-1296455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296455">
			May 17, 2017 at 8:03 am</a>		</div>

		<p><a href=https://blogs.technet.microsoft.com/mrmlcgn/2013/02/26/windows-8-associate-a-file-type-or-protocol-with-a-specific-app-using-gpo-e-gdefault-mail-client-for-mailto-protocol/ rel="nofollow">There&#8217;s a group policy for that</a>.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2 parent" id="comment-1296515">
				<div id="div-comment-1296515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296515">
			May 17, 2017 at 9:12 am</a>		</div>

		<p>&#8220;set default programs&#8221; sets the per-user default handler, rather than the system default handler.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1296725">
				<div id="div-comment-1296725" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296725">
			May 18, 2017 at 7:47 am</a>		</div>

		<p>Ah, thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com even thread-odd thread-alt depth-1" id="comment-1296486">
				<div id="div-comment-1296486" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296486">
			May 17, 2017 at 8:57 am</a>		</div>

		<p>Just FYI, I believe version 11 or above of Program X use the correct methods to set PDF associations.</p>
<p>Is that vague enough? We all know who the culprit is here right&#8230;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1296495">
				<div id="div-comment-1296495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296495">
			May 17, 2017 at 8:58 am</a>		</div>

		<p>A related question would be, why does Microsoft invent a whole new file association system every time there&#8217;s a new version of Windows?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1296525">
				<div id="div-comment-1296525" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mantas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296525">
			May 17, 2017 at 9:19 am</a>		</div>

		<p>Precisely because of such programs, I would assume.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com odd alt depth-2" id="comment-1296545">
				<div id="div-comment-1296545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296545">
			May 17, 2017 at 9:55 am</a>		</div>

		<p>It doesn&#8217;t. The current system has been in place since Vista. 10 finally enforced it.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-iboyd even thread-odd thread-alt depth-1 parent" id="comment-1296505">
				<div id="div-comment-1296505" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296505">
			May 17, 2017 at 9:05 am</a>		</div>

		<p>But the <a href=https://msdn.microsoft.com/en-us/library/windows/desktop/cc144148.aspx rel="nofollow">documented way to register your application as the handler is through the registry</a>.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-archangelpip odd alt depth-2 parent" id="comment-1296546">
				<div id="div-comment-1296546" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296546">
			May 17, 2017 at 10:24 am</a>		</div>

		<p>What he means is that for any extension, there are now at least two keys to control what program opens a file extension. The one for the extension itself (.myext) and the one that contains the information to open the file with a program.<br />
This application that is being kind is probably updating the .pdf registry key directly, not having a separate pdffile or whatever key that has all of the commands to open the file that the .pdf key would then link to.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-iboyd even depth-3 parent" id="comment-1296785">
				<div id="div-comment-1296785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296785">
			May 18, 2017 at 10:49 am</a>		</div>

		<p>What is the documented way to register my application to open a particular file extension? The documentation is to use the registry.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-4 parent" id="comment-1296796">
				<div id="div-comment-1296796" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296796">
			May 18, 2017 at 11:07 am</a>		</div>

		<p>You use HKCR to declare that your application can handle a file type. But you let the system manage the default.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1296936">
				<div id="div-comment-1296936" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296936">
			May 19, 2017 at 8:18 am</a>		</div>

		<p>The linked article does not make the distinction (between being able to handle a file type, and being the default handler) very clear.</p>
<p>It says &#8220;To associate the file type with an existing application, &#8230;&#8221; you muck around in the registry.  &#8220;Associating&#8221; sounds like &#8220;setting the program that will handle the file type&#8221;.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1296557">
				<div id="div-comment-1296557" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.bio/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296557">
			May 17, 2017 at 12:46 pm</a>		</div>

		<p>Registering a file association is NOT setting it as default also. If the extension has not a handler yet, the newly registered handler will become the default. If the extension already has a handler, Explorer will ask the user if they want to use the new handler the next time the user opens the file. That&#8217;s basically how it works.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1297315">
				<div id="div-comment-1297315" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297315">
			May 23, 2017 at 4:40 am</a>		</div>

		<p>I hope the &#8220;Do you want to keep using Program X&#8221; prompt gets eliminated. That seems to annoy my users more than anything.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1296547">
				<div id="div-comment-1296547" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">littlealex</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296547">
			May 17, 2017 at 10:29 am</a>		</div>

		<p>Isn&#8217;t this something that can be fixed by using a Shim?<br />
&#8220;Hey, Windows, when this software here tries to access the registry key for old stlye file extensions, please redirect it to this newly created harmles key, where it can do no damage, kthnxby&#8221;.<br />
Something like:<br />
VirtualRegistry: AddRedirect(originalkey^fakekey)</p>
<p>It should be possible, if I recall correct, for the user to create this shim for himself and use it on his own computer, no?<br />
Con: Shims aren&#8217;t very easy<br />
Pro: The user can now set any program he wants as PDF handler, without Program X messing up his setting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1296555">
				<div id="div-comment-1296555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Leo Davidson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296555">
			May 17, 2017 at 11:06 am</a>		</div>

		<p>It sure is great that the file association system in Windows is now so complicated, involving about 10 differetn places in the registry and obfuscated data (and don&#8217;t even get me started on Metro apps which you can&#8217;t even get the NAME of from the Win32 side).</p>
<p>Debugging problems with it, or trying to replicate the system but with slight differences (say if you want to let people override what happens for some file types, but only inside your application, or if a key is held down, for example), is a nightmare.</p>
<p>All to perpetuate an endless arms race between &#8220;bad&#8221; apps (which are often just doing what the user actually wants them to do) and the OS, which the OS cannot win as there is always a way around it, resulting in yet another layer added on top in a future version of Windows.</p>
<p>Ditto pinning things to the taskbar (which Microsoft do with their own apps, against the rules, and which another popular browser has worked out how to do).</p>
<p>Ditto pinning things to the Start Menu, which now seems to be restricted to Explorer.exe and does not work from any other process (even the FIle Open dialog in Notepad, so it&#8217;s still the same shell code), despite putting the option in the context menus in all processes. The menu item is there in other processes but does nothing, so we start fielding bug reports. But any app that really wanted to break the rules could fairly trivially run the context menu command inside Explorer.exe via various routes.</p>
<p>Writing for the Windows shell is really annoying these days.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1296565">
				<div id="div-comment-1296565" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.bio/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296565">
			May 17, 2017 at 12:57 pm</a>		</div>

		<p>I love the hash mechanism, but it can be worked around by simply removing it. See <a href="https://ardamis.com/2015/12/01/configuring-a-default-application-for-protected-file-types-in-windows-10/" rel="nofollow">https://ardamis.com/2015/12/01/configuring-a-default-application-for-protected-file-types-in-windows-10/</a> . This new mechanism makes it hard to deploy policies :-(</p>
<p>BTW, my guess is that X is playing with the <code>UserChoice</code> and cannot fill in the correct hash, which corrupts the association choice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1296587">
				<div id="div-comment-1296587" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Seitz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296587">
			May 17, 2017 at 3:14 pm</a>		</div>

		<p>You don&#8217;t ask the producers of Program X to stop using registry keys.  You tell the producers of Program X that you can&#8217;t set their program as the default.</p>
<p>Since being the user&#8217;s default is apparently very important to the producers of Program X, I expect they will be highly motivated to fix this problem.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1296606">
				<div id="div-comment-1296606" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.bio/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296606">
			May 17, 2017 at 4:54 pm</a>		</div>

		<p>ROTFL this is a perfect example how to do something by not doing it.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1 parent" id="comment-1296595">
				<div id="div-comment-1296595" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296595">
			May 17, 2017 at 3:17 pm</a>		</div>

		<p>Before Windows 10, I could set the file associations for other users and they were all set when they first logged in. Now, I have to teach them how to do it, per system × person.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1296615">
				<div id="div-comment-1296615" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.bio/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296615">
			May 17, 2017 at 4:55 pm</a>		</div>

		<p>You still can, see the link I mentioned in an earlier reply. Bra you can use GPO, which is documented.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com even depth-2 parent" id="comment-1296745">
				<div id="div-comment-1296745" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296745">
			May 18, 2017 at 8:11 am</a>		</div>

		<p>You can do this: <a href="https://technet.microsoft.com/en-ca/library/hh825038.aspx" rel="nofollow">https://technet.microsoft.com/en-ca/library/hh825038.aspx</a></p>
<p>Users who already have a profile on the machine aren&#8217;t affected, but new users logging in will get your customized defaults, and then can change it based on their preferences later. Or if you don&#8217;t want your users to pick their own file associations, GPO.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command odd alt depth-3 parent" id="comment-1296765">
				<div id="div-comment-1296765" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296765">
			May 18, 2017 at 9:02 am</a>		</div>

		<p>Er&#8230; Your link seems broken.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-entegygmail-com even depth-4" id="comment-1296945">
				<div id="div-comment-1296945" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296945">
			May 19, 2017 at 8:54 am</a>		</div>

		<p>Microsoft seems to keep moving documentation around. Here it is on MSDN instead of TechNet.</p>
<p><a href="https://msdn.microsoft.com/en-us/windows/hardware/commercialize/manufacture/desktop/export-or-import-default-application-associations" rel="nofollow">https://msdn.microsoft.com/en-us/windows/hardware/commercialize/manufacture/desktop/export-or-import-default-application-associations</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1296676">
				<div id="div-comment-1296676" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.tymme.org' rel='external nofollow' class='url'>Timm</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296676">
			May 18, 2017 at 4:55 am</a>		</div>

		<p>Now if only Windows 10 would respect the defaults when they are set properly, and not decide to make sure I don&#8217;t want to use Edge or something else I intentionally changed from default (&#8220;Keep using&#8230;&#8221;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1296835">
				<div id="div-comment-1296835" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Erkin Alp Güney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296835">
			May 18, 2017 at 12:21 pm</a>		</div>

		<p>I know who did that but rules prevent me to post it</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1296907">
				<div id="div-comment-1296907" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296907">
			May 19, 2017 at 4:23 am</a>		</div>

		<p>I think Windows 8 (and Window 10) is to be blamed for this. Windows 8 removed the ability to programmatically change defaults. While this was done in the interests of protecting user choice, it greatly inconvenienced everyone including users. The correct way would have been to allow programmatic default changing but show a notification to the user that the defaults have changed. When the user clicks the notification, the change in defaults gets undone/reverted.</p>
<p>By crippling installers and programs ability to change defaults and exclusively allowing the Default Programs page to change them, Microsoft created this mess.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1296925">
				<div id="div-comment-1296925" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296925">
			May 19, 2017 at 7:10 am</a>		</div>

		<p>And then you get <a href=https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413/" rel="nofollow">this</a>, where two people keep fighting over the association. Program X changes the association, then Windows displays a dialog box and resets it, then program X changes the association again, then Windows displays a dialog box and resets it etc. The user is now stuck in an infinite loop of dialog boxes.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1296985">
				<div id="div-comment-1296985" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296985">
			May 20, 2017 at 3:36 am</a>		</div>

		<p>Sure, the OS can&#8217;t protect against all badly coded apps but at least such a design would inform the user immediately (as soon as the app or its installer steals associations) that program X is that badly behaving app repeatedly stealing associations. At that point, it&#8217;s the user&#8217;s decision whether to continue using the badly behaving app or uninstall it.</p>
<p>The current behavior in Windows 8/10 breaks all installers and apps trying to associate on demand (when the user intentionally wants to make that app default using the *app provided UI*). Many times, the developer chooses to not register his program in Default Programs and there is no easy way for the average user to add it there without Registry fiddling.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com even depth-2 parent" id="comment-1296955">
				<div id="div-comment-1296955" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296955">
			May 19, 2017 at 8:57 am</a>		</div>

		<p>If you really are xpclient, then I know you don&#8217;t use Windows 10 or you already would know the answer to this.</p>
<p>If multiple programs register for a file type correctly, then Windows 10 <i>does</i> pop up a message asking if you want to use the new app or keep your current settings when you try to open a file of that type. Firefox triggered this for a little while after every update before it was fixed.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1296996">
				<div id="div-comment-1296996" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1296996">
			May 20, 2017 at 3:50 am</a>		</div>

		<p>Yes I don&#8217;t use Windows 10 because my slow internet cannot handle 350 MB updates of zero value to me almost every week. Even with Unified Update Platform, they couldn&#8217;t keep the update size below 50 MB per month. This rules out Windows 10 for the next 20-25 years until the area where I live has faster internet connection available.</p>
<p>But I&#8217;ve observed how it behaves in case of file associations. It shows that dialog when the user opens the file. It should notify the user as soon as the offending app steals the association that &#8220;Program X has made itself the default. Click here to undo this change.&#8221; The system&#8217;s job is to inform, not play middleman. Or it may not be even that hard to add an additional option &#8220;Don&#8217;t notify about file associations for this app again.&#8221; They could make this setting encoded in the Registry so apps can&#8217;t fool around with it.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1297635">
				<div id="div-comment-1297635" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297635">
			May 25, 2017 at 12:53 pm</a>		</div>

		<p>So, you basically want Windows to slow itself down by constantly polling two entire registry trees for each user logged in, just in case some program somewhere starts digging around where it shouldn&#8217;t?  Because, without doing that, the system has know way of knowing when one of those keys has changed until it actually tries to use them.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1297865">
				<div id="div-comment-1297865" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297865">
			May 27, 2017 at 7:07 am</a>		</div>

		<p>Have you heard of Event logs?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1297285">
				<div id="div-comment-1297285" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tribletrouble</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297285">
			May 23, 2017 at 12:36 am</a>		</div>

		<p>I created a script at some point. Might not be Perfect. But it could be a solution for some.<br />
<a href="https://social.technet.microsoft.com/Forums/en-US/f949da5a-e0df-4b92-ba23-bf05635fbb12/group-policy-and-xml-files-for-configuring-fileassociations-in-windows-10?forum=win10itprosetup" rel="nofollow">https://social.technet.microsoft.com/Forums/en-US/f949da5a-e0df-4b92-ba23-bf05635fbb12/group-policy-and-xml-files-for-configuring-fileassociations-in-windows-10?forum=win10itprosetup</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1297305">
				<div id="div-comment-1297305" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297305">
			May 23, 2017 at 4:15 am</a>		</div>

		<p>Can you please make file associations not go through this for user accounts created before Sysprep? File associations reset for these accounts after Sysprep even if they were set before Sysprep in the Windows 10-aporoved way.</p>
<p>We need pre-created user profiles for all our kiosks and public-facing computers.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1297405">
				<div id="div-comment-1297405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297405">
			May 23, 2017 at 12:21 pm</a>		</div>

		<p>Except the behavior of SysPrep requires that ALL (except for the Administrator&#8217;s) user profiles be removed prior to SysPrep.  Somewhere back (I forgot when), Microsoft said that if multiple profiles exist when SysPrep is ran, then SysPrep may &#8220;pick&#8221; the wrong one.  Although maybe this requriement is for using &#8220;CopyProfile&#8221;.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1297695">
				<div id="div-comment-1297695" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://levicki.net' rel='external nofollow' class='url'>Igor Levicki</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170517-00/?p=96175#comment-1297695">
			May 25, 2017 at 8:22 pm</a>		</div>

		<p>I think that Windows went too far in &#8220;protecting&#8221; users from hostile programs messing with file associations.</p>
<p>My biggest grief is that ever since Vista setting custom and complex associations with multiple action verbs for programs and command line tools has progressed from mildly annoying over royal pain in the butt to almost impossible.</p>
<p>And dont even get me started about Windows Media Player which if removed breaks programs which embed it but if left installed associates everything to itself and clutters context menu.</p>
<p>Why not just let advanced users edit associations directly is beyond me, but I guess the company which took it upon themselves to decide how long we may use our PC without reboot doesn&#8217;t know better than to annoy people with artificial restrictions.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>