<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (19)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-256893">
				<div id="div-comment-256893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Maas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256893">
			February 21, 2005 at 9:19 am</a>		</div>

		<p>I&#8217;m guessing the point of these modality articles is to point out the pitfalls of code modality without UI modality? In my experience it seems every time I have code modality it leads to trouble (due to re-entrancy or other unexpected interactions with the outer event loop). State machines or threads are more difficult to write than modal code but seem like the only alternative.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256923">
				<div id="div-comment-256923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dashslot.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256923">
			February 21, 2005 at 11:30 am</a>		</div>

		<p>Found QBasic, should anyone care:</p>
<p><a target="_new" href="http://download.microsoft.com/download/win95upg/tool_s/1.0/W95/EN-US/olddos.exe" rel="nofollow">http://download.microsoft.com/download/win95upg/tool_s/1.0/W95/EN-US/olddos.exe</a></p>
<p>(Also, an edit button for comments would be nice. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256933">
				<div id="div-comment-256933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Billy Boy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256933">
			February 21, 2005 at 12:58 pm</a>		</div>

		<p>Why doesn&#8217;t CreateDialog/DialogBox has a bit-flag if it should be modal?</p>
<p>&quot;12 lines of text is enough for everyone.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256943">
				<div id="div-comment-256943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256943">
			February 21, 2005 at 1:04 pm</a>		</div>

		<p>CreateDialog is the modeless function and DialogBox the modal one. If you really want one function with a bit-flag you are free to write it yourself.</p>
<p>CustomFunction(&#8230;, BOOL fModal)<br />
<br />{<br />
<br /> if (fModal) DialogBox(&#8230;);<br />
<br /> else CreateDialog(&#8230;);<br />
<br />}<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256963">
				<div id="div-comment-256963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256963">
			February 21, 2005 at 1:36 pm</a>		</div>

		<p>When are you going to address the even more important issue of Code morality? :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256973">
				<div id="div-comment-256973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">.ten</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256973">
			February 21, 2005 at 1:40 pm</a>		</div>

		<p>modality schmodality. stop making excuses, i want tabbed browsing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256983">
				<div id="div-comment-256983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256983">
			February 21, 2005 at 4:49 pm</a>		</div>

		<p>That&#8217;s the IE team, second door on your left.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256993">
				<div id="div-comment-256993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeremy Morton [MSFT]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256993">
			February 21, 2005 at 4:51 pm</a>		</div>

		<p>Don&#8217;t tab my browser; I don&#8217;t want to have to go to yet another place to switch between windows, the taskbar and Alt-Tab work perfectly well for that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257003">
				<div id="div-comment-257003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">zd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257003">
			February 21, 2005 at 6:09 pm</a>		</div>

		<p>When a window is in menu mode, it seems that all WM_MOUSEMOVE messages in the same message queue are dispatched to that window rather than their original windows. Why is it so?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-257013">
				<div id="div-comment-257013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257013">
			February 21, 2005 at 6:29 pm</a>		</div>

		<p>Zd: so that it can figure out where the mouse is so it can tear down the Window when you click outside of it, given that the menu neither gets focus nor activation.</p>
<p>Do a search for &quot;Fakemenu&quot; &#8211; which is one of Raymond Chen&#8217;s wonderful example pieces of code, and invaluable for those who want to learn the finer points of making Windows sit up and beg &#8211; on Google Groups.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257023">
				<div id="div-comment-257023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257023">
			February 21, 2005 at 6:30 pm</a>		</div>

		<p>Oh, and Zd, there&#8217;s a little addenda for that:</p>
<p>It&#8217;s also so that your message loop &#8211; which might have its own translation and pre-translation code in it &#8211; doesn&#8217;t interfere with the operation of the menu. So it just pushes it entirely out of the equation until it&#8217;s done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256913">
				<div id="div-comment-256913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dashslot.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-256913">
			February 21, 2005 at 11:25 am</a>		</div>

		<p>I remember back in the dim and distant days I wrote a bunch of GUI-type code in, horror of horrors, QBasic, and trying to maintain state during various interactions was tricky, but worth the effort.</p>
<p>The first iteration was completely modal (in a manner of speaking) &#8212; if a window popped up, nothing else could happen (GUI-wise) in the underlying application until the popup was closed.  However, this somewhat limited its usefulness, so the second iteration went to the other extreme and (unless the application writer deliberately interfered with the &quot;message queue&quot;) everything was non-modal; rather counterintuitively the second iteration wound up being significantly shorter and more elegant (although I guess that&#8217;s in some part due to the fact that I&#8217;d learned a lot of lessons from v1).</p>
<p>The relevance?  Ever since then I&#8217;ve tried my best to avoid any sort of modal situation; apart from one or two edge-cases it&#8217;s not neccessary, and is almost universally irritating &#8212; I&#8217;d wager that everyone reading this has, at one time or another, navigated through a series of modal dialogs only to realise that some vital piece of information they need is now hidden by a previous level of dialog neccessitating a quick backtrack.  Even if Windows would let you *move* the windows stuck underneath it&#8217;d be an improvement&#8230;</p>
<p>(As an aside, does anyone have a copy of QBasic or where I can get one?  I must confess to having a soft spot for it, but I seem to have discarded my last remaining copy of Win95.  Sure, it&#8217;s of little practical use these days, but I want to throw me some bananas! :)</p>
<p>(As another aside, does anyone else get annoyed with the piddly little text box for entering comments here?  It&#8217;s a pain having to fire up Notepad every time, but it&#8217;s almost impossible to proofread anything if you can only see 12 lines of 48-column text; it&#8217;s like using the C64 all over again, only worse!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257033">
				<div id="div-comment-257033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257033">
			February 21, 2005 at 10:39 pm</a>		</div>

		<p>This is horribly offtopic here but doesn&#8217;t anybody remeber that tabbed browsing was in IE long before Mozilla and Firefox even existed? IE 3.x (or was it 4.x?) had tabbed browsing. I&#8217;m glad it was removed (you can&#8217;t switch to a specific tab from a different app) but it might have been a user option like it is today in the other browsers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-257043">
				<div id="div-comment-257043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257043">
			February 21, 2005 at 10:41 pm</a>		</div>

		<p>This is horribly offtopic here but doesn&#8217;t anybody remeber that tabbed browsing was in IE long before Mozilla and Firefox even existed? IE 3.x (or was it 4.x?) had tabbed browsing. I&#8217;m glad it was removed (you can&#8217;t switch to a specific tab from a different app) but it might have been a user option like it is today in the other browsers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257083">
				<div id="div-comment-257083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257083">
			February 22, 2005 at 3:52 am</a>		</div>

		<p>Ive never found a good reference describing things like modality in the context of code and UI.</p>
<p>Anyway, when the user is engaged in a modal drag operation I would have thought that the UI was modal &#8211; I mean &#8211; the user is quite obviously stuck on that scrollbar until they let go of the mouse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-257093">
				<div id="div-comment-257093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2005/02/22/378018.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257093">
			February 22, 2005 at 10:00 am</a>		</div>

		<p>The WM_QUIT message lets multiple modal loops communicate with each other.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257223">
				<div id="div-comment-257223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257223">
			February 22, 2005 at 12:27 pm</a>		</div>

		<p>Aside of backwards compatibility, I don&#8217;t see why nested pumps are needed at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-257433">
				<div id="div-comment-257433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257433">
			February 23, 2005 at 11:36 pm</a>		</div>

		<p>Aside from backwards compatability with what?</p>
<p>Modal pumps arn&#8217;t *needed*, theyre just very convenient to localize functionality.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257563">
				<div id="div-comment-257563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050221-00/?p=36403#comment-257563">
			February 24, 2005 at 3:00 pm</a>		</div>

		<p>&quot;Aside from backwards compatibility&quot; just seems a safe thing to say, being that it seems like the perennial fallback explanation to every quirk.</p>
<p>With a little planning, I think functionality can be just as conveniently localized *without* modal pumps. But nobody I&#8217;ve ever worked with would take the time to (a) work it out, and (b) admire the elegance of the finished code as opposed to a modal hack.</p>
<p>This might all stem from my sky-is-falling mentality that wonders what my code would do if some goofy utility re-enabled the parent window of a dialog box.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>