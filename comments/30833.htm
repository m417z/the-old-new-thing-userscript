<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (47)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-392813">
				<div id="div-comment-392813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lionell Griffith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392813">
			June 19, 2006 at 10:26 am</a>		</div>

		<p>I am shocked. &nbsp;You don&#8217;t trust programmers. &nbsp;</p>
<p>Apparently you know more than three programmers. &nbsp;As near as I can tell, the vast majority of programmers view that simply being able to do something is adequate justification for doing it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392823">
				<div id="div-comment-392823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392823">
			June 19, 2006 at 10:36 am</a>		</div>

		<p>Why not allow a user override option? &nbsp;Or an option to order based on use frequency, similar to the Add/Remove Programs heuristic?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392843">
				<div id="div-comment-392843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392843">
			June 19, 2006 at 10:44 am</a>		</div>

		<p>I quite understand the reason not to allow programs to do this<br />
(unfortunately some unscrupulous software authors would abuse the<br />
previledge), however I also happen to think that if you start applying<br />
this approach everywhere, pretty soon you won&#8217;t be able to do ANYTHING<br />
programmatically. Flexibility goes out the door!</p>
<p>As an author of software that customizes the way windows looks and<br />
works, I run into this barrier quite often. What I want to do is<br />
actually in the INTEREST of the user (and by his request) but I can&#8217;t<br />
because there is no API to do it. In cases such as this, you are<br />
actually doing a diservice to your customers.</p>
<p>So why not just PROMPT the user with &#8216;Program X is trying to do<br />
this. Allow/Deny?&#8217; and provide the user with a checkbox never to ask<br />
again for that program? Vista is not shy of prompting the user for<br />
every little thing that might require Admin previledges, after all&#8230;<br />
;-)</p>
<div CLASS=post>[<i>&#8220;Provide the user with a checkbox never to ask again for that program.&#8221; And programs will find out where that checkbox is stored and set it programmatically, thereby suppressing the prompt. (See: Autoplay.) You&#8217;ve protected nothing. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392863">
				<div id="div-comment-392863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jamesmckay.net/' rel='external nofollow' class='url'>James McKay</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392863">
			June 19, 2006 at 10:54 am</a>		</div>

		<p>I&#8217;d have thought that if someone were that unscrupulous they&#8217;d find a way to do it programmatically even though there is no documented way of doing so. Hackers and virus writers do that kind of thing all the time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392873">
				<div id="div-comment-392873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lex.mitchell.spaces.msn.com/' rel='external nofollow' class='url'>Lex</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392873">
			June 19, 2006 at 10:58 am</a>		</div>

		<blockquote><p>
  So why not just PROMPT the user with &#8216;Program X is trying to do this. Allow/Deny?&#8217;</p>
<p>Wow I read the article and thought &#8211; yeah ok no-brainer but reading the comments already&#8230;</p>
<p>The goal is to have less confirm dialogs not more &#8211; I take your comparison of UAP as a joke but frankly it&#8217;s bad enough programs desparately loading out Quick Launch, system tray, folder and the desktop with launch icons let alone trying to force there way up on the main start bar.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392883">
				<div id="div-comment-392883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neal C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392883">
			June 19, 2006 at 10:59 am</a>		</div>

		<p>Jorge: &quot;So why not just PROMPT the user with &#8216;Program X is trying to do this. Allow/Deny?&#8217;&quot;</p>
<p>As history has shown (with the warnings about driver signing), the program will simply click &quot;Allow&quot; on your behalf.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392893">
				<div id="div-comment-392893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Sowul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392893">
			June 19, 2006 at 11:15 am</a>		</div>

		<p>Incidentally, going back to programs spamming quick launch et al, I sure wish Outlook didn&#8217;t feel the need to do that EVERY TIME I INSTALL AN UPDATE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392923">
				<div id="div-comment-392923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392923">
			June 19, 2006 at 11:27 am</a>		</div>

		<p>The Visual Studio toolbox has a related problem. Bring up the Choose Toolbox Items dialog box, click COM Components and see this at the top of the list.</p>
<p>&quot;:-) VideoSoft&#8230;&quot;</p>
<p>Who are these jerks, great name for their component.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-392933">
				<div id="div-comment-392933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392933">
			June 19, 2006 at 11:30 am</a>		</div>

		<p>&quot;the program will simply click &quot;Allow&quot; on your behalf&quot;</p>
<p>I would expect this to not be possible anymore with Vista, what with UAC, mandatory integrity levels, and the Secure Desktop&#8230; Hopefully :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392943">
				<div id="div-comment-392943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392943">
			June 19, 2006 at 11:31 am</a>		</div>

		<p>This was a good decision. I am a programmer.</p>
<p>Can anyone complaining please tell me why would I would need an API to rearrange the start menu?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392963">
				<div id="div-comment-392963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392963">
			June 19, 2006 at 11:33 am</a>		</div>

		<p>Mark: Even worse, Outlook makes itself the default mail client after every update. Very annoying if you want to use a different program. Of course, you can just uninstall it, but that&#8217;s no excuse for bad behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392983">
				<div id="div-comment-392983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392983">
			June 19, 2006 at 12:11 pm</a>		</div>

		<p>Jack, you would need an API to rearrange the Start menu if you wanted to write a program to rearrange the Start menu for the user. It seems obvious to me, at least. The OS lets you sort by name or drag-and-drop. If I want any order other than by name with folders first, I have to drag the items one-by-one. I&#8217;d like to write a program that keeps the folders at the end of the list.</p>
<p>Another thing I&#8217;d like to do is write a program to enforce a set order on all of the computers in my department. That way I can make sure that all of the programs that people use daily are right at the top in the same order on every computer. To do this now I have to walk to every machine and manually drag the items into order on each one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393003">
				<div id="div-comment-393003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lpetrazickis.livejournal.com' rel='external nofollow' class='url'>Leo Petr</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393003">
			June 19, 2006 at 12:44 pm</a>		</div>

		<p>Gabe, why don&#8217;t you just put those programs in the area above the separator line (one folder up from the Programs folder). Windows Update usually resides there, and it&#8217;s sorted separately from the stuff below the dividing line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393023">
				<div id="div-comment-393023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">IanA</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393023">
			June 19, 2006 at 12:59 pm</a>		</div>

		<p>We should &nbsp;understand that Users (and their wishes) are not always paramount. Quite often, in a Corporate environment for instance, the User is not your customer (as a Software Vendor) the Corporation is.</p>
<p>Will a Corporation wish to specify the order of items on the Start Menu? Maybe&#8230;</p>
<p>There is a fair bit of software written to stop Users doing things they shouldn&#8217;t. Who decides the limit of this, you? me? or the customers?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393043">
				<div id="div-comment-393043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393043">
			June 19, 2006 at 1:07 pm</a>		</div>

		<p>There is a technical solution to Jorge Coelho&#8217;s problem, but it involves significant complexity &nbsp;(including bureaucratic complexity) and the very real likelyhood that Microsoft would, yet again, be branded an onerous monopolizer for enforcing the solution: &nbsp;have Microsoft (or a designated third party) sign applications that are permitted to make these kinds of changes.</p>
<p>This might be handled in a manner similar to the way driver signing is accomplished.</p>
<p>I&#8217;m not suggesting that this is something MS needs to fix &#8211; just pointing out that a solution exists, if the desire for a solution is greater than the cost of providing it.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393073">
				<div id="div-comment-393073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reinder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393073">
			June 19, 2006 at 1:21 pm</a>		</div>

		<p>Back in the DOS days, you couldn&#8217;t programmatically change the order in which &#8216;DIR&#8217; listed files either, but there was a simple workaround: remove all items from a directory, then move them back in in the desired order.<br />
<br />I would guess that this might work for the start menu, too.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393093">
				<div id="div-comment-393093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Payne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393093">
			June 19, 2006 at 2:01 pm</a>		</div>

		<p>I think this is the wrong way to approach the problem. &nbsp;Windows already allows software to do lots of anti-social things â€“ I could make my application run on startup or stick my application icon in every possible location (quick launch, desktop, send to, start menu etc). &nbsp;Most applications are well behaved because customers will choose to avoid applications that break the rules (for example, a lot of people avoid a certain media player because it has a habit of installing a lot of annoying extra content).</p>
<p>By trying to enforce these requirements through not supplying APIs just annoys users with a legitimate use for them. &nbsp;In this case, one situation that comes to mind is a locked down environment where an IT department what to make sure all the icons in the Start Menu occur in a particular order (to make training easier).</p>
<p>This issue also comes up a lot on Pocket PC devices where, for some applications, a customer buys a lot of devices and requires them to be locked down so the user can only see certain parts of the UI. &nbsp;Pocket PC does a few things that make it hard to lock down devices. &nbsp;This might stop some unscrupulous developers from breaking the UI rules but also makes life more difficult for other developers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393103">
				<div id="div-comment-393103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393103">
			June 19, 2006 at 2:15 pm</a>		</div>

		<p>I don&#8217;t get the request to do it though. What application would have the need to reorder the start menu? Why? Start Menu is not part of any application, so why should one feel the need to change it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393123">
				<div id="div-comment-393123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://www.darklock.com/blog/' rel='external nofollow' class='url'>Caliban Darklock</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393123">
			June 19, 2006 at 2:19 pm</a>		</div>

		<p>There seems to be a common fallacy in these discussions. </p>
<p>When discussing the lack of an API and why it is a Good Thing, &quot;Why not provide an API and place a gateway dialog on it?&quot; is always met with &quot;The program will muck with the dialog.&quot; </p>
<p>But why is there an API for the dialog?</p>
<p>It seems to me that given the choice between &quot;no API for start menu sorting&quot; and &quot;no API for security dialog automation&quot;, the latter is already desirable anyway. We don&#8217;t want program X to try something nasty and programmatically click &quot;Allow&quot; on the resulting security dialog. That would be broken security, wouldn&#8217;t it?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393133">
				<div id="div-comment-393133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.developpeur.org/coq/archive/2006/06/19/21715.aspx' rel='external nofollow' class='url'>CoqBlog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393133">
			June 19, 2006 at 2:38 pm</a>		</div>

		<p>Si vous vous &amp;#234;tes toujours demander (ou si vous venez seulement de vous le demander en&amp;amp;nbsp;lisant ce&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393143">
				<div id="div-comment-393143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lionell Griffith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393143">
			June 19, 2006 at 2:40 pm</a>		</div>

		<p>There is a workaround. &nbsp;</p>
<p>Install program A in program group A and you will go to the top of the list. &nbsp;Alternatviely, you could switch to using Z&#8217;s and go to the bottom of the list. &nbsp;Unfortunately, all your competition has to do is use more A&#8217;s or Z&#8217;s. So you can&#8217;t win.</p>
<p>See yellow pages for countless examples of A and Z competition.</p>
<p>I really think its best to leave it as it is. &nbsp;Especially since &nbsp;cascade menus are a bloody pain to use when you have more than 10 things and more than two levels in it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393153">
				<div id="div-comment-393153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393153">
			June 19, 2006 at 4:35 pm</a>		</div>

		<p>Actually a politician (running for a city or township position) changed his last name to start with &#8216;AA&#8217; or &#8216;AAA&#8217; (Can&#8217;t remember which) to be at the top of the ballot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392913">
				<div id="div-comment-392913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392913">
			June 19, 2006 at 11:19 am</a>		</div>

		<p>Neil: &quot;the program will simply click &quot;Allow&quot; on your behalf&quot;</p>
<p>Ok, but that is an extreme case and the user, seeing this, can always uninstall the mis-behaving program. This is, in a way, similar to all those programs who put themselves in the Windows notification area (aka &#8216;systray&#8217; :-): most of them, if not all, give you an option NOT to do this or to remove their icon from that area &#8211; and the few that don&#8217;t, I promptly remove from my system. </p>
<p>You can trust *most* developers not to do something that will go against the user wishes, and the user to remove those programs that stubbornly do what you don&#8217;t want them to. The proof of this is that we do NOT have 1 mile long notification areas, although every program is free to put their icon there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392953">
				<div id="div-comment-392953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392953">
			June 19, 2006 at 11:33 am</a>		</div>

		<p>&quot;The proof of this is that we do NOT have 1 mile long notification areas, although every program is free to put their icon there. &quot;</p>
<p>Have you ever seen the default OS install from a vendor like Dell? We *do* have mile long notification areas, and most users aren&#8217;t proficient/patient enough to click through and disable every single icon. Not to mention spyware/adware that is difficult or impossible for a novice user to uninstall.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392973">
				<div id="div-comment-392973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-392973">
			June 19, 2006 at 12:00 pm</a>		</div>

		<p>&gt; You can trust *most* developers not to do something that will go against the user wishes</p>
<p>No. You can&#8217;t. If a dev is getting poked by his manager that he *will* put their program at the top, he&#8217;ll do it.</p>
<p>&gt; the user to remove those programs that stubbornly do what you don&#8217;t want them to.</p>
<p>Uh. No. If the user didn&#8217;t need the program, he wouldn&#8217;t have installed it (excluding all the crap that comes with a new Dell)</p>
<p>It&#8217;s even worse because now you&#8217;ve got to put up with the bad behaviour because you need the program to do stuff.</p>
<p>Look at all the people complaining about Outlook, which they (some of them) need to have so they can do email.</p>
<p>It&#8217;s like having to have Flash so that menus work in a website, and having to put up with all the bouncy animated annoying crap that comes along with installing Flash.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393173">
				<div id="div-comment-393173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paulcoddington.info' rel='external nofollow' class='url'>Paul Coddington</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393173">
			June 19, 2006 at 7:56 pm</a>		</div>

		<p>&quot;have Microsoft (or a designated third party) sign applications that are permitted to make these kinds of changes.&quot;</p>
<p>This then excludes small-time developers (eg: shareware authors) from the game, as happened with Microsoft Office development, because few people outside a corporation can afford the hideously overpriced annual certification fees.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393183">
				<div id="div-comment-393183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paulcoddington.info' rel='external nofollow' class='url'>Paul Coddington</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393183">
			June 19, 2006 at 8:04 pm</a>		</div>

		<p>&quot;Especially since &nbsp;cascade menus are a bloody pain to use when you have more than 10 things and more than two levels in it.&quot;</p>
<p>I have countless things in My Start menu, all easily and quickly accessable (many of them custom scripts, not just programs). &nbsp;It comes down to being organised for me (arrange things by task using the 7+-2 rule for every level).</p>
<p>Try doing the same with Vista&#8217;s menu, it is much much harder to navigate quickly, as Vista has destroyed the concept of instantly viewable hierachy. &nbsp;The search function is useless for a complex menu because not all shortcuts have unique names (and they would be too long to display properly if they had).</p>
<p>In short, designing a good Start Menu is not easy and I haven&#8217;t seen anything better for my workspace than what we have now. &nbsp;Wis coming is, IMO, designed for disorganised people with few programs installed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393193">
				<div id="div-comment-393193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393193">
			June 19, 2006 at 8:17 pm</a>		</div>

		<p>I wonder how difficult is to reverse-engineer the keys in HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerMenuOrder<br />
<br />if one really-really wants to :-)<br />
<br />Not that I think is a good idea.</p>
<p>But if we are here, why allow applications to set the run from &#8230;SoftwareMicrosoftWindowsCurrentVersionRun?<br />
<br />Start/Programs/Startup (which is visible) is not good enough for them?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393063">
				<div id="div-comment-393063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393063">
			June 19, 2006 at 1:19 pm</a>		</div>

		<p>Well, since the user can rearrange items and the system must remember that order, all you have to do is find and reverse-engineer the data that the OS stores. If you Google for MenuOrder you will find that people have already done that. I&#8217;m not sayin&#8217; it&#8217;s right, I&#8217;m just sayin&#8217; it&#8217;s been done. So there *is* an API, it&#8217;s called RegSetValue. :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393083">
				<div id="div-comment-393083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray Trent</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393083">
			June 19, 2006 at 1:31 pm</a>		</div>

		<p>This wouldn&#8217;t be *all* that hard to solve (technically speaking) on Vista: just make the settings for such a &quot;don&#8217;t show this confirmation dialog any more&quot; dialog require admin privs to change. </p>
<p>Then the offending app couldn&#8217;t just undo the user&#8217;s selection (but, sadly, that would mean the user would have to encounter UAP if they chose that option&#8230; you can&#8217;t have everything, where would you put it?). </p>
<p>It&#8217;s pretty justifiable in this case, apps that change stuff like this without the user&#8217;s permission are essentially acting like spyware unless that&#8217;s the primary function of that app (e.g. some kind of skinning app). </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393213">
				<div id="div-comment-393213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393213">
			June 19, 2006 at 8:35 pm</a>		</div>

		<blockquote><p>
  And programs will find out where that<br />
  <br />&gt; checkbox is stored and set it<br />
  <br />&gt; programmatically, thereby suppressing the<br />
  <br />&gt; prompt. (See: Autoplay.)</p>
<p>But Autoplay is already broken, whether or not third-party programs are added. &nbsp;TweakUI helps relieve a lot of the pain, though it doesn&#8217;t fix the underlying breakage.</p>
<p>Monday, June 19, 2006 11:31 AM by Jack<br />
  <br />&gt; This was a good decision. I am a programmer.<br />
  <br />&gt; Can anyone complaining please tell me why<br />
  <br />&gt; would I would need an API to rearrange the<br />
  <br />&gt; start menu? </p>
<p>Jack, you and I don&#8217;t need that API because you and I are programmers for things that don&#8217;t do theming. &nbsp;But programmers who do want to assist end users in doing theming, or who want to assist corporate IT departments in doing theming for their companies, or who want to assist OEMs in doing theming for their appliances, those are the programmers who need this kind of API.</p>
<p>Monday, June 19, 2006 1:19 PM by Dave<br />
  <br />&gt; Well, since the user can rearrange items</p>
<p>(except when prohibited by a setting ^_^)</p>
<p>&gt; and the system must remember that order,</p>
<p>Wanna bet?</p>
<p>Monday, June 19, 2006 1:21 PM by Reinder<br />
  <br />&gt; Back in the DOS days, you couldn&#8217;t<br />
  <br />&gt; programmatically change the order in<br />
  <br />&gt; which &#8216;DIR&#8217; listed files either, but there<br />
  <br />&gt; was a simple workaround: remove all items<br />
  <br />&gt; from a directory, then move them back in in<br />
  <br />&gt; the desired order.<br />
  <br />&gt; I would guess that this might work for the<br />
  <br />&gt; start menu, too.</p>
<p>I&#8217;ve seen one or two programs that use the same trick to arrange the task bar the way the user wants it too.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393223">
				<div id="div-comment-393223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393223">
			June 19, 2006 at 8:38 pm</a>		</div>

		<p>Just saw Mihai&#8217;s posting after submitting my previous one.</p>
<p>&gt; But if we are here, why allow applications<br />
<br />&gt; to set the run from<br />
<br />&gt; &#8230;SoftwareMicrosoftWindowsCurrentVersionRun?<br />
<br />&gt; Start/Programs/Startup (which is visible) is<br />
<br />&gt; not good enough for them? </p>
<p>That depends on the application. &nbsp;Antivirus programs, firewalls, and their opponents (malware) need the Run key.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393233">
				<div id="div-comment-393233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bimdotjimatgmaildotcom' rel='external nofollow' class='url'>Jim Bim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393233">
			June 19, 2006 at 8:47 pm</a>		</div>

		<p>I used to be able to reorder the start menu in W2K but that seems to have gone away in WXP. &nbsp;At least in the menu directly over the start button.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393113">
				<div id="div-comment-393113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393113">
			June 19, 2006 at 2:16 pm</a>		</div>

		<p>&gt; This wouldn&#8217;t be *all* that hard to solve (technically speaking) on Vista: just make the settings for such a &quot;don&#8217;t show this confirmation dialog any more&quot; dialog require admin privs to change.</p>
<p>How many people wil be running Vista as admins?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393253">
				<div id="div-comment-393253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zettaserve.com' rel='external nofollow' class='url'>Troy Phillips</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393253">
			June 19, 2006 at 9:16 pm</a>		</div>

		<p>I can understand why it is not good to allow programatic reordering, but I remember when I wished you could at least do &quot;sort alphabetically&quot; programatically. </p>
<p>A number of years ago, we used our own software deployment tool in a couple of large corporates. Whenever new software shortcut was advertised it would go to the bottom of the list (when the existing items where likely to be sorted) so we would get lots of calls from people who thought that they hadn&#8217;t received it at all because they assumed the wole list was sorted.</p>
<p>We eventually worked around it by deleting HKCUSoftwareMicrosoftWindowsCurrentVersionExplorerMenuOrder &#8211; not pretty I know :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393263">
				<div id="div-comment-393263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">m</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393263">
			June 19, 2006 at 9:23 pm</a>		</div>

		<p>Why does Microsoft make it so damn hard to use the same desktop settings on multiple computers? &nbsp;It pisses me off how many problems there are with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393273">
				<div id="div-comment-393273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393273">
			June 19, 2006 at 9:34 pm</a>		</div>

		<p>[It&#8217;s not deliberately obfuscated. It&#8217;s just naturally obfuscated. -Raymond]</p>
<p>Hehe. Granted, for some things, which still doesn&#8217;t invalidate my point. :-) </p>
<p>But other things are deliberately obfuscated &#8211; the MRU programs list in the Registry is deliberately encrypted using ROT13, for instance. Easy to break encryption, but kind of proves the point&#8230;And yes, I remember you discussing this issue before. :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393293">
				<div id="div-comment-393293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393293">
			June 19, 2006 at 10:01 pm</a>		</div>

		<p>&quot;I&#8217;ve seen one or two programs that use the same trick to arrange the task bar the way the user wants it too.&quot;</p>
<p>I use one of those programs. &nbsp;:)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393303">
				<div id="div-comment-393303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393303">
			June 19, 2006 at 10:41 pm</a>		</div>

		<p>Reading this, I&#8217;m always in question why there isn&#8217;t a confirm dialog function that other Windows program cannot directly send messages to(Maybe the system itself will prevent other programs from getting the HWnd or simply refuse relay the message to the dialog)&#8230; it&#8217;ll be good for the use of those security dialogs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393313">
				<div id="div-comment-393313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393313">
			June 19, 2006 at 11:14 pm</a>		</div>

		<p>Monday, June 19, 2006 9:34 PM by Jorge Coelho<br />
<br />&gt;&gt; [It&#8217;s not deliberately obfuscated. It&#8217;s<br />
<br />&gt;&gt; just naturally obfuscated. -Raymond]<br />
<br />&gt;<br />
<br />&gt; But other things are deliberately obfuscated<br />
<br />&gt; &#8211; the MRU programs list in the Registry is<br />
<br />&gt; deliberately encrypted using ROT13,</p>
<p>That&#8217;s only partly obfuscated. &nbsp;If a filename contains a mixture of Chinese, Italian, and native Japanese characters, only the Italian characters get ROTted. &nbsp;In this case the only thing more obscure than the security is the security policy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393243">
				<div id="div-comment-393243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393243">
			June 19, 2006 at 9:06 pm</a>		</div>

		<p>Mihai: &#8220;I wonder how difficult is to reverse-engineer the keys in&#8221; </p>
<p>Mihai, and others who suggested several other ways to solve this problem, of course you can always use some kind of a &#8216;hack&#8217; (this is what I do to read the &#8216;Recent Documents&#8217; list and the MRU programs list, for instance) but: </p>
<p>This is not officially supported by Microsoft and, as such, can change from Windows version to Windows version, or even service pack to service pack. It&#8217;s the kind of thing Raymond Chen frowns upon, and with reason. </p>
<p>For instance, with Win9x it was easy to display a Recent Documents menu: just show the contents of the special Recent Documents folder. Then in Windows 2000 Microsoft changed the rules and this folder would suddenly held HUNDREDS of shortcuts. To solve this problem you had to go to an undocumented Registry key and find the actual list there. With XP, the structure of this list changed yet again. </p>
<p>Now, don&#8217;t you think that a program whose purpose is to replace the actual Windows Start Menu, or use an alternate way to display the information in it, has a legitimate purpose in wanting to know what the Recent Documents list is? And the MRU Programs list? </p>
<p>This are just examples, the same way that re-ordering the contents of the Start Menu is an example: don&#8217;t hold on to it alone, think on a broader scale (glad some people suggested some uses for the re-ordering of Start Menu items, I actually could think of none, hehe). </p>
<p>Another example is the systray: if there was some kind of API to it, I would have been able to replace the systray with a much improved version a long time ago (one where the *user* could select the icon size he wants, specify custom icons, select which icons appear and which not &#8211; the later was implemented by MS in XP, but I could have added this to Win9x if only there was an API to deal with the systray). </p>
<p>Instead I had to come up with ugly &#8216;hacks&#8217; to capture the Windows systray into my application and render the background transparent, etc&#8230; And yes, I know how I can actually make my own replacement, but it involves running a service at start-up, etc&#8230; </p>
<p>Not trying to plug my own software, but, for instance, because it is actually easy to replace the Windows tasklist (you simply hide the real Windows taskbar and do your own windows enumeration) I am able to improve on it over what Microsoft has done so far: I can provide task snapshots in XP, the user can re-order tasks by drag &amp; drop, specify which tasks appear on the tasklist and which not, customize icons for specific programs, specify the size of icons on the tasklist, specify which mouse click does what &#8211; and I could go on&#8230;). </p>
<p>What I am trying to say is that if all this stuff was documented and Microsoft provided APIs for this instead of actually doing the opposite (i.e.; deliberately obfuscating the little information that is actually there) 3rd party software could actually build on the existing Windows functionality and add to it. </p>
<p>Having an open architecture is what made the PC great. When Microsoft deliberately obfuscates information, it is doing something akin to what IBM tried to do with the MCA bus, i.e.; lock the user into a proprietary way of doing things. And it forces 3rd parties to use undocumented hacks. </p>
<p>Obviously, all said and done, Microsoft still has to be very careful with things that might compromise the security of the system &#8211; but surely this is not it.</p>
<div CLASS=post>[<i>It&#8217;s not deliberately obfuscated. It&#8217;s just naturally obfuscated. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393443">
				<div id="div-comment-393443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meno</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393443">
			June 20, 2006 at 12:41 pm</a>		</div>

		<p>Personally I think all theming, skins, and similar customizations should be done away with and all users and writers of suck crap should be taken out and executed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393733">
				<div id="div-comment-393733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-393733">
			June 21, 2006 at 7:56 am</a>		</div>

		<p>Meno, don&#8217;t like it, don&#8217;t use it&#8230; and leave the rest of us alone, enough executions and death going on in the world already. :-)</p>
<p>Also, just because a program is skinnable, doesn&#8217;t mean it doesn&#8217;t offer functionality enhancements as well (shameless plug: Winstep applications focus on usability enhancements *and* they also happen to be skinnable). </p>
<p>I bet you used WinAmp for a long time as an MP3 player &#8211; and WinAmp is basically THE program that gave birth to the skinning movement.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394723">
				<div id="div-comment-394723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">XrX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-394723">
			June 23, 2006 at 12:06 am</a>		</div>

		<p>I don&#8217;t have a problem with skinnable programs, just so long as they allow you to turn OFF tha damndable skins, I don&#8217;t need fancy bells and whistles eating up my clock cycles, I want it lean and mean (Eye candy doesn&#8217;t improve my productivity one iota.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-395303">
				<div id="div-comment-395303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-395303">
			June 24, 2006 at 1:22 pm</a>		</div>

		<p>XrX: &quot;Eye candy doesn&#8217;t improve my productivity one iota&quot;</p>
<p>But sells, and everybody loves a beautiful thing. I fully agree, however, that when it comes down to it it&#8217;s the performance/functionality that really counts. Now, if you can get the two together (and that has always been my goal) then you can have your pie and eat it too. :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396193">
				<div id="div-comment-396193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-396193">
			June 28, 2006 at 8:39 am</a>		</div>

		<p>Like &quot;Windows Update&quot;, &quot;Activate Windows&quot; and &quot;Set Program Access and Defaults&quot; that automatically appear on top of the Start menu?</p>
<p>Oh, and I think Microsoft should add some trick to automatically destroy these stupid &#8216;Uninstall $program&quot; entries from the start menu.</p>
<p>Didn&#8217;t the Add and remove programs dialog come with Windows 95?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-410643">
				<div id="div-comment-410643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx' rel='external nofollow' class='url'>The Old New Thing : Applications and DLLs don't have privileges; users do</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060619-12/?p=30833#comment-410643">
			August 18, 2006 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>