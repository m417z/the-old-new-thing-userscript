<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (41)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-930463">
				<div id="div-comment-930463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Not Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930463">
			August 17, 2011 at 7:38 am</a>		</div>

		<p>I tried editing HKLMSWMSWindowsCurrentVersionExplorerAdvancedDelayedAppsDelay_Sec to change its value from 0 back to 60 and regedit says &#39;Error Editing Value &#8211; Cannot edit Delay_Sec: Error writing the value&#39;s new contents.&#39;</p>
<p>That sucks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930493">
				<div id="div-comment-930493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PlexMan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930493">
			August 17, 2011 at 7:57 am</a>		</div>

		<p>@Not Norman Diamond</p>
<p>Follow the first link and in that article you will see why you can&#39;t edit the registry value:</p>
<p>&quot;One thing to note here, is that in order to make this change, you will first have to take ownership of the DelayedApps key in the registry.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-andre-ziegler even thread-even depth-1" id="comment-930503">
				<div id="div-comment-930503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Andre.Ziegler' rel='external nofollow' class='url'>Andre.Ziegler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930503">
			August 17, 2011 at 7:58 am</a>		</div>

		<p>@Not Norman Diamond</p>
<p>&quot;One thing to note here, is that in order to make this change, you will first have to take ownership of the DelayedApps key in the registry.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930523">
				<div id="div-comment-930523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930523">
			August 17, 2011 at 8:18 am</a>		</div>

		<p>Good riddance.</p>
<p>Incidentally, it&#39;s immediately obvious to me how to work around this behavior if some no-good application vendor wanted to do so. The essential technique was published in an MSDN article for NT4 about how to write a self-deleting executable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930533">
				<div id="div-comment-930533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">configurator</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930533">
			August 17, 2011 at 8:26 am</a>		</div>

		<p>I&#39;ve notices a lot of these kind of apps have splash screens (which is an extremely stupid idea, by the way), and display them while loading on login; slowing down over the first 60 seconds will only cause the splash screens to display for longer and the system to seem actually slower to load (although it would be responsive while said screens are shown), wouldn&#39;t it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jader3rd odd alt thread-odd thread-alt depth-1" id="comment-930543">
				<div id="div-comment-930543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/jader3rd' rel='external nofollow' class='url'>jader3rd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930543">
			August 17, 2011 at 8:38 am</a>		</div>

		<p>But at least with scheduled tasks, I can administer them to behave as I want them to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930553">
				<div id="div-comment-930553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Dietz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930553">
			August 17, 2011 at 9:28 am</a>		</div>

		<p>I&#39;ve always taken the opinion that balancing and scheduling processes, threads and memory is best left up to the kernel team. &nbsp;Attempting to arbitrarily control resource usage at the application layer is often counter productive. &nbsp;Though I entirely understand the motivation, most of these things being autostarted could very likely have waited a bit to start, or should have themselfves elected to run at a low priority. &nbsp;But the shell team really can&#39;t win here, so I&#39;m glad to see they recognized defeat when they saw it. &nbsp;Win7 is an obviously better product than Vista, which I think reflects the maturing of its developers. &nbsp;Vista had the feel of a fresh generation starting at Microsoft full of idealistic ideas about how to change the world, Win7 has the feel of an experienced team that understands their limitations.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930563">
				<div id="div-comment-930563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930563">
			August 17, 2011 at 9:47 am</a>		</div>

		<p>The only solution to this problem is to make it impossible for applications to set things to run on startup without user intervention.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930583">
				<div id="div-comment-930583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930583">
			August 17, 2011 at 9:51 am</a>		</div>

		<p>A service which polled for users logging on and started a custom logon job would also do the trick.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930613">
				<div id="div-comment-930613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930613">
			August 17, 2011 at 11:38 am</a>		</div>

		<p>Don&#39;t worry Raymond, the secret was already out. I was wondering why some vendors where starting their software through tasks, instead of using the startup group or the oh-so-invisible [/sarcasm] windows/currentversion/run entry in the registry.</p>
<p>At least I now know why.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930633">
				<div id="div-comment-930633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930633">
			August 17, 2011 at 12:41 pm</a>		</div>

		<p>Maybe Windows 7 aims at solid-state drives, where the I/O burden would have much less of an effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930643">
				<div id="div-comment-930643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930643">
			August 17, 2011 at 3:47 pm</a>		</div>

		<p>@Anonymous Coward</p>
<p>Be serious. &nbsp;99% of users when prompted by the application to &quot;click X to make SuperDooperMegaFunFunFun start faster&quot; will robotically click X adding it to autorun on startup, just like they&#39;re successfully social engineered into installing any malware that leaks through their security screens.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-930673">
				<div id="div-comment-930673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930673">
			August 17, 2011 at 6:43 pm</a>		</div>

		<p>Actually in some case I want to have user setting to control the running priority of certain application (with aid of some dialog obvious like &quot;compatability option&quot;?)</p>
<p>There are some applications that users will want to run in background priority. But now the user seems to have no way to set the preference themselves.</p>
<p>Note: For advanced users that is comfortable with command line, they can use &quot;start low/normal/high/realtime&quot; to specify the priorty before the application loads.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930683">
				<div id="div-comment-930683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ens</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930683">
			August 17, 2011 at 7:13 pm</a>		</div>

		<p>Certain applications change behaviour when run under a job object. &nbsp;I recall a bug I fixed some months ago for a big release. &nbsp;Our main process, call it process A, was creating a second process, call it D for Destination, with CreateProcessWithTokenW (which was used to de-elevate privileges). &nbsp;That second process was ultimately launching an arbitrary list of 3rd-party applications. &nbsp;A certain commonly-installed product from a non-Microsoft product exhibited pathological behaviour. &nbsp;We might have let that slide, except that the product in question was a direct competitor to our product, so it gave the appearance that we were doing something underhanded when we really weren&#39;t.</p>
<p>Turns out that our competitors&#39; process doesn&#39;t like being placed in a job object, and CreateProcessWithTokenW puts the child process in a job object with no chance of escape (no JOB_OBJECT_LIMIT_BREAKAWAY_OK).</p>
<p>Ultimately my solution was to create two intermediate processes. &nbsp;Call our original process A and the findal target application D for Destination. &nbsp;A would CreateProcess process B. &nbsp;Process B would put itself in a job object with JOB_OBJECT_LIMIT_BREAKAWAY_OK, and then CreateProcessWithTokenW C. &nbsp;This automatically placed C in process B&#39;s job, so the API&#39;s side-effect of adding its own job was defeated. &nbsp;C would then call CeateProcess with CREATE_BREAKAWAY_FROM_JOB process D. &nbsp;On net, we achieved a CreateProcessWithTokenW from A-&gt;D without ever putting either A or D in a job object.</p>
<p>Of course, this whole scenario falls apart if we ourselves were created in an unbreakable job object (if it&#39;s breakable, then the B process is unnecessary but not harmful). &nbsp;But at least then we could point our finger at somebody else as triggering the problem :).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930693">
				<div id="div-comment-930693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930693">
			August 17, 2011 at 7:44 pm</a>		</div>

		<p>It might be nice for everything run from the Run registry key to be low priority but allow users to set the links in the Startup folder to run at regular or low priority. That way if somebody wants their crap to not run so slowly they can put it in the Startup folder where it won&#39;t be invisible to users.</p>
<p>If a user decides that their start-up is too inconvenient they can go to the Startup folder, see what shortcuts are for unimportant programs, and set them to low priority. Assuming shortcuts would have a way to set the priority of the program they run, this should be a good way to put users in control of their startup experience.</p>
<div class="post">[<i>Visibility doesn&#39;t help. I go to my Startup folder (I bet most users don&#39;t even know that there is a Startup folder), and I see &quot;Contoso Client&quot;. Can I delete Contoso Client? Will my computer stop working if I delete Contoso Client? Last time I deleted something from my Startup group, my 3G modem stopped working. Play it safe and just leave it there. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930653">
				<div id="div-comment-930653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930653">
			August 17, 2011 at 3:51 pm</a>		</div>

		<p>This seems like one of those &quot;Darned-if-you-do, Darned-if-you-don&#39;t&quot; situations. &nbsp;This is truly a fantastic idea, in my opinion&#8211;There are machines out there that *clearly* require some level of intervention along these lines during startup. &nbsp;Between consumer AV, browser plugins, PDF readers, IM, &quot;helpful&quot; utilities that shipped with consumer hardware, and *VM updates, the value of something like this becomes readily apparent.</p>
<p>*Whatever* most of those things are doing during startup, they certainly don&#39;t need to be doing it at a high to moderate priority level.</p>
<p>That being said, if one or more of those utilities does something even more annoying like paint a splash window, create a dialog or 2, etc, the user gets stuck with an unresponsive window or splash hovering over their desktop (or worse, at the top of the desktop).</p>
<p>Sigh&#8230;</p>
<p>Maybe it would be cool if the feature kept the program in a box until it painted a window? Developers that try to get out of the box by painting a useless window might rapidly annoy their users into disabling/uninstalling their program, so the risk of leaving such an obvious escape hatch might not be so bad?</p>
<p>-Paul</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930663">
				<div id="div-comment-930663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930663">
			August 17, 2011 at 3:53 pm</a>		</div>

		<p>Just a guess, but perhaps they ran into complaints from people who manually added things to startup. &nbsp;For example, say someone adds Outlook to startup because they want it to always run at login. Under Vista they might have to sit and wait *longer* than they would had they just clicked an Outlook quicklaunch icon.</p>
<p>And, as you point out, there is an &quot;exploit&quot; that can be used to bypass the lower priority. &nbsp;The team probably figured that they really only had two options: make it impossible to automatically start programs at normal priority (bad because it cripples users) or give up (why maintain code for a feature that everyone you&#39;ve targeted it for has found a way around it anyway).</p>
<p>I think they made the correct choice. &nbsp;Eventually someone has to be left holding the blame for poorly written software. &nbsp;Ideally it would be the crappy software vendors, but if not then it&#39;s left on the user who chose to install their software. &nbsp;This seems like the only real option, as long as we&#39;re not living in some nightmare locked-down world where users cannot fully choose what software to install or remove (iOS and locked Android).</p>
<p>I don&#39;t envy the people trying to balance the decisions which help provide a good Windows experience for the &quot;regular&quot; computer users with those that give &quot;power&quot; users the flexibility and capabilities they desire.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930703">
				<div id="div-comment-930703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930703">
			August 18, 2011 at 12:29 am</a>		</div>

		<p>Very interesting article. I searched MSDN / Google for setting I/O-Prio programmatically for my process to &quot;nice&quot; without going for low Page priority. Using PROCESS_MODE_BACKGROUND_BEGIN just nices all things (I/O, CPU, Page) which slows down my service. I realized I could set the I/O-Prio to low when opening a file, but could not get this to work (C# call to win32api). ProcExp still showed the file handles having &quot;normal&quot; prio.</p>
<p>Now I saw the reg keys BoxedIoPriority, BoxedPagePriority and BoxedPriorityClass for startup processes. How can I set I/O-Priority alone for my process?</p>
<p>BTW, here&#39;s my (non-functional?) code for nicing I/O prio for a filestream in C#:</p>
<p>&nbsp; &nbsp; &nbsp;[StructLayout(LayoutKind.Sequential)]</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;internal struct FILE_IO_PRIORITY_HINT_INFO</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;{</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;public UInt32 PriorityHint;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;[DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;private static extern bool SetFileInformationByHandle(IntPtr hFile, uint fileInfoByHandleClass, [In()] ref FILE_IO_PRIORITY_HINT_INFO info, UInt32 buffersize);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;private static void SetFileBackgroundMode(FileStream fs)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;{</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var hint = new FILE_IO_PRIORITY_HINT_INFO();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hint.PriorityHint = 1; // low</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SetFileInformationByHandle(fs.SafeFileHandle.DangerousGetHandle(), 12, ref hint, 4);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;}</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930713">
				<div id="div-comment-930713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930713">
			August 18, 2011 at 12:50 am</a>		</div>

		<p>&quot;I won&#39;t try to save you from yourself any more.&quot;</p>
<p>Thank you nanny!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-briantkatchhotmail-com odd alt thread-odd thread-alt depth-1" id="comment-930733">
				<div id="div-comment-930733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian+Tkatch' rel='external nofollow' class='url'>Brian Tkatch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930733">
			August 18, 2011 at 5:08 am</a>		</div>

		<p>One reason to hold back from purchasing the book, is demonstrated here: Half of Raymond&#39;s stuff is interesting because of the linked articles. Some may be humorous, others are quite informational.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930723">
				<div id="div-comment-930723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thomas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930723">
			August 18, 2011 at 1:21 am</a>		</div>

		<p>&gt; they can put it in the Startup folter where it won&#39;t be invisible to users</p>
<p>Unless it is, you know, *hidden*.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930853">
				<div id="div-comment-930853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930853">
			August 18, 2011 at 10:24 am</a>		</div>

		<p>[Last time I deleted something from my Startup group, my 3G modem stopped working. Play it safe and just leave it there. -Raymond]</p>
<p>My response would have been either to replace it with a desktop shortcut called &quot;Connect&quot; or return the product to the store depending on the severity of the design problem requiring an auto-start application.</p>
<div class="post">[<i>You, my friend, are not a typical end user. (And returning the product to the store means canceling your 3G contract with your cellular provider. And who knows, the provider you switch to may have the exact same problem!) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930873">
				<div id="div-comment-930873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930873">
			August 18, 2011 at 11:17 am</a>		</div>

		<p>I&#39;m not sure I understand the argument against having startup items in the Startup folder in order to let people choose what priority they run with (assuming a hypothetical feature allowing a shortcut to specify a priority). Are you saying that putting things in the Startup folder is a bad idea because people might delete the shortcuts without realizing they&#39;re important? I wasn&#39;t advocating deleting shortcuts (just changing their priority), but certainly if a user finds their Startup folder and deletes something unwittingly, only to find that their computer stopped doing something they cared about, they could always undelete it. Furthermore, because it&#39;s a shortcut, it can have a comment telling you how important it is to the functioning of your computer.</p>
<p>The problem with the Run key is that there&#39;s no penalty to the softwar vendor for putting their program(s) there. Most users don&#39;t even know about it! Even if I&#39;m a user who knows about it and is willing to edit my registry, all I can tell is that there&#39;s some program called BTTray.exe that is supposed to run. I have no idea what that program is or why it&#39;s running when I log in, nor do I have an easy way to undo the operation if I delete it.</p>
<p>A Startup folder shortcut is something I can discover just by browsing my Start menu, it has an icon and a comment telling me what it is (&quot;Bluetooth with Enhanced Data Rate Software&quot;), and if I remove it (by moving to the Recycle bin or just another folder), I can easily undo the operation if I need to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930903">
				<div id="div-comment-930903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930903">
			August 18, 2011 at 12:12 pm</a>		</div>

		<p>Of course, the original &quot;asker&quot; didn&#39;t know that saying &quot;I found that in Windows Vista, the xcopy command is ten times slower than it was in Windows XP&quot; is not the same as saying &quot;I found that in Windows Vista, running the xcopy command from the startup folder is ten times slower than it was in Windows XP&quot;. &nbsp;</p>
<p>I can almost understand their confusion, but, didn&#39;t they ever try to debug this by running the same program manually, that is, after Windows had started up? &nbsp;They should have noticed that it wasn&#39;t slower then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930913">
				<div id="div-comment-930913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930913">
			August 18, 2011 at 12:15 pm</a>		</div>

		<p>@640K: &nbsp;POLLING for users to log on? &nbsp;No, that&#39;s just wrong. &nbsp;Very wrong.</p>
<p>You can schedule tasks to run at logon. &nbsp;Several well-written program installers will help you with this, by prompting you to enter the logon password on the screen that&#39;s about to come up, then it uses the Scheduled Task creation interface to bring up the Add Scheduled Task window (whatever its official name is).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-930953">
				<div id="div-comment-930953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930953">
			August 18, 2011 at 1:58 pm</a>		</div>

		<p>How about simply making the applications start faster? By simply bringing the whole image into memory on the image load. Touch every page, and it&#39;s there. And because it&#39;s linear read in most cases, it&#39;s very fast. The computers got at least 2GB these days, in case somebody didn&#39;t know that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-930993">
				<div id="div-comment-930993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-930993">
			August 18, 2011 at 7:47 pm</a>		</div>

		<p>@Alex Grigoriev: The exe might be fragmented all over the disk * several apps = a lot of pointless I/O.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-931063">
				<div id="div-comment-931063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931063">
			August 19, 2011 at 8:59 am</a>		</div>

		<p>@Alex Grigoriev: &nbsp;I hope you&#39;re not serious. &nbsp;Do you expect this to be done for every application, including the parts of the program that the user is not going to use? &nbsp;That&#39;s just wrong. &nbsp;What if every program did that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-931073">
				<div id="div-comment-931073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931073">
			August 19, 2011 at 10:16 am</a>		</div>

		<p>@David Walker: +1</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-931093">
				<div id="div-comment-931093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931093">
			August 19, 2011 at 11:25 am</a>		</div>

		<p>@DW:</p>
<p>It can easily be done either by user mode module loader, or by an add-on kernel module using an image load callback (PsSetLoadImageNotifyRoutine) which will work for all applications. And the parts of the program the user won&#39;t be using? They will be aged out by a normal page aging if they&#39;re not touched for long time. Not a big deal. It&#39;s not like there is memory pressure in a typical consumer box these days.</p>
<p>@asf:</p>
<p>Even if some exe happens to be fragmented (which is quite unlikely), it&#39;s better than loading a page from this exe, a page from another exe (by random demand). If you have multiple processes starting in parallel, those seeks can slow it down dramatically.</p>
<p>And of course, a reasonable limit on the pre-load size should be used.</p>
<div class="post">[<i>&quot;It&#39;s not like there is memory pressure in a typical consumer box these days.&quot; Can I quote you on that the next time somebody complains about how much memory Windows is using? That way, when somebody says, &quot;Why is Windows wasting all this memory and I/O bandwidth loading programs I don&#39;t care about?&quot; I can tell them &quot;Alex said it was okay.&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-931113">
				<div id="div-comment-931113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931113">
			August 19, 2011 at 12:29 pm</a>		</div>

		<p>A quick look shows that a trivial app like Notepad has a couple dozen DLLs, a moderately complex one like IE has over a hundred, and a major one like VS2010 has hundreds.</p>
<p>Can you imagine what Alex&#39;s idea would be do to file servers? It&#39;s one thing to say that your local computer has so much RAM and disk bandwidth, but a file server has to share its disk cache, disk bandwidth, and network bandwidth with everybody else using it. And god help you if you&#39;re accessing the app over the Internet on a VPN!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-931123">
				<div id="div-comment-931123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931123">
			August 19, 2011 at 4:17 pm</a>		</div>

		<p>&quot;Can I quote you on that the next time somebody complains about how much memory Windows is using?&quot;</p>
<p>Yes, Mr Chen, you have my full permission. I don&#39;t know if Windows already has that &quot;average physical memory usage&quot; parameter as a part of user experience improvement program telemetry. If it does, check it out. If it doesn&#39;t, go around and see what your coworkers&#39; boxes have at the moment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-931133">
				<div id="div-comment-931133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931133">
			August 19, 2011 at 4:22 pm</a>		</div>

		<p>@Gabe:</p>
<p>From &quot;couple dozen&quot; DLLs only the notepad.exe module is a non-shared file section object. The rest of those DLL&#39;s pages are shared by all processes. Also, if you start multiple notepad.exe processes, the exe itself will also be a shared file section.</p>
<p>One day I&#39;ll actually write that driver and post it on the codeproject of like that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-931143">
				<div id="div-comment-931143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931143">
			August 19, 2011 at 4:29 pm</a>		</div>

		<p>@Gabe:</p>
<p>&quot;And god help you if you&#39;re accessing the app over the Internet on a VPN!&quot;</p>
<p>If your IT hates you so much that they installed your app on the VPN share, ask yourself, what would you rather prefer:</p>
<p>a) suffer your VPN roundtrip every time another 4KB of your executable needs to be brought in;</p>
<p>or b) suffer your VPN roundtrip much fewer times while the image is being fully loaded.</p>
<p>Also, /SWAPRUN:NET linker switch exists for a reason.</p>
<div class="post">[<i>&quot;My Excel spreadsheet takes 30 minutes to load because stupid Explorer is saturating my slow VPN connection trying to prefect some app I don&#39;t even care about.&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-931153">
				<div id="div-comment-931153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CGomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931153">
			August 19, 2011 at 6:01 pm</a>		</div>

		<p>It is too bad if the performance team gave up. &nbsp;&quot;Startup helpers&quot; do need to just go away and it sucks that I have to go about maintaining my system when I know my mom and dad won&#39;t be able to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-931203">
				<div id="div-comment-931203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931203">
			August 20, 2011 at 12:02 pm</a>		</div>

		<p>&quot; Vista had the feel of a fresh generation starting at Microsoft full of idealistic ideas about how to change the world, Win7 has the feel of an experienced team that understands their limitations.&quot;</p>
<p>Yea, I remember Jim Allchin was involved in Vista, while Steven Sinofsky was involved in Windows 7.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-931253">
				<div id="div-comment-931253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick Brewster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931253">
			August 20, 2011 at 10:52 pm</a>		</div>

		<p>I wrote a little command-line utility that you can use to set any process to use &quot;process background mode&quot; (or to disable it, of course). It&#39;s very handy, like if you&#39;re unzipping a bunch of files and you&#39;d rather have it operate in the background, including its I/O (you could set it to Real Time CPU priority and it probably wouldn&#39;t even matter, it&#39;s so I/O bound). I&#39;m hesitant to release the source code though because it could probably be used to write a virus. It uses some interesting techniques so it can call SetPriorityClass() within the other process (you can&#39;t enable/disable process background mode for another process). Maybe a version 2 would let me set the background mode for any particular UI thread, which would be great for long file operations in Explorer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-931263">
				<div id="div-comment-931263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931263">
			August 21, 2011 at 12:06 am</a>		</div>

		<p>So boxing CAN be disabled on Vista! On a related note, why does holding down Shift no longer prevent items in the Startup folder from running beginning with Vista? It was very useful for troubleshooting a program that caused problems when it launched at startup.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-931283">
				<div id="div-comment-931283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931283">
			August 21, 2011 at 11:47 pm</a>		</div>

		<p>@Chris: The performance team does leave the switch to you, so you can enable it yourself if you do care.</p>
<p>@xpclient: Have you tried using &quot;Right Shift&quot; key?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-931353">
				<div id="div-comment-931353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">hagenp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931353">
			August 22, 2011 at 8:44 am</a>		</div>

		<p>Please see &quot;Programmed Politeness&quot; by Kai A. Olsen,</p>
<p>IEEE Computer, July 2011 (Vol. 44, No. 7) pp. 108,106-107</p>
<p>&#39;We should require a minimum of politeness. A polite system would ask, &quot;Do you want a shortcut on your desktop, a new menu in Word, or automatic updates?&quot; Then at least we&#39;d feel that we&#39;re in control.&#39;</p>
<p>&#39;It&#39;s discourteous to interrupt. [&#8230;] While some polite programs understand this, many behave like a bull in a china shop. Messages pop up at the most inconvenient time. While we&#39;re giving a speech using a presentation program, the computer might tell us that new mail has arrived, offer to help clean the desktop or, worse, require a reboot.&#39;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-931413">
				<div id="div-comment-931413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110817-00/?p=9883#comment-931413">
			August 22, 2011 at 1:55 pm</a>		</div>

		<p>&quot;or, worse, require a reboot&quot;</p>
<p>Now I&#39;m sure we all know where that example comes from &#8211; and I&#39;m also sure it&#39;s heartfelt by basically everyone (though Win7 [Vista?] included the &quot;wait 4 hours&quot; option which means I&#39;m not that likely anymore to kill the service every time something&#39;s updated)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>