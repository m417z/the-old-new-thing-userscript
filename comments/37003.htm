<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-234703">
				<div id="div-comment-234703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/12/15/313250.aspx#313306' rel='external nofollow' class='url'>Edward</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234703">
			December 15, 2004 at 7:41 am</a>		</div>

		<p>Considering the majority of x86 processors produced must be used for running Windows it always surprised me that the two did not work together more closely to optimise performance.</p>
<p>There was a rumour somewhere that Dave Cutler was heavily involved in the design of AMD64, so perhaps that is a more Windows centric architechture than x86 ever was.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234753">
				<div id="div-comment-234753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/12/15/313250.aspx#314662' rel='external nofollow' class='url'>asdf</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234753">
			December 15, 2004 at 8:11 am</a>		</div>

		<p>I initially thought that dev must be a pain in the ass to work with because he goes after the wrong problems but then I realized that with his solution you&#8217;ve sped up syscalls and faults with the same effort so it&#8217;s a win in general.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-234763">
				<div id="div-comment-234763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.cataraxia.com/' rel='external nofollow' class='url'>Kristoffer Henriksson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234763">
			December 15, 2004 at 8:11 am</a>		</div>

		<p>Engineers can sometimes be short sighted; instead of asking for a faster way to get into kernel mode they ask for their hack to be made faster.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234803">
				<div id="div-comment-234803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/12/15/313250.aspx#315946' rel='external nofollow' class='url'>Nate</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234803">
			December 15, 2004 at 10:03 am</a>		</div>

		<p>So what was the aftermath of this?  I presume that Microsoft has switched over to a newer syscall scheme; that should be easy because the scheme is wrapped in kernel32.dll.  If so, what is it and when was the change made?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-234813">
				<div id="div-comment-234813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com/' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234813">
			December 15, 2004 at 10:14 am</a>		</div>

		<p>I think I remember reading about this particular syscall trap in Andrew Schulman&#8217;s &quot;Unauthorised Windows 95&quot; book. It was a few years ago now though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234823">
				<div id="div-comment-234823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234823">
			December 15, 2004 at 10:15 am</a>		</div>

		<p>Nate: I don&#8217;t know. I wasn&#8217;t at the meeting 15 years ago and I don&#8217;t work on syscall traps. I was just re-telling an amusing story.</p>
<p>asdf: The dev in question is actually a really nice guy, but he does have a playful sense of humor as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-234843">
				<div id="div-comment-234843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/12/15/313250.aspx#316000' rel='external nofollow' class='url'>nealsid</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234843">
			December 15, 2004 at 11:07 am</a>		</div>

		<p>was the SYSENTER instruction introduced as an abstraction for that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234873">
				<div id="div-comment-234873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/12/15/313250.aspx#316083' rel='external nofollow' class='url'>Dave</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234873">
			December 15, 2004 at 12:59 pm</a>		</div>

		<p>Kristoffer, the reason they wanted the &quot;hack&quot; to be made faster was that all the code up to that point used INT instructions; MS-DOS and the BIOS calls used that convention. When you do an INT instruction inside a virtual-86 machine, it naturally needs to somehow invoke the protected mode operating system. In the 386 calling out of a V86 box was an expensive operation, and it happened a lot since nearly all the code that users ran was DOS apps.</p>
<p>Virtual-86 mode was really Intel&#8217;s answer to a much uglier problem. Intel had made it easy to get into protected mode (just flip a status bit) but there was no way to get OUT of protected mode, which was important in the 286 era (circa 1987 or so) because there was no V86 support in the CPU and all the existing apps were real mode MS-DOS. No protected-mode OS (say, OS/2 or Windows/286) was going to launch without some sort of support for existing apps.</p>
<p>The solution to get from protected mode back to real mode was to create a triple-fault condition that would cause the processor to reset itself and head back to the BIOS reset vector, where it would eventually make it to some OS code that would start running the real mode apps. I had understood that Gordon Letwin figured that out, but there are some other credits for it here:<br />
<br /><a target="_new" href="http://www.x86.org/productivity/triplefault.htm" rel="nofollow">http://www.x86.org/productivity/triplefault.htm</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-234903">
				<div id="div-comment-234903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234903">
			December 15, 2004 at 6:35 pm</a>		</div>

		<p>I thought the 286 era was circa 1983 or so, and Intel&#8217;s market was still dominated more by embedded systems than by general purpose computers.  Intel made RMX and other vendors or users (industrial users, makers of machines) could make other OSes, there was no need to worry about existing apps on the new processors, etc.  Of course PC makers and Microsoft had different ideas, and for their purposes they used tools that they saw available, and they used those tools in ways that Intel didn&#8217;t imagine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234923">
				<div id="div-comment-234923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/12/16/313250.aspx#317198' rel='external nofollow' class='url'>some1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-234923">
			December 16, 2004 at 7:16 am</a>		</div>

		<p>invalid instructions are still used as kind of syscalls in DOS emulation inside of NTVDM AFAIK.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-246103">
				<div id="div-comment-246103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2005/01/18/355232.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-246103">
			January 18, 2005 at 11:33 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444993">
				<div id="div-comment-444993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://test.xxeo.com/archives/2006/06/24/more-x86-lore-illegal-instructions-and-the-286-protected-mode.html' rel='external nofollow' class='url'>Dru&#8217;s Blog &raquo; Blog Archive &raquo; More x86 Lore - Illegal instructions and the 286 Protected Mode</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-444993">
			November 26, 2006 at 5:24 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://test.xxeo.com/archives/2006/06/24/more-x86-lore-illegal-instructions-and-the-286-protected-mode.html" rel="nofollow">http://test.xxeo.com/archives/2006/06/24/more-x86-lore-illegal-instructions-and-the-286-protected-mode.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-518793">
				<div id="div-comment-518793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.xxeo.com/archives/2006/06/24/more-x86-lore-illegal-instructions-and-the-286-protected-mode.html' rel='external nofollow' class='url'>Dru&#8217;s Blog &raquo; Blog Archive &raquo; More x86 Lore - Illegal instructions and the 286 Protected Mode</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-518793">
			June 25, 2007 at 3:53 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.xxeo.com/archives/2006/06/24/more-x86-lore-illegal-instructions-and-the-286-protected-mode.html" rel="nofollow">http://www.xxeo.com/archives/2006/06/24/more-x86-lore-illegal-instructions-and-the-286-protected-mode.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-727583">
				<div id="div-comment-727583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.meesqa.com/2009/04/18/more-side-effects-that-become-features/' rel='external nofollow' class='url'>MEE SQA Blog &raquo; Blog Archive &raquo; More Side Effects That Become Features</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041215-00/?p=37003#comment-727583">
			April 18, 2009 at 11:43 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.meesqa.com/2009/04/18/more-side-effects-that-become-features/" rel="nofollow">http://blog.meesqa.com/2009/04/18/more-side-effects-that-become-features/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>