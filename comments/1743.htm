<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (18)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1107103">
				<div id="div-comment-1107103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BOFH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107103">
			February 17, 2014 at 7:11 am</a>		</div>

		<p>Well, how does one compile it?</p>
<p>I get this error:</p>
<p>&#8212;8&lt;&#8212;</p>
<p>Microsoft (R) Visual C# Compiler version 4.0.30319.18408</p>
<p>for Microsoft (R) .NET Framework 4.5</p>
<p>Copyright (C) Microsoft Corporation. All rights reserved.</p>
<p>closerun.cs(1,22): error CS0234: The type or namespace name &#39;Automation&#39; does</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;not exist in the namespace &#39;System.Windows&#39; (are you missing an assembly</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;reference?)</p>
<p>&#8212;8&lt;&#8212;</p>
<div class="post">[<em>Have you considered the possibility that you are missing an assembly reference? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107113">
				<div id="div-comment-1107113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BOFH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107113">
			February 17, 2014 at 7:27 am</a>		</div>

		<p>Yes, but I&#39;m not a kodhjon so I don&#39;t know what to do with that information.</p>
<p>Do you have a suggestion as to what to add to your Little Program?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107123">
				<div id="div-comment-1107123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ross Presser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107123">
			February 17, 2014 at 7:34 am</a>		</div>

		<p><a href="http://stackoverflow.com/questions/1469386/referencing-system-windows-automation" rel="nofollow" target="_new">stackoverflow.com/&#8230;/referencing-system-windows-automation</a></p>
<p>&quot;referencing System.Windows.Automation&quot;</p>
<p>The UIAutomationClient.dll is located in this folder:</p>
<p>C:Program FilesReference AssembliesMicrosoftFrameworkv3.0</p>
<div class="post">[<em>Note that if you have to have the answer given to you, then you probably aren&#39;t in the target audience for this blog. In particular, it&#39;s not clear what you&#39;re going to do with the techniques illustrated by the Little Program. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107153">
				<div id="div-comment-1107153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JDT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107153">
			February 17, 2014 at 8:04 am</a>		</div>

		<p>I suspect Raymond has been replaced by an imposter; this blog post both:</p>
<p>&gt; gives instructions for how to do something evil;</p>
<p>&gt; is written in C# where an aspect of the CLR is not the subject of the blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107163">
				<div id="div-comment-1107163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107163">
			February 17, 2014 at 8:12 am</a>		</div>

		<p>Now, how to get the localized string for &quot;Run&quot;?</p>
<div class="post">[<em>UI automation is not intended for driving UI programmatically in production. It&#39;s for automating your testing. So the way you get it is by whatever means you use to localize your program (since your program is the one whose dialog is being driven). I chose the Run dialog just for illustration. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107203">
				<div id="div-comment-1107203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">VZ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107203">
			February 17, 2014 at 8:39 am</a>		</div>

		<p>@JDT: This was my first thought as well. But the inline reply in the first BOFH comment is pure Raymond. Now I&#39;m confused&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107243">
				<div id="div-comment-1107243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107243">
			February 17, 2014 at 10:33 am</a>		</div>

		<p>[UI automation is not intended for driving UI programmatically in production. -Raymond]</p>
<p>So it&#39;s not a good idea to use to write accessibility software then?</p>
<div class="post">[<em>That&#39;s not what I&#39;m talking about. Go ahead and use it for accessibility. But that is different from writing a program to identify the Run dialog every time it appears or to programmatically click on buttons on dialogs automatically. When used for accessibility, the <span style="text-decoration:underline;">end user</span> is the one who is identifying the dialog and deciding which buttons to click. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1107263">
				<div id="div-comment-1107263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107263">
			February 17, 2014 at 10:40 am</a>		</div>

		<p>Wait for somebody using this to disable Run box as &quot;security&quot; policy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107273">
				<div id="div-comment-1107273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107273">
			February 17, 2014 at 12:01 pm</a>		</div>

		<p>I always enjoy these Automation Posts, its part of my daily job function. Its a pretty slick library, but in some senses not documented as well as it could be (although it has gotten much much better in recent years).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107293">
				<div id="div-comment-1107293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jas88</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107293">
			February 17, 2014 at 1:37 pm</a>		</div>

		<p>alegr1: Run is actually disabled on the machine on my desktop at work (as was logging in, until two weeks ago, and writing to my home directory until last week). There&#39;s some paperwork somewhere I can do to get admin rights, or just walk next door where there&#39;s a whole lab of machines on which I already have. Ironic, as a security researcher, but we all start off with standard staff builds (and the occasional glitch!) until we social-engineer ourselves more access&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1107303">
				<div id="div-comment-1107303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107303">
			February 17, 2014 at 6:45 pm</a>		</div>

		<p>@jas88: In univeristy, we used to have (boring) kiosk everywhere that have everything (mostly) locked up too. We found that the &quot;Save as&quot; dialog in IE is handy for us to run &quot;telnet&quot; to connect to the Unix clusters, in order to do things like emailing homework or so.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107323">
				<div id="div-comment-1107323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107323">
			February 18, 2014 at 2:15 am</a>		</div>

		<p>To be fair finding the reference for a particular namespace is much harder than it should be for some namespaces (here the reference has a different name than the namespace and the namespace documentation on MSDN doesn&#39;t mention the dll/reference)</p>
<div class="post">[<em>Namespaces don&#39;t have references. Classes have references. (A single namespace can be spread out among multiple assemblies, and a single assembly can include classes from multiple namespaces.) So you need to look up the class documentation to see what assembly it is in. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107333">
				<div id="div-comment-1107333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107333">
			February 18, 2014 at 2:37 am</a>		</div>

		<p>@JK Much harder than it should be? Because the only thing I did was google for &quot;msdn Automation.AddAutomationEventHandler&quot;, click the first link that goes to msdn and read the third line which states Assembly: &nbsp;UIAutomationClient (in UIAutomationClient.dll)</p>
<p>How exactly you make this process any easier really isn&#39;t clear to me and considering Raymond&#39;s target audience, anyone who can&#39;t figure that one out is probably reading the wrong blog &#8211; as harsh as that sounds.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107353">
				<div id="div-comment-1107353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RonO</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107353">
			February 18, 2014 at 6:17 am</a>		</div>

		<p>@voo Well, I think there&#39;s a reasonable expectation the MSDN documentation will give the specific assembly for a namespace. Many (most?) namespaces only exist in a single assembly. Some namespaces could result in a long list, though. As you point out, using the class (or in your example, class + method name &#8212; namespace + class will also work) results in a clear reference.</p>
<div class="post">[<em>The problem is that anybody can inject a class into a namespace. I could write a &quot;foo.cs&quot; that includes the line &quot;namespace System.Windows.Automation { public class Haha { &#8230; } }&quot; and bingo, there is a new Foo.dll assembly that participates in the System.Windows.Automation namespace. It&#39;s like coming up with a list of all the subclasses of a base class. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107533">
				<div id="div-comment-1107533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107533">
			February 18, 2014 at 10:53 am</a>		</div>

		<p>[The problem is that anybody can inject a class into a namespace. I could write a &quot;foo.cs&quot; &#8230;]</p>
<p>Non-issue. foo.cs doesn&#39;t build into an assembly that is part of .NET.</p>
<div class="post">[<em>Different pieces of the BCL update at different times. (See .NET 3.5.) Maybe it would be nice if all the different pieces of the BCL were interrelated so that whenever, say, a new class is added to UIA, it adds itself to a list of classes maintained by WPF. But in practice, this is hard to manage. Tightly-coupled is harder to maintain than loosely-coupled. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1107783">
				<div id="div-comment-1107783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">IInspectable</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107783">
			February 19, 2014 at 2:41 am</a>		</div>

		<p>@RonO Namespaces do not exist in assemblies. In fact, namespaces do not exist at all. Some programming languages have support for namespaces to ease constructing and accessing long (and thus more likely to be unique) type names. As far as the CLR is concerned, there are no namespaces. Your expectation that assemblies (which do exist) and namespaces (which don&#39;t) are somehow related is misguided.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1107863">
				<div id="div-comment-1107863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RonO</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1107863">
			February 19, 2014 at 6:11 am</a>		</div>

		<p>@Raymond Different pieces of the BLC may update at different times, but they are still released as a part of an official and specific version of the .NET Framework (even if just a service pack). And the online MSDN documentation is pretty good now (complete?) at separating the documentation of the different versions. It&#39;s just as important to look at the specific version of the documentation for a class/method in the version of the .NET Framework used in a project (and yes, I&#39;ve burned myself a time or two).</p>
<p>And tools like ILSpy seem to do a good job finding sub-classes, though I imagine it is dependent upon which assemblies are loaded.</p>
<p>@IInspectable We&#39;ll have to agree to disagree here. Namespaces exist to serve the same purpose in the overall Framework as they do in any project referencing those assemblies. If they did not, it would be impossible to use System.Globalization.Calendar and System.Web.UI.WebControls.Calendar in the same project and there would be no purpose in specifying using (Imports) directives.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1108823">
				<div id="div-comment-1108823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140217-00/?p=1743#comment-1108823">
			February 22, 2014 at 9:11 am</a>		</div>

		<p>[Different pieces of the BCL update at different times. (See .NET 3.5.) Maybe it would be nice if all the different pieces of the BCL were interrelated so that whenever, say, a new class is added to UIA, it adds itself to a list of classes maintained by WPF. But in practice, this is hard to manage. Tightly-coupled is harder to maintain than loosely-coupled. -Raymond]</p>
<p>Enter auto-gen, stage right. It appears those docs are mostly auto-gened anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>