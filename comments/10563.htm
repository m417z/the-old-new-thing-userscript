<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-915353">
				<div id="div-comment-915353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915353">
			May 26, 2011 at 7:30 am</a>		</div>

		<p>Out of inexperience, why would someone need to know?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915363">
				<div id="div-comment-915363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JS Bangs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915363">
			May 26, 2011 at 7:36 am</a>		</div>

		<p>So why is theming enabled per-window rather than per-process? I find that somewhat counterintuitive, but I assume there must be a good reason. (And I assume that when you say &quot;window-by-window basis&quot; you mean window = HWND, rather than window = top-level window (the layman&#39;s definition.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915373">
				<div id="div-comment-915373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dalek</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915373">
			May 26, 2011 at 7:36 am</a>		</div>

		<p>&quot;How can you tell whether a particular button is an old-school button or a fancy new button? I don&#39;t know either.&quot; Wow, maybe the end of the world did start last Saturday, it&#39;s just not happening as fast as everyone expects :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915383">
				<div id="div-comment-915383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915383">
			May 26, 2011 at 7:45 am</a>		</div>

		<p>@Adam I actually found myself in a position where I needed to know. &nbsp;Due to some bugs in Windows Forms, toolbars and a few other controls, when placed in a tab page, would not correctly pick up the white background of the tabpage, resulting in a slightly jarring (to me, at least) visual experience. &nbsp;The only solution I found, ultimately, was to check for themes, and if so, manually set the toolbar background color to the background color of the tabpage. &nbsp;It&#39;s an ugly way to do things, I know. &nbsp;Don&#39;t chastise me too much :).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915393">
				<div id="div-comment-915393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roland</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915393">
			May 26, 2011 at 8:09 am</a>		</div>

		<p>I use GetWindowTheme(buttonhwnd) to determine whether a button is themed or not, and it seems to work reliably.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915413">
				<div id="div-comment-915413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915413">
			May 26, 2011 at 9:32 am</a>		</div>

		<p>@JS Bangs: If theming were per-process, an appcompat-requiring shell extension would cause all windows of Explorer.exe to be unthemed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915423">
				<div id="div-comment-915423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">henke37</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915423">
			May 26, 2011 at 9:41 am</a>		</div>

		<p>Here are some ideas of stuff to look at (given a hwnd) to find out if it is fancy:</p>
<p>window procedure (better have a plan for those chained ones)</p>
<p>window class (remember to check the hinstance too)</p>
<p>window extra data</p>
<div class="post">[<i>Yay, relying on undocumented behavior. Keeping the application compatibility team in business! -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915433">
				<div id="div-comment-915433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915433">
			May 26, 2011 at 9:59 am</a>		</div>

		<p>Okay, apparently anything Raymond says he doesn&#39;t know is a challenge.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915463">
				<div id="div-comment-915463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915463">
			May 26, 2011 at 11:13 am</a>		</div>

		<p>Joshua: Everything Raymond says people see as a challenge, period. 2/3rds of the comments here are people trying to &quot;correct&quot; Raymond&#39;s post, generally either by being a pedant nitpicker, or by putting forth arguments he already addressed in the post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915473">
				<div id="div-comment-915473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nitpicker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915473">
			May 26, 2011 at 1:56 pm</a>		</div>

		<p>James: Let me tell you something about that&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915483">
				<div id="div-comment-915483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915483">
			May 26, 2011 at 2:28 pm</a>		</div>

		<p>The MSDN pages for IsThemeActive and IsAppThemed both talk about the current application and not the user, this confuses me every time I have to look this stuff up.</p>
<p>IsAppThemed can&#39;t be trusted anyway, it will return 0 if you &quot;Disable visual themes&quot; on the compatibility tab, but it will return != 0 for a simple hello world app without a manifest (If themes (Visual Styles really) are on systemwide). I&#39;m guessing IsAppThemed returns true if comctl v6 is used to draw, even when using the classic look. This probably makes sense internally, but most people would expect IsAppThemed to return false for a app with the classic look.</p>
<p>What most people care about is if comctl v6 is used or not since it provides more features so you don&#39;t have to owner draw (Listview/Header sort arrow, EM_SETCUEBANNER etc), I don&#39;t know if it is a good idea to use IsAppThemed to detect the version, it is probably better to stick with DllGetVersion.</p>
<p>The hard part is to detect classic look (comctl v4/5 &amp; v6) vs &quot;real&quot; visual styles (Luna etc). Most people probably don&#39;t need to know, but there might be edge cases where classic look is drawn differently&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915493">
				<div id="div-comment-915493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915493">
			May 26, 2011 at 7:48 pm</a>		</div>

		<p>The &quot;manifest&quot; does not enable theming in your application. Theming is a feature provided by the operating system, exposed as a set of APIs. Your application is free to use, or not use them, at your own discretion. If you create your own controls, then you should pay your taxes and be sure to respect the users preferences &#8211; in this case their visual styles.</p>
<p>Your app is also free to use whatever 3rd party controls you like. Microsoft even updated their &quot;common controls&quot; library to take advantage of the theme API. These updated controls are available in version 6 of the common controls library, which are available as a side-by-side assembly. That&#39;s what the manifest gets you: a version of the common controls that draw themselves with the theme API (if available).</p>
<p>You can still call the theme API and not load v6 common controls. Your app can draw itself themed, while not using any common controls. Nothing requires a themed application to have a manifest.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915503">
				<div id="div-comment-915503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915503">
			May 26, 2011 at 10:09 pm</a>		</div>

		<p>@Ian Boyd: Yes, I skipped talking about activation contexts and the horrible ISOLATION_AWARE_ENABLED headerfile hack. I only said &quot;without a manifest&quot; to make it clear that I tried to opt-out of getting the v6 comctl. My point was that the look/style/mode of the v6 common controls might not match the return value of IsAppThemed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915523">
				<div id="div-comment-915523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915523">
			May 27, 2011 at 7:00 am</a>		</div>

		<p>@WndSks: Re-read what Ian Boyd is talking about, you&#39;re clearly not getting it. To simplify matters further, here&#39;s a table:</p>
<p>V5comctl: NOT themed.</p>
<p>V6comctl: themed, if IsAppThemed returns true.</p>
<p>comctl = HasManifest ? V6comctl : V5comctl.</p>
<p>In other words, if you don&#39;t have a manifest, you&#39;re creating V5 common controls and it does not matter what IsAppThemed returns &#8211; they&#39;re not styled.</p>
<p>On the other hand, some other DLL in your application could explicitly access theming API and draw themed controls. Even though you&#39;re not getting any!</p>
<p>Manifest is not some magic &quot;enable/disable themes&quot; thing. It&#39;s just &quot;replace STANDARD controls by themed versions&quot;. IsAppThemed does not talk about comctl, it talks about themes at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-915723">
				<div id="div-comment-915723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915723">
			May 30, 2011 at 3:04 am</a>		</div>

		<p>How can common controls V6 usage be determined on a per-window basis? Isn&#39;t it rather on a per-module basis, depending on each module&#39;s manifest?</p>
<p>If it is indeed on a per-window basis, how does one choose?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-915733">
				<div id="div-comment-915733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DaveK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110526-00/?p=10563#comment-915733">
			May 30, 2011 at 6:04 am</a>		</div>

		<p>@Joel: Why wouldn&#39;t just always indiscriminately manually setting the toolbar background colour to the tabpage background colour work, regardless of themes or no themes?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>