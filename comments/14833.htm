<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-814533">
				<div id="div-comment-814533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814533">
			February 24, 2010 at 10:01 am</a>		</div>

		<p>This sort of thing makes no sense to me, why is there no internal flag for something like this (At least by the time win32 came around, you would have enough memory to store one more bitflag)</p>
<p>The way it is now, CBS_SORT is pretty much useless to everyone</p>
<div class=post>[<i>There are only 16 bits available for class styles. CBS_SORTLINGUISTIC would consume one of the three available remaining bits. Or are you saying that a sorted combo box should behave differently depending on whether it received the CB_DIR message or not? What about the existing contents of the combo box at the time CB_DIR is sent? Should they be re-sorted? And does this mean that there&#8217;s yet another so subtle you&#8217;ll-never-find-this-until-it&#8217;s-too-late obstacle to porting your Win16 program to Win32? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-814563">
				<div id="div-comment-814563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814563">
			February 24, 2010 at 10:33 am</a>		</div>

		<p>@asf</p>
<p>No need to fix the issue at all &#8211; there is a new listview, that handles if not LVS_LIST then at least LVM_SORTITEMS&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-814623">
				<div id="div-comment-814623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814623">
			February 24, 2010 at 1:36 pm</a>		</div>

		<p>@Raymond: FindFirstFile and add just one item at the time with full path to CB_DIR?</p>
<div class=post>[<i>&#8220;What a screwed-up API this is.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-814633">
				<div id="div-comment-814633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814633">
			February 24, 2010 at 2:46 pm</a>		</div>

		<p>If someone wants esoteric sorting, for drive letters in a particular text format or whatever, then they can sort the items themselves and tell the control not to sort, like everyone else has to.</p>
<p>It&#8217;s too late to change now but making a general-purpose controls&#8217;s default sorting use an esoteric method because of one special case seems very silly to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-814653">
				<div id="div-comment-814653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814653">
			February 24, 2010 at 3:35 pm</a>		</div>

		<p>I agree. We can&#8217;t go back now, but when Windows 95 came out, support for CB_DIR &amp;c. should have been terminated for 32 bit applications. Microsoft could easily have dictated that new applications should use the common dialogues. There is no good use case for dir comboboxes and lists any more, they&#8217;re hard to use, unnecessary, and invoking a common dialogue is easier and provides more features.</p>
<p>The only post-Win3.1 application I&#8217;ve seen that uses things like that is VB and the VB guys decided to implement it differently, presumably for aesthetic reasons. I assume they were just there for 16-bit VB compatibility anyway, since VB supports the common dialogues as well. They should have just axed them from the toolbox when VB4 came out; there&#8217;s no sense in deliberately adding them to new, or even existing, applications.</p>
<div class=post>[<i>You and Ulric need to work out your differences. Ulric was <a href="http://blogs.msdn.com/oldnewthing/archive/2009/07/20/9840597.aspx" rel="nofollow">upset at the loss of MoveTo</a>, something you could easily work around with a macro. Whereas your proposal of removing support for CB_DIR requires a redesign of a program&#8217;s UI. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-814573">
				<div id="div-comment-814573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814573">
			February 24, 2010 at 10:41 am</a>		</div>

		<p>@Raymond: Yes, I&#8217;m saying CB_DIR would activate this mode (And deleting all items would deactivate it)</p>
<p>@waleri: Listbox has LBS_OWNERDRAWVARIABLE and LBS_MULTICOLUMN etc</p>
<div class=post>[<i>I guess that would cover most cases, though it messes up the case where somebody actually *wants* the left-bracket sort order (say because they are doing their own manual FindFirstFile instead of using CB_DIR, say, because they need to do additional filtering) &#8211; now they can&#8217;t get it. And of course it would be an incompatibility between Win16 and Win32 that wouldn&#8217;t be caught at compile time. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-814713">
				<div id="div-comment-814713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814713">
			February 24, 2010 at 9:44 pm</a>		</div>

		<blockquote><p>
  &gt;&gt; @waleri: Listbox has LBS_OWNERDRAWVARIABLE and LBS_MULTICOLUMN etc
</p></blockquote>
<p>Yeah, so?</p>
<p>What this has to do with sorting?</p>
<p>And beside, list view has those as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-814733">
				<div id="div-comment-814733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814733">
			February 24, 2010 at 11:51 pm</a>		</div>

		<p>Given [ is legal in a filename, could this be used to &quot;fake&quot; a drive?</p>
<p>E.g., decided to have a bunch of files [-A-] through [-Z-] ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-814763">
				<div id="div-comment-814763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-814763">
			February 25, 2010 at 4:02 am</a>		</div>

		<p>I believe Mr Chen has imparted these words before: &quot;Try it and see&quot;</p>
<p>I&#8217;d be intrigued as to what it would do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-815293">
				<div id="div-comment-815293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-815293">
			February 26, 2010 at 12:04 am</a>		</div>

		<p>Yeah, it would require a slight redesign, although it would in almost all cases be replacing the call to open your own file dialogue with a call to open the common one.</p>
<p>Going by the original questions and the comments, I don&#8217;t think Ulric was upset by the way. In any case, I could probably convince him that a major platform change (in this case 16- to 32-bit) requires a full code review anyway, so it isn&#8217;t that bad if it doesn&#8217;t recompile out of the box.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-815303">
				<div id="div-comment-815303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-815303">
			February 26, 2010 at 1:22 am</a>		</div>

		<p>Worf, first of all, square brackets weren&#8217;t legal in the Windows 3.1 era. I&#8217;ve looked at a file like that using Windows 1.0 Notepad, and it sees an alias short file name.</p>
<p>Next, play around with this code:</p>
<p>&#8212;(paste this in a form with a combobox)&#8212;</p>
<p>Option Explicit</p>
<p>Private Declare Function SendMessageA Lib &quot;User32&quot; (ByVal hWnd As Long, ByVal Msg As Long, ByVal W As Long, ByVal L As String) As Long</p>
<p>Private Sub Form_Load()</p>
<p>SendMessageA Combo1.hWnd, &amp;H145, &amp;HE036, &quot;C:*.*&quot;</p>
<p>End Sub</p>
<p>&#8212;(end &#8211; yes I know this code is ugly and I wouldn&#8217;t be caught dead doing this in a production environment)&#8212;</p>
<p>You will find that if you create a file called &quot;[-b-]&quot; it gets sorted as if it were a folder called &quot;-b-&quot;, id est between the b&#8217;s, after &quot;-a-&quot; and &quot;abc&quot; and before a folder called &quot;-c-&quot;.</p>
<p>Furthermore, mapped drive letters always get added to the bottom of the list, regardless of sort order. The special casing for the opening square bracket is there for folders, not for drives.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-816053">
				<div id="div-comment-816053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-816053">
			March 2, 2010 at 11:23 pm</a>		</div>

		<blockquote><p>
  You will find that if you create a file called &quot;[-b-]&quot; it gets sorted as if it were a folder called &quot;-b-&quot;,
</p></blockquote>
<p>But what if you have a junction point called &quot;[-b-]&quot; to a drive?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-816063">
				<div id="div-comment-816063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-816063">
			March 2, 2010 at 11:33 pm</a>		</div>

		<p>First time I saw &#8220;CB_DIR&#8221; flag I thought: HACK.</p>
<p>MS has had several opportunities to remove this hack altogether. The most obvious two are the 16-&gt;32 bit transition (a 15 year hell of pain for every windev). One of the more recent opportunities was the 32-&gt;64 bit hell.</p>
<div class=post>[<i>That&#8217;s right, because the best way to get people to port their code to a new platform is to make it <u>harder</u> to do. (How&#8217;s that 64-bit port coming?) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-816073">
				<div id="div-comment-816073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100224-00/?p=14833#comment-816073">
			March 3, 2010 at 1:20 am</a>		</div>

		<blockquote><p>
  what if you have a junction point
</p></blockquote>
<p>I think you&#8217;ve got enough information to figure that out. If not, try it.</p>
<blockquote><p>
  First time I saw &quot;CB_DIR&quot; flag I thought: HACK.
</p></blockquote>
<p>With the benefit of hindsight, yes. You have to realise however that in the Windows 1.0 era programs did their own file open dialogue, like in DOS. And displaying file lists as simple text lists also was the norm for DOS programs, so it must have seemed sensible at the time to add a message for this commonly used functionality. Although I have to say that the dialogues in the first Notepad are hilariously bad, even for the time.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>