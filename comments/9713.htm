<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (33)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-933723">
				<div id="div-comment-933723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933723">
			September 7, 2011 at 7:24 am</a>		</div>

		<p>Is there a kernel-mode implementation of SQL server?</p>
<p>;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933733">
				<div id="div-comment-933733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933733">
			September 7, 2011 at 7:31 am</a>		</div>

		<p>If you want a relational database, then use a relational database. &nbsp;Use the right tool for the right job. &nbsp;The hammer (registry) isn&#39;t your only tool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933743">
				<div id="div-comment-933743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933743">
			September 7, 2011 at 7:46 am</a>		</div>

		<p>Another use of &quot;anticipatory&quot; data: &nbsp;Compatibility shims, where a lot of program names are listed along with their compatibility hacks, even though the user might not have all of those programs installed. &nbsp;Or might not have them installed YET.</p>
<p>I have to wonder about people who like to bash without thinking. &nbsp;I read things like &quot;the registry is horrible; get rid of it&quot;. &nbsp;As someone once said, &quot;and replace it with what?&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-briantkatchhotmail-com odd alt thread-odd thread-alt depth-1" id="comment-933763">
				<div id="div-comment-933763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian+Tkatch' rel='external nofollow' class='url'>Brian Tkatch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933763">
			September 7, 2011 at 8:23 am</a>		</div>

		<p>Wow, thanx for the explanation. I think the registry was a great idea, perhaps abused, but nonetheless a good idea.</p>
<p>In what version of Windows did it start?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933753">
				<div id="div-comment-933753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr&#237;guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933753">
			September 7, 2011 at 8:23 am</a>		</div>

		<p>@David Walker: with a bunch of colon-delimited text files, all stored in the /etc/ directory (for system settings) or in the user&#39;s home directory (for user settings), and which need to be edited using a text editor (vi being the preferred one, and emacs the second choice). Everybody knows it&#39;s easier to manage for the novice user, allows more powerful remote administration for the systems administrator and is more consistent than Windows&#39; Registry for the programmer: it has something for anybody!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933773">
				<div id="div-comment-933773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr&#237;guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933773">
			September 7, 2011 at 8:28 am</a>		</div>

		<p>@Brian Tkatch: the first version of Windows that included the Registry was Windows 3.1, launched in 1992. But at that time, Windows NT had been in development for almost three years, and it&#39;s more than possible than the Registry was already implemented in that OS, so the Windows 3.1 was added for compatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933783">
				<div id="div-comment-933783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933783">
			September 7, 2011 at 8:38 am</a>		</div>

		<p>Asking for relational models are trollish. MS tried this with WinFS and failed. The current trend is to flatten databases out. NoSQL!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933793">
				<div id="div-comment-933793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933793">
			September 7, 2011 at 9:10 am</a>		</div>

		<p>@Antonio Rodríguez</p>
<p>The registry was added for OLE in Windows 3.1, nothing to do with Windows NT. It was later extended to store application data.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jader3rd even thread-even depth-1" id="comment-933803">
				<div id="div-comment-933803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/jader3rd' rel='external nofollow' class='url'>jader3rd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933803">
			September 7, 2011 at 9:12 am</a>		</div>

		<p>Should automatic cleanup happen, the smarts would have to be not to clean up an orphaned entry right away, but to wait for a couple of weeks to pass and a couple of reboots to happen. Then the next probelm to tackle will be automatically defragging the registry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933813">
				<div id="div-comment-933813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933813">
			September 7, 2011 at 9:14 am</a>		</div>

		<p>@Antonio Rodríguez 7 Sep 2011 8:23 AM:</p>
<p>I thought people should to suggest better alternatives, not to send everybody to hell. (back)</p>
<p>I can remote to/load offline registry through regedit and API is good enough. And it has permissions for control unlike text files.</p>
<p>BTW Microsoft was sort of there and I doubt they would want to return there&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933823">
				<div id="div-comment-933823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933823">
			September 7, 2011 at 9:19 am</a>		</div>

		<p>@Klimax: With .NET the trend was heading back towards using individual configuration files for each application. I guess it&#39;s just one of those cyclical things, like all the buzz surrounding cloud computing.</p>
<div class="post">[<i>Configuration files have different use patterns from user settings though. Users like to change settings, so you have to worry about concurrent write access. Configuration files are typically changed only by administrators (and even then only rarely) so concurrent write access is less of an issue. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933833">
				<div id="div-comment-933833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">henke37</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933833">
			September 7, 2011 at 9:36 am</a>		</div>

		<p>The registry still needs defragmentation. Unless you want to think that windows keeps all of it in memory and rewrites the full thing from scratch each time a value or key is deleted.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933843">
				<div id="div-comment-933843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933843">
			September 7, 2011 at 10:29 am</a>		</div>

		<p>@henke37: &nbsp;Do you know exactly how the registry is cached, or not cached, in the memory/page file subsystem? &nbsp;Do you know whether it is read sequentially from disk on each search for a key, and whether the entire registry is read at once? &nbsp;Do you know whether the different hives of the registry are stored on disk in different physical files?</p>
<p>If you don&#39;t know the details, then you shouldn&#39;t claim that it &quot;needs defragmentation&quot;. &nbsp;If you do know those details, then that&#39;s great.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933853">
				<div id="div-comment-933853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933853">
			September 7, 2011 at 10:39 am</a>		</div>

		<p>Overheard on the other side of MS campus:</p>
<p>&quot;We need to develop a new format for application installation. Let&#39;s call it MSI&quot;</p>
<p>&quot;Why don&#39;t we make it a database?&quot;</p>
<p>&quot;Cool! Let&#39;s make it a database. Then we don&#39;t need to supply any authoring tools. Everybody can populate a database, right?&quot;</p>
<p>&quot;And while we&#39;re at that, don&#39;t care about installer performance. Nobody would complain it takes 1 minute to install a couple files&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933863">
				<div id="div-comment-933863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933863">
			September 7, 2011 at 12:18 pm</a>		</div>

		<p>[Configuration files have different use patterns from user settings though. Users like to change settings, so you have to worry about concurrent write access. Configuration files are typically changed only by administrators (and even then only rarely) so concurrent write access is less of an issue. -Raymond]</p>
<p>I&#39;ve seen many .NET applications that have both per-application (e.g. admin settings) and per-user (e.g. MRU lists, window positions, etc.) configuration files; I&#39;m pretty sure there are classes designed to handle this specific scenario built right into the framework. &nbsp;This is more-or-less coming back full circle to .ini files, only now they are .xml files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933873">
				<div id="div-comment-933873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933873">
			September 7, 2011 at 1:42 pm</a>		</div>

		<p>@John Correct: theConfig = ConfigurationManager.Load(ConfigurationUserLevel.PerUserRoamingAndLocal) will merge settings from AppDataLocal&#8230;, AppDataRoaming&#8230;, App.exe.config and Machine.config.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933883">
				<div id="div-comment-933883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933883">
			September 7, 2011 at 1:43 pm</a>		</div>

		<p>What about WMI instead of the registry when some sort of RDBMS is needed for storing app data?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933903">
				<div id="div-comment-933903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933903">
			September 7, 2011 at 2:14 pm</a>		</div>

		<p>@David Walker 7 Sep 2011 10:29 AM:</p>
<p>I do have sort of idea (Windows Internals) and would say once per year one cleanup and defrag is way more then sufficent unless one did huge amount of uninstallation/deletion. (if uninstall-install then no extra block present as they are reused.)</p>
<p>@John:</p>
<p>DotNet programms are not the only one. Counter example is TortoiseSVN, which has to use registry because it integrates with shell and thus by that can be running under several user accounts at the same time. (the only ini-like files come from libsvn)</p>
<p>And with ini/xml you don&#39;t get key-level access control. Only file level which is usually insufficent.</p>
<p>And I don&#39;t think many of those programms using xml are written with multiple copies running under different users at the same time in mind. I smell corruption&#8230; (or at best sharing violation)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933913">
				<div id="div-comment-933913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933913">
			September 7, 2011 at 2:56 pm</a>		</div>

		<p>Raymond you surprised me!!! I did not think you would respond. Interesting points you bring up lets go over a few things.</p>
<p>&quot;As originally designed, the registry was for recording information about file types.&quot;</p>
<p>Well we know that the registry is used to store much more data than that now. It now stores info about the kernel,device drivers, services,SAM, and third party applications and as a result the importance of the integrity of the data has risen significantly from the original design that you described.</p>
<p>&quot;But I would argue that in the general case, you don&#39;t want strict enforcement of referential integrity.&quot;</p>
<p>Yes and I agree with that. I was trying to hint in my original comments that referential integrity should really only be enforced in <em>specific</em> cases where corruption of the registry could occur.</p>
<p>&quot;Just leave it as an unregulated collection of name/value pairs governed by convention rather than rigid rules, as long as the code which writes the information and the code which reads it agree on the format of the information and where to look for it.&quot;</p>
<p>My thinking about RDBMS&#39; and data storage have evolved since I originally wrote these original comments. I now believe that NoSQL is a viable solution for storing schema-less data.</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/NoSQL" rel="nofollow">en.wikipedia.org/&#8230;/NoSQL</a></p>
<p>These systems are much more lightweight and permissive than a typical RDBMS. Also there are storage systems that are eventually‐consistent key‐value stores like Apache Cassandra. These type of ACID-like features are being added to the Registry already anyway.</p>
<p>Example:</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Windows_registry#Rationale" rel="nofollow">en.wikipedia.org/&#8230;/Windows_registry</a></p>
<p>&quot;The registry has features that improve system integrity, as the registry is constructed as a database and offers database-like features such as atomic updates. If two processes attempt to update the same registry value at the same time, one process&#39;s change will precede the other&#39;s and the overall consistency of the data will be maintained.[&#8230;] Windows Vista and Windows 7 provide transactional updates to the registry, extending the atomicity guarantees across multiple key and/or value changes, with traditional commit-abort semantics.&quot;</p>
<p>Eventually the registry will evolve to become a complete database, its already partially there its just a question of when the windows team will stop dancing around the bush and take the final leap and implement it as a full fledged database system.</p>
<p>In the beginning when constrained environments and data were the rule of law, you&#39;re right none of these design options made sense but as the complexity and size of the data grows so must the complexity and size of the code that manages it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933923">
				<div id="div-comment-933923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caleb Vear</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933923">
			September 7, 2011 at 3:37 pm</a>		</div>

		<p>I would love it if most applications did just keep their settings in an .ini or similar file rather than hiding it away in the registry. &nbsp;If the settings are kept in the program directory it makes it so much easier to back them up or move them to another machine. &nbsp;Add to this the bonus of not clogging up my registry with useless crap and it sounds even better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933943">
				<div id="div-comment-933943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933943">
			September 7, 2011 at 6:20 pm</a>		</div>

		<p>I prefer to use the registry only for its intended purpose: program X is installed in directory YX and handles file type Z has service A and shell plugin B and uninstaller U.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933933">
				<div id="div-comment-933933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933933">
			September 7, 2011 at 4:50 pm</a>		</div>

		<p>ton: the registry *is* NoSQL.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-933953">
				<div id="div-comment-933953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933953">
			September 8, 2011 at 1:13 am</a>		</div>

		<p>Note the registry is also read by the boot loader which has a pretty limited size (to check which drivers need to be preloaded with the kernel), so the amount of features you can add to the file format are a bit limited. Still, Microsoft could have done better with regard to stability and efficiency.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-933963">
				<div id="div-comment-933963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933963">
			September 8, 2011 at 6:29 am</a>		</div>

		<p>WMI DBs are a horrible example of rdbms gone wrong. With 2000 servers, the probability for any server with one or more corrupt wmi repos is about 70-80% (if you fix the broken repos when you detect them &#8211; I do this on daily basis). And keep in mind that windows tries to rebuild broken wmi repos at every boot, without that it would be a even larger mess. WMI apis are therefore not trustworthy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-933973">
				<div id="div-comment-933973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-933973">
			September 8, 2011 at 6:40 am</a>		</div>

		<blockquote><p>
  Eventually the registry will evolve to become a complete database, its already partially there its just a question of when the windows team will stop dancing around the bush and take the final leap and implement it as a full fledged database system.
</p></blockquote>
<p>I think it&#39;ll probably never happen. The development of registry has to observe the same rule as notepad &#8211; you have to make to possible to use even if most of the other parts of system goes wrong.</p>
<p>And the result will be probably the same as the (non-essential to become justifible) list of feature people want to add to notepad &#8211; Instead, people get those features in Wordpad or Word. In fact this is happening&#8230; I see people started to store cluster application settings in database.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-934083">
				<div id="div-comment-934083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Faisal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934083">
			September 8, 2011 at 8:41 am</a>		</div>

		<p>See the Jeff Atwood&#39;s opinion about windows registry.</p>
<p><a href="http://www.codinghorror.com/blog/2007/08/was-the-windows-registry-a-good-idea.html" target="_new" rel="nofollow">http://www.codinghorror.com/&#8230;/was-the-windows-registry-a-good-idea.html</a></p>
<p>I liked his last observations</p>
<p>&lt;BLOCKQUOTE&gt;</p>
<p>How many billions of man-hours could we have saved by now if some early Windows NT 3.0 or 3.5 developers had decided to turn off public access to the registry, and transparently redirected the public registry API calls so they followed simpler, UNIX-like filesystem storage conventions instead?</p>
<p>&lt;/BLOCKQUOTE&gt;</p>
<div class="post">[<i>Hey, let&#39;s go back to the old days when everybody had to write a file parser! Oh wait, I remember those days. You had bugs like &quot;If system.ini contains a line longer than 80 characters, then running program X causes your machine to become unbootable&quot; because program X tried to edit system.ini and messed up and ended up corrupting it. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-934133">
				<div id="div-comment-934133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Greg D</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934133">
			September 8, 2011 at 9:29 am</a>		</div>

		<p>&quot;[Hey, let&#39;s go back to the old days when everybody had to write a file parser! Oh wait, I remember those days. You had bugs like &quot;If system.ini contains a line longer than 80 characters, then running program X causes your machine to become unbootable&quot; because program X tried to edit system.ini and messed up and ended up corrupting it. -Raymond]&quot;</p>
<p>+1 for truth. &nbsp;It&#39;s convenient that .Net apps get all that parsing for free, but a lot of folks aren&#39;t writing .Net apps and a lot of folks who <em>are</em> writing .Net apps are still rolling their own parsers for this (presumably due to ignorance of the built-in mechanism, willful or not). &nbsp;Better a simple call to read/write in the registry than Yet Another Busted Parser.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-934253">
				<div id="div-comment-934253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934253">
			September 8, 2011 at 11:48 am</a>		</div>

		<p>Aha!!! It turns out someone has already done the leg work on a relational database system back-end with a key-value store front-end end to store data. &nbsp;</p>
<p><a rel="nofollow" target="_new" href="http://pages.cs.wisc.edu/~adwait/cdms.pdf" rel="nofollow">pages.cs.wisc.edu/&#8230;/cdms.pdf</a></p>
<p>&quot;CDMS instead stores ﬂat key-value pairs in relational tables; the</p>
<p>hierarchy is imposed by a naming mechanism. Values de-</p>
<p>fault to text, but may be optionally interpreted as a num-</p>
<p>ber, a ﬁle name, a link, or other type, if metadata indicat-</p>
<p>ing the type is stored.</p>
<p>Unlike other conﬁguration services, CDMS provides</p>
<p>another dimension of organization: settings related to a</p>
<p>single user, application, or service are grouped into ob-</p>
<p>jects. This allows related settings that have unrelated</p>
<p>names to be associated. These objects represent a group</p>
<p>of settings in a scope and are the building blocks of an</p>
<p>inheritance mechanism, where an object may inherit set-</p>
<p>tings from many other objects.&quot;</p>
<p>Using the configuration objects from the key-value front-end a schema-less data store could be supported AND still have a relational database back end to create a registry that supports referential integrity when needed and is more stable and reliable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-934293">
				<div id="div-comment-934293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934293">
			September 8, 2011 at 1:29 pm</a>		</div>

		<p>Why do people keep complaining about the stability, reliability, or performance of the Registry? I&#39;ve never heard of it being unstable, unreliable, or slow except on Win9x, and that was over a decade ago.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-934323">
				<div id="div-comment-934323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934323">
			September 8, 2011 at 3:49 pm</a>		</div>

		<p>@Gabe</p>
<p>Probably because they&#39;re the same people who keep their systems running smoothly with RegCleanerPro2011 and AwesomeSuperRegFixer 4.</p>
<p>There are very few snakeoil software products more successful than registry &quot;cleaners&quot; and &quot;fixers&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-934333">
				<div id="div-comment-934333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934333">
			September 8, 2011 at 6:09 pm</a>		</div>

		<p>@ton: Like what I said, for those who want to store their settings in relational database, it isn&#39;t really that difficult to roll out your own. You can even use a SQLCE database to store your settings, then write registry API like wrappers to get the values for you. Noone prevent you to do that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-934353">
				<div id="div-comment-934353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934353">
			September 8, 2011 at 8:51 pm</a>		</div>

		<p>Still using GetPrivateProfileString</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-934383">
				<div id="div-comment-934383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">hagenp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110907-00/?p=9713#comment-934383">
			September 9, 2011 at 1:31 am</a>		</div>

		<p>[As originally designed, the registry was for recording information about file types.]</p>
<p>First time I noticed the registry being there was in 199x when doing admin work for Win3.1 and MS Office 4.3.</p>
<p>Some MSO settings were not in an *.ini file but in something (IIRC) like reg.dat.</p>
<p>Funny enough registry export (with regedit.exe) resulted in a file larger than 64kB, but you had to split it into chunks of 64kB before re-importing it. :-)</p>
<p>(Our goal at the time was &quot;cloning&quot; MSO installations to different computers when maintaining 30+ computers, and we found out that some system-specific entries had to be renamed.)</p>
<p>Later tools like &quot;Delta Deploy&quot; very nicely fixed these problems, and were way easier to handle that MS SMS.</p>
<p>Nowadays registry exporting/importing/editing is much easier.</p>
<p>Bonus fact: regedit.exe was one of the first tools to actively support dual-mode operation &#8211; commandline and GUI &#8211; within the same binary.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>