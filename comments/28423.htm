<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (5)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-460473">
				<div id="div-comment-460473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070112-02/?p=28423#comment-460473">
			January 12, 2007 at 2:25 pm</a>		</div>

		<p>It&#8217;s worth noting also that the RichEdit control doesn&#8217;t support WM_PRINTCLIENT, so EM_FORMATRANGE is the only way to approximate this behavior as well.</p>
<div class=post>[<i>Um, WM_PRINTCLIENT wouldn&#8217;t help even if it were supported. How do you print a 50-page document with WM_PRINTCLIENT? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-460483">
				<div id="div-comment-460483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070112-02/?p=28423#comment-460483">
			January 12, 2007 at 3:39 pm</a>		</div>

		<p>I haven&#8217;t looked at printing in windows since win95, and back then it was non-trivial to figure out. While I comprehend the code you&#8217;ve posted, I see printing continues to be a non-trivial task. Maybe since you talk of graphics etc enough, the abstraction of the device context/DC means who cares if you&#8217;re drawing to the screen or printer, but to the rest of us rubes, it&#8217;s stupidly complex.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-460513">
				<div id="div-comment-460513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070112-02/?p=28423#comment-460513">
			January 12, 2007 at 5:58 pm</a>		</div>

		<p>WM_PRINTCLIENT has nothing to do with printing Raymond, I was just pointing out that if you do want to get the RichEdit control to render itself to an arbitrary DC, EM_FORMATRANGE is the only way to do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-460463">
				<div id="div-comment-460463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070112-02/?p=28423#comment-460463">
			January 12, 2007 at 12:30 pm</a>		</div>

		<p>Despite the relatively large quantity of documentation on this topic, I think there are two reasons people have been confused. &nbsp;(Note: &nbsp;I write this as somebody who&#8217;s never needed to make a RichEdit control print, and never even thought to look up the documentation before: &nbsp;So I&#8217;m genuinely approaching this as a newbie, an educated and smart newbie, but a newbie nonetheless.)</p>
<p>First, I think people are confused because this is what MSDN says about EM_FORMATRANGE:</p>
<p>&quot;EM_FORMATRANGE Message&quot;</p>
<p>&quot;The EM_FORMATRANGE message formats a range of text in a rich edit control for a specific device.&quot;</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/richedit/richeditcontrols/richeditcontrolreference/richeditmessages/em_formatrange.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/richedit/richeditcontrols/richeditcontrolreference/richeditmessages/em_formatrange.asp</a></p>
<p>You don&#8217;t see the word &quot;print&quot; anywhere in its documentation, and the word &quot;printer&quot; only appears once, near the bottom. &nbsp;Anybody naively searching MSDN for the word &quot;print&quot; or &quot;printing&quot; is going to have a hard time finding this. &nbsp;Try it for yourself; type &quot;site:msdn.microsoft.com print richedit&quot; into Google and see how long it takes to find a meaningful page. &nbsp;A more useful (and yes, redundant) opening sentence might&#8217;ve been:</p>
<p>&quot;The EM_FORMATRANGE message formats a range of text in a rich edit control for a specific device, most commonly to print a RichEdit control&#8217;s contents to a printer.&quot;</p>
<p>A search engine can *find* that one since it has all the right keywords in all the right places, and 99% of the time that&#8217;s what people are gonna use EM_FORMATRANGE for anyway, so it&#8217;s not inaccurate documentation.</p>
<p>The second reason that people probably have trouble is that for many users, EM_FORMATRANGE is probably overkill; there&#8217;s no such thing as a simple EM_PRINT message. &nbsp;As you yourself demonstrated, it&#8217;s 30 lines of code to get the thing to print. &nbsp;Admittedly, that&#8217;s not a lot, and the additional code offers flexibility, but if all you want is to simply dump the contents of a RichEdit control (which I think is what a lot of people want), you have either some work ahead of you to figure it out or a lot of copy+paste ahead of you &#8212; if you can find a good example. &nbsp;Just like CreateWindow can&#8217;t throw up a window in one or two lines of code, EM_FORMATMESSAGE can&#8217;t print in one or two lines of code, and I think a lot of developers have come to expect common operations can be done in one or two lines of code these days.</p>
<p>So that&#8217;s my two cents on reading the documentation and sample code now, but I could always be wrong.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-460623">
				<div id="div-comment-460623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070112-02/?p=28423#comment-460623">
			January 15, 2007 at 10:27 am</a>		</div>

		<p>I&#8217;ve implemented printing for Windows apps and it is, as my colleague put it, &quot;eine sauerei&quot; (a mess). I think he was talking about the problem generally, rather than my code, but&#8230;</p>
<p>Anyway, definitely non-trivial, though I eventually knocked up a small framework which made things a lot easier for anyone following me.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>