<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (55)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-479233">
				<div id="div-comment-479233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479233">
			March 5, 2007 at 10:26 am</a>		</div>

		<p>Hang on &#8211; what are you calling &#8220;protected operating system&#8221; files here?</p>
<p>&#8220;[desktop.ini] files are marked as &#8220;protected operating system files&#8221; because messing with them changes the plumbing of how Explorer treats those directories.&#8221;</p>
<p>Ummmm&#8230;..but if users can change them, how are they &#8220;protected operating system files&#8221;. With particular regards to the &#8220;protected&#8221; part?</p>
<p>How are you defining protection, if not by an ACL (NTFS) or the System bit (FAT)?</p>
<div class="post">[<i>Please read the linked article again. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479253">
				<div id="div-comment-479253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479253">
			March 5, 2007 at 11:15 am</a>		</div>

		<p>The problem is when there is a conflict between the desire to stop people messing about unknowingly, and allowing the above-average but not expert user to find things.</p>
<p>Think of the grief that is caused by .pst files are hidden by default (apart from the fun that&#8217;s caused when you copy them over from CD and they marked read only as a result).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479293">
				<div id="div-comment-479293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://gabest@gabest.org' rel='external nofollow' class='url'>Gabest</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479293">
			March 5, 2007 at 12:24 pm</a>		</div>

		<p>On vista there are even two desktop.ini&#8217;s on the desktop. Since I can&#8217;t live without seeing the hidden files I have no other choice but to sacrifice two expensive icon space there. There should be a better way customizing folders than littering them with hidden files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479303">
				<div id="div-comment-479303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Julio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479303">
			March 5, 2007 at 12:25 pm</a>		</div>

		<p>&quot;A user might see them and say, &quot;Huh, what&#8217;s this? I&#8217;m not using it. Let me delete it and free up some disk space.&quot;&quot;</p>
<p>Back in the Windows 3.1 days, I received a call from a friend of mine:</p>
<p>&quot;Hey, Julio. I need more space in my hard disk, so I deleted some useless files. But Windows stopped working &#8212; that buggy Windows, always a problem.&quot;</p>
<p>&quot;Do you remember which files you deleted?&quot;</p>
<p>&quot;They weren&#8217;t my files, so they should be useless. Most of them ended in DLL, I think.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479313">
				<div id="div-comment-479313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479313">
			March 5, 2007 at 12:29 pm</a>		</div>

		<p>Security != Safety</p>
<p>Protect : Hide :: Security : Safety</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479343">
				<div id="div-comment-479343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mdahmus.monkeysystems.com/blog/' rel='external nofollow' class='url'>M1EK</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479343">
			March 5, 2007 at 1:23 pm</a>		</div>

		<p>Why not use something akin to OS/2&#8217;s &#8220;extended attributes&#8221; in the filesystem itself to hold this customization data? </p>
<div class=post>[<i>I&#8217;ll leave you to find the holes in this suggestion. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479353">
				<div id="div-comment-479353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479353">
			March 5, 2007 at 1:31 pm</a>		</div>

		<p>It seems to me that hiding files is essentially protecting them from stupid people like me who would delete them upon not figuring out what they&#8217;re for.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479363">
				<div id="div-comment-479363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479363">
			March 5, 2007 at 2:14 pm</a>		</div>

		<blockquote><p>
  We&#8217;ve learned the hard way that none of these programs can do anything dangerous if run with no command line options. For example, shutdown.exe with no parameters doesn&#8217;t actually shut down your computer.
</p></blockquote>
<p>Duh, the command should print a help/usage msg if executed without any parameters.</p>
<p>I would&#8217;ve thought that was obvious. :=)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479373">
				<div id="div-comment-479373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joeri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479373">
			March 5, 2007 at 2:20 pm</a>		</div>

		<p>Hiding files to prevent people from deleting them can however turn against you: long ago, in windows 3.11 days, I decided to delete an empty directory as it annoyed me (I didn&#8217;t really think through it, I was quite young too). A few days later we discovered that the CD-ROM drive suddenly wasn&#8217;t recognized anymore. Turned out that that empty directory wasn&#8217;t empty after all.</p>
<p>Ever since I always set windows explorer to show all files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479383">
				<div id="div-comment-479383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479383">
			March 5, 2007 at 2:25 pm</a>		</div>

		<p>I think that the source of the confusion here is that what Microsoft really means by &quot;protected&quot; is &quot;should be protected&quot; (which they should), but some people understand that to mean &quot;are protected&quot; (which they aren&#8217;t). &nbsp;Maybe verbiage like &quot;important&quot; would have resulted in less confusion?</p>
<p>Personally, I like the concept of system folders better than system files &#8211; they&#8217;re analogous to the &quot;do not open, no user servicable parts inside&quot; labels on electronics. &nbsp;But what can ya do, what&#8217;s done is done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479393">
				<div id="div-comment-479393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479393">
			March 5, 2007 at 2:26 pm</a>		</div>

		<p>By the way, there&#8217;s a whole thread on shellrevealed.com about hiding desktop.ini</p>
<p>Some folks believe that since desktop.ini is a real file, it should be displayed when the user selects the Show Hidden Files option.</p>
<p>Other people feel desktop.ini should always be hidden &#8211; especially on the Desktop &#8211; despite the Show Hidden Files.</p>
<p>On Vista, if Show Hidden Files is turned on, then the CD-RW drives will always have a desktop.ini &quot;waiting to be written to CD&quot;</p>
<blockquote><p>
  Feedback from the product support team told us that many users just go into their system directory and double-click everything in it, just to see what happens.
</p></blockquote>
<p>Ever hit Enter by accident in a folder when all its files are selected? &nbsp;WinXP will ask &quot;are you sure you want to open all 1234 files?&quot; but it was loads of fun in earlier Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479403">
				<div id="div-comment-479403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anony Moose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479403">
			March 5, 2007 at 3:04 pm</a>		</div>

		<blockquote><p>
  Why not use something akin to OS/2&#8217;s &quot;extended attributes&quot; in the filesystem itself to hold this customization data?
</p></blockquote>
<p>The lack of a time machine makes it impractical to implement an otherwise ideal solution. &nbsp;;)</p>
<p>Seriously, both UNIX (all variants) and Windows share two things in common &#8211; they&#8217;re a product of evolution and not intelligent design, and sacrificing backwards compatability will eliminate adoption of later versions, thus ensuring the perpetuation of decades old design decisions that were the result of hardware limitations that would embarass a wrist watch today. &nbsp;;)</p>
<p>The whole &quot;desktop.ini&quot; file mess is a compromise to get around the detail that older systems (eg a FAT32 formatted hard drive) won&#8217;t really react well to Vista trying to play with &quot;extended attributes&quot;, or with ACL based systems. We can complain all we like about the way things work today, but if Windows XP had shipped with a requirement to abandon all previous filesystems and we had to reformat all our hard drives to install, well, then you&#8217;ld really have seen some screaming &#8211; and much slower adoption.</p>
<p>That said, I&#8217;ve never seen a &quot;desktop.ini&quot; file actually on my desktop before, so if Vista actually is displaying it, that&#8217;s a definate irritating step backwards.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479413">
				<div id="div-comment-479413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479413">
			March 5, 2007 at 3:10 pm</a>		</div>

		<p>Maybe go back in time and use the registry instead? Are not other folder customizations &quot;remembered&quot; in the registry?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479423">
				<div id="div-comment-479423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.consultingsmiths.com' rel='external nofollow' class='url'>David Smith</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479423">
			March 5, 2007 at 3:12 pm</a>		</div>

		<p>&quot;Delete those files, and your Fonts folder stops working.&quot; Not so.</p>
<p>I cd&#8217;d to C:WindowsFonts and used UNIX shell tools to &quot;mv desktop.ini desktop.bak&quot;. Lit up WinWord and fonts seemed to work as advertised. The only change was that Explorer let me see the real contents of the Fonts directory, which is what I&#8217;d prefer that it do.</p>
<p>Interestingly, cmd.exe seems to be quite twisted when it comes to the Fonts directory. Command completion will work if I type &quot;dir deskt&quot; then press my completion character (TAB) &#8211; expands to &quot;desktop.ini&quot; then &quot;not found&quot;. Copying desktop.ini to &quot;foo.bak&quot; is likewise &quot;completable&quot; but &quot;not found&quot;. So does cmd.exe only recognize .tt? and .fon files in Fonts? No, because renaming &quot;foo.bak&quot; to &quot;foo.fon&quot; is still broken. Love those alternate shells!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479433">
				<div id="div-comment-479433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479433">
			March 5, 2007 at 3:17 pm</a>		</div>

		<p>I understand &#8216;hiding&#8217; files to &#8216;protect&#8217; the user from their own stupidity. &nbsp;Good idea, but it does introduce &#8216;opportunities&#8217; for untested combinations to fail. &nbsp;In Vista, when Explorer is configured to show all hidden and system files, the desktop.ini files from the desktop directories appear on the real desktop in addition to the normal shortcuts. &nbsp;I guess they didn&#8217;t test that combination, but it works correctly in XP.</p>
<div class=post>[<i>Um, it worked the same on XP. Create a hidden system desktop.ini file on your desktop and it will show up even on XP. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479463">
				<div id="div-comment-479463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479463">
			March 5, 2007 at 3:40 pm</a>		</div>

		<p>David, I don&#8217;t think the problem with copying desktop.ini is cmd.exe fault. cmd completes the name but &quot;copy&quot; does not want to copy hidden files.</p>
<p>Granted, &quot;copy&quot; is a built-in command. But there are many external commands that don&#8217;t work well with hidden files either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479473">
				<div id="div-comment-479473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479473">
			March 5, 2007 at 3:45 pm</a>		</div>

		<p>&quot;Delete [desktop.ini], and your Fonts folder stops working&quot;</p>
<p>I don&#8217;t think the Fonts folder ever worked properly, to be honest with you. &nbsp;I realised it was broken the first time I put a hard disk from another PC into mine and tried to copy the fonts from one installation to the other&#8230; for somebody who wasn&#8217;t aware at the time that the shell did virtual directory-like things, it was very confusing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479483">
				<div id="div-comment-479483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479483">
			March 5, 2007 at 3:48 pm</a>		</div>

		<p>David Smith, the desktop.ini file is marked with the Hidden attribute, so it is &quot;not found&quot; by standard system utilities like dir and copy that the file is meant to be hidden from. Filename completion does not respect the Hidden and System attributes, so it shows those files just fine. If it didn&#8217;t, you wouldn&#8217;t be able to use tab completion for the attrib command reliably.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479503">
				<div id="div-comment-479503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479503">
			March 5, 2007 at 4:34 pm</a>		</div>

		<p>&#8212;&quot;Makes a hellova lot more sense than the &quot;hide file extensions for known file types&quot; option that i must remember to disable every time i re-install Windows&#8230;&quot;&#8212;-</p>
<p>The hide file extensions is the default setting and very much correctly so. If it wasn&#8217;t non-tech users would rename the files and change the extension and then find they can&#8217;t open them.</p>
<p>Tech users know to disable the setting.</p>
<p>By the way, I&#8217;ve never seen a desktop.ini file on the desktop. It&#8217;s always in the My Documents folder.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479513">
				<div id="div-comment-479513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lionel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479513">
			March 5, 2007 at 4:34 pm</a>		</div>

		<p>&quot;Hiding and showing is done by IShellFolder::EnumObjects; it&#8217;s a property of the folder not of the view.&quot;</p>
<p>Well, maybe the implementation should be changed to fit user&#8217;s expectations. Figuring how is left as an exercise to the developers.</p>
<p>&quot;Which is a good thing. Otherwise, you change the setting and say, &quot;Hey, that setting has no effect on common dialogs / Internet Explorer / anybody else that re-uses the file browser control.&quot;</p>
<p>Uh? Why would you change it in such a broken way? The point is to keep hiding files on the desktop (and possibly a few other places, such as menus), not to hide file everywhere except in the file manager, so it&#8217;s the shell views that should be changed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479533">
				<div id="div-comment-479533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Foolhardy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479533">
			March 5, 2007 at 4:48 pm</a>		</div>

		<p>I don&#8217;t see why desktop.ini&#8217;s preferred location couldn&#8217;t have become an alternate data stream of the directory (rather than a file within the directory), for Vista at least. The shell has already been using ADSes to associate metadata with files and directories. Vista already requires NTFS for the boot volume and depends on NTFS features like reparse points. The old desktop.ini file could still be used for existing (not upgraded) directories and FAT volumes, but only use the ADS form for new folder properties on NTFS. A compatibility shim for the occasional broken app could redirect an open request for desktop.ini to the appropriate stream. This wouldn&#8217;t be the first time that such a switch was made.</p>
<p>Desktop.ini is a chunk of metadata about a directory. The problems with it being visible are due to it being incorrectly stored as and treated like a discrete file, when it really shouldn&#8217;t be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479543">
				<div id="div-comment-479543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479543">
			March 5, 2007 at 5:07 pm</a>		</div>

		<p>Hiding encryptiion keys was probably also a contributing factor to EFS&#8217;s initial reputation as &quot;the other recycle bin&quot;. Customers were used to reinstalling Windows every so often. It was well-known voodoo to make the OS more responsive. Unfortunately for folks who used EFS, this also resulted in removing those hidden keys in their old profiles. Data loss.</p>
<p>:-(</p>
<p>At least in the case of keys there are risks to hiding them and risks to revealing them. Which strategy is better? I honestly don&#8217;t know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479553">
				<div id="div-comment-479553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479553">
			March 5, 2007 at 5:18 pm</a>		</div>

		<p>&quot;Huh, what&#8217;s this? I&#8217;m not using it. Let me delete it and free up some disk space.&quot;</p>
<p>Agh, you just reminded me of when I had to support DOS PC users at BT, and everyone had XTree installed (pirate copy, of course), and used to go around &#8216;cleaning up&#8217; their PC.</p>
<p>The number of people who deleted COMMAND.COM was surprisingly high.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479563">
				<div id="div-comment-479563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://qstuff.blogspot.com/' rel='external nofollow' class='url'>Justin Olbrantz (Quantam)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479563">
			March 5, 2007 at 5:31 pm</a>		</div>

		<p>&quot;A &quot;Power User&quot; friend explained to me over IM a few days ago how he was testing the software that comes with Windows. I asked what he meant, and his reply was &quot;Oh, I just wanted to see what all the programs in the Windows, system, and system32 folders do, so I ran them all. Most don&#8217;t seem to do anything anymore. Just more proof that M$ windoze is getting more and more bloated.&quot;&quot;</p>
<p>Did you stab him with a sharp object? You did stab him, right? And if he survives, tell him he&#8217;s not a power user, but a cat that&#8217;s in queue to die.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479613">
				<div id="div-comment-479613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479613">
			March 5, 2007 at 6:27 pm</a>		</div>

		<p>The main problem is that lots of junk accumulates &nbsp;</p>
<p>all over the file system after a while.</p>
<p>Look into %windir% on a typical Windows machine with enabled automatic updates. You&#8217;ll see all those %NtUninstallKBxxxxxx$ folders, dated years back. Do users really want to uninstall some update they installed couple of years ago?</p>
<p>Now if you have managed application look into %USERPROFILE%Local SettingsApps that is another elephant bone yard.</p>
<p>The same thing inside the registry hives.</p>
<p>OS does not take care about cleaning all of these.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479623">
				<div id="div-comment-479623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Steward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479623">
			March 5, 2007 at 6:43 pm</a>		</div>

		<p>David Smith: you can use dir /a desktop.ini to show hidden files. &nbsp;For copying, use xcopy /h (I guess this flag wasn&#8217;t added to copy because xcopy exists).</p>
<p>But I don&#8217;t get why the desktop shows hidden files when the Start Menu doesn&#8217;t. &nbsp;It&#8217;s not like desktop isn&#8217;t already subclassed plenty&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479243">
				<div id="div-comment-479243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479243">
			March 5, 2007 at 11:06 am</a>		</div>

		<p>Just have &#8211; still don&#8217;t see what difference it makes. How can a file be a &#8220;protected operating system file&#8221; if a regular user can change it? How is that actually &#8220;protected&#8221;?</p>
<p>As this article is pointing out, hiding is not the same as protection &#8211; the two are completely orthogonal. Even if, as per the linked article, you added levels 6 and 7 of the &#8220;hidden&#8221; attribute, how does that change what a user can *do* to that file if they already know the full path to it?</p>
<p>I guess another way of what I&#8217;m trying to ask is &#8211; what &#8220;protection&#8221; is provided to &#8220;System&#8221; files that are *not* &#8220;Hidden&#8221;?</p>
<p>Am I making any sense at all?</p>
<div class="post">[<i>My point is that hiding is not the same as ACLs. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479263">
				<div id="div-comment-479263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shog9</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479263">
			March 5, 2007 at 11:28 am</a>		</div>

		<p>System files *are* hidden. That&#8217;s the protection. It goes clear back to the DOS days, when files with the System bit set were excluded from directory listings. &quot;dir /ah&quot;, &quot;dir /as&quot;, &quot;dir /ahs&quot; would show what you were missing. </p>
<p>Frankly, it&#8217;s about as much protection as i can stand for such things &#8211; they&#8217;re out of your way, but you can still copy &#8217;em with XCOPY, delete &#8217;em if they get screwed up, edit &#8217;em if you&#8217;re bored&#8230;</p>
<p>Makes a hellova lot more sense than the &quot;hide file extensions for known file types&quot; option that i must remember to disable every time i re-install Windows&#8230; </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479283">
				<div id="div-comment-479283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479283">
			March 5, 2007 at 11:41 am</a>		</div>

		<p>Raymond &gt; I get that hiding is not the same as protection. That&#8217;s clear.</p>
<p>But you say that you hide protected operating system files such as desktop.ini so that users can&#8217;t mess with them. I&#8217;m trying to figure out how those files count as being &#8220;protected&#8221; if they *don&#8217;t have* an ACL that prevents users from messing with them in the first place.</p>
<div class="post">[<i>That&#8217;s just UI text for a non-technical audience. You try explaining it in 40 characters or less. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479643">
				<div id="div-comment-479643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Sowul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479643">
			March 5, 2007 at 7:58 pm</a>		</div>

		<p>I agree that the Vista desktop.ini (both of them!) on the desktop is incredibly annoying. &nbsp;I can&#8217;t believe that was left there. &nbsp;I know, Raymond, that if you make such a file on XP it will be there; the difference is that XP doesn&#8217;t have them there if you don&#8217;t put them there. &nbsp;With Vista, they are there already. &nbsp;It makes showing all files/folders useless to those with clean desktops.</p>
<div class=post>[<i>And without the file, everybody who doesn&#8217;t speak English will get the wrong icon names. (This was a bug in XP.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479653">
				<div id="div-comment-479653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dazhel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479653">
			March 5, 2007 at 8:46 pm</a>		</div>

		<p>Jack:</p>
<blockquote><p>
  &gt; OS does not take care about cleaning all of these.
</p></blockquote>
<p>I&#8217;d be extremely miffed if the OS took to &quot;cleaning&quot; locations and deleting files/reigstry that it decided wasn&#8217;t important. The system would probably do just as good a job as an inexperienced user at cleaning up because workable artificial intelligence hasn&#8217;t been perfected yet.</p>
<p>All of my experience says that the majority of cruft exists there for a reason. Don&#8217;t like the cruft? Then fine, remove it, but you lose the right to complain if your system starts to act weirdly or show errors in the future if those system files or registry settings were expected to be there.</p>
<p>My $NTUninstallKB&#8230;$ patch folders take up ~170 megabytes of disk space. Compare that to my documents folder that takes up 10 gigabytes of disk space. 1 GB of disk space currently costs approx 40 cents these days. Just as a cost benefit analysis &#8211; is it worth leaving the files in place for piece of mind that nothing should break, or delete them to reclaim a bit some space worth just pennies?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479663">
				<div id="div-comment-479663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ikk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479663">
			March 5, 2007 at 9:05 pm</a>		</div>

		<p>It&#8217;s good to know that i can click on those prongrams in the &nbsp;Windows dir. ;-) I used to do that back on the Win95 days&#8230; :-D</p>
<p>One could find interesting things there, such as the old file manager, a &quot;Win3.1-like&quot; program manager (why???), telnet, mkcompat, regedit&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479683">
				<div id="div-comment-479683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479683">
			March 5, 2007 at 10:08 pm</a>		</div>

		<p>&quot;The whole &quot;desktop.ini&quot; file mess is a compromise to get around the detail that older systems (eg a FAT32 formatted hard drive) won&#8217;t really react well to Vista trying to play with &quot;extended attributes&quot;, or with ACL based systems. We can complain all we like about the way things work today, but if Windows XP had shipped with a requirement to abandon all previous filesystems and we had to reformat all our hard drives to install, well, then you&#8217;ld really have seen some screaming &#8211; and much slower adoption.&quot;</p>
<p>In fact, desktop.ini was invented with the Windows Desktop Update in IE4, I think, (I could be wrong), which had to run on 95.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479453">
				<div id="div-comment-479453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479453">
			March 5, 2007 at 3:37 pm</a>		</div>

		<p>I agree with your conclusion, but sometimes hiding files has unintended consequences.</p>
<p>When XP first came out, I remember there was something of a hubbub about the System Volume Information directory. &nbsp;Not only was it hidden, but it also used ACLs to limit access to SYSTEM. Certain &quot;Power Users&quot; were miffed that they didn&#8217;t have access to the directory, and so what conclusion do they reach? Obviously Microsoft is hiding secret information in there! We&#8217;d better check it out!</p>
<p>They grant themselves access (proof ACLs do *nothing* to enhance protection) and discover the contents. What a waste of space! This folder is using some 15GB of space! DELETE! &nbsp;A few days later they want/need to try out the neat new&#185; System Restore feature. &nbsp;What the crap, it doesn&#8217;t even work!? Stupid Microsoft, never gets anything right! I tweak&#178; my system for hours and this is what I get? Impossible!</p>
<p>No matter what you do people will muck with &quot;protected&quot; files. As soon as you strengthen the protection enough to prevent that (if it&#8217;s even possible), people cry out about &quot;big brother&quot; and how evil Microsoft is. You just can&#8217;t win against a large number of idiots.</p>
<p>By the way, you made me spit Pepsi with &quot;go into their system directory and double-click everything in it&quot;. &nbsp;A &quot;Power User&quot; friend explained to me over IM a few days ago how he was testing the software that comes with Windows. I asked what he meant, and his reply was &quot;Oh, I just wanted to see what all the programs in the Windows, system, and system32 folders do, so I ran them all. Most don&#8217;t seem to do anything anymore. Just more proof that M$ windoze is getting more and more bloated.&quot;</p>
<p>It&#8217;s just about too sad to be funny.</p>
<p>&#185; WinME doesn&#8217;t count</p>
<p>&#178; break</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479693">
				<div id="div-comment-479693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blntechie.wordpress.com' rel='external nofollow' class='url'>LakshmiNarayanan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479693">
			March 5, 2007 at 11:49 pm</a>		</div>

		<p>The point here is if a file is hidden and classified as Operating system files everyone will surely think twice before doing anything o it.But working with the hidden operating sysytem files is the most entertaining part for me,particularly hacking system32 folder,SAM,SYSTEM files helped me to learn a lot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479493">
				<div id="div-comment-479493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lionel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479493">
			March 5, 2007 at 3:51 pm</a>		</div>

		<p>Hiding files by default does make sense, but why should &#8220;Show protected operating system files&#8221; behave the way it currently does? If I enable it, that&#8217;s because I want to see all hidden files *in explorer* (as a file manager), not because I want to clutter my desktop with desktop.ini files.</p>
<p>Actually, what it does is encourage power user to either delete these (with a slight loss of functionality) or accept some hidden file (which is an irritation when you want to explore them).</p>
<p>IMHO, a sane implementation for this option would be to show system files in explorer (as a file manager), but not on the desktop/menus/whatever displayed by the shell (which is explorer, too, of course, but in another mode). I doubt you would find many people actually in favor of the current behavior.</p>
<div class=post>[<i>Hiding and showing is done by IShellFolder::EnumObjects; it&#8217;s a property of the folder not of the view. (Which is a good thing. Otherwise, you change the setting and say, &#8220;Hey, that setting has no effect on common dialogs / Internet Explorer / anybody else that re-uses the file browser control.&#8221;) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479703">
				<div id="div-comment-479703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479703">
			March 6, 2007 at 2:41 am</a>		</div>

		<p>Hm, I thought the desktop on Vista was governed by a desktop manager. Surely it can be tought to ignore desktop.ini&#8217;s.</p>
<p>Yes, I too find them very irritating, as well as the fact that my XP on the same machine now has a $Recyclebin folder in each partition even though I turned the recycle bin off in Vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479713">
				<div id="div-comment-479713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479713">
			March 6, 2007 at 4:39 am</a>		</div>

		<p>What Explorer (and thus the Desktop, etc.) does seems reasonable for general users. For power users who want more control over which files they see then you might want to get a more powerful file manager. (The one I have allows me, if I want, to show all files except a few explicit names or wildcard expressions. I can also define different filename and/or attribute filters for different locations. This is done independently of Explorer so my Desktop doesn&#8217;t have to suffer.)</p>
<p>When I switched from Amiga to PC all those years ago I really found myself missing a decent, configurable and powerful file manager. Explorer works but it was and still is very basic and light. (Which may be a good thing in general, but not for me. I&#8217;m not saying Explorer is bad; I just want more.)</p>
<p>Back then there were no decent options. The Explorer alternatives completely sucked so I stuck to Explorer and got on with my life. That has changed in the last 5 years or so. There are now several very good file managers for Windows (including my personal preference which is a very well known program from the Amiga days) so if Explorer doesn&#8217;t do what you want investigate the alternatives.</p>
<p>We have to keep in mind that MS write software that is used, by default, by millions of people of all computing abilities. Even adding an additional option, or turning a checkbox into a 3-way radio button, could confuse hundreds of thousands of people. Because of that Explorer will probably always be on the simple-but-works side of things with the rest of the market filled by 3rd party options.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479753">
				<div id="div-comment-479753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">shut</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479753">
			March 6, 2007 at 5:40 am</a>		</div>

		<p>If i double click shutdown.exe in the system folder, i expect the system to shutdown.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479763">
				<div id="div-comment-479763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Xavi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479763">
			March 6, 2007 at 6:51 am</a>		</div>

		<blockquote><p>
  Hiding files is not the same as protecting them
</p></blockquote>
<p>Totally agreed</p>
<p>Concenring Desktop.ini and the desktip&#8230; going slightly off topic:</p>
<p>Half of the posts here would be obsolete if the desktop wouldn&#8217;t be some sort of file explorer.</p>
<p>Being aware of the benefits and simplifications that come along with this approach, I&#8217;m not so sure if this is really pays off in the end.</p>
<p>Anybody knows how Mac-OS or Unix handle this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479773">
				<div id="div-comment-479773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479773">
			March 6, 2007 at 7:24 am</a>		</div>

		<p>Xavi: OSX and various *nix WMs handle it approximately the same way &#8211; there&#8217;s a folder called &quot;Desktop&quot; or similar in the user&#8217;s home directory that contains the files that are on the desktop. &nbsp;OSX also adds shortcuts to the base directories of various media (hard drives, CDs, USB flash drives, etc, etc) to this.</p>
<p>Vorn</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479793">
				<div id="div-comment-479793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479793">
			March 6, 2007 at 8:26 am</a>		</div>

		<p>Dazhel:</p>
<blockquote><p>
  1 GB of disk space currently costs approx 40 cents these days.
</p></blockquote>
<p>Very true. &nbsp;However, you can&#8217;t add this extra space to the boot partition of a Windows system (which is where the windows directory almost always lives), so it&#8217;s a rather moot point. &nbsp;If you need that extra space, you can&#8217;t get it, short of reinstalling.</p>
<p>(Yes, there are a few third-party, unsupported utilities that claim to be able to expand the system volume. &nbsp;But it&#8217;s unsupported, so most people (including me) aren&#8217;t all that comfortable with it. &nbsp;And of course partitions can be expanded if they&#8217;re on a dynamic disk, but I&#8217;m not sure whether a &quot;normal&quot; partition table can be upgraded to a dynamic one without a reinstall.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479803">
				<div id="div-comment-479803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mdahmus.monkeysystems.com/blog/' rel='external nofollow' class='url'>M1EK</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479803">
			March 6, 2007 at 9:43 am</a>		</div>

		<p>As I recall (and it&#8217;s been a very long time), the extended attribute scheme on OS/2 used built-in filesystem support in HPFS (presumably available in NTFS) but used a desktop.ini-like solution on FAT. Which would, if correct, make the same solution feasible here for Windows &#8211; you wouldn&#8217;t be any worse off than today if you were using FAT32; and you&#8217;d be a lot better off if using NTFS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479893">
				<div id="div-comment-479893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-479893">
			March 6, 2007 at 3:43 pm</a>		</div>

		<p>The OS/2 Extended Attributes were natively supported on HPFS, and continues to be supported on NTFS. &nbsp;They were also supported on FAT systems on OS/2. &nbsp;There was a hidden file at the root of the drive/volume named &quot;EA DATA. SF&quot;. &nbsp;The index/offset was maintained in two bytes of the FAT directory entry, starting at offset 20 (0x14). &nbsp;These two bytes are still available on all versions of Windows. &nbsp;Unfortunately, these two bytes have been reused on FAT-32, where they contain the high-order two bytes of the starting cluster number of the file/directory.</p>
<p>To my knowledge, the EAs are not exposed to the WIN32 API. &nbsp;You have to use the Native API functions &quot;NtQueryEaFile()&quot; and &quot;NtSetEaFile()&quot;, which are not formerly documented by Microsoft.</p>
<p>I would be curious as to the future of these Native API&#8217;s, considering that the OS/2 Subsystem was removed with Windows XP. &nbsp;Too bad MS never made documented WIN 32 interfaces to these, as there may be cases where using EAs are preferable to Alternate Data Streams.</p>
<p>EAs are even better for data hiding than ADSs, since they fly so far below the radar screen. &nbsp;Only backup utilities know about them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480183">
				<div id="div-comment-480183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dazhel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480183">
			March 7, 2007 at 10:16 pm</a>		</div>

		<p>BryanK:</p>
<blockquote><p>
  &gt; However, you can&#8217;t add this extra space to the boot partition of a Windows system
</p></blockquote>
<p>Agreed, reinstallation may be necessary if you absolutely need the space on the boot partition. &nbsp;I&#8217;m not all that comfortable with those utilities either. All in all, it&#8217;s probably a better solution to buy another hard disk drive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-480203">
				<div id="div-comment-480203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marius</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480203">
			March 8, 2007 at 4:42 am</a>		</div>

		<p>Raymond, it&#8217;s a very interesting subject.</p>
<p>I&#8217;ve always wondered about why was decided to use hidden ini files for this.</p>
<p>First, the INI API functions are considered deprecated and we should not use them. Why not use xml or any other (more) portable format?</p>
<p>Second, Windows was designed and recommends applications to use the Registry to store their settings.</p>
<p>Considering that these ini files probably are only useful to Windows Explorer, why aren&#8217;t these settings stored in a registry node, for the current logged in user, for example?</p>
<p>These ini files are small but each of them takes 4 KB on the drive. I currently have 112 small desktop.ini files, totaling 17204 bytes but the space used is 458.752 bytes. Yes, I know space is no longer an issue but do these files really need to fragment the driver when all these settings could have been stored in registry or in a single xml/ini file in System32 folder ?</p>
<p>I don&#8217;t know, I&#8217;m not an expert but it sure looks to me that all this desktop.ini stuff was a feature added without lots of thinking or as a workaround for something.</p>
<p>And I don&#8217;t even want to start ranting about Thumbs.db..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480273">
				<div id="div-comment-480273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480273">
			March 8, 2007 at 10:25 am</a>		</div>

		<p>Dazhel &#8212; that&#8217;s probably fine for client machines, yes. &nbsp;It&#8217;s not so great a solution for a server (which is what I was thinking about when I wrote the earlier comment, though I didn&#8217;t actually say anything about it).</p>
<p>A sister company of ours used to have a machine on our site that ran Server 2k3, on a 4G root partition. &nbsp;It was a 4G root partition because the box was upgraded from NT 4 Server (which didn&#8217;t allow a root FS larger than that) without doing a full reinstall. &nbsp;(Our parent company acquired this sister company several years after they had hired some random consultant to do this upgrade.)</p>
<p>Needless to say, Server 2k3 doesn&#8217;t run very well on a 4G C drive&#8230; &nbsp;we ran out of space several times trying to install patches because of all the NtUninstallXXXXX directories. &nbsp;(Of course having Exchange 2003 installed on the same box didn&#8217;t help either, but at least the Exchange databases were on a different partition.)</p>
<p>And of course they don&#8217;t use that server anymore, so it&#8217;s off and likely to never be turned on again unless they need an old email that they didn&#8217;t copy to the replacement. &nbsp;So it&#8217;s not even a problem anymore. &nbsp;But it was a pretty large headache for a couple years while it was in use.</p>
<p>(And note, I&#8217;m not saying the OS should randomly delete files. &nbsp;It might be nice if the NtUninstall stuff got deleted eventually, but as you say, it&#8217;s not really that much space. &nbsp;Unless you&#8217;re on a 4G disk that&#8217;s almost full and can&#8217;t be replaced without either several days of downtime, which the users won&#8217;t accept, or a new server box, which the accounting people don&#8217;t generally like spending several thousand dollars on without any notice. &nbsp;But hey, whatever.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-480293">
				<div id="div-comment-480293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480293">
			March 8, 2007 at 11:40 am</a>		</div>

		<p>Marius: Putting the desktop.ini data into the registry is about the last thing you&#8217;d want to do.</p>
<p>For one thing, there&#8217;s no limit on the amount of information to store. I could have a desktop.ini for each of 1M directories, which would undoubtedly blow my registry quota.</p>
<p>Another reason is that you want the customization to move with the folder. I shouldn&#8217;t lose my customizations just because I rename a folder or move it to a different parent, or even a different computer. And renaming a folder would orphan all of the data in the registry under its name.</p>
<p>Similarly, an administrator should be able to set the customizations for folders on a file server. A user shouldn&#8217;t have to make his own customizations every time he maps a share to a different drive letter.</p>
<p>While I do like the idea of using EAs or ADs to store the data, it would be extremely difficult to get your customizations when copying a folder to a CD, zipping it up, or transferring it via FTP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480383">
				<div id="div-comment-480383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marius</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480383">
			March 8, 2007 at 2:10 pm</a>		</div>

		<p>Thank you Gabe. It makes sense what you say.</p>
<p>However, it still makes me think.. How often do you copy or move folders like your My Documents , Windows, System32 or Program Files folder?</p>
<p>I&#8217;m using Windows operating systems since Windows 3.0 but never in my life I needed those Desktop.ini or Thumbs.db files. I hardly ever use Windows Explorer for a fact, 99.99 % of the time I use Total Commander which doesn&#8217;t care about those files.</p>
<p>You&#8217;re right, storing settings in registry for 1M folders isn&#8217;t right, but would you accept having 1M x 1 KB files on your drive taking up about 4 times as much space because the smallest size a file can be is usually 4 KB ?</p>
<p>My solution would probably be creating a database for these settings and an API that applications would be able to use and offer the choice of transferring these files along with the rest of the files in a folder. There are more advanced problems with the file system such as applications that do not copy the alternate file streams of a file and this didn&#8217;t force Windows and Microsoft to create workarounds.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-480503">
				<div id="div-comment-480503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480503">
			March 9, 2007 at 1:21 am</a>		</div>

		<p>Thursday, March 08, 2007 4:42 AM by Marius</p>
<blockquote><p>
  And I don&#8217;t even want to start ranting about</p>
<p>  Thumbs.db..
</p></blockquote>
<p>OK I&#8217;ll do that for you.</p>
<p>Someone (I don&#8217;t know who) used Windows Explorer to take a look at a folder on a file server. &nbsp;The folder was ready to be zipped and sent off for its contents to be put into ROM on hundreds of thousands of devices. &nbsp;Well, it was, it really was, until someone used Windows Explorer to take a last look at it. &nbsp;The person didn&#8217;t notice that Windows Explorer added an unwanted thumbs.db, which almost got sent off to be put into ROM on hundreds of thousands of devices. &nbsp;Fortunately my last look came later.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480513">
				<div id="div-comment-480513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480513">
			March 9, 2007 at 1:32 am</a>		</div>

		<p>Thursday, March 08, 2007 10:25 AM by BryanK</p>
<blockquote><p>
  It was a 4G root partition because the box</p>
<p>  was upgraded from NT 4 Server (which didn&#8217;t</p>
<p>  allow a root FS larger than that)
</p></blockquote>
<p>Actually NT4 did allow a root FS larger than that, it just couldn&#8217;t create a larger one on the fly during installation. &nbsp;You could create a larger partition by using Partition Magic, or attach the drive to an existing NT4 machine, etc. &nbsp;Then tell the NT4 installer to install into the existing partition without changing it.</p>
<p>If you had a BIOS with inadequate INT13 extensions then you had to use additional trickery or you&#8217;d still get hit at the 7.8GB mark.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-480553">
				<div id="div-comment-480553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480553">
			March 9, 2007 at 8:11 am</a>		</div>

		<p>Has it ever occured to anyone that operating system should keep its important files in its own directory???</p>
<p>Current system is a mess. Protecting files by hiding them is the worst solution. I really grew up to hate desktop.ini and thumbs.db because people tend to archive them using WinZIP or WinRAR together with files they send me. Arcive utility writers had to resort to implementing workarounds for this nonsense by allowing you to specify list of files you don&#8217;t want extracted.</p>
<p>ACLs are also useless because they can be manipulated directly by the admin.</p>
<p>My point is &#8212; if it is a system file and if it is crucial for correct functioning, then only system itself should see it. Period.</p>
<p>Fortunately that is not hard to do &#8212; filesystem filter driver and a list of files and folders to be filtered out from display. If you believe that it poses security risks (rootkits) then make every change to that list visible in event log and if you decide to allow third party developers to use the feature, then also allow users to allow or deny modifications of that list.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480563">
				<div id="div-comment-480563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480563">
			March 9, 2007 at 8:19 am</a>		</div>

		<p>Oh really; that&#8217;s good to know. &nbsp;Well, maybe not &quot;good&quot;, since I&#8217;ll likely never use it, but at least &quot;interesting&quot;. &nbsp;:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-480883">
				<div id="div-comment-480883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">notimportant</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-480883">
			March 10, 2007 at 11:28 am</a>		</div>

		<p>I agree with Foolhardy. If an ntfs volume, store this stuff in a stream in the directory.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-481793">
				<div id="div-comment-481793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070305-00/?p=27763#comment-481793">
			March 13, 2007 at 6:31 pm</a>		</div>

		<p>Streams get lost when the file is archived, moved to FAT16/FAT32 volume, or burned onto a CD/DVD.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>