<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-962283">
				<div id="div-comment-962283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962283">
			January 23, 2012 at 8:23 am</a>		</div>

		<p>Once again, I see a very good reason to want to ban all shell extensions, etc. from loading into my app. It is unfair to have to debug crashes or weird behavior caused by plugins when I don&#39;t even load plugins myself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-962293">
				<div id="div-comment-962293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kyle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962293">
			January 23, 2012 at 8:36 am</a>		</div>

		<p>If the shell was designed today, would Microsoft have disallowed in-process shell extensions, only allowing out-of-process extensions? &nbsp;At least that way it would be harder for extensions to cause issues in the shell process. &nbsp;I&#39;m sure fewer available computing resources at least partially drove the decision originally, but would a different choice be made now?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-962303">
				<div id="div-comment-962303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962303">
			January 23, 2012 at 8:50 am</a>		</div>

		<p>Re the discussion about debug and checked builds at the other link: &nbsp;The term &quot;checked build&quot; is weird; it sounds like the build was checked out, whereas the non-checked build was just thrown together and not &quot;checked&quot;! &nbsp;It&#39;s too late, but maybe the &quot;checked build&quot; should have been called an &quot;assertion build&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-962333">
				<div id="div-comment-962333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962333">
			January 23, 2012 at 1:19 pm</a>		</div>

		<p>Joshua: What would your users say when the Open/Save dialogs no longer work as they expect them to? I can think of few apps where I wouldn&#39;t want care if shell extensions didn&#39;t work.</p>
<p>Kyle: If the shell was designed today, they might not realize that bad shell extensions would cause so many crashes, so they might not consider that it would be necessary. On the other hand, maybe they would have learned from IE plug-ins and put them in a different process.</p>
<p>BTW, why did they cache BSTRs to begin with? Since they&#39;re not all the same size, it seems like it wouldn&#39;t be a big win. I suppose the memory allocator overhead was more of an issue back when BSTRs were created.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-962343">
				<div id="div-comment-962343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Friday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962343">
			January 23, 2012 at 1:47 pm</a>		</div>

		<p>I used it ever since then (in fact I even forgot I had put it there) and I never saw any apparent problems. Light home usage, browsing, office apps, image processing&#8230;</p>
<p>Maybe the hardware has grown so fast it can&#39;t be noticed?</p>
<p>And I tried it in the first place because I don&#39;t want any leaks (as per Larry&#39;s article). Maybe I got it all wrong, as I said, I&#39;m not a programmer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-962353">
				<div id="div-comment-962353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962353">
			January 23, 2012 at 3:12 pm</a>		</div>

		<blockquote><p>
  What would your users say when the Open/Save dialogs no longer work as they expect them to?
</p></blockquote>
<p>I&#39;ve had to debug a really weird bug in our app where it would behave strangely after a while, but it was only reproducible on some machines. Turned out to be after calling the open / save dialogs which injected a shell plugin into the process. The shell plugin went ahead and changed the locale, creating parsing problems.</p>
<p>Duh, that was a pain to find out. I&#39;d probably still be debugging this if Raymond&#39;s psychic powers hadn&#39;t told him to queue an article about <em>exactly this</em> a little over 2 years ago.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-962363">
				<div id="div-comment-962363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962363">
			January 23, 2012 at 4:29 pm</a>		</div>

		<p>@Gabe: Let&#39;s just say I publish my app with an on/off switch for shell extensions. If someone&#39;s getting a weird crash and I&#39;m getting nowhere, I tell them to try to reproduce with the switch thrown.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-962383">
				<div id="div-comment-962383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962383">
			January 23, 2012 at 7:21 pm</a>		</div>

		<p>Jushua, I see where you&#39;re coming from, but in practice all applications would ship with the switch turned off, leaving the average user with dialogues that don&#39;t work as expected.</p>
<p>The only effective way to debug crashes (at least in experience) is to look at the address/line where the crash happens and check what&#39;s in the registers anyway, so in practice the off switch might not even be that big of a benefit.</p>
<p>It also harks back to countless talks with Q&amp;A people asking be to toggle all kind of pointless unrelated settings and to come back when the crash happens again. I think it&#39;s just a way to postpone having to deal with the problem until next week, and it also shows why the reproduction first mentality of crash debugging doesn&#39;t work for the majority of crashes, since they often happen sporadically and unpredictably.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-962393">
				<div id="div-comment-962393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962393">
			January 24, 2012 at 3:45 am</a>		</div>

		<p>All crashes can be reproduced repdictably. Just demonstrate the allegedly finished product, to senior management!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-962423">
				<div id="div-comment-962423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962423">
			January 24, 2012 at 5:44 am</a>		</div>

		<p>TC: I&#39;m afraid that the only way to get a trouble-free demo for upper management is by attempting to reproduce a crash!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-962543">
				<div id="div-comment-962543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962543">
			January 24, 2012 at 9:15 am</a>		</div>

		<p>@Gabe: I think we&#39;re on to something. Finally a way to beat murphy!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-962633">
				<div id="div-comment-962633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962633">
			January 24, 2012 at 10:47 am</a>		</div>

		<p>@Anonymous Coward: More than half of the reported crashes to me, when the problem is found, turn out to be caused by third party code that does not exist in dev or test.</p>
<p>After directly fingering a specific version of TrendMicro (perfectly reproducible crash only while that version of TrendMicro was installed), I started getting a bit touchy about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-962773">
				<div id="div-comment-962773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962773">
			January 25, 2012 at 2:15 am</a>		</div>

		<p>Joshua: I&#39;ve sometimes found irritations like that &#8211; of course, if the problem showed up in the dev environment, the code would never have gone out like that in the first place! I had a very frustrating time once, getting a BugCheck when I called NtClose. Needless to say, an AV app (not the one you mention) had hooked NtCreateFile and NtClose; their close hook seemed to be relying on some internal state being set up by their open hook, which wasn&#39;t happening in the particular way I was using it. Very irritating!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-962943">
				<div id="div-comment-962943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120123-00/?p=8483#comment-962943">
			January 25, 2012 at 6:32 pm</a>		</div>

		<p>I had bitten by 3rd party bug as well. That is related to a form that used embedded web browser control, but the user&#39;s running a PC that have IE bugged to a level that it can&#39;t be started. (This user normally used Firefox so thought it wan&#39;t a big deal, and didn&#39;t report the issue to I.T. staffs.)</p>
<p>A fresh reinstallation of Windows cured that.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>