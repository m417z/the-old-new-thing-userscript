<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (74)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-989283">
				<div id="div-comment-989283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">prunoki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989283">
			June 6, 2012 at 7:13 am</a>		</div>

		<p>I guess you know the people do not read rule?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989293">
				<div id="div-comment-989293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989293">
			June 6, 2012 at 7:16 am</a>		</div>

		<p>Isn&#39;t it the program&#39;s job to ensure the 2 subdirectory exists? &nbsp;I suppose that&#39;s somewhat tangential to your point, but if I was using the program I would have reported it as a bug. &nbsp;Then again I would have probably ran process monitor against it to see what it was actually doing and figured it out from there (error messages may or may not be accurate; process monitor logs are the word of God).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989313">
				<div id="div-comment-989313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989313">
			June 6, 2012 at 7:25 am</a>		</div>

		<p>John: For an end-user program I&#39;d say yes. But Q is described as a programmer&#39;s tool that&#39;s internal to Microsoft. It may only do one thing, and expect everything to be set up correctly for it before it&#39;s run. It&#39;s not the hammer&#39;s job to make sure there&#39;s a nail under it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989333">
				<div id="div-comment-989333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989333">
			June 6, 2012 at 7:28 am</a>		</div>

		<p>So there&#39;s no way to vote this person off the show?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989343">
				<div id="div-comment-989343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989343">
			June 6, 2012 at 7:31 am</a>		</div>

		<p>I think it&#39;s a reasonable expectation of a program that the $TEMP directory exists (and is writable). &nbsp;Sure, you could make it a little more robust by trying to CreateDirectory up from the drive root if it doesn&#39;t exist, but that can fail too, and then you&#39;re back to square one. &nbsp;If somehow $TEMP gets set to a non-existent directory, or if $TEMP gets deleted, you want programs to complain loudly as soon as possible so that the error can be corrected.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989353">
				<div id="div-comment-989353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pete.d</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989353">
			June 6, 2012 at 7:34 am</a>		</div>

		<p>Jason: even programmers have a right to be able to expect tools to comply with normal computer usage conventions. I&#39;m with John on this one.</p>
<p>In particular, one hard-and-fast rule about the %TEMP% directory is that whatever&#39;s in there can be deleted at any time. A program that wants to keep a file alive needs to keep it locked, and of course if the program is not running at all, it has no right to expect anything to stay in the %TEMP% directory.</p>
<p>If you want data to stick around, don&#39;t put it in the %TEMP% directory. And that goes for directories too. Along the same lines, if you just need a place to put new temporary files, if you want a special directory under the %TEMP% directory, be prepared to have to re-create the directory if it&#39;s not there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989363">
				<div id="div-comment-989363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pete.d</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989363">
			June 6, 2012 at 7:37 am</a>		</div>

		<p>Engywuck, Adam: except that&#39;s not the scenario in question here.</p>
<p>It&#39;s reasonable to expect that the directory referred to by %TEMP% exists. But that&#39;s &quot;C:UsersWaldoAppDataLocalTemp&quot;. The &quot;2&quot; subdirectory is the program&#39;s own addition, according to Raymond&#39;s article.</p>
<p>%TEMP% hasn&#39;t been set to a non-existent directory. The program itself is making up a directory name that it expects to find <em>within</em> the %TEMP% directory and then itself complaining that it&#39;s specially-named sub-directory doesn&#39;t exist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989373">
				<div id="div-comment-989373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">prunoki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989373">
			June 6, 2012 at 7:40 am</a>		</div>

		<p>@pete.d</p>
<p>&quot;Too bad that their TEMP environment variable still contained a reference to it.&quot; He did not delete something from %TEMP%, he deleted the directory that was %TEMP%.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-989383">
				<div id="div-comment-989383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989383">
			June 6, 2012 at 7:50 am</a>		</div>

		<p>RULE NUMBER 1 (or any small number):</p>
<p>A SANE PROGRAM SHOULD NOT EXPECT ANYTHING EXISTING (OR NOT EXISTING) IN %TEMP%. ANYTHING THERE CAN BE DELETED AT ANY TIME.</p>
<p>If the author of Q doesn&#39;t understand that, what is he doing at Microsoft at all? That&#39;s the reason we get programs that will not start under an user, because its installer created values in HKCU for the Administrator. That was a problem in one release of MS Messenger.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989393">
				<div id="div-comment-989393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Guest</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989393">
			June 6, 2012 at 7:52 am</a>		</div>

		<p>@pete.d</p>
<p>The /2/ subfolder is added to the %TEMP% variable by terminal services, read the last link.</p>
<p>@Engywuck, @Adam Rosenfield</p>
<p>Actually &quot;doing some mkdir to every part of the path&quot; is not that hard, and you dont need to &quot;trying to CreateDirectory up from the drive root if it doesn&#39;t exist&quot;, just call SHCreateDirectory or SHCreateDirectoryEx once.</p>
<p>That said, if the app dont want to modify user&#39;s system so rudely and decide to just return the error, its perfectly okay.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989403">
				<div id="div-comment-989403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">shinyhat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989403">
			June 6, 2012 at 7:53 am</a>		</div>

		<p>That&#39;s not helpless; that&#39;s hapless. Is this person responsible for removing the Start menu from Windows 8 as well? (please put it back, I have computer-literate grandparents)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989413">
				<div id="div-comment-989413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989413">
			June 6, 2012 at 8:23 am</a>		</div>

		<p>Wow. User of program Q is being an idiot and nearly half the commenters here appear to be smoking something illegal.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989423">
				<div id="div-comment-989423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989423">
			June 6, 2012 at 8:25 am</a>		</div>

		<p>&quot;deleted everything from the Temp directory, including the 2 subdirectory. Too bad that their TEMP environment variable still contained a reference to it.&quot;</p>
<p>That means %TEMP%=C:UsersWaldoAppDataLocalTemp2</p>
<p>How did everyone miss this? &nbsp;Most programs (at least mine!) assume that %TEMP% already exists.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989433">
				<div id="div-comment-989433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989433">
			June 6, 2012 at 8:39 am</a>		</div>

		<p>Bookmarked, so I can link to this later; I see this kind of attitude, obsessiveness and helplessness from people on mailing lists not infrequently.</p>
<p>@alegr1, %TEMP% is not a cache directory. If I write a program that writes to %TEMP%, closes my handle to that file, and then passes that file as an argument to another program, I have every right to anticipate that file is still there. Users and programs should not remove files they didn&#39;t create without knowing the potential impact.</p>
<p>If I shouldn&#39;t be using %TEMP% for transient objects, what&#39;s the point of it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989453">
				<div id="div-comment-989453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">feh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989453">
			June 6, 2012 at 9:04 am</a>		</div>

		<p>I heard one person say the definition of insanity is doing the same thing over and over expexting a different result.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989463">
				<div id="div-comment-989463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/paulb_4000_rochester.rr.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>paulb@rochester.rr.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989463">
			June 6, 2012 at 9:35 am</a>		</div>

		<p>Many of the people who responded failed to realise that %TEMP% is set to the subfolder. How did that happen?</p>
<p>I agree with JM, the poster was not to stupid to understand the message, just too helpless to properly ask what they were really thinking &#8211; why did it even TRY to use that path? This is evident in the quote &quot;the fact remains that I did not specify a path at all&quot;, as well as JM&#39;s quote.</p>
<p>So in summary:</p>
<ul>
<li>
<p>Something odd happened to the %TEMP% variable</p>
</li>
<li>
<p>The program should indeed act properly, regardless of who the user is, and it does</p>
</li>
<li>
<p>The poster is helpless but not stupid, Raymond went too far</p>
</li>
</ul>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989473">
				<div id="div-comment-989473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dpff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989473">
			June 6, 2012 at 9:35 am</a>		</div>

		<p>I do have a question: if you call Win32 API GetTempFileName and if the folder specified by %T(E)MP% environment variable doesn&#39;t exist, would GetTempFileName return error of path not found? My guess is yes, since it needs to enumerate the existing files in that folder to generate the unique file name to be returned, and it cannot do so if the folder doesn&#39;t exist. Then does it make sense for GetTempFileName to create the temp folder if it is not present? What harm could it introduce by doing so?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989483">
				<div id="div-comment-989483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul M. Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989483">
			June 6, 2012 at 9:49 am</a>		</div>

		<p>@dpff: Why are you guessing about what GetTempFileName does?</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa364991%28v=vs.85%29.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/aa364991%28v=vs.85%29.aspx</a></p>
<p>Though, to be honest, this is the droid you&#39;re looking for:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa364992%28v=vs.85%29.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/aa364992%28v=vs.85%29.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989503">
				<div id="div-comment-989503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/hireaphysicist_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>hireaphysicist@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989503">
			June 6, 2012 at 9:55 am</a>		</div>

		<p>A technical user doesn&#39;t necessarily mean technical in all areas. I know web devs that are ninjas with python etc. But through them a networking hiccup and they have no clue how to figure out if their system is connecting to the right DHCP server (there should only be one but funny how devs will run a network off their dev laptop at home then plug it in to a work network and wonder why everything goes wonky site wide).</p>
<p>Anyways: people have expertise a radiation oncologist isn&#39;t the right guy to go to if you have a rash. They might remember it from back in the med school days but that isn&#39;t their primary skill and what they do every day. Expecting them to remember trivia just because they learnt it once back in the day is unreasonable.</p>
<p>I think you still are right but for the wrong reason, it isn&#39;t that it was a technical user, it was that the error message said what is wrong fairly clearly and even if the user had no sense of what a temp directory is or that it is in the environment somewhere when led to the solution they should have been able to say &quot;oh that makes since. I should have remembered that&quot;. Not be utterly confused. It is like a guy in church not knowing why he can&#39;t covet his neighbors ass being shown the scripture and still saying &quot;so why can&#39;t I do that?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989533">
				<div id="div-comment-989533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989533">
			June 6, 2012 at 10:14 am</a>		</div>

		<p>I didn&#39;t realize that %TEMP% actually referenced the path with 2 in it; I assumed the program was appending the 2. &nbsp;About 99.9% of people are going to assume %TEMP% exists so I suspect the potential for this failure is quite high. &nbsp;It can still be handled programatically, of course, but I wouldn&#39;t expect it for a developer utility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989543">
				<div id="div-comment-989543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Camillo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989543">
			June 6, 2012 at 10:40 am</a>		</div>

		<p>I am mildly surprised a MS developer was not able to handle the issue. Affter years of horror stories about MS hiring interviews my expectations is that only top notch engineers work there, Raymond&#8230; any clue why?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989553">
				<div id="div-comment-989553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JohnQ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989553">
			June 6, 2012 at 10:45 am</a>		</div>

		<p>I think that this post is way too harsh. &nbsp;It seems like the user&#39;s ultimate difficulty was that the temporary folder was not named as he expected. &nbsp;(Not surprising since it was silently changed by Terminal Services.) &nbsp;He probably asssumed (as many posters here did), that the subfolder &quot;2&quot; was something the application should create. &nbsp;I think that, when you read a question, you should assume that the person is missing a piece of key information, and not that he is lazy and/or stupid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-989563">
				<div id="div-comment-989563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989563">
			June 6, 2012 at 10:48 am</a>		</div>

		<blockquote><p>
  Anyways: people have expertise a radiation oncologist isn&#39;t the right guy to go to if you have a rash.
</p></blockquote>
<p>What if the rash appears on the radiation treatment site?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-989583">
				<div id="div-comment-989583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989583">
			June 6, 2012 at 10:56 am</a>		</div>

		<p>This reminds me of the time I was reading a children&#39;s book and hit a WALDO_NOT_FOUND error.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989603">
				<div id="div-comment-989603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AECL</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989603">
			June 6, 2012 at 11:03 am</a>		</div>

		<blockquote><p>
  personality.
</p></blockquote>
<p>No worries. Just throw a therac at it. Or an Israeli Sub! Gerjunimo!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989613">
				<div id="div-comment-989613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989613">
			June 6, 2012 at 11:06 am</a>		</div>

		<p>I agree with JM and JohnQ. I&#39;ve been in a similar situation where the software (a compiler) threw an error message in my face which was 1) completely 100% correct and 2) completely unhelpful unless you already knew what the problem was.</p>
<p>It is exactly the same in this case. Unless you already happened to know what TS does to your Temp folder, the error message looks like either the tool has a bug of some sort or that because of some misconfiguration or other it&#39;s trying to access the wrong path. It should be absolutely clear why the user (programmer or not) didn&#39;t think the absence of the path was the problem.</p>
<p>(As for JM&#39;s ‘too smart for his own good’ remark, if this is the kind of tool I think it is, more often than not simply ‘satisfying the error messages’ will set you on a coarse for cataclysmic failure. I wouldn&#39;t have created the 2 folder without knowing why it should be there; past experience has taught me that road leads straight to hell.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989633">
				<div id="div-comment-989633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989633">
			June 6, 2012 at 11:28 am</a>		</div>

		<p>@Anonymous Coward: Wait a &quot;Path XYZ not Found&quot; is &quot;completely unhelpful&quot;? I mean yes, if the obvious solution (&quot;what happens when I just create the necessary path?&quot;) doesn&#39;t work, then you have a problem and yes it&#39;s not especially good designed, but I still expect a technically capable person to at least look whether the path exists and create it if not.</p>
<p>A completely unhelpful error message is something like: &quot;Could not restore data. Error 2211.&quot;. That was the windows integrated backup tool btw.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989643">
				<div id="div-comment-989643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989643">
			June 6, 2012 at 11:48 am</a>		</div>

		<p>@Jason Programmers are users too; personally I think the rules of usability are too often ignored when making stuff for programmers, be it languages, IDEs, APIs&#8230; (what, you expected g++ to print a nice, short, readable message for beginners when called without arguments? Oh you! It&#39;s a compiler, silly).</p>
<p>But yes, Waldo should have checked that folder and made sure it existed. &quot;I don&#39;t think it should matter, therefore it does not&quot; is not a good rule of thumb.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989653">
				<div id="div-comment-989653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989653">
			June 6, 2012 at 11:57 am</a>		</div>

		<p>@voo: &nbsp;obviously, the server is configured without a valid user path. &nbsp;:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989663">
				<div id="div-comment-989663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989663">
			June 6, 2012 at 12:04 pm</a>		</div>

		<p>You seem to generally dismiss the person as an incompetent fool. &nbsp;(which is somewhat warranted, given the story).</p>
<p>However, I&#39;d remind you that even the most brilliant people (in any field), have bad days and occasionally make dumb mistakes.</p>
<p>Maybe he just hadn&#39;t had his coffee yet after his car had a flat tire and his GF dumped him?</p>
<p>In those circumstances, I understand why he might blame the tool and its error message.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989683">
				<div id="div-comment-989683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dpff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989683">
			June 6, 2012 at 12:11 pm</a>		</div>

		<p>@Paul M. Parks: just tried, if GetTempFileName was called with non-exist folder passed as first parameter, it will fail with error code 267 (The directory name is invalid), not 2 (did Raymond use &quot;2&quot; as folder name in his example?).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989693">
				<div id="div-comment-989693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul M. Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989693">
			June 6, 2012 at 12:25 pm</a>		</div>

		<p>@dpff: The point of my response was that the documentation for GetTempFileName would lead you to GetTempPath, and the documentation for that function would tell you everything you needed to know. GetTempFileName would also lead you to a sample application that demonstrates the typical usage pattern, which is calling GetTempPath to, uh, get the temp path, and then passing that path to GetTempFileName. Of course, the documentation and the sample both point out that there is no guarantee that the temp path exists.</p>
<p>From your first comment:</p>
<p>&quot;My guess is yes, since it needs to enumerate the existing files in that folder to generate the unique file name to be returned, and it cannot do so if the folder doesn&#39;t exist.&quot;</p>
<p>This is the guess I balked at.</p>
<p>&quot;Then does it make sense for GetTempFileName to create the temp folder if it is not present? What harm could it introduce by doing so?&quot;</p>
<p>Tremendous harm. Think about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989703">
				<div id="div-comment-989703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chentiangemalc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989703">
			June 6, 2012 at 12:54 pm</a>		</div>

		<p>The end user is idiot. Blows my mind people here defending this stupidity. Failures of the programmer has nothing to do with ignoring obvious error messages. Yes program should handle this scenario. Yes technical user should get &amp; fix this error, bad program or not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989713">
				<div id="div-comment-989713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989713">
			June 6, 2012 at 12:56 pm</a>		</div>

		<p>@Mike M</p>
<p>I consider every file in %TEMP% to be fair game when it comes to deleting. If a program does not want it deleted, it should keep it open without deletion rights.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-989723">
				<div id="div-comment-989723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989723">
			June 6, 2012 at 1:44 pm</a>		</div>

		<p>GetTempFileName does not know about %TEMP%. &nbsp;It just creates a file in whatever folder you tell it to.</p>
<p>The problem was not that the user deleted everything in %TEMP%. &nbsp;That would have been fine. &nbsp;The problem was that the user deleted everything in %TEMP%..</p>
<p>In particular, the user rmdir&#39;d %TEMP% itself.</p>
<p>Well, actually, we don&#39;t know that the user did this; we just know that %TEMP% pointed to a folder that didn&#39;t exist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989323">
				<div id="div-comment-989323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989323">
			June 6, 2012 at 7:28 am</a>		</div>

		<p>@John: so say you have some Environment Variable TEMP=C:UsersWaldoAppDataLocalTemp2 (however the 2 got at the end). Your program does some &quot;open %TEMP%t144t4.tmp&quot;. Do you *really* want every programmer to dereference all variables and doing some mkdir to every part of the path? What if the path was intended to be on a separate drive, mounted into the NTFS namespace? (yes, that&#39;s possible). </p>
<p>The program does what&#39;s best: let the user decide *why* there&#39;s a &quot;path not found&quot;. How should it know? (Assuming, of course, the program itself didn&#39;t delete the folder previously :-))</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989733">
				<div id="div-comment-989733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989733">
			June 6, 2012 at 3:10 pm</a>		</div>

		<p>This whole issue could have been handled in a few seconds, like this: &quot;Hey Internal Programmer User of Q, just try to navigate to C:UsersWaldoAppDataLocalTemp and create the folder &#39;2&#39; if it doesn&#39;t exist. Yours, &#8230;&quot;</p>
<p>Instead, there are several arrogant messages going back and forth, PLUS a blog post etc.</p>
<p>What a waste of time just to make a helpless person feel stupid, which does not help anybody.</p>
<p>This is what makes the world such a sad place.</p>
<div class="post">[<i>Here, have a fish. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989443">
				<div id="div-comment-989443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989443">
			June 6, 2012 at 8:53 am</a>		</div>

		<p>The person Raymond is castigating was stupid for not realizing the program was talking about the %TEMP% directory, and that programs have a habit of using the %TEMP% directory. That&#39;s all. Everyone (including Raymond) who is pretending the user was so dim they didn&#39;t understand the *semantics* of the error message is being disingenuous at best and deliberately mean at worst.</p>
<p>The user didn&#39;t understand that the program was accessing %TEMP%. That&#39;s all. You can see this thought process in action when they say &quot;I could try to navigate to that path in Windows Explorer, but I doubt that this has anything to do with resolving the problem&quot; &#8212; in other words, they didn&#39;t know *why* the program was using this particular path and not some other. This is stupid, but it doesn&#39;t seem to be the kind of stupid people are falling over.</p>
<p>If the user had been Pragmatic Stupid, they would have created the directory the program was asking for without understanding why, and everything would have just worked. But the user was Programmer Stupid, and programmers first want to understand why things aren&#39;t working as they expect them to. This can be a real damper on your productivity if you&#39;re too stupid to actually do that, so I guess we could call this kind of stupid too smart for its own good.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989753">
				<div id="div-comment-989753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989753">
			June 6, 2012 at 4:00 pm</a>		</div>

		<p>@Samir Talwar: follow the links in the blog entry and your question will be answered.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989763">
				<div id="div-comment-989763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Samir Talwar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989763">
			June 6, 2012 at 4:05 pm</a>		</div>

		<p>@JamesJohnston: Aha. Thank you very much. I blame Google Reader for aiding me in missing those particular links. It&#39;s probably not its fault, but I&#39;m blaming it anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989773">
				<div id="div-comment-989773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989773">
			June 6, 2012 at 4:14 pm</a>		</div>

		<p>@Samir Talwar</p>
<p>No, this is Terminal Services at work. When you log in over remote desktop, Windows will set the temp directory for the logon session to %LOCALAPPDATA%Temp&lt;session id&gt;, this is to avoid the possibility that the same user account could log in twice in different sessions. I&#39;m not entirely sure, but I think Windows creates that directory when it logs on too. In order to get this kind of error, the user had to have gone to the %LOCALAPPDATA%Temp directory, deleted everything in there themselves and then tried to run the program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989783">
				<div id="div-comment-989783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989783">
			June 6, 2012 at 4:40 pm</a>		</div>

		<p>So just to clarify: you feel winlogon.exe (or whichever Windows process does the Term Server temp magic) should hold %TEMP% open without deletion rights?</p>
<p>Because the missing folder was not in %TEMP%, but rather WAS %TEMP%.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989793">
				<div id="div-comment-989793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989793">
			June 6, 2012 at 5:03 pm</a>		</div>

		<p>@Daniel</p>
<p>Thank you. I was feeling a bit flat this morning, and your post has invoked enough rage to get me through to lunch at least!</p>
<p>Waldo: Too stupid to breath, needs someone to push back and say &quot;Use your brain idiot&quot;.</p>
<p>Daniel: Defending the living vegetable. Reconfirming the world is full of idiots.</p>
<p>You know what? It&#39;s good to feel stupid from time to time; it makes you think hard before asking for help next time. Technical people should be capable of problem solving. If you can&#39;t solve this puzzle, you should consider another line of work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008794c744 odd alt thread-odd thread-alt depth-1" id="comment-989523">
				<div id="div-comment-989523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Wisefaq' rel='external nofollow' class='url'>Wisefaq</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989523">
			June 6, 2012 at 10:13 am</a>		</div>

		<p>My employer has a logon script, which amongst other things, to check for the validity of the TEMP &amp; TMP variables.</p>
<p>In the past,</p>
<p>a) users* will do silly things, such as incorrectly set TEMP/TMP variables, which</p>
<p>b) breaks some third party applications.</p>
<p>* when I say users, I really mean that some third party program installs have done this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989803">
				<div id="div-comment-989803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989803">
			June 6, 2012 at 5:17 pm</a>		</div>

		<p>Somewhere deep inside Microsoft someone is planning their revenge!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989823">
				<div id="div-comment-989823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989823">
			June 6, 2012 at 6:40 pm</a>		</div>

		<p>@steveg: Preferably with kinetic rods.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989673">
				<div id="div-comment-989673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul M. Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989673">
			June 6, 2012 at 12:10 pm</a>		</div>

		<p>So many comments seem to miss (or simply ignore) the fact that this is not only a programmer&#39;s tool, but an *internal* programmer&#39;s tool. The quality bar for such tools is usually quite a bit lower than a publicly available product like, say, g++.</p>
<p>I write a lot of internal tools, and I rarely spend any time making them bulletproof. They&#39;re targeted at developers on the teams I work with who have access to the tool&#39;s source code. My knee-jerk response to developers that seek &quot;support&quot; on these tools is, &quot;I dunno; run it in a debugger and see what&#39;s happening.&quot; After all, that&#39;s what I would do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-989843">
				<div id="div-comment-989843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989843">
			June 6, 2012 at 7:50 pm</a>		</div>

		<p>It&#39;s true that every program should assume the files and folders in TEMP is deletable, but any sane person who want to clean TEMP folder do so by &quot;disk cleaner&quot; or by &quot;delete when logging in as another user&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989853">
				<div id="div-comment-989853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989853">
			June 6, 2012 at 10:34 pm</a>		</div>

		<p>[Here, have a fish. -Raymond] &lt;&#8211; Epic!</p>
<p>If any of the internal tools I made goes &#39;boom&#39; and someone ask me about it, I generally tell them to not use it for that scenario anymore until I get a chance to fix it.</p>
<p>In this case however, it&#39;s almost like someone removing the &#39;Windows&#39; directory, and then complaining windows doesn&#39;t work anymore. Don&#39;t delete system paths!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989743">
				<div id="div-comment-989743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Samir Talwar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989743">
			June 6, 2012 at 3:53 pm</a>		</div>

		<p>I would love to know how the %TEMP% directory got set to that location (including the &quot;2&quot;). Was it a third-party application, an internal tool or the user himself? If it was either of the first two, I *really* want to know why. Partially so I can keep those programs the hell away from my machine (I&#39;d like it to work normally), but also because I want to know what possible reason anyone could have for changing the temporary directory location.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-989863">
				<div id="div-comment-989863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989863">
			June 6, 2012 at 11:12 pm</a>		</div>

		<p>Btw, few people even notice that %temp%&lt;number&gt; folder will be created by TS when login remotely. (<a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/243555" rel="nofollow">support.microsoft.com/&#8230;/243555</a>)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989873">
				<div id="div-comment-989873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989873">
			June 7, 2012 at 12:54 am</a>		</div>

		<p>Ben,</p>
<blockquote><p>
  Reconfirming the world is full of idiots.
</p></blockquote>
<p>it actually is. For the intelligent, it&#39;s up to them how to deal with the idiots. If you want to rage, do so. We idiots won&#39;t care, I&#39;m telling you. Sometimes I go to an intelligent person I do not depend on, ask a stupid question and see them rage, just for fun.</p>
<blockquote><p>
  it makes you think hard before asking for help next time
</p></blockquote>
<p>I see, so the effort with the sarcastic e-mails and the blog post is an investment in the future to defeat idiocy or at least keep it at a distance.</p>
<p>Maybe you&#39;re right about that. I keep my fingers crossed for the intelligent that it pays off.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989813">
				<div id="div-comment-989813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989813">
			June 6, 2012 at 6:26 pm</a>		</div>

		<p>Voo: the error message *is* unhelpful, because unless you already know what the problem is (TS creates numbered Temp folders and one of them got deleted) the message looks like it&#39;s accessing the wrong path and provides no clue as to why or how to go about solving the problem.</p>
<p>The problem with people like you or Malcolm McCaffery is that every time someone else has a problem he&#39;s obviously an idiot, but if you have the problem the tool is unhelpful. I&#39;ve met your clones many many times in real life. I&#39;d ask you to pretend you didn&#39;t read the snarky blog post and imagine you were sitting at there with just that error, but I know that your kind is physically incapable of putting themselves in someone else&#39;s shoes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989833">
				<div id="div-comment-989833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989833">
			June 6, 2012 at 6:46 pm</a>		</div>

		<p>@Anonymous Coward: You really don&#39;t see the difference between a non-descriptive error code and a well phrased error message? Really? </p>
<p>Yes after you&#39;ve tested whether creating a new folder resolves the problem, you can start investigating why the program wanted that specific folder and that&#39;s probably more work (well it&#39;d more finding out why the TEMP path was set to such a strange value &#8211; googling would&#39;ve answered that one though). But for attempting to solve the problem at hand you really don&#39;t have to know *why* it is accessing that folder. &nbsp;</p>
<p>Yes I know not everybody can easily put themselves into the shoes of a person who doesn&#39;t want to use their brain before taking the easy way out and asking others for help. A horrible fault that denies the world another 100 SO questions every day about why str1 == &quot;foo&quot; doesn&#39;t work correctly in Java and similar things &#8211; I&#39;m inconsolable. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989883">
				<div id="div-comment-989883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989883">
			June 7, 2012 at 3:42 am</a>		</div>

		<p>@Raphael: Will that even work? I always thought deleting a folder with an open handle resulted in a zombie.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989893">
				<div id="div-comment-989893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Someone else</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989893">
			June 7, 2012 at 6:05 am</a>		</div>

		<p>@Ben</p>
<p>The user should have looked for that path, yes. And it&#39;s true that it&#39;s better to make people learn than to just give them the &quot;magical instructions&quot;. But you are definitely more idiot than him (&quot;idiot&quot; is allowed in this blog, right?).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-989923">
				<div id="div-comment-989923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989923">
			June 7, 2012 at 7:21 am</a>		</div>

		<p>Winlogon.exe needs to keep a handle to the user&#39;s %TEMP% folder, and possibly a few other such folders, to prevent this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-989933">
				<div id="div-comment-989933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989933">
			June 7, 2012 at 7:35 am</a>		</div>

		<p>@Raphael: And what of passing the file to a program that opens its arguments with exclusive permissions? (A terrible number of these programs exist&#8230;)</p>
<p>Reading further, though, it would seem The Thing To Do would be to create a folder in %TEMP%, keep an open handle of that folder, and then place my temporary file in there.</p>
<p>Of course, you&#39;d still find the files in the subfolder to be fair game, wouldn&#39;t you?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989993">
				<div id="div-comment-989993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Programmerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-989993">
			June 7, 2012 at 8:48 am</a>		</div>

		<p>If we&#39;re trying to teach the user, the appropriate next message in the chain here is &quot;C:UsersWaldoAppDataLocalTemp isn&#39;t the temp folder mentioned, C:UsersWaldoAppDataLocalTemp2 is.&quot; They made an assumption that is wrong, correct their assumption.</p>
<p>Keep in mind, this is peer support, not user support. You&#39;re trying to help them solve their own problems, not solve their problems for them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990013">
				<div id="div-comment-990013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random User 437029</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990013">
			June 7, 2012 at 8:55 am</a>		</div>

		<p>Sometimes I wonder if X years ago, someone invented an amazingly successful bot, designed specifically to scan blog comments and randomly select, and re-post comments into the exact same article, with optional rephrasing. Then I remember that most people (apparently) comment on articles before (optionally) reading the comments.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990023">
				<div id="div-comment-990023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990023">
			June 7, 2012 at 9:13 am</a>		</div>

		<p>I think at least part of the point that Raymond was trying to make and that seems to be lost on some is that the user most likely did not even attempt to troubleshoot in even the smallest degree and that&rsquo;s what upset him more than the user not being a computer expert. It was just a gut reaction of error message email developer. As an internal tool this isn&#39;t John Q. Public, it&rsquo;s someone who works for MS, now they may not be a developer but I would hope that had at least a basic understanding of computers and windows to be able to get going down the right tract of troubleshooting. The error message tells them right there what the problem is path not found and what path it is looking at. In the reply the user even states that they reluctantly (as if it was a huge burden for them to do) browsed all the way to TEMP but it was empty as in no 2 folder. Again after exerting the minimal effort possible the shut their brains off and pushed the problem on to someone else. If they had put any effort into it there next question might have been hmm /2 that&rsquo;s an odd path I wonder why it&rsquo;s using that and they could have easily goog&hellip; emm, binged for the answer. They could have at least tried creating a /2 folder to see what happened but they just wanted someone to do it all for them.</p>
<div class="post">[<i>Not even &quot;Gosh what&#39;s this 2?&quot; It&#39;s like &quot;The error message says the path can&#39;t be found. The path is BlahblahTemp2. But BlahblahTemp is just fine!&quot; Yeah, but BlahblahTemp isn&#39;t what the error message was complaining about. It&#39;s like saying, &quot;You told me the book is not available in the library. But the library is right there!&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990043">
				<div id="div-comment-990043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990043">
			June 7, 2012 at 10:09 am</a>		</div>

		<p>If Terminal Services gave its $TEMP subfolder a more meaningful name such as &quot;TSTemp&lt;number&gt;&quot; instead of just &quot;&lt;number&gt;&quot;, people would be less confused and more likely to be able to figure this out on their own. &nbsp;&quot;TSTemp2&quot; is a much more eyebrow-raising name that&#39;s easier to search for online, whereas &quot;2&quot; is opaque enough that most people would just ignore it rather than try to search for it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990093">
				<div id="div-comment-990093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ts bug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990093">
			June 7, 2012 at 2:37 pm</a>		</div>

		<p>I still think it&#39;s a design bug in terminal server. There&#39;s no need for TS to redirect the temp dir.</p>
<div class="post">[<i>It most likely had to be done for app compat. This isn&#39;t the sort of thing you do for no reason. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990153">
				<div id="div-comment-990153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CodesInChaos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990153">
			June 7, 2012 at 6:42 pm</a>		</div>

		<p>I admit that I&#39;m not sure if I would have solved the issue. %TEMP% pointing to <code>C:UsersWaldoAppDataLocalTemp2</code> instead of <code>C:UsersWaldoAppDataLocalTemp</code> is certainly surprising for me. Probably I would have printed %TEMP% after some time, and learned that it isn&#39;t the program that&#39;s weird, but that it&#39;s windows that&#39;s weird. And even that doesn&#39;t tell you why %TEMP% points there. Sure it makes sense once you know what&#39;s causing it(prevent concurrent sessions from interfering or something like that), but figuring it out if you don&#39;t know isn&#39;t that obvious IMO.</p>
<p>Obviously I could have created the <code>2</code> directory to make the error go away. But that&#39;s not solving the actual problem, that&#39;s just curing the symptoms without understanding the cause.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990163">
				<div id="div-comment-990163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990163">
			June 7, 2012 at 8:31 pm</a>		</div>

		<p>CodesInChaos: The problem is that the &quot;2&quot; directory was deleted. How is creating it not solving the problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990173">
				<div id="div-comment-990173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990173">
			June 7, 2012 at 10:56 pm</a>		</div>

		<p>Terminal server creates the numbered temp folder each time you log in.</p>
<p>Try: Log off, Log on. Fixed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990183">
				<div id="div-comment-990183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Hagan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990183">
			June 8, 2012 at 1:51 am</a>		</div>

		<p>You *could* just insist that the OS creates TEMP when necessary. That would work. Right up to the day when I maliciously:</p>
<p> &nbsp; set TEMP=Q:DriveNotFound</p>
<p>So&#8230; since you can&#39;t fix the problem *reliably*, programs have to cope with this error anyway and if they have to cope with the error, why not just let it happen when someone naively blows away their own TEMP directory.</p>
<p>Bear in mind also that in this case Terminal Services *did* create the TEMP directory. The user must have blown it away after logging in.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990283">
				<div id="div-comment-990283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990283">
			June 8, 2012 at 12:24 pm</a>		</div>

		<p>No, Raymond, your analogy doesn&#39;t hold water.</p>
<p>The point is that the error message prima facie doesn&#39;t help in diagnosing the cause of the problem. It&#39;s like when you ask someone to repair your bicycle and he comes back the next day saying that he cannot find the book &lsquo;On Gnomes and Kobolts&rsquo; in the library.</p>
<div class="post">[<i>I&#39;m assuming that if a developer gets the error message &quot;path not found trying to access file X&quot;, they should know to check whether the path to file X can be found. Saying &quot;I checked the path to Y, and it&#39;s good&quot; is missing the point of the error message. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990333">
				<div id="div-comment-990333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990333">
			June 8, 2012 at 2:36 pm</a>		</div>

		<p>Raymond, don&#39;t be obtuse. It&#39;s obvious to everyone here that the path mentioned couldn&#39;t be found. But that is not the issue. As the user said, it looks like the tool was accessing the wrong path or maybe hit on a configuration problem or something, and the (in)accessibility of the path seems irrelevant. Unless you already knew what the problem was, the error message was no help.</p>
<p>If the bicycle repair man complained he couldn&#39;t find &lsquo;On Gnomes and Kobolts&rsquo; your first reaction would be to look for a different repair man, or if he&#39;s the only one in town, talk to his friends and family and maybe the local shrink.</p>
<div class="post">[<i>If the error message is &quot;path not found&quot; and you think the path is the wrong path, then the question you should ask is &quot;Where did this bogus path come from, and how do I get the program to use a valid one?&quot; Not &quot;I got an error. Wha?&quot; At least try some basic troubleshooting first. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-990353">
				<div id="div-comment-990353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990353">
			June 8, 2012 at 6:26 pm</a>		</div>

		<p>*Kobolds</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990403">
				<div id="div-comment-990403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990403">
			June 9, 2012 at 4:15 am</a>		</div>

		<p>I think for this one Raymond has all bases covered because it is an (1)internal (2)programmer&#39;s tool (3)at Microsoft.</p>
<p>So one cannot really nitpick about how the wording of the error message is misleading :(</p>
<p>Still,</p>
<p>Raymond&gt; I also find it astonishing that the person thinks that verifying whether the path can be found is totally unrelated to resolving a &quot;Path not found&quot; error.</p>
<p>Raymond&gt; &#8230;first we have a &quot;Path not found&quot; error, and there is a fully-qualified file name whose path couldn&#39;t be found. First thing to check is whether the path really exists.</p>
<p>Why?</p>
<p>The program says the system cannot find the path&#8230; Why would you (as the user) verify anything further? Of course the path does not exist, you don&#39;t need to verify it. If it did, the system would have found it! Don&#39;t you have any faith in the system?</p>
<p>Alternatively, if the program was in error, displaying an unrelated/incorrect error message, then again verifying that will only help finding out this. Then what? Will it help resolving the issue, or just make you label the issue as un-resolvable.</p>
<p>Verifying the path would not have helped (Waldo) resolving the issue. It would have helped the author of the program, it could have helped resolving a bug in Windows where it cannot find a path which did exist. It would be a waste of time for Waldo, he should have assumed the path did not exist right away&#8230;</p>
<div class="post">[<i>Verifying the error message is an important first step. Otherwise you may&nbsp;end up running in the wrong direction. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990423">
				<div id="div-comment-990423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ts bug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990423">
			June 9, 2012 at 7:10 am</a>		</div>

		<p>@Raymond: [It most likely had to be done for app compat. This isn&#39;t the sort of thing you do for no reason. -Raymond]</p>
<p>Most probably NOT for any technical reason, no.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990473">
				<div id="div-comment-990473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990473">
			June 10, 2012 at 11:06 pm</a>		</div>

		<p>@Ken Hagan: Bonus points for calling &quot;net use Q: \notexistinguncpath&quot; beforehand in a non-WINS-Environment :-)</p>
<p>Or, in the bad ol&#39; times, using set TEMP=C:CONCON for nice unexpected (for the end user) results. Even saw that path once upon a time in an img-Tag in a web page&#8230; :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990513">
				<div id="div-comment-990513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120606-00/?p=7443#comment-990513">
			June 11, 2012 at 5:33 am</a>		</div>

		<p>[Here, have a fish. -Raymond]</p>
<p>Took me a few seconds, but that one was truly, as Drak put it, epic :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>