<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-948323">
				<div id="div-comment-948323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">I dont wanna give my name</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948323">
			November 18, 2011 at 9:29 am</a>		</div>

		<p>I don&#39;t know why, but the demolition analogy made me crack up. &nbsp;Perhaps because it&#39;s so fitting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948343">
				<div id="div-comment-948343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948343">
			November 18, 2011 at 11:16 am</a>		</div>

		<p>I&#39;ve a habit of writing my code TerminateProcess() safe, so I&#39;d be rather unphased by somebody doing this to my code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948353">
				<div id="div-comment-948353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timothy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948353">
			November 18, 2011 at 11:28 am</a>		</div>

		<p>Joshua &#8211; would you please elaborate or provide a link on being TerminateProcess() safe?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948363">
				<div id="div-comment-948363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">InYourSpaceShipStealingYourGravity</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948363">
			November 18, 2011 at 11:46 am</a>		</div>

		<p>@Timothy: I really doubt that Joshua is writing code that is TerminateProcess() safe, although I&#39;m sure he thinks he does, I&#39;d wager that his customers could prove him wrong with enough time with his application.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948383">
				<div id="div-comment-948383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948383">
			November 18, 2011 at 12:13 pm</a>		</div>

		<p>Ahh, IWeb­Browser2. &nbsp;Such an amazingly full and complete interface around a complex object. &nbsp;Very useful in so many instances. &nbsp;But so full of edge cases (depending in part on the version of IE installed) without viable workarounds or solutions that it&#39;s almost infeasible for real production applications.</p>
<p>Granted, it&#39;s much, much better now than it was about 4-5 years ago.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948373">
				<div id="div-comment-948373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948373">
			November 18, 2011 at 11:54 am</a>		</div>

		<p>@Timothy: Easy. You paste over the first few bytes of TerminateProcess with a jmp to a stub function that creates a new event and waits for it.*</p>
<p>Your plugin and the hosted webpage can communicate back to the host, so you don&#39;t necessarily have to wait an arbitrary five seconds. You can also do your tests and signal the host that you want to quit. (I&#39;m sure Raymond knows this, but I thought it was worth pointing out.)</p>
<p>* That was tongue in cheek. The only reasonable way I know to guard against foreign code calling TerminateProcess is to make sure it runs in a separate process.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948403">
				<div id="div-comment-948403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948403">
			November 19, 2011 at 2:15 am</a>		</div>

		<p>@Nick: it&#39;s like any interface: if it has behaviour you don&#39;t like, you have to identify and code around that. I&#39;ve written a wrapper later accordingly. Now I can use that layer to automate IE from script, with few if any nasty surprises!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948433">
				<div id="div-comment-948433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948433">
			November 20, 2011 at 3:29 am</a>		</div>

		<p>I was instantly reminded of the incident where a demolition crane operator was asked &quot;why did you just demolish #20?&quot; &quot;Because I have a work order here to demolish &#8230; uh &#8230; #21&#8230; whoops.&quot;</p>
<p>Then there was the computer equivalent, in which our servers+storage team tried to improve lousy mail server performance by installing a new mail server &#8230; which reformatted the chunk of SAN which held the entire Medical School&#39;s existing mail server. Apparently &quot;it&#39;s OK, we can reinstall from the tape backup from 3 days ago sometime tomorrow&quot; wasn&#39;t enough to get them off the hook, either.</p>
<p>The house analogy also reminded me of a phone call on TV from someone&#39;s houseguest, with running water in the background: &quot;uhh, where&#39;s the water shutoff valve in your house?&quot; In the vein of some of the &#39;local problem, global solution&#39; tales Raymond has shared, I can imagine a lot of these people using the main water shutoff to get their kids/siblings/guests out of the bathroom faster&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948463">
				<div id="div-comment-948463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">IWeb&#173;Browser2 != IE</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948463">
			November 21, 2011 at 5:23 am</a>		</div>

		<p>If you test with IWeb­Browser2 you doesn&#39;t test with IE, you test with IWeb­Browser2.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948523">
				<div id="div-comment-948523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948523">
			November 21, 2011 at 8:09 am</a>		</div>

		<p>@Timothy: Transactional storage. If the filesystem APIs behave as advertised I&#39;m good.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948643">
				<div id="div-comment-948643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111118-00/?p=9083#comment-948643">
			November 21, 2011 at 8:10 pm</a>		</div>

		<blockquote><p>
  If you test with IWebBrowser2 you don&#39;t test with IE, you test with IWebBrowser2.
</p></blockquote>
<p>set ie = CreateObject (&quot;Internetexplorer.Application&quot;)</p>
<p>msgbox typename (ie) &nbsp;&#39; &quot;IWebBrowser2&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>