<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (23)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-996393">
				<div id="div-comment-996393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996393">
			July 5, 2012 at 8:07 am</a>		</div>

		<p>I&#39;ve had to do a similar thing (not this exact thing) before. Yes, the what if is immediately obvious to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996403">
				<div id="div-comment-996403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996403">
			July 5, 2012 at 8:14 am</a>		</div>

		<p>A program I worked on changed the global menu colors so their popup menu colors matched the rest of the application color scheme. The solution I found to fix it was owner-draw menus; there seems to be no other way of changing popup menu colors locally. But implementing owner-draw popup menus on the high-level language used by the application is hard (luckly, I am a low-level programmer, so low-level stuff like that does not scare me as much).</p>
<p>I can see why the original programmer went with the global solution (probably copy-pasted from some programming forum); it &quot;works&quot; as long as you do not notice the menu colors on other applications become slightly wrong, and it is a couple of lines of simple code instead of several hundred lines of low-level GDI drawing code.</p>
<p>(To make things even more interesting, a later version of the high-level language &quot;eats&quot; one of the messages needed for owner-draw menus, so I had to temporarily subclass the window to renumber the message before it gets to my menu-drawing code. The fun of programming for Win32&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996423">
				<div id="div-comment-996423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996423">
			July 5, 2012 at 8:31 am</a>		</div>

		<p>Of course, you could simply not have an application colour scheme to begin with. If the standard menu colours don&#39;t fit with the application, chances are the application doesn&#39;t fit with the user-selected theme.</p>
<p>The only situation where an application colour scheme makes sense is in a public terminal type setting (ATM, museum info panel, &#8230;) but then there&#39;s no reason not to change the system colours.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996433">
				<div id="div-comment-996433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996433">
			July 5, 2012 at 9:24 am</a>		</div>

		<p>It seems like your problem is writing bad code that uses bad libraries, rather than Win32&#39;s fault.</p>
<p>Programming in Swing if you&#39;re several abstractions away from the drawing libraries where the abstraction deliberately trips you up would be just as hard to resolve. But that&#39;s not Java&#39;s fault either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996443">
				<div id="div-comment-996443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996443">
			July 5, 2012 at 9:50 am</a>		</div>

		<p>It was not my code; I inherited it. Not my choice its color scheme, or its unportable high-level language. But I was not going to leave it trampling global state.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996453">
				<div id="div-comment-996453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996453">
			July 5, 2012 at 10:41 am</a>		</div>

		<blockquote><p>
  Not my choice
</p></blockquote>
<p>Yeah, been there. Just because they know how to push numbers around on paper, they think they&#39;re the final authority on everything computer related. The only hope we have is that someday we can say: look &#8211; we wasted this many man hours on doing something non-standard and unproductive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-996463">
				<div id="div-comment-996463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996463">
			July 5, 2012 at 11:58 am</a>		</div>

		<p>Override WM_GETMINMAXINFO, my young padawan, to get the fullscreen.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996473">
				<div id="div-comment-996473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dsmtoday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996473">
			July 5, 2012 at 12:59 pm</a>		</div>

		<p>ITaskbarList2::MarkFullscreenWindow</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb774640%28v=vs.85%29.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/bb774640%28v=vs.85%29.aspx</a></p>
<p>rock-solid reliable and available in WinXP</p>
<p>works for applications that have to be fullscreen across multiple monitors</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996493">
				<div id="div-comment-996493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996493">
			July 5, 2012 at 2:46 pm</a>		</div>

		<p>A concrete class whose name starting with &quot;I&quot;? Sigh, Windows&#39; COM implementation goes against all sane OO conventions. Please purge COM from Windows ASAP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-996503">
				<div id="div-comment-996503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996503">
			July 5, 2012 at 3:12 pm</a>		</div>

		<p>@640K:</p>
<p>I think you don&#39;t understand interfaces. Go read a book, or something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996513">
				<div id="div-comment-996513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Yates</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996513">
			July 5, 2012 at 6:38 pm</a>		</div>

		<p>@alegr1 is right. &nbsp;There&#39;s a COM CLASS &#8211; CLSID_TaskbarList &#8211; which implements a couple of interfaces. &nbsp;ITaskbarList and ITaskbarList2 (the only method on #2 is the one @dsmtoday pointed out). &nbsp;It was easy to discover &#8211; look in MSDN for ITaskbarList2 and see that it&#39;s under a topic group about shell Interfaces and follow your nose from there. &nbsp;The &quot;Understanding the Taskbar&quot; topic at <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc144179(v=vs.85).aspx" rel="nofollow">msdn.microsoft.com/&#8230;/cc144179(v=vs.85).aspx</a> has a lot of nice information.</p>
<p>I wasn&#39;t aware of that particular interface myself &#8211; always good to read and learn from the comments :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996523">
				<div id="div-comment-996523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996523">
			July 5, 2012 at 6:56 pm</a>		</div>

		<p>@640K: COM has the unique property in that interfaces have a method in many cases to request an implementation to be instantiated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-996543">
				<div id="div-comment-996543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996543">
			July 5, 2012 at 7:48 pm</a>		</div>

		<p>At some point, I wonder whether Windows should introduce a &quot;This is a support tool&quot; flag that, if not be set, all global setting written by this program will be saved into virtualized space that applies to that program only (or just ignore it if no equivalent local setting is available). This should have made most &quot;unintentional&quot; case of &quot;using global solution to solve local problem&quot; go away.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996533">
				<div id="div-comment-996533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996533">
			July 5, 2012 at 7:09 pm</a>		</div>

		<p>OK, so riddle me this.</p>
<p>for the last decade, Auto-Hide has not worked correctly. Even if the taskbar *is set to audohide*, sometimes it stops doing it, for absolutely no reason. No pending notifications, no task tray attention needed. &nbsp;The fix is to go in and *unset* and *reset* autohide. &nbsp;This has been a known issue&#8230; oh&#8230; forever.</p>
<p>So, given that autohide is inherently buggy, and that the API is exposed, why are you surprised that folks took advantage of it?</p>
<p>And more, what&#39;s your moral high ground here, if the setting is already frequently ignored by Windows?</p>
<p>*grabs a beer and sits back*</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996563">
				<div id="div-comment-996563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kermi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996563">
			July 6, 2012 at 3:14 am</a>		</div>

		<p>@Bron</p>
<p>I&#39;ve noticed the same exact thing, and it&#39;s annoying as hell. I&#39;ve yet to find anyone alive who would&#39;ve been able to explain this to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996573">
				<div id="div-comment-996573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996573">
			July 6, 2012 at 5:53 am</a>		</div>

		<p>@cheong00</p>
<p>Then everyone would just set the &quot;this is a support tool&quot; flag and keep using global solutions. What is your definition of unintentional the programmer may not have intended to mess up the users auto hide preference but they certainly intended to check the auto hide box.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996673">
				<div id="div-comment-996673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Bron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996673">
			July 6, 2012 at 10:49 am</a>		</div>

		<p>&quot;So, given that autohide is inherently buggy, and that the API is exposed, why are you surprised that folks took advantage of it?&quot;</p>
<p>I think you&#39;re getting confused between cause and effect:</p>
<p>The autohide appears to be inherently buggy BECAUSE folks take advantage of the exposed API.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996683">
				<div id="div-comment-996683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@cheong00</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996683">
			July 6, 2012 at 10:50 am</a>		</div>

		<p>Oh &#8211; why doesn&#39;t my app properly work? Oh it&#39;s because you need to put on the &quot;my app is awesome flag&quot;. OK. I&#39;ve put it on and now everything works. Isn&#39;t Microsoft silly for having these hoops for me to jump through?</p>
<div class="post">[<i>Yup. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/10/06/8969399.aspx" rel="nofollow">Eventually, nothing is special any more</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996803">
				<div id="div-comment-996803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996803">
			July 6, 2012 at 5:38 pm</a>		</div>

		<p>About WoW, doesn&#39;t Blizzard not like it when you use third party tools with the client? Wouldn&#39;t any testing get your account banned?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-996863">
				<div id="div-comment-996863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996863">
			July 8, 2012 at 7:43 pm</a>		</div>

		<p>@Both @cheong00: I think for this case, the developer does not mean to change a global setting. Maybe they just ask &quot;How to auto-hide taskbar?&quot; on a forum and people enthusiastically show them how to do this with a global change. By silently replace them with a local change it would still keep them happy, because as far as they care, if they can autohide the taskbar &quot;for their application&quot; they&#39;d have no concern what&#39;s the means be used to get there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-996873">
				<div id="div-comment-996873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996873">
			July 9, 2012 at 4:50 am</a>		</div>

		<p>cheong00: What happens when the magic incantation the hapless programmer finds on the forum includes setting the &quot;I&#39;m special&quot; bit?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-996953">
				<div id="div-comment-996953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-996953">
			July 9, 2012 at 10:20 am</a>		</div>

		<p>to @@Bron (um, that&#39;s a weird way to refer to someone who replied using the name @Bron)</p>
<p>While that&#39;s a reasonable assumption, &nbsp;I don&#39;t think that&#39;s the cause. &nbsp;Why? &nbsp;Because the auto-hide bugginess happens on *machines that are fresh windows installs* that don&#39;t have *ANY* third party software. Hmmm!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-997033">
				<div id="div-comment-997033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120705-00/?p=7203#comment-997033">
			July 9, 2012 at 7:13 pm</a>		</div>

		<p>@Gabe: Yup. That&#39;s why I said &quot;At some point, I wonder&#8230;&quot;. It&#39;s not a good solution to the problem either.</p>
<p>However, since Win8 and VS11 will introduce a new type of application called Metro. I think it could be a good time to introduce this flag and a new application template for that, then wait for one or two new version of VS to enforce this shim. We can also update &quot;editbin&quot; in SDK to include ability to set this flag so end-users of the old applications can toggle this flag themselves. (I assume here that only technical savvy enough people &#8211; read as &quot;those can search information on web&quot; &#8211; will use these kinds of application.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>