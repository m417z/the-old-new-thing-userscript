<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (9)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-530753">
				<div id="div-comment-530753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530753">
			July 26, 2007 at 10:52 am</a>		</div>

		<p>Brilliant! I was actually looking for exactly this information a while back and ended up giving up and just cobbling together something that covered the simple cases. Thanks Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-530813">
				<div id="div-comment-530813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesNT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530813">
			July 26, 2007 at 1:12 pm</a>		</div>

		<p>This will prove very useful to me as well. &nbsp;Thank you, Mr. Chen.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-530863">
				<div id="div-comment-530863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530863">
			July 26, 2007 at 3:07 pm</a>		</div>

		<p>The WinXP &quot;Help and Support Center&quot; has a topic on Permissions that has links with similar descriptions (but still not nearly as detailed as what Raymond provided here) of the meanings of the terms used in the security dialog for all types of objects, including:</p>
<p>&nbsp;&#8211; file &amp; folders (what Raymond described above)</p>
<p>&nbsp;&#8211; Shares</p>
<p>&nbsp;&#8211; Registry keys</p>
<p>&nbsp;&#8211; Services</p>
<p>&nbsp;&#8211; Printers</p>
<p>&nbsp;&#8211; Term Serv connections</p>
<p>&nbsp;&#8211; Group policy objects</p>
<p>&nbsp;&#8211; WMI objects</p>
<p>Even though the descriptions in WinXP help don&#8217;t go to the level of detail saying which Win32 identifiers map to the permissions in the UI, they do get detailed enough that you can usually figure out the mappings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-530953">
				<div id="div-comment-530953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pavel Lebedinsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530953">
			July 26, 2007 at 7:04 pm</a>		</div>

		<blockquote><p>
  Purpose: Having a common &#8216;temp&#8217; directory that anybody can write to and in which one can only read/modify/delete his/her files.
</p></blockquote>
<p>%windir%temp already works like this. It gives create file rights to BUILTINUsers and full control to creator/owner.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-530973">
				<div id="div-comment-530973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530973">
			July 26, 2007 at 9:31 pm</a>		</div>

		<p>Although it&#8217;s probably not shell related, I&#8217;d be more interested to know how GENERIC_READ and GENERIC_WRITE permissions map to ACLs. &nbsp;From what little research I&#8217;ve done, it appears that various subsystems (object manager, file system, etc) have tables that map the GENERIC_XXX to specific permissions, but I haven&#8217;t been able to find all the mappings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-530983">
				<div id="div-comment-530983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Prem</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530983">
			July 27, 2007 at 12:40 am</a>		</div>

		<p>I believe this &quot;owner can delete&quot; concept doesn&#8217;t entierly apply. If a user creates a subdirectory and denies permission to the directory, the owner can&#8217;t delete the directory and the files beneath it. Is there any workaround for this?</p>
<p>Say if I want to implement a directory where any user can create/delete files but I have full access to the files/folders underneath. Assuming I don&#8217;t have admin rights..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-530943">
				<div id="div-comment-530943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-530943">
			July 26, 2007 at 6:38 pm</a>		</div>

		<p>*Thanks* a lot Raymond!</p>
<p>With that info, I managed, at last, to do what I always wanted: create a common temp directory for all users! Previously, I relied on the fact that there was always a program with a open temp file to deny me the temp directory deletion (I have a script to delete its content that does a &quot;rd /s&quot;)</p>
<p>Now I truly don&#8217;t have the right to delete it.</p>
<p>For anybody who&#8217;s interested, and for my future use I&#8217;m sure, here is the purpose and how to do it:</p>
<p>Purpose:</p>
<p>Having a common &#8216;temp&#8217; directory that anybody can write to and in which one can only read/modify/delete his/her files.</p>
<p>I set it up so that administrator is also impacted, so you will have to have another special account+ACL if you want to easily clean it.</p>
<p>In my example, the temp directory in question will be C:temp</p>
<p>How to do it:</p>
<p>&#8211; On the parent of the &#8216;temp&#8217; directory (C:), remove the &quot;Delete subfolders &amp; file&quot; permission from the users you want this method to apply. In my case, since &quot;Users&quot; only have Read/Execute permission on C:, this means that I only remove this permissions from the Administrators group(*).</p>
<p>&#8211; Still on the parent (C:), add a new ACL for &quot;CREATOR&quot; that will apply only to contained files and subfolders. For this ACL, only set the &quot;Delete&quot; permission.</p>
<p>&#8211; Create the temp directory.</p>
<p>&#8211; Remove the ACL inheritance </p>
<p>&#8211; Make effective the following permissions:</p>
<p> &nbsp;&#8211; Admin group/This folder only: full control minus delete and delete children</p>
<p> &nbsp;&#8211; Users group/This folder only: read/execute plus file and folders creation</p>
<p> &nbsp;&#8211; CREATOR/This folder and everything inside: full control</p>
<p>I hope I didn&#8217;t forget anything. Anybody, please feel free to correct me if this method is wrong in any way and thanks again Raymond!</p>
<p>(*) I had previously removed my administrator login name from the list on C: since its right do not, in my opinion, need to be explicitely specified as they are not different from those of the group Administrators&#8230; I thought it was a duplicate entry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-531013">
				<div id="div-comment-531013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-531013">
			July 27, 2007 at 8:30 am</a>		</div>

		<p>&quot;Say if I want to implement a directory where any user can create/delete files but I have full access to the files/folders underneath. Assuming I don&#8217;t have admin rights..&quot;</p>
<p>If you don&#8217;t grant the WRITE_DAC permission on child objects that should do it, shouldn&#8217;t it? Since they won&#8217;t be able to alter the permission, you&#8217;ll always have access.</p>
<p>Alternatively you could give the account that needs to delete them the Take Ownership permission, though that&#8217;s a little heavy handed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-531523">
				<div id="div-comment-531523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070726-00/?p=25833#comment-531523">
			July 28, 2007 at 8:27 am</a>		</div>

		<blockquote><p>
  &gt;Nawak:</p>
<p>  &gt; Purpose: Having a common &#8216;temp&#8217; directory that anybody can write to and in which one can only read/modify/delete his/her files.</p>
<p>  Pavel:</p>
<p>  %windir%temp already works like this. It gives create file rights to BUILTINUsers and full control to creator/owner.
</p></blockquote>
<p>Well, mine doesn&#8217;t work like this. I don&#8217;t remember messing with its permissions but maybe I did. Mine is setup so that Users have Read/Execution access to c:windowstemp. So they cannot create files in it but they can read Admin&#8217;s temp files! Looking at how stupid that situation is, I clearly must have done something wrong in the past&#8230;</p>
<p>If I look at one of my newer PC, the situation is different, much closer to what I wanted, except that while Users can create files and have directory traversal permission, they can&#8217;t list its files, which disables my &quot;rd /s&quot; temp cleaning solution. The other problem is that Admins can read &amp; delete Users&#8217; files, but I can understand that my personal preference is not the default :)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>