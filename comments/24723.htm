<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (23)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-561713">
				<div id="div-comment-561713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Psa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561713">
			October 22, 2007 at 10:23 am</a>		</div>

		<p>Slightly offtopic, but do you know if there&#8217;s any end-user documentation for the IMEs that comes with Windows?</p>
<p>I&#8217;m learning mandarin and it took me ages to work out that you need to type &quot;v&quot; in the IME to get a pinyin &quot;&#252;&quot; (that&#8217;s supposed to be a u with a diaeresis if it doesn&#8217;t show up).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561733">
				<div id="div-comment-561733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mmmh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561733">
			October 22, 2007 at 10:30 am</a>		</div>

		<p>Is it always possible ?</p>
<p>For example, is it possible to implement a complex control like the VS2005 syntax coloring edit control resorting only to the basic text editbox and/or the rtf-editor ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-561753">
				<div id="div-comment-561753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.paralint.com/blog/' rel='external nofollow' class='url'>Guillaume</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561753">
			October 22, 2007 at 11:30 am</a>		</div>

		<p>In one console application, I use ReadConsoleInput to handle all things Unicode for me. Works fine.</p>
<p>But if a stream is redirected in my application, stdin is not a console anymore and I loose ReadConsoleInput and all the Unicode goodies it provides (most of wich I wasn&#8217;t even aware of, mind you).</p>
<p>Any tips on how to handle this ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561823">
				<div id="div-comment-561823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561823">
			October 22, 2007 at 3:22 pm</a>		</div>

		<p>What happened to the Raymond Chen who said &#8220;Programming is hard because nobody said it would be easy&#8221; ?</p>
<div class=post>[<i>No sense making something harder than it needs to be. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-561833">
				<div id="div-comment-561833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561833">
			October 22, 2007 at 3:46 pm</a>		</div>

		<p>[No sense making something harder than it needs to be. -Raymond]</p>
<p>What about the shell and COM you mentioned yesterday, wouldn&#8217;t it be simpler to allow objects created by one thread to be used by other threads?</p>
<div class=post>[<i>You&#8217;re saying it&#8217;s just as easy to write a free-threaded object as a multi-threaded object? My experience suggests otherwise. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561853">
				<div id="div-comment-561853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Not a nitpicker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561853">
			October 22, 2007 at 4:06 pm</a>		</div>

		<p>Actually, it is just as easy to write a free-threaded object as it is to write a multi-threaded object. &nbsp;Is it safe to assume you meant apartment-threaded instead of multi-threaded?</p>
<div class=post>[<i>Right, sorry. free-threaded vs. single-threaded. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-561863">
				<div id="div-comment-561863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561863">
			October 22, 2007 at 4:08 pm</a>		</div>

		<p>[You&#8217;re saying it&#8217;s just as easy to write a free-threaded object as a multi-threaded object? My experience suggests otherwise. -Raymond]</p>
<p>I mean using the object &#8211; not implementing it.</p>
<div class=post>[<i>So you believe it should be more important to make using shell extensions easier at the expense of making it harder to write them. <a href="http://blogs.msdn.com/oldnewthing/archive/2004/12/29/343664.aspx" rel="nofollow">It&#8217;s a balance we&#8217;ve already discussed a few years ago</a>; no point rehashing it. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561883">
				<div id="div-comment-561883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ramdyne.nl/' rel='external nofollow' class='url'>Andreas Sikkema</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561883">
			October 22, 2007 at 5:12 pm</a>		</div>

		<p>This looks very much like the way T9 input on mobile phones seems to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-561903">
				<div id="div-comment-561903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561903">
			October 22, 2007 at 5:41 pm</a>		</div>

		<p>&quot;This looks very much like the way T9 input on mobile phones seems to work.&quot;</p>
<p>Its the same story on some of the BlackBerry phones I&#8217;ve done a lot of coding for. &nbsp;The predictive nature they use is pretty efficient if you take the time to learn it. &nbsp;Using the standard edit controls there gains you all of this for free; of course, being a completely closed in Java solution, you generally can&#8217;t write new input methods.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-henry-boehlert odd alt thread-odd thread-alt depth-1" id="comment-561913">
				<div id="div-comment-561913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Henry+Boehlert' rel='external nofollow' class='url'>Henry Boehlert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561913">
			October 22, 2007 at 5:51 pm</a>		</div>

		<p>I&#8217;ll probably be dead wrong but last time I checked, EDIT and RICHEDIT_CLASS didn&#8217;t provide support for huge files, e.g. windowing/virtualization, maybe like WC_LISTVIEW does.</p>
<p>Whenever I needed to wade through weeks of logs and traces, I came darn close to try and write it myself.</p>
<p>It&#8217;s not so frequent anymore, though, now that we have multi-core and dirt-cheap RAM and I can keep working while the editor is catching breath. (Will notepad.exe ever support /3G?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-561923">
				<div id="div-comment-561923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561923">
			October 22, 2007 at 5:54 pm</a>		</div>

		<p>Some people think they can do a better job then the programmers at Microsoft. &nbsp;When I meet people like that I say &quot;Well you obviously can&#8217;t, &#8217;cause if you could you&#8217;d be working for them.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561743">
				<div id="div-comment-561743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561743">
			October 22, 2007 at 11:05 am</a>		</div>

		<p>If it was always possible to hand off work to other people, we wouldn&#8217;t need to write much code, would we? &nbsp;Of course the edit and RTF controls aren&#8217;t suitable for every possible situation. &nbsp;But you should definitely try to use them *if possible*.</p>
<p>I had to add proper IME support to someone else&#8217;s custom edit control not too long ago and it wasn&#8217;t that hard. &nbsp;I paid attention to WM_IME_COMPOSITION and used the Imm*() API.</p>
<p>Here&#8217;s the example I used as a guide &#8211; IME support in the context of a game:</p>
<p><a rel="nofollow" target="_new" href="http://web.archive.org/web/20061109141509/http://www.libsdl.org/pipermail/sdl/2002-October/049962.html" rel="nofollow">http://web.archive.org/web/20061109141509/http://www.libsdl.org/pipermail/sdl/2002-October/049962.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-561763">
				<div id="div-comment-561763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561763">
			October 22, 2007 at 12:10 pm</a>		</div>

		<p>&quot;the answer is pretty easy: Don&#8217;t do it!&quot;</p>
<p>Good advice, but it&#8217;s clearly not always possible to follow it. &nbsp;Many applications with non-trivial user interfaces will require something more advanced than either of these controls will handle (e.g. automatic text formatting, graphical variations like visible whitespace, etc.).</p>
<p>As an example, one application I intend to write in the near future will require a text editor with automatic highlighting (like a syntax highlighting editor) combined with support for simple text formatting (e.g. choice of a few predefined font styles, underline and italics, first line of paragraph indents, etc.)</p>
<p>This seems to me to be beyond the capabilities of the existing controls. &nbsp;The project will be distributed as shareware and will likely not earn a huge amount of cash, so third party controls seem to be out. &nbsp;This means I *need* to write something that will allow the user to enter text.</p>
<p>So how do I do this? &nbsp;Frankly, not being in the slightest bit familiar with IME, I don&#8217;t have a clue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561933">
				<div id="div-comment-561933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ookii.org' rel='external nofollow' class='url'>Sven Groot</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561933">
			October 22, 2007 at 7:49 pm</a>		</div>

		<p>There are legitimate cases for writing your own text editors. Are the Visual Studio editor and Word not examples of that? How do they deal with input, then?</p>
<p>The nice thing about the IME is that it sends you window messages as it&#8217;s composing the string to let you know what it&#8217;s doing. This has been very useful for to me in one instance. :)</p>
<div class=post>[<i>Of all the times I&#8217;ve been asked this question, I have yet to find someone who was intending to write a text editor. If you want to write a text editor, then you get to learn about the IME messages. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-eric-brown even thread-even depth-1" id="comment-561793">
				<div id="div-comment-561793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Eric+C+Brown' rel='external nofollow' class='url'>Eric C Brown</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561793">
			October 22, 2007 at 12:59 pm</a>		</div>

		<p>Jules:</p>
<p>I would *strongly* consider using the richedit control for your text editor control; preferably richedit 4.1, as it has full Text Services Framework support (the supported way to implement IMEs). &nbsp;If you have more questions, contact me via my blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-561943">
				<div id="div-comment-561943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-561943">
			October 22, 2007 at 8:32 pm</a>		</div>

		<p>From the question, I understood it as &quot;how do you deal with an input stream that may or may not contain unicodedata?&quot;, not &quot;how do you deal with key inputs that should map to unicode output?&quot; &#8211; but it was a woolly question.</p>
<p>I strongly agree, if the question meant what Raymond interpreted it to, that you should avoid it like the plague. In Java 1.1 I tried, really hard, to do rich text (as a superset of unicode). After months of getting it wrong, with one bug popping up whenever I squished another, I retired from the fray, defeated, and used a Java 1.2 Swing component instead.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-562003">
				<div id="div-comment-562003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://olshave.com/23102007luchshij-sposob-realizovat-vvod-unicode-simvolov.html' rel='external nofollow' class='url'>?????? ???????????? ?????? 2.0 &raquo; Blog Archive &raquo; ???????????? ???????????? ?????????????????????? ???????? Unicode ????????????????&#8230;</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-562003">
			October 23, 2007 at 7:10 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://olshave.com/23102007luchshij-sposob-realizovat-vvod-unicode-simvolov.html" rel="nofollow">http://olshave.com/23102007luchshij-sposob-realizovat-vvod-unicode-simvolov.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-562013">
				<div id="div-comment-562013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">e</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-562013">
			October 23, 2007 at 8:00 am</a>		</div>

		<blockquote><p>
  &gt; When I meet people like that I say &quot;Well you obviously can&#8217;t, &#8217;cause if you could you&#8217;d be working for them.&quot;
</p></blockquote>
<p>Pretty stupid comment. First because MS given its size has naturally a good number of bright heads as well as a much greater number of &quot;standard-skilled programmers&quot;.</p>
<p>Second you take for granted anyone&#8217;s dream is working for a big corporation in Redmond as opposite in &quot;working for a smaller company (and all that this implies)&quot;, &quot;working for a company closer to your home/family&quot;, &quot;creating your own startup&quot; or any combination of these and other factors.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-562023">
				<div id="div-comment-562023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Developers, developers, developers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-562023">
			October 23, 2007 at 9:13 am</a>		</div>

		<p>MS has a long tradition of ease the work of (external) developers. Why should this be an exception?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-562343">
				<div id="div-comment-562343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anony Moose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-562343">
			October 24, 2007 at 12:00 am</a>		</div>

		<p>Based on the &quot;if you can do better than X then you would work for X&quot; theory, all companies (including both Microsoft and Apple) are the worst company, because if the developers at company Y could do better than the ones working for company X then they would work for that company because company X is always the best company in the universe for all values of X. You know, logic is a funy thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-562403">
				<div id="div-comment-562403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-562403">
			October 24, 2007 at 5:02 am</a>		</div>

		<p>brian:</p>
<p>Some people think they can do a better job then the programmers at Microsoft. &nbsp;When I meet people like that I say &quot;Well you obviously can&#8217;t, &#8217;cause if you could you&#8217;d be working for them.&quot;</p>
<p>@brian:</p>
<p>Then Brian, we must all assume that no other good programmer exists except the ones who work or once worked for Microsoft, now do you honestly believe that? Seeing Microsoft products over the years I have strong doubts ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-562793">
				<div id="div-comment-562793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/michkap/archive/2007/10/26/5677876.aspx' rel='external nofollow' class='url'>Sorting It All Out</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-562793">
			October 26, 2007 at 11:13 am</a>		</div>

		<p>I saw Raymond Chen&#8217;s The best way to process Unicode input is to make somebody else do it and I wholeheartedly</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-595943">
				<div id="div-comment-595943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.nikvoronin.com/2007/10/22/luchshij-sposob-realizovat-vvod-unicode-simvolov/' rel='external nofollow' class='url'>?????? ???????????????????????? &raquo; Blog Archive &raquo; ???????????? ???????????? ?????????????????????? ???????? Unicode ????????????????</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071022-00/?p=24723#comment-595943">
			January 31, 2008 at 5:13 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.nikvoronin.com/2007/10/22/luchshij-sposob-realizovat-vvod-unicode-simvolov/" rel="nofollow">http://www.nikvoronin.com/2007/10/22/luchshij-sposob-realizovat-vvod-unicode-simvolov/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>