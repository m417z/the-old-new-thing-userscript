<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-189563">
				<div id="div-comment-189563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189563">
			July 1, 2004 at 7:22 am</a>		</div>

		<blockquote><p>
  Of course, this problem could have been solved by separating the item content from the item presence. So instead of just having an HTREEITEM, there would be, say, HTREENODE and HTREENODECONTENTS. The node would represent a physical location in the tree, and the item contents would represent the contents of that node: its name, icon, etc.</p>
<p>This appeals to me logically &#8211; it&#8217;s analogous to model-view separation. Of course, we can simplify the common case by creating a wrapper API that generates HTREEITEMs by manipulating the node and nodecontents individually. You can then choose your level of abstraction.</p>
<p>Your solution is fairly similar to mine, with the difference that it will be implemented slightly differently by everyone that does it. You could possibly fix that by writing a BSD-licensed wrapper and maintaining it as part of the normal dev kit.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189603">
				<div id="div-comment-189603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189603">
			July 1, 2004 at 8:20 am</a>		</div>

		<p>Other than the lack of multiselect, I have to say the tree control is one of the most straightforward of the common controls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189613">
				<div id="div-comment-189613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jhurani.blogspot.com' rel='external nofollow' class='url'>Chetan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189613">
			July 1, 2004 at 8:29 am</a>		</div>

		<p>I&#8217;ve never done anything serious in windows GUI programming, but is this related?</p>
<p><a target="_new" href="http://jhurani.blogspot.com/2004_01_01_jhurani_archive.html#107427087477478848" rel="nofollow">http://jhurani.blogspot.com/2004_01_01_jhurani_archive.html#107427087477478848</a></p>
<p>Yesterday I just discovered something.  Do not name a folder on your Windows Desktop as &quot;desktop&quot;.  Why?</p>
<p>Because it leads to some crazy behavior in a special case.  Here are the steps.  It happens on Windows 2000 Professional and Server, and Windows XP Home/Professional at least.</p>
<p>&#8211; Open explorer in the folders view.  (Press the Win-E combo.)<br />
<br />&#8211; Right click in the list pane and create a new folder.  Rename<br />
<br />  it to &quot;desktop&quot;.<br />
<br />&#8211; Right click in the list pane and create another new folder.<br />
<br />&#8211; &quot;Go in&quot; the last created folder.<br />
<br />&#8211; Create another new folder or a new file here using the same old<br />
<br />  context menu.<br />
<br />&#8211; Press F5 (once or twice).</p>
<p>In the Folder tree view on left you&#8217;ll see empty entries.  The only use of this explorer window now is to create more such empty entries using refresh-view (F5).  Clicking on &quot;C:&quot; for example leads you to no where.  Try it.</p>
<p>The special case is not very special.  Later whenever you create a new file/directory and refresh, you&#8217;ll see it.</p>
<p>Sometimes a dialog pops up saying &quot;c:&#8230;..New Folder&quot; etc.. refers to a location that is not available.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189623">
				<div id="div-comment-189623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189623">
			July 1, 2004 at 8:37 am</a>		</div>

		<p>Parts of TreeView make the common case hard to benefit the rare case though &#8211; which is kind of odd.</p>
<p>Namely, there are two images for each TreeView item &#8211; one for when the item is selected, and one for when it&#8217;s not.</p>
<p>I&#8217;ve never seen this used by anyone.</p>
<p>However, the common case used throughout the OS and apps is that you want a different image when the node is opened than when it&#8217;s closed.</p>
<p>It&#8217;s a really strange design choice to have it the way it&#8217;s actually implemented.</p>
<p>Of course, these days you&#8217;d probably want all the permutations of open/closed/selected/unselected/hot/cold&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189633">
				<div id="div-comment-189633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189633">
			July 1, 2004 at 8:38 am</a>		</div>

		<p>Chetan:<br />
<br />It&#8217;s not related. The special name &quot;desktop&quot; (lousy choice &#8211; should have been a GUID for the filename) is used by the shell, that&#8217;s all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189663">
				<div id="div-comment-189663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johan Creuk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189663">
			July 1, 2004 at 9:22 am</a>		</div>

		<p>Simon,</p>
<p>Think of the case when a tree view is driving a more detailed view pane, also on-screen. In this case, it makes sense for the selection to change the icon. For example, if the &quot;folder&quot; in the tree view is on display in the list pane, as in Explorer, it makes sense for that folder to appear &quot;open&quot;.</p>
<p>On the other hand, I&#8217;d expect the open/close status of a tree view to be indicated by the expand/collapse widget showing either + or -, and also by the fact that there are items displayed beneath a given item!</p>
<p>I&#8217;d say a different icon for selected is the more useful case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189683">
				<div id="div-comment-189683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Orion Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189683">
			July 1, 2004 at 10:07 am</a>		</div>

		<p>Wouldn&#8217;t it have been possible to add an additional struct containing the content information and an additional method that would allow you to populate the node with the struct so that the creation of nodes would be simpler. I.e. you could have gone with both approaches.</p>
<p>Orion Adrian</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189703">
				<div id="div-comment-189703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189703">
			July 1, 2004 at 10:22 am</a>		</div>

		<p>Once you allow a tree node to be in several different places of the tree, it is no longer a tree. Now try to explain Joe Random User what a DAG is and why it works :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189773">
				<div id="div-comment-189773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189773">
			July 1, 2004 at 11:42 am</a>		</div>

		<p>Johan: Never mind &#8211; I had a brain fart and confused the two models.<br />
<br />I was under the impression that Explorer used the common-case I was describing &#8211; it doesn&#8217;t.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189793">
				<div id="div-comment-189793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189793">
			July 1, 2004 at 12:09 pm</a>		</div>

		<blockquote><p>
  When you design an interface, you want to make the common case easier than the rare case. </p>
<p>Damn right. I can&#8217;t remember the number of arguments I&#8217;ve had with people who want to design for the cool but esoteric case. It&#8217;s kind of like the premature generalization that people seem to be prone to when designing inheritance hierarchies.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189803">
				<div id="div-comment-189803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pixelbeat.org/' rel='external nofollow' class='url'>P&#225;draig Brady</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189803">
			July 1, 2004 at 1:09 pm</a>		</div>

		<p>For comparison, GtkTreeView is a concrete example<br />
<br />that uses the Model/View/Controller approach.<br />
<br /><a target="_new" href="http://liw.iki.fi/liw/texts/gtktreeview-tutorial.html" rel="nofollow">http://liw.iki.fi/liw/texts/gtktreeview-tutorial.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189823">
				<div id="div-comment-189823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189823">
			July 1, 2004 at 2:30 pm</a>		</div>

		<p>I&#8217;d like to know why many treeview (and listview) notification messages send a structure that contains fields that aren&#8217;t properly filled in. Eg the lParam field isn&#8217;t supplied, or coordinates aren&#8217;t correct for custom draw. Things like that.</p>
<p>Any reasonably complicated program is surely going to use the lParam field for its own data &#8211; wouldn&#8217;t the &quot;common case&quot; justify providing this rather than necessitating an additional call to TVM_GETITEM, etc?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189643">
				<div id="div-comment-189643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Merle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189643">
			July 1, 2004 at 9:00 am</a>		</div>

		<p>&quot;When you design an interface, you want to make the common case easier than the rare case.&quot;</p>
<p>Hear, hear.</p>
<p>And I don&#8217;t think it&#8217;s analogous to model-view.  Your model is probably not stored in the tree item &#8212; the item is more a placeholder for content, much as buttons or menu labels are.  You wouldn&#8217;t *really* put your controller code directly in btn1_onClick, would you?  Nor would you store information in the button object itself.</p>
<p>I think of tree items as containing references to data (or actions).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189733">
				<div id="div-comment-189733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.vbbox.com/blog/' rel='external nofollow' class='url'>Klaus H. Probst</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189733">
			July 1, 2004 at 11:01 am</a>		</div>

		<p>Chetan: You don&#8217;t say *where* you&#8217;re creating these folders.</p>
<p>A few weeks ago I uninstalled some app that actually deleted the physical Desktop folder under &lt;root&gt;:Documents And Settings&lt;myid&gt;. In the Win32 shell there are two concepts of a &quot;desktop&quot;. This physical folder (which allows you to have a messy desktop with things in it) and the shell namespace root, which is not a real folder.</p>
<p>If you delete the physical folder, every time you try to refresh the &quot;screen desktop&quot; you&#8217;ll get an error saying that the location refers to something that is unavailable. If you re-create the physical desktop folder then the problem goes away.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189963">
				<div id="div-comment-189963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-189963">
			July 2, 2004 at 8:27 am</a>		</div>

		<p>Jon:<br />
<br />Two things:</p>
<p>Firstly, you need to check the flags to see which parts of the structure are valid; not all flags are set for each notification message.</p>
<p>Secondly, the reason for not using lparam for this is because&#8230; well&#8230; what do you do if you&#8217;re not in the same process as the treeview control? Your lParam data would be invalid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190063">
				<div id="div-comment-190063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-190063">
			July 2, 2004 at 9:18 am</a>		</div>

		<p>Jon: I just spent fifteen minutes going through all the treeview notifications and all of the ones that refer to items do set the lParam (at least that&#8217;s what it looked like to me), so I&#8217;m not sure which notifications you&#8217;re talking about. If any fail to set it, it&#8217;s just an oversight. </p>
<p>Simon: Yeah, the selected image thingie violates the principle of &quot;simple is easy&quot;. Nobody&#8217;s perfect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190243">
				<div id="div-comment-190243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040701-00/?p=38613#comment-190243">
			July 2, 2004 at 7:53 pm</a>		</div>

		<p>LVN_DELETEITEM and LVN_GETDISPINFO are two examples where the listview doesn&#8217;t supply the lParam value and obviously should. The coordinates supplied for NM_CUSTOMDRAW are sometimes invalid under XP. Ok, these are probably just oversights but they&#8217;re annoying nonetheless :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>