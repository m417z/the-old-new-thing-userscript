<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (40)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1188504">
				<div id="div-comment-1188504" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188504">
			May 8, 2015 at 7:12 am</a>		</div>

		<p>Wow talk about asking for a bad reason. The reason I wanted similar diagrams was not to define the screen layout but to define the constants. A mysterious 1,3, etc. in the form layout code is a recipe for trouble on Windows next.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188514">
				<div id="div-comment-1188514" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sehe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188514">
			May 8, 2015 at 7:22 am</a>		</div>

		<p>CAUTION: This image is really useful and I wish all of this was actually documented.&quot; &#8211; I get a big fat malware warning on that site. No-view.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188534">
				<div id="div-comment-1188534" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188534">
			May 8, 2015 at 7:41 am</a>		</div>

		<p>It&#39;s a pity you can&#39;t have both an official &quot;this is what is guaranteed&quot; documentation and an unofficial &quot;this is how it&#39;s currently done&quot; documentation (because you know people are going to treat the later as if it was the former, causing endless headaches).</p>
<p>For open source software, the official documentation is the documentation itself and the unofficial documentation is the source code and its non-documentation comments. I imagine it&#39;s the same for Windows, but with only Microsoft employees being allowed to look into the source code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-john-ludlow odd alt thread-odd thread-alt depth-1" id="comment-1188544">
				<div id="div-comment-1188544" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/John+Ludlow' rel='external nofollow' class='url'>John Ludlow</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188544">
			May 8, 2015 at 7:58 am</a>		</div>

		<p>@Cesar</p>
<p>And where do blogs like this one fit in? I&#39;d argue the latter, since it&#39;s just someone who wants to provide potentially useful and / or interesting information through an unofficial channel. I think somewhere there&#39;s a disclaimer that effectively says that a blog isn&#39;t to be taken as gospel.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188554">
				<div id="div-comment-1188554" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188554">
			May 8, 2015 at 8:04 am</a>		</div>

		<p>Just reminds me of how beautiful the Aero window decorations were. IMO, still the best desktop theme there ever was.</p>
<p>I don&#39;t understand why they had to go in 8/10, looked much better than the ugly flat look with its Win 3.1 color scheme. (Battery concerns are void because 7 could already disable transparency for battery only)</p>
<p>I guess we have the fruit company to blame for that general trend, but it&#39;s really a shame I now have to guess what&#39;s a UI element and what is just static.</p>
<p>At least under the hood things are now rock solid, so I&#39;ll have to live with bad UI rather than switching to an inferior OS (with also bad UI).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188564">
				<div id="div-comment-1188564" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BJC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188564">
			May 8, 2015 at 8:16 am</a>		</div>

		<p>How does this compare to the MS published UI Design Guidelines?</p>
<p>As I understand it, the UI guidelines address many areas to try to define a consistent user experience. For example, they include recommendations that describe how controls should be spaced on different windows (e.g. dialogs). They also state the default font that should be used for many window elements. The current default font is now Segoe UI but that changed at some Windows version (Vista?). It seems that those guidelines change/evolve with different versions of Windows.</p>
<p>I&#39;m not sure I understand why there can&#39;t also be guidelines for defining the drawing of the window frames, even thought that may change and evolve with different versions of Windows. As was stated, drawing the frames according to a guideline doesn&#39;t break anything it simply looks dated. That doesn&#39;t seem to be a reason to leave the description of the windows frame undocumentated, for a given Windows version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-1188574">
				<div id="div-comment-1188574" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188574">
			May 8, 2015 at 8:19 am</a>		</div>

		<p>It is not about programmatically clicking something, it&#39;s about custom/owner draw. The listview uses magic padding constants etc so it is hard to perfectly replicate. Lets even forget about the padding for a second and ask, what is the color of the listview gridlines? You could just have a document that describes the colors and metrics of the v5 common controls. This would be extremely useful to the developer community even though most people are using v6 now and maybe moving to WinRT.</p>
<p>Every web browser seems to draw their own titlebar these days so if documentation is a no-go, maybe a SDK sample would be possible so people have a better chance of getting it right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188584">
				<div id="div-comment-1188584" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188584">
			May 8, 2015 at 8:47 am</a>		</div>

		<p>@sehe</p>
<p>On&#8230; archive.org? That&#39;s the worst false-positive I&#39;ve ever heard of.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188594">
				<div id="div-comment-1188594" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188594">
			May 8, 2015 at 8:52 am</a>		</div>

		<p>@skSdnW</p>
<p>I don&#39;t understand. Who is using comctl v5 in 2015, and why isn&#39;t anyone telling them to stop it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188604">
				<div id="div-comment-1188604" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">R</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188604">
			May 8, 2015 at 9:06 am</a>		</div>

		<p>On the other hand, not providing certain system metrics encourages people to use magic numbers instead. &nbsp;When I was writing Windows controls for a project, the reference library frequently provided insight on layout issues that I had. &nbsp;However, it&#39;s full of stuff like &quot;Windows calculates the height as the font plus 2px on top and 1px on bottom.&quot; &nbsp;I think more functions like GetComboBoxInfo(), which tell where components are without the details of inner/outer padding/margins would help cut down on requests for metrics like those in the linked image. &nbsp;(I was auto-sizing an owner-drawn control and just needed to know how much space to allocate outside of the rectangle that my items occupied.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-1188624">
				<div id="div-comment-1188624" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188624">
			May 8, 2015 at 9:17 am</a>		</div>

		<p>@Anon: The issue is owner draw and/or custom controls. If someone needs a TreeListView hybrid control (Process Explorer etc) then v5 documentation would be a good starting point, certainly much better than using &quot;3 + (GSM(SM_CYEDGE) * 2) + magicpadding&quot; and hoping for the best&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188634">
				<div id="div-comment-1188634" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188634">
			May 8, 2015 at 10:09 am</a>		</div>

		<p>Usually when a developer asks for this type of information they&#39;re doing something I don&#39;t care for (changing the Visual Style by trying to mimic an existing one), terrible software, they need to be named and shamed, they prevent us from moving forward to better Windows Versions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188644">
				<div id="div-comment-1188644" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188644">
			May 8, 2015 at 10:29 am</a>		</div>

		<p>I&#39;m under the impression, that this image simply visualize what is already documented anyway, so what&#39;s the problem adding it to the documentation? A picture is worth a thousands words.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188654">
				<div id="div-comment-1188654" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188654">
			May 8, 2015 at 10:31 am</a>		</div>

		<p>Personally, I despise the idea that this can&#39;t be done. &nbsp;It certainly can.</p>
<p>There are many ways to handle this:</p>
<p>a) so what if software &quot;breaks&quot; &#8211; that&#39;s their problem for taking the documentation as if it were going to be for all time. &nbsp;No OS is set in stone, nothing stops MS from changing things over time (which they do anyway).</p>
<p>b) without getting into a time-machine discussion, implement a &quot;visual version number desired&quot; with flags to say that your software makes no assumptions on visual layout, and should use the latest flavor. &nbsp;If someone wants to use the metrics for Windows 8.1, then they can &quot;lock&quot; their software to that visual metric by saying so in the manifest.</p>
<p>c) implement new API or IDs for each version of the OS &#8211; so if you want to change things for Windows 9 &#8211; then add a new API for asking about the layout &#8211; or add new SM_XXX symbols for the &quot;windows 9&quot; values.</p>
<p>I personally am not a fan of the &quot;if you don&#39;t document it then nobody can rely on it&quot; line of thinking. &nbsp;All it does is cause folks to spend time reverse-engineering it, and they still end up dependent upon it. &nbsp;Maybe they have more reason to think it is their own responsibility &#8211; but really &#8211; updating software to the latest visual flavor already requires effort at each release, so why would this be any different?</p>
<p>Too much backwards compatibility code&#8230; argument could / should be countered with &quot;you&#39;ve already written it &#8211; just put that flavor in a separate DLL and related functions, and then load that library in association with the target software&#39;s manifest&quot;. &nbsp;Again&#8230; fairly minor amount of upkeep.</p>
<p>&#8230;and arguments going as far back as Windows 95&#39;s UI expansion: yeesh &#8211; we&#39;ve had the same basic layout for 20 years now&#8230; I think if MS seriously changed much of anything it would break 100 things anyway, so documenting and supporting it in a more formal, clear, documented way still seems like a win-win.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188674">
				<div id="div-comment-1188674" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188674">
			May 8, 2015 at 10:53 am</a>		</div>

		<p>@Steve Wolf: When you wrote down &quot;the metrics for Windows&quot; you made an error like what perpetuates the problem. I don&#39;t know how, but I&#39;ve managed to change those metrics, and it can&#39;t be a gross hack because it spreads through saved and restored themes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188694">
				<div id="div-comment-1188694" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188694">
			May 8, 2015 at 11:46 am</a>		</div>

		<p>@Joshua &#8211; There are I assume values stored in themes &#8211; values that control the placement / size / spacing / etc. of visual elements. &nbsp;These values adhere to some internal published or not interfaces that the theme manager uses to draw things, or that is referenced by correctly written controls supplied by MS.</p>
<p>That the value of SM_CXBUTTON can change isn&#39;t the issue. &nbsp;That you can load a theme that alters the value of that metric isn&#39;t the issue. &nbsp;That&#39;s perfectly reasonable, and would be handled neat as a pin by documenting &quot;use CXBUTTON here in exactly this way for Windows 8.1&quot;.</p>
<p>What is at issue is only that SM_CXBUTTON may no longer be used in the same way in Windows .Next. &nbsp;But so what is my point&#8230;</p>
<p>Everything changes &#8211; software must adapt. &nbsp;By formalizing what the relationship is between a full API for a given OS release only clarifies the situation: in no way does it make things worse; unless you really think that by not-documenting it you actually make the situation better (as oppossed to simply engineering yourself an politically correct &quot;out&quot; of responsibility card while in actuality still making things a mess both for your programmers and your customers who still actually in reality have to deal with the bigger mess that results from lack of contractual documentation &#8211; even if that contract is &quot;here is the values for Windows version X &#8211; which may change in version Y and beyond&#8230; use at own risk)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188704">
				<div id="div-comment-1188704" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel Neely</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188704">
			May 8, 2015 at 12:31 pm</a>		</div>

		<p>@anon</p>
<p>It&#39;s probably an indication of a site wide warning; and considering how much of the web archive.org scrapes, I&#39;d be astounded if their malware filters didn&#39;t occasionally spring a leak and at least temporarily mirror something dangerous somewhere on the site.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188524">
				<div id="div-comment-1188524" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jesse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188524">
			May 8, 2015 at 7:34 am</a>		</div>

		<p>&gt; &quot;Okay, so if I want to programmatically click the Close button, I can go to the upper right corner of the window, move down SM_CY­FRAME + 1 pixels, move left move down SM_CX­FRAME + 1 pixels, and click there, and it will hit the button.&quot; </p>
<p>Presumably &quot;they&quot; had a rationally considered, well though-out reason for wanting such a thing, but if *that* doesn&#39;t raise a stonkin&#39; big red flag and sound a warning klaxon that you may be Doing It Wrong(tm), I don&#39;t know what will.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188664">
				<div id="div-comment-1188664" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188664">
			May 8, 2015 at 10:35 am</a>		</div>

		<p>@waleri</p>
<p>I take it you&#39;ve never been in a work place where arguments against poor programming practices, such as hard coding the programatic calculation of the position of a close button, comes down to whomever can find the MSDN Documentation that says its a particular way.</p>
<p>The problem is you&#39;ve got an official source that *looks* like it might be giving you a contractual guarantee when in reality you have nothing of the sort. </p>
<p>The bigger problem is that this isn&#39;t realized until the next version of Windows rolls around and management is furious that this programatic calculation no longer works. The Programmer is in CYA mode and blames the MSDN.</p>
<p>The only safe play is to not document stuff like this to not give these poor practices an out.</p>
<p>This is probably one of the more extreme cases, but one that comes up all the time is printing from services, it has never been documented to work, but enough people have found *evidence* through MSDN to hack together something really zombie-ish and get irate (at Microsoft no less) when it breaks (use your favorite search engine to search &quot;Printing from a Service&quot; for great examples of this).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188724">
				<div id="div-comment-1188724" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kurt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188724">
			May 8, 2015 at 7:30 pm</a>		</div>

		<p>When you have as many developers hacking on your API like Microsoft does, trying to hide details like these doesn&#39;t seem like the right approach to me. &nbsp;Ignorant programmers attempting to do stupid things are going to achieve it whether or not you help them with a diagram. &nbsp;A better approach is to try to make your readers a bit less ignorant about the sort of things that might change, by clearly stating what is not contractual. &nbsp;Can&#39;t do anything about them being stupid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188734">
				<div id="div-comment-1188734" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188734">
			May 8, 2015 at 8:22 pm</a>		</div>

		<p>@AS: It seems everything old is new again&#8230;</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2004/07/28/199589.aspx">blogs.msdn.com/&#8230;/199589.aspx</a></p>
<p>Old&#8230; new&#8230; someone should name a blog after that or something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-andycadley2 odd alt thread-odd thread-alt depth-1" id="comment-1188744">
				<div id="div-comment-1188744" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/AndyCadley' rel='external nofollow' class='url'>AndyCadley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188744">
			May 8, 2015 at 8:23 pm</a>		</div>

		<p>@Steve Wolf: But you&#39;ve missed the point. How would you have documented SM_CX­PADDED­BORDER for Windows 95, when padded borders weren&#39;t even a thing? If you don&#39;t, then you&#39;ve given people the impression of following the rules but pulled the rug out from under them. And it&#39;ll be their customers telling everyone &quot;Don&#39;t upgrade to Windows v.Next, it breaks all your programs&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188714">
				<div id="div-comment-1188714" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188714">
			May 8, 2015 at 1:29 pm</a>		</div>

		<p>@John</p>
<p>That&#39;s why I am confused &#8211; things like SM_CXEDGE and SM_CXSIZE *are* documented anyway, aren&#39;t they?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188754">
				<div id="div-comment-1188754" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kirillenseer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188754">
			May 9, 2015 at 1:41 am</a>		</div>

		<p>The better way is IMHO still just using the system title bar. This way, my app will always look consistent. And quite frankly, I assume that MS debug their title bars way more thoroughly, than I ever could.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188774">
				<div id="div-comment-1188774" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188774">
			May 9, 2015 at 3:00 am</a>		</div>

		<p>@John Ludlow: And where do blogs like this one fit in?</p>
<p>&#8211;&gt; Since oct 2001 I trust info on this blog more than msdn library. Of course, Raymond tries to spin much information in good light for his employer though.</p>
<p>@John: Usually when a developer asks for this type of information they&#39;re doing something I don&#39;t care for (changing the Visual Style by trying to mimic an existing one), terrible software, they need to be named and shamed.</p>
<p>&#8211;&gt; Instead, Raymond works full time creating back compat shims because he thinks it&#39;s constructive. What that does instead is developers relying on shims. Windows almost guarantee sloppy developers can continue to develop buggy programs without care. Lesson learned.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188784">
				<div id="div-comment-1188784" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GDwarf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188784">
			May 9, 2015 at 5:44 am</a>		</div>

		<p>@640k: You&#39;d rather no new version of Windows exist because Microsoft has gone under due to no one being willing to upgrade because 50% of their key applications no longer work? (You use hyperbole, I use hyperbole. :P)</p>
<p>Vista is an excellent demonstration of what happens when Microsoft follows your advice: suddenly basic hardware stops working because the developers have been writing drivers wrong for years. Lots of common hardware never gets proper drivers made, leading to a slow, unstable, and buggy experience for many people. Who gets the blame? Microsoft. Whose sales suffer? Microsoft&#39;s.</p>
<p>There&#39;s part of me that does agree with you: Full-time developers should learn how to write code properly, and it&#39;s ridiculous that scores of much more talented programmers have to spend their time fixing the mistakes of the ones who simply don&#39;t care, but short of Microsoft setting up an iOS-esque &quot;walled garden&quot; (which I&#39;m very opposed to) there&#39;s no real solution that isn&#39;t worse for end-users, and end-users are the people that computers are built to work for.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188794">
				<div id="div-comment-1188794" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188794">
			May 9, 2015 at 6:36 am</a>		</div>

		<p>&quot;Note that changing the visual layout of the caption does not break programs which draw their own caption bar.&quot;</p>
<p>Soon we&#39;ll forget how the default caption bar looks like. Every application wants to have a custom bar. Even Visual Studio.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188804">
				<div id="div-comment-1188804" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188804">
			May 10, 2015 at 8:28 am</a>		</div>

		<p>@GDwarf: That&#39;s why I said publish a broken list that includes the nature of the driver misbehavior that caused the problem. Truth is an absolute defense against libel.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188814">
				<div id="div-comment-1188814" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GDwarf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188814">
			May 10, 2015 at 10:01 am</a>		</div>

		<p>@Joshua: And how many people would read such a list? How many hardware developers would sue as soon as they appeared on it? How do you curate such a list? How does Microsoft monitor every single driver ever written? How bad must a bug be before a driver gets on that list? How many people would simply see it as Microsoft blaming others for their own mistakes?</p>
<p>I mean, loads of PC users don&#39;t even install Windows updates, how do you get such people to not blame Windows when their motherboard has a buggy driver?</p>
<div class="post">[<em>What happens if a driver gets put on the list, and then it turns out it wasn&#39;t the driver&#39;s fault after all? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1188824">
				<div id="div-comment-1188824" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188824">
			May 10, 2015 at 6:37 pm</a>		</div>

		<p>Just wondering if the documentation team had considered introducing a section of non-contractual appendix, where every pieces in it has boilerplate &quot;this section contains implementation detail / illustration to give you better understanding on the topic, however this is subject to change between versions&quot;.</p>
<p>It&#39;ll also help to create footprint on how a particular feature changed across version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188834">
				<div id="div-comment-1188834" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Piggott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188834">
			May 11, 2015 at 6:20 am</a>		</div>

		<p>@anon re: archive.org malware warning</p>
<p>&quot;On&#8230; archive.org? That&#39;s the worst false-positive I&#39;ve ever heard of.&quot;</p>
<p>I have come across several phishing sites hosted by archive.org that had been active for some weeks. (Yes, I reported them and they were taken down.) They were not part of the WayBack Machine, they were simply hiding in various corners of the service. Just because they&#39;re big, well-known and benevolent, doesn&#39;t make them invulnerable :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188844">
				<div id="div-comment-1188844" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188844">
			May 11, 2015 at 7:16 am</a>		</div>

		<p>@Steve Wolf</p>
<p>&quot;just put that flavor in a separate DLL and related functions, and then load that library in association with the target software&#39;s manifest&quot;</p>
<p>And then spend 100s of hours testing to ensure that loading this DLL doesn&#39;t somehow end up stomping the new function at the wrong time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188854">
				<div id="div-comment-1188854" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188854">
			May 11, 2015 at 7:26 am</a>		</div>

		<p>@Steve Wolf: You must be new here. &quot;Our software worked fine until Microsoft &#39;upgraded&#39; Windows. Don&#39;t update Windows, keep using [9X/XP/7/IE6].&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188874">
				<div id="div-comment-1188874" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188874">
			May 11, 2015 at 7:30 am</a>		</div>

		<p>Wow, it&#39;s intense how little ability there seems to be in the programming community (as represented on this site) for documenting interfaces&#8230; like is done for hundreds of other interfaces, which then sometimes have to be superseded in Windows Next and SxS is used to handle&#8230; oh, I dunno, exactly this same sorts of things.</p>
<p>lol &#8211; Andy &#8211; you&#39;ve missed the point. &nbsp;For a future version, you document what that future version uses, how it lays things out, what metrics it needs. &nbsp;You don&#39;t go backwards in time and break the Windows 95 layout API &#8211; you keep it too. &nbsp;and for those apps which say &quot;I use Windows 95 visual layout&quot; &#8211; they use the Win95Theme.dll &#8211; so that they continue to work &amp; can continue to rely on the _documented_ layout that Win95 adheres to.</p>
<p>&#8230;and since Windows 95 is intentionally a stupid thing to bring up (because it is already water under the bridge &#8211; can&#39;t go back in time and all that), you start doing this now, for windows 9, and going forward. &nbsp;Or maybe you back-port it to Windows 8 and above&#8230; which MS is perfectly capable of doing and has done with many interfaces in the past (back porting Wind32s, back-porting various APIs via common controls dialog, etc., etc., etc., ad naseum).</p>
<p>&#8230;not rocket science. &nbsp;Yes, it adds some testing &amp; maintenance debt to each release&#8230; which means at some point they have to sunset support for former themes &#8211; such as deciding that in Windows 10, Windows 8 theme / layout will no longer be supported (apps that rely upon it will be forced to use Windows 9 theme, and will look funny until you update them).</p>
<p>&#8230;almost like what they do anyway with things like XP and Vista and 2000 and every other thing that &#8211; although DOCUMENTED &#8211; still eventually becomes unsupported and&#8230; yet&#8230; the world yet spins, MS is still profitable at last check&#8230; and most software continues to function well enough&#8230; and supported software continues to be maintained &amp; updated for newer OS versions &#8230; like on every other day of the week since the dawn of Windows.</p>
<p>Seriously&#8230; how is this a difficult concept since you&#39;re all steeped in it daily anyway?</p>
<div class="post">[<em>It&#39;s more than just &quot;look funny&quot;. They may stop working outright. For example, they may not hit-test correctly. And woe unto you if you try to automate another application via coordinate calculations. (Your app uses the Windows 8 metrics, but the other app is using Windows 9 metrics.) -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcohn even thread-even depth-1" id="comment-1188934">
				<div id="div-comment-1188934" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188934">
			May 11, 2015 at 10:45 am</a>		</div>

		<p>@Nick: &quot;Don&#39;t update Windows, keep using [9X/XP/7/IE6].&quot; &#8211; not anymore!</p>
<p><a rel="nofollow" target="_new" href="http://www.telegraph.co.uk/technology/microsoft/11597114/Windows-10-will-be-final-version-of-Windows.html">http://www.telegraph.co.uk/&#8230;/Windows-10-will-be-final-version-of-Windows.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-andycadley2 odd alt thread-odd thread-alt depth-1" id="comment-1188944">
				<div id="div-comment-1188944" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/AndyCadley' rel='external nofollow' class='url'>AndyCadley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188944">
			May 11, 2015 at 11:08 am</a>		</div>

		<p>@Steve Wolf: And when the app that says &quot;I use Windows 95 visual layout&quot; tried to use that information to automate Explorer windows?</p>
<p>Not to mention how many people complain already that Windows has old dialogs. Can you even begin to imagine what a mess it would start to look like if you mixed and matched the themes for various different versions of Windows on a single desktop.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1188964">
				<div id="div-comment-1188964" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188964">
			May 11, 2015 at 12:17 pm</a>		</div>

		<p>@waleri</p>
<p>They&#39;re documented, but their implementation (IE their exact values) are not. Perhaps I misunderstood here, but I think what&#39;s being argued for here is a contractual guarantee that X+Y=Z, metrics that are all free to change from Windows version to Windows version, that is a terrible idea that ensures you&#39;re never able to change.</p>
<p>@640k</p>
<p>&gt;Instead, Raymond works full time creating back compat shims because he thinks it&#39;s constructive.</p>
<p>Its incredibly constructive because it means that companies that upgrade are not punished for poor programming practices and encourages upgrades. While I like to believe in the perfect world to, the business reality is that if none of the old crappy software runs on your platform people (more so multi-million dollar businesses) aren&#39;t going to upgrade, which means you&#39;re out of business real quick. I agree with almost everything GDwarf had to reply with there.</p>
<p>@Steve Wolf</p>
<p>&gt;Wow, it&#39;s intense how little ability there seems to be in the programming community (as represented on this site) for documenting interfaces</p>
<p>Try working on any code base of any decent size (25-30 Million LOC; basically anything beyond a trivial Single Page App) with a decent sized development team (50-75+ employees) and come back and tell me if you have the same opinion. Look at these companies internally and how many of them can&#39;t seem to document their own internal systems, now multiply that by several orders of magnitude and you&#39;re in Microsoft&#39;s shoes.</p>
<p>Dependency Hell is real, as is Servicing Hell, there have been several attempts to fix it the latest one seems to say &quot;Throw everything in the trash, every time, and just roll a single version; Don&#39;t like it? Tough Cookie&quot;. A profitable company whose name is a fruit seems to have taken this approach. Time will tell if this is the solution that wins out in the end.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1188974">
				<div id="div-comment-1188974" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188974">
			May 11, 2015 at 1:06 pm</a>		</div>

		<p>Hit testing via display coordinate computation? &nbsp;Really? &nbsp;That&#39;s a valid approach to anything? &nbsp;Why wouldn&#39;t I walk the child windows looking for the one with the correct ID, then clicking the center of that?</p>
<p>Such a counter example sounds like a hackity hack hack, not a valid reason to avoid documenting visual layouts.</p>
<p>I&#39;ve written an awful lot of Windows software over the years, and I&#39;ve never automated other software by computing a click-position. &nbsp;Software which does that sort of hackery deserves to fail. &nbsp;That&#39;s why automation interfaces exist. &nbsp;If the target software doesn&#39;t support automation &#8211; then you have no business trying to do this anyway. &nbsp;And if you do anyway &#8211; well, of _course_ it breaks. &nbsp;Duh.</p>
<p>If you clearly document something &#8211; the it is only that much easier to document the next something: you have prior art to refer to, and you only need update that which has actually changed. &nbsp;Big companies 30 million lines of code blah &#8211; who cares? &nbsp;Microsoft surely has deep enough pockets to document its UI. &nbsp;And I would bet that their own software would actually run better &#8211; because their own programmers would suddenly have correct information that could be relied upon, instead of winging it and hoping.</p>
<p>After all&#8230; does anyone think that the lack of documentation reduces those who do all of these hackity hack horrible things? &nbsp;I think not. &nbsp;I think all it does is make a murkier situation that much darker and less reliable.</p>
<p>Also &#8211; if you see that there is an unmet need that is being hacked at to achieve it &#8211; then that is a strong indication that you need a real solution that itself is documented that addresses the actual problem so that folks don&#39;t keep having to hack bad fragile / broken solutions to it, eh?</p>
<div class="post">[<em>News flash: <a href="http://stackoverflow.com/q/30152842/">Apps use hackity hack hacks</a>. Also, while declaring that a customer&#39;s line of business application &quot;deserves to fail&quot; may win you points in certain circles, it will also lose you a customer. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hankhein even thread-even depth-1" id="comment-1188984">
				<div id="div-comment-1188984" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Henri+Hein' rel='external nofollow' class='url'>Henri Hein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1188984">
			May 11, 2015 at 2:33 pm</a>		</div>

		<p>@Steve Wolf,</p>
<p>Backwards compatibility isn&#39;t hard, developers handle versioning management &quot;neat as a pin,&quot; and I should not use hit-testing? &nbsp;This all sounds strange in my ears.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-anonymouscommenter odd alt thread-odd thread-alt depth-1" id="comment-1244026">
				<div id="div-comment-1244026" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymouscommenter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150508-00/?p=44904#comment-1244026">
			May 12, 2015 at 9:55 am</a>		</div>

		<p>Looks like some people believe that old software is no longer sold and its failure would affect only those few using it like big corporations. Not even wrong&#8230;</p>
<p><a rel="nofollow" target="_new" href="http://store.steampowered.com/app/364810/?snr=1_7_7_230_150_3">store.steampowered.com/&#8230;/364810</a></p>
<p>Yes, publishers built entire new model based on rereleasing old games with zero changes (as they were released + some optional patches) today. No compatibility updates, no bugfixes, nothing. (DirectX 7 in example I posted, in others you can find DX 6; maybe there is even DX 2 game&#8230;) Business model based on Microsoft&#39;s work on backwards compatibility. (And customers even defend that)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>