<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (8)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1281605">
				<div id="div-comment-1281605" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281605">
			January 27, 2017 at 8:21 am</a>		</div>

		<p>We ran into a similar but more insidious problem? A COM local server hands out references to an object(A) which in turn can create in-proc objects and hand out references to those (B). If the client process then releases the main object(A) the server process shuts down even though it is still hosting the subobject B.</p>
<p>Ideally the server process would call CoAddRefServerProcess for every loaded COM DLL that isn&#8217;t ready to be freed, but I never figured out how CoFreeUnusedLibrariesEx enumerates the DLLs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1 parent" id="comment-1281615">
				<div id="div-comment-1281615" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281615">
			January 27, 2017 at 9:20 am</a>		</div>

		<p>I suspect the tall narrow formatting may have more to do with the screen sizes that were common 20 years ago! It looks perfectly fine at 640&#215;480 or 800&#215;600. There&#8217;s also the widely-held belief that it&#8217;s easier to scan shorter lines, e.g. <a href="http://baymard.com/blog/line-length-readability" rel="nofollow">http://baymard.com/blog/line-length-readability</a>, <a href="http://practicaltypography.com/line-length.html" rel="nofollow">http://practicaltypography.com/line-length.html</a>, or <a href="http://www.webstyleguide.com/wsg2/type/lines.html" rel="nofollow">http://www.webstyleguide.com/wsg2/type/lines.html</a> which is of a similar era (ironically, it doesn&#8217;t limit the text width!) The articles are about 50-55 characters per line. We&#8217;ve just got used to ludicrously wide layouts due to web pages that pay no attention to page width, particularly on widescreen monitors.</p>
<p>Developers are probably more used to very wide layouts. I&#8217;m struggling to keep my juniors within the width that renders without wrapping in GitLab&#8217;s Merge Request view with both sidebars open, on a widescreen 1920&#215;1080 monitor (about 120 columns).</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1281735">
				<div id="div-comment-1281735" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lars Viklund</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281735">
			January 27, 2017 at 1:31 pm</a>		</div>

		<p>The term &#8220;magazine&#8221; is used for a reason. MSJ existed as a physical dead-tree artifact, whose articles had the typical narrow column typesetting.</p>
<p>I guess you could say that the online archives are skeumorphic.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1281635">
				<div id="div-comment-1281635" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.silverbacknetworks.tech' rel='external nofollow' class='url'>Joshua Bowman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281635">
			January 27, 2017 at 9:39 am</a>		</div>

		<p>It&#8217;s pretty cool that COM has been solid and stable enough that a 20-year-old article is still authoritative.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1281665">
				<div id="div-comment-1281665" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Hagan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281665">
			January 27, 2017 at 11:11 am</a>		</div>

		<p>SI: That&#8217;s a scenario you can get with OLE linking to embeddings. It is solved in that case by insisting that object B offers a way to obtain the IOleContainer interface on A, so that its clients can call LockContainer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1281675">
				<div id="div-comment-1281675" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Hagan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281675">
			January 27, 2017 at 11:13 am</a>		</div>

		<p>&#8230;or have I mis-remembered and this is the occasion where we reach for IExternalConnection?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1281775">
				<div id="div-comment-1281775" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1281775">
			January 30, 2017 at 1:23 am</a>		</div>

		<p>I&#8217;ll read up on both of those and see if either one helps, thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1282555">
				<div id="div-comment-1282555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170127-00/?p=95275#comment-1282555">
			February 3, 2017 at 2:09 pm</a>		</div>

		<p>You are my hero.  Thank you for posting this for me and the five other people still interested in COM development.</p>
<p>I am actually working on a distributed algorithm research project using DCOM and was considering an approach to trick out remote COM servers on their internal client count in order to exert some control over their startup/shutdown process &#8211; rather than implement them (and register them) as full Windows services.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>