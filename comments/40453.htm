<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (65)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-148553">
				<div id="div-comment-148553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/jgalloway' rel='external nofollow' class='url'>Jon Galloway</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148553">
			March 1, 2004 at 10:15 am</a>		</div>

		<p>This is an overwhelming argument for why Windows needs to be able to support 16 bit legacy apps. Great explanation.</p>
<p>Could the 16 bit support be optional at some point, though? Either a separate Windows Component (like IIS or MSMQ), or as a separate edition of Windows (like Media Center or Data Center Editions)? </p>
<p>I know I&#8217;m going to look dumb for asking, but that&#8217;s never stopped me before. I realize componentizing legacy support (jusk run the Add / Remove Thunking Wizard&#8230;) is not at all trivial, but at some point we need to move forward, right?</p>
<p>And on another note &#8211; is SysWOW64 an awful name for the 64 bit Windows on Windows system, or is it just me? I realize Joe User shouldn&#8217;t have to dig through his system directories, but that name is just plain silly. &quot;No, Mom, like sis&#8230; wow&#8230; 64&#8230; no, that&#8217;s wow&#8230; no, no, Mom, I&#8217;ll e-mail it to you.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148583">
				<div id="div-comment-148583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reuben Harris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148583">
			March 1, 2004 at 10:24 am</a>		</div>

		<p>Speaking of Win64, isn&#8217;t it delightfully head-explodey that %SystemRoot%SYSWOW64 is the home of OS 32-bit binaries and %SystemRoot%SYSTEM32 is the home of OS 64-bit binaries?</p>
<p>Backwards compatability sucks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148603">
				<div id="div-comment-148603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148603">
			March 1, 2004 at 10:41 am</a>		</div>

		<p>&quot;delightfully head-explodey&quot;.</p>
<p>Wow.  I like that phrase a lot.</p>
<p>I&#8217;m guessing you also spent too much time on &quot;Lemmings&quot; a few years back :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148613">
				<div id="div-comment-148613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">(6)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148613">
			March 1, 2004 at 10:46 am</a>		</div>

		<p>In a similar line to Jon&#8217;s comment, could Microsoft not use their Virtual PC technology to internally sandbox Win16 applications (essentially shipping an earlier subsystem with future versions of Windows)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148623">
				<div id="div-comment-148623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148623">
			March 1, 2004 at 10:49 am</a>		</div>

		<p>Sure you can sandbox them, but then they wouldn&#8217;t interoperate with Win32 programs.</p>
<p>E.g., document type &quot;.lwd&quot; is associated with a 16-bit program called &quot;Litware Deluxe&quot; via DDE. You go to Explorer and double-click a .lwd file and&#8230; um&#8230; a new VM opens up and Windows 3.1 starts up inside the VM and then Litware Deluxe is started. And then Explorer says &quot;Okay, let&#8217;s do some DDE&quot; and tries to send a message to that copy of Litware Deluxe that&#8217;s running in the VM&#8230; How do you EnumWindows across VMs and make sure the window handles are unique?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148633">
				<div id="div-comment-148633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148633">
			March 1, 2004 at 11:21 am</a>		</div>

		<p>If I remember correctly, x86-64 does not support 16-bit VMs under a 64-bit OS. Does Windows for x86-64 have an x86 emulator for running Win16 programs, or will this be added in a later version, or will customers have to choose between Win16 and Win64 programs?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148643">
				<div id="div-comment-148643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148643">
			March 1, 2004 at 11:26 am</a>		</div>

		<p>I&#8217;ve yet to stay in a hotel where their reception doesn&#8217;t have some DOS application on their computer screens.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148653">
				<div id="div-comment-148653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148653">
			March 1, 2004 at 11:42 am</a>		</div>

		<p>Reuben Harris: you forgot to mention the %SYSTEMROOT%SYSTEM folder for 16-bit stuff :) Nice confusing names for the folders.</p>
<p>Raymond, do you know if the reason for this foldername-mess is because of just stupid programs (hardcoded to system32 instead of using eg. SHGetFolderLocation with CSIDL_SYSTEM), or is it another reason?</p>
<p>I guess the SYSWOW64 folder really should be called SYSW32OW64, but that name is &gt; 8 characters(seems like Windows prefers 8.3 paths for kernel-stuff etc&#8230; at least, I can&#8217;t see any such dll/exe in %SYSTEMROOT%). And since there isn&#8217;t any SYSW16OW64 there isn&#8217;t any need for the &#8217;32&#8217; part anyways :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148663">
				<div id="div-comment-148663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148663">
			March 1, 2004 at 11:59 am</a>		</div>

		<p>Ben: You have to choose between Win64 and Win16.</p>
<p>Andreas: Yup, the confusing naming is for compatibility. Lots of people hardcode &quot;system32&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148673">
				<div id="div-comment-148673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RichB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148673">
			March 1, 2004 at 12:01 pm</a>		</div>

		<p>If an application at a company relies on Win16, why not sell them Windows 3.1?</p>
<p>If an application at a company relies on DOS, why not sell them DOS6?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148693">
				<div id="div-comment-148693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sam Carter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148693">
			March 1, 2004 at 12:10 pm</a>		</div>

		<p>Because they already paid for Win3.1 and DOS, and MS (like all software companies) can&#8217;t make money  unless they ship new code.  People aren&#8217;t going to pay for old code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148703">
				<div id="div-comment-148703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148703">
			March 1, 2004 at 12:11 pm</a>		</div>

		<p>Because they also rely on other programs that don&#8217;t run on DOS or Windows 3.1 (e.g., they use Office XP for writing proposals).  They need an OS that runs both Office XP *and* their LOB programs.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148713">
				<div id="div-comment-148713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mikedimmick.blogspot.com' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148713">
			March 1, 2004 at 12:57 pm</a>		</div>

		<p>Manual trackback: <a target="_new" href="http://mikedimmick.blogspot.com/2004_03_01_mikedimmick_archive.html#107817459629776377" rel="nofollow">http://mikedimmick.blogspot.com/2004_03_01_mikedimmick_archive.html#107817459629776377</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148723">
				<div id="div-comment-148723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Weiss</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148723">
			March 1, 2004 at 1:11 pm</a>		</div>

		<p>Not that Microsofts&#8217;s SCM and defect tracking systems are 16-bit, right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148733">
				<div id="div-comment-148733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148733">
			March 1, 2004 at 1:19 pm</a>		</div>

		<p>Right, I was using those as examples of LOB software, not as examples of 16-bit software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148743">
				<div id="div-comment-148743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.4guysfromrolla.com/ScottMitchell.shtml' rel='external nofollow' class='url'>Scott Mitchell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148743">
			March 1, 2004 at 1:26 pm</a>		</div>

		<p>****************************<br />
<br />Real example: Just this past weekend I was visiting a friend who lived in a very nice, professionally-managed apartment complex. We had occasion to go to the office, and I caught a glimpse of their computer screen. The operating system was Windows XP. And the program they were running to do their apartment management? It was running in a DOS box.<br />
<br />****************************</p>
<p>Real example of my own: my lawyer uses WinXP, but writes his documents using some ancient WordPerfect program through DOS.  No mouse support, no WYSIWYG.  But, damn, he can create a document very fast, knows all the keyboard commands, etc., etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148753">
				<div id="div-comment-148753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.rotd.org/' rel='external nofollow' class='url'>Andreas Magnusson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148753">
			March 1, 2004 at 1:28 pm</a>		</div>

		<p>I don&#8217;t quite understand; it&#8217;s (some of) the 32-bit apps that hardcode &quot;system32&quot;, don&#8217;t they want the 32-bit binaries?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148763">
				<div id="div-comment-148763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148763">
			March 1, 2004 at 1:35 pm</a>		</div>

		<p>It turns out they usually don&#8217;t! A 32-bit program that builds the path &quot;C:WindowsSystem32control.exe&quot; probably wants the 64-bit control panel, for example.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148783">
				<div id="div-comment-148783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">russ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148783">
			March 1, 2004 at 2:46 pm</a>		</div>

		<p>But wait, how can they really be with us?  Can people still buy computers with Win16 on them?  I thought MS EOL&#8217;d Win3.x long ago?  Win95/98 are having a hard enough time staying on MS&#8217; support infrastructure and tools radar, I don&#8217;t see this argument about &quot;us having to deal with win16&quot;.  Unless a developer kept that dusty VC 1.5.1 CD that came with their visual studio 2.x, I don&#8217;t even see how somebody could still write something that would run on Win16.</p>
<p>This whole 16bit legacy thing seems to be more of an issue for MS&#8217; operating systems _sales_ dept. more than technically related.  Due to those LOB apps on critical paths and being entrenched, MS can&#8217;t make headway in getting them to buy new licenses.</p>
<p>Win32 came from Win16.  That to me is the reason (and only reason) we still &quot;deal&quot; with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148793">
				<div id="div-comment-148793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/jgalloway' rel='external nofollow' class='url'>Jon Galloway</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148793">
			March 1, 2004 at 3:06 pm</a>		</div>

		<p>What about the ideas I mentioned with separating out 16 bit support, either as (1) a Windows Component or (2) a separate Windows Edition?</p>
<p>Both are likely expensive &#8211; (1) more upfront, and (2) from a support point of view. But it&#8217;s got to happen some time, right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148803">
				<div id="div-comment-148803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148803">
			March 1, 2004 at 3:23 pm</a>		</div>

		<p>That means, that the next 5 Windows versions will support apps based on Win32 API and there is no need for learning .NET? :o)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148813">
				<div id="div-comment-148813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://andrew75@gmx.de' rel='external nofollow' class='url'>Andrew75</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148813">
			March 1, 2004 at 3:27 pm</a>		</div>

		<p>Great explanation, but I&#8217;d be very interested to know how much of a performance boost I would get if my Windows 2000/XP was stripped of its 16 bit abilities </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148823">
				<div id="div-comment-148823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Carmen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148823">
			March 1, 2004 at 3:47 pm</a>		</div>

		<p>Andrew75: None.  16bit DOS/Win16 is implemented in a subsystem that only exists when you run 16bit applications. In fact, they&#8217;re implemented in 32bit code, designed to emulate the 16bit environment.  Every version of NT has been 100% 32bit except for the small bit of compatibility code in those subsystems. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148833">
				<div id="div-comment-148833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148833">
			March 1, 2004 at 4:34 pm</a>		</div>

		<p>I assume it&#8217;s possible to ship the Win16 compatibility (&quot;Windows on Win32&quot;) separately, for example like Windows Services for UNIX.</p>
<p>However _most_ people would have to (download?) and install it separately then. Lot&#8217;s of Win32 applications uses 16-bit installers for example&#8230;</p>
<p>Andrew75: You could try to remove the WOW by removing/changing values under this registry key: HKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlWOW<br />
<br />The registry values under this key is described in KB102986 (see also KB105992). But, as Carmen already said, this will not affect the performance of your system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148853">
				<div id="div-comment-148853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tommyblogs.com/' rel='external nofollow' class='url'>Tommy Williams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148853">
			March 1, 2004 at 5:04 pm</a>		</div>

		<p>In the example about a company running a line-of-business app without source code (so that they couldn&#8217;t port if they wanted to), I would consider that a *huge* risk for the company. In that situation &#8212; especially if the LOB app is critical &#8212; I would think they would be desperate to migrate to code they own and know just to manage the risk.</p>
<p>And yet I know it doesn&#8217;t work that way. Why?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148863">
				<div id="div-comment-148863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148863">
			March 1, 2004 at 5:14 pm</a>		</div>

		<p>Regarding the base note, I don&#8217;t code much 16-bit stuff (I was using 32-bit computers before Microsoft ever existed) but I do use a, um, bit of it.  For example, Microsoft always warns how dangerous it is to use Regedit.  Notice how much safer it is to edit an .ini file.  I do use things like GetPrivateProfileInt and WritePrivateProfileString.  Of course I abhor the inadequate error checking built-in to GetPrivateProfileInt, but it doesn&#8217;t seem to be a problem, because customers who edit their .ini files don&#8217;t seem to mind fixing their editing errors.</p>
<p>3/1/2004 1:35 PM Raymond Chen:</p>
<p>&gt; A 32-bit program that builds the path<br />
<br />&gt; &quot;C:WindowsSystem32control.exe&quot;</p>
<p>is enormously badly broken and shouldn&#8217;t be allowed to run.</p>
<p>Usually I avoid putting an OS on drive C because it would get smashed when I install badly broken applications or drivers in OSes on other partitions.  It is safer to use ONLY other partitions for OSes.</p>
<p>But then there are these neat little recovery CDs from some vendors, when I buy a new machine and have to pay for yet another unwanted copy of an OS, and the vendor refuses to warranty their hardware unless I reinstall their recovery version on C.  Fortunately they don&#8217;t seem to mind the repartitioning and the installation of OSes from MSDN etc. on partitions other than C.  But then I don&#8217;t get to notice when a buggy application created C:Windows or C:Progra~1.</p>
<p>3/1/2004 2:46 PM russ:</p>
<p>&gt; Unless a developer kept that dusty VC 1.5.1<br />
<br />&gt; CD that came with their visual studio 2.x,</p>
<p>And with MSDN.  (It used to be on the FrontPage CD but has moved to a more sensible place.)  As mentioned, I don&#8217;t code much 16-bit stuff, but about 2 years ago I did for an embedded system.  Of course Longhorn or XP weren&#8217;t an issue for that.  (Yeah I know, XP could theoretically be an issue for an embedded system.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148873">
				<div id="div-comment-148873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148873">
			March 1, 2004 at 6:15 pm</a>		</div>

		<p>The danger in editing the registry is not inherent in the structure of the registry. GetPrivateProfileXxx is extremely dangerous on Win9x where a lot of critical system configuration information is kept in INI files.  Editing your system.ini file incorrectly can render your Win9x machine unbootable.</p>
<p>The danger is in what the database is used for, not in the technicals of how the database is represented.</p>
<p>What would be your alternative to building a path to (say) control.exe?  Surely you don&#8217;t want to use SearchPath or you become subject to current directory security bugs!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148843">
				<div id="div-comment-148843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.dotnetwizards.org/mastermaq/archive/2004/03/01/180.aspx' rel='external nofollow' class='url'>MasterMaq.NET</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148843">
			March 1, 2004 at 7:41 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148893">
				<div id="div-comment-148893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shane King</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148893">
			March 1, 2004 at 7:56 pm</a>		</div>

		<p>&quot;What would be your alternative to building a path to (say) control.exe?&quot;</p>
<p>The only one I can think of is to remove the ability to reference your system32 directory through a path (such as c:winntsystem32), and instead only allow it to be accessed via a symbolic name (eg %SYSTEM32%).</p>
<p>Of course, the horse has bolted on that one, and you have to leave it accessable for backwards compatability reasons now!</p>
<p>&quot;Surely you don&#8217;t want to use SearchPath or you become subject to current directory security bugs!&quot;</p>
<p>Well, cmd.exe still executes whatever is in the current directory before searching the path. Yeah I know, backwards compatability. But surely security should come first.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148913">
				<div id="div-comment-148913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.open-node.net' rel='external nofollow' class='url'>Mike Kolitz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148913">
			March 1, 2004 at 8:28 pm</a>		</div>

		<p>Raymond, thanks for the feedback :)</p>
<p>I can see your point about using the VM technology in Virtual PC to handle the 16-bit compat, but what are your feelings on making  the 16-bit compat layers optional components.  Assuming they&#8217;ll need to be removed someday anyway, wouldn&#8217;t making them a component now save work down the road?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148923">
				<div id="div-comment-148923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sven G. Ali</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148923">
			March 1, 2004 at 8:43 pm</a>		</div>

		<p>&quot;What would be your alternative to building a path to (say) control.exe?&quot;</p>
<p>Why that&#8217;s easy. Use shell automation to open a window on the path &quot;::{21EC2020-3AEA-1069-A2DD-08002B30309D}&quot;.</p>
<p>;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148883">
				<div id="div-comment-148883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://open-node.net/archive/2004/03/01/237.aspx' rel='external nofollow' class='url'>Open-node.net</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148883">
			March 1, 2004 at 9:25 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148933">
				<div id="div-comment-148933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148933">
			March 1, 2004 at 9:57 pm</a>		</div>

		<p>&gt; 3/1/2004 6:15 PM Raymond Chen<br />
<br />&gt; The danger in editing the registry is not<br />
<br />&gt; inherent in the structure of the registry.</p>
<p>That&#8217;s a little bit debatable.  Whether it&#8217;s inherent in the Regedit command itself is also a little bit debatable, except for one famous exception.  Nonetheless your employer always warns about its danger.</p>
<p>&gt; GetPrivateProfileXxx is extremely dangerous<br />
<br />&gt; on Win9x where a lot of critical system<br />
<br />&gt; configuration information is kept in INI<br />
<br />&gt; files.</p>
<p>Please enlighten me.</p>
<p>&gt; Editing your system.ini file incorrectly can<br />
<br />&gt; render your Win9x machine unbootable.</p>
<p>Yes, but GetPrivateProfileXxx is reading, and both GetPrivateProfileXxx and WritePrivateProfileXxx are writing to named .ini files.  The purpose of private profiles was to avoid contaminating system.ini, right?  They continue to be valuable in making it possible to avoid Regedit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148943">
				<div id="div-comment-148943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148943">
			March 1, 2004 at 10:08 pm</a>		</div>

		<p>Even in Windows 1.0 there was a way to get the path to the system directory (GetSystemDirectory); just nobody used it.  And given the state of technology back then, it wasn&#8217;t feasible to say &quot;Sorry, but this directory you can&#8217;t access unless you go through me.&quot; Windows programs still used int 21h to talk directly to DOS.</p>
<p>And would that fly even today? Suppose there was a new rule: &quot;Programs written in WinFX cannot access the system32 directory directly.&quot; Would you cry foul?</p>
<p>On the subject of system.ini and win16: Basically, system.ini was the win16 version of HKLMSystem. That&#8217;s where drivers came from. That&#8217;s where driver configuration settings came from. Mess with that file and you can render your system unbootable the same way that messing with HKLMSystem will do.</p>
<p>Whether the config info is in the registry or ini files &#8211; the point is, &quot;Don&#8217;t change it unless you really know what you&#8217;re doing.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148903">
				<div id="div-comment-148903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://open-node.net/archive/0001/01/01/237.aspx' rel='external nofollow' class='url'>Open-node.net</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148903">
			March 1, 2004 at 11:22 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148963">
				<div id="div-comment-148963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Johnson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148963">
			March 2, 2004 at 12:26 am</a>		</div>

		<p>Imagine if somebody took away your current editor and gave you a new one with different keybindings. &quot;But the new one is better.&quot;) </p>
<p>&#8212;</p>
<p>I still use Brief for OS/2 as my &quot;IDE&quot; of choice ;) You might as well break all the fingers on my hands if that ever stopped working&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148973">
				<div id="div-comment-148973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jpayne@NOSPAM.serif.com' rel='external nofollow' class='url'>Jonathan Payne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148973">
			March 2, 2004 at 12:38 am</a>		</div>

		<p>As another example, the app I work on has some 16 bit components.  Long ago, when OLE was the in thing, some small OLE apps were written for the application.  The features in these apps have been replaced by code in the main 32 bit application but we still have to keep around these old applications to load old documents and so old documents draw in the same way.  While it might be possible to write code to read in the data these old apps wrote out and replace the objects they created with 32 bit versions, it would be a lot of work for very little gain.  Of course they might stop working on 64 bit Windows but hopefully by the time our users start using 64 bit systems, there won&#8217;t be many documents with the old objects any more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148983">
				<div id="div-comment-148983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://kreiger.linuxgods.com/' rel='external nofollow' class='url'>Christoffer &quot;Kreiger&quot; Hammarstr&#246;m</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148983">
			March 2, 2004 at 12:58 am</a>		</div>

		<p>I&#8217;m stricken by how much an overwhelming argument this article is for free software / open source.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148993">
				<div id="div-comment-148993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148993">
			March 2, 2004 at 1:06 am</a>		</div>

		<p>How so?  Why would a financial services company open-source their top-secret trend prediction software?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148953">
				<div id="div-comment-148953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://arcterex.net/blog/archives/2004/03/01/why_16_bit.html' rel='external nofollow' class='url'>The ArcterJournal</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-148953">
			March 2, 2004 at 1:43 am</a>		</div>

		<p>Raymond asked Why 16-bit DOS and Windows are still with us, and Mike answered. This is something I&#8217;ve thought about&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149013">
				<div id="div-comment-149013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Robinson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149013">
			March 2, 2004 at 2:26 am</a>		</div>

		<p>Mike: OS/2 app _have_ stopped working, as of Windows XP &#8212; os2ss and psxss have been removed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149023">
				<div id="div-comment-149023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mikedimmick.blogspot.com' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149023">
			March 2, 2004 at 2:55 am</a>		</div>

		<p>The registry has a bad reputation in the OSS world, mainly due to Windows 9x&#8217;s relatively poor implementation, which didn&#8217;t offer much protection against hardware faults, system crashes and power loss. The registry could be saved back in an inconsistent state.</p>
<p>Windows NT&#8217;s implementation is journalled (separately from the file system; remember that NTFS only protects its own metadata, not your data, and that NT also has to work on FAT file systems), but is still susceptible to hardware faults. Some parts of the system configuration data are edited by the system as it boots up (particularly the write of Last Known Good and hardware detection) and this can, on rare occasions, cause an inconsistent registry to be written back to disk.</p>
<p>It&#8217;s easier to write the usual disclaimer in a KB article than to say that the _act_ of editing the registry isn&#8217;t liable to cause any harm on its own, but writing incorrect values or deleting keys that the system depends on can cause it never to boot again. This is like deleting or misconfiguring your /etc/inittab or /etc/rc.d on a UNIX system. Get it wrong and you&#8217;ll be booting from a recovery disk or reinstalling your system.</p>
<p>The registry also has the advantage of being _fast_. Try reading initialisation information from a text file quickly enough to generate a context menu on the fly &#8211; after all, that&#8217;s what Explorer does with the registry. The Send To menu is noticeably slower than the parent context menu &#8211; it reads the file system.</p>
<p>I don&#8217;t believe I&#8217;ve ever suffered from registry corruption in over ten years of using the registry, from Windows 3.1&#8217;s minor implementation for OLE right through to Windows XP. This could be because my hardware has been reliable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149033">
				<div id="div-comment-149033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shane King</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149033">
			March 2, 2004 at 4:19 am</a>		</div>

		<p>The first edition of Windows 95 broke its own registry on an all too regular basis. Since then it&#8217;s been solid though. I agree the registry gets a bad reputation for reasons that aren&#8217;t grounded in fact.</p>
<p>It concerns me a lot more that the values in the registry aren&#8217;t always documented well than the implementation. I know regular users aren&#8217;t supposed to touch the registry directly, but there&#8217;s a ton of infomation scattered across various microsoft sites telling you how you can tweak such and such a value to achieve some effect. Surely this should all be documented in a central location.</p>
<p>Additionally, it would be nice if there were better tools for repairing your own registry if you do manage to break it. I think that&#8217;s part of where the complaints come from. It&#8217;s simple to fix a text config file on a UNIX system if you add a bad value &#8211; boot up from a CD and use any text editor. Unfortunately, Windows doesn&#8217;t come with anywhere near as nice a recovery environment. It would be wonderful if the next version of windows came with a bootable mini-install on CD, that at least let you run the basic programs one might want to use to recover a system (such as regedit!).</p>
<p>I&#8217;m not holding my breath. :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149053">
				<div id="div-comment-149053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149053">
			March 2, 2004 at 6:04 am</a>		</div>

		<p>Windows does come with a very nice recovery environment &#8211; the recovery console. Boot up the Windows XP CD and choose &#8216;R&#8217; to start it&#8230; See the document at <a target="_new" href="http://www.microsoft.com/windows2000/techinfo/administration/management/safemode.asp" rel="nofollow">http://www.microsoft.com/windows2000/techinfo/administration/management/safemode.asp</a> for more information about it.</p>
<p>But there is (at least) one utility which is missing there &#8211; the reg.exe utility which lets you edit the registry from the console. Why isn&#8217;t this utility supported? :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149223">
				<div id="div-comment-149223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149223">
			March 2, 2004 at 1:41 pm</a>		</div>

		<p>One thing I&#8217;d like to see in the recovery console is a text editor. The ability to tweak my boot.ini (because SP3 ate my install) would be nice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149243">
				<div id="div-comment-149243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149243">
			March 2, 2004 at 3:36 pm</a>		</div>

		<p>Cooney: yeah, that&#8217;s another useful thing they missed.</p>
<p>But.. there isn&#8217;t any decent console-based texteditor in Windows :( so I&#8217;d like to see it both in the RC and in normal use. Something like vi or similar&#8230; and please not edlin ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149263">
				<div id="div-comment-149263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149263">
			March 2, 2004 at 5:20 pm</a>		</div>

		<p>3/1/2004 10:08 PM Raymond Chen:</p>
<p>&gt; On the subject of system.ini and win16:<br />
<br />&gt; Basically, system.ini was the win16 version<br />
<br />&gt; of HKLMSystem.</p>
<p>No kidding.  That&#8217;s why I&#8217;ve said (twice) that I call functions of the sort GetPrivateProfileXxx not GetProfileXxx, and reminded you that GetPrivateProfileXxx uses a named .ini file.  Perhaps I should further add that the named .ini file, in addition to not being system.ini, is not even in a system directory.  (Though in cases where I let a caller specify a filename, it could potentially be named system.ini and/or be located in a system directory.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149283">
				<div id="div-comment-149283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149283">
			March 2, 2004 at 5:48 pm</a>		</div>

		<p>GetProfileXxx reads from win.ini.  To access system.ini you had to use GetPrivateProfileXxx and pass &quot;system.ini&quot;.</p>
<p>Note also that you can&#8217;t store unicode data into INI files. (Well, you could convert it to binary, I guess, but that sort of ruins the readability.)</p>
<p>And of course if the INI file is recording per-user data, make sure to store it in the user profile and not in a shared location.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149353">
				<div id="div-comment-149353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149353">
			March 2, 2004 at 6:44 pm</a>		</div>

		<p>OK, whichever system file is accessed by GetProfileXxx, I DO NOT USE GetProfileXxx.  And when I use GetPrivateProfileXxx, I SPECIFY A FILENAME which is a private file, not system.ini, not win.ini, not even in a system directory (except that if I am allowing a caller to specify a filename then they are allowed to name a dangerous one).</p>
<p>My .ini files do not record per-user data (unless the customer arranges their data that way).  If I&#8217;m coding an application, the customer generally wants the administrator to set options once and have the application use them without interference from the operator, so I put the .ini file in the same directory as the .exe (unless otherwise asked).  If I&#8217;m coding a DLL then the customer or the customer&#8217;s other contractor gets to decide where the .ini file goes.  In both cases, customers have not wanted the administrator to use Regedit for it.</p>
<p>I suppose you could say that a separate program should be written to store options which an administrator selects for each program.  Well, one way is for a separate program to be Notepad and then we have .ini files.  One way is for a separate program to be Regedit and use the registry.  One way is to write a separate administration program for each separate application, but that has not been proposed by anybody.  Customers want to use Notepad and .ini files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149373">
				<div id="div-comment-149373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149373">
			March 2, 2004 at 6:50 pm</a>		</div>

		<p>If you want to use INI files then more power to you. Just be aware of their limitations. (For example, they&#8217;re slower since the file is loaded and parsed each time you call GetPrivateProfileXxx, and you can&#8217;t store unicode data there, and binary data is pretty clumsy, and woe unto you if two threads try to write to the same INI file simultaneously.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149393">
				<div id="div-comment-149393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149393">
			March 2, 2004 at 7:39 pm</a>		</div>

		<p>Yes the .ini file is loaded and parsed several times for each time the .exe file is loaded and executed.  I infer that the registry might only be loaded once, but reading a 1KB file 10 times is faster than reading a 3MB file 1 time.  9 out of 10 times it&#8217;s probably still in the disk driver&#8217;s cache too.</p>
<p>Yes strings have to be stored in the code page used by the customer&#8217;s Windows product and administrator and operators.</p>
<p>Yes binary data is clumsy, no negative values, and (as already discussed) no error checking.</p>
<p>Of course if the administrator has two Notepad windows open at and tries to write the same .ini file from both of them at the same time then there might be corruption.  Hmmm, I did say I use WritePrivateProfileString, so I really deserved your comment about two threads.  Actually I only recall using it during debugging.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149423">
				<div id="div-comment-149423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shane King</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149423">
			March 2, 2004 at 8:48 pm</a>		</div>

		<p>&quot;Windows does come with a very nice recovery environment&quot;</p>
<p>It comes with it, but it is in no waay, shape or form &quot;very nice&quot;, especially when compared to the competition. Some Linux distros can boot into a full blown GUI with web browser, mail, etc all off a CD.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149463">
				<div id="div-comment-149463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frederik Slijkerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149463">
			March 3, 2004 at 5:11 am</a>		</div>

		<p>&quot;so I put the .ini file in the same directory as the .exe (unless otherwise asked)&quot;</p>
<p>And therefore your application can never run with normal user level privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149693">
				<div id="div-comment-149693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149693">
			March 3, 2004 at 2:31 pm</a>		</div>

		<p>&gt; Note also that you can&#8217;t store unicode data into INI files.</p>
<p>Actually, you can. Write a Unicode BOM (byte order mark) to the beginning of an .ini file, and voila &#8211; you have a Unicode .ini file.</p>
<p>I&#8217;ve never actually seen someone use that technique, but it does work&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149713">
				<div id="div-comment-149713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149713">
			March 3, 2004 at 2:47 pm</a>		</div>

		<p>True, you can do that, but nobody does as far as I know, and it requires you to use a unicode-enabled editor to edit your ini files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149743">
				<div id="div-comment-149743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-149743">
			March 3, 2004 at 5:09 pm</a>		</div>

		<p>3/3/2004 5:11 AM Frederik Slijkerman:</p>
<p>&gt;&gt; &quot;so I put the .ini file in the same<br />
<br />&gt;&gt; directory as the .exe (unless otherwise<br />
<br />&gt;&gt; asked)&quot;<br />
<br />&gt;<br />
<br />&gt; And therefore your application can never run<br />
<br />&gt; with normal user level privileges.</p>
<p>But somehow it does.  As already mentioned, when the customer wants to change the configuration, the administrator uses Notepad to edit the .ini file.  When operators use the product, it seems to have no trouble reading the .ini file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150373">
				<div id="div-comment-150373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-150373">
			March 4, 2004 at 1:54 pm</a>		</div>

		<p>This is why we have the concept of &quot;Sub Systems&quot; on NT and later. We have POSIX and OS2 subsystems etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151503">
				<div id="div-comment-151503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ed</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-151503">
			March 7, 2004 at 2:20 am</a>		</div>

		<p>&gt;And like Microsoft&#8217;s defect tracking system and &gt;source control system, many of the LOB &gt;applications at major corporations are not &gt;commercial-available</p>
<p>Isn&#8217;t Microsoft on Perforce?  That&#8217;s commercially available.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-153593">
				<div id="div-comment-153593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/joshwil/archive/2004/03/11/88280.aspx' rel='external nofollow' class='url'>Josh Williams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-153593">
			March 11, 2004 at 7:12 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-153603">
				<div id="div-comment-153603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/joshwil/archive/0001/01/01/88280.aspx' rel='external nofollow' class='url'>Josh Williams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-153603">
			March 11, 2004 at 7:12 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-157453">
				<div id="div-comment-157453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://esl.jrc.it/envind/dashbrds.htm' rel='external nofollow' class='url'>Jochen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-157453">
			March 25, 2004 at 6:49 am</a>		</div>

		<p>One more reason why WOW is still there is that some old folks like me love to write their stuff with languages that do not produce bloatware, and are incredibly comfortable to use &#8211; like GFA Basic, which was used to write the dashboard at <a target="_new" href="http://esl.jrc.it/envind/dashbrds.htm" rel="nofollow">http://esl.jrc.it/envind/dashbrds.htm</a></p>
<p>The wowexec also offers a somehow &quot;protected&quot; environment: its behaviour won&#8217;t change with the next Windows version.</p>
<p>By the way: is there an elegant way to get the original index of an item from a listbox with LBS_SORT style?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-177733">
				<div id="div-comment-177733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://michaeleatonconsulting.com/blog/archive/2004/05/26/171.aspx' rel='external nofollow' class='url'>the blog of michael eaton</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-177733">
			May 26, 2004 at 4:56 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-199183">
				<div id="div-comment-199183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-199183">
			July 28, 2004 at 9:32 am</a>		</div>

		<p>Commenting closes after two weeks.</p>
<p><a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-201423">
				<div id="div-comment-201423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/08/05/209019.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-201423">
			August 5, 2004 at 12:10 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-714453">
				<div id="div-comment-714453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://castalie.comoj.com/?p=248' rel='external nofollow' class='url'>Myths on Windows | Castalie....^_^</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040301-00/?p=40453#comment-714453">
			March 9, 2009 at 12:18 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://castalie.comoj.com/?p=248" rel="nofollow">http://castalie.comoj.com/?p=248</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>