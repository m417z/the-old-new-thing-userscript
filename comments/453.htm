<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (18)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1139823">
				<div id="div-comment-1139823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1139823">
			July 21, 2014 at 7:35 am</a>		</div>

		<p>If there is no SourceURL, there is the possibility that the copying program put a &lt;BASE&gt; element in the HTML that you can use for a source.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-koldude odd alt thread-odd thread-alt depth-1" id="comment-1139843">
				<div id="div-comment-1139843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1139843">
			July 21, 2014 at 7:46 am</a>		</div>

		<p>I never cease to be amazed at the lack of just basic RAII helpers that are not provided with the windows SDK&#8230; even a basic clipboard that always ensure that GlobalUnlock is called would be useful</p>
<div class="post">[<em>Windows is a cross-language platform. It focuses on making things possible from any language. If you have a language that supports RAII, then you can add RAII wrappers around the core functionality. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1139953">
				<div id="div-comment-1139953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1139953">
			July 21, 2014 at 8:43 am</a>		</div>

		<p>Ah, so that&#39;s what OneNote is doing when it helpfully says what site you pasted in an HTML fragment from.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command odd alt thread-odd thread-alt depth-1" id="comment-1140103">
				<div id="div-comment-1140103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140103">
			July 21, 2014 at 10:40 am</a>		</div>

		<p>Wow! A C# example. What a sight for the sore eyes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman even thread-even depth-1" id="comment-1140113">
				<div id="div-comment-1140113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140113">
			July 21, 2014 at 10:45 am</a>		</div>

		<p>@FleetCommand: Your eyes are still sore from reading Raymond&#39;s Friday post and subsequent response?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140243">
				<div id="div-comment-1140243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140243">
			July 21, 2014 at 12:44 pm</a>		</div>

		<p>[then you can add RAII wrappers around the core functionality. -Raymond]</p>
<p>Following up:</p>
<p>template &lt;class T&gt; class GlobalMemoryRegion {</p>
<p> &nbsp; private:</p>
<p> &nbsp; &nbsp; &nbsp;HGLOBAL h;</p>
<p> &nbsp; &nbsp; &nbsp;T ptr;</p>
<p> &nbsp; public:</p>
<p> &nbsp; &nbsp; &nbsp;GlobalMemoryRegion(HGLOBAL hmem) : h(hmem) { ptr = (T)GlobalLock(h); }</p>
<p> &nbsp; &nbsp; &nbsp;~GlobalMemoryRegion() { GlobalUnlock(h); ptr = NULL; }</p>
<p> &nbsp; &nbsp; &nbsp;operator T () { return ptr; }</p>
<p> &nbsp; &nbsp; &nbsp;operator const T () const { return ptr; }</p>
<p>}</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1" id="comment-1140263">
				<div id="div-comment-1140263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140263">
			July 21, 2014 at 1:22 pm</a>		</div>

		<p>@Brian_EE: Not really, dear. I am not alien to personal attacks and assumption of bad faith. Once I gave a feedback to a collage professor that in an essay he has written for students, it is better for him to use a less formal language. Well, he downgraded the language to the level of street talk and literally added four F-words just to prove I am an idiot. Cost him his tenure review four years later. I just am mildly surprised what in my post hurt Raymond&#39;s feeling so much. I tried to be as courteous as possible. I myself welcome such input in my own blog. Damn, it helped me a lot too.</p>
<p>But I love C# and certainly welcome more use of it in this blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140343">
				<div id="div-comment-1140343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bill s</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140343">
			July 21, 2014 at 3:12 pm</a>		</div>

		<p>&lt;i&gt;Once I gave a feedback to a collage professor that in an essay he has written for students, it is better for him to use a less formal language. Well, he downgraded the language to the level of street talk and literally added four F-words just to prove I am an idiot. Cost him his tenure review four years later.&lt;/I&gt;</p>
<p>And you&#39;re, like, proud of this or something? Get a life, man.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140363">
				<div id="div-comment-1140363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140363">
			July 21, 2014 at 4:11 pm</a>		</div>

		<p>@bill s, it&#39;s about showing the point: if you take criticism to the ridicule, expose yourself to the ridicule, risk making yourself a figure of ridicule.</p>
<p>But comments to that post should be on that post, not here.</p>
<p>BTW, that John Doe, &quot;The longer version is much better.&quot;, it&#39;s not me, it&#39;s another John Doe.</p>
<p>You can too make GlobalLock/GlobalUnlock automatic in .NET with IDispose and C#&#39;s using statement.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140433">
				<div id="div-comment-1140433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140433">
			July 21, 2014 at 10:43 pm</a>		</div>

		<p>@Joshua</p>
<p>This code would cause more problems than it would solve.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140483">
				<div id="div-comment-1140483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140483">
			July 22, 2014 at 4:04 am</a>		</div>

		<p>This is the worst feature ever added and many M$ apps do it already. Past plain text instead of bloated formatted text junk which the user has to remove because it&#39;s wrong anyway. These &quot;features&quot; does NOT help anyone, it only makes peoples job harder to perform.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140513">
				<div id="div-comment-1140513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Katie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140513">
			July 22, 2014 at 6:03 am</a>		</div>

		<p>@640k</p>
<p>I appreciate the little bits that OneNote adds &#8211; it makes it easier to keep track of all the sources I&#39;ve used as I build up a binder worth of notes on a project. ~~~~</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-1140523">
				<div id="div-comment-1140523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140523">
			July 22, 2014 at 6:48 am</a>		</div>

		<p>Why does MSDN refer to it as CF_HTML? It is not a native clipboard format, if anything it should be called CFSTR_HTML&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com odd alt thread-odd thread-alt depth-1" id="comment-1140713">
				<div id="div-comment-1140713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140713">
			July 22, 2014 at 8:29 pm</a>		</div>

		<p>@640k Normally I&#39;d ask if you&#39;re 12&#8230; But I know you&#39;ve been reading this blog long enough that you aren&#39;t. Which means you&#39;re an adult human being who uses M$. Grow up.</p>
<p>I find the pasted from feature extremely useful when taking notes or snippets of passages that I want to source or remember where that information comes from. And I&#39;m extremely happy that Raymond gave a C# example for mimicking!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140763">
				<div id="div-comment-1140763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140763">
			July 23, 2014 at 7:11 am</a>		</div>

		<p>@skSdnW: probably for consistency with the system-provided clipboard formats. &nbsp;My guess is that it&#39;s a registered clipboard format. &nbsp;Once it&#39;s registered, there&#39;s little difference between it and a system-provided format, so why not use the established naming convention? &nbsp;What benefit(s) does the CFSTR_HTML name confer that CF_HTML doesn&#39;t? &nbsp;Imagine if they took your advice (way back when it was first conceived) and they called it CFSTR_HTML. &nbsp;Imagine the cries of geeks of a different stripe: &quot;Stupid Microsoft! &nbsp;I just want to use the HTML clipboard format. &nbsp;Why did they have to give it a different name?? &nbsp;Now I have to remember that the HTML format has a different name from all the others. &nbsp;Stupid Microsoft!!!1!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140993">
				<div id="div-comment-1140993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140993">
			July 23, 2014 at 2:49 pm</a>		</div>

		<p>@skSdnW: From what I can see, the CFSTR_* naming convention is for the Shell Clipboard formats: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb776902%28v=vs.85%29.aspx">msdn.microsoft.com/&#8230;/bb776902%28v=vs.85%29.aspx</a></p>
<p>The shell formats are used when copying Windows shell objects through the clipboard. &nbsp;CF_HTML, on the other hand, is for copying fragments of HTML to the clipboard. &nbsp;Sure, the shell could use CF_HTML, but so could any application that a) understands HTML and b) wants to share HTML with the clipboard. &nbsp;In other words, CF_HTML is a more general-purpose clipboard format. &nbsp;Why should it adhere to the naming convention of the shell clipboard formats when it has more in common with CF_TEXT?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-1140843">
				<div id="div-comment-1140843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1140843">
			July 23, 2014 at 9:42 am</a>		</div>

		<p>@morlamweb: For consistency it _should_ be named CFSTR_HTML! CF_* are number constants and are used by the older clipboard formats and you don&#39;t have to register them. CFSTR_* are strings and have to be registered before you can use them. Several are already defined by the shell headers (CFSTR_INETURL etc).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt thread-odd thread-alt depth-1" id="comment-1141043">
				<div id="div-comment-1141043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140721-00/?p=453#comment-1141043">
			July 24, 2014 at 2:40 am</a>		</div>

		<p>@morlamweb: So you are saying that CFSTR_INETURL is not a general-purpose clipboard format just because it is defined by a shell header? Most browsers will put both CFSTR_INETURL and CF_TEXT on the clipboard if you drag&amp;drop a link.</p>
<p>My point is, RegisterClipboardFormat(CF_*) is never valid and neither is GetClipboardData(CFSTR_*) so why should CF_HTML be so special?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>