<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-334683">
				<div id="div-comment-334683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">aon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334683">
			January 5, 2006 at 10:21 am</a>		</div>

		<p>Simply read HKCU/MIME/Database/RFC1766. Problem solved.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-334693">
				<div id="div-comment-334693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Derek</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334693">
			January 5, 2006 at 10:53 am</a>		</div>

		<p>Yes, because it&#8217;s always better to go delving into the registry than to use the documented API calls. . . .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-334743">
				<div id="div-comment-334743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334743">
			January 5, 2006 at 11:44 am</a>		</div>

		<p>Especially when that&#8217;s the wrong path. It should be HKLM/Software/Classes/MIME/Database/Rfc1766.</p>
<p>But yeah, use the APIs instead, even though it means more blasted COM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-334773">
				<div id="div-comment-334773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334773">
			January 5, 2006 at 1:05 pm</a>		</div>

		<p>Looks like you could also use Rfc1766ToLcid (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/mlang/reference/functions/rfc1766tolcid.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/mlang/reference/functions/rfc1766tolcid.asp</a>) and LcidToRfc1766 (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/mlang/reference/functions/rfc1766tolcid.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/mlang/reference/functions/rfc1766tolcid.asp</a>), functions exposed directly from mlang.dll.  Of course this requires IE 5.5 or newer, whereas IMultiLanguage is available from IE 4.0 onward.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-334783">
				<div id="div-comment-334783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334783">
			January 5, 2006 at 1:14 pm</a>		</div>

		<p>RFC 1766 is long obolete (replaced by rfc3066) &#8211; best conversion function to use is LCIDToLocaleName (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/intl/nls_LCIDToLocaleName.asp?frame=true" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/intl/nls_LCIDToLocaleName.asp?frame=true</a>).  This is base platform functionality rather than MLang.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-334793">
				<div id="div-comment-334793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334793">
			January 5, 2006 at 1:49 pm</a>		</div>

		<blockquote><p>
  best conversion function to use is LCIDToLocaleName </p>
<p>&#8230;except it doesn&#8217;t exist on any shipping version of Windows.</p>
<p>Windows NT/2000/XP/Vista: Included in Windows Vista and later.<br />
  <br />Windows 95/98/Me/NT/2000/XP: Unsupported.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-334803">
				<div id="div-comment-334803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">michkap</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334803">
			January 5, 2006 at 1:56 pm</a>		</div>

		<p>There are other problems with MLang though. I will blog about this tonight&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-334823">
				<div id="div-comment-334823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334823">
			January 5, 2006 at 2:41 pm</a>		</div>

		<p>How do you determine the character set of each code page?  For example, for code page 932?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-334843">
				<div id="div-comment-334843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">michkap</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334843">
			January 5, 2006 at 4:45 pm</a>		</div>

		<p>Hey Rob &#8212; Do you meant font charset? That would make a cool blog topic, too. :-)</p>
<p>If you mean the one you would use in web pages, that&#8217;s a bit harder.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-334863">
				<div id="div-comment-334863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334863">
			January 5, 2006 at 5:53 pm</a>		</div>

		<p>What I want to do is to display all the characters in a particular code page i.e. codepage 932 is japanese.  I want to gather all those characters and displays them using something like the following code snipplet.</p>
<p>SomeFunkyFunction(void)<br />
<br />{<br />
<br />   CString s, s1;</p>
<p>   for (int i = BEGIN; i &lt; END; i++)<br />
<br />   {<br />
<br />      // concatenate the character into string.<br />
<br />      s1.Format(_T(&quot;%c&quot;), i);<br />
<br />      s += s1;<br />
<br />   }<br />
<br />   return s;<br />
<br />}</p>
<p>// Any recommendations?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-334873">
				<div id="div-comment-334873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">michkap</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334873">
			January 5, 2006 at 6:07 pm</a>		</div>

		<p>You should put this in the suggestion box on my blog (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/michkap/482609.aspx" rel="nofollow">http://blogs.msdn.com/michkap/482609.aspx</a>)&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-334903">
				<div id="div-comment-334903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334903">
			January 5, 2006 at 7:40 pm</a>		</div>

		<p>Rob: HKEY_CLASSES_ROOTMIMEDatabaseCodepage for the codepage-to-charset conversion, and HKEY_CLASSES_ROOTMIMEDatabaseCharset for the reverse. There&#8217;s no API for it AFAIK</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-334913">
				<div id="div-comment-334913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334913">
			January 5, 2006 at 7:41 pm</a>		</div>

		<p>oh, nevermind</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-334933">
				<div id="div-comment-334933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-334933">
			January 5, 2006 at 8:08 pm</a>		</div>

		<p>Thursday, January 05, 2006 5:53 PM by Rob<br />
<br />&gt; all the characters in a particular code page<br />
<br />&gt; [&#8230;]<br />
<br />&gt; for (int i = BEGIN; i &lt; END; i++)<br />
<br />&gt; s1.Format(_T(&quot;%c&quot;), i);</p>
<p>I can&#8217;t find any spec for what happens when the value of i isn&#8217;t a valid character&#8217;s codepoint.</p>
<p>But there&#8217;s something else odd about this.  In a Unicode compilation, you won&#8217;t know what code page(s) contain the character that you&#8217;re dealing with in Unicode.  In an ANSI compilation, your %c format can only handle a single-byte character.  In an ANSI compilation you&#8217;ll have two problems.  One is the same as above, I can&#8217;t find any spec for what happens when the value of i isn&#8217;t a valid character&#8217;s codepoint (i.e. might just be the lead byte of a two-byte character, or might not be a valid lead byte of anything).  The other is that you never format any double-byte characters, so you miss most of the characters in the code page.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335023">
				<div id="div-comment-335023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-335023">
			January 6, 2006 at 11:27 am</a>		</div>

		<p>KJK::Hyperion,</p>
<p>How do you use those data?  Any idea?  They don&#8217;t really display the characters.  For the CharSet it only gives (Default) and AliasForCharset.  Any recommendation would be appreciated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335033">
				<div id="div-comment-335033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-335033">
			January 6, 2006 at 11:29 am</a>		</div>

		<p>Norman Diamond,</p>
<p>Yeah that&#8217;s the problem that i&#8217;m running into.  Deciphering the ranging and the getting the correct double for each individual codepage seems like a daunting task.  Any recommendation?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335303">
				<div id="div-comment-335303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">michkap</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060105-00/?p=32753#comment-335303">
			January 7, 2006 at 10:27 am</a>		</div>

		<p>Hi Rob &#8212;</p>
<p>I posted what I think is the easiest approach over in my blog (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/michkap/510411.aspx" rel="nofollow">http://blogs.msdn.com/michkap/510411.aspx</a>). The method covers all of the problems outlined in this thread (and several others, like best fit mappings).</p>
<p>Enjoy!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>