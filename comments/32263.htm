<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (133)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-346193">
				<div id="div-comment-346193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">..</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346193">
			February 16, 2006 at 10:08 am</a>		</div>

		<p>Wow! Can&#8217;t wait till the day my laptop will standby when flashing some rom or doing some delicate work. Here we have many program set to always deny standby because for our work the laptop must be always on (even when closed) and checking the settings on every pc is impratical.</p>
<p>Thanks to the person with the ball, who, as always, is imposing his view on every other like most dictators.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346203">
				<div id="div-comment-346203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.radixtwo.com/blog' rel='external nofollow' class='url'>Marty Thompson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346203">
			February 16, 2006 at 10:35 am</a>		</div>

		<p>What&#8217;s the difference it suspends(in Vista) or runs out of power(your way)? &nbsp;Either way you&#8217;re in danger.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346213">
				<div id="div-comment-346213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pazu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346213">
			February 16, 2006 at 10:49 am</a>		</div>

		<p>If there is possibility to disable the suspend-mode &#8211; what is a problem ?? Flashing of ROM &#8211; always risky &#8211; if there is no suspend and you do it on batteries, you can of course expect the worst ! So what next ? Nothing ? Good. Finally somebody in MSFT realised that OS has to imperative, othervise there is no security and stability.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346233">
				<div id="div-comment-346233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://msmvps.com/alunj' rel='external nofollow' class='url'>Alun Jones</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346233">
			February 16, 2006 at 11:28 am</a>		</div>

		<p>A lot of this would be helped if Microsoft made available (in documentation, not in fleeting presentations at PDC) statements on the philosophy of certain elements of the API.</p>
<p>I learned a long time ago that once you understood the philosophy behind an API, you found yourself programming with it, rather than against it, and programs are written far faster, smaller, and with less hassle. &nbsp;So, why is it that we have to divine the philosophy from trial and error?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346243">
				<div id="div-comment-346243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346243">
			February 16, 2006 at 11:30 am</a>		</div>

		<p>Can&#8217;t delay or suspend more than a few seconds&#8230;</p>
<p>But you do still get a power event notice, right? If so, I think this is a wise way to go.</p>
<p>You at least still know there&#8217;s a power event occuring, and have a few seconds to do whatever you need to do in order to handle it. If you chose to ignore it, and you get shutdown mid-process, you (the programmer) messed up and deserve to be berated by an irate user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346253">
				<div id="div-comment-346253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346253">
			February 16, 2006 at 11:33 am</a>		</div>

		<p>Why not requesting for the user advice when a window returns PWR_FAIL on WM_POWER message?<br />
<br />Something like:<br />
<br />&quot;The state of program &lt;executable-file-name&gt; may be altered when passing into low power mode. Are you sure you want to pass in low power?&quot;</p>
<p>Both behaviours :<br />
<br />rejecting blindlessly the WM_POWER operation without user&#8217;s advice, for a program.</p>
<p>Or</p>
<p>Rejecting blindlessly program advice &amp; user advice, for Windows.</p>
<p>Appear to be bad.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-346273">
				<div id="div-comment-346273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346273">
			February 16, 2006 at 11:54 am</a>		</div>

		<p>Oh&#8230; my&#8230; God.</p>
<p>How arrogant is this?</p>
<p>Give the user the option. &nbsp;Let the program say it wants to cancel the suspend, and have WINDOWS pop up a box:</p>
<p>[?] Cancel Suspend?<br />
<br />&lt;such-and-such program&gt; wants to cancel the suspend. &nbsp;Cancel the suspend?</p>
<p>[ Yes ] [ No ]<br />
<br />[ ] Remember my choice for this program</p>
<p>where the &quot;remember&quot; input is a checkbox.</p>
<p>Oh, and provide a means on the Power Options control panel to clear the &quot;remember&quot; memory.</p>
<p>If the guy with the ball won&#8217;t let anyone play, the neighborhood kids are likely to go get their own ball.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346283">
				<div id="div-comment-346283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346283">
			February 16, 2006 at 11:54 am</a>		</div>

		<p>Well, if it&#8217;s suspending because you closed your laptop, eg, all the user prompting in the world won&#8217;t help. &nbsp;You&#8217;re not gonna see any of it.</p>
<p>Of course you could have a timeout to some default behavior&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-346293">
				<div id="div-comment-346293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346293">
			February 16, 2006 at 11:56 am</a>		</div>

		<p>If the user doesn&#8217;t press &quot;Yes&quot; within a preset time, &quot;No&quot; should be the default action (similar to the &quot;End Now&quot; button when shutting down)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-346303">
				<div id="div-comment-346303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346303">
			February 16, 2006 at 11:59 am</a>		</div>

		<p>James Schend: It&#8217;s called the Application Verifier. Check it out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346313">
				<div id="div-comment-346313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">N. Coffey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346313">
			February 16, 2006 at 12:02 pm</a>		</div>

		<p>I think SuperKoko has the right idea, above. &nbsp;Don&#8217;t explicitly trust the programs, but at least take their advice. &nbsp;I&#8217;d pick a friendlier wording, though.</p>
<p>&quot;The program &#8216;AppName&#8217; may need attention before going into sleep mode. &nbsp;Please be sure any open files are saved, or exit the program if necessary. &nbsp;Sleep mode will continue anyway in [x] seconds.&quot;</p>
<p>Stuff in a &quot;Sleep Anyway&quot; button and a &quot;Cancel Sleep&quot; button (yeah, forget &quot;ok&quot; and &quot;cancel&quot;), and the hardest part becomes figuring out a good value for [x]. This allows programs to request attention, while still allowing sleep to continue (albeit slightly delayed) without further user intervention.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346323">
				<div id="div-comment-346323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Doug McClean</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346323">
			February 16, 2006 at 12:08 pm</a>		</div>

		<p>Why does the newer version of Office (I think it is Office XP?) stop you from shutting down windows when &quot;an office application is open&quot;? It got a notification that I want to shut down, clearly, to put up the dialog. Couldn&#8217;t it respond by saving my work and closing?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346333">
				<div id="div-comment-346333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thewalrus.org' rel='external nofollow' class='url'>Matt Sayler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346333">
			February 16, 2006 at 12:19 pm</a>		</div>

		<p>The issue of &quot;trust&quot; here reminds me a lot of the idea of cooperative multitasking. &nbsp;We trust you to cede your control to the OS at decent intervals..</p>
<p>In general, the way to deal with these issues seems to be work ok/give preference to apps that behave nicely, but be prepared to bring down the big stick on ones that don&#8217;t.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346353">
				<div id="div-comment-346353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">krisztian pinter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346353">
			February 16, 2006 at 12:28 pm</a>		</div>

		<p>very smart. replace a poor behaviour with a wrong one. if there really is a program that can not finalize itself in the given time, you actually punish the user for a wrong decision (e.g. forgetting about an ongoing task, like CD burning)</p>
<p>the right solution would be to give the program only two options: either accept, or demand a reject and supplying an explanation message. if windows receives a reject demand, it shows a dialog, and includes the explanation, then let the user to decide what to do.</p>
<p>if you do so, user have full control without being punished for mistakes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346363">
				<div id="div-comment-346363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346363">
			February 16, 2006 at 12:29 pm</a>		</div>

		<p>This is good stuff. &nbsp;My biggest complaint about computers is the constant second guessing . . . you said reboot, are you really sure? &nbsp;Do you really want to put the computer to sleep? &nbsp;Of course I do, I clicked the bloody button.</p>
<p>I just want a computer that when I tell it to hibernate, it actually hibernates.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346373">
				<div id="div-comment-346373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346373">
			February 16, 2006 at 12:32 pm</a>		</div>

		<p>The auto update functionality in XP is annoying. &nbsp;It likes to reboot your computer no matter what. &nbsp;This is extremely annoying if you happen to be away from your computer for a while, and come back to find out it has rebooted throwing away whatever you had going. &nbsp;(Things like command line history are valuable to me, in addition to open documents etc).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346383">
				<div id="div-comment-346383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346383">
			February 16, 2006 at 12:38 pm</a>		</div>

		<p>When you enabled automatic updates, you were asked whether you wanted reboots to be automatic or not. Say &quot;no&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346393">
				<div id="div-comment-346393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://boggyb.livejournal.com' rel='external nofollow' class='url'>Thomas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346393">
			February 16, 2006 at 12:42 pm</a>		</div>

		<p>Oddly enough, a while back I wrote a little utility in C to give me more control over things like this. It basically listens for the WM_POWER message, and then either cancels it, allows it, or prompts the user (defaulting to allow after 15 seconds) as to what to do, dependign on what the user chose earlier. It also does the same thing for shutdown, so I can happily stop those installers that assume a restart is always required, regardless of what actually went on in the install or what the user&#8217;s doing. Are there any plans to allow special-purpose utilities like that to still work as normal, or will this affect everything?</p>
<p>(on another note: the linked ppt (FUN319) has a typo on slide 45. It looks like the ES_SYSTEM_REQUIRED and ES_CONTINUOUS flags have been swapped)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346403">
				<div id="div-comment-346403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Darren Stone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346403">
			February 16, 2006 at 12:47 pm</a>		</div>

		<p>When a user shuts their laptop lid, the machine must suspend immediately. &nbsp;Period. &nbsp;No prompting or any other ridiculousness.</p>
<p>If a program is doing a risky operation, such as burning a ROM, it should ensure that the power profile is adequate before proceeding (e.g. ensuring that the machine doesn&#8217;t shutdown automatically from inactivity).</p>
<p>It&#8217;s simple. &nbsp;And it&#8217;s surprising that in 2006 the premier PC OS can&#8217;t handle this correctly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-346413">
				<div id="div-comment-346413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346413">
			February 16, 2006 at 12:49 pm</a>		</div>

		<p>&quot;&#8230; then let the user to decide what to do.&quot;</p>
<p>This assumes there&#8217;s a user there to answer the question. The laptop lid is closed. The user&#8217;s workstation is locked or switched-away-from.</p>
<p>Even if you manage to get the message into the user&#8217;s face, you get the &quot;I already told you&quot; problem. User initiates suspend. Application says, &quot;You are watching a movie. Do you want to suspend anyway?&quot; You say &quot;No&quot;. The system then says, &quot;Hey, this program cancelled the suspend. Do you want to suspend anyway?&quot; User says, &quot;Stupid computer. I already told you.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-346423">
				<div id="div-comment-346423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346423">
			February 16, 2006 at 12:53 pm</a>		</div>

		<p>Responses inline&#8230;</p>
<p>&gt; &quot;&#8230; then let the user to decide what to do.&quot;</p>
<p>&gt; This assumes there&#8217;s a user there to answer the question. The laptop lid is closed. The user&#8217;s workstation is locked or switched-away-from.</p>
<p>Timeouts fix this problem. &nbsp;Default action should be to sleep as requested.</p>
<p>&gt; Even if you manage to get the message into the user&#8217;s face, you get the &quot;I already told you&quot; problem. User initiates suspend. Application says, &quot;You are watching a movie. Do you want to suspend anyway?&quot; You say &quot;No&quot;. The system then says, &quot;Hey, this program cancelled the suspend. Do you want to suspend anyway?&quot; User says, &quot;Stupid computer. I already told you.</p>
<p>The idea is to REPLACE the application dialog with the Windows dialog, not show both. &nbsp;This entails allowing the app to send back a string containing the reason it would like the suspend to be cancelled.</p>
<p>Anyway, that&#8217;s only an issue in the event that the user WANTS to cancel the suspend. &nbsp;The Vista behavior you describe wouldn&#8217;t allow them to cancel the suspend at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346433">
				<div id="div-comment-346433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346433">
			February 16, 2006 at 1:06 pm</a>		</div>

		<p>Am I correct to assume that this behavior is only with user-requested suspends?</p>
<p>If I request a suspend while watching a movie, then I obviously am aware of it. If I&#8217;m watching a movie with my laptop connected to my TV or doing a presentation, I don&#8217;t want to have to leave the lid open just to prevent the automatic suspend.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346463">
				<div id="div-comment-346463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346463">
			February 16, 2006 at 1:12 pm</a>		</div>

		<p>&quot;work out which updates require a reboot and which don&#8217;t.&quot;</p>
<p>All updates can potentially require a reboot if a file being updated is in use. So just assume that they always require a reboot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346473">
				<div id="div-comment-346473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346473">
			February 16, 2006 at 1:13 pm</a>		</div>

		<blockquote><p>
  When you enabled automatic updates,<br />
  <br />&gt; you were asked whether you wanted<br />
  <br />&gt; reboots to be automatic or not. Say<br />
  <br />&gt; &quot;no&quot;.</p>
<p>Maybe, but if you made the mistake of saying &quot;yes&quot; windows won&#8217;t let you cancel the impending shutdown, only delay it every X minutes by clicking delay.</p>
<p>A co-worker today had a presnetation trashed because auto-update managed to reboot his machine while he was being introduced. &nbsp;He had clicked &quot;later&quot; earlier, but apparently this means &quot;reboot later&quot; not the proper action of &quot;I&#8217;ll reboot when <em>I</em> know I can.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346483">
				<div id="div-comment-346483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346483">
			February 16, 2006 at 1:19 pm</a>		</div>

		<p>You really need to reboot. Until you do, you&#8217;re in this frankenstate and things may start crashing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346503">
				<div id="div-comment-346503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Austin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346503">
			February 16, 2006 at 2:16 pm</a>		</div>

		<p>Raymond,<br />
<br />The force-reboot-no-matter-what-I-choose is an absolutely horrid design decision. &nbsp;It assumes that I can&#8217;t make a rational decision for myself. &nbsp;I&#8217;m glad some programmer at 2000 miles away from me knows what&#8217;s best for my computer and my time (reboots can sometimes take awhile, if I&#8217;ve got programs running that have a large amount of data that needs to be saved). &nbsp;</p>
<p>I&#8217;ve lost data because of this, before I realized what an asinine decision MS made (No means no, k?). &nbsp;And while I still have Automatic Updates enabled, now I download the specific update from the web, and I get full control over what happens next.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346513">
				<div id="div-comment-346513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan_S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346513">
			February 16, 2006 at 2:24 pm</a>		</div>

		<blockquote><p>
  None of those say anything about reboots. &nbsp;The 2nd one will in theory solve the problem, but then I have to work out which updates require a reboot and which don&#8217;t. </p>
<p>That is one thing I really like about the updater for Apple&#8217;s OS-X. &nbsp;It always shows, before you start installing the update, whether that update will require a reboot or not.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346523">
				<div id="div-comment-346523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346523">
			February 16, 2006 at 2:49 pm</a>		</div>

		<p>OS X also needs only one restart to update everything; the same is true of Linux, in the rare occasion you need to restart at all: the entire kernel can get replaced and a reboot is not required.</p>
<p>Vorn</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346533">
				<div id="div-comment-346533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346533">
			February 16, 2006 at 2:51 pm</a>		</div>

		<p>What about device drivers that need to do stuff (for example, unload themselves) when suspending? Since Vista is probably going to run a lot slower then XP, will &quot;a few seconds&quot; be enough, considering the hard disk will be a small one and the data very fragmented?</p>
<p>Reminds me of a funny problem with Windows 98. Try playing an MP3 file with ActiveMovie, and then try to suspend. You&#8217;ll get a fatal exception 0D. Something with DirectSound still going on regardless of wether the sound driver still exists, I guess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-346563">
				<div id="div-comment-346563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346563">
			February 16, 2006 at 3:37 pm</a>		</div>

		<p>Because you REALLY need to reboot soon. Your system is in an unstable state and needs to reboot to restabilize.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346573">
				<div id="div-comment-346573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346573">
			February 16, 2006 at 3:53 pm</a>		</div>

		<p>Al Cooper, About Face (first edition), page 178. &nbsp;&quot;Don&#8217;t stop the proceedings with idiocy.&quot; &nbsp;And page 179. &nbsp;&quot;You might think that &#8216;idiocy&#8217; is too harsh a word, but it isn&#8217;t&#8230; &nbsp;The typical error message box is unnecessary. &nbsp;It either tells the user something that he doesn&#8217;t care about or demands that he fix some situation that the program could usually fix just as well.&quot;</p>
<p>Frankly, I don&#8217;t care about the supposed state of the system. &nbsp;The machine ran fine before that message appeared; and just as significant, it continues to run fine no matter how many times (or hours or days days) I click &quot;Reboot Later.&quot; &nbsp;From the user&#8217;s perspective, this little dialog box is excise, plain and simple. &nbsp;It tells the user that the system isn&#8217;t capable of handling its daily needs without immediate attention, like a young child who needs to use a bathroom before he wets himself. &nbsp;From a user-interaction perspective, this dialog box &#8212; or perhaps the underlying model that generates the need for it &#8212; is an unforgivable mistake.</p>
<p>The automatic updates system needs to be altered to fit the needs of the user &#8212; and not the other way around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346583">
				<div id="div-comment-346583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346583">
			February 16, 2006 at 3:55 pm</a>		</div>

		<blockquote><p>
  &gt;Because you REALLY need to reboot soon<br />
  <br />&gt;&gt;Your system is in an unstable state<br />
  <br />&gt;&gt;and needs to reboot to restabilize.</p>
<p>In most Linux distros you can unlink and replace the binaries of running programs, add new versions of libraries, etc. and whenever you eventually quit the old ones the update will be complete. Why can&#8217;t Windows do that?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346593">
				<div id="div-comment-346593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346593">
			February 16, 2006 at 3:58 pm</a>		</div>

		<p>I forgot to mention that the programs being updated have to be designed to be updated like that, but for your own updates you could go out of your way to make a better user experience.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-346603">
				<div id="div-comment-346603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346603">
			February 16, 2006 at 3:58 pm</a>		</div>

		<p>It only seems to run fine. You&#8217;re actually running with mismatched binaries. Maybe there&#8217;s only a 1% chance of data corruption but when that 1% hits you you&#8217;re going to be complaining &quot;If Windows knew that things were bad, why didn&#8217;t it tell me?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346613">
				<div id="div-comment-346613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346613">
			February 16, 2006 at 4:04 pm</a>		</div>

		<p>Nar: That works as long as all the libraries the program needs are already loaded. If a program loads a library dynamically, then it will get the new one instead of the old one, and now you have a mismatch. How does Linux address this?</p>
<p>Even if all the Windows components supported on-the-fly updates, you&#8217;re still screwed if you&#8217;re running Word or Lotus or anything else that isn&#8217;t part of Windows. Say Lotus uses a component that got updated, but only used half of it at the time you installed the update. When you go to insert a picture, it loads the other half, and now it&#8217;s running a mishmash of old and new.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346633">
				<div id="div-comment-346633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346633">
			February 16, 2006 at 4:16 pm</a>		</div>

		<blockquote><p>
  It only seems to run fine. You&#8217;re actually<br />
  <br />&gt; running with mismatched binaries.</p>
<p>To which I say: &nbsp;So what? &nbsp;What you&#8217;re telling me is that not only does the implementation not know how to update the system as a single atomic action, it has to bother the user with loud complaints about its failures as well.</p>
<p>A viable alternative implementation is to download the binaries, and determine immediately whether any of them require a reboot. &nbsp;If they do, you pop up the dialog to remind the user that reboots are required to update the system, and give him the opportunity to ignore it (at his risk, obviously). &nbsp;On reboot, as part of shutdown, you apply the first half of the patches, and as part of startup, you apply the other half. &nbsp;From the user&#8217;s perspective, he&#8217;s bothered with this question no more than he cares to be, and there are no negative consequences to saying &quot;Reboot Later&quot; because nothing has changed.</p>
<p>The way it&#8217;s implemented now presents a user experience like having the maintenance staff of an office building come in to replace your desk; and when they find you&#8217;re still using the old one, they give you the option of coming back in 20 minutes or replacing it right now. &nbsp;And the fact is that any maintenance staff that did that all day to, say, president of the company would likely be fired on the spot after the second or third time they bothered him &#8212; and with good cause.</p>
<p>An alternative implementation model exists, and it&#8217;s more compatible with the user&#8217;s experience. &nbsp;Moreover, it&#8217;s not that much harder to implement than the current model. &nbsp;So the dialog box can be shown to be irrelevant, and therefore it solidly earns the title of &quot;idiocy.&quot;
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346643">
				<div id="div-comment-346643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frederik Slijkerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346643">
			February 16, 2006 at 4:20 pm</a>		</div>

		<p>Ok, how about this? When auto-update encounters a locked file, it rolls back the entire update, and writes it to a temp folder instead. Then it sets a flag so it knows that this should be installed at the next reboot, and tells the user that a reboot is required in order to install this update. No frankenstate, no mishmash.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-346653">
				<div id="div-comment-346653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346653">
			February 16, 2006 at 4:26 pm</a>		</div>

		<p>Sean W: If you want that model, then use the &quot;Download, but don&#8217;t install&quot; option to automatic updates.</p>
<p>Frederik: But what if the file can&#8217;t be rolled back because during the interim, somebody started using it? The frankenstate remains.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346663">
				<div id="div-comment-346663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346663">
			February 16, 2006 at 4:33 pm</a>		</div>

		<p>FYI, the automatic-rebooting after applying security updates was added with Windows XP Serivce Pack 2. &nbsp;This change was made because too many people were applying the updates and not rebooting, which leaves your system still at risk for any nasty worms that are spreading.</p>
<p>If the auto-reboot upsets you, you can disable it. &nbsp;However, (as Mr. Chen is pointing out) you run the risk of system instability by not rebooting immedaitely afterwards. &nbsp;Not rebooting is a BAD THING, but if you want to keep the gun pointed at your foot, have fun.</p>
<p>The registry keys for controlling this behavior are documented:<br />
<br /><a rel="nofollow" target="_new" href="http://www.microsoft.com/technet/prodtechnol/winxppro/maintain/sp2maint.mspx" rel="nofollow">http://www.microsoft.com/technet/prodtechnol/winxppro/maintain/sp2maint.mspx</a></p>
<p>It is unfortunate that the rebooting is inconvenient for some users. &nbsp;However, it is a tradeoff between usability and security. &nbsp;Which is more valuable to you?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346673">
				<div id="div-comment-346673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346673">
			February 16, 2006 at 4:36 pm</a>		</div>

		<p>&quot;The 2nd one will in theory solve the problem, but then I have to work out which updates require a reboot and which don&#8217;t. &quot;</p>
<p>It&#8217;s not on the GUI, however you can get the behaviour you want by using the &quot;No auto-reboot with logged on users&quot; Group Policy setting.</p>
<p>&quot;The idea is to REPLACE the application dialog with the Windows dialog, not show both. &quot;</p>
<p>How can you do that without rewriting all the old applications?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346683">
				<div id="div-comment-346683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346683">
			February 16, 2006 at 4:41 pm</a>		</div>

		<blockquote><p>
  &gt; Because you REALLY need to reboot soon. Your system is in an unstable state and needs to reboot to restabilize.</p>
<p>Simple. The system should not apply updates until ready. Use whatever data structure to install them 90% but not completely, that is not going into &quot;frakenstate&quot;. </p>
<p>The way it works now is very brain damaged and having Mr. &quot;Pay your taxes&quot; defend it, is ridicolous.</p>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-346693">
				<div id="div-comment-346693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346693">
			February 16, 2006 at 4:43 pm</a>		</div>

		<blockquote><p>
  How can you do that without rewriting all the old applications?</p>
<p>1. Microsoft designs the new power messaging behavior<br />
  <br />2. Microsoft publishes the new power messaging behavior<br />
  <br />3. Microsoft releases betas to application developers<br />
  <br />4. Application developers rewrite / patch / ignore according to taste<br />
  <br />5. Microsoft releases operating system<br />
  <br />6. Users install new versions / patch existing versions / live with told-you-twice according to taste and decisions of application developers<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346703">
				<div id="div-comment-346703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346703">
			February 16, 2006 at 4:49 pm</a>		</div>

		<p>Maurits: Yup, that&#8217;s how the changes to power management were handled in Windows 95. Look at all the applications that were updated accordingly! (Repeat exercise with Remote Desktop, Hierarchical Storage Management, ClearType, Roaming User Profiles, &#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346713">
				<div id="div-comment-346713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Abc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346713">
			February 16, 2006 at 4:51 pm</a>		</div>

		<p>&quot;You really need to reboot. Until you do, you&#8217;re in this frankenstate and things may start crashing.&quot;</p>
<p>So the question is, why is &quot;Automatic&quot; the default (and recommended) option in Windows Update? &nbsp;Why is the default action set to the one that puts the clueless user into some weird &quot;fankenstate&quot; that is fraught with danger? &nbsp;If updating DLLs while programs are running is dangerous, why give the user an option to do so?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346723">
				<div id="div-comment-346723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Abc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346723">
			February 16, 2006 at 4:52 pm</a>		</div>

		<p>&quot;You really need to reboot. Until you do, you&#8217;re in this frankenstate and things may start crashing.&quot;</p>
<p>So the question is, why is &quot;Automatic&quot; the default (and recommended) option in Windows Update? &nbsp;Why is the default action set to the one that puts the clueless user into some weird &quot;fankenstate&quot; that is fraught with danger? &nbsp;If updating DLLs while programs are running is dangerous, why give the user an option to do so?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346743">
				<div id="div-comment-346743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.the-rodeo.com' rel='external nofollow' class='url'>Ian Tyrrell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346743">
			February 16, 2006 at 4:53 pm</a>		</div>

		<p>Maurits, you are assuming two things here:<br />
<br />1) That the company that produced the application in the first place still exists AND<br />
<br />2) That companies running the application will install an updated version. I know many won&#8217;t do it, and won&#8217;t patch it unless a business-critical error occurs (and then they get annoyed at the application developer).</p>
<p>I work programming business systems management programs, and many of the businesses that use them won&#8217;t update just because we put out a patch (even if it is critical). They will only update if something stops working for them.</p>
<p>They might update their version of windows though. But then again, they might not. What happens then if they install your new application version, but are still running an older version of windows that doesn&#8217;t support this new power management scheme?</p>
<p>(Not trying to be harsh, but they are important issues. Also I had some program that wouldn&#8217;t let me hibernate my laptop, and I didn&#8217;t discover it till I&#8217;d shut the lid and put the laptop in a bag and pulled it out several hours later to find it was incredibly hot, out of battery, and I&#8217;d lost my work (which I&#8217;d saved, but I still lost my place in the document). If I tell the computer to hibernate/shut down, it better do it. When <em>I</em> say to.</p>
<p>Oh, and I hate dialog boxes, no-one reads them anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346763">
				<div id="div-comment-346763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346763">
			February 16, 2006 at 5:12 pm</a>		</div>

		<p>I&#8217;d rather take my chances than be forced to drop everything I&#8217;m doing and reboot. It an update is really going to make a system unstable though, why not design the updates so that they don&#8217;t replace any files until the reboot is performed? System is not in an unstable state even if I put off rebooting for a week. Yeah, I don&#8217;t get the updates immediately, but at least I&#8217;ll get them as soon as I reboot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346773">
				<div id="div-comment-346773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.the-rodeo.com' rel='external nofollow' class='url'>Ian Tyrrell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346773">
			February 16, 2006 at 5:15 pm</a>		</div>

		<p>Ouchies, that&#8217;s a whole lot of dialogs&#8230;</p>
<p>Fair enough re: ignoring. I missed that bit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346783">
				<div id="div-comment-346783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346783">
			February 16, 2006 at 5:15 pm</a>		</div>

		<p>Anom: I&#8217;m not defending the current model. I&#8217;m just pointing out that the proposed &quot;solutions&quot; are worse.</p>
<p>I would have designed it differently.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346793">
				<div id="div-comment-346793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346793">
			February 16, 2006 at 5:15 pm</a>		</div>

		<blockquote><p>
  Nar: That works as long as all the libraries<br />
  <br />&gt; the program needs are already loaded. If a<br />
  <br />&gt; program loads a library dynamically, then it<br />
  <br />&gt; will get the new one instead of the old one,<br />
  <br />&gt; and now you have a mismatch. How does Linux<br />
  <br />&gt; address this?</p>
<p>It doesn&#8217;t, but it doesn&#8217;t usually have to, either. &nbsp;Most programs don&#8217;t link to other libraries at runtime. &nbsp;Of the ones that do, they only do it on startup, not while they&#8217;re running, because they use the dlopen() as a test for what addons or plugins or optional dependencies are installed.</p>
<p>For instance, there is no COM CreateObject API that will load the required DLL when it&#8217;s called; there&#8217;s only dlopen() / dlsym() / dlclose() (pretty much exactly equivalent to LoadLibrary, GetProcAddress, and FreeLibrary). &nbsp;If you need to load an additional .so file to support your COM infrastructure (like FF does), then you do it at startup and leave it loaded.</p>
<p>When all programs do that, you can unlink (and therefore replace) any file at any time. &nbsp;And when the process starts again, it&#8217;ll get the new version. &nbsp;(This is what Nar meant about &quot;the programs have to be designed to do this&quot;.) &nbsp;It&#8217;s not a 100% simple fix, but it does work much better than Windows having to restart every time I patch anything.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346803">
				<div id="div-comment-346803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bjorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346803">
			February 16, 2006 at 5:21 pm</a>		</div>

		<p>Honestly, it seems the way to get rid of the C:WINDOWS crowd is to abolish C:WINDOWS. Ditto C:Docume~1, C:Progra~1, and the like. At install time (including OEM image install time), add a random extension to these directories, so we get C:WINDOWS.A40, C:USERS.J$E, and so on. The per-system variation will mean no one can get away with hardcoding the paths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346813">
				<div id="div-comment-346813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ChrisE</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346813">
			February 16, 2006 at 5:44 pm</a>		</div>

		<p>Regarding the hardcoded C:WINDOWS insanity, I&#8217;m guessing that&#8217;s why Windows 2000 installs to &lt;drive&gt;:WINNT by default, but the later NT-based OSes (XP, 2003, etc.) install to WINDOWS? &nbsp;I wonder how many applications were broken by the behavior in WinNT/Win2K.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-346823">
				<div id="div-comment-346823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346823">
			February 16, 2006 at 5:48 pm</a>		</div>

		<p>I forget which version it was (it might be 2003), but I&#8217;ve seen Windows applying updates when you actually shut down the computer. So instead of applying updates, then asking to reboot, it happens the other way around &#8211; it asks to reboot, then applies the updates. So you&#8217;re never left in the &quot;Frankenstate&quot;.</p>
<p>You can still be persistent: &quot;I REALLY have to reboot to apply these updates&quot; (because it should apply them ASAP) but at least there&#8217;s no chance of screwing the system up by not updating all at once.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-346833">
				<div id="div-comment-346833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346833">
			February 16, 2006 at 5:54 pm</a>		</div>

		<p>BryanK: It still doesn&#8217;t fix the problem though. If you have two program which communicate via some sort of IPC, and open the second one after the update, then if they used a common library for communication, you&#8217;d get a mismatch.</p>
<p>And if you&#8217;re asking applications to play nicely with the system, then you haven&#8217;t been programming Windows for long&#8230; the apps which DON&#8217;T play nicely surely outweight the ones that do everything right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-346843">
				<div id="div-comment-346843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346843">
			February 16, 2006 at 5:57 pm</a>		</div>

		<p>&quot;I forget which version it was (it might be 2003) [that installs updates when you shut down]&quot;</p>
<p>Windows XP Service Pack 2 added this feature (which is how I would&#8217;ve done it). I believe you get it when you specify &quot;Download but do not install immediately&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-346853">
				<div id="div-comment-346853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346853">
			February 16, 2006 at 6:22 pm</a>		</div>

		<p>&quot;Why is the automatic updates the default if it leaves you in the frankenstate?&quot;</p>
<p>You only get into that state if you interfere with the automatic update and postpone the reboot. The default is to install automatically and reboot. That way, you are always up to date.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346863">
				<div id="div-comment-346863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346863">
			February 16, 2006 at 6:43 pm</a>		</div>

		<p>oldnewthing: &quot;Because you REALLY need to reboot soon. Your system is in an unstable state and needs to reboot to restabilize.&quot;</p>
<p>If the update leaves the system in such an unstable state, then the updater should not run unless all other programs are closed. The auto-updater in XP doesn&#8217;t work that way. On the contrary, it encourages the user to keep working while the update is installed.</p>
<p>Unless this unstable state materializes the moment the update finishes, we have a contradiction. Either the system is still stable after the update finishes or it is already unstable while the update is installed and the user is being encouraged to keep working.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346223">
				<div id="div-comment-346223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346223">
			February 16, 2006 at 10:57 am</a>		</div>

		<p>Because XP (at least on the few laptops we have) will still suspend, even if the machine is plugged into AC and the battery is in use. &nbsp;You never flash a ROM while on battery anyway (or at least, you shouldn&#8217;t).</p>
<p>On a sort-of-related note: Anyone know why XP no longer allows programs to shut the machine down but *NOT* power it off? &nbsp;We have several services running on our shop-floor machines that require this capability. &nbsp;For instance, one is a watchdog card service. &nbsp;When the watchdog doesn&#8217;t get reset, the service (if it&#8217;s still able to run) does a clean machine shutdown and tells the watchdog card to toggle the reset line on the motherboard after a fixed delay (something like 30 seconds). &nbsp;The watchdog plugs into the reset switch header on the motherboard, and connects these contacts after the delay elapses. &nbsp;But if the machine doesn&#8217;t stay powered on, the reset contact doesn&#8217;t do anything. &nbsp;And if the machine doesn&#8217;t shut down at all, then the FS is in danger of getting screwed up.</p>
<p>So does anyone know why this capability got removed? &nbsp;(MSDN even got updated, at least the online version. &nbsp;The VS .Net 2003 version still says that InitiateSystemShutdownEx&#8217;s bRebootAfterShutdown parameter will shut down but not power off if it&#8217;s set to FALSE (&quot;Windows XP and earlier: A message is displayed indicating it is safe to power down&quot;); the online version says that it will &quot;safely power down&quot; the system when it&#8217;s set to FALSE.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346873">
				<div id="div-comment-346873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spaces.msn.com/thewendyhouse/' rel='external nofollow' class='url'>:: Wendy ::</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346873">
			February 16, 2006 at 7:13 pm</a>		</div>

		<p>most people that I know systematically close all their windows and programs before they &#8216;shutdown&#8217; their computer &#8211; i do. &nbsp;during this process I notice if some &#8216;process&#8217; that I value (burning a CD) is still happening. &nbsp;When i say SHUTDOWN that&#8217;s what I want, &nbsp;the times it doesnt happen are when some process i dont recognise is not &#8216;ending&#8217; so I zap the bugger with that &#8216;end process now&#8217; dialog thingy that pops-up because I have no idea what it is or why i would want it or how long it will take if it will ever end &#8211; its gotta be something dodgy because i closed everything legitimately before hitting shutdown.</p>
<p>If i wanted my PC on all the time I&#8217;d never hit shutdown or get someone clever to arrange clever-setting-type-things for me.</p>
<p>As it is I have to sit and watch the thing shutdown (Bluhhhh!)when all is quiet and all lights are off I can leave or shut the lid and put it in its very cute carry-case. &nbsp;BUT if forget sometimes, &nbsp;because I trust my PC to do what i want when I&#8217;ve said SHUTDOWN 2 times already</p>
<p>Those pesky program is not responding thingys that stop shutdown have drained my battry several times. &nbsp;ZAP them!!!!!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346893">
				<div id="div-comment-346893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346893">
			February 16, 2006 at 7:21 pm</a>		</div>

		<p>Maurits, I don&#8217;t get the point of you linking to that 7-step file delete thing. &nbsp;Are you implying that since there&#8217;s circumstances where Windows annoys you with 7 dialogs, then it&#8217;s ok for Windows to annoy you with 2 dialogs to suspend the PC? &nbsp;</p>
<p>Couldn&#8217;t it just be that the 7-step dialog is the wrong way to do it, and you should never bug the user multiple times about the same issue?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346903">
				<div id="div-comment-346903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346903">
			February 16, 2006 at 7:46 pm</a>		</div>

		<p>&quot;You only get into that state if you interfere with the automatic update and postpone the reboot. The default is to install automatically and reboot. That way, you are always up to date.&quot;</p>
<p>And missing lots of unsaved data, or web pages that you haven&#8217;t read, or have read and were meaning to bookmark but hadn&#8217;t yet.</p>
<p>No sane person would ever willingly allow their computer to spontaneously reboot whenever it felt like it. &nbsp;Which is why the only sensible thing to do with the current implementation (IMO) is to set it to &quot;download, but install only when I tell you to&quot;, and then stubbornly resist the icon in the corner until I&#8217;m actually ready to reboot. &nbsp;Which tends to be about three months later (I hibernate a lot).</p>
<p>Better an unpatched system than a frankenstate or spontaneously rebooting one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346263">
				<div id="div-comment-346263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346263">
			February 16, 2006 at 11:50 am</a>		</div>

		<p>Microsoft&#8217;s greatest enemy is and has always been the 3rd party developers writing for their OSes. &nbsp;Notice how Apple never has any problems like this&#8230; I don&#8217;t know exactly what it is that Apple is doing right, but it might be a good idea to copy it and raise the quality of Windows software.</p>
<p>I&#8217;m really sick of not being able to run as administrator because of broken third party software, and having sleep disabled on my computer would just make me mad as hell.</p>
<p>The other part of this equation is why do Windows users stand for it? &nbsp;I think it&#8217;s just ignorance&#8230; there&#8217;s no way to tell which programs will crap all over your system until you&#8217;ve already bought and installed it. &nbsp;Windows should have some kind of notification system, informing the developer (and user) of which Windows API rules they&#8217;re breaking and tallying a final score for them. &nbsp;&quot;Move the mouse cursor without user interaction? &nbsp;-100 points.&quot; &nbsp;Something like that. &nbsp;Additionally, Microsoft should provide a testing environment (perhaps using VirtualPC) which could automatically test for things like &#8216;windows directory not in the default loaction&#8217; or &#8216;really restrictive file permissions&#8217; and tell the programmer what part of his program failed, and what to do to fix it.</p>
<p>But the most important thing is to make the developers *want* to fix it. &nbsp;Normally when I point out stuff like, &quot;you shouldn&#8217;t hard-code the path c:Windows because that will break on some systems&quot;, the response is usually, &quot;who cares? &nbsp;I&#8217;ll fix it when it happens.&quot; &nbsp;You need to convince programmers that doing things the right way is always easier in the long run, and usually easier in the short run also.</p>
<p>Enough ranting. &nbsp;I&#8217;m just sick of the quality of the software out there. &nbsp;The very fact that IBM can produce a product as terrible as Lotus Notes, and then sell it for *more money* than Exchange/Outlook&#8230; that means something is VERY WRONG with the free market as it relates to the computing industry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346933">
				<div id="div-comment-346933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346933">
			February 16, 2006 at 7:55 pm</a>		</div>

		<p>Perhaps I&#8217;m missing something &#8212; but I just wrote a program that does a SendMessage (hWnd, 72=WM_POWER, 1=PRW_SUSPENDREQUEST, 0) to every window on my system (yes, I like playing with fire) &#8212; each and every window came back right away with a &#8216;0&#8217; which, according to the docs, is not legit (they are supposed to respond with 1=PWR_OK or (-1)=PWR_FAIL.</p>
<p>Other than whacking horribly at my system, what have I done wrong?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-346963">
				<div id="div-comment-346963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346963">
			February 16, 2006 at 8:01 pm</a>		</div>

		<blockquote><p>
  why doesn&#8217;t IE have a spell-checker?</p>
<p><a rel="nofollow" target="_new" href="http://www.iespell.com/" rel="nofollow">http://www.iespell.com/</a>
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346973">
				<div id="div-comment-346973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346973">
			February 16, 2006 at 8:02 pm</a>		</div>

		<p>Peter:</p>
<p>(quoted from MSDN):<br />
<br />Note &nbsp;The WM_POWER message is obsolete. It is provided only for compatibility with 16-bit Windows-based applications. Win32-based applications should use the WM_POWERBROADCAST message.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346993">
				<div id="div-comment-346993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346993">
			February 16, 2006 at 8:26 pm</a>		</div>

		<blockquote><p>
  Peter:</p>
<p>&gt;(quoted from MSDN):<br />
  <br />&gt;Note &nbsp;The WM_POWER message is obsolete. It is &gt;provided only for compatibility with 16-bit &gt;Windows-based applications. Win32-based &gt;applications should use the WM_POWERBROADCAST &gt;message.</p>
<p>Hey, I&#8217;m just using the WM_POWER that Raymond himself is using. &nbsp;What&#8217;s odd, though, is that all programs are returning the wrong thing &#8212; even all of the true-blue Microsoft ones. &nbsp;You&#8217;d expect that Dos shells and IE would return the &#8216;correct&#8217; values even for bad items.</p>
<p>However, when I try the same thing with WM_POWERBROADCAST (536=0x218) with a APMQUERYSUSPEND (0), I get 1&#8217;s back for almost everything (yay!) and ZEROS back from three programs. &nbsp;The doc, of course, say to return either TRUE (1) or BRAODCAST_QUERY_DENY which is 0x424d5144.</p>
<p>(This means, of course, that Raymond is pretty well right &#8212; &quot;nobody&quot; is following the WM_POWER spec, and some people are doing the WM_POWERBROADCAST wrong)</p>
<p>Personally, I think Microsoft is doing the right thing here. &nbsp;Suspend means suspend right now; anything else is wrong. &nbsp;If some apps are broken (for whatever reason), then let them be replaced with working programs.</p>
<p>Peter
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346343">
				<div id="div-comment-346343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Not Amused Again</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346343">
			February 16, 2006 at 12:27 pm</a>		</div>

		<p>James Schend: Nice one. Do you know why the damn programs have to ask before allowing things to go into suspend mode? It&#8217;s because MS&#8217;s freakin networking code is freakin *broken*. Open files are supposed to be reconnected after a suspend, and *they are not*, leading to losses in any open files. (Not that saving the files then allowing the suspend to continue works either, as the wonderful opportunistic file locking junk seems to predictably barf after suspends.)</p>
<p>MS&#8217;s worst enemy has always been their own programmers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346443">
				<div id="div-comment-346443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346443">
			February 16, 2006 at 1:07 pm</a>		</div>

		<p>Raymond said:</p>
<p>&quot;When you enabled automatic updates, you were asked whether you wanted reboots to be automatic or not. Say &quot;no&quot;.&quot;</p>
<p>I am using XP Pro and there is no &quot;automatic reboots&quot; option. &nbsp;In fact the word reboot doesn&#8217;t appear anywhere on the page (I am using the &quot;Automatic Updates&quot; widget in the Control Panel).</p>
<p>There are 4 options:</p>
<p>&#8211; Automatic (recommended)<br />
<br />&#8211; Download, but don&#8217;t install<br />
<br />&#8211; Notify, but don&#8217;t download<br />
<br />&#8211; Off</p>
<p>None of those say anything about reboots. &nbsp;The 2nd one will in theory solve the problem, but then I have to work out which updates require a reboot and which don&#8217;t.</p>
<p>All I am asking is to stop automatically overriding me and losing *MY* information. &nbsp;I will reboot *my* computer when I am ready.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347003">
				<div id="div-comment-347003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://satiricalramblings.blogspot.com' rel='external nofollow' class='url'>tsrblke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347003">
			February 16, 2006 at 9:11 pm</a>		</div>

		<p>Regarding the automatic updates. &nbsp;MS made a simple assumption and that&#8217;s that people would choose a time when they aren&#8217;t likely to be using their computer (i.e. 3 AM). &nbsp;Simply put the next assumption would be that people will save and exit their thngs before they leave their PC for extended periods of time. &nbsp;Do I always do this: No. &nbsp;But I will say this: the last time my power went out overnight and I lost some data, I learned quickly. &nbsp;Is the power outage a result of bad programming? No.<br />
<br />So to be quite blunt, before you leave your computer for extended periods of time, you should save and exit. &nbsp;This is just a good practice. &nbsp;While this assumption maybe horribly wrong on MS&#8217;s part, it is based on a least something viable.<br />
<br />And before you go off about &quot;extended rendering times&quot; and &quot;compiling takes all night.&quot; &nbsp;Remember, this Autoupdate was built to be as simple as possible for the user whose using Word and IE only on their computer, and so they are unaffected by these things.<br />
<br />(Yes, I make blatent generalizations and ad hoc assumptions in this post. &nbsp;But face it, it&#8217;s decently grounded at its core.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347013">
				<div id="div-comment-347013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347013">
			February 16, 2006 at 9:37 pm</a>		</div>

		<p>Default behaviour for all programs is to respond 0 to messages that they don&#8217;t care about. &nbsp;So that&#8217;s to be expected.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346543">
				<div id="div-comment-346543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346543">
			February 16, 2006 at 2:59 pm</a>		</div>

		<p>You know, if you really want the machine to go down on suspend, just catch WM_POWER and kill the DCOM server.</p>
<p>I&#8217;ve noticed multiple behaviors with Auto Update, but never click later -&gt; reboot. Sometimes, five minutes after clicking &quot;Later,&quot; you get a &quot;I&#8217;m going to reboot within a minute unless you tell me not to&quot; dialog with a timer. Timer reaches zero? You get a reboot.</p>
<p>Personally, I usually get annoyed after two cycles and let it reboot.</p>
<p>The funny thing in all this: people *always* complain about lack of flexibility in Windows. Here, MSFT provided flexibility, 3rd party programs break it, and people blame it on the OS.</p>
<p>I can&#8217;t hibernate my Shuttle desktop that runs XP, but none of the power stuff on my Sony Vaio laptop works in Linux. *shrug* And I used to have an iMac that crashed so hard while OS/X was doing a system update that I had to format the drive and start from scratch.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347023">
				<div id="div-comment-347023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347023">
			February 16, 2006 at 11:17 pm</a>		</div>

		<p>Thursday, February 16, 2006 10:08 AM by ..<br />
<br />&gt; Can&#8217;t wait till the day my laptop will<br />
<br />&gt; standby when flashing some rom</p>
<p>Me too. &nbsp;Fortunately the closest problem I had to this was when Windows XP decided to suspend itself during an FTP download. &nbsp;Thank you for reminding me how lucky I was, and much worse it could have been.</p>
<p>Thursday, February 16, 2006 12:38 PM by oldnewthing<br />
<br />&gt; When you enabled automatic updates, you were<br />
<br />&gt; asked whether you wanted reboots to be<br />
<br />&gt; automatic or not. Say &quot;no&quot;.</p>
<p>I&#8217;ll gladly say &quot;no&quot;, but, in which universe was I asked this question?</p>
<p>Thursday, February 16, 2006 12:47 PM by Darren Stone<br />
<br />&gt; When a user shuts their laptop lid, the<br />
<br />&gt; machine must suspend immediately. &nbsp;Period.</p>
<p>Wrong. &nbsp;If the user has set an option to behave that way period then it should behave that way period.</p>
<p>When Windows is running and lets me set what action to do, I set it to do no action, because I close the lid to turn off the backlight (and/or prevent the cat from stepping on the keyboard) while letting programs continue to run.</p>
<p>When Windows isn&#8217;t running, usually I avoid closing the lid, though sometimes I have to hope that BIOS settings were lucky. &nbsp;This is particularly relevant in the machine where I&#8217;m installing the checked build of Vista Beta 1. &nbsp;Even though some part of Windows is running to some degree while installation is proceeding, control panel settings are not available. &nbsp;About 3 months after I started installation, part of the plastic case burned a little bit because the backlight had been on for 3 months straight. &nbsp;This is during the time when the installer says &quot;Do not restart your computer during this time&quot; and I don&#8217;t think the installer has enabled hibernation so I didn&#8217;t want to gamble on what would happen when the lid closed. &nbsp;But after seeing what happened, I finally did have to gamble, and closed the lid. &nbsp;Fortunately the backlight turned off but the rest of the machine continued running, just as I hoped. &nbsp;Around 5 times a week I open it to check it and the installer is still going, with MSCORSVW.EXE being the biggest user.</p>
<p>Now, what to think when part of the plastic case burns because the backlight has been on for 3 months. &nbsp;My intuition says I should take this up with Fujitsu (which I intend to do after Vista finishes installing, if I live that long). &nbsp;But certain famous people say that everyone blames Microsoft no matter what, and I&#8217;m not sure if I want to disappoint them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346553">
				<div id="div-comment-346553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346553">
			February 16, 2006 at 3:32 pm</a>		</div>

		<p>In regards to the &quot;Reboot Now&quot; vs. &quot;Reboot Later&quot; buttons, why not just have another button that says &quot;Reboot Tomorrow,&quot; that puts it off for, say, twelve or sixteen hours? &nbsp;This achieves the same goal of forcing the user to reboot, but it gives the user time to get his work done without being bothered. &nbsp;I have a reboot dialog that&#8217;s been bothering me all day today, and every twenty minutes or so, like clockwork, I just keep hitting &quot;Reboot Later,&quot; when what I really want is just for it to wait for me to be done for the day.</p>
<p>Heck, I&#8217;ve been known to shut down the relevant processes in the Task Manager just so I can keep working, and I&#8217;m sure *that&#8217;s* a lot less healthy for the system than the Frankenstate solution.</p>
<p>Graaah! &nbsp;Stupid dialog box popped up again while I was writing this message. &nbsp;Somebody gimme a gun and point me at the programmer who coded this wretched monstrosity&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347033">
				<div id="div-comment-347033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Day</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347033">
			February 16, 2006 at 11:43 pm</a>		</div>

		<p>Likely reaction from one database server: when power down notice is received, do a deliberate &quot;crash&quot; of the server, then a recovery of (RAM in computer less one gigabyte) of &nbsp;data when the service is restarted after the reboot.</p>
<p>I&#8217;m not really sure that deferring say 16GB of random reads and writes in 16k chunks to system restart is desirable behavior, even though it is the behavior you need when you&#8217;re facing power loss in the immediate future.</p>
<p>Does Microsoft desire some other behavior? At the moment, this is the one I&#8217;m going to recommend for a server with a few million Windows users.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-347043">
				<div id="div-comment-347043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347043">
			February 17, 2006 at 12:22 am</a>		</div>

		<p>Btw: W.r.t. the comments about why Windows closes files over the network on connection loss.</p>
<p>The answer is very &quot;Raymond-ish&quot;. &nbsp;&quot;Because the alternative is worse&quot;.</p>
<p>I&#8217;ll write up more about it tomorrow in my blog (it&#8217;s late), but the simple reason is the answer to the question: &quot;What happened to the contents of the file during the time the connection was lost?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346733">
				<div id="div-comment-346733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346733">
			February 16, 2006 at 4:52 pm</a>		</div>

		<p>Since I don&#8217;t have any new updates to test with, it&#8217;ll be hard to compare: &nbsp;But I&#8217;ve set this machine to update using &quot;Let me choose when to install them&quot; as you suggested. &nbsp;That said, I remember I used to have this thing set to do exactly that, and it would never remind me at all that anything needed to be done: &nbsp;No messages, no notices, nothing more than an icon in the system tray that&#8217;s easily overlooked among a dozen others. &nbsp;So I&#8217;ll give you the benefit of the doubt on this setting: &nbsp;But if it doesn&#8217;t tell the user at all that anything needs to be done, and doesn&#8217;t do anything automatic at all, that&#8217;s just as bad as the over-notification of the other setting.</p>
<p>A steady fallback system akin to how TCP/IP uses fallbacks would make more sense for most users than either of the two existing models: &nbsp;Download the updates, and prepare to install them, and offer &quot;Reboot Now&quot; and &quot;Reboot Later&quot; as options. &nbsp;For each successive time &quot;Reboot Later&quot; is clicked, double the amount of time you wait until the next notice, up to 24 hours. &nbsp;Most users won&#8217;t object to being reminded once a day that they have to do something semi-important; but most users *will* object to being reminded every 20 minutes on the same thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-346753">
				<div id="div-comment-346753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346753">
			February 16, 2006 at 5:07 pm</a>		</div>

		<p>&gt; Maurits, you are assuming two things here</p>
<p>Nah, there was an &quot;ignore&quot; option in my previous comment.</p>
<p>I&#8217;m trying to save the ability for apps to cancel a suspend here, and I&#8217;m getting shot down with &quot;but the users might have to see a dialog box twice.&quot;</p>
<p>Which is a bit like removing the fire escape because the color doesn&#8217;t match the building.</p>
<p>Oh, and *ahem*: <a rel="nofollow" target="_new" href="http://img513.imageshack.us/my.php?image=deletingashortcut1sd.jpg" rel="nofollow">http://img513.imageshack.us/my.php?image=deletingashortcut1sd.jpg</a><br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347063">
				<div id="div-comment-347063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/doronh/archive/2006/02/16/533898.aspx' rel='external nofollow' class='url'>A Hole In My Head</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347063">
			February 17, 2006 at 1:57 am</a>		</div>

		<p>I was going to blog about this after I had some KMDF entries under my belt, but Raymond Chen got things&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347073">
				<div id="div-comment-347073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.1060.org/blogxter/publish/5' rel='external nofollow' class='url'>Steve Loughran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347073">
			February 17, 2006 at 2:21 am</a>		</div>

		<p>Raymond,</p>
<p>Its easy to critique all those third party apps, but office 2000 abused WM_POWER too. If you tried to suspend/hibernate win2k with a network file open, office 2k would refuse to suspend, even when the file was in the offline filestore. It was trying to be clever, but not clever enough.</p>
<p>I have a systray applet that triggers suspend/hibernate/shutdown without giving apps a lookin. This leaves me only vulnerable to drivers.</p>
<p>One problem there is the OS; if a driver refuses there is no attempt to retry, just a dialog box. &nbsp;A dialog box you see later, when you pull a hot laptop out of your bag to find the battery nearly flat.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347083">
				<div id="div-comment-347083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347083">
			February 17, 2006 at 2:59 am</a>		</div>

		<p>On the </p>
<p>&gt;When a user shuts their laptop lid, the<br />
<br />&gt; machine must suspend immediately. &nbsp;Period. </p>
<p>We often do short but critical works (involving television) with laptops, sometimes off power (the job often last less than 1 hour).<br />
<br />We have a backup laptop, usually closed below the one we work on. Should anything happen to the main one, we close the lid of the main, swap them, open the lid of the backup and expect it to be ready (not suspended) even after 45 min of inactivity with lid closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-346923">
				<div id="div-comment-346923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346923">
			February 16, 2006 at 7:53 pm</a>		</div>

		<p>Guilty as charged :)</p>
<p>Yes, the 7-step dialog is wrong.<br />
<br />Yes, a single dialog is better than two dialogs.</p>
<p>But the choice is between two scenarios:</p>
<p>A) The operating system suspends without offering applications a chance to appeal to the user</p>
<p>and</p>
<p>B) The operating system allows applications a chance to appeal to the user to cancel a suspend;<br />
<br />* new and patched applications may appeal by having Windows show a single dialog;<br />
<br />* legacy applications may appeal by either<br />
<br />&#8212; having Windows show a single dialog (these are the &quot;naughty&quot; apps that try to cancel the suspend without checking with the user or<br />
<br />&#8212; showing a dialog themselves, then (if the user tries to cancel the suspend) Windows will show another dialog confirming (these are the &quot;nice&quot; apps that ask the user before trying to cancel the suspend)</p>
<p>I think B) is by far the lesser of two evils.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347103">
				<div id="div-comment-347103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347103">
			February 17, 2006 at 3:55 am</a>		</div>

		<p>The user is allowed to choose what happens when the laptop lid closes. Often he will want to chose &#8216;do nothing&#8217;, because for example he has another monitor, keyboard and mouse.</p>
<p>Now, perhaps Raymond can tell us if the monitor will switch off automatically in this case when the lid is closed? Unfortunately I am not able to squeeze underneath and have a peep :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346943">
				<div id="div-comment-346943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346943">
			February 16, 2006 at 7:56 pm</a>		</div>

		<p>1. Microsoft designs the new power messaging behavior<br />
<br />2. Microsoft publishes the new power messaging behavior<br />
<br />3. Microsoft releases betas to application developers<br />
<br />4. Application developers rewrite / patch / ignore according to taste<br />
<br />5. Microsoft releases operating system<br />
<br />6. Users install new versions / patch existing versions / live with told-you-twice according to taste and decisions of application developers</p>
<p>That would be great is number 4 ever happened, but it doesn&#8217;t.</p>
<p>How long did it take Lotus Notes to properly support running on multi-user Windows installs? &nbsp;There was a version of it (3, 4?) for NT 4, but it didn&#8217;t actually *support* it until 6.5, which didn&#8217;t come out until Windows XP was already out.</p>
<p>Do you know how many web apps force me to disable XP SP2&#8217;s pop-up blocker because, despite having access to the betas and knowing it was coming, they never bothered to design their site to cope with blocked pop-ups?</p>
<p>That&#8217;s the exact crap that makes me complain about how plain *terrible* most software is. &nbsp;Microsoft only releases an OS every, what, 4-5 years? &nbsp;And *still* application developers have trouble keeping up! &nbsp;(Meanwhile, Apple&#8217;s releasing a new OS X every 18 months or so, and OS X applications never have a problem coping with those releases or taking advantage of the new features added by Apple.)</p>
<p>It&#8217;s the year 2006. &nbsp;How come there isn&#8217;t a single IM program on Windows that uses text-to-speech to speak IMs out loud, but there are a half-dozen on OS X? &nbsp;(And don&#8217;t tell me it&#8217;s a useless feature; I love it.) &nbsp;How come there are still applications that allow text input but *don&#8217;t* have spell-checkers? &nbsp;Does Microsoft know that a huge number of people use web clients for their email or things like, hm, this comment field? &nbsp;I&#8217;d bet it&#8217;s 75% of users or more&#8230; so why doesn&#8217;t IE have a spell-checker?</p>
<p>Grah. &nbsp;It just drives me nuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-346953">
				<div id="div-comment-346953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346953">
			February 16, 2006 at 7:56 pm</a>		</div>

		<p>This is very belated, but:</p>
<p>&quot;Do you know why the damn programs have to ask before allowing things to go into suspend mode? It&#8217;s because MS&#8217;s freakin networking code is freakin *broken*. Open files are supposed to be reconnected after a suspend, and *they are not*, leading to losses in any open files.&quot;</p>
<p>It&#8217;s worse than that. &nbsp;Open files on a network drive randomly drop out all the time, and never reconnect. &nbsp;Apps need to never assume that just because they opened a file it&#8217;ll stay that way &#8212; it could vanish out from under them at any time. &nbsp;And it&#8217;s not just networked files.</p>
<p>One of my big peeves recently is with a VM program. &nbsp;I had a VM running with a CD mounted from an image on a network server. &nbsp;The network connection dropped out for a few seconds, and then I get a warning dialog saying &quot;crap, i can&#8217;t read the file&quot; with retry/cancel &#8212; but the retry only retried the read, it didn&#8217;t reopen the file. &nbsp;Meaning that even once the network was back it still failed. &nbsp;And Cancel shut down the entire VM. &nbsp;And I wasn&#8217;t even *using* the CD at the time it happened. &nbsp;Grr.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-346983">
				<div id="div-comment-346983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jamie Anderson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-346983">
			February 16, 2006 at 8:04 pm</a>		</div>

		<p>Re: WM_POWER and Vista</p>
<p>I agree that the &quot;shut down anyway&quot; approach is wrong. There may be software out there that correctly says that it cannot be suspended. However, something needs to be done so that users can deal with programs (and programmers) with big egos.</p>
<p>I like the idea of a dialog box saying something like:</p>
<p>&quot;The program &#8216;xyzzy.exe&#8217; has indicated that the system should not be suspended. Do you want to suspend anyway?</p>
<p>The system will suspend automatically in ## seconds.</p>
<p>[ ] Remember my answer for this application.&quot;</p>
<p>The timer should count down from a sufficiently large value (30 or 60 seconds). This solution (a) allows rogue applications to be ignored, (b) allows correct applications to prevent shutdown, and (c) minimizes duplicate dialogs.</p>
<p>Re: automatic updates</p>
<p>I seem to remember that more recent versions of XP and 2003 allowed for hot-patching of in-use DLLs. So, shouldn&#8217;t the following happen when updating:<br />
<br />* Updater tries to write the new DLL.<br />
<br />* Write fails (sharing violation).<br />
<br />* Updater suspends execution of all applications using the DLL. (It may have to wait for threads to exit the DLL code.)<br />
<br />* Updater renames the in-use DLL.<br />
<br />* Updater writes the new version of the DLL.<br />
<br />* Updater resumes any applications that were suspended.</p>
<p>Using this method, the code is updated nicely and without thread execution contentions. The next time the system reboots, it simply has to remove the renamed copies of the old DLLs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347113">
				<div id="div-comment-347113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347113">
			February 17, 2006 at 7:05 am</a>		</div>

		<p>Oh yeah. When will people learn: applications should be the lowest class citizens in the system.</p>
<p>When I say &quot;shutdown&quot;, I don&#8217;t mean &quot;can you please shut down?&quot;, I mean &quot;I&#8217;m cutting the power in 30 seconds, make the most out of it because it is really going down no matter what&quot;.</p>
<p>A better example: the stupid &quot;safe removal&quot; behaviour (is it called this way in English?). I say &quot;remove this USB drive&quot;. Windows says &quot;no I can&#8217;t&quot;. Ok, bad luck, but trust me, I have the last word on this. I have met people who have a retarded program which locks any drive; therefore &quot;safe removal&quot; never works. Not that it matters, they won&#8217;t bother with it anymore and just remove the drive.</p>
<p>A much better behaviour would be to invalidate all the handles and at least unmount the filesystem cleanly. The &quot;invalidate all the handles&quot; thing is going to happen anyway, so&#8230;</p>
<p>If computers still had a classical power switch (or people knew that you can press 5 seconds to force shutdown), you&#8217;d be surprised how few would cope with the &quot;it takes more than 1 second to switch off&quot; bullshit.</p>
<p>Apart from those two things, this can be extended to other stuff such as locked files that you can&#8217;t rename, move or delete. I want a &quot;kill all handles of this file&quot; button in the failure dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347123">
				<div id="div-comment-347123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347123">
			February 17, 2006 at 7:55 am</a>		</div>

		<p>Peter:<br />
<br />For the windows returning 0 to WM_POWER, I am almost sure that it is not their fault.<br />
<br />It is probably due to DefWindowProc, returning zero, instead of a correct default value (I am not absolutely sure since I did&#8217;nt tested it right now, but you can test).</p>
<p>And, theorically, a programmer who don&#8217;t handle a message (because he is not even aware of it&#8230; we cannot expect that every programmer know the hundreds of message, whose number increases at each release of Windows).</p>
<p>So, I am almost sure that this behaviour is due to a bug in DefWindowProc, which should be reported &amp; fixed.</p>
<p>Also, It would have been nice (but now it is too late), if there existed a value (zero for example) that could be returned for any &quot;unhandled&quot; message, and if there were a convention for return values, similar to the one used by COM.</p>
<p>For example:<br />
<br />0 &nbsp;: unknown/unrecognised/unhandled message.<br />
<br />&lt;0 : failure code<br />
<br />&gt;0 : success code</p>
<p>Perhaps, -1 could be a better choice for the &quot;universal unhandled code&quot;, hence, allowing messages to return a positive integer meaning something (for example a count), and still maintaining a coherent convention.</p>
<p>For example, using TRUE/FALSE for some messages and zero/non-zero for others is quite evil, because 1==TRUE==success for messages using boolean, and 0==success for many messages returning more complex values.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347133">
				<div id="div-comment-347133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347133">
			February 17, 2006 at 8:26 am</a>		</div>

		<p>Dean:</p>
<p>&quot;It still doesn&#8217;t fix the problem though. If you have two program which communicate via some sort of IPC, and open the second one after the update, then if they used a common library for communication, you&#8217;d get a mismatch.&quot;</p>
<p>Yes. &nbsp;And yet, I don&#8217;t think this ever happens. &nbsp;That may be because IPC libraries are careful enough to include &quot;version X&quot; fields in their data structures, or it may be because of other things, I&#8217;m not sure.</p>
<p>(Perhaps it&#8217;s because the programmers know the entire system. &nbsp;See below.)</p>
<p>&quot;And if you&#8217;re asking applications to play nicely with the system, then you haven&#8217;t been programming Windows for long&#8230; the apps which DON&#8217;T play nicely surely outweight the ones that do everything right.&quot;</p>
<p>I have been programming Windows (and cursing its stupidity) for maybe 7 years or so, actually. &nbsp;Now maybe that isn&#8217;t what you mean by &quot;long&quot;, but it&#8217;s been a while. &nbsp;As for &quot;the apps which DON&#8217;T play nicely surely outweigh the ones that do everything right&quot; &#8212; it&#8217;s funny how Windows is the only OS where I see this. &nbsp;As others have mentioned, it doesn&#8217;t happen on OSX. &nbsp;It doesn&#8217;t happen on Linux. &nbsp;It doesn&#8217;t happen on BSD. &nbsp;It probably doesn&#8217;t happen on proprietary Unix-en, though I&#8217;ve never seen any of those to know for sure.</p>
<p>I think the reason is (partly) related to the fact that it seems like there are hundreds of millions of people programming for Windows that don&#8217;t have a clue how to program, and/or who don&#8217;t know the &quot;philosophy&quot; of the OS (so even if they do know how to program, they do the wrong thing with the various APIs).</p>
<p>The philosophy of Unix, OTOH, is fairly well known among its programmers, and the ones that don&#8217;t know (because they&#8217;re just starting, or whatever) have 2 things to help them learn: tons of code available that does the right thing already (since many of the applications are open-source, and many more facilities have pre-made libraries already built), and relatively better documentation (manpages for every C library function, manpages for most add-on library functions, lots of online tutorials for various common-but-hard concepts (select, X11, etc.), etc.).</p>
<p>And this documentation never changes, because there&#8217;s an even higher commitment to backwards compatibility at certain levels (the meaning of flags passed to old system calls NEVER changes, for instance; reference my comment #3 above, regarding InitiateSystemShutdownEx &#8212; I wonder why this wasn&#8217;t flagged by the various back-compat people at Microsoft?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347143">
				<div id="div-comment-347143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jasonhaley.com/blog/archive/2006/02/17/136238.aspx' rel='external nofollow' class='url'>Jason Haley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347143">
			February 17, 2006 at 8:41 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347153">
				<div id="div-comment-347153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jasonhaley.com/blog/archive/0001/01/01/136238.aspx' rel='external nofollow' class='url'>Jason Haley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347153">
			February 17, 2006 at 8:45 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347163">
				<div id="div-comment-347163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347163">
			February 17, 2006 at 9:38 am</a>		</div>

		<p>re &#8216;So to be quite blunt, before you leave your computer for extended periods &#8216;</p>
<p>Anyone who leaves there computer on for extended periods of time [doing nothing] should be fined. </p>
<p>It&#8217;s irresponsible to waste energy and pump out greenhouse gasses like that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347183">
				<div id="div-comment-347183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347183">
			February 17, 2006 at 10:04 am</a>		</div>

		<blockquote><p>
  perhaps Raymond can tell us if the monitor will switch off automatically in this case when the lid is closed?</p>
<p>I understand, Stephen, that they each laptop will come with its own little Elf, like the one that comes with each fridge, and he will switch off the monitor.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347203">
				<div id="div-comment-347203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347203">
			February 17, 2006 at 10:07 am</a>		</div>

		<p>&quot;Anyone who leaves there computer on for extended periods of time [doing nothing] should be fined.&quot;</p>
<p>Yeah, and what about those sheep left for extended periods of time doing nothing but emitting greenhouse gasses?? :D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347223">
				<div id="div-comment-347223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamessummerlin.blogspot.com' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347223">
			February 17, 2006 at 10:12 am</a>		</div>

		<p>I am getting a kick out of those of you who are saying what MS should and shouldn&#8217;t be doing. &nbsp;There are two things happening here:</p>
<p>1. &nbsp;The change in Vista will break or hurt your program in some way and you don&#8217;t like it because you were caught cheating or are trying to be cool by thinking your program is THE number one program the user has on his/her computer.</p>
<p>2. &nbsp;Not a single one of you has spent the resources MS has in researching this problem. &nbsp;You are just guessing at what you think needs to be done or what would suite you and not the user base at large.</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347233">
				<div id="div-comment-347233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347233">
			February 17, 2006 at 10:20 am</a>		</div>

		<p>&quot;When you enabled automatic updates, you were asked whether you wanted reboots to be automatic or not. Say &quot;no&quot;. &quot;</p>
<p>Um, that&#8217;s completely false. &nbsp;</p>
<p>You are asked if you want to INSTALL updates automatically, but not if you want the machine to reboot after the install. &nbsp;(OK, you could claim that the reboot is implied. &nbsp;Sometimes I tell Automatic Updates to install an update, but I choose to reboot later. &nbsp;It keeps reminding me, and eventually I let it reboot.)</p>
<p>We once had our server set to install updates at the default time of 3:00 AM, and lo and behold, one afternoon at 4:15 PM it decided to install some automatic updates AND reboot. &nbsp;Bleah. &nbsp;Now the server is set to download but not install updates.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347243">
				<div id="div-comment-347243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347243">
			February 17, 2006 at 10:24 am</a>		</div>

		<p>I see I am not the only one with that comment &quot;there&#8217;s no reboot option&quot;.</p>
<p>What&#8217;s confusing is that when there&#8217;s an automatic update notification, the GUI gives you an Express or Custom choice, and only the Custom choice says a reboot may be required. &nbsp;</p>
<p>It implies that the Express choice won&#8217;t need a reboot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347253">
				<div id="div-comment-347253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347253">
			February 17, 2006 at 10:28 am</a>		</div>

		<p>And, this whole &quot;Reboot is required&quot; thing clearly points out that the Automatic Updates settings dialog in Control Panel should say &quot;install and reboot&quot;, not just &quot;install&quot;.</p>
<p>One choice should say &quot;Download updates, but let me choose when to install them and reboot the system.&quot;</p>
<p>Another choice saying &quot;Automatically download recommended updates for my computer and install them and reboot the system [Every day] at [3:00 AM]&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347263">
				<div id="div-comment-347263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347263">
			February 17, 2006 at 10:31 am</a>		</div>

		<p>Suspend:<br />
<br />When I say &quot;shutdown/sleep&quot; I mean &quot;Take your time, don&#8217;t lose my data.&quot;</p>
<p>When I say &quot;Force shutdown/sleep&quot;, or hold in my power button for five seconds, I mean &quot;I understand there may be data loss, but the shutdown is more important than the data in the open applications of which I am aware.&quot;</p>
<p>If I close my laptop lid, or the screen saver has been on for N minutes, or I hit the &quot;power&quot; button on my keyboard by accident, these are not, and should never default to being, the same as holding in my power button for five seconds.</p>
<p>For this reason, I invariably perform a keyectomy on keyboards which have sleep/power buttons, since win2k does not permit these to be disabled or remapped, does not permit apps to prompt when they are hit, and just doesn&#8217;t sleep well at all.</p>
<p>Updater:<br />
<br />&quot;You can get safe update behaviour if you click on unrelated-advanced-option A, but not if you click unrelated-default-option B&quot; is russian roulette at its worst: you default to shooting users.</p>
<p>Files to be updated should be checked to see if they can be updated. If not, the relevant update should set up installation files in the tmp dir, display an &quot;I need to (reboot/close application X) in order to update, may I do so?&quot; and the files should be updated in the reboot or once the application is closed. That&#8217;s what I always assumed it was doing.</p>
<p>The idea that windows itself was playing update-roulette with my data never occurred to me, or, I suspect, any other windows user, because that&#8217;s not how any other updater on earth behaves.</p>
<p>Unlike most of Raymond&#8217;s blogs, where he demonstrated that certain windows behaviours are reasonable, this time it is clear that both these behaviours are not just bad, kludgy, or inefficient: they&#8217;re evil.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347293">
				<div id="div-comment-347293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ashod Nakashian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347293">
			February 17, 2006 at 11:18 am</a>		</div>

		<p>Yet another example of NOT getting it right.</p>
<p>When will MS realize that the USER should choose behavior, NOT WHOEVER HAPPENS TO HAVE TO BALL!</p>
<p>Why not make it an option? Why isn&#8217;t most things an option that the user configures? Don&#8217;t you trust the user to configure to his/her needs? You know better?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347383">
				<div id="div-comment-347383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347383">
			February 17, 2006 at 12:24 pm</a>		</div>

		<p>Ashod Nakashian:</p>
<p>Think about it for a second from a program perspective. &nbsp;Let&#8217;s say that MS lets you, the user, decide the behavior during suspends. &nbsp;You can either have the computer suspend immediately, or you can let applications abort the suspend.</p>
<p>Don&#8217;t you see that if you&#8217;re writing a program, you had better assume that the user is ALWAYS going to force the computer to suspend? &nbsp;If you rely on the user always letting your program abort the suspend, then your program is BROKEN.</p>
<p>MS absolutely got it right in this situation.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-347403">
				<div id="div-comment-347403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347403">
			February 17, 2006 at 12:55 pm</a>		</div>

		<p>Wow, 100 comments in one day. &nbsp;Is that a record for this blog?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347423">
				<div id="div-comment-347423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/larryosterman/archive/2006/02/17/534234.aspx' rel='external nofollow' class='url'>Larry Osterman's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347423">
			February 17, 2006 at 1:09 pm</a>		</div>

		<p>Yesterday, Raymond posted an article about power suspend and it&#8217;s behavior in XP and Vista.&amp;amp;nbsp; It&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347503">
				<div id="div-comment-347503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347503">
			February 17, 2006 at 4:24 pm</a>		</div>

		<p>In the case of automatic reboots, I think there would have to be a flag indicating the urgency of the reboot shipped with the update. Something like &quot;You are vulnerable to attack until the next reboot&quot; would be indicated so that the user would know whether their work or the pending reboot is more important.</p>
<p>People seem to forget that the reboot isn&#8217;t necessary just because the system is in an inconsistent state, but because the system is vulnerable to attack. Most patches nowadays are for security reasons, and any security update that requires a reboot is going to leave the system vulnerable until it happens.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-347513">
				<div id="div-comment-347513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347513">
			February 17, 2006 at 6:14 pm</a>		</div>

		<blockquote><p>
  If you rely on the user always letting your program abort the suspend, then your program is BROKEN.</p>
<p>Um, nonsense. &nbsp;The program knows what the consequences of a suspend are, at any point in time. &nbsp;If these are particularly dire, the program has an OBLIGATION to alert the user.</p>
<p>Imagine suspending in the middle of a write to a document on a network drive, for example.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-347533">
				<div id="div-comment-347533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347533">
			February 17, 2006 at 6:31 pm</a>		</div>

		<p>Ashod: that&#8217;s the whole point! USERS are telling Windows to suspend, but PROGRAMS are saying &quot;no, I don&#8217;t want to do that&quot; &#8211; now Windows is taking the side of the USERS and saying &quot;sorry, program, but you don&#8217;t get a choice in the matter &#8211; I&#8217;ve been told to suspend, so I&#8217;m going to suspend.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347543">
				<div id="div-comment-347543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Isaac Lin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347543">
			February 17, 2006 at 6:42 pm</a>		</div>

		<p>As for &quot;the apps which DON&#8217;T play nicely surely outweigh the ones that do everything right&quot; &#8212; it&#8217;s funny how Windows is the only OS where I see this. &nbsp;As others have mentioned, it doesn&#8217;t happen on OSX. &nbsp;It doesn&#8217;t happen on Linux. &nbsp;It doesn&#8217;t happen on BSD. &nbsp;It probably doesn&#8217;t happen on proprietary Unix-en, though I&#8217;ve never seen any of those to know for sure. </p>
<p>On the contrary &#8212; much Unix code uses ancient pre-POSIX APIs, and I&#8217;ve seen plenty of code that fails to handle signal handling and multi-threading correctly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347583">
				<div id="div-comment-347583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347583">
			February 17, 2006 at 11:19 pm</a>		</div>

		<p>Maurits,</p>
<p>The best way to prevent that is to save a copy of the file first, then overwrite the original. &nbsp;If your save goes bad on you, you can at least open the original without as much loss. &nbsp;I don&#8217;t know how Word does it, but that&#8217;s one of the safest ways to do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-347593">
				<div id="div-comment-347593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347593">
			February 18, 2006 at 12:51 am</a>		</div>

		<p>Maurits, in my experience, word&#8217;s never had a problem resuming from a suspend.</p>
<p>I&#8217;ve seen CD burning apps have issues, and other apps that deal with real-world external devices have issues, but never word (or Excel or Outlook, or&#8230;).</p>
<p>And I open and close my laptop lid ALL the time.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-347553">
				<div id="div-comment-347553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347553">
			February 17, 2006 at 7:50 pm</a>		</div>

		<p>&gt; USERS are telling Windows to suspend</p>
<p>Well&#8230; sometimes.</p>
<p>Consider the following scenario.</p>
<p>Jane is sitting in her office working away on her laptop one cold but sunny day. &nbsp;She&#8217;s typing away on a large Word document which is open from a network drive.</p>
<p>Her neighbor Bill plugs in his portable heater and blows the circuit breaker that they share. &nbsp;He goes off to find a Facilities guy.</p>
<p>Jane happened to be looking out the window for inspiration (as is her wont) and didn&#8217;t notice the screen suddenly dim. &nbsp;She turns back to her Word document.</p>
<p>She carries on typing for a while, then decides to take a break for coffee.</p>
<p>She doesn&#8217;t worry about losing any data&#8230; after a nasty experience in her past, she configured Word to save automatically every fifteen minutes.</p>
<p>Which it does, a few minutes later. &nbsp;Due to a twist of fate, the &quot;suspend&quot; timeout coincides with the middle of the Word autosave. &nbsp;The network file is only partially written to&#8230; corrupting her massive Word document&#8230; losing hours of work.</p>
<p>Now I&#8217;ll ask you. &nbsp;Did Jane tell Windows to suspend?</p>
<p>Notice I left out the part of the story when Jane comes back and sits at her desk. &nbsp;I&#8217;ll let you fill that part in.</p>
<p>Another critical question is, what *should* have happened? &nbsp;The default would have been to suspend anyway. &nbsp;Only if Jane had gone out of her way to set &quot;Let Word cancel suspends&quot; would the document have been saved.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347613">
				<div id="div-comment-347613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">..</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347613">
			February 18, 2006 at 7:27 am</a>		</div>

		<blockquote><p>
  &gt; &quot;You are vulnerable to attack until the next reboot&quot; would be indicated so that the user would know whether their work or the pending reboot is more important. </p>
<p>A boot process can take away 6 minutes, not counting the time to reopen the applications, resuming work etc. There are times (often) when these minutes are precious and cannot be wasted. Of course you can say security is more important but this is seldomly so. Infact there is a huge probability that the specific issue fixed would not affect me anyway, and, above all, Microsoft patches to OS tipically come after 15 days (at least) after the attack is in the wild.. it is not a day more which breaks the whole thing.</p>
<p>That said, for me it&#8217;s not a problem because usually I check away every &quot;automatic&quot; thing.</p>
<p>About those automatic things&#8230; do someone knows how to disable attachment filtering in MSN and Outlook ? It&#8217;s just plain stupid that I cannot receive an exe or an xml.. You can warn me, but I SHOULD HAVE THE LAST WORD.</p>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347623">
				<div id="div-comment-347623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">uniware</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347623">
			February 18, 2006 at 7:52 am</a>		</div>

		<p>a) Windows autoupdate.<br />
<br />Once upon a time, I found my IE doesnot work suddenly. After several minutes, I decided to reboot the computer. It worked well after the reboot. I thought hard and guessed it&#8217;s something related with Windows&#8217; autoupdate.</p>
<p>b) POWER button on some keyboards.<br />
<br />I think the POWER button on keyboards is a bad design. As a programmer, I need to play with different kinds of computers. Some of them have different kinds of keyboards. I remember that I have mispressed the POWER button on some of the keyboards for many times. Yes, I did tell the computer to power off, but I donot want it actually. I was punished by my carelessness. But, can&#8217;t we design the keyboard better?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347633">
				<div id="div-comment-347633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hpl.hp.com/techreports/2000/HPL-2000-21.html' rel='external nofollow' class='url'>Steve Loughran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347633">
			February 18, 2006 at 8:56 am</a>		</div>

		<p>James Summerlin says &quot;Not a single one of you has spent the resources MS has in researching this problem&quot;</p>
<p>James, I have actually invested time logging how end users use laptops, and have presented the results to partners such as MS and Intel, and a summary, &quot;The Secret Life of Notebooks&quot; to the ACM conference on human factors in 2000. That was six years ago. (follow the link above)</p>
<p>By logging system power events, network state changes, application foreground changes etc, I had a pretty good model of system use, the key conclusion being &quot;network state matters a lot more than battery; people work differently offline&quot;. </p>
<p>The other thing I discovered (not in the ACM paper) was the unofficial sleep state, S6. This is the hibernate from which the OS never recovers, &quot;the big sleep&quot;. All too often in the logs the system would hibernate, then suddenly the log would jump to system boot. My hypothesis was the OS (win98SE mostly) couldnt handle the change in state when it resumed -network, devices etc, and ended up crashing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347693">
				<div id="div-comment-347693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://qstuff.blogspot.com' rel='external nofollow' class='url'>Justin Olbrantz (Quantam)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347693">
			February 18, 2006 at 8:05 pm</a>		</div>

		<p>&quot;Regarding the hardcoded C:WINDOWS insanity, I&#8217;m guessing that&#8217;s why Windows 2000 installs to &lt;drive&gt;:WINNT by default, but the later NT-based OSes (XP, 2003, etc.) install to WINDOWS? &nbsp;I wonder how many applications were broken by the behavior in WinNT/Win2K.&quot;</p>
<p>I&#8217;ve actually had a virus install itself in my C:WINNTsystem32. This immediately caught my attention, because I didn&#8217;t HAVE a WINNT directory &#8211; my Windows directory was WINNT_3 (long story) :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347703">
				<div id="div-comment-347703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://qstuff.blogspot.com' rel='external nofollow' class='url'>Justin Olbrantz (Quantam)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347703">
			February 18, 2006 at 8:16 pm</a>		</div>

		<p>I have a question: why not poll programs for how soon they can be ready for suspend (&quot;now&quot;, &quot;real soon&quot;, and &quot;never&quot;) and display something like a green/yellow/red light on the shut down Windows box, so the user can decide for themselves whether or not to suspend (of course whatever the user says will be done, regardless of any misbehaving programs)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-347713">
				<div id="div-comment-347713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347713">
			February 19, 2006 at 2:05 am</a>		</div>

		<blockquote><p>
  The best way to prevent that is to save a copy of the file first, then overwrite the original</p>
<p>IIRC, Word 5.0 saved over the original file, wherever it happened to be. &nbsp;Later versions switched to an &quot;AutoRecover&quot; procedure. &nbsp;In &quot;AutoRecover&quot;, a copy of the present state of the file is saved in the temporary directory, which is usually on a local hard drive.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347723">
				<div id="div-comment-347723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347723">
			February 19, 2006 at 4:35 am</a>		</div>

		<blockquote><p>
  Something like &quot;You are vulnerable to attack until the<br />
  <br />&gt;next reboot&quot; would be indicated so that the user would<br />
  <br />&gt;know whether their work or the pending reboot is more<br />
  <br />&gt;important.</p>
<p>&gt;People seem to forget that the reboot isn&#8217;t necessary<br />
  <br />&gt;just because the system is in an inconsistent state,<br />
  <br />&gt;but because the system is vulnerable to attack.</p>
<p>Except users don&#8217;t care. And they shouldn&#8217;t have to.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347753">
				<div id="div-comment-347753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spaces.msn.com/thewendyhouse/blog/cns!9BD8182714EFE199!2265.entry' rel='external nofollow' class='url'>:: Wendy ::</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347753">
			February 19, 2006 at 3:42 pm</a>		</div>

		<p>I always thought that it depended on who provided the laptop (Dell, Toshiba etc) what the lid close action is. &nbsp;</p>
<p>Yep I want to be able to change some things like if the lid-close action is wrong for my laptops purpose. &nbsp;</p>
<p>I want Software developers and PC manufacturers to make a &#8216;best-guess&#8217; informed by researching what users do. &nbsp;Then provide easily discoverable options to change their &#8216;best guess&#8217; when they know there is a lot of diversity in what users want to do. &nbsp;</p>
<p>I do not want lots of dialogs asking me to make settings choices because I&#8217;m the user and have a right to choose. &nbsp;</p>
<p>I don&#8217;t want options giving me &#8216;choices&#8217; that I cant make, &nbsp;fake-choices where the developer thinks they are doing me a favour but I really am not equipped to make the decision. &nbsp;For example: </p>
<p>&quot;The program &#8216;xyzzy.exe&#8217; has indicated that the system should not be suspended. Do you want to suspend anyway? </p>
<p>How can I make a decision on that kind of information. &nbsp;The last program that blocked shutdown was IE. &nbsp;It looked closed to me. &nbsp;I choose to &#8216;end the process now&#8217; because it&#8217;s what I said earlier and I have no idea what&#8217;s going on so I couldnt make an informed decision. &nbsp;That is &#8211; there is no decision.</p>
<p>Sometimes, &nbsp;it feels like software developers are using &#8216;give the user choice&#8217; as an excuse to<br />
<br />a) sidestep making potnetially expensive and complex design decisions<br />
<br />b) demonstrate they want to give the user control &#8211; as if this was always good. &nbsp;</p>
<p>I dont want to be given choices that are based on a pressumption of technical knowledge or simply supply insufficient information to enable me to make an informed decision.</p>
<p> &nbsp;<br />
<br />PS &nbsp;My laptop power connectiion is sufficiently flakey since the &#8216;melt&#8217; experience that now I will have to get a new one soon. &nbsp;SIGH. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-347763">
				<div id="div-comment-347763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347763">
			February 19, 2006 at 4:52 pm</a>		</div>

		<p>Wendy: I totally agree! I even made a post on the same topic a while ago: <a rel="nofollow" target="_new" href="http://www.codeka.com/blogs/index.php/dean/2005/03/08/when_choice_is_bad" rel="nofollow">http://www.codeka.com/blogs/index.php/dean/2005/03/08/when_choice_is_bad</a></p>
<p>Too bad no one reads my blog :p~</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347773">
				<div id="div-comment-347773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347773">
			February 19, 2006 at 6:52 pm</a>		</div>

		<p>&quot;Apart from those two things, this can be extended to other stuff such as locked files that you can&#8217;t rename, move or delete. I want a &quot;kill all handles of this file&quot; button in the failure dialog.&quot;</p>
<p>I use Process Explorer for that. &nbsp;Whenever I want to rename/delete something and it won&#8217;t let me, I fire up ProcExp and ask it who has it open. &nbsp;Most of the time, I then just summarily close the handle. &nbsp;(Usually, it tends to be the Indexing Service. &nbsp;But not always.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347793">
				<div id="div-comment-347793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wesley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347793">
			February 19, 2006 at 7:06 pm</a>		</div>

		<p>I&#8217;d also like to chime in to say that I reinstalled Windows XP on my Toshiba notebook, and at no point was it mentioned that &quot;Automatic Updates&quot; will automatically cause reboots. &nbsp;At the first boot, it does ask if you want updates downloaded and installed automatically. Nowhere was there a mention of rebooting. (That may be implied as veteran users of Windows knows that most updates require reboots, but new users can&#8217;t possibly know that, or that the &quot;Later&quot; snooze button only works for 5 minutes each time.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347803">
				<div id="div-comment-347803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347803">
			February 19, 2006 at 7:47 pm</a>		</div>

		<p>Responding to myself here, because I&#8217;ve thought of a few more reasons Linux doesn&#8217;t have the &quot;you must reboot&quot; problem, nor does it have a problem with mismatched libraries.</p>
<p>Shared libraries have a &quot;soname&quot; field (at least on ELF systems, which is all of them now). &nbsp;When a program is linked, the linker command references the &quot;bare&quot; library name (for instance, libipc.so). &nbsp;This filename is a symlink to the full-version library file (e.g. libipc.so.1.0.5), which the linker links in. &nbsp;That file may have a soname of (e.g.) libipc.so.1.</p>
<p>When the linker links in the libipc.so.1.0.5 file, it writes a field into the executable that refers to the soname of the library, *not* the full name. &nbsp;Later, when the program is run, the runtime linker/loader reads the soname out of the executable and loads the soname file, not the full-name file. &nbsp;dlopen() likewise is supposed to use the soname (although it can use any name whose symlink points at the correct file).</p>
<p>(There&#8217;s a separate program, ldconfig, which creates a symlink from each library&#8217;s soname to its highest-version full name. &nbsp;ldconfig is supposed to be run every time a library is installed. &nbsp;So the dynamic linker/loader loads the newest library version through the soname symlink.)</p>
<p>Now, the rule for the library author is to change the soname if and only if there&#8217;s an binary-incompatible change in the library. &nbsp;The full filename can change whenever the author wants it to (some packages, e.g. OpenSSL, change it at each release so that multiple releases can coexist if needed, but this is not the only way to do it).</p>
<p>This way, all compatible library versions (including ones whose only difference to the previous is a bugfix) have the same soname. &nbsp;So when the bugfixed library gets installed, the version with the hole gets unlinked, the new version gets installed, and subsequent process startups use the new version. &nbsp;But since the soname is the same, that means it&#8217;s completely compatible; old and new versions can talk to each other without problems.</p>
<p>There&#8217;s still a problem if the bugfix makes the new version incompatible with the old. &nbsp;In that case, there&#8217;s no choice but to recompile (or at least relink) everything that uses the library. &nbsp;But because the new library has a different soname, it&#8217;ll at least not segfault or whatever on processes that haven&#8217;t been fixed.</p>
<p>This situation (bugfixes being incompatible) is rare, though. &nbsp;And even if everything using the library has to be recompiled (e.g. if it&#8217;s a bug in the C library), all the new executables can be installed and started without rebooting the kernel. &nbsp;Even /sbin/init, though it would take a bit of coordinating. &nbsp;(It can re-exec itself once its binary has been replaced. &nbsp;It would just have to be told to do so; I&#8217;m not sure whether this is possible.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347873">
				<div id="div-comment-347873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347873">
			February 20, 2006 at 10:19 am</a>		</div>

		<p>Apparently it seems to be Microsoft&#8217;s favorite distribution: <a rel="nofollow" target="_new" href="http://channel9.msdn.com/ShowPost.aspx?PostID=65355" rel="nofollow">http://channel9.msdn.com/ShowPost.aspx?PostID=65355</a> . I like to use Ubuntu, and have used Debian and SuSE before that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-348003">
				<div id="div-comment-348003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-348003">
			February 20, 2006 at 12:39 pm</a>		</div>

		<p>&quot;If these are particularly dire, the program has an OBLIGATION to alert the user. Imagine suspending in the middle of a write to a document on a network drive, for example.&quot;</p>
<p>Oh good. &nbsp;Now you&#8217;ve designed your program to punish the user so that if they click &quot;Yes, I want to suspend now&quot;, they corrupt their files. Brilliant design.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347823">
				<div id="div-comment-347823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347823">
			February 20, 2006 at 4:42 am</a>		</div>

		<p>But it gets even better: there is a central package manager that makes sure all dependencies are properly met. And there is source for all applications, so they all get to be compiled for the latest library versions. If it fails, a bug is filed and depending on the maintainer and the importance of the package it gets fixed sooner or later. THAT is a *huge* advantage, as it makes constant BC&#8217;ing irrelevant. If a binary doesn&#8217;t work, compile it yourself. Don&#8217;t scream &#8216;but the average user cant&#8217;, because the average user wouldn&#8217;t need to get a binary someplace somewhere and install it. Packages are installed through applications like Synaptic and YaST, lots of them. And all of them were specifically compiled for the release.</p>
<p>Granted, there are plenty distro&#8217;s that lack this ability, but the popular ones do a good job staying popular that way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-348053">
				<div id="div-comment-348053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nekto2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-348053">
			February 20, 2006 at 3:45 pm</a>		</div>

		<p>Should there be a message like &quot;WM_YOU_WILL_DIE&quot; and &quot;in X seconds&quot; as a parameter. So The app will know it&#8217;s fate and write it&#8217;s last will? :)))))<br />
<br /> It will be for new apps and programmer should just make best choice of what to do and it which order if it expected it&#8217;s software to crash soon. First to write down simple flag &quot;we are crashing&quot; so it will know that on next startup. Then to try to save some data without any question to user. (It should be required &#8211; no GUI interaction).</p>
<p> And that will be solution to 0% battery and UPS no power messages.</p>
<p>ps. It&#8217;s fun to boot up laptop to find out dialog box &quot;You have no power left, so we are shutdowning&quot; :)) &nbsp;It was just hibernated with the rest of apps.</p>
<p>pps. As for updates &#8211; the question is not &quot;are you need automatic reboot&quot;. The question is &#8211; &quot;are you need automatic installation of updates&quot;. The person who desides that Windows will automatically install updates is responsible for any data loss becouse of &quot;inconsistence state&quot; ;)<br />
<br /> The best choice (IMHO) is the one when updates are installed only after user confirmed it wants to reboot and most off Apps are already closed.<br />
<br /> Ok there may be than situation &quot;Oh wait &#8211; I need not really any reboot, so hey &#8211; all could start up again without reboot&quot; :) But it is rare situation to consider ;))</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347843">
				<div id="div-comment-347843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-347843">
			February 20, 2006 at 8:04 am</a>		</div>

		<p>Heh &#8212; Gentoo. &nbsp;Where *everyone* compiles it for themselves.</p>
<p>;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-348073">
				<div id="div-comment-348073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-348073">
			February 20, 2006 at 4:15 pm</a>		</div>

		<p>Good sense of humor, Nekto2 :D</p>
<p>If all apps were designed like this: <a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Crash-only_software" rel="nofollow">http://en.wikipedia.org/wiki/Crash-only_software</a><br />
<br />The first sentence isn&#8217;t really true, but it goes on about right: &quot;Correctly written components of crash-only software can microreboot to a known-good state without the help of a user. Since failure-handling and normal startup use the same methods, this can increase the chance that bugs in failure-handling code will be noticed, except when there are leftover artifacts, such as data corruption from a severe failure, that don&#8217;t occur during normal startup.&quot;<br />
<br />It means that starting the application is the same as recovering, and closing it is the same as crashing.<br />
<br />There&#8217;s also a strategy where subsystems of an app can decouple and reattach to prevent the &quot;we&#8217;re about to crash&quot; scenarios.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-348583">
				<div id="div-comment-348583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jspiro.tripod.com' rel='external nofollow' class='url'>Jason Spiro</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-348583">
			February 21, 2006 at 6:06 pm</a>		</div>

		<p>Sean W. wrote above:<br />
<br />&gt; &#8230; I&#8217;ve set this machine to update using &quot;Let me choose when to install them&quot;<br />
<br />&gt; as you suggested. &nbsp;That said, I remember I used to have this thing set to do<br />
<br />&gt; exactly that, and it would never remind me at all that anything needed to be<br />
<br />&gt; done: &nbsp;No messages, no notices, nothing more than an icon in the system tray&#8230;</p>
<p>Maybe you&#8217;ve disabled balloon tips. The systray icon normally pops up a balloon tip that says &quot;New updates are ready to install.&quot;</p>
<p>&gt; that&#8217;s easily overlooked among a dozen others.</p>
<p>The system tray is misused nowadays. Too many apps install tray icons that don&#8217;t do much other than slow down system startup. Why do RealPlayer, QuickTime, WinZip, and my Synaptics touchpad driver all need to show tray icons? Is it to provide free advertising for the manufacturers?</p>
<p>Also, instant messengers (except for Gaim) and P2P clients seem to always minimize themselves to the system tray, as the rant at <a rel="nofollow" target="_new" href="http://shell-shocked.org/article.php?id=285" rel="nofollow">http://shell-shocked.org/article.php?id=285</a> explains. This stops me from Alt-Tabbing to my IM clients. Instead, I have to fuss with tiny icons (I&#8217;m use a laptop with a touchpad) or press Ctrl+Win+Tab a few times to display a hard-to-see dotted icon selection border. IM clients should have a Minimize button, a Minimize to Tray button, and a Close button. Each button should do what it is supposed to.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-348653">
				<div id="div-comment-348653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-348653">
			February 22, 2006 at 7:18 am</a>		</div>

		<p>Do they all work with Alt+Tab when they are not iconified? Atleast one of them that I know (ICQ) uses a toolbar dialog frame by default IIRC.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-349973">
				<div id="div-comment-349973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">memet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-349973">
			February 25, 2006 at 12:41 pm</a>		</div>

		<p> Poor Raymond (or maybe lucky). You are becoming so popular that you will start needing a moderation system pretty soon to weed out the &#8216;trolls&#8217;.<br />
<br /> I really love your blog, but when you have to read through 100+ posts of people who claim to know *the* only right way to do things, it quickly gets tiresome and pointless &#8211; there is no real debate here.<br />
<br /> It reminds me of a very funny article I had once read (slightly coarse language warning): <a rel="nofollow" target="_new" href="http://www.jaypinkerton.com/blog/archives/001160.html" rel="nofollow">http://www.jaypinkerton.com/blog/archives/001160.html</a><br />
<br />quote:<br />
<br />&quot;[&#8230;]I&#8217;m no hypocrite. My opinions? They don&#8217;t matter either. Not to you, anyway. They matter to me, of course&#8211;if I&#8217;m deciding which movie to rent, I&#8217;m the first person I ask. But I wouldn&#8217;t expect you to care one way or another. I could type lengthy manifestos about my religious, political and fashion preferences all day. If you were polite you might pretend to read them. &quot;</p>
<p> Well, I guess I&#8217;m just saying that I don&#8217;t pretend to read the debates, but I still do love the posts. Rock on Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-350193">
				<div id="div-comment-350193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-350193">
			February 27, 2006 at 2:31 am</a>		</div>

		<p>People call this kind of thing a troll too, but think about where this kind of thing comes from.</p>
<p>I just noticed that the Windows Event Viewer contains logs of failed shutdown attempts, at least sometimes. &nbsp;The logs include links to Microsoft&#8217;s web site, where &quot;Windows Help and Support Center&quot; provides really useful helpful information, such as the really useful helpful information that I will quote below.</p>
<p>This is help and support in Japanese, though part of it is funny Japanese that will be understandable by most readers here. &nbsp;I&#8217;m not going to bother translating the few words that really are Japanese, and they&#8217;ll probably get scrambled by the blog&#8217;s software, but they&#8217;re not important.</p>
<p>Now I&#8217;ve just noticed that this Help and Support information says it applies to Windows version 5.2. &nbsp;Version 5.2 is Windows XP x64, Windows 2003 x64, and Windows 2003 32-bit, right? &nbsp;Windows XP SP2 32-bit is still version 5.1, right?</p>
<p>So, does the recommended procedure of pressing the Ctrl key while clicking on the menu header of the Windows Task Manager&#8217;s Shutdown menu really have some effect in version 5.2 stuff that it doesn&#8217;t have in version 5.1? &nbsp;Or is the recommended procedure equally trollish there as it is in Windows XP SP2 32-bit?</p>
<p>Or sure, we can repeat the ordinary shutdown effort, which only repeated the same failure 3 times.</p>
<p>Pulling the power cable worked.</p>
<p>Here are Microsoft&#8217;s recommendations.</p>
<p>詳細<br />
<br />製品: Windows Operating System<br />
<br />ID: 1073<br />
<br />ソース: USER32<br />
<br />バージョン: 5.2<br />
<br />シンボリック名: WARNING_EW_SHUTDOWN_CANCELLED<br />
<br />メッセージ: The attempt by user %2 to restart/shutdown computer %1 failed<br />
<br /> &nbsp; &nbsp;<br />
<br />説明<br />
<br />This event is written when a user or application attempts, but fails, to restart or shut down the computer by using either the graphical user interface (GUI) or the shutdown command.</p>
<p> &nbsp; &nbsp;<br />
<br />対処方法<br />
<br />If you still want to restart or shut down the computer, save any open files, close any applications that are running, and then you can:</p>
<p>Use either the graphical user interface (GUI) or the shutdown command again.<br />
<br />Press CTRL+ALT+DELETE, and then while pressing CTRL, click Shut Down to force a shutdown.<br />
<br />Press the reset or power button on the computer.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-350423">
				<div id="div-comment-350423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-350423">
			February 28, 2006 at 3:08 am</a>		</div>

		<p>How hard is it to change the balloon notification from saying &quot;You can continue working while updates are being installed&quot; to &quot;You&#8217;d better stop working because the system is in a frankenstate while updates are being installed&quot;?</p>
<p>I am grateful that I know not do do any further work in this machine (a guest PC under Virtual PC 2004) until its updates finish and it reboots. &nbsp;I am grateful that I know not to believe this assertion. &nbsp;But why hasn&#8217;t Microsoft fixed it?</p>
<p><a rel="nofollow" target="_new" href="http://www.geocities.jp/hitotsubishi/frankenstate.png" rel="nofollow">http://www.geocities.jp/hitotsubishi/frankenstate.png</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-350773">
				<div id="div-comment-350773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nekto2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060216-06/?p=32263#comment-350773">
			March 1, 2006 at 9:07 am</a>		</div>

		<p>Just an item in shutdown dialog:</p>
<p>&#8211; Shutdown<br />
<br />&#8211; Hibernate<br />
<br />&#8211; Reboot to UPDATED windows</p>
<p>;)</p>
<p>or checkbox &quot;Apply any new updates&quot;.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>