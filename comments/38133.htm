<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-204043">
				<div id="div-comment-204043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">neli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204043">
			August 18, 2004 at 7:51 am</a>		</div>

		<p>LOL, there is 1TB memory available, but there is no addressing space left to map it into :).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204093">
				<div id="div-comment-204093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.articulatebabble.org' rel='external nofollow' class='url'>vince</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204093">
			August 18, 2004 at 8:11 am</a>		</div>

		<p>Wouldn&#8217;t increasing the page size also alleviate this? (Let&#8217;s pretend for a second that wouldn&#8217;t break a bunch of applications that don&#8217;t correctly query the page size from the OS) </p>
<p>I would think bigger page size = less address mapping entries, and thus more physical memory could be mapped (obviously, in different processes).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204113">
				<div id="div-comment-204113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miles Archer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204113">
			August 18, 2004 at 8:32 am</a>		</div>

		<p>It&#8217;s time to move to 64-bit processors&#8230;</p>
<p>You said it, man. I suspect the floodgates will open once MS releases 64 bit windows for the Athlon-64.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204123">
				<div id="div-comment-204123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.positivenetworks.net' rel='external nofollow' class='url'>Steve Dispensa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204123">
			August 18, 2004 at 8:45 am</a>		</div>

		<p>I have a dual opteron 240 that I use to test drivers with, and I&#8217;ve been running the amd64 preview of winxp for a while now.  It works really well, and it is super fast.  I agree with you on the Athalon 64 &#8211; it&#8217;s gonna be a killer.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204143">
				<div id="div-comment-204143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">timchen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204143">
			August 18, 2004 at 9:05 am</a>		</div>

		<p>There is one thing quite interesting about /PAE. On some machines with 4GB RAM installed, Task Manager shows only 3.5GB physical memory. However, if you switch to the PAE kernel, all 4GB is shown. </p>
<p>Some says that it&#8217;s because the BIOS reserves 512MB &quot;physical&quot; address space just below the 4GB line and put the real 512MB RAM above the line. Thus only the PAE kernel sees that 512MB RAM.</p>
<p>I&#8217;m not sure if the explanation is true or not, but the symptom is confirmed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204193">
				<div id="div-comment-204193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Claus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204193">
			August 18, 2004 at 10:47 am</a>		</div>

		<p>I have also heard that BIOS story, about how it hides memory from task manager, but I&#8217;d sure love to hear that story confirmed or refuted by someone &quot;in the know&quot;&#8230;.</p>
<p>Claus</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204213">
				<div id="div-comment-204213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/carmencr' rel='external nofollow' class='url'>Carmen Crincoli</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204213">
			August 18, 2004 at 11:43 am</a>		</div>

		<p>That&#8217;s exactly what happens.  The BIOS (or sometimes devices) remap the memory above the 4GB range, which means without /PAE, Windows can&#8217;t address it.  Once you turn on /PAE, we can see it all again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204223">
				<div id="div-comment-204223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204223">
			August 18, 2004 at 1:34 pm</a>		</div>

		<p>A standard AGP or PCI bus only has 32-bit address lines so MMIO areas for video, network and disk interfaces among other things normally need to be within the first 4 GB of physical memory. (Some hardware allows remapping between PCI and system bus addresses, but I don&#8217;t think this is normally done on the PC aside from the use of GARTs for video.) So in order for a standard PC to do anything useful it can&#8217;t have a whole 4 GB of RAM in the first 4 GB of physical address space, which is why the BIOS prevents that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204263">
				<div id="div-comment-204263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeremy Morton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204263">
			August 18, 2004 at 3:38 pm</a>		</div>

		<p>Hmmm, I wonder if that&#8217;s why our 32GB /PAE machine lists the memory as 31.0 GB.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204323">
				<div id="div-comment-204323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204323">
			August 19, 2004 at 5:27 am</a>		</div>

		<p>Memory-mapped hardware (like almost every PCI device in your system) eats up a chunk of the 4GB physical address space.  For example, one of the boards I&#8217;m writing drivers for now has a 4MB and an 8MB address window.  This cuts into the amount of RAM Windows can see (with 32-bit addressing anyway).</p>
<p>There are some 64-bit PCI devices, which can live above 4GB, but to use them (as a 64-bit device) you need a 64-bit PCI motherboard.</p>
<p>Some devices are I/O mapped (usually legacy ISA devices), which don&#8217;t eat into the 4GB address space.  It&#8217;s pretty rare to see an exclusively I/O mapped device these days, though.</p>
<p>Enabling PAE increases the physical address space, so Windows can fit all 4GB of RAM AND your PCI devices.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204333">
				<div id="div-comment-204333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204333">
			August 19, 2004 at 5:29 am</a>		</div>

		<p>Of course, 64-bit machines have the same problem with 32-bit PCI devices.</p>
<p>The AMD abominations have an on-CPU hardware IOMMU to make this work (the 32-bit devices think that what they&#8217;re getting is memory below 4 GiB but it could be anywhere).  Intel&#8217;s x86-64 implementations don&#8217;t; it&#8217;d go on the Northbridge for Intel, but their chipsets don&#8217;t have one.</p>
<p>AMD&#8217;s IOMMU is a hacked up AGP GART.  It&#8217;s not as capable as a purpose-built IOMMU would probably be, and so inefficient in comparison (to e.g. SPARC64).  But it&#8217;s still better than no IOMMU at all (which is what you get on Intel).</p>
<p>The proper solution, of course, is to use 64-bit PCI devices (PCI-X, PCIe, both of which notionally require 64-bit support, though both of which have devices that are broken and only really work with 32-bit addresses&#8230;).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204833">
				<div id="div-comment-204833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.savagenomads.net/archives/000203.html' rel='external nofollow' class='url'>Savage Nomads</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-204833">
			August 20, 2004 at 1:43 pm</a>		</div>

		<p>&amp;nbsp; As Evan&amp;nbsp;already mentioned on his blog, Raymond Chen has a great series on /3GB switch on his blog. What is really cool is that Raymond takes on some myths about the /3GB switch and&amp;nbsp; the fact that he&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-609723">
				<div id="div-comment-609723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://saltwetfish.wordpress.com/2008/03/13/windebug-3gb-and-pae-switches/' rel='external nofollow' class='url'>Windebug: 3GB and PAE switches &laquo; Salt * Wet * Bytes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040818-00/?p=38133#comment-609723">
			March 13, 2008 at 12:43 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://saltwetfish.wordpress.com/2008/03/13/windebug-3gb-and-pae-switches/" rel="nofollow">http://saltwetfish.wordpress.com/2008/03/13/windebug-3gb-and-pae-switches/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>