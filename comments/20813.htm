<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (45)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-669033">
				<div id="div-comment-669033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AsmGuru62</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669033">
			September 22, 2008 at 10:26 am</a>		</div>

		<p>I remember seeing an API which allows to flash the taskbar button of an application requiring attention of the user. Why developers not using that API instead of stealing focus?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669043">
				<div id="div-comment-669043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexander Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669043">
			September 22, 2008 at 10:30 am</a>		</div>

		<p>Why developers are not using FlashWindow? They don&#8217;t have to. If you pop a modal dialog, and it&#8217;s not a foreground application, that will flash your taskbar button.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669053">
				<div id="div-comment-669053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669053">
			September 22, 2008 at 11:20 am</a>		</div>

		<p>@Alexander Grigoriev:</p>
<p>The installer database isn&#8217;t kept in the registry at all. &nbsp;Those strings are referred to by the MSI team as Darwin Descriptors and are used for a different purpose altogether:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/aa302344.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/aa302344.aspx</a></p>
<p>The Windows Installer copy of the database is stored in C:WindowsInstaller and the full MSI is stored in an arbitrary location chosen by the installer itself.</p>
<p>The real question is: &nbsp;why do you care? &nbsp;And generally speaking, hashing together multiple components of data in a programatically easy fashion is not usually my definition of a moron.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669063">
				<div id="div-comment-669063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Spike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669063">
			September 22, 2008 at 11:44 am</a>		</div>

		<p>@Bryan</p>
<p>&quot;why do you care?&quot; &nbsp;I&#8217;ve often wondered myself where the installer database is kept. &nbsp;But never wondered strongly enough to go and find out. &nbsp;And why do I care? Because sometimes uninstalls fail to complete. &nbsp;The application still appears in the list of installed programs but is actually no longer installed (I hope).</p>
<p>I&#8217;ve often wondered if I can manually remove all those half-uninstalled apps from the list on my machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669073">
				<div id="div-comment-669073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669073">
			September 22, 2008 at 12:33 pm</a>		</div>

		<p>It&#8217;s really amusing that even Windows Vista has to keep supporting APIs that make its user interface as single minded as using a command line. A command line that can arbitrarily decide the directory that it&#8217;s &quot;cd&quot;&#8217;ed into.</p>
<p>The whole wellspring of multi-threading is nearly useless while a single app can hijack the entire windows UI and dance around laughing and slapping its bum. Please for the love of Bill, modal dialogs should not disable the minimize button of the windows that launched them!</p>
<p>There is about 3 different solutions to the problem, from firefox search bar, to IE&#8217;s own windows update activex&#8217;s progress indicator, to mac-os-kitty&#8217;s dialogs that are pinned to windows that launched them. Just pick one and go with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669083">
				<div id="div-comment-669083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669083">
			September 22, 2008 at 12:55 pm</a>		</div>

		<p>@Bryan:</p>
<p>In the article you refer to:</p>
<p>&quot;Shortcuts. Windows Installer introduces a special type of shortcut which, while transparent to the user, contains additional metadata that Windows Installer uses through its shell integration to verify the state of the specified application&#8217;s installation prior to launching the application.&quot;</p>
<p>Unfortunately, also, you cannot drag and drop a file to those half-assed shortcuts, as you could with old good ones. And they always delay the app startup quite a bit.</p>
<p>Those &quot;Darwin Descriptors&quot; are a kludge, anyway. Why a critical file should get removed? Instead you should: prevent users from messing up your installation, by employing the right security practices; provide means to clean your installation unconditionally (should NOT require the original installer to be present anywhere), AND should NOT depend on any of the installed files for uninstallation if you run an external setup.exe (from your original CD). We&#8217;ve all seen examples of the contrary, including those of MS software.</p>
<p>And PLEASE, don&#8217;t do any &quot;check for updated components&quot; behind our backs. Like VS2005 SP1 supposedly does, which is why its installation can take HOURS. And PLEASE, don&#8217;t try to use doubly-bulletproof file copy while installing non-critical files. There is no reason that uncompressing and writing 50 MB of files should even take 1 minute (while it usually takes at least 5 minutes).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669093">
				<div id="div-comment-669093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669093">
			September 22, 2008 at 1:24 pm</a>		</div>

		<p>The issue with Windows Installer setups is that people don&#8217;t integrate with it properly, usually because they don&#8217;t know how. It doesn&#8217;t help that it&#8217;s rather arcane. Classic example: if you want to display a message you don&#8217;t call MessageBox &#8211; you call MsiProcessMessage.</p>
<p>Turn off advertised shortcuts in your product installs if you don&#8217;t want them. What&#8217;s the big deal?</p>
<p>People remove files from installed products accidentally, sometimes deliberately. You might be surprised at the number of people that remove files from an installed product, only to be shocked that it repairs itself. I don&#8217;t see how you could clean up missing files without access to the original install source.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669133">
				<div id="div-comment-669133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669133">
			September 22, 2008 at 2:59 pm</a>		</div>

		<p>Phil: The problem is it isn&#8217;t &quot;my install&quot;, my frustration (and I suspect Alexandre&#8217;s) is from a user perspective. I would very much prefer a shortcut which actually runs the exe file and can receive drop events, rather than an &quot;advertised&quot; one which adds extra hoops to jump through every time. If an application is damaged, I&#8217;ll run a repair operation using the setup utility. Similarly, I hate sitting waiting while an installer keeps me waiting ten minutes while it undoes the ultra-hyper-steroidal-megapacker compression which shaved a megabyte off the ten megabyte ten second download: it might seem like a really clever algorithm, and I&#8217;m sure the authors pat themselves on the back a lot for it, but the end result is substantially worse than any of the alternatives!</p>
<p>(Not to mention that there is definitely something profoundly wrong when I can download the Vista install images from MSDN in less time than the older XP machines take to list the available updates from MS Update. That really infuriates me.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669143">
				<div id="div-comment-669143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669143">
			September 22, 2008 at 3:11 pm</a>		</div>

		<p>@James:</p>
<p>The MSI team foresaw that not everyone would like this:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/aa368297" rel="nofollow">http://msdn.microsoft.com/en-us/library/aa368297</a>(VS.85).aspx</p>
<p>Non-advertised shortcuts regardless of the original installation author&#8217;s intent are only a command line switch away :-)</p>
<p>To verify, I found a blog that would send you to this page on the first page of basically any search engine&#8217;s result for &quot;Disabling Advertised Shortcuts&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669153">
				<div id="div-comment-669153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669153">
			September 22, 2008 at 3:13 pm</a>		</div>

		<p>James:</p>
<p>That megabyte of savings might not seem like a lot to you, but consider the savings over the lifetime of that file download. &nbsp;A significant download (say, XP SP3) might get downloaded millions of times. Suddenly your 10% savings has turned into petabytes of unnecessary bandwidth. Last time I checked, bandwidth still costs money.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669193">
				<div id="div-comment-669193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669193">
			September 22, 2008 at 5:14 pm</a>		</div>

		<p>Bryan,</p>
<p>&quot;disable advertized shortcuts&quot; should not be a command line option, but a default. &quot;enable advertized shortcuts&quot; should be an option. That&#8217;s a thing that should be explicitly enabled by the site admin, instead of being done behind home user&#8217;s back. And, yes, there is no reason an installation should ever get corrupted. If it does, you haven&#8217;t configured your site correctly &#8211; your users are given too much privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669203">
				<div id="div-comment-669203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">wickens85@gmail.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669203">
			September 22, 2008 at 5:15 pm</a>		</div>

		<p>I do hate it when start menu shortcuts don&#8217;t appear to point to anything. They just magically start whatever program they magically point to.</p>
<p>Why can I not use &quot;find target&quot; on these (Office is an example, so is Adobe acrobat).</p>
<p>This just makes spyware easier to hide itself.</p>
<p>I much prefer dragging over an icon from a disk image. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669023">
				<div id="div-comment-669023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669023">
			September 22, 2008 at 10:17 am</a>		</div>

		<p>Another plausible explanation: the function has a nice name that seems related to the problem the programmer was trying to solve and its API is very simple.</p>
<p>I would bet the programmer though it was his *own process* foreground window that the function returned.</p>
<p>That&#8217;s what you get for keeping backward compatibility. You can&#8217;t only have the good sides. You also get bad relic API that no one should ever have a reason to call just so some old program that is arguably bugged can continue running.</p>
<p>/me grumble. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669213">
				<div id="div-comment-669213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669213">
			September 22, 2008 at 5:20 pm</a>		</div>

		<p>@James:</p>
<p>&quot;I hate sitting waiting while an installer keeps me waiting ten minutes while it undoes the ultra-hyper-steroidal-megapacker compression which shaved a megabyte off the ten megabyte ten second download&quot;.</p>
<p>That&#8217;s Acrobat 7 &#8211; after download it was running some obscure &quot;optimizer&quot; which was supposed to uncompress the files. That &quot;optimizer&quot; took like forever to complete.</p>
<p>@Nick:</p>
<p>There&#8217;s no way you can save 10% by a different compression. 1% maybe. And no, even a super pooper decompressor should not be slower that 10 MB/s on a modern processor. Which they still appear to be slower&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669233">
				<div id="div-comment-669233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669233">
			September 22, 2008 at 6:28 pm</a>		</div>

		<p>@Alexandre:</p>
<p>Compare 7zip and normal LZW-related zip. A 10 % vs. 1 % difference is far from absurd.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669263">
				<div id="div-comment-669263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669263">
			September 22, 2008 at 7:48 pm</a>		</div>

		<p>7zip, zip, zlib, bzip2 all suffer from quite short windows for searching for redundancy (e.g. 1MB max).</p>
<p>One can easily get more by searching further. e.g. xdelta.</p>
<p>Propably these guys from this optimizer just used that&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669283">
				<div id="div-comment-669283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669283">
			September 22, 2008 at 8:48 pm</a>		</div>

		<p>Heh, I wrote a really cool installer compressor once. We had a whole bunch of patches (around 40) and there was an optimised delta patch to the current version for each of the earlier versions. There were about a million users, and a surprising number were on really slow dial-up (not all of Australia has DSL or even 56k). Of course the people on 14400 generally also had slow computers, so it took them forever to decompress and apply the patch.</p>
<p>Adobe&#8217;s current updater (and a few others, like Paint.NET) can&#8217;t handle proxies properly, they baulk at authentication.</p>
<p>I also wrote the server-side installer using a really awesome (cough) bunch of BATch scripts, woo! I hear they&#8217;ve just thrown it away and now use a real installer. :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669313">
				<div id="div-comment-669313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669313">
			September 22, 2008 at 10:53 pm</a>		</div>

		<p>&quot;&quot;disable advertized shortcuts&quot; should not be a command line option, but a default. &quot;enable advertized shortcuts&quot; should be an option.&quot;</p>
<p>Why? Install on First Use would probably not work without advertised shortcuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669353">
				<div id="div-comment-669353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669353">
			September 23, 2008 at 7:25 am</a>		</div>

		<blockquote><p>
  I remember seeing an API which allows to flash the taskbar button of an application requiring attention of the user.
</p></blockquote>
<p>This is what SetForegroundWindow is supposed to do when a sibling process calls SetForegroundWindow.</p>
<p>e.g. Once, I wrote a utility providing an optional show/hide global hotkey. I never managed to pop the window up when the hotkey is pressed. Fortunately, there&#8217;s this flashing visual effect which is ok for me.</p>
<p>I don&#8217;t know how most applications really manage to steal the focus, but they do. I don&#8217;t see how to do that without injecting its own code into Microsoft Windows Explorer.</p>
<p>From James:</p>
<blockquote><p>
  Please for the love of Bill, modal dialogs should not disable the minimize button of the windows that launched them!
</p></blockquote>
<p>I agree, the parent window recieves WM_PAINT messages. Why wouldn&#8217;t it recieve resize, minimize and maximize messages?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669403">
				<div id="div-comment-669403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669403">
			September 23, 2008 at 10:18 am</a>		</div>

		<blockquote><p>
  7zip, zip, zlib, bzip2 all suffer from quite short windows for searching for redundancy (e.g. 1MB max).
</p></blockquote>
<p>7-zip allows dictionary size up to 1GB (though you need to use the command-line version to get that, the GUI only exposes up to 64MB).</p>
<p>BTW, on the subject of compression ratio: using zip (zlib) instead of lzma compression in the installer for Gimp (117MB installed) results in 37,7MB installer instead of 17,8MB (bzip2 achieves 28,6MB).</p>
<blockquote><p>
  I don&#8217;t know how most applications really manage to steal the focus, but they do. I don&#8217;t see how to do that without injecting its own code into Microsoft Windows Explorer.
</p></blockquote>
<p>It&#8217;s easy &#8211; make your window always on top, then focus it. Had to do this with an internal application which needed to display an alert when a DOS program was running in full-screen mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669413">
				<div id="div-comment-669413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669413">
			September 23, 2008 at 10:22 am</a>		</div>

		<p>@Alexandre Grigoriev:</p>
<p>You live in a fantasy world. &nbsp;Most users don&#8217;t drag &amp; drop files on to a shortcut ( most don&#8217;t even know you CAN drag &amp; drop a file to a shortcut ) and given the choice, would rather their applications &quot;just work&quot;. &nbsp;Like Yuhong Bao said, disabling that would break a large portion of the functionality provided by Windows Installer.</p>
<p>Advertised Shortcuts are typically desired. &nbsp;The situations where they are not (as rare as those are), they provide a command line parameter to get around it. &nbsp;Disabling advertisement would also affect your ability to roll out applications using Windows Installer deployment technologies. &nbsp;It&#8217;s quite common practice to advertise commonly used applications that everyone might not always need.</p>
<p>Yeesh, you complain for the sake of complaining. &nbsp;If you&#8217;re a site admin of a corporation, you already have a slathering of command lines &#8211; one more isn&#8217;t going to matter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669463">
				<div id="div-comment-669463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669463">
			September 23, 2008 at 11:43 am</a>		</div>

		<p>@Bryan:</p>
<p>You live in fantasy &#8220;corporate only&#8221; world, where the users are clueless and should be herded. Most of home users are clueless, too, but not all.</p>
<p>I&#8217;m not sure, though, why in this age of multigigabyte hard drives anybody would need to have install by demand. Just install it. If you want to save some disk space, use disk compression. </p>
<p>Have you never seen an application that will do that stupid &#8220;install&#8221; every time you run it, AND wanted the installation CD? I saw; one of old MS Office apps. It would be great if all those great features just worked, without excessive delay and without confusing the user. Unfortunately, we don&#8217;t live in an ideal world, and Microsoft screws up more often than we ever wanted.</p>
<div class="post">[<i>You already answered your question. The &#8220;anybody&#8221; who wants install-on-demand are the corporate fantasy-world folks. Without install-on-demand, if you log onto your workstation in Singapore via roaming user profiles, you&#8217;d  you have to wait 3 hours for all the deployed applications to be installed onto your machine before you can check your email. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669483">
				<div id="div-comment-669483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669483">
			September 23, 2008 at 11:46 am</a>		</div>

		<p>@SuperKoko:</p>
<p>James&gt; Please for the love of Bill, modal dialogs should not disable the minimize button of the windows that launched them!</p>
<p>&quot;I agree, the parent window recieves WM_PAINT messages. Why wouldn&#8217;t it recieve resize, minimize and maximize messages?&quot;</p>
<p>Parent window doesn&#8217;t receive any keyboard and mouse messages, because it&#8217;s disabled. You cannot click any button. You can provide a minimize button in your dialog, though, and forward the minimize command to your main window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669513">
				<div id="div-comment-669513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bitvise.com/' rel='external nofollow' class='url'>denis bider</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669513">
			September 23, 2008 at 12:38 pm</a>		</div>

		<p>Raymond says: &quot;And that&#8217;s how the installation program ends up disabling Task Manager.&quot;</p>
<p>As a security developer, I cannot fathom why Microsoft has not yet given the Task Manager a protected environment to execute in.</p>
<p>Two things are sorely missing in Windows:</p>
<p>(1) The ability to suspend all executing processes except Task Manager (and other trusted system processes) at the press of a key.</p>
<p>(2) The ability to run Task Manager even when everything else is crapping on the desktop.</p>
<p>As it is, the easiest way for any Windows user to create a DoS condition is to keep launching new child processes (or threads!) in a loop. Launch enough, and this will completely cripple the machine. Intervention is hardly possible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669543">
				<div id="div-comment-669543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669543">
			September 23, 2008 at 1:34 pm</a>		</div>

		<p>This is so annoying, apps should never steal the focus unless as a direct result of a user action.</p>
<p>Related, and just as annoying are applications with large, always-on-top splash screens. Sure I&#8217;ve got a multi-core multi-gigabyte multitasking monster under my desk, but who needs multitasking stuff anyway if you can have the pleasure of watching product X start up.</p>
<p>Most annoying is the time tracking application I have to use at work. I always forget to enter my hours so I have scheduled a task at 17:00 sharp that starts the application. I usually work until 18:00 but it varies so I set it an hour early to be on the safe side. This application pops up this very annoying always-on-top screen while it loads. Why the heck a simple app like this needs a splash screen and why it takes 10 to 20 seconds to start is a complete mystery to me, but because it starts an hour before I leave I&#8217;m usually just in the middle of something when it pops up. It also has the most boring splash-screen picture ever.</p>
<p>On the Mac there&#8217;s at least the bouncing-dock-icon startup indicator, &nbsp;which is still distracting but at least not always-on-top in the middle of the screen. Unfortunately, Office::Mac still feels the need to display this pretty, but useless and annoying partially-transparent splash screen thingy. Fortunately, I hardly use Office at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669583">
				<div id="div-comment-669583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669583">
			September 23, 2008 at 4:06 pm</a>		</div>

		<p>I hate those advertised shortcuts because I can&#8217;t use RunAs (and DnD, as somebody mentioned).</p>
<p>Why can&#8217;t the shell be smart enough to handle them like regular shortcuts?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669593">
				<div id="div-comment-669593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669593">
			September 23, 2008 at 5:56 pm</a>		</div>

		<p>@Raymond:</p>
<p>&#8220;The &#8220;anybody&#8221; who wants install-on-demand are the corporate fantasy-world folks. &#8220;</p>
<p>I&#8217;m sure the corporate folks would know the magic command line switch to enable install by demand and advertised shortcuts. Unfortunately, a lot of consumer grade software (and MS Office, too) is by default using those evil shortcuts, which we, lowly home users, don&#8217;t want, thank you very much.</p>
<div class=post>[<i>I thought Office defaulted to normal install; install on demand is an option. The &#8220;evil shortcuts&#8221; are there for the people who choose install on demand. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669623">
				<div id="div-comment-669623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669623">
			September 23, 2008 at 8:13 pm</a>		</div>

		<p>@Aargh:</p>
<p>&quot;Unfortunately, Office::Mac still feels the need to display this pretty, but useless and annoying partially-transparent splash screen thingy&quot;</p>
<p>Also add to the list of annoying things Microsoft thinks we should not live without:</p>
<p>Alt+LButton opens that &quot;Research&quot; pane. Unfortunately, I&#8217;m not one of those 10 people that use Research. If I hold Alt (for Alt+Tab) and then want to dismiss that AltTab window by clicking away, it often end up in in Outlook, and opens that annoying tab. THERE IS NO WAY TO DISABLE THAT MOUSE SHORTCUT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-669633">
				<div id="div-comment-669633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669633">
			September 23, 2008 at 9:01 pm</a>		</div>

		<p>&quot;THERE IS NO WAY TO DISABLE THAT MOUSE SHORTCUT&quot;</p>
<p>How about you don&#8217;t install the &quot;Research&quot; feature when you install Office? It&#8217;s underneath &quot;Office Tools&quot; and it&#8217;s called &quot;Research Explorer Bar&quot;.</p>
<p>In fact, because the .msi files are kept right there on the disk when you install Office, you don&#8217;t even need the CD to remove it. Just select &quot;Change&quot; from the toolbar in &quot;Programs &amp; Features&quot; and then deselect it.</p>
<p>What an age we live in!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669663">
				<div id="div-comment-669663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669663">
			September 24, 2008 at 12:47 am</a>		</div>

		<p>Thank you everyone for reminding me how advertised shortcuts SUCK!</p>
<p>I once tried uninstalling application and the original installer was corrupt. Then I tried to remove it manually by deleting files.</p>
<p>But no&#8230; RIGHT-CLICK on a desktop lauched the installer which tried to repair the application and it couldn&#8217;t because it was corrupted effectively standing there hanging my computer completely so I could barely bring up the Task Manager and kill msiexec.exe.</p>
<p>That&#8217;s not all&#8230; wait for it&#8230; another accidental click and it re-lauched the setup! I couldn&#8217;t stop the menace from re-lauching itself until I somehow managed to start Total Commander and killed both msiexec.exe <em>and</em> explorer.exe and then deleted all crap from that application thoroughly by using msizap which of course required me to dig into the registry and find the damn product code.</p>
<p>God how I wished to know which shell extensiong was responsible for that re-launching &quot;feature&quot; so I can nuke it into the Sun!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669673">
				<div id="div-comment-669673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669673">
			September 24, 2008 at 12:53 am</a>		</div>

		<p>Keeping those MSI (and MSP!) files as a requirement for uninstallation is downright crazy. They eat space, can become corrupted just like the application itself, and when they do they wreak havoc with those stupid advertised shortcuts.</p>
<p>If the installer was smart enough to figure out that it can&#8217;t repair the application or when I don&#8217;t want it to repair it automatically, then it might have been usefull. This way it sucks.</p>
<div class=post>[<i>Hey, Igor, long time no see! Good to see that you&#8217;re sticking to your rule that every comment must include the word &#8220;suck&#8221;. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-669693">
				<div id="div-comment-669693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669693">
			September 24, 2008 at 2:48 am</a>		</div>

		<p>Corrupted Files Make Your Applications Run Incorrectly, film at 11.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669703">
				<div id="div-comment-669703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669703">
			September 24, 2008 at 3:59 am</a>		</div>

		<p>[I thought Office defaulted to normal install; install on demand is an option. The &quot;evil shortcuts&quot; are there for the people who choose install on demand. -Raymond]</p>
<p>I have yet to see a MSI package that doesn&#8217;t default to advertised shortcuts, and I agree that they&#8217;re annoying. I stopped counting how often Windows Installer decided that something is wrong with the application and tried to reinstall it (requesting the original CD in the process), then failed because some updates were installed that made the original .msi files somehow incompatible with what was installed (this most commonly happened with Office 2000 after SR-1a was applied, but I&#8217;ve seen it with some other programs). Of course, launching the .exe directly made the application work without any apparent problems.</p>
<p>Also, good work on requiring the original install source when uninstalling.</p>
<p>And while I&#8217;m whining about MSI: why does it display progress bars at all when they&#8217;re totally and completely useless, since they&#8217;ll fill up several times (my personal favourite in this regard is the Office 2000 SR-1a update, which would fill the progress bar 17 times before reboot, and then 5 more times after reboot &#8211; yes, I installed it manually enough times that I counted).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669773">
				<div id="div-comment-669773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669773">
			September 24, 2008 at 10:50 am</a>		</div>

		<p>Raymond said: &quot;Hey, Igor, long time no see! Good to see that you&#8217;re sticking to your rule that every comment must include the word &#8216;suck&#8217;.&quot;</p>
<p>Hey there Raymond, it&#8217;s good to be back, thank you.</p>
<p>But you are right, I should improve my comment writing skills &#8212; I&#8217;ll start using the word &quot;blow(s)&quot; as well from now on :)</p>
<p>Nitpick note: this post unintentionally includes the problematic word because it is a part of the quoted text.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669783">
				<div id="div-comment-669783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669783">
			September 24, 2008 at 10:57 am</a>		</div>

		<p>&gt;&gt;Corrupted Files Make Your Applications Run Incorrectly</p>
<p>You say that as if I am the one responsible for file corruption when I am not.</p>
<p>In short, application which does not safeguard against invalid input data is not something I want running on my computer. Proper input validation was the first thing I learned when I started learning programming.</p>
<p>File checksums and data range checking have been invented so that responsible developers can write applications which fail gracefully instead of taking down the whole system if and when they really have to fail.</p>
<div class="post">[<i>I can&#8217;t tell any more whether you are in favor of or opposed to MSI shortcuts. You hate them yet you argue for their features. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-669873">
				<div id="div-comment-669873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669873">
			September 24, 2008 at 1:08 pm</a>		</div>

		<p>Igor: &gt;&gt;File checksums and data range checking have been invented so that responsible developers can write applications which fail gracefully instead of taking down the whole system if and when they really have to fail.</p>
<p>[I can&#8217;t tell any more whether you are in favor of or opposed to MSI shortcuts. You hate them yet you argue for their features. -Raymond]</p>
<p>How about stopping doing involuntary things behind our backs? Don&#8217;t do stupid reinstallation automatically; if your super smart Microsoft Installer detects that an installation is possibly corrupted, how about asking an user whether he wants to fix it or erase the damn application from the face of Earth completely? Don&#8217;t create &#8220;evil shortcuts&#8221; by default; only if the site administrator wants them.</p>
<div class=post>[<i>MSI is doing what it does because the install package asked for it. Or are you saying that MSI should ignore what the programmer requested and the documentation should be changed to read &#8220;DISABLEADVTSHORTCUTS: This setting is ignored. Advertised shortcuts are never created.&#8221;? I can put you in touch with some large corporations who would object strenuously to this change. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669883">
				<div id="div-comment-669883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-669883">
			September 24, 2008 at 1:48 pm</a>		</div>

		<p>[I thought Office defaulted to normal install; install on demand is an option. The &#8220;evil shortcuts&#8221; are there for the people who choose install on demand. -Raymond]</p>
<p>But they are used even if you choose normal install.</p>
<div class=post>[<i>Would you prefer that Office come with two installers? -Raymond</i>]</div>
<p>BTW, the first version of the Windows Shell to support MSI shortcuts was I think the version that came as part of IE 4 SP2.</p>
<div class=post>[<i>Ah, it wouldn&#8217;t be a proper Yuhong Bao comment without a marginally-on-topic tangent.</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-670043">
				<div id="div-comment-670043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt [C++ MVP]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670043">
			September 24, 2008 at 5:40 pm</a>		</div>

		<p>Raymond wrote [MSI is doing what it does because the install package asked for it. Or are you saying that MSI should ignore what the programmer requested and the documentation should be changed to read &#8220;DISABLEADVTSHORTCUTS: This setting is ignored. Advertised shortcuts are never created.&#8221;?]</p>
<p>No, I think what we are all suggesting is that there should be one registry setting (&#8220;Installer Expert Mode&#8221;), with an appropriately buried GUI (like the disable UAC setting), that causes Windows Installer to display a dialog with all the override options (and a &#8220;remember these options as default&#8221; button) every time it starts. Then we power users could hit &#8220;Disable Advertised Shortcuts&#8221; and whatever other nifty options the installer team intended us to have, with the possibility to change them on a per-application basis, without having to pass command-line arguments. A setting to globally disable advertised shortcuts would be good too.</p>
<div class=post>[<i>Wow that sounds pretty complicated &#8211; especially the &#8220;per-application basis&#8221;: Who enjoys typing in GUIDs? And presumably there&#8217;s some way of resolving the conflict between &#8220;show me this dialog every time a program installs&#8221; and &#8220;install in silent mode&#8221;. And that advanced dialog will really mess up installers that customize their UI. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-670063">
				<div id="div-comment-670063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670063">
			September 24, 2008 at 7:12 pm</a>		</div>

		<p>Raymond, my point was that MSI does an EVIL thing &#8212; it attempts to auto-repair an application over and over again even though the installer cache is corrupted.</p>
<p>In my opinion, what is wrong is that the MSI offers some potentially usefull but at the same time dangerous options when not used responsibly.</p>
<p>One example is auto-repair launched by shell extension and advertised shortcuts.</p>
<p>If it is offering such an option to the setup maker, then it should be smarter &#8212; it should check the size of the install package, checksum it and if corrupt give an option to remove the remnants and not bug the user again.</p>
<p>Another example is auto-defragmentation launched after the setup.</p>
<p>I have seen a lot of vendors using those options irresponsibly.</p>
<p>When someone is using something irresponsibly there has to be an override.</p>
<p>Here is a scenario for you and please do not anonymize it &#8212; I want to read a <font color=red>XYZ</font> document on a freshly installed computer and I am in a hurry. I launch <font color=red>XYZ Viewer</font> installer, it installs the application, and it then proceeds to use Windows built-in defragmenter to defragment its files even though I use another one with completely opposite file sorting strategy, and there is nothing to defragment on a freshly instaleld system.</p>
<p>So it wastes my time (I can&#8217;t use the application immediately), it does things I don&#8217;t want it to do (messes up my file layout), and it doesn&#8217;t give me an override === EVIL.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-670193">
				<div id="div-comment-670193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670193">
			September 25, 2008 at 10:11 am</a>		</div>

		<p>@Igor</p>
<p>&quot;If it is offering such an option to the setup maker, then it should be smarter &#8212; it should check the size of the install package, checksum it and if corrupt give an option to remove the remnants and not bug the user again.&quot;</p>
<p>I like your idea of CRC checking, but how do you present the user who isn&#8217;t capable of making such decisions (for security or knowledge reasons) a dialog on that topic? &nbsp;I think if there&#8217;s a good way to do something like this then it would be a good thing. &nbsp;Perhaps send your suggestion to <a href="mailto:msiwish@microsoft.com">msiwish@microsoft.com</a>, since Raymond isn&#8217;t the MSI team.</p>
<p>&quot;Another example is auto-defragmentation launched after the setup.&quot;</p>
<p>Windows Installer doesn&#8217;t support or deal with defragmenting anything.</p>
<p>But the truth is that you do have options. &nbsp;You have simply chosen to ignore those options or you have chosen to not seek them out. &nbsp;If you are a power user / administrator type user then use the power user / administrator type tools provided by the MSI team. &nbsp;For example, start with the Windows Installer Cleanup Utility:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/aa370523.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/aa370523.aspx</a></p>
<p>Also, if you don&#8217;t investigate why you&#8217;re getting auto repair it&#8217;s going to be really hard to just solve the problem on your own or &quot;fake&quot; the MSI engine in to thinking nothing is broken. &nbsp;Try out <a rel="nofollow" target="_new" href="http://www.installsite.org/pages/en/msifaq/a/1037.htm" rel="nofollow">http://www.installsite.org/pages/en/msifaq/a/1037.htm</a></p>
<p>But mucking about with an application vendor&#8217;s deployment strategy is not likely going to endear them to you and it&#8217;s often times a violation of their EULA.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-670233">
				<div id="div-comment-670233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.notlevicki.net' rel='external nofollow' class='url'>Not Igor Levicki</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670233">
			September 25, 2008 at 11:01 am</a>		</div>

		<blockquote><p>
  Here is a scenario for you and please do not anonymize it
</p></blockquote>
<p>Come on, Raymond! I&#8217;m special, I shouldn&#8217;t have to obey the rules of the blog as they apply to everyone else.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-670533">
				<div id="div-comment-670533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670533">
			September 25, 2008 at 6:03 pm</a>		</div>

		<p>Bryan said : &#8220;I like your idea of CRC checking, but how do you present the user who isn&#8217;t capable of making such decisions (for security or knowledge reasons) a dialog on that topic?&#8221;</p>
<p>User doesn&#8217;t need to know about CRC or other technical details, all he should get is a dialog saying:</p>
<p>&#8220;XYZ&#8217;s installer cache has been corrupted. As a result, installation auto-repair may not be possible. Would you like to&#8221;</p>
<p>( ) Attempt auto-repair anyway (may hang your system)</p>
<p>( ) Remove XYZ&#8217;s remnants from your system so you can re-install it later</p>
<p>(*) Just leave me alone until the next reboot!</p>
<p>[x] Remember my choice for future installation issues with this product.</p>
<p>Would that be so hard to implement? I don&#8217;t think so! Would it improve user experience? Tremendously!</p>
<p>One thing I agree with you though &#8212; it is not Raymonds fault in any way. The reason I am bringing it up is MSI&#8217;s tight shell integration which causes the problem and there is no override.</p>
<p>Bryan said : &#8220;Windows Installer doesn&#8217;t support or deal with defragmenting anything.&#8221;</p>
<p>I am not sure which interface is used for defragmentation (it appears to be using built-in defragmenter), but in the <font color=red>XYZ</font>.msi in a Property table there is an entry called <font color=red>XYZ_OPTIMIZATION</font> and it is set to &#8220;YES&#8221;.</p>
<div class=post>[<i>And that flag is custom to product XYZ. It&#8217;s not part of MSI. -Raymond</i>]</div>
<p>Bryan said : &#8220;You have simply chosen to ignore those options or you have chosen to not seek them out&#8221;</p>
<p>That is not true. I often use Orca to fix irresponsible use of MSI features when I am aware of it in advance.</p>
<p>However, in a situation when the installer hangs my computer repeatedly re-launching itself in a brain-dead attempt to repair from broken installation source what options do I really have?</p>
<p>Bryan said : &#8220;But mucking about with an application vendor&#8217;s deployment strategy&#8230;&#8221;</p>
<p>You call that strategy?!? Oh man&#8230;</p>
<p>Anonymous Coward said : &#8220;Come on, Raymond! I&#8217;m special&#8230;&#8221;</p>
<p>I never said I am special, I just asked Raymond not to anonymize application name because I am not criticising the application but the deployment system, and I am giving an example everyone is already familiar with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-670723">
				<div id="div-comment-670723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670723">
			September 26, 2008 at 3:50 am</a>		</div>

		<p>Oh, I forgot my fauvorite gripe with MSI installs: why won&#8217;t they stay on non-primary monitors?!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-670873">
				<div id="div-comment-670873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Apparently Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670873">
			September 26, 2008 at 11:57 am</a>		</div>

		<blockquote><p>
  I never said I am special
</p></blockquote>
<p>Raymond&#8217;s ground rules state:</p>
<p>&quot;You can talk about a program, but you have to call it &quot;Program X&quot; or something like that.&quot;</p>
<p>You&#8217;re saying you should be allowed to ignore the ground rules, unlike everyone else who posts on this blog. I call that &quot;thinking you&#8217;re special&quot;. Sorry if you disagree with the terminology.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-670903">
				<div id="div-comment-670903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080922-00/?p=20813#comment-670903">
			September 26, 2008 at 1:56 pm</a>		</div>

		<p>Raymond said: &#8220;And that flag is custom to product XYZ. It&#8217;s not part of MSI.&#8221;</p>
<p>Raymond, you are right. This functionality is a part of <font color=red>XYZInst</font>.dll which is included in the .msi file. It exports two functions &#8212; DefragmentFiles() (from a proprietary table in the MSI database) and SetOptimizationStatus().</p>
<p>I am not ashamed to admit when I make a mistake &#8212; I incorrectly believed that this functionality is offered by the Installer.</p>
<p>But there is still an issue with auto-repair.</p>
<p>Anonymous Coward said: &#8220;You&#8217;re saying you should be allowed to ignore the ground rules&#8230;&#8221;</p>
<p>I believed that Raymond&#8217;s rule:</p>
<p>&#8220;You can talk about a program, but you have to call it &#8220;Program X&#8221; or something like that.&#8221;</p>
<p>Actually means:</p>
<p>&#8220;You can talk about a program (describing its bad behavior), but you have to call it &#8220;Program X&#8221; or something like that.&#8221;</p>
<p>Since I wasn&#8217;t talking about the program X&#8217;s bad behavior but about what I believed was bad Windows Installer behavior I thought it was ok to mention the program name. Since it isn&#8217;t Windows Installer fault in that particular case (thanks Raymond for clearing that up) I can now post a rant on my website bashing corporation&#8217;s XYZ deployment strategy.</p>
<div class=post>[<i>That&#8217;s why the rule is phrased the way it is. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>