<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-442813">
				<div id="div-comment-442813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442813">
			November 15, 2006 at 10:28 am</a>		</div>

		<p>Reminds me of the old 320x200x8bit VGA mode. &nbsp;Just under 64K of framebuffer RAM required, so even the woefully inadequate DOS programs could address the entire display using one segment (at segment:offset addresses A000:0000 through A000:ffff, IIRC). &nbsp;And it had the same 256-entry palette (though I think the palette was composed of three bytes per entry, not four).</p>
<p>And of course the same effects were possible; you could modify the palette instead of the display if you needed to do a global color change.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442863">
				<div id="div-comment-442863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MichaelAbrashWasMyHero</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442863">
			November 15, 2006 at 12:07 pm</a>		</div>

		<p>yeah remember how you used to program effects for games like this? &nbsp;Like making a waterfall look like it was flowing with palette rotation?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-442893">
				<div id="div-comment-442893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.benryves.com/' rel='external nofollow' class='url'>Ben Ryves</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442893">
			November 15, 2006 at 12:32 pm</a>		</div>

		<p>who could forget that nifty wormhole effect in FC&#8217;s Unreal? :)</p>
<p>It&#8217;s a shame that the .NET analogue (manipulating Bitmap.Palette) appears to be so horribly slow to retrieve and update; to the extent that it is significantly faster to just rewrite every pixel in a 32bpp Bitmap yourself than update the palette. (By significant, I mean reducing a &quot;100%&quot; CPU load and half the original framerate to about 10% &#8211; this is when called in a render loop).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442903">
				<div id="div-comment-442903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442903">
			November 15, 2006 at 12:55 pm</a>		</div>

		<p>Where did the magic numbers come from for converting to greyscale? &nbsp;Is that a &#8220;standard&#8221; set of values, or something you came up with?</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/07/30/4123208.aspx" rel="nofollow">Response</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-442923">
				<div id="div-comment-442923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://com2kid.wordpress.com' rel='external nofollow' class='url'>Devlin Bentley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442923">
			November 15, 2006 at 1:11 pm</a>		</div>

		<p>Yes, palette rotations rocked. &nbsp;:) &nbsp;I remember many old games that used them.</p>
<p>Hey, shouldn&#8217;t this post have been obvious to everybody? &nbsp;I am still in College and I knew this. :-D</p>
<p>256 colors an portray a lot of information. &nbsp;As long as the material is not photographic (or photorealistic), it is enough for most images. &nbsp;One reason that GIFs are still around!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442953">
				<div id="div-comment-442953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.justresting.net/blog/' rel='external nofollow' class='url'>Mark</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442953">
			November 15, 2006 at 2:03 pm</a>		</div>

		<p>GregM: Check out <a rel="nofollow" target="_new" href="http://www.bersoft.com/bimagem/help/color_channels.htm" rel="nofollow">http://www.bersoft.com/bimagem/help/color_channels.htm</a></p>
<p>&quot;The coefficients 0.299, 0.587 and 0.114 properly computed luminance for monitors having phosphors that were contemporary at the introduction of NTSC television in 1953, however, these coefficients do not accurately compute luminance for contemporary monitors.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-442963">
				<div id="div-comment-442963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442963">
			November 15, 2006 at 2:29 pm</a>		</div>

		<p>Well, it wasn&#8217;t just games (ultime underworld 2, clearly the best game of all time, used it for fires, magic effects, and other things).</p>
<p>Windows 95 used it too, on the loading screen. Remember the progress banner scrolly thingy at the bottom? Pallette rotated.</p>
<p>Which meant that you could create cool, slightly-animated loading screens :D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442973">
				<div id="div-comment-442973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-442973">
			November 15, 2006 at 3:44 pm</a>		</div>

		<p>I remember all the cool kids had &quot;The Matrix&quot; animated Windows 95/98 load screens.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-443043">
				<div id="div-comment-443043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443043">
			November 16, 2006 at 2:11 am</a>		</div>

		<p>Raymond, you know very well that there are a bunch of unfortunates<br />
out there who just copy &amp; paste the first code they see off the<br />
&#8216;net, then you get the problems and write about how stupid they are<br />
some months down the road. Can&#8217;t you at least set a good example by not<br />
assuming that Windows lives in C:Windows, please?</p>
<div class="post">[<i>That is not the point of the article. I&#8217;m<br />
assuming you&#8217;re smart enough to know that I&#8217;m hard-coding for<br />
expository purposes, in the same way that I often ignore error checking<br />
for the same reason. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008195987d odd alt thread-odd thread-alt depth-1" id="comment-443063">
				<div id="div-comment-443063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Spire' rel='external nofollow' class='url'>Spire</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443063">
			November 16, 2006 at 3:43 am</a>		</div>

		<p>BryanK: The stock 320&#215;200&#215;8bit MCGA/VGA video mode (0x13) used the address range from A000:0000 to A000:F9FF. The 256-color palette was set by writing directly to a couple of ports on the VGA. (But you had do it during vertical blank if you didn&#8217;t want any snow!) Each palette entry occupied three bytes, but only the lowest six bits of each byte were used. If you wanted to use a standard 24-bit palette, you would have to shift every byte two bits to the right before sending it to the VGA.</p>
<p>That was the basic stuff. The VGA could actually do modes better than 320&#215;200&#215;8bit, but there was no BIOS support for them, so you&#8217;d have to program them in yourself by manipulating the VGA registers directly. The famous &quot;Mode X&quot; (320&#215;240&#215;8bit) needed more than a segment of memory to be addressed, so to get it to work you&#8217;d have to &quot;unchain&quot; the VGA and access the frame buffer as four parallel planes. It was actually similar to working with the stock 4-bit EGA and VGA modes. (Little known fact: VGA always used planes internally; the elegant linear frame buffer in mode 0x13 was implemented as a clever hack.)</p>
<p>Good times, good times.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-443083">
				<div id="div-comment-443083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443083">
			November 16, 2006 at 8:10 am</a>		</div>

		<p>At some point, graphics cards with very slow palette switching started appearing, killing the great palette-rotation effects &#8211; the latest games using 256 colors usually included an option to disable it (StarCraft comes to mind, and Diablo got it added on a patch).</p>
<p>If I had to guess, perhaps the culprit cards stored always RGB and when changing a palette entry they rescaned the whole image- wait, that wouldn&#8217;t even work at all. Perhaps they stored two copys &#8211; RGB and indexes?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443113">
				<div id="div-comment-443113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443113">
			November 16, 2006 at 11:27 am</a>		</div>

		<p>Ah &#8212; I knew about the &quot;Mode X&quot; stuff, but never learned how to work with it. &nbsp;Since it&#8217;s planar and not linear, it sounds like it&#8217;s harder to work with (from the program&#8217;s POV) than 0x13 was.</p>
<p>And right, it&#8217;s F9FF because it isn&#8217;t a full segment (64000 bytes, not 65536). &nbsp;Minor little details. &nbsp;;-)</p>
<p>I do remember the VESA interface, though &#8212; where you had to map a 64K chunk of the full large-resolution linear framebuffer into a fixed 64K segment at a time. &nbsp;And if you had to draw across multiple chunks of the large framebuffer, you had to call into one of the VESA software interrupts to remap the 64K window. &nbsp;That was also a PITA.</p>
<p>Good times? &nbsp;Well, maybe&#8230; &nbsp;;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-443173">
				<div id="div-comment-443173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nomenclature</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443173">
			November 16, 2006 at 1:13 pm</a>		</div>

		<p>Colorkeying = transparency</p>
<p>Alphablending = translucency</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443183">
				<div id="div-comment-443183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Slow palette</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443183">
			November 16, 2006 at 1:31 pm</a>		</div>

		<p>My old 286/12 with VGA could change 800k of palette entries per second (which was about ten colors per scanline, if I remember correctly). Same program on a P200 with PCI-card did write 1.2 MB/s. I would bet modern graphics cards isn&#8217;t much better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-443273">
				<div id="div-comment-443273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443273">
			November 17, 2006 at 3:54 am</a>		</div>

		<p>&gt; I&#8217;m assuming you&#8217;re smart enough to know that I&#8217;m hard-coding for expository purposes</p>
<p>I am, but then I wouldn&#8217;t do that (hard code the path) anyway. It is<br />
the other n% of the software developing population you have to worry<br />
about (those who, like I said, just copy &amp; paste source off the<br />
web).</p>
<div class="post">[<i>Somebody who copies/pastes this code will have a<br />
hard-coded path to the Gone Fishing bitmap in their app. Unless they&#8217;re<br />
really interested in Gone Fishing, I strongly suspect they&#8217;re going to<br />
change the hard-coded path anyway. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443363">
				<div id="div-comment-443363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tungware.com' rel='external nofollow' class='url'>Henry Skoglund</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-443363">
			November 17, 2006 at 4:28 pm</a>		</div>

		<p>Maybe I am just being picky today but shouldn&#8217;t you add 50 to make the B/W computation round off correctly, like this: (in theory you otherwise lose half a percent of luminance)</p>
<p>BYTE b = (BYTE)((30 * rgbColors[iColor].rgbRed +</p>
<p>59 * rgbColors[iColor].rgbGreen + 11 * rgbColors[iColor].rgbBlue + 50) / 100);</p>
<p>Rgrds Henry</p>
<div class="post">[<i>The point of this article was not the grayscale formula. Grayscale was just a demonstration. Feel free to use whatever formula you want. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-468543">
				<div id="div-comment-468543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/02/05/1604637.aspx' rel='external nofollow' class='url'>The Old New Thing : Public service announcement for United States taxpayers: In tax year 2006, you can claim a $30 refund if you owned a telephone</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061115-01/?p=28993#comment-468543">
			February 5, 2007 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2007/02/05/1604637.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2007/02/05/1604637.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>