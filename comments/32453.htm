<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (24)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-342073">
				<div id="div-comment-342073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Waitaminit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342073">
			January 31, 2006 at 10:31 am</a>		</div>

		<p>A recycle bin on a FAT-NTFS converted drive is still FAT, not NTFS?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342093">
				<div id="div-comment-342093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sebastian Redl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342093">
			January 31, 2006 at 10:34 am</a>		</div>

		<p>Or you could make emptying the recycling bin part of the conversion process, thus eliminating the possibility of confusion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-342123">
				<div id="div-comment-342123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342123">
			January 31, 2006 at 11:07 am</a>		</div>

		<ol>
<li>Having the file system conversion &quot;know&quot; about shell data structures would be a violation of engineering principles. You can&#8217;t have lower-level components depending on higher-level ones.
<p>2. What if you had a regular folder whose name happened to be &quot;RECYCLED&quot;? The conversion would delete it!<br />
</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342153">
				<div id="div-comment-342153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamessummerlin.blogspot.com' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342153">
			January 31, 2006 at 11:59 am</a>		</div>

		<p>Sebastian wrote:</p>
<p>&quot;Or you could make emptying the recycling bin part of the conversion process, thus eliminating the possibility of confusion.&quot;</p>
<p>That would remove control of such operations from the user.  I and I alone should be the one to make the decision on when to remove or recall contents from the recycle bin.</p>
<p>Also, the word &quot;conversion&quot; means to transform from one format to another &#8211; not transform and change half my stuff in the process.</p>
<p>James<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342173">
				<div id="div-comment-342173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Orlphar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342173">
			January 31, 2006 at 12:59 pm</a>		</div>

		<p>oldnewthing wrote:</p>
<p>&quot;2. What if you had a regular folder whose name happened to be &quot;RECYCLED&quot;? The conversion would delete it!&quot;</p>
<p>&#8212;&#8212;&#8212;</p>
<p>What happens in the other case, when you have a folder named &quot;RECYCLER&quot; on a FAT partition and convert it to NTFS?</p>
<p>I see that the folder is accessible on my NTFS drives, and that I can get into subfolders fine (Norton put an NPROTECT folder in there that I can get into and see files).</p>
<p>This makes me think that whatever you have before the conversion will still be there and accessible after the conversion (unless you have a folder that happens to be named &quot;S-&#8230;&quot;, which Explorer won&#8217;t let me look at; it brings up Unerase Wizard).  If this is the case, then why was the name change necessary?  Files in the old recycling bin would still be there after the conversion, and wouldn&#8217;t be &quot;lost&quot; to the user.</p>
<p>I think the reason might be that &quot;RECYCLER&quot; is a hidden system folder, so users who have Explorer set up to not show files and folders flagged like that would never see it (especially those who don&#8217;t know about the option)&#8230; but &quot;RECYCLED&quot; on a FAT partition should be flagged the same way, and the conversion shouldn&#8217;t change that; because then it would have knowledge of a higher-level component.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342183">
				<div id="div-comment-342183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vsz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342183">
			January 31, 2006 at 1:43 pm</a>		</div>

		<p>Extra shell logic is needed anyway to handle FAT/NTFS differently, so with about the same amount of complexity it could have just automatically detect (and handle) the two possible types of storage inside the same folder name. This way it would have been more elegant/uniform IMO.</p>
<p>Another solution would have been to move the whole &quot;recycle bin&quot; logic to a lower level (something like NProtect or Salvage on Netware volumes), but I understand this is an utopia considering the history of Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342193">
				<div id="div-comment-342193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342193">
			January 31, 2006 at 3:48 pm</a>		</div>

		<p>Orlphar,<br />
<br />Perhaps a better question is what happens if there is a <em>file</em> called &quot;RECYCLER&quot;&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-342203">
				<div id="div-comment-342203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342203">
			January 31, 2006 at 3:53 pm</a>		</div>

		<p>Why not just have FAT use an &quot;Everyone&quot; SID?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342243">
				<div id="div-comment-342243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342243">
			January 31, 2006 at 8:36 pm</a>		</div>

		<p>Edge cases!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342263">
				<div id="div-comment-342263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342263">
			January 31, 2006 at 10:42 pm</a>		</div>

		<p>Tuesday, January 31, 2006 11:59 AM by James Summerlin<br />
<br />&gt; I and I alone should be the one to make the<br />
<br />&gt; decision on when to remove or recall contents<br />
<br />&gt; from the recycle bin.</p>
<p>You&#8217;re in for at least two big disappointments.</p>
<p>1.  If the size occupied by files in the recycle bin reaches some threshhold, Windows automatically deletes some.  The threshhold doesn&#8217;t depend on how much unused free space remains available in the partition for ordinary applications to write files, the threshhold depends on some percentage of the original size of the partition.</p>
<p>2.  Limited users can look in the recycle bin, see files that administrative users put in it, and permanently delete them.  (I didn&#8217;t think of trying to restore one, which could potentially be a security risk.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-342283">
				<div id="div-comment-342283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342283">
			February 1, 2006 at 12:48 am</a>		</div>

		<blockquote><p>
  If the size occupied by files in the recycle bin reaches some<br />
  <br />&gt; threshhold, Windows automatically deletes some.</p>
<p>The percentage is configurable (you can even set it to 100% to effectively disable it) so it&#8217;s not exactly &quot;unexpected&quot;.</p>
<p>&gt; Limited users can look in the recycle bin, see files that<br />
  <br />&gt; administrative users put in it, and permanently delete them.</p>
<p>From what I&#8217;ve seen, the deleted file has the same ACL as the original file, so if they could permanently delete the file before you put it in the recycling bin, then that&#8217;s not going to change after you put it in.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342293">
				<div id="div-comment-342293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342293">
			February 1, 2006 at 1:43 am</a>		</div>

		<p>&quot;What happens in the other case, when you have a folder named &quot;RECYCLER&quot; on a FAT partition and convert it to NTFS?&quot;</p>
<p>Or, similarly, what did Windows 95 do when a drive already had something named RECYCLED on it?  Interesting that the opportunity was not taken to use a name that could not have existed before LFN.</p>
<p>&quot;Also, the word &#8216;conversion&#8217; means to transform from one format to another &#8211; not transform and change half my stuff in the process.&quot;</p>
<p>The recycle bin isn&#8217;t converted anyway.  I dunno, I don&#8217;t think I&#8217;d have a problem with someone dumping my trash out while moving between offices.</p>
<p>Then again, I always use shift-delete on files&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342543">
				<div id="div-comment-342543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342543">
			February 1, 2006 at 5:26 pm</a>		</div>

		<p>I imagine any user can empty all the existing files in the recycling bin just by deleting enough new files to hit the allocated percentage.   Regardless of ACLs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis odd alt thread-odd thread-alt depth-1" id="comment-342623">
				<div id="div-comment-342623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342623">
			February 1, 2006 at 8:55 pm</a>		</div>

		<p>If you have a situation where Limited Users can look into or modify the contents of another user&#8217;s Recycle Bin, you&#8217;ve done something [unsupported] to mess with the default ACLs.  Some [unsupported/unsupportable] 3rd party security guidance recommends file system ACL changes that have this unintended side effect.  The ACL on each RECYCLERS-&#8230; folder should allow access only to the user whose Bin it is, to Administrators and to SYSTEM.  The folder is created by Explorer when Recycle Bin functionality is first invoked by that user and ACLed at that time.  (The user should also be the owner of the folder.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-342483">
				<div id="div-comment-342483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342483">
			February 1, 2006 at 2:47 pm</a>		</div>

		<p>&quot;Also, the word &#8216;conversion&#8217; means to transform from one format to another &#8211; not transform and change half my stuff in the process.&quot; </p>
<p>Well, as long as it would *tell you* that it will empty the recycle bin when converting, there&#8217;s nothing to complain about.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-342573">
				<div id="div-comment-342573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342573">
			February 1, 2006 at 7:48 pm</a>		</div>

		<p>&gt; I imagine any user can empty all the existing files in the recycling<br />
<br />&gt; bin just by deleting enough new files to hit the allocated percentage.<br />
<br />&gt; Regardless of ACLs.</p>
<p>I&#8217;m not sure if that would be true. Now, obviously I know nothing of Window&#8217;s architecture, but if it was *me* doing it, then when the Recycle bin reaches it&#8217;s &quot;maximum percentage of the disk&quot;, I&#8217;d start deleting files out of the *current user&#8217;s* section (i.e. under my S-* sub-folder) &#8211; oldest files first, of course.</p>
<p>That would mean that a single user could never delete other user&#8217;s files, because the Recycle Bin would only ever be deleting his own files.</p>
<p>But that&#8217;s just me guessing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342703">
				<div id="div-comment-342703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342703">
			February 2, 2006 at 9:51 am</a>		</div>

		<p>While we&#8217;re on the recycle bin, why does it sometimes get the &#8216;full&#8217; icon when it is empty? The effect even seems to survive a reboot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-342803">
				<div id="div-comment-342803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-342803">
			February 2, 2006 at 10:56 pm</a>		</div>

		<p>Thursday, February 02, 2006 9:51 AM by Stu<br />
<br />&gt; While we&#8217;re on the recycle bin, why does it<br />
<br />&gt; sometimes get the &#8216;full&#8217; icon when it is<br />
<br />&gt; empty?</p>
<p>Because it runs out of disk space trying to record the fact that the recycle bin is empty?  No, unfortunately for this answer, that&#8217;s not how it happens, because it really fails to empty the recycle bin in such a case.</p>
<p>&gt; The effect even seems to survive a reboot.</p>
<p>Now for THAT we do know the answer.  Whenever it thinks it&#8217;s changed the status of the recycle bin, it records the status in the registry.  And then it just believes the registry instead of checking the actual recycle bin, because of this:<br />
<br /><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/01/24/516808.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/01/24/516808.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-343243">
				<div id="div-comment-343243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-343243">
			February 5, 2006 at 10:49 pm</a>		</div>

		<p>Sorry for two in a row but here&#8217;s the result of a small partial experiment.</p>
<p>In an NTFS partition I created a file (not folder) named RECYCLER</p>
<p>Then created a small scratch file, then right-clicked it and selected Delete. &nbsp;Explorer didn&#8217;t ask if I wanted to move the file to the recycle bin, Explorer asked if I wanted to delete the file.</p>
<p>(Now I wonder, if I create a file named &quot;System Volume Information&quot; on every external USB and SCSI hard drive partition, then will Windows XP refrain from putting restore points on them.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-343253">
				<div id="div-comment-343253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-343253">
			February 5, 2006 at 11:47 pm</a>		</div>

		<p>What usre mode APIs can you give you the SID for the current user?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-343263">
				<div id="div-comment-343263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">floppi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-343263">
			February 6, 2006 at 4:18 am</a>		</div>

		<p>Is this documented anywhere, or did it take you 4 months of code reviewing to find out why the names differ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-343423">
				<div id="div-comment-343423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-343423">
			February 6, 2006 at 12:50 pm</a>		</div>

		<p>Joe:</p>
<p>Try LookupAccountName in advapi32.dll:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/secauthz/security/lookupaccountname.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/secauthz/security/lookupaccountname.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-533863">
				<div id="div-comment-533863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dator.wordpress.com/2007/06/27/crecycler/' rel='external nofollow' class='url'>C:/Recycler &laquo; Dator - En blogg om datorer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-533863">
			August 7, 2007 at 3:16 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://dator.wordpress.com/2007/06/27/crecycler/" rel="nofollow">http://dator.wordpress.com/2007/06/27/crecycler/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668443">
				<div id="div-comment-668443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2008/09/18/8956382.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060131-00/?p=32453#comment-668443">
			September 18, 2008 at 12:19 pm</a>		</div>

		<p>You can ask for its description ID.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>