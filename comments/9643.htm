<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-935463">
				<div id="div-comment-935463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Darth Vader</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935463">
			September 15, 2011 at 7:54 am</a>		</div>

		<p>Sadly that YouTube video seems to be devoid of content. &nbsp;Fortunately, I have a replacement: <a rel="nofollow" target="_new" href="http://www.youtube.com/watch?v=WWaLxFIVX1s" rel="nofollow">http://www.youtube.com/watch</a> .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-935483">
				<div id="div-comment-935483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935483">
			September 15, 2011 at 8:07 am</a>		</div>

		<p>@Darth Vader: &nbsp;Worked fine for me&#8211;it&#39;s a clip from Torchwood.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-935533">
				<div id="div-comment-935533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nksingh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935533">
			September 15, 2011 at 8:31 am</a>		</div>

		<p>@Chris S:</p>
<p>One way of looking at it is that you shouldn&#39;t need a timeout or an asynch callback. &nbsp;You shouldn&#39;t be sending a message to a guy you don&#39;t trust enough to actually process the message in a timely manner.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-935583">
				<div id="div-comment-935583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935583">
			September 15, 2011 at 8:48 am</a>		</div>

		<p>@nksingh:</p>
<p>By that logic the window messaging system can&#39;t ever be used when a response it required because you can never be sure that the program doesn&#39;t have any bugs that will cause it to hang.</p>
<p>I actually have this problem at the moment where I have to communicate with a third-party program via window messages, and it has a tendency to hang periodically which causes me problems. I&#39;m still trying to come up with a solution I like.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-935603">
				<div id="div-comment-935603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935603">
			September 15, 2011 at 8:56 am</a>		</div>

		<p>@Chris S: &nbsp;Can you not use your own timer?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-935613">
				<div id="div-comment-935613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935613">
			September 15, 2011 at 8:57 am</a>		</div>

		<p>@Chris: Right, it&#39;s no different from any other IPC or RPC mechanism. &nbsp;You can&#39;t send an HTTP request to a web server and trust that it will process the request in a timely manner &#8212; you just have to hope it does, and provide a useful fallback when it doesn&#39;t.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-935633">
				<div id="div-comment-935633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935633">
			September 15, 2011 at 9:03 am</a>		</div>

		<p>@Rick C:</p>
<p>Yes, and I am. Problem is, I&#39;ve got no way of knowing if the program will ever receive my message, so the shared memory I said it could use is basically tainted until the other program decides to respond, if that ever happens.</p>
<p>It would be nice if I could replace the whole thing with a pipe based message queue, but this is a legacy system that I can&#39;t change, so I&#39;m pretty much stuck.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-935653">
				<div id="div-comment-935653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nksingh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935653">
			September 15, 2011 at 9:11 am</a>		</div>

		<p>@Chris S:</p>
<p>There&#39;s not much you can do about a legacy system, sadly. Given that Windows has progressed a bit since the early days, for new programs Window Messages should not be used for IPC.</p>
<p>All I can say is that I hope you&#39;re communicating to that third-party program via a supported interface and not hacking an interface into that program through some window message tricks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-935663">
				<div id="div-comment-935663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935663">
			September 15, 2011 at 9:18 am</a>		</div>

		<p>@nksingh:</p>
<p>No, this is the official interface that everyone must use. Pretty much every other program that uses the interface will hang the UI if the other program hangs. I&#39;m trying to be a bit smarter about how I use it, but it&#39;s difficult because the window messaging system clearly wasn&#39;t designed to be used asynchronously.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-935693">
				<div id="div-comment-935693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935693">
			September 15, 2011 at 9:54 am</a>		</div>

		<p>@Chris: The window messaging system was most definitely designed to be used asynchronously. &nbsp;That&#39;s what <code>PostMessage</code> is all about.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-935703">
				<div id="div-comment-935703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935703">
			September 15, 2011 at 9:57 am</a>		</div>

		<p>@Ben Voigt:</p>
<p>Sorry, I meant where a response is required, as is in what I&#39;m doing. SendMessageCallback() is a bit limited, and there is no way to cancel requests.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-935513">
				<div id="div-comment-935513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935513">
			September 15, 2011 at 8:23 am</a>		</div>

		<p>What if you need a timeout *and* and asynchronous callback though? There doesn&#39;t seem to be any way to do that as far as I can tell.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-935863">
				<div id="div-comment-935863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110915-00/?p=9643#comment-935863">
			September 16, 2011 at 1:51 am</a>		</div>

		<p>Couldn&#39;t you just sandbox an instance of the app and simulate the message receiving? &quot;according to simulations, this app answers rapidly to messages&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>