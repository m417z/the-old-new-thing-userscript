<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1169813">
				<div id="div-comment-1169813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ryan Phelps</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169813">
			January 5, 2015 at 10:21 am</a>		</div>

		<p>What have you been working on that this stuff is coming up? &nbsp;Or is it just a hobby?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1169853">
				<div id="div-comment-1169853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Al Go</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169853">
			January 5, 2015 at 2:23 pm</a>		</div>

		<p>He got tired of counting the ways he could arrange balls into boxes. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1169863">
				<div id="div-comment-1169863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169863">
			January 5, 2015 at 6:23 pm</a>		</div>

		<p>Ok so it&#39;s a bit funny that Mr. Go turned up again, but really, you know, it must be an alias for somebody here commonly. I suppose Raymond could figure it out but I don&#39;t think he cares any more than the elephant cares to smite any particular gnat.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1169873">
				<div id="div-comment-1169873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesNT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169873">
			January 5, 2015 at 8:09 pm</a>		</div>

		<p>You guys can poke fun all you want, but I find these posts fascinating. &nbsp;It&#39;s been a lot of fun looking up more information regarding this topic.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1169883">
				<div id="div-comment-1169883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A regular viewer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169883">
			January 5, 2015 at 10:14 pm</a>		</div>

		<p>These calculations form the foundation for the transposition of algebraic first order polynomials on 2 dimensional N-planar geometry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1169893">
				<div id="div-comment-1169893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Smithers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169893">
			January 6, 2015 at 4:06 am</a>		</div>

		<p>I believe I have a three-instruction solution which covers 7 of the 14 remaining cases.</p>
<p>; set the top N bits, where 72 &lt;= N &lt;= 96</p>
<p>pcmdeqd xmm0, xmm0</p>
<p>pslldq xmm0, 7</p>
<p>psrad xmm0, N-72</p>
<p>The trick here is to shift further than we need to, then use a signed shift to get some of the ones back.</p>
<p>E.g. N=77:</p>
<p>FFFF FFFF|FFFF FFFF|FFFF FFFF|FFFF FFFF</p>
<p>Unsigned shift left 56 bits</p>
<p>FFFF FFFF|FFFF FFFF|FF00 0000|0000 0000</p>
<p>Signed shift right each doubleword N-72 bits</p>
<p>FFFF FFFF|FFFF FFFF|FFF8 0000|0000 0000</p>
<p>Unfortunately, we can&#39;t do the left-shift by any more than 56 bits without clearing the bottom half completely, so we still can&#39;t do 64 &lt; N &lt; 72.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1169903">
				<div id="div-comment-1169903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1169903">
			January 6, 2015 at 4:41 am</a>		</div>

		<p>To set the top 72&lt;N&lt;128 bits to 1:</p>
<p>pcmpeqd xmm0, xmm0</p>
<p>pslldq &nbsp;xmm0, 7</p>
<p>psrad &nbsp; xmm0, N &#8211; 72</p>
<p>That still leaves 64&lt;N&lt;72 though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1170133">
				<div id="div-comment-1170133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sintendo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1170133">
			January 6, 2015 at 4:02 pm</a>		</div>

		<p>I was going to suggest using the AMD-exclusive SSE4a instructions &#39;extraq&#39; and &#39;insertq&#39; somehow, but I forgot that they only operate on the lower 64 bits and leave the upper half undefined.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1170153">
				<div id="div-comment-1170153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gr8 m8 r8 8/8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1170153">
			January 6, 2015 at 5:05 pm</a>		</div>

		<p>a gr8 feature m8 im going have to rate ya 8/8</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1170233">
				<div id="div-comment-1170233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150105-00/?p=43223#comment-1170233">
			January 7, 2015 at 4:57 am</a>		</div>

		<p>I must have had the page open for quite a while before submitting my comment, which explains how Smithers was able to submit his comment without me noticing. I&#39;ll just put it down to &quot;Great minds think alike.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>