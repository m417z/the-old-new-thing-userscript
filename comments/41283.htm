<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (41)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-118663">
				<div id="div-comment-118663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Feinman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118663">
			December 29, 2003 at 10:44 am</a>		</div>

		<p>The link to WH_SHELL hook seems to be broken</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118683">
				<div id="div-comment-118683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118683">
			December 29, 2003 at 11:06 am</a>		</div>

		<p>Fixed, thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118693">
				<div id="div-comment-118693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/kdente' rel='external nofollow' class='url'>Kevin Dente</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118693">
			December 29, 2003 at 12:03 pm</a>		</div>

		<p>Here&#8217;s a related question &#8211; why is it that there are sometimes (in fact, often) windows that show up in the taskbar but don&#8217;t show up in the ALT-TAB rotation? That one drives a heavy keyboarder like me nuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118713">
				<div id="div-comment-118713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ozemail.com.au/~markhurd/' rel='external nofollow' class='url'>Mark Hurd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118713">
			December 29, 2003 at 4:06 pm</a>		</div>

		<p>Kevin: Anyone can look up the documentation for the exact details, but simply the criteria is different.</p>
<p>You can use Win-Tab to cycle through the TaskBar buttons in the same way.</p>
<p>(Note also for keyboarders: Win-Tab (or otherwise give the TaskBar focus) followed by Tab (or Shift-Tab) will move the focus to toolbars and the notification area. Further Tabs and Ctrl-Tabs will move to docked toolbars and to the desktop.)</p>
<p>Raymond: What&#8217;s the easiest way to give a minimized application the focus (and hence the priority boost) without restoring it? (In Win3.1 just clicking on the task icon would do it IIRC.) Alt-Esc gets it done, but is there a TaskBar way?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118733">
				<div id="div-comment-118733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118733">
			December 29, 2003 at 5:27 pm</a>		</div>

		<p>Alt+Esc is the way to do this. It turns out that very few people ever say, &quot;Y&#8217;know, what I really want to do is switch to a minimized program without restoring it, so it can get its priority boost.&quot;  The taskbar is all about switching to running windows so you can use them, not fiddling with priority boosts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118743">
				<div id="div-comment-118743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bytegems.com' rel='external nofollow' class='url'>Oleksiy Kolisnychenko</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118743">
			December 30, 2003 at 12:58 am</a>		</div>

		<p>Raymond, why WH_SHELL doesn&#8217;t send anything when console window become active? How to handle this situation?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118753">
				<div id="div-comment-118753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118753">
			December 30, 2003 at 1:25 am</a>		</div>

		<p>It doesn&#8217;t? I didn&#8217;t know that. It should &#8211; you see the taskbar buttons pushing and unpushing when you move focus to/from a console window, after all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118763">
				<div id="div-comment-118763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bytegems.com' rel='external nofollow' class='url'>Oleksiy Kolisnychenko</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118763">
			December 30, 2003 at 3:01 am</a>		</div>

		<p>Heh. I thought so too, but it doesn&#8217;t &#8212; I made WH_SHELL hook several days ago. :-)<br />
<br />I also searched google groups &#8212; people have met this problem too. :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118793">
				<div id="div-comment-118793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.honestillusion.com' rel='external nofollow' class='url'>James Curran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118793">
			December 30, 2003 at 7:53 am</a>		</div>

		<p>While we&#8217;re on taskbar quirks&#8230;. What&#8217;s up with this?</p>
<p>I&#8217;ve noticed frequently, if you has several windows open, and click on a taskbar item to to bring that window to the top of the z-order, a complete different window will also rise.  (I&#8217;ve noticed this the most when I&#8217;ve tried to do a drag&#8217;n&#8217;drop between two Explorer windows. I&#8217;d get the source window pointed to the right directory, click the taskbar icon for the destination window to bring it into view &#8212; and at the same time, an IE window (for example) will also come to the top, blocking the source Explorer window).   </p>
<p>Another time I see it a lot, is when a spammer pops-up an off-the-screen IE window.  I&#8217;ll see an unidentified IE icon on the taskbar, and click on it to see what it is.  While the popup restores out of view, a legitimate IE window also restores, looking as if it&#8217;s the one I clicked on.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118833">
				<div id="div-comment-118833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118833">
			December 30, 2003 at 8:11 am</a>		</div>

		<p>I can&#8217;t explain the behavior you&#8217;re seeing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118943">
				<div id="div-comment-118943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-118943">
			December 30, 2003 at 12:25 pm</a>		</div>

		<p>How about this one: if a program in the &quot;tray&quot; crashes, the icon isn&#8217;t removed until you mouse over it.  Did they fix that in XP?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-119003">
				<div id="div-comment-119003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119003">
			December 30, 2003 at 3:06 pm</a>		</div>

		<p>I&#8217;ve never seen empty taskbar items in the new-style XP taskbar, has it changed or am I just lucky?</p>
<p>Also, why was the decision that Control Panel dialogs should never have a taskbar button taken? *So* many times I&#8217;ve seen someone accidentally click away from one, and then go all through Start -&gt; Settings, etc just to get it back!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-119013">
				<div id="div-comment-119013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119013">
			December 30, 2003 at 4:26 pm</a>		</div>

		<p>The taskbar doesn&#8217;t continuously check if each program backing a notification icon is still alive. That would be very wasteful of memory and CPU (checking the window every few seconds to see if it is still responding).  When you mouse over the icon, the taskbar finally has a reason to talk to the window backing the icon, and that&#8217;s when it notices that the window is no longer valid.</p>
<p>As for why control panel programs do not show up in the taskbar: This was in my mind a controversial decision from the beginning. The theory was that they aren&#8217;t applications or documents; they&#8217;re properties (like file properties), and the taskbar is for showing tasks and documents.</p>
<p>I think the original taskbar designers were trying to keep &quot;clutter&quot; out of the taskbar.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-119553">
				<div id="div-comment-119553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119553">
			January 3, 2004 at 2:34 pm</a>		</div>

		<p>Hehe, so why in XP do connection properties dialogs get taskbar buttons? Slight lack of consistency methinks :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-119563">
				<div id="div-comment-119563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119563">
			January 3, 2004 at 2:49 pm</a>		</div>

		<p>Simple: The RAS team is not part of the shell team.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-119573">
				<div id="div-comment-119573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ozemail.com.au/~markhurd/' rel='external nofollow' class='url'>Mark Hurd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119573">
			January 4, 2004 at 1:08 am</a>		</div>

		<p>I&#8217;ve noticed File Properties *sometimes* get icons. I&#8217;m not sure when &#8212; perhaps when the Explorer window that initiated them has been closed.</p>
<p>James: The other windows that come foreward can be windows of the same process. If you&#8217;ve got Explorer doing web browsing and Internet Explorer browsing disks, you can get some un expected window changes&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-119633">
				<div id="div-comment-119633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.iserializable.com' rel='external nofollow' class='url'>Roy Osherove</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119633">
			January 5, 2004 at 8:17 am</a>		</div>

		<p>Here&#8217;s a good question:<br />
<br />Why in the world when I copy large amounts of data between machines, does the copy dialog show the most inexact time, and sometimes even counts upwards?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-119643">
				<div id="div-comment-119643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119643">
			January 5, 2004 at 8:24 am</a>		</div>

		<p>Good question. I&#8217;ll answer it in a future blog entry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-119813">
				<div id="div-comment-119813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119813">
			January 5, 2004 at 8:04 pm</a>		</div>

		<p>&quot;If the window is a top-level unowned window, then it will show (when visible).&quot;</p>
<p>In XP the above is true about 97% of the time.  There are only a few ways in which XP is more unreliable than 95, but this is one of them.  After you minimize an application which doesn&#8217;t have a button showing in the taskbar, you have to open the task manager and do a &quot;switch to&quot; in order to get back to the application.  And to decide to do that, you have to have the presence of mind to remember that you actually have that application running and only the Windows XP taskbar forgot about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-119823">
				<div id="div-comment-119823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119823">
			January 5, 2004 at 8:14 pm</a>		</div>

		<p>James Curran said:</p>
<p>&quot;Another time I see it a lot, is when a spammer pops-up an off-the-screen IE window.&quot;</p>
<p>Actually IE can do that all by itself.  This happens even when each IE window resulted from a separate invocation (separate push of the icon in the Quick Launch bar or Start menu or whatever, anyway not from popups and not from a right clicking a link and open in new window).  For a few months last year I had to use Windows 98 and IE was doing that several times per day, suddenly deciding that each window had negative size and was located beyond the lower right corner of the display.  In Windows XP it has only happened a few times, deciding that a single IE window had negative size and was located beyond the upper left corner of the display.</p>
<p>Such a broken window can be brought back by a sequence of three steps.  In the taskbar, do a right click on the button for the window, and select Move.  Use an arrow key to move the window a bit, but it will actually move onto the visible screen, at an edge or corner of the screen, and you can use the mouse to move it further.  It will hardly be visible because it has negative size and only a corrupted portion of its title is showing, but if you know what to look for you&#8217;ll find it.  Second, click on an edge of the window and try to resize it.  This effort will fail but the size will change from negative to zero and you&#8217;ll be able to read the first few characters in its title.  Third, click on an edge of the window and try to resize it again.  This will succeed.</p>
<p>In this situation, Windows XP is more reliable than Windows 98, as it should be.  But it&#8217;s just luck that the few times it happened to me, it didn&#8217;t coincide with Windows XP forgetting to display a button in the taskbar.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-119833">
				<div id="div-comment-119833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119833">
			January 5, 2004 at 8:14 pm</a>		</div>

		<p>If you can repro this I&#8217;d like to debug it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-119933">
				<div id="div-comment-119933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-119933">
			January 6, 2004 at 9:39 am</a>		</div>

		<p>The area in my win-xp taskbar that shows the tasks disappeared and I can&#8217;t get it back.<br />
<br />I guess there&#8217;s some registry key responsible for that, but I don&#8217;t know which.<br />
<br />Can you help?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-120453">
				<div id="div-comment-120453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-120453">
			January 7, 2004 at 8:07 pm</a>		</div>

		<p>I think Raymond Chen was replying to me:</p>
<p>&quot;If you can repro this I&#8217;d like to debug it.&quot;</p>
<p>1.  Taskbar not getting button for application.</p>
<p>In my experience it happens about 3% of the time.  The victim application can be anything.  I can only guess what might or might not be a way to make it happen more than 3% of the time.  Here is a first guess.  Let&#8217;s try something that is slow to start up, and open a bunch of them, and let&#8217;s hope this will maximize the probability of Windows forgetting to put the victim&#8217;s button in the taskbar.</p>
<p>Try something like my Crusoe at a slow 600MHz and measly 320MB of RAM.  To simulate that, maybe try a Celeron 300MHz and measly 256MB of RAM.</p>
<p>In Internet Explorer, uncheck the option to reuse existing IE windows when clicking on shortcuts.  (By the way, another bug is that IE doesn&#8217;t entirely respect this option either.  Sometimes it still reuse a window.  Then the user has to scramble to find the window that had some other page that they wanted to keep open, do a &quot;back&quot; operation there, open a new IE application and copy the new desired shortcut into its address bar.)</p>
<p>Anyway, in that environment, click about 20 times on the IE button in the Quick Launch bar.  This might put about 19 IE buttons in the taskbar, if we&#8217;re lucky enough to get the problem reproduced this time.  Minimize each IE window as it gets opened.  When none of them are open on the desktop, go through each one in turn, click on the button in the taskbar to restore it, then click on the upper-right closer to close it.  At the end of this there should be no IE buttons in the taskbar.  Then open up the Task Manager to the Applications tab and see if it knows about a still-existing IE window.  If it does, you can do a &quot;switch to&quot;, the IE window will be restored, and Windows will belatedly enter a button into the taskbar.</p>
<p>2.  IE displaying itself with negative size, off screen.</p>
<p>In Windows 98 it&#8217;s pretty easy.  If I&#8217;m on a machine connected (indirectly) to the internet, I usually keep three IE windows open but minimized, displaying financial information, and glance at them occasionally.  Two of them automatically get refreshed every few minutes.  The three I do are:<br />
<br /><a target="_new" href="http://quote.yahoo.co.jp/" rel="nofollow">http://quote.yahoo.co.jp/</a><br />
<br /><a target="_new" href="http://www.cme.com/dta/del/globex.html" rel="nofollow">http://www.cme.com/dta/del/globex.html</a><br />
<br />(You want RTH if you do it during your hours)<br />
<br /><a target="_new" href="http://finance.yahoo.com/m2?u" rel="nofollow">http://finance.yahoo.com/m2?u</a><br />
<br />And I usually keep one OE window open, which automatically checks for new mail every some minutes.</p>
<p>If I then do something silly like opening a few more IE windows and actively using them to search for useful information, and open the MSDN library in another window, and on rare occasions a non-MS app, then the confusion will start pretty quickly.  I&#8217;ll try to minimize a window and it will refuse to minimize.  I&#8217;ll try to click on icons in the task bar for windows that are already minimized but they refuse to open.  If enough windows are still being displayed, then clicking on the upper right to close them will free enough of Windows Resources, so that some of the messed up victim applications can be reopened after a fashion.  Clicking on a button in the task bar to restore the window appears to fail but in fact it succeeds, with IE or OE or MSDN library having negative size and off-screen.  It can be brought back on-screen by playing games as described.</p>
<p>In Windows XP, the exact same behavior only happened to me about twice so I can&#8217;t exactly say how to reproduce it.</p>
<p>In Windows XP, different but not entirely different behavior had some windows that could not be brought back on-screen at all.  This involved having IE open to a completely different web site from any of those involved in the past.  For MSDN product keys I had to get a Microsoft Passport.  After evading MSDN&#8217;s effort to create a personal passport associated with a Windows XP account existing on one of my employer&#8217;s computers, I followed instructions to go to the sign-on screen and get a new passport associated with my personal e-mail account.  But before proceeding to get such a passport, I clicked on two of the &quot;help&quot; items to see what assertions there were about privacy and such matters.  These opened up IE windows that did not display at all, but which had buttons in the taskbar.  I reported this to Microsoft already.  Microsoft said to delete cookies.  I deleted all known cookies associated with Microsoft (microsoft.com, msj.co.jp, 207.46.something).  It worked.  I was surprised, but it worked.  On retrying, I got Microsoft&#8217;s assertions about its Passport privacy policy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-120763">
				<div id="div-comment-120763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-120763">
			January 8, 2004 at 9:48 am</a>		</div>

		<p>I tried scenario 1 twice on my 128MB P3 (800MHz) with a fresh copy of Windows XP (SP2) and neither time were there any &quot;lost windows&quot;. Sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-121113">
				<div id="div-comment-121113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-121113">
			January 8, 2004 at 7:38 pm</a>		</div>

		<p>I suppose it should be possible to send you a screen shot the next time it happens, but I guess it won&#8217;t be possible to give a recipe to reproduce it.</p>
<p>By the way you don&#8217;t say how many IE windows you opened each time.  Say my estimate of 3% failures is accurate, and say you opened 20 IE windows twice, for a total of 40.  This would be enough to expect an average of 1.2 failures, but not an enormous certainty of getting 1.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-138203">
				<div id="div-comment-138203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-138203">
			January 22, 2004 at 5:54 pm</a>		</div>

		<p>Is there any way to move application buttons around on the taskbar? For Example, I always want Outlook as the far left side button. Short of logging off and always starting Outlook first, how is that accomplished?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-138213">
				<div id="div-comment-138213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-138213">
			January 22, 2004 at 5:57 pm</a>		</div>

		<p>There is no facility to change the positions of the buttons. Buttons from the same program are grouped together.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-141013">
				<div id="div-comment-141013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-141013">
			February 3, 2004 at 4:11 pm</a>		</div>

		<p>Mr. Chen, though this won&#8217;t help much, here&#8217;s a repro of the taskbar losing its button for an executing IE window.  One of my home computers did this last night.</p>
<p><a target="_new" href="http://home.att.ne.jp/star/ndiamond/xp-taskbar-bug.jpg" rel="nofollow">http://home.att.ne.jp/star/ndiamond/xp-taskbar-bug.jpg</a></p>
<p>This occasion was even more odd, because I don&#8217;t recall opening any new windows (applications or processes) when the taskbar suddenly decided to forget this one.</p>
<p>At first glance it might look like the number of buttons in the taskbar matches the number of applications listed in the Windows Task Manager, so you&#8217;ll have to remember that the Windows Task Manager does not list itself as an executing application.  The lost taskbar button is for the IE window for eBay item 2221926370.</p>
<p>After capturing the screen image, opening Paint to save the bitmap and then Microsoft Photo Editor to convert it to JPEG, (i.e. after several minutes) I went back to the Windows Task Manager, selected that IE task, and clicked on ???? (Switch To).  The correct IE window appeared, and a few seconds later a correct new button appeared in the taskbar.</p>
<p>By the way, although I installed a PowerToy two years ago to switch desktops, I&#8217;ve never used it except for testing it the day I installed it.  I probably ought to delete that PowerToy.  But I don&#8217;t think it&#8217;s responsible for lost taskbar buttons.  The day I tested it, it switched desktops but the taskbar remained unchanged, displaying buttons for all applications regardless of desktops.</p>
<p>Also by the way, though this looks like an IE bug, I think it might not be.  A few past occurences involved applications which are not part of IE or Windows Explorer or Outlook Express.</p>
<p>Though this won&#8217;t help track down where the bug is, I hope it will help assure you that the bug is active.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-141073">
				<div id="div-comment-141073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gwyn Fisher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-141073">
			February 4, 2004 at 9:07 am</a>		</div>

		<p>Somewhat related question: I&#8217;ve noticed that several applications (MMC being the example du jour) manage to have modeless top-level dialogs show up in the Alt+Tab set of tasks, but not in the taskbar.</p>
<p>For purposes of consistency (I&#8217;m writing a snap-in) my customer would like to have the modeless top-level dialogs that I create also exhibit this same behavior, i.e. be available for keyboard navigation via the Alt+Tab list, but not &quot;clutter up&quot; their taskbar.</p>
<p>So&#8230; I&#8217;m feeling incredibly thick at this point, but the approaches I&#8217;ve tried so far don&#8217;t seem to do what MMC does, or anything close.</p>
<p>Spy++ reports that MMC is subclassing its property sheets, but&#8230; what are they overriding in this particular context (spy++ usefully reports that the dialog doesn&#8217;t actually respond to *any* messages)?</p>
<p>I&#8217;ve tried using ITaskbarList::DeleteTab on various messages (WM_ACTIVATE, etc.), but that simply results in a nice now-its-here, now-it-gone sort of game.</p>
<p>So&#8230; anybody got bright ideas of how to accomplish this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-141173">
				<div id="div-comment-141173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-141173">
			February 4, 2004 at 6:58 pm</a>		</div>

		<p>I don&#8217;t doubt that the bug exists, but without a way of consistently reproducing it, it&#8217;svery hard to diagnose. Like an automobile mechanic &#8211; there&#8217;s only so much you can do without studying the car *while* it is making the strange noise.</p>
<p>Gwyn: It&#8217;s nothing that complicated. I forget precisely, but it&#8217;s just a combination of having an owned window (therefore not taskbar ineligible) and some extended style (I forget precisely which). A little more Spy++ action on the *extended* styles of the window and its owner should reveal somethinguseful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-141213">
				<div id="div-comment-141213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gwyn Fisher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-141213">
			February 5, 2004 at 7:14 am</a>		</div>

		<p>Thanks for the feedback. As you say, it&#8217;s nothing that complicated. Turns out that what I was missing was the fact that the MMC property sheet named a hidden window as its parent (got to love Spy++), and if you do this (and that hidden window has the desktop as its parent), then Windows does all the work for you. Automagically your icon shows up in the Alt+Tab list, but not on the taskbar.</p>
<p>Thanks for shoving me in the right direction.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-141303">
				<div id="div-comment-141303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-141303">
			February 5, 2004 at 8:06 pm</a>		</div>

		<p>2/4/2004 6:58 PM Raymond Chen:</p>
<p>&gt; I don&#8217;t doubt that the bug exists,</p>
<p>At least that&#8217;s a start, thank you.  At least I didn&#8217;t have to pay Microsoft 4,200 yen to get this far.  Thank you.</p>
<p>(Speaking of reproducibility, Microsoft added two bugs to Solitaire in Windows XP that I never saw in previous versions of Windows, one of which is 100% reproducible.  I haven&#8217;t posted screenshots because other bugs in Windows are vastly more important.  But perhaps I should post them for laughs, that one of them is 100% reproducible and that Microsoft even found a way to add bugs to Solitaire.  Windows Server 2003 didn&#8217;t copy Solitaire bugs from XP though :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-154083">
				<div id="div-comment-154083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mary Breden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-154083">
			March 13, 2004 at 9:53 pm</a>		</div>

		<p>Danit wrote: &quot;The area in my win-xp taskbar that shows the tasks disappeared and I can&#8217;t get it back.&quot;</p>
<p>I have also had the exact same problem, which occurred after &quot;playing&quot; with Desktop Manager and Tweak UI power toys. No buttons for open windows, folders, or applications appear on the taskbar. When minimized they simply disappear (with the normal animation effect of going down to the taskbar), but no taskbar button appears. Double clicking on the desktop icon of the window which was minimized retrieves the window from the taskbar (with the same animation effect).</p>
<p>One other symptom is in the appearance of  the &quot;dotted&quot; divider lines which appear when the taskbar is unlocked. These seem to be associated with the various toolbars on the taskbar, and there was a &quot;blank&quot; area between other tool bars where the application buttons were displayed. This &quot;blank space&quot; seems to be missing.</p>
<p>Note that it only has affected my user login, not my husband&#8217;s, so this seems to be  something user-specific, not system-wide.</p>
<p>Is there a registry entry to toggle or tweak to fix this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-154093">
				<div id="div-comment-154093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mary_breden@alumni.reed.edu' rel='external nofollow' class='url'>Mary Breden</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-154093">
			March 13, 2004 at 9:55 pm</a>		</div>

		<p>Forgot to post my email &#8211; sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-154103">
				<div id="div-comment-154103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-154103">
			March 13, 2004 at 10:26 pm</a>		</div>

		<p>You say they disappear but later talk about double-clicking on the desktop icon for the window &#8212; so they didn&#8217;t really disappear. They turned into a desktop icon rather than going onto the taskbar.</p>
<p>This means that the notification that tells the taskbar &quot;Hey, I just minimized a window, please make a button for it&quot; isn&#8217;t working. This can happen if another program installs a WH_SHELL hook and fails to forward the notifications onward. Did you install any new software?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-154133">
				<div id="div-comment-154133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mary Breden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-154133">
			March 14, 2004 at 4:42 pm</a>		</div>

		<p>The desktop icon was there before I started the application &#8211; in fact, double-clicking on the desktop icon was how I started the program in the first place.  There should be a button on the taskbar for any active application &#8211; not just one that is minimized.  There are no application buttons at all appearing on the taskbar &#8211; minimized or otherwise.</p>
<p>The only new software I had installed was the XP Powertoys.  I had installed the Desktop Manager, Tweak UI, Taskbar Magnifier, and CmdHere.  I had played with all of them except the CmdHere program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-156883">
				<div id="div-comment-156883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mary Breden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-156883">
			March 22, 2004 at 8:53 pm</a>		</div>

		<p>I created a new user &amp; have been using the Desktop Manager, Tweak UI, etc. with no problems so far&#8230;  The only thing that I haven&#8217;t tried to use is to turn off the &quot;Shared Desktop&quot; option, so that the application buttons only show up on the taskbar associated with the desktop window that they are &quot;in&quot;.  I am guessing that this is what &quot;broke&quot; everything before&#8230;  </p>
<p>Has anyone used Desk Manager with this otion turned off &#8211; and not experienced problems??</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-167813">
				<div id="div-comment-167813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gilad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-167813">
			April 26, 2004 at 1:44 pm</a>		</div>

		<p>&quot;&quot;If the window is a top-level unowned window, then it will show (when visible).&quot; </p>
<p>In XP the above is true about 97% of the time.&quot;</p>
<p>how can i enumerate all windows that have a taskbar button? more accurate, how will i filter out those that don&#8217;t&#8230;</p>
<p>i&#8217;m using VB6, but just a general idea of what i have to do will help a lot..</p>
<p>thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-175153">
				<div id="div-comment-175153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alec Soroudi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-175153">
			May 18, 2004 at 1:48 pm</a>		</div>

		<p>  A little off topic but it seems that when explorer crashes and is restarted, any windows that were opened BEFORE it crashed get disconnected from the taskbar.  The result is that you can no longer minimize the window by clicking on it&#8217;s taskbar button while it&#8217;s active.  However any windows that are created AFTER the crash perform correctly.  I assume that the taskbar keeps an internal list of windows and uses that to perform the minimize action and when it crashes, then it no longer has the old list correct?  If so, then I am still confounded because the taskbar creates new buttons for existing windows when explorer is restarted, so why does it not allow you to minimize them by clicking their buttons?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-181443">
				<div id="div-comment-181443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-181443">
			June 7, 2004 at 8:35 am</a>		</div>

		<p>Commenting on this topic has been closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-257803">
				<div id="div-comment-257803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2005/02/27/381450.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031229-00/?p=41283#comment-257803">
			February 28, 2005 at 1:50 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>