<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1094773">
				<div id="div-comment-1094773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094773">
			December 16, 2013 at 7:05 am</a>		</div>

		<p>I&#39;m guessing this still doesn&#39;t prevent the Snipping Tool and it&#39;s moral equivalents from capturing the screen?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094783">
				<div id="div-comment-1094783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094783">
			December 16, 2013 at 7:17 am</a>		</div>

		<p>Nor is it effective at blocking screen snapshot via RDP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094803">
				<div id="div-comment-1094803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094803">
			December 16, 2013 at 7:43 am</a>		</div>

		<p>Or taking a picture of your screen with an iPhone or painting it in watercolours onto a canvas sitting next to your laptop.</p>
<p>Seriously guys. This is a tiny program, and it does what it says it does, which is to reject PRNTSCRN button presses being sent to your window. Nothing more. Nothing less.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094813">
				<div id="div-comment-1094813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094813">
			December 16, 2013 at 7:54 am</a>		</div>

		<p>Yes, but as engineers if someone tells us that screen printing is blocked on a particular computer we will immediately put all our energies to figure out how to circumvent this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094853">
				<div id="div-comment-1094853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094853">
			December 16, 2013 at 8:40 am</a>		</div>

		<p>Assuming the goal was to make screencaps harder, this couldn&#39;t have been done by group policy at the time?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094863">
				<div id="div-comment-1094863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094863">
			December 16, 2013 at 8:41 am</a>		</div>

		<p>This program caused my computer to completely lock up the moment I hit the PrtSc key, requiring it to be power cycled. &nbsp;Almost like the time I thought it&#39;d be a good idea to set the registry key &quot;Image File Execution Optionscmd.exedebugger&quot; &#8212; except that time my computer also locked up immediately after logging in, so I needed to use a recovery CD to manually fix my registry and undo my stupidity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094823">
				<div id="div-comment-1094823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094823">
			December 16, 2013 at 8:02 am</a>		</div>

		<p>Disallowing print screen and friends seems like a losing battle, but I&#39;d rather the person doing these shenanigans using a keyboard hook than messing with my keyboard layout. At least I can remove a hook fairly easily; I&#39;m pretty sure I wouldn&#39;t think about the keyboard mappings table as it&#39;s pretty obscure and a *very* global solution to a local problem!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094953">
				<div id="div-comment-1094953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio &amp;#39;Grijan&amp;#39;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094953">
			December 16, 2013 at 5:23 pm</a>		</div>

		<p>@Adam: that&#39;s what God invented virtual machines for&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094973">
				<div id="div-comment-1094973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anil Kulkarni</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094973">
			December 16, 2013 at 6:47 pm</a>		</div>

		<p>An important thing to consider when using LL hooks is to run them on a dedicated thread, so as to not tie up the system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094983">
				<div id="div-comment-1094983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Silly</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1094983">
			December 16, 2013 at 9:16 pm</a>		</div>

		<p>I wrote something similar to the above back in the late 90&#39;s, but its sole purpose was to beep on any keystroke if some small random number of milliseconds had passed since the last beep. So in other words its sole purpose was to annoy and confuse any workmates who liked to listen to music on their headphones and left their computer unlocked and unattended (basically I was a newly-graduated smart-a**). But I remember having to put the hook function in a separate dll, though the memory is hazy. Nowadays I&#39;d consider such an action tantamount to vandalism&#8230; I&#39;ve lost the edge.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rat even thread-even depth-1" id="comment-1095443">
				<div id="div-comment-1095443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/hacksoncode' rel='external nofollow' class='url'>hacksoncode</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1095443">
			December 18, 2013 at 4:16 pm</a>		</div>

		<p>I know we&#39;re not to complain about error checking in &quot;Little Programs&quot;, but&#8230; I&#39;m curious about the documentation of &quot;SetWindowsHookEx&quot;: &quot;An error may occur if the hMod parameter is NULL and the dwThreadId parameter is zero or specifies the identifier of a thread created by another process.&quot; Perhaps the LL hooks don&#39;t have this limitation because they are never injected?</p>
<p>I&#39;m also really curious (because the documentation doesn&#39;t say), how CallNextHookEx works on the WH_KEYBOARD_LL hook, since LL hooks aren&#39;t injected/executed in the target thread context. I would guess that it just calls SendMessage to forward the hook call to the next process in the chain?</p>
<p>And, of course, this only works if nothing else in the hook chain before this hook returned early or caused an error that resulted in nCode being &lt;0. Like, say, the hook my devious application installed to circumvent this stupid feature :-). </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1095823">
				<div id="div-comment-1095823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131216-00/?p=2373#comment-1095823">
			December 22, 2013 at 6:49 pm</a>		</div>

		<p>Speaking of PrtSc, I know this is slightly (well ok, completely) off-topic, but has anyone ever had Alt+PrtSc fail them? Ever since I can remember Alt+PrtSc has perfectly captured _only_ the active window, but on an old Lenovo laptop I recently installed Windows 7 32-bit on (Intel XDDM driver installed in compatibility mode, no Aero support, only Aero Basic and Win Classic, works _very_ nicely once I installed 3GB max RAM and SSD), it ends up capturing the active window and the top of the taskbar! Here&#39;s a screenshot: <a href="http://i.imgur.com/BS5Dc7E.png" rel="nofollow" target="_new">http://i.imgur.com/BS5Dc7E.png</a></p>
<p>Has anyone ever seen anything this weird? I take it it&#39;s the display driver&#39;s fault? (And Intel&#39;s of course, the only hardware manufacturer not to have released updated drivers for this model.)</p>
<div class="post">[<em>Look closely. The taskbar overlaps the bottom window border. (You also have this problem on the other three edges of the window, but since you have a single-monitor system, you don&#39;t notice it.) -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>