<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1 parent" id="comment-1314465">
				<div id="div-comment-1314465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mason Wheeler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314465">
			November 1, 2017 at 8:36 am</a>		</div>

		<p>What does SFGAO stand for anyway?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1314466">
				<div id="div-comment-1314466" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314466">
			November 1, 2017 at 8:58 am</a>		</div>

		<p>These values are returned from IShellFolder::GetAttributesOf.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1314476">
				<div id="div-comment-1314476" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314476">
			November 1, 2017 at 8:58 am</a>		</div>

		<p>Google is your friend: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb762589%28v=vs.85%29.aspx?f=255&#038;MSPPError=-2147217396" rel="nofollow">https://msdn.microsoft.com/en-us/library/windows/desktop/bb762589%28v=vs.85%29.aspx?f=255&#038;MSPPError=-2147217396</a></p>
<p>(TLDR: Shell Folder Get Attributes Of)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1314485">
				<div id="div-comment-1314485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">...doug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314485">
			November 1, 2017 at 8:59 am</a>		</div>

		<p>Probably Shell Folder Get Attributes Of, derived from the IShellFolder::GetAttributesOf method.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-iboyd even thread-odd thread-alt depth-1 parent" id="comment-1314505">
				<div id="div-comment-1314505" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314505">
			November 1, 2017 at 11:55 am</a>		</div>

		<p>I tested a ZIP file sitting on a phone connected using Media Transfer Protocol (MTP). It has `SFGAO_Stream`, but not `SFGAO_FileSystem` nor `SFGAO_Folder`. Looks like MTP shell handler doesn&#8217;t expose ZIPs as virtual folders with data.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1314506">
				<div id="div-comment-1314506" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314506">
			November 1, 2017 at 11:59 am</a>		</div>

		<p>Makes sense. The Zip Folder implementation requires a file system file, and MTP can&#8217;t give it one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even depth-2 parent" id="comment-1314516">
				<div id="div-comment-1314516" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314516">
			November 1, 2017 at 7:23 pm</a>		</div>

		<p>I don&#8217;t think filesystem means any type of filesystem nor any type of hardware connection even if the filesystem is FAT etc. I believe it means; if the filesystem bit is set then the shell (IShellFolder implementation) is able to convert the PIDL to a path. Basically classic drive letters and UNC paths and most code probably assumes that the functions in kernel32 are able to parse said path.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-3" id="comment-1314565">
				<div id="div-comment-1314565" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314565">
			November 2, 2017 at 11:06 am</a>		</div>

		<p>After all, there&#8217;s a file system on web servers and FTP servers, but they aren&#8217;t in the local file system either.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fjeldse even depth-2" id="comment-1314526">
				<div id="div-comment-1314526" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Erik+F' rel='external nofollow' class='url'>Erik F</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314526">
			November 1, 2017 at 11:23 pm</a>		</div>

		<p>Looking at the MTP spec (<a href="http://www.usb.org/developers/docs/devclass_docs/MTPv1_1.zip" rel="nofollow">http://www.usb.org/developers/docs/devclass_docs/MTPv1_1.zip</a> from <a href="https://en.wikipedia.org/wiki/Media_Transfer_Protocol" rel="nofollow">https://en.wikipedia.org/wiki/Media_Transfer_Protocol</a>), it doesn&#8217;t appear that ZIP files have a object format so they are presented as &#8220;Unknown object&#8221; to the host. This limits what the MTP handler can do with it I would think.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-deskrule odd alt thread-even depth-1 parent" id="comment-1314527">
				<div id="div-comment-1314527" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/deskrule' rel='external nofollow' class='url'>deskrule</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314527">
			November 2, 2017 at 1:18 am</a>		</div>

		<p>&gt; I couldn&#8217;t think of an example of a virtual folder with data.</p>
<p>a subfolder within a zipfolder</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1314547">
				<div id="div-comment-1314547" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314547">
			November 2, 2017 at 6:09 am</a>		</div>

		<p>Wouldn&#8217;t that still have SFGAO_FILESYSTEM ?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-3" id="comment-1314575">
				<div id="div-comment-1314575" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314575">
			November 2, 2017 at 11:07 am</a>		</div>

		<p>No, because there is no file name for &#8220;the foo subdirectory in bar.zip&#8221;. It would be a virtual folder with data if the virtual folder implementation dynamically generated a new zip file for the subfolder. I don&#8217;t think anybody does this though.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1314535">
				<div id="div-comment-1314535" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua Schaeffer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20171101-00/?p=97325#comment-1314535">
			November 2, 2017 at 5:19 am</a>		</div>

		<p>IShellFolder is strictly STA right?  Does that mean any IStream produced by BindToStorage() is stuck on that thread? Is there a way to set up the bind context to know for sure?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>