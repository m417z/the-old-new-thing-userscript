<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1 parent" id="comment-1227641">
				<div id="div-comment-1227641" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scarlet Manuka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227641">
			February 22, 2016 at 10:09 pm</a>		</div>

		<p>This seems like a case where, assuming you don&#8217;t care about the output format, it&#8217;d be easier to deal with the inputs as fixed point binary strings. Then you just have to go along the strings and look for the first place where they don&#8217;t match, put a 1 in that position  and you&#8217;re done.</p>
<p>Now performance wise this may not be too great, depending on how your language of choice deals with strings, but conceptually it seems simpler to me.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1227651">
				<div id="div-comment-1227651" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Xinthia Douglas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227651">
			February 23, 2016 at 2:06 am</a>		</div>

		<p>If the numbers are fixed-point, you can do that by first xorring the two inputs, and then finding the first 1. Here are some ideas on how to do that: <a href="http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious" rel="nofollow">http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious</a><br />
The most obvious one would be to left shift the number to test, while simultaneously right shifting our result number.<br />
And I agree that conceptually, it does seem simpler.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2 parent" id="comment-1227661">
				<div id="div-comment-1227661" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227661">
			February 23, 2016 at 2:26 am</a>		</div>

		<p>I don&#8217;t think that algorithm agrees with Raymond&#8217;s for inputs 0.25, 0.5 &#8211; his returns 0.25 but you return 0.5.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1227673">
				<div id="div-comment-1227673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227673">
			February 23, 2016 at 2:29 am</a>		</div>

		<p>Hmm, thinking about it, I&#8217;d expect the surreal number for { 0.25 | 0.5 } would be 0.375, but maybe I miscalculated Raymond&#8217;s algorithm.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-4" id="comment-1227701">
				<div id="div-comment-1227701" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227701">
			February 23, 2016 at 5:03 am</a>		</div>

		<p>More likely is that I miscalculated my algorithm.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1227681">
				<div id="div-comment-1227681" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Xinthia Douglas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227681">
			February 23, 2016 at 2:41 am</a>		</div>

		<p>But isn&#8217;t 0.5 shorter than 0.25? And expressed in binary, 0.01 &lt;= 0.1 &lt;= 0.1.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2" id="comment-1227711">
				<div id="div-comment-1227711" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227711">
			February 23, 2016 at 5:04 am</a>		</div>

		<p>If you&#8217;re going to do that, then skip the string and just do bit operations directly on the mantissa.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1227671">
				<div id="div-comment-1227671" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227671">
			February 23, 2016 at 2:26 am</a>		</div>

		<p>Related: <a href="http://codegolf.stackexchange.com/q/73509/17602" rel="nofollow">http://codegolf.stackexchange.com/q/73509/17602</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1227691">
				<div id="div-comment-1227691" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steinar H. Gunderson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1227691">
			February 23, 2016 at 2:54 am</a>		</div>

		<p>I believe it&#8217;s possible to do this without a for loop, in just a few instructions, if you&#8217;re willing to assume numbers are IEEE 754 floats. It&#8217;s more complicated, but here&#8217;s an outline (ignoring NaNs and inf for now):</p>
<p>&#8211; If the signs differ, either the numbers are -0.0 and +0.0 (in which case there is no solution), or +0.0 is your solution.<br />
&#8211; If the exponents are the same, find the first digit of the mantissa where they differ (the smaller will be 0 and the larger will be 1, at least assuming positive numbers). You can do this in constant time with XOR and a bit-search instruction. Try setting the 0-bit in the smaller to 1 and truncating the rest; if that&#8217;s not equal to the larger number, that&#8217;s your solution. If it _is_ equal to the larger, set the end to …01 instead of …1. That&#8217;s your solution.<br />
&#8211; If the exponents are different, I&#8217;m not sure if there&#8217;s sufficient information in your problem. (What&#8217;s the right solution for 2.0 and 32.0; are 4, 8 and 16 all good solutions? Or 2.5? Or are these numbers implicitly fixed-point with the 1.0 bit as the first one?) Anyway, for one possible interpretation, you can take the smaller number (again assuming they are positive), find the first 0 bit, flip it to 1 and truncate as above. If the mantissa is all-ones, the solution is to just add epsilon, which takes you up to the next exponent.</p>
<p>If the numbers are to be interpreted as fixed-point between 0.0 and 1.0, you can convert them to fixed-point by just adding 1.0 (making them between 1.0 and 2.0), and then you can follow case #2 above. That&#8217;s probably cheating, though, since it chops off precision :-)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1228351">
				<div id="div-comment-1228351" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1228351">
			February 26, 2016 at 3:07 pm</a>		</div>

		<p>For (2.0, 32.0) the answer is 3. The smallest denominator is 1, and the smallest numerator for that denominator is 3.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1228331">
				<div id="div-comment-1228331" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Xinthia Douglas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1228331">
			February 26, 2016 at 2:10 pm</a>		</div>

		<p>‘Your comment is awaiting moderation.’<br />
Can I ask why it is taking so long?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1228332">
				<div id="div-comment-1228332" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1228332">
			February 26, 2016 at 3:04 pm</a>		</div>

		<p>I&#8217;m kind of busy. Also, comments with fake email addresses are not accepted.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1228382">
				<div id="div-comment-1228382" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160222-00/?p=93061#comment-1228382">
			February 26, 2016 at 9:48 pm</a>		</div>

		<p>The practical usage of this exercise is in Fano coding ( <a href="https://en.wikipedia.org/wiki/Shannon%E2%80%93Fano_coding" rel="nofollow">https://en.wikipedia.org/wiki/Shannon%E2%80%93Fano_coding</a> ).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>