<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (43)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1111613">
				<div id="div-comment-1111613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111613">
			March 11, 2014 at 7:11 am</a>		</div>

		<p>Feeling brutal?</p>
<p>The warn opening is a good thing. No, I don&#39;t want to open the 500mb doc file you linked to (you != Raymond in this case).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com odd alt thread-odd thread-alt depth-1" id="comment-1111633">
				<div id="div-comment-1111633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111633">
			March 11, 2014 at 7:35 am</a>		</div>

		<p>Unfortunately even if the policy is set, it depends on the app which is copying/downloading that file to respect that policy setting. Latest Mozilla Firefox for example doesn&#39;t respect it. Thankfully I use IE. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1111643">
				<div id="div-comment-1111643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111643">
			March 11, 2014 at 7:36 am</a>		</div>

		<p>If I wanted to make my computer less secure, I would make it hide file extension in email attachments. What are you saying? It&#39;s already default? Sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111653">
				<div id="div-comment-1111653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111653">
			March 11, 2014 at 7:43 am</a>		</div>

		<p>Personally, I much preferred the Windows 98 lack of warnings and &quot;busybody&quot;-ness. &nbsp;Honestly, I was just fine with a virus scanner telling me if something was amiss, and otherwise the OS not asking me to confirm something that I am not honestly qualified to answer (it feels more like a cover-thy-ass approach from MS &#8211; &quot;well, YOU clicked open it even after being warned of the potential&#8230;&quot; &nbsp;Everything has the potential&#8230; give me tools that actually look at that file to see if it actually is dangerous &#8211; keep databases on files that prove to be dangerous, etc., but blind &quot;are you sure?!&quot; type confirmations (repeatedly) I find to be &#8230; less than honest and/or useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111673">
				<div id="div-comment-1111673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nichilist</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111673">
			March 11, 2014 at 8:14 am</a>		</div>

		<p>Just a little while before 1995 the problem these warnings are trying to solve was no problem. Computer wouldn&#39;t simply run anything by just clicking them and people had to know beforehand which program they needed, launch that and open the file from there.</p>
<p>I know catering to ignorant people helps microsoft and it&#39;s cousins (apple, first in line, in fact double click is their idea I think), and perhaps give an illusion of being better out to those ignorants, but that&#39;s not a road I approve we going on (for more than 20 years now)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111683">
				<div id="div-comment-1111683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111683">
			March 11, 2014 at 8:16 am</a>		</div>

		<p>@Nichilist</p>
<p>I&#39;m sure September will end any day now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf even thread-even depth-1" id="comment-1111693">
				<div id="div-comment-1111693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111693">
			March 11, 2014 at 9:10 am</a>		</div>

		<p>The big problem with the zone identifier thing is that some files gain more power locally than on the web: HTML pages that now execute in the Computer zone instead of the Web zone, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111723">
				<div id="div-comment-1111723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111723">
			March 11, 2014 at 9:42 am</a>		</div>

		<p>I know of a certain PDF reader application that tries very hard to behave this way:</p>
<p>&#8211; it installs a Browser Helper Object (aka IE plugin)</p>
<p>&#8211; if you disable the BHO, the documents will still auto-open due to BrowseInPlace registry entry (ActiveX Document)</p>
<p>&#8211; if you delete the BrowseInPlace registry entry, the PDFs will still autodownload and auto-open due to EditFlags set to FTA_OpenIsSafe (0x00010000)</p>
<p>&#8211; if you delete the EditFlags for .PDF, there are still many more similar file types used by this application and registered in the same way</p>
<p>Last but not least, it also makes some of its registry keys read-only and sets the Owner SID on those keys to SYSTEM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf even thread-even depth-1" id="comment-1111733">
				<div id="div-comment-1111733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111733">
			March 11, 2014 at 9:52 am</a>		</div>

		<p>Unfortunately not all browsers save the &quot;Mark Of The Web&quot;, and for a file without, the only options available to the user are all-or-nothing: The Information Bar will show the user is a &quot;more secure than the web, but nothing works&quot; option, a &quot;more dangerous than the web&quot; option, but no &quot;just do as if it were on the web&quot; option which is what the user wanted in the first place (but not what a local WebBrowser-using application wants).</p>
<p>Firefox is a browser that neither injects a &quot;Mark Of The Web&quot; in the web page contents nor in an alternate data stream when you save a web page.</p>
<p>Also, it sounds like disabling zone preservation disables the mark of the web as well, right? If yes, it&#39;s a further argument that disabling it is shooting self in the foot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111743">
				<div id="div-comment-1111743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111743">
			March 11, 2014 at 9:57 am</a>		</div>

		<p>@Adam: 7497 days in, and counting&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111763">
				<div id="div-comment-1111763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111763">
			March 11, 2014 at 10:03 am</a>		</div>

		<p>@Nichilist: File associations existed at least as far back as Windows 3.1. I remember File Manager listing files whose extension had an associated program as pieces of paper with writing on them, whereas files without an associated program were represented as black pieces of paper. Just how far back before 1995 are you talking?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111773">
				<div id="div-comment-1111773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111773">
			March 11, 2014 at 10:55 am</a>		</div>

		<p>Raymond, zone identifiers are sometimes useful, but more often than not they&#39;re annoying. &nbsp;.chm files are unusable unless you find and clear them (and I had a colleague who had actually copied a file off of a USB thumb drive which was evidently formatted with NTFS, because it STILL had a zone identifier, and I had to walk him through clearing it). &nbsp;As a developer, jQuery is really bad, too. &nbsp;Since jQuery revs frequently, it never gets to the point where SmartScreen decides it&#39;s a legitimate file, and since its extension is .js, which is executable via WSH, IE thinks that I want to run it instead of copying it. &nbsp;Thus IE blocks it and makes it rather hard to get to as opposed to other files (which are easy to &quot;Open Folder&quot; to).</p>
<p>There has to be some design in the middle.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111783">
				<div id="div-comment-1111783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111783">
			March 11, 2014 at 11:11 am</a>		</div>

		<p>Ah how the world would have been different if the document-action for an EXE file was open in debugger (or in absense of debugger open with properties).</p>
<p>Sure I&#39;d have put execute in the actions but it wouldn&#39;t have been the default. Open document and execute program really shouldn&#39;t occupy the same mental action space.</p>
<p>In &#39;95, most users would need the latter case only for programs on removable media anyway. All others would have shortcuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111793">
				<div id="div-comment-1111793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111793">
			March 11, 2014 at 11:58 am</a>		</div>

		<p>@Rob: Automate your jQuery updates with a package manager of your choice, such as npm, NuGet, bower, or what have you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111803">
				<div id="div-comment-1111803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nico</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111803">
			March 11, 2014 at 12:27 pm</a>		</div>

		<p>&gt; Welcome to 1995. Enjoy your stay.</p>
<p>This got an lol from me. &nbsp;Reading the post I kept thinking &quot;this sure sounds familiar&quot;. &nbsp;The only thing missing is an ActiveX dialog prompt that says &quot;Do you want to install and run &quot;YOUR COMPUTER REQUIRES AN UPDATE TO SEE THIS PAGE-CLICK YES TO CONTINUE&quot; signed on 5/13/2001&#8230;..&quot;</p>
<p>The &quot;mark of the web&quot; doesn&#39;t bother me, but I wonder how much it has actually helped prevent problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111813">
				<div id="div-comment-1111813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KapilK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111813">
			March 11, 2014 at 12:52 pm</a>		</div>

		<p>@Joshua &#8211; Then we would not have enjoyed the delicious autorun.inf functionality.</p>
<p>Ofcource, not having the .EXE execute by default would have meant a difficult transition from Windows 95 to NT based OSs and Microsoft would have lost some money. Screwing over the security of users vs making a few billion dollars &#8211; I&#39;m not sure I&#39;d side with the users either.</p>
<p>I guess in that scenario only MSI installers would be the official way to create files blessed with the execute bit (other than the user manually doing it and propagation via NTFS compatible compression formats). Also would have been cool if MS had documented the MSI standard back then to allow for greater adoption.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111823">
				<div id="div-comment-1111823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111823">
			March 11, 2014 at 1:40 pm</a>		</div>

		<p>And of course, this isn&#39;t an option at all if you have a home version of Windows that lacks gpedit.msc. <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/ms815238.aspx">msdn.microsoft.com/&#8230;/ms815238.aspx</a> doesn&#39;t include this crucial setting sadly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-1111833">
				<div id="div-comment-1111833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111833">
			March 11, 2014 at 1:51 pm</a>		</div>

		<p>I wonder why Outlook still don&#39;t have UI for Level1Remove.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111843">
				<div id="div-comment-1111843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111843">
			March 11, 2014 at 2:22 pm</a>		</div>

		<p>@&#39;k: It&#39;s not permission based. Right-click -&gt; run would have been the way to execute a program given its .exe file.</p>
<p>In my worldview, autorun.inf would have only worked for CD-ROMs. (not CD-RW media)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111853">
				<div id="div-comment-1111853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dylan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111853">
			March 11, 2014 at 3:37 pm</a>		</div>

		<p>@Joshua: If you use an old CD-ROM drive, can it even tell if a CD-R is writable? &nbsp;Or even worse, look at the U3 devices that pretend to be a CD-ROM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-john-ludlow even thread-even depth-1" id="comment-1111863">
				<div id="div-comment-1111863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/John+Ludlow' rel='external nofollow' class='url'>John Ludlow</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111863">
			March 11, 2014 at 3:51 pm</a>		</div>

		<p>Is there a way to set or clear the zone identifier on a batch basis? Say, for every file in a folder.</p>
<p>That would probably go a long way to quelling any objections to zone identifiers without having to resort to switching them off.</p>
<p>While I get why they exist, there&#39;s thing Microsoft could do to make the experience better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf odd alt thread-odd thread-alt depth-1" id="comment-1111703">
				<div id="div-comment-1111703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111703">
			March 11, 2014 at 9:12 am</a>		</div>

		<p>(whoops I submitted early)</p>
<p>Ordinary people don&#39;t understand that, *nor should they have to*. Principle of least astonishment says that if I open something from the web, it should be just like it was on the web.</p>
<p>This is why disabling the preservation of zone identifiers is a dangerous thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-1111713">
				<div id="div-comment-1111713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111713">
			March 11, 2014 at 9:17 am</a>		</div>

		<p>@Medinoc: &quot;HTML pages that now execute in the Computer zone&quot;. Since XP SP2/Windows Server 2003 SP1, the Local Machine zone has been locked down &#8211; it is now (by default) *more* secure than the Internet zone. See for example <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/ieinternals/archive/2011/03/23/understanding-local-machine-zone-lockdown-restricted-this-webpage-from-running-scripts-or-activex-controls.aspx" rel="nofollow">blogs.msdn.com/&#8230;/understanding-local-machine-zone-lockdown-restricted-this-webpage-from-running-scripts-or-activex-controls.aspx</a> .</p>
<p>XP SP2 was released nearly 10 years ago (August 2004).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf odd alt thread-odd thread-alt depth-1" id="comment-1111753">
				<div id="div-comment-1111753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111753">
			March 11, 2014 at 10:00 am</a>		</div>

		<p>Similarly, is there any way in Office (such as Word) to see the code of a document&#39;s macros *before* unlocking the document?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1111873">
				<div id="div-comment-1111873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111873">
			March 11, 2014 at 5:20 pm</a>		</div>

		<p>&gt; Is there a way to set or clear the zone identifier on a batch basis? Say, for every file in a folder</p>
<p>Sure, just set up a FileSystemWatcher for the folder in question, and remove the zone identifier from files as they show up.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111883">
				<div id="div-comment-1111883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111883">
			March 11, 2014 at 5:26 pm</a>		</div>

		<p>@Dylan: By checking for ISO9660 filesystem w/o growth records. This kind of filesystem is probably too difficult to directly infect and too rarely made by casual users anyway (CD-R and CD-RW would normally use extendible records).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111893">
				<div id="div-comment-1111893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KapilK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111893">
			March 12, 2014 at 2:17 am</a>		</div>

		<p>@Joshua: How is right-click run any better than double-click run?</p>
<p>Like I said the best thing is to not have a .EXE extension at all. Explorer parses files which have the executable bit set and loads up the icon if the file is valid. By default, files not created by an installer will never have the executable bit set.</p>
<div class="post">[<em>What&#39;s to prevent somebody from just setting the executable bit on any file they want? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111903">
				<div id="div-comment-1111903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111903">
			March 12, 2014 at 2:58 am</a>		</div>

		<p>Go away back to Unix world please. Users dont want to set their files executable to run them. And anyone can create an installer that makes themselves executable in that case so you&#39;re back to square one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111933">
				<div id="div-comment-1111933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111933">
			March 12, 2014 at 5:08 am</a>		</div>

		<p>@1995 had some&#8230;: So you&#39;re saying a technique that limits the social engineering vector is not on the radar when looking at OS-level exploits to circumvent the need to actually social engineer an attack? Color me surprised. </p>
<p>How often do you think &quot;hide known file extensions&quot; turns up in MS&#39; patch notes or in security bug descriptions? Also not a single time? So does that mean you don&#39;t gain any additional security from seeing &quot;foo.doc.exe&quot; instead of &quot;foo.doc&quot; either? </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111943">
				<div id="div-comment-1111943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111943">
			March 12, 2014 at 7:06 am</a>		</div>

		<p>@voo: The solution is simple: Windows shouldn&#39;t hide multiple extensions, or even block execution of such files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111953">
				<div id="div-comment-1111953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111953">
			March 12, 2014 at 7:09 am</a>		</div>

		<p>@&#39;k: It&#39;s simply the most sensible way to make sure .jpg.exe infects nobody by accident. Permission systems are just too heavyweight for W95.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1111973">
				<div id="div-comment-1111973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111973">
			March 12, 2014 at 7:47 am</a>		</div>

		<p>This is OK when it is one file&#8230; but compressed files will retain this flag across all files which are uncompressed from that file. Which can lead to a support nightmare.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-1111983">
				<div id="div-comment-1111983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111983">
			March 12, 2014 at 7:53 am</a>		</div>

		<p>&quot;If I wanted to make my computer less secure, I would make it hide file extension in email attachments.&quot;</p>
<p>If I wanted to make MY computer less secure, I would hide file extensions by default in Windows Explorer. &nbsp;Oh, wait&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112013">
				<div id="div-comment-1112013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112013">
			March 12, 2014 at 8:54 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2009/02/13/9416485.aspx">blogs.msdn.com/&#8230;/9416485.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1111913">
				<div id="div-comment-1111913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">1995 had some good rap let me tell you</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1111913">
			March 12, 2014 at 4:20 am</a>		</div>

		<p>In 1995 my parents&#39; Windows machine could go for three weeks without becoming infested with adware, so I&#39;m not personally seeing the payoff from the &quot;one more msgbox&quot; play.</p>
<p>In 2014 any file a home user is likely to open *did* come from the Internet unless they created it themselves locally, so it&#39;s hard for me to see how one could find value in that &quot;Security Warning&quot; unless they suffer from Stockholm Syndrome.</p>
<p>Just take a look at any security researcher&#39;s blog, or any penetration tester&#39;s presentation, or any anti virus company&#39;s teardown of the latest browser exploit kit or banking trojan, or any Microsoft write-up of this month&#39;s patched security bugs, or any of the more detailed write-ups that show up later in the tools that exploit them like metasploit&#8230; and see how many times &quot;zone identifiers&quot; come up. It&#39;s just not on that radar because it doesn&#39;t even exist in the same spectrum of what&#39;s really going on out there. (&quot;out there&quot; being my parents&#39; computer in the next three weeks.) Even in the unlikely event that this dialog enters into an infection&#39;s workflow, I think we all know the only outcome from that step: Not reading the prompt and clicking &quot;YES OF COURSE DUH&quot; just like the user has been trained to do by years of opening files to get things done. (As you have blogged!) We&#39;ll see an NSA slide someday that says &quot;At this point, the user could defeat the implant by opting to *not* open the file. LOL MOVING ON.&quot;</p>
<p>Raymond you are my programming hero, originally for the way your mind handles machines but later for the way it handles people. Your patience inspires me, as does the fireworks display when it runs out. I wince though when you engage a rant that&#39;s washed up on your shore that you don&#39;t deserve but geez *somebody* does. Especially when it&#39;s inappropriate, inarticulate, off-topic, rude, and right.</p>
<p>In retrospect, I should have just abbreviated this to &quot;you are my programming hero&quot;, because that was the most important part. I use hand gestures when describing your existence to others! I always look forward to reading your writing.</p>
<div class="post">[<em>So I&#39;m not allowed to respond to a diatribe with a counter-diatribe? Trying to figure out what the rules are. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-1112033">
				<div id="div-comment-1112033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112033">
			March 12, 2014 at 1:22 pm</a>		</div>

		<p>Personally, I do wish that MS would change the default to show file extensions by default.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112053">
				<div id="div-comment-1112053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112053">
			March 12, 2014 at 6:06 pm</a>		</div>

		<p>@Joshua: read-only media can also be malicious (see for instance the Sony Rootkit).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112313">
				<div id="div-comment-1112313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112313">
			March 13, 2014 at 11:46 am</a>		</div>

		<p>@Joshua: A 500mb doc file is nothing, actually &lt;1% of my available ram. There&#39;s no excuses why it shouldn&#39;t open just fine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112353">
				<div id="div-comment-1112353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KapilK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112353">
			March 13, 2014 at 1:16 pm</a>		</div>

		<p>[What&#39;s to prevent somebody from just setting the executable bit on any file they want? -Raymond]</p>
<p>I already excluded this use-case in an earlier comment. It is reasonable to assume it means &quot;I know what I&#39;m doing&quot; vs. a novice user randomly double clicking .exe attachments, etc.</p>
<p>@ Joshua</p>
<p>&gt; Permission systems are just too heavyweight for W95.</p>
<p>Oh, I was talking about the transition to a sane OS design (NT) from the W95 world of &quot;Hey Bob I just left this note for you to let you know that I parked my lawnmower in your fridge to cool off the engine and I borrowed your company credit card to purchase a private jet for Jack. We&#39;re cool right?&quot;</p>
<p>&gt;And anyone can create an installer that makes themselves executable in that case so you&#39;re back to square one.</p>
<p>No, you are not back to square one. (1) Novice users are protected from spammers attaching executable files to emails (2) Browser bugs delivering drive-by malware no longer are able to run the malware (3) having an central MSI model of installation allows the OS to have a more rigid model in dealing with dependencies. (4) requiring MSIs to be digitally signed leaves a digital trace back to the s/w author.</p>
<p>Note that tinkerers and power users can still execute whatever they want just by setting the execute bit so it doesn&#39;t burden them too much.</p>
<p>I&#39;m sure this is nothing new to most people on the Windows dev team. Its rather that the business concerns override the security concerns.</p>
<div class="post">[<em>I guess I don&#39;t see how you can make it so only MSI can set the executable bit. If you have Full Control over a file, you can set any bit you want. That&#39;s what Full Control means. Or are you saying that nobody has Full Control any more? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112513">
				<div id="div-comment-1112513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KapilK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112513">
			March 14, 2014 at 4:05 am</a>		</div>

		<p>&gt;[I guess I don&#39;t see how you can make it so only MSI can set the executable bit. If you have Full Control over a file, you can set any bit you want. That&#39;s what Full Control means. Or are you saying that nobody has Full Control any more? -Raymond]</p>
<p>Its not the MSI per-se that sets the executable bit. Its the OS part (Windows Installer Service I presume) which parses the MSI data structures, unpacks and installs all the stuff that sets the executable bit (on files explicitly specified in the MSI tables as requiring it)</p>
<p>A user ofcource should be able to manually set the bit, but like I said &#8211; its reasonable for the OS to assume the user knows what hes doing in that particular scenario.</p>
<p>There are other alternative models with creative use of things like software restriction policies but that is another topic.</p>
<div class="post">[<em>But if the user can set the bit, then malware running as the user can set the bit, too. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112563">
				<div id="div-comment-1112563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Katie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112563">
			March 14, 2014 at 5:59 am</a>		</div>

		<p>If an application couldn&#39;t run because the execute bit wasn&#39;t set, then presumably Windows would have to pop up an error along the lines of &quot;this file does not have permission to execute,&quot; and give instructions on where to find the &quot;executable&quot; checkbox. How is this different than the zone security warning letting you know that the file isn&#39;t trusted, but you can run it anyways and mark it as safe if you want to?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112653">
				<div id="div-comment-1112653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112653">
			March 14, 2014 at 8:41 am</a>		</div>

		<p>[But if the user can set the bit, then malware running as the user can set the bit, too. -Raymond]</p>
<p>The intended result is a program that managed to get itself downloaded incidentally doesn&#39;t start.</p>
<p>Unfortunately it doesn&#39;t do much for security without the other Unix tradition that removable</p>
<p>media is mounted by default w/o execute permissions (noexec). The Windows culture wouldn&#39;t put</p>
<p>up with that half so there&#39;s not much point.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112783">
				<div id="div-comment-1112783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KapilK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140311-00/?p=1543#comment-1112783">
			March 15, 2014 at 12:43 am</a>		</div>

		<p>@Joshua</p>
<p>&gt;Unfortunately it doesn&#39;t do much for security without the other Unix tradition that removable media is mounted by default w/o execute permissions (noexec)</p>
<p>How does it not do much? No email attack vector. No possibility of drive-by malware binaries. No fake &#39;download this codec&#39; malware, etc, etc. Yes, you can inject shellcode after exploiting memory bugs &#8211; but that&#39;s going to be there no matter what you do &#8211; till our code become &#39;provable&#39;. And these days most executable memory pages are read-only and with the IP-on-stack check, you eliminate most vectors.</p>
<p>I&#39;m curious as to where you have your bar set at if knocking down so many attack vectors &#39;doesn&#39;t do much&#39;.</p>
<p>&gt;The Windows culture wouldn&#39;t put up with that half so there&#39;s not much point.</p>
<p>What exactly would be the problem? Users downloading plain .exes and running them is not a mainstream usecase anymore. The .exe files will almost always come from installers.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>