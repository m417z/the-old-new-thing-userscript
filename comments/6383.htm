<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (25)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1014823">
				<div id="div-comment-1014823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014823">
			October 8, 2012 at 7:06 am</a>		</div>

		<blockquote><p>
  &gt; It&#39;s not that Explorer actually keeps track of the files as they move around, just in case you had a shortcut to them.
</p></blockquote>
<p>And luckily it does so.. otherwise the classic &quot;rename old file, copy new file&quot; would update the shortcut which is not what one wants.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014853">
				<div id="div-comment-1014853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014853">
			October 8, 2012 at 7:38 am</a>		</div>

		<p>Odd. I don&#39;t know if it&#39;s because I&#39;m a programmer or what, but I&#39;ve never seen this feature used in real life.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1014863">
				<div id="div-comment-1014863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Muzer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014863">
			October 8, 2012 at 7:40 am</a>		</div>

		<p>I find it irritating when you click on a shortcut that doesn&#39;t exist and it offers to replace the shortcut with the found one (if it does find one), even when you don&#39;t have write access to the shortcut. This might have changed, of course, my only experience with that was XP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1014873">
				<div id="div-comment-1014873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014873">
			October 8, 2012 at 8:11 am</a>		</div>

		<blockquote><p>
  otherwise the classic &quot;rename old file, copy new file&quot; would update the shortcut which is not what one wants.
</p></blockquote>
<p>In NTFS it probably will do that. NTFS shortcut keeps a file GUID. If you move a file and replace it with the new file with the same name, the GIUD will belong to the old file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1014883">
				<div id="div-comment-1014883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014883">
			October 8, 2012 at 8:12 am</a>		</div>

		<p>&quot;xpclient: and even then, it doesn&#39;t place that file in the sort order&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014893">
				<div id="div-comment-1014893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014893">
			October 8, 2012 at 9:04 am</a>		</div>

		<p>@Vilx: I&#39;ve never made use of this feature, either. &nbsp;Then again I don&#39;t create many personal shortcuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jader3rd even thread-even depth-1" id="comment-1014903">
				<div id="div-comment-1014903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/jader3rd' rel='external nofollow' class='url'>jader3rd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014903">
			October 8, 2012 at 9:24 am</a>		</div>

		<p>I didn&#39;t know it kept track of a rename. In the Vista timeframe I&#39;d import some pictures, and then with a combination of Tab and F2 start renaming them. Many times I&#39;d outpace Explorer (I could see it struggle with the renames), and then when I&#39;d add some metadata tags (which was a much richer experience in Vista than in 7) Explorer would fail with errors saying that it couldn&#39;t find the file; sometimes the error was with the new name, sometimes with the old.</p>
<p>It&#39;s the reason why I wish that Explorer would make the changes asynchronously, and assume that it was going to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014913">
				<div id="div-comment-1014913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Giulia Q</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014913">
			October 8, 2012 at 9:46 am</a>		</div>

		<p>@vilx: when this feature works, you won&#39;t even notice you used it :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1014933">
				<div id="div-comment-1014933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Giovanni</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014933">
			October 8, 2012 at 10:49 am</a>		</div>

		<p>I wish Windows creates relative shortcuts so I can use them on a DVD-R.</p>
<div class="post">[<i>Oh, you mean SLDF_HAS_RELPATH, which is on by default? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-andycadley2 odd alt thread-odd thread-alt depth-1" id="comment-1014943">
				<div id="div-comment-1014943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/AndyCadley' rel='external nofollow' class='url'>AndyCadley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014943">
			October 8, 2012 at 11:53 am</a>		</div>

		<p>@alegr1: It doesn&#39;t matter if you&#39;re using NTFS, because the path to a file that the shortcut pointed to is still valid and thus there is no need to &quot;resolve&quot; the shortcut. Although the guid no doubt helps in all those cases where the target does go missing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1014953">
				<div id="div-comment-1014953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skyborne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014953">
			October 8, 2012 at 12:30 pm</a>		</div>

		<p>One time, the flashlight-finding-a-folder animation came up on our Windows 95 machine and my mom seemed surprised at it, saying something like, &quot;it thinks it&#39;s dark in there?&quot; &nbsp;I guess to her, it should be bright inside the computer because the screen is lit up.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014963">
				<div id="div-comment-1014963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014963">
			October 8, 2012 at 1:07 pm</a>		</div>

		<p>[Oh, you mean SLDF_HAS_RELPATH, which is on by default? -Raymond]</p>
<p>Try this. Burn such a DVD-R. Move it to a second DVD drive. Access the file via the shortcut. Grind-grind-grind oops no disk in first drive. Then it tries to resolve the second drive (which does work).</p>
<p>At least that&#39;s the way it worked last time I tried it.</p>
<div class="post">[<i>Oh, now I understand the question. You want to suppress the initial probe and go straight to the relative path. I don&#39;t think that&#39;s possible. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1014973">
				<div id="div-comment-1014973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014973">
			October 8, 2012 at 1:54 pm</a>		</div>

		<p>[Oh, now I understand the question. You want to suppress the initial probe and go straight to the relative path. I don&#39;t think that&#39;s possible. -Raymond]</p>
<p>I&#39;ll bet a sufficiently deranged shortcut would work (primary path goes somewhere off of &#46;pipe or similar game), but good luck getting explorer to make one.</p>
<p>I solved the problem by shipping a tiny BAT file that could perform the relative lookup. So much easier.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014843">
				<div id="div-comment-1014843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/bombsoft_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>bombsoft@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014843">
			October 8, 2012 at 7:15 am</a>		</div>

		<p>I remember the torch animation.</p>
<p>&quot;Trying to find new target&#8230;&quot;</p>
<p>*torch scanning*</p>
<p>&quot;The file MyGame.exe has been moved or deleted. Do you want the shortcut to now point to RandomThingIShotWhileOnHoliday.jpg as the file closest matching? Yes/No&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1014993">
				<div id="div-comment-1014993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JustSomeGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014993">
			October 9, 2012 at 5:31 am</a>		</div>

		<p>I have a vague recollection that one version of OS/2 easily handled moving files around while still keeping shortcuts up to date. Or it may have been Workplace Shell.</p>
<p>Does anyone know about this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1015053">
				<div id="div-comment-1015053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015053">
			October 9, 2012 at 8:08 am</a>		</div>

		<ul>
<li>There is little problem in blog. People with no account are showing &quot;kurakuraninja&quot; if mouse is over their name in post title.</li>
</ul>
<p>I don&#39;t think that&#39;s a bug.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1015123">
				<div id="div-comment-1015123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015123">
			October 9, 2012 at 10:20 am</a>		</div>

		<p>Not to be confused with <a href="<a target="_new" href="http://technet.microsoft.com/en-us/library/cc736811.aspx" rel="nofollow">technet.microsoft.com/&#8230;/cc736811.aspx</a>&#8220;>Distributed Link Tracking, which can find a shortcut target if you:</p>
<ul>
<li>
<p>rename it</p>
</li>
<li>
<p>move it to a different folder</p>
</li>
<li>
<p>move it to a different volume</p>
</li>
<li>
<p>move it to a different computer</p>
</li>
<li>
<p>rename the computer the target is on</p>
</li>
<li>
<p>rename the share that the target is on</p>
</li>
</ul>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014983">
				<div id="div-comment-1014983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1014983">
			October 9, 2012 at 4:29 am</a>		</div>

		<p>&quot;You want to suppress the initial probe and go straight to the relative path.&quot;</p>
<p>I think he was after a shortcut with a relative destination *instead of* an absolute one &#8211; which seems a reasonable thing to want, indeed arguably a more reasonable expectation for most purposes than absolute ones, since drive letters aren&#39;t constant and I&#39;m sure the vast majority of links are intra-filesystem.</p>
<p>A batch/command file is a functional workaround, but far from ideal &#8211; surely there is a more elegant way?</p>
<div class="post">[<i>While I agree that it&#39;s an interesting feature, it&#39;s outside the scope of what shortcuts were originally designed for. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1015003">
				<div id="div-comment-1015003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Giovanni</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015003">
			October 9, 2012 at 5:42 am</a>		</div>

		<p>&quot;I think he was after a shortcut with a relative destination *instead of* an absolute one &#8211; which seems a reasonable thing to want, indeed arguably a more reasonable expectation for most purposes than absolute ones, since drive letters aren&#39;t constant and I&#39;m sure the vast majority of links are intra-filesystem.</p>
<p>A batch/command file is a functional workaround, but far from ideal &#8211; surely there is a more elegant way?&quot;</p>
<p>Si, si! When I put DVD-R in other PC then drive letter is changing. I was thinking relative shortcut is nice feature but Windows no support it. Batch file is not so nice way.</p>
<p>* There is little problem in blog. People with no account are showing &quot;kurakuraninja&quot; if mouse is over their name in post title.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1015243">
				<div id="div-comment-1015243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015243">
			October 9, 2012 at 10:35 pm</a>		</div>

		<p>Ian Boyd: Wouldn&#39;t Explorer just use the distributed link tracking service?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1015473">
				<div id="div-comment-1015473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015473">
			October 10, 2012 at 11:01 am</a>		</div>

		<p>I thought the Distributed Link Tracking Client was only useful on a domain-connected computer where there is a Distributed Link Tracking Server running in the same domain. &nbsp;Is that right or wrong?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1015493">
				<div id="div-comment-1015493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015493">
			October 10, 2012 at 12:10 pm</a>		</div>

		<p>@Gabe</p>
<blockquote><p>
  Wouldn&#39;t Explorer just use the distributed link tracking service?
</p></blockquote>
<p>i assume because Explorer was invented before NTFS, and has to run on file systems other than NTFS, they needed their own way to resolve shortcuts to the <a href="<a target="_new" href="http://technet.microsoft.com/en-ca/magazine/2006.09.windowsconfidential.aspx" rel="nofollow">technet.microsoft.com/&#8230;/2006.09.windowsconfidential.aspx</a>&#8220;>best of their limited ability.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1015543">
				<div id="div-comment-1015543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015543">
			October 10, 2012 at 4:23 pm</a>		</div>

		<p>[While I agree that it&#39;s an interesting feature, it&#39;s outside the scope of what shortcuts were originally designed for. -Raymond]</p>
<p>My first encounter with shortcuts encountered it. Had some program (probably game) on floppy and needed to start it with some custom options. Drive letter was A:. Guess what happened when I put the floppy into another machine that still had a 5.25&#39;&#39; floppy as A:.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1015563">
				<div id="div-comment-1015563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015563">
			October 10, 2012 at 10:22 pm</a>		</div>

		<p>Ian: The last paragraph of Raymond&#39;s article that you linked to actually implies that link tracking is indeed used by Explorer. And here&#39;s proof, from MSDN&#39;s documentation on the IShellLink::Resolve method:</p>
<p>&quot;If distributed link tracking is not available or fails to find the link object, Resolve attempts to find it with search heuristics.&quot; (from <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/bb774952.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/bb774952.aspx</a>)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1015593">
				<div id="div-comment-1015593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121008-00/?p=6383#comment-1015593">
			October 11, 2012 at 7:34 am</a>		</div>

		<p>@Gabe: i don&#39;t believe Explorer is &quot;using&quot; Distributed Link Tracking. If the Distributed Link Tracking client service is running, and it manages to resolve the shortcut for you &#8211; then Explorer never *realizes* that the shortcut was broken. DLT intercepts requests for a shortcut and resolves it for you, at the file system level.</p>
<p>Only if DLT could not resolve the link (service not running, file moved too far from it&#39;s capabilities), then the shortcut is passed (broken as it is) to the calling process.</p>
<p>You could test this by trying to call `CreateFile` on a broken shortcut from your own application. If the shortcut is resolved, then DLT fixed it for you. Otherwise the file will not be found.</p>
<div class="post">[<i>The file system doesn&#39;t know about shortcuts. That&#39;s purely a shell concept. The <code>IShellLink::Resolve</code> method first asks the DLT to find the target. If not found, then it uses its fallback algorithm. (I&#39;m still not sure what mental model you&#39;re using where <code>CreateFile</code> on a *.lnk file magically opens a file different from the one you requested, and even if it did, that wouldn&#39;t fix the shortcut target.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>