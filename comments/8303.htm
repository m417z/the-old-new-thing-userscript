<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (5)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-fredericmagnyf even thread-even depth-1" id="comment-967063">
				<div id="div-comment-967063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120215-00/?p=8303#comment-967063">
			February 15, 2012 at 8:03 am</a>		</div>

		<p>Expanding on this, do icons created from resources depend on the underlying resource, or can the DLL be freely unloaded without damaging the icon object?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967073">
				<div id="div-comment-967073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120215-00/?p=8303#comment-967073">
			February 15, 2012 at 9:12 am</a>		</div>

		<p>@Medinoc: Good question. The documentation for LoadImage doesn&#39;t cover this, and I&#39;d be interested to hear the answer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967093">
				<div id="div-comment-967093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120215-00/?p=8303#comment-967093">
			February 15, 2012 at 12:23 pm</a>		</div>

		<p>@Medinoc: I&#39;m guessing this depends on if you are using the LR_SHARED flag (&quot;Do not use LR_SHARED for images that have non-standard sizes, that may change after loading, or that are loaded from a file.&quot;). For file extensions, the shell icon cache probably also comes into play&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967103">
				<div id="div-comment-967103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120215-00/?p=8303#comment-967103">
			February 15, 2012 at 1:07 pm</a>		</div>

		<p>The fact that the documentation calls out that you need to call DestroyIcon, then I would guess that LoadImage makes a copy of the Icon. There is also:</p>
<p>&quot;The system automatically deletes these resources when the process that created them terminates; however, calling the appropriate function saves memory and decreases the size of the process&#39;s working set.&quot;</p>
<p>At the end of LoadImage, so I would guess that it makes a copy. But it is still questionable if it is a good idea to unload the DLL even then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967313">
				<div id="div-comment-967313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120215-00/?p=8303#comment-967313">
			February 16, 2012 at 10:32 pm</a>		</div>

		<p>There&#39;s the possibility that the icon object that you need to destroy only contains pointers to the data, no?</p>
<p>It&#39;s probably not what happens, but even if it isn&#39;t, it isn&#39;t in the documentation (though it should be) so you can&#39;t rely on it. Or maybe loading an icon from a DLL could cause the reference count of the DLL to increase&#8230;</p>
<p>There are many possible implementations of that function, all of which have side effects which can be important to know.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>