<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (8)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-955643">
				<div id="div-comment-955643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955643">
			December 28, 2011 at 9:30 am</a>		</div>

		<p>For people using windows 7 where &quot;C:Windowsclock.avi&quot; doesn&#39;t exist:</p>
<p>Relpace this line;</p>
<p>hr = GetUIObjectOfFile(hwnd, L&quot;C:\Windows\clock.avi&quot;,</p>
<p>with this:</p>
<p>hr = GetUIObjectOfFile(hwnd, L&quot;C:\Users\Public\Videos\Sample Videos\Wildlife.wmv&quot;,</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-955653">
				<div id="div-comment-955653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955653">
			December 28, 2011 at 9:56 am</a>		</div>

		<p>If the native menu in 2000 supports both D&amp;D and right-clicks(TPM_RECURSE), why are the startmenu submenus implemented with toolbar+pager? D&amp;D re-order? Hold shift to stay open?</p>
<div class="post">[<i>For the same reason <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/01/19/10117410.aspx" rel="nofollow">NASA didn&#39;t use the space shuttle to rescue the Apollo 13 astronauts</a>: Windows 2000 didn&#39;t exist in 1995. Or because the built-in functionality <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/01/04/10252869.aspx#10253330" rel="nofollow">doesn&#39;t quite do everything they needed</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-955673">
				<div id="div-comment-955673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sunil Joshi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955673">
			December 28, 2011 at 10:15 am</a>		</div>

		<p>Why was this feature implemted? What was the envisioned use?</p>
<div class="post">[<i>No idea. Maybe the menu manager folks were jealous of the Start menu. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-955683">
				<div id="div-comment-955683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955683">
			December 28, 2011 at 10:45 am</a>		</div>

		<p>@Raymond: IIRC Win95 used a normal menu and did support right-click, that stuff was added in the IE4 shellupdate/Win98.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-955693">
				<div id="div-comment-955693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955693">
			December 28, 2011 at 10:48 am</a>		</div>

		<p>did NOT (Damn you comment system forcing me to re-type)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-955703">
				<div id="div-comment-955703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955703">
			December 28, 2011 at 1:01 pm</a>		</div>

		<p>WndSks:</p>
<p>Even if it was added to the start menu in Win98, that doesn&#39;t mean that the native menus supported this kind of thing in Win98.</p>
<p>As you pointed out, Win98 had to fake it to be able to get this kind of functionality and then the native menu ability to do this was added at a later point.</p>
<p>As to why the Windows 2000 start menu was still written with the old code, well, if it isn&#39;t broke then don&#39;t fix it. What they introduced with Win98 worked perfectly well, so without a good reason it would have been daft for them to rewrite the start menu code and potentially introduce more bugs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-955723">
				<div id="div-comment-955723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955723">
			December 28, 2011 at 2:10 pm</a>		</div>

		<p>Facinating. Personally, I think this was for the cascading toolbars, which appeared on the NT branch in 2000. If the IE update that backported it to NT4 backported this also it would make perfect sense.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-955773">
				<div id="div-comment-955773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111228-00/?p=8783#comment-955773">
			December 28, 2011 at 8:26 pm</a>		</div>

		<p>As for the undiscoverability, this is true to some extent. But a lot of people know that you can drag around icons in the start menu and in the Favourites menu, so if you make your icons look like that, people will try it. By the way, is it really necessary to use owner draw to get that effect or is there an easier way? I&#39;ve found the standard menu icon functionality doesn&#39;t do what I want &#8211; the icons invert when I mouseover them.</p>
<div class="post">[<em>Stay tuned for <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/12/30/10251751.aspx" rel="nofollow">the exciting conclusion</a>. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>