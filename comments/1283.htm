<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (9)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1118303">
				<div id="div-comment-1118303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118303">
			April 10, 2014 at 8:12 am</a>		</div>

		<p>[The proposed workaround doesn&#39;t actually work reliably, which means that it probably shouldn&#39;t be done at all.]</p>
<p>Too bad I can&#39;t convince my bosses of that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1118323">
				<div id="div-comment-1118323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118323">
			April 10, 2014 at 10:59 am</a>		</div>

		<p>Far too many programmers out there work on the reverse assumption: &nbsp;If code doesn&#39;t fail reliably, use it (and reuse it, and copy it for use elsewhere).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1118343">
				<div id="div-comment-1118343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">immibis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118343">
			April 10, 2014 at 3:08 pm</a>		</div>

		<p>Of course, not everyone is using multiple threads. Or even multiple windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1118353">
				<div id="div-comment-1118353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118353">
			April 10, 2014 at 3:09 pm</a>		</div>

		<p>I&#39;m still not clear on why PrintWindow hates CS_PARENTDC. Here&#39;s what the docs (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff729176.aspx">msdn.microsoft.com/&#8230;/ff729176.aspx</a>) say:</p>
<p>Sets the clipping rectangle of the child window to that of the parent window so that the child can draw on the parent. A window with the CS_PARENTDC style bit receives a regular device context from the system&#39;s cache of device contexts. It does not give the child the parent&#39;s device context or device context settings. Specifying CS_PARENTDC enhances an application&#39;s performance. </p>
<p>It looks like this style means you&#39;re just asking for a special clipping rectangle (region?). I don&#39;t see what&#39;s to hate. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1118363">
				<div id="div-comment-1118363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio &amp;#39;Grijan&amp;#39;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118363">
			April 10, 2014 at 4:24 pm</a>		</div>

		<p>I have never understood the need for PrintWindow. Of course, WYSIWYG editors are supposed to use the same code to draw in both screen and printer. But they are different enough to make you use separate wrapper code. For starts, a window on the screen usually shows only part of the document, or maybe a page scaled to fit inside it. And the window may need to draw additional elements (page borders, window background outside the page, document/margin limits, table rows and columns&#8230;). PrintWindow is, IMHO, a quick and dirty job, and everyone lazy enough to use it should be punished (hey, many times, using it is its own punishment!).</p>
<p>@Gabe: read the linked article. It&#39;s not about clipping regions, but about the window using the wrong DC (in this case, a screen DC instead of the printer&#39;s DC).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1118373">
				<div id="div-comment-1118373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118373">
			April 10, 2014 at 6:31 pm</a>		</div>

		<p>@Antonio &#39;Grijan&#39; : The old ASPX programming model does try to make writing WebForm similar to writing WinForm applications. However the experience is&#8230; quite leaky&#8230; I should say. If you don&#39;t know how to program in web, your application still cannot get smooth user experience, but that doesn&#39;t mean Microsoft should stop support it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1118383">
				<div id="div-comment-1118383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118383">
			April 10, 2014 at 8:21 pm</a>		</div>

		<p>@chenog00: Ever see somebody call MsgBox from a VB ASPX program? We had one developer not be able to figure out why it didn&#39;t work when we deployed it even though it did on his workstation. We went back and checked. He turned on &quot;Allow service to interact with desktop&quot; on IIS on his workstation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1118393">
				<div id="div-comment-1118393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118393">
			April 10, 2014 at 10:20 pm</a>		</div>

		<p>Antonio &#39;Grijan&#39;: I did read the linked article &#8212; I even commented on it. And I still don&#39;t see any part that says how the CS_PARENTDC style causes problems when a paint function is passed a printer&#39;s DC. It&#39;s not like CS_OWNÂ­DC, where you would have been expecting a pre-existing DC that might already have things like brushes selected (that obviously wouldn&#39;t work with a printer&#39;s DC).</p>
<p>As I said, the CS_PARENTDC documentation states that the distinguishing factors about that style are that you get a different window&#39;s clipping rectangle, not that you get a special DC.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1118403">
				<div id="div-comment-1118403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140410-00/?p=1283#comment-1118403">
			April 10, 2014 at 11:33 pm</a>		</div>

		<p>@Joshua: All I could say is &quot;Oops&quot;. :P</p>
<p>Btw, this kind of question happens a lot in MSDN forum alone. There are other variant of it like launching notepad or printing to a selected printer&#8230; Some can be solved and others cannot. Hopefully after encounter this once they&#39;ll understand these are two worlds.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>