<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-835493">
				<div id="div-comment-835493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835493">
			May 28, 2010 at 8:37 am</a>		</div>

		<p>The claim that HKCU supports App Paths key is simply not true (On XP, not sure about Vista/7, but we all know Vista RTM really lacked in the HKCU/COM department) See <a target="_new" href="http://img571.imageshack.us/img571/4649/nocuapppaths.png" rel="nofollow">img571.imageshack.us/&#8230;/nocuapppaths.png</a></p>
<div class="post">[<i>Try reading past the first ten words in the link I provided, sucker. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835503">
				<div id="div-comment-835503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835503">
			May 28, 2010 at 9:34 am</a>		</div>

		<p>Re: Time machine</p>
<p>It wouldn&#39;t help. Most theories limit time travel to the time the machine was invented at the earliest.</p>
<div class="post">[<i>Then they&#39;ll just have to work on a new theory, too! -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-835533">
				<div id="div-comment-835533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835533">
			May 28, 2010 at 10:23 am</a>		</div>

		<p>@Raymond: It is not clear from the Application Registration page that HKCU is 7+ only since the whole &quot;Using the App Paths Subkey&quot; part only talks about 7 and no other versions. Just before that section under &quot;Registering Applications&quot; it talks about XP:SP1 and that App Paths is the preferred location, but it never talks about which HKEY it must be under (And the App Paths key has existed much longer than that (Win95?), and has certainly been the preferred way to modify the per app %path% for way longer than just XP).</p>
<p>The only clear statement about HKEY&#39;s is a comment in the DropTargetVerb sample: &quot;// Windows7 supports per user App Paths, downlevel requires HKLM&quot; (Maybe you could get that added to the MSDN page)</p>
<p>I know the MS focus is mostly on current+next versions, but most of us need to target XP and maybe 2000 for a while longer. The sad part is that HKCU support should have been added when DropTarget was added, not 3 versions later (When I&#39;m done building this time machine, I&#39;ll get right on that)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835573">
				<div id="div-comment-835573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kemp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835573">
			May 28, 2010 at 12:55 pm</a>		</div>

		<p>@WndSks</p>
<p>Quoth the linked article: &quot;To register an application with the App Paths subkey in Windows 7 and later&quot;</p>
<p>Seems pretty clear to me that it&#39;s Windows 7 and later.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-835623">
				<div id="div-comment-835623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835623">
			May 28, 2010 at 2:41 pm</a>		</div>

		<p>‘it turns out that there is an SDK sample that demonstrates the DropTarget technique after all’ &#8211; If it&#39;s any consolation, I liked the OTN article better.</p>
<p>I must say I had to do a double take on the App Paths thing, and I have to thank WndSks for clearing this up. Raymond should have known that it&#39;s probably a good idea to mention any dependency on Windows 6+.</p>
<p>On that note, ExecuteCommand needs Windows 6.1, so most of us can&#39;t use it, something which should have been mentioned in the article.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835513">
				<div id="div-comment-835513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835513">
			May 28, 2010 at 9:52 am</a>		</div>

		<p>Boris: &nbsp;Most theories also preclude the possibility of traveling backward in time, so it *really* wouldn&#39;t help.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-835643">
				<div id="div-comment-835643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835643">
			May 28, 2010 at 5:55 pm</a>		</div>

		<p>AppPath&#8230; CURRENT_USER&#8230; Hmm&#8230; Nice feature&#8230; I wonder if I override a path for a system component with some &quot;custom&quot; stuff silently dropped into temporary files&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-leo-davidson odd alt thread-odd thread-alt depth-1" id="comment-835603">
				<div id="div-comment-835603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Leo+Davidson' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835603">
			May 28, 2010 at 1:32 pm</a>		</div>

		<p>@Kemp, I think WndSks&#39;s point there was that the App Paths subkey is *not* only for Windows 7 and later. (Look on an XP machine and you&#39;ll find loads of App Path entries created before Windows 7 even existed, at least in HKLM.)</p>
<p>When the article says something about &quot;Windows 7 and later&quot; you cannot assume anything about earlier versions. In fact, much of the information applies to them as well.</p>
<p>(I can say, in London people breathe air. You&#39;d be wrong to infer that people do otherwise outside of London. :))</p>
<p>Having said all that, XP not supporting HKCU App Paths (if that&#39;s the case) doesn&#39;t seem like a big deal to me. App Paths registry entries are useful but not essential; per-user installs aren&#39;t something I&#39;m fond of (though there are exceptions); in the rare cases you need that stuff to be per-user there were decent-enough workarounds.</p>
<p>PS: FWIW, the article also has the registry paths wrong at the start of the quoted section. It uses &quot;&#8230;MicrosoftCurrentVersion&#8230;&quot; when the real path is &quot;&#8230;MicrosoftWindowsCurrentVersion&#8230;&quot; (It&#39;s a very common path, though, and it gets it right just below there, so I don&#39;t imagine it&#39;ll cause many people problems).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-835683">
				<div id="div-comment-835683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835683">
			May 28, 2010 at 11:05 pm</a>		</div>

		<p>@Leo Davidson: The App Paths for HKLM is supported on XP. But the question was why it wasn&#39;t also available for HKCU, becuase you need admin priviledges for that part of HKLM, which can trigger a UAC popup.</p>
<p>Raymond&#39;s right &#8211; that link is accuate for Windows 7 and later.</p>
<p>The unspecified behavior, and a problem in the document is it doesn&#39;t describe previous versions of Windows. But as it is, it&#39;s clear in Windows 7, all users use HKLM, current user use HKCU.</p>
<p>In Vista and below, it&#39;s not documented. We know empirically that HKCU does NOT work and HKLM does. But that should be noted &#8211; perhaps by using the &quot;Notify Microsoft&quot; link or adding it as community content.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835713">
				<div id="div-comment-835713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835713">
			May 29, 2010 at 1:36 pm</a>		</div>

		<p>@Alexandre:</p>
<p>AppPath is searched last, so good luck with that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-835753">
				<div id="div-comment-835753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835753">
			May 30, 2010 at 10:50 pm</a>		</div>

		<p>(Totally OT, but can&#39;t resist)</p>
<p>@Leo: Are you sure people in London breathe air, and not smog? :) Although maybe congestion tax has actually solved that problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835763">
				<div id="div-comment-835763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835763">
			May 31, 2010 at 1:33 am</a>		</div>

		<p>[Try reading past the first ten words in the link I provided, sucker. -Raymond]</p>
<p>&quot;Sucker&quot;&#8230;oaw&#8230;.this is the 1st reply of Ray that I see he&#39;s using somehow vulgar word to insult his commenter&#8230;in the past he did it with sarcasm or more subtle irony by providing counter arguments but now was just a vulgar word. Regress.</p>
<p>Who are you and what you did with Ray?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-835793">
				<div id="div-comment-835793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835793">
			May 31, 2010 at 7:28 am</a>		</div>

		<p>@Danny: Some people might say I&#39;m asking for it (And a snarky reply is better than nothing)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835853">
				<div id="div-comment-835853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bahbar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-835853">
			May 31, 2010 at 9:35 am</a>		</div>

		<p>@Danny: It&#39;s the new blog engine style. I like it too! You might feel it&#39;s regression, but this is a blog, for educational purposes only; it&#39;s not corporate communication. I personally think Raymond&#39;s been trying to cater too much to some of his audience. His will to stay &quot;politically correct&quot; has turned at times to what looked like frustration. I&#39;d personally rather have him vent like that!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-836363">
				<div id="div-comment-836363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://arnshea.blogspot.com/' rel='external nofollow' class='url'>arnshea</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-836363">
			June 1, 2010 at 12:42 pm</a>		</div>

		<p>The moral of the story imho is to always keep older versions of MSDN around. &nbsp;No vendor with as many products as Microsoft can maintain every version of the documentation so they naturally tend to disappear off the web over time.</p>
<p>I still keep a copy of Oct 2001 MSDN for just such occasions&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837013">
				<div id="div-comment-837013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random832</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-837013">
			June 3, 2010 at 5:05 am</a>		</div>

		<p>The link is far from clear &#8211; it indicates that there&#39;s something specific to 7, sure, but it could be read as meaning any of: that HKCU is only supported on 7 whereas HKLM is supported on all versions [the correct answer]; that the entire App Paths feature is new in 7; or even that HKLM is only supported on 7 whereas HKCU is supported on all versions. The correct answer is in fact a less obvious interpretation of the text (absent the knowledge of what worked on XP) than either of the other two.</p>
<p>Also, the &quot;Finding an Application Executable&quot; section was not updated mention HKCU at all, which also means it doesn&#39;t say which one is searched first.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837333">
				<div id="div-comment-837333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random832</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100528-01/?p=13883#comment-837333">
			June 4, 2010 at 5:10 am</a>		</div>

		<p>The link is far from clear &#8211; it indicates that there&#39;s something specific to 7, sure, but it could be read as meaning any of: HKCU is only supported on 7 whereas HKLM is supported on all versions [the correct answer]; the entire App Paths feature is new in 7; or HKLM is only supported on 7 whereas HKCU is supported on all versions. The correct answer is in fact a less obvious interpretation of the text (absent the knowledge of what worked on XP) than either of the other two.</p>
<p>Also, the &quot;Finding an Application Executable&quot; section was not updated mention HKCU at all, which also means it doesn&#39;t say which one is searched first.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>