<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1232271">
				<div id="div-comment-1232271" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232271">
			April 4, 2016 at 7:21 am</a>		</div>

		<p>&gt; the application is running 32-bit protected-mode code on a 16-bit stack</p>
<p>The obvious question here is, why would you use a 16-bit stack? So I had a bit of a dig, and found the following quote on the Wikipedia page of one of the major players in the 32-bit DOS extender market:<br />
&gt; The compiler generates 32-bit code, which runs natively in 32-bit protected mode while switching back to 16-bit DOS calls for basic OS support.<br />
Also:<br />
&gt; While [the platform] runs in 32-bit protected mode, its stub and library heavily rely on many 16-bit DOS and BIOS calls.</p>
<p>Just in case anyone else was wondering.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1232283">
				<div id="div-comment-1232283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr√≠guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232283">
			April 4, 2016 at 7:50 am</a>		</div>

		<p>The world of 32-bit DOS extenders was weird. Since the native OS only supported a 16-bit model and it wasn&#8217;t multitasking, the 32-bit developer thought it was free to do as s/he whished, as far as it switched back to 16-bit before calling into DOS. And I suspect most of the hacks involved performance (after all most of its &#8220;clients&#8221; were games of heavy-load applications). Having a single 16-bit stack would avoid moving data back and fort two 16-bit and 32-bit stacks, and would greatly speed calls and interrupts.</p>
<p>Debugging those 32-bit extenders to make them work in Windows 95 must have been everything but fun :-( . I send my condolences, Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1232304">
				<div id="div-comment-1232304" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232304">
			April 4, 2016 at 10:50 am</a>		</div>

		<p>I wish that modern NT had NtSetLdtEntries, so that I could create my own NTVDM for 64-bit Windows.  Maybe the Linux on Windows thing will allow modify_ldt and arch_prctl so that it could be implemented now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-1232313">
				<div id="div-comment-1232313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232313">
			April 4, 2016 at 10:52 am</a>		</div>

		<p>I hate the theme music too.  And &#8220;Speed Racer&#8221; is just a silly name.  who would name their child &#8220;Speed&#8221;?  Especially if your last name was already &#8220;Racer&#8221;?  As a kid, I thought about these things&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1232321">
				<div id="div-comment-1232321" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232321">
			April 4, 2016 at 11:23 am</a>		</div>

		<p>I found it long ago. Whenever you transition from 32 bit back to 16 bit, the 32 bit portions of all registers are preserved in the 32 bit portions of the registers and will be there next time you transition back to 32 bit. Now obviously this is pretty bad and v86 interrupt to protected mode should have protected the bits but I guess Intel never thought a process would move back and forth between v86 mode and 32 bit protected mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1232322">
				<div id="div-comment-1232322" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Bonner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232322">
			April 4, 2016 at 1:02 pm</a>		</div>

		<p>Huh!  I can still remember the details of a bug switching between 16- and 32-bit mode on a Pr1me mini-computer before 19*8*5.  (It was a slightly simpler bug though).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1232332">
				<div id="div-comment-1232332" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">HiTechHiTouch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232332">
			April 4, 2016 at 2:09 pm</a>		</div>

		<p>I don&#8217;t know any of the design players in in Intel 286 &#8220;brain dead&#8221; birth, or the Intel 386 &#8220;32 bits and never look back&#8221; delivery.  </p>
<p>But, as an old math prof of my used to say, &#8220;It is blatantly obvious to the most trivial of observers that&#8230;&#8221; that _Things were Missing_.  Why else did the triple-fault become so important?</p>
<p>{insert link to story about Intel visit to MS asking programmers for 386 suggestions and hearing about the ingenuity required to get the processor out of 32 bit mode.}</p>
<p>{insert link to story about original IBM PC&#8217;s use of A31 line as a mark on the wall} so Intel won&#8217;t feel alone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1232351">
				<div id="div-comment-1232351" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232351">
			April 4, 2016 at 6:49 pm</a>		</div>

		<p>Wait, didn&#8217;t I see this issue somewhere before? *searches around* Yup, the Linux folks also hit the same issue, and their fix was similar. The keyword is &#8220;espfix&#8221; if anyone wants to know more.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1232353">
				<div id="div-comment-1232353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scarlet Manuka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232353">
			April 4, 2016 at 11:27 pm</a>		</div>

		<p>&#8220;espfix&#8221; makes it sound like it&#8217;s those famous psychic powers in play again (I assume Linux devs have them too). :)</p>
<p>I&#8217;m glad I wasn&#8217;t the one who had to work out what was going on. It sounds like it would have been a nightmare to debug. Even with the psychic powers.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1232361">
				<div id="div-comment-1232361" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scarlet Manuka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160404-00/?p=93261#comment-1232361">
			April 4, 2016 at 11:28 pm</a>		</div>

		<p>Also &#8211; I love this series. Can&#8217;t wait for next Monday&#8217;s adventure!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>