<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (25)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-728983">
				<div id="div-comment-728983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-728983">
			April 23, 2009 at 10:40 am</a>		</div>

		<p>So what happens if you set both bits? &nbsp;If there a check for that or would you get both old and new behavior in different areas?</p>
<div class="post">[<i>Why does it matter what happens? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729003">
				<div id="div-comment-729003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrkMatter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729003">
			April 23, 2009 at 11:32 am</a>		</div>

		<p>@John</p>
<p>Try it and see! Though this is the equivalent of asking: &quot;What happens if I swallow a gallon of liquid laundry detergent?&quot; Nobody knows for SURE, but anybody can tell it&#8217;s a bad idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729023">
				<div id="div-comment-729023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729023">
			April 23, 2009 at 12:13 pm</a>		</div>

		<p>It&#8217;s a shame they couldn&#8217;t just create a new flag called PSH_WIZARD2k for the new behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729053">
				<div id="div-comment-729053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729053">
			April 23, 2009 at 12:49 pm</a>		</div>

		<p>It matters because I&#8217;m going to set both bits in all my future applications. &nbsp;I hope the crash dumps find their way to you.</p>
<div class=post>[<i>And people wonder why there&#8217;s so much bad software out there. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729073">
				<div id="div-comment-729073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729073">
			April 23, 2009 at 1:04 pm</a>		</div>

		<p>Maybe there is something I missed, but why was Internet Explorer developped against a WIP comctl32.dll? Even if competitors could have done the same (which I doubt) why hadn&#8217;t the IE team have to live with the consequence (waiting for the linked-against dll to be finished)?</p>
<p>It seems that some lawsuits were well deserved&#8230;</p>
<p>It is sad that it is eventually the shell team that had to pay the price, but I hope somebody took note and won&#8217;t let it happen again.</p>
<p>That being said, as Gabe said, why not manage the problem with a new wizard ID, just like MS had to do for the Wizard95-&gt;Wizard97 evolution? Let the MFC and applications that were so eager to use the bugged version use it and create a new clean version that eventually every toolkit will adapt to. You would have the 95, 97-don&#8217;t-use-kthx and the 2k-ooh-this-one-is-shiny versions available depending on the flag&#8230; Of course MS thought of this and still didn&#8217;t choose to do that&#8230; Come on, Raymond, don&#8217;t leave us hanging there, tell us why!! :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729083">
				<div id="div-comment-729083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729083">
			April 23, 2009 at 1:08 pm</a>		</div>

		<p>Gabe: Well they probably could have, but nobody should be developing against the incomplete buggy version anyway so why should they have? They&#8217;re doing you a favor by not letting you use something that&#8217;s broken.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729093">
				<div id="div-comment-729093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://levicki.net/' rel='external nofollow' class='url'>Igor Levicki</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729093">
			April 23, 2009 at 1:10 pm</a>		</div>

		<p>Raymond, John has a point (sort of).</p>
<p>If you have two separate bits that share the same name for a single feature, then you can pretty much expect that people will set both.</p>
<p>Never mind the warnings on the MSDN page, people will do it &quot;to be on the safe side&quot;.</p>
<p>Heck, they might even hard-code the constant instead of using #defines and the next thing you know there will be yet another compatibility shim to write.</p>
<p>Bonus question:</p>
<p>What happens if you have a library compiled with #define _WIN32_IE 0x0400, an application compiled with #define _WIN32_IE 0x0500, and they need to communicate those flags?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729123">
				<div id="div-comment-729123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729123">
			April 23, 2009 at 2:08 pm</a>		</div>

		<p>Thanks for the info, Raymond. &nbsp;I was wondering what WIZARD97 did, so I poked into the MSDN documentation and found out about the guidelines for developing a wizard. &nbsp;Although I suppose that the MFC CPropertyPage class, etc. can be used in implementing a wizard, it would be nice if there were some built-in windows messages like WM_WIZNEXT and WM_WIZFINISH, and maybe some windows classes that I could use to implement a wizard &quot;old-school&quot; style (i.e. using C instead of MCF/C++).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729133">
				<div id="div-comment-729133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729133">
			April 23, 2009 at 2:13 pm</a>		</div>

		<p>Yeah&#8230;about that messages and windows classes. &nbsp;Nevermind. &nbsp;I spoke too soon.</p>
<p><a href="http://msdn.microsoft.com/en-us/library/bb774544.aspx" target=_new rel=nofollow rel="nofollow">http://msdn.microsoft.com/en-us/library/bb774544.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729173">
				<div id="div-comment-729173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ERock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729173">
			April 23, 2009 at 4:17 pm</a>		</div>

		<p>I propose all bits are changed to trinary to prevent this. Ok, Microsoft, FUND IT. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729203">
				<div id="div-comment-729203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathaniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729203">
			April 23, 2009 at 4:35 pm</a>		</div>

		<p>So&#8230; I didn&#8217;t see an article on this on Slashdot, so either the message is preemptive or my search-fu has gone downhill&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729253">
				<div id="div-comment-729253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729253">
			April 23, 2009 at 6:26 pm</a>		</div>

		<p>By Windows 2000 do you mean IE 5? Because when you are talking about the shell, you seems to sometimes say Win98 when you really mean IE 4, I can tell because I know that the version of the shell shipped with Win98 is the same as the version shipped with the IE 4 desktop update for Win95.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-729293">
				<div id="div-comment-729293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729293">
			April 23, 2009 at 7:48 pm</a>		</div>

		<p>In hindsight, the obvious solution is to put the flag into a private, internal header and not move it to a public header until the feature is ready to ship.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729303">
				<div id="div-comment-729303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729303">
			April 23, 2009 at 10:26 pm</a>		</div>

		<p>No, in hindsight Nawak was right. &nbsp;Either IE4 shouldn&#8217;t have started using the control library until it was finished (properly) or they should have waited for development on it to be complete instead of shipping a half-baked version. &nbsp;If they didn&#8217;t want to wait, then they should have removed the code that used it.</p>
<p>You can&#8217;t ship a product until all of its dependencies are shippable. &nbsp;That&#8217;s just the basic rules.</p>
<div class=post>[<i>IE4 didn&#8217;t use Wizard97. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729313">
				<div id="div-comment-729313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729313">
			April 23, 2009 at 10:28 pm</a>		</div>

		<p>&#8230; and if Wizard97 did end up being considered complete enough to ship, then the followup to it should have been Wizard2000 or Wizard97 v2 (with a version field or API call instead of a flag), so that apps could consciously make the decision about which one they wanted to use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729343">
				<div id="div-comment-729343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729343">
			April 24, 2009 at 1:37 am</a>		</div>

		<p>It&#8217;s all nice to say &#8216;they should have done it better&#8217;, but this sort of stuff just happens, and I think Microsoft dealt with it in a reasonable way.</p>
<p>And about setting both flags: if you use the .h file, and the nicely defined constants, how would you go about setting both. It&#8217;s not gonna happen unless you go out and define your own constants (which is a bad idea anyway).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729373">
				<div id="div-comment-729373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729373">
			April 24, 2009 at 6:24 am</a>		</div>

		<p>How did the IE4 Wizard97 style look like?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729393">
				<div id="div-comment-729393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729393">
			April 24, 2009 at 7:55 am</a>		</div>

		<p>Obviously, since IE didn&#8217;t use Wizard 97, it didn&#8217;t need the flag. In fact, since Wizard 97 wasn&#8217;t ready, no one except the Wizard 97 development team needed the flag and therefore it shouldn&#8217;t have been in any publicly (as in outside of the team) shipped header files. And of course, there&#8217;s something to be said for the &#8220;we didn&#8217;t cause this, not our problem&#8221; approach. Although I imagine that that would be kind of impossible if the problem is in MFC. I thought this was an interesting read, since it was a preventable problem and reading about these things can help prevent similar mistakes in the future.</p>
<div class="post">[<i>The Wizard97 team expected to be finished in time, so they put the flags in the public header file. By the time they realized that they weren&#8217;t going to make it, the header files had already been frozen. I think people don&#8217;t understand how methodical the release process is (and how long it takes). -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729403">
				<div id="div-comment-729403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DysgraphicProgrammer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729403">
			April 24, 2009 at 10:06 am</a>		</div>

		<p>OK, if IE4 didn&#8217;t need it, why not #ifdef out it&#8217;s entire existence? Make the offending functions not callable, and not linkable? Or if you can&#8217;t do that for some DLL compatibility reason make the functions crash the whole program noisily if called. That way if any one tried to use them, they would not get past debugging. &nbsp; </p>
<div class="post">[<i>That&#8217;s a big code change to make just days before RTM. It would almost certainly <a href="http://blogs.msdn.com/release_team/archive/2005/08/26/456610.aspx" rel="nofollow">reset escrow</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729413">
				<div id="div-comment-729413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CGomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729413">
			April 24, 2009 at 11:16 am</a>		</div>

		<p>This is an awesome story about how real world software teams have to deal with concurrent development.</p>
<p>You can&#8217;t have developers sitting on their hands waiting for another part of the team to finish something. &nbsp;And that is a smaller example of what a large software corporation that works on many products has to deal with.</p>
<p>Very good lesson to be learned here. &nbsp;The idiot says, &quot;Just don&#8217;t use something half finished.&quot; &nbsp;The realist nods and recalls a situation where his own team had to use new features that would work for the instant case but might not work in all cases.</p>
<p>This is truly one of the best stories I&#8217;ve ever read on this blog. &nbsp;An instant classic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-729383">
				<div id="div-comment-729383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729383">
			April 24, 2009 at 7:39 am</a>		</div>

		<p>It *wasn&#8217;t* complete enough to ship, but was in the source code for comctl32.dll, including all other changes in prsht.h. This was before Microsoft had a strong branching/merging source control solution for the Windows source code, so work in progress was all in the same tree (this was sorted out for Windows XP). IE4 shipped a new comctl32.dll &#8211; which had always housed the property sheet and wizard code &#8211; with various other new controls and new features, so the half-finished solution was shipped.</p>
<p>The documentation said &#8216;don&#8217;t use it&#8217;, but unfortunately the header didn&#8217;t.</p>
<p>Changing the value of the define is a little dodgy, as a release built with the new SDK will pick up the new flag; a patch release might not get complete coverage testing, although you shouldn&#8217;t change your SDK when building maintenance releases anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729573">
				<div id="div-comment-729573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">katastrofa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729573">
			April 26, 2009 at 12:26 pm</a>		</div>

		<p>Raymond: &quot;The Wizard97 team expected to be finished in time, so they put the flags in the public header file. By the time they realized that they weren&#8217;t going to make it, the header files had already been frozen. I think people don&#8217;t understand how methodical the release process is (and how long it takes).&quot;</p>
<p>Well it isn&#8217;t very methodological if it allows half-finished features to slip through to final &quot;frozen&quot; release.</p>
<p>Oh, and why did Microsoft start to use source control with branching so late?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-729603">
				<div id="div-comment-729603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">old-new-skool</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-729603">
			April 26, 2009 at 9:23 pm</a>		</div>

		<p>very nice tale&#8230; &nbsp;It made me recall my desire to denounce all things C in the late 80&#8217;s/early 90&#8217;s &#8212; not sure why&#8230; &nbsp; :)</p>
<p>c&#8217;mon naysayers&#8230; what OS/Software Suite the size (and mass) of the world have you deployed or written lately, and how did you make it perfect with a Marketing department ultimately pulling the strings? &nbsp;:D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-730043">
				<div id="div-comment-730043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tpasoft.com' rel='external nofollow' class='url'>Kevin Provance</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-730043">
			April 27, 2009 at 10:28 pm</a>		</div>

		<p>But&#8230;time travel is possible.</p>
<p><a href="http://www.chronos.ws" rel="nofollow">http://www.chronos.ws</a></p>
<p>Who do you think I will be working for 20 years from now? &nbsp;&lt;g&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-733443">
				<div id="div-comment-733443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/tims/archive/2009/05/06/a-developer-s-guide-to-preparing-for-windows-7.aspx' rel='external nofollow' class='url'>Tim Sneath</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090423-00/?p=18473#comment-733443">
			May 6, 2009 at 9:13 pm</a>		</div>

		<p>As everyone must know by now, the Windows 7 Release Candidate is broadly released and available for download</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>