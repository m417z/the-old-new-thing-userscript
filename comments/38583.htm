<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (32)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-189893">
				<div id="div-comment-189893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-189893">
			July 2, 2004 at 7:44 am</a>		</div>

		<p>If you put kernel32.dll in application&#8217;s directory, nothing happens &#8211; Windows check &quot;KnownDLLs&quot; registry key and will load it from correct location. I just wonder why not put all &quot;mission critical&quot; DLLs in that list.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189943">
				<div id="div-comment-189943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.schkerke.com' rel='external nofollow' class='url'>Brian Schkerke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-189943">
			July 2, 2004 at 8:20 am</a>		</div>

		<p>I&#8217;d wager that in some cases you&#8217;d want security.dll to be overridable.  If you&#8217;re creating a replacement login system, or&#8230; heck, I don&#8217;t know.</p>
<p>On the bright side we ran into this problem two years ago on one of our first forays into .NET.  I thought it was humorous and obvious at the time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-189983">
				<div id="div-comment-189983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-189983">
			July 2, 2004 at 8:33 am</a>		</div>

		<p>Ah the joys of using filenames. I hope that WinFS come through with some sort of GUID system or something so you know which file is which.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-189993">
				<div id="div-comment-189993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.chadmyers.com' rel='external nofollow' class='url'>Chad Myers</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-189993">
			July 2, 2004 at 8:37 am</a>		</div>

		<p>wow, this is potentially a major vulnerability, right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190043">
				<div id="div-comment-190043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">M Knight</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190043">
			July 2, 2004 at 9:11 am</a>		</div>

		<p>On a side note, this is how Total Annihilation Demo Recorder implements hooking into Total Annihilation&#8217;s network layer to support game recording and other enhanced team play features. Also does the same with DirectDraw to provide a few GUI enhancments.</p>
<p>Implementing a DirectPlay3 proxy in pascal, scary scary stuff.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190073">
				<div id="div-comment-190073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulrich E.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190073">
			July 2, 2004 at 9:31 am</a>		</div>

		<p>The KnownDlls Registry entries can be a source of huge headaches. The fact that these entries override the &#8216;normal&#8217; search order is not very well documented (e.g., the link that Raymond quotes does not mention it). Couple this with programs that mess with these entries and suddenly a program that worked for ages does not work any more or (even worse) behaves different in subtle ways. I remember when the installation of IE 4.01 under Win95 suddenly screwed up an otherwise well-behaved program and it took us days to track down the reason.<br />
<br />(And no, my memory is not that great, this took place about a year ago.)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190093">
				<div id="div-comment-190093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190093">
			July 2, 2004 at 9:42 am</a>		</div>

		<blockquote><p>
  &gt; Ah the joys of using filenames. I hope that WinFS come through with some sort of GUID system or something so you know which file is which. &lt;&lt;</p>
<p>Please tell me you&#8217;re kidding.  Yeah, that&#8217;s what I&#8217;d want, is only one version of zlib.dll sitting around, one version of any library.  That would just be wonderful.  GUIDs work against side by side DLL&#8217;s, which has been shown to be a HUGE help to application developers.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190173">
				<div id="div-comment-190173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://perlmonks.org/?node=theorbtwo' rel='external nofollow' class='url'>James Mastros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190173">
			July 2, 2004 at 11:25 am</a>		</div>

		<p>Not only will it mess things up, but it&#8217;s a pretty clear indication that it&#8217;s a good place to start dissassembling/decompiling/debugging if you want to bypass security checks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190203">
				<div id="div-comment-190203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar Eduardo Barros</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190203">
			July 2, 2004 at 2:29 pm</a>		</div>

		<p>Shouldn&#8217;t it look in the system directories first?</p>
<p>Also, why does it look in the current directory? Can&#8217;t it cause surprising behavior (the application behaves differently depending on where your current directory is)? Not to mention the potential security trouble (some joker putting a dll in a shared directory and waiting for you to run a program while in that directory).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190213">
				<div id="div-comment-190213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190213">
			July 2, 2004 at 2:47 pm</a>		</div>

		<p>Starting in Windows XP SP1, the current directory is searched *after* system directories. This change was made with much trepidation because some very popular programs relied on the old behavior, but security trumps compatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190253">
				<div id="div-comment-190253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/ptorr/archive/2004/06/14/Referral.aspx' rel='external nofollow' class='url'>Peter Torr</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190253">
			July 2, 2004 at 11:13 pm</a>		</div>

		<p>Fudging with SSPI on a client box won&#8217;t help you break into a remote SQL Server&#8230; basic rule of security is that servers should not trust their clients (and vice-versa).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190313">
				<div id="div-comment-190313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mikedimmick.blogspot.com/' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190313">
			July 3, 2004 at 1:57 pm</a>		</div>

		<p>I helped a guy troubleshoot this problem through the CodeProject forums back in March: <a target="_new" href="http://www.codeproject.com/script/comments/forums.asp?msg=805487&amp;forumid=1650#xx805298xx" rel="nofollow">http://www.codeproject.com/script/comments/forums.asp?msg=805487&#038;forumid=1650#xx805298xx</a>.</p>
<p>Basically, whether his website worked depended on whether another site on the same server, with a stray security.dll, loaded first. Ouch.</p>
<p>It would be nice if there was a way of controlling where DLLs load from when using a DllImport directive. The .NET Framework shouldn&#8217;t break because the current directory contains a DLL with the same name as the DLL being imported!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190323">
				<div id="div-comment-190323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190323">
			July 3, 2004 at 2:07 pm</a>		</div>

		<p>But that&#8217;s the whole point of putting a DLL in your EXE&#8217;s directory: To override the system DLL. The &quot;modern&quot; way of accomplishing this is with a manifest.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190403">
				<div id="div-comment-190403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://feldgendler.livejournal.com/' rel='external nofollow' class='url'>Alexey Feldgendler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190403">
			July 4, 2004 at 11:38 am</a>		</div>

		<p>Oops, a security hole. Even if you can&#8217;t modify the files in the, say, Program files directory, you can put a DLL named after some system library into, for example, the Microsoft Office directory, then just wait until the administrator runs Word, and your code is run with admin privileges!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190413">
				<div id="div-comment-190413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190413">
			July 4, 2004 at 11:57 am</a>		</div>

		<p>And how do you get write permission into the Microsoft Office directory?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190483">
				<div id="div-comment-190483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190483">
			July 4, 2004 at 11:13 pm</a>		</div>

		<p>If you look at the documentation for LoadLibrary, you will see that the application directory does take precedence over all other directories, as you suggested.</p>
<p>The programs in question did</p>
<p>SetCurrentDirectory(&quot;somewhere&quot;);<br />
<br />LoadLibrary(&quot;somelibrary.dll&quot;);</p>
<p>and expected somelibrary.dll to be loaded from the &quot;somewhere&quot; directory, overriding the matching library in the system32 directory. Perhaps you find it hard to believe, but it&#8217;s true nonetheless. I remember one meeting where this was the primary topic on the agenda.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190453">
				<div id="div-comment-190453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190453">
			July 4, 2004 at 8:33 pm</a>		</div>

		<p>7/2/2004 2:47 PM Raymond Chen</p>
<p>&gt; Starting in Windows XP SP1, the current<br />
<br />&gt; directory is searched *after* system<br />
<br />&gt; directories. This change was made with much<br />
<br />&gt; trepidation because some very popular<br />
<br />&gt; programs relied on the old behavior, but<br />
<br />&gt; security trumps compatibility. </p>
<p>This is rather hard to believe.  Surely popular programs rely on loading DLLs that are located in the same directory where the EXE is located.  The old behavior only happened to work for them usually, because the current directory is the same directory where the EXE is located usually.</p>
<p>If the rule were changed to give priority to the directory where the EXE is located (or more precisely, the directory where the invoker is located, since the invoker might also be a DLL and might have been loaded by its own full path), then surely this would obtain security plus 99% backward compatibility?</p>
<p>As for whether the current directory is included at all, maybe there should be an option to enable it last (after the invoker&#8217;s directory and system directories) because maybe some abnormal people such as developers might need it for some reason.  Otherwise, maybe security should trump the other 1% of backwards compatibility and the current directory shouldn&#8217;t even be searched.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190603">
				<div id="div-comment-190603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190603">
			July 5, 2004 at 10:08 am</a>		</div>

		<p>&quot;And how do you get write permission into the Microsoft Office directory? &quot;</p>
<p>&#8216;cos you&#8217;re a Power User?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190623">
				<div id="div-comment-190623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190623">
			July 5, 2004 at 10:35 am</a>		</div>

		<p>If you&#8217;re a Power User there are even easier ways to attack the administrator account than this roundabout DLL thingie. For example, just change the default handler for DOC files to be your hackorama.exe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190763">
				<div id="div-comment-190763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190763">
			July 5, 2004 at 6:17 pm</a>		</div>

		<p>7/4/2004 11:13 PM Raymond Chen</p>
<p>&gt; The programs in question did<br />
<br />&gt; SetCurrentDirectory(&quot;somewhere&quot;);<br />
<br />&gt; LoadLibrary(&quot;somelibrary.dll&quot;);<br />
<br />[&#8230;]<br />
<br />&gt; Perhaps you find it hard to believe</p>
<p>No, that example does make it believable.  I can half-imagine a program doing this in order to invoke some other program, maybe another program included in some suite, or maybe invoking a plug-in.</p>
<p>Since backward compatibility is being broken in a documented manner, it might still be better to drop the current directory entirely from the search path.  Old programs don&#8217;t only get broken immediately by this change, some will break in the future when other random DLLs in the system32 directory get added or renamed.  And changes to the contents of the  system32 directory might happen not only from future Windows changes, but from installing or changing other random applications.  It would be better for programmers to find out now that their use of the current directory is no longer reliable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190793">
				<div id="div-comment-190793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-190793">
			July 5, 2004 at 9:49 pm</a>		</div>

		<p>It&#8217;s a balancing act. It seems, Norman, that your approach is to say that &quot;All the thousands of programs that do this (some of them EXTREMELY popular) are hereby declared broken. If your company was relying on one of these programs, then you&#8217;re screwed.&quot; That&#8217;s great for security but doesn&#8217;t make you many friends among your 100 million customers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191153">
				<div id="div-comment-191153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar Eduardo Barros</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191153">
			July 6, 2004 at 11:30 am</a>		</div>

		<p>Raymond, they wouldn&#8217;t be declared broken, they would be declared incompatible with the newer version of the operating system. The customers can still keep using the older version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191183">
				<div id="div-comment-191183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191183">
			July 6, 2004 at 11:55 am</a>		</div>

		<p>So customers who were using these programs would stay with the original version of XP instead of upgrading to SP1? They would miss out on all the security fixes then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191253">
				<div id="div-comment-191253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Petr Prazak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191253">
			July 6, 2004 at 1:20 pm</a>		</div>

		<p>Funny things also happen when you place an executable file name winlogon.exe into a directory and set the directory in the PATH env. variable to be searched first.</p>
<p>You will get a mysterious bootup blue screen without any apparent reason. Happened to me once  I set up a new computer. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191363">
				<div id="div-comment-191363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191363">
			July 6, 2004 at 5:28 pm</a>		</div>

		<p>7/6/2004 11:30 AM Cesar Eduardo Barros<br />
<br />&gt; Raymond, they wouldn&#8217;t be declared broken,<br />
<br />&gt; they would be declared incompatible with the<br />
<br />&gt; newer version of the operating system.</p>
<p>Bingo, thank you for explaining it.</p>
<p>7/5/2004 9:49 PM Raymond Chen<br />
<br />&gt; but doesn&#8217;t make you many friends among your<br />
<br />&gt; 100 million customers. </p>
<p>That has never been a concern of Microsoft.  Each version of Windows is already broken in so many ways by itself, things like this are trivial by comparison.  Document the change, conform to the document, and you&#8217;ll be a lot farther towards friendship than your company&#8217;s past and present practices.</p>
<p>7/6/2004 11:55 AM Raymond Chen<br />
<br />&gt; So customers who were using these programs<br />
<br />&gt; would stay with the original version of XP<br />
<br />&gt; instead of upgrading to SP1? They would miss<br />
<br />&gt; out on all the security fixes then.</p>
<p>More or less the same as customers who miss out on security fixes for six months, being the interval between discoveries of flaws and patches being available on Windows Update.  Fortunately the patches on Windows Update tend to add fewer new bugs than SPs do, while usually finally providing the security improvements that they&#8217;re intended for.</p>
<p>It must be admitted that Windows XP SP1a didn&#8217;t add many new bugs, it just left most of Windows XP&#8217;s existing bugs unchanged.  But how did Windows XP Explorer get to be so much buggier than Windows 2000 Explorer?  How did Windows XP&#8217;s USB floppy disk driver get to cause blue screens when Windows 2000&#8217;s didn&#8217;t?  How did Windows 2000&#8217;s video drivers get to cause blue screens when Windows NT4&#8217;s and 98&#8217;s didn&#8217;t?  How did Windows 98 Second Edition fdisk get to be broken after Windows 98 First Edition fdisk could reliably create partitions (though even that one wasn&#8217;t safe for use in deleting partitions)?  For some of these items, Microsoft posted knowledge base articles saying that fixes were developed but not available for download, and Microsoft won&#8217;t even listen to requests for these fixes unless victims pay for submitting requests.  To repeat, friendship with 100 million Microsoft victims has never been a concern of Microsoft.</p>
<p>Meanwhile, you have an opportunity to make a security improvement.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191463">
				<div id="div-comment-191463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191463">
			July 6, 2004 at 10:16 pm</a>		</div>

		<p>? Now I&#8217;m confused. Then why were you recommending that we break those programs?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191373">
				<div id="div-comment-191373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191373">
			July 6, 2004 at 5:36 pm</a>		</div>

		<p>Norman, I understand your frustration with the USB floppy disk driver and fdisk, but complaining to me gets you nowhere. I have no influence over those things.</p>
<p>I guess I didn&#8217;t emphasize enough how critical some of the affected programs are. We&#8217;re talking about progams on the scale of Photoshop and Microsoft Office. (Note: Those are *NOT* the affected programs. I&#8217;m just trying to give a sense of scope.) If any update broke Photoshop people would be screaming bloody murder.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191443">
				<div id="div-comment-191443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191443">
			July 6, 2004 at 9:42 pm</a>		</div>

		<p>7/6/2004 5:36 PM Raymond Chen</p>
<p>&gt; We&#8217;re talking about progams on the scale of<br />
<br />&gt; Photoshop and Microsoft Office. (Note: Those<br />
<br />&gt; are *NOT* the affected programs.</p>
<p>Sometimes they are.  That&#8217;s exactly what Windows NT4 SP4 did, it was only half-fixed in SP5, and it remains broken in Windows 2000 (except for the US version) and Windows 2003 (including the US version).  I guess Microsoft really is unaware that sometimes newly added bugs have such critical effects.</p>
<p>&gt; If any update broke Photoshop people would<br />
<br />&gt; be screaming bloody murder.</p>
<p>Yup, some of us have very good reasons for screaming bloody murder.  Thank you for your understanding.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191803">
				<div id="div-comment-191803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191803">
			July 7, 2004 at 11:43 am</a>		</div>

		<blockquote><p>
  If you&#8217;re a Power User there are even easier ways to attack the administrator account than this roundabout DLL thingie. For example, just change the default handler for DOC files to be your hackorama.exe. </p>
<p>I&#8217;d rather have something subtle (something that won&#8217;t show up in Task Manager, at least) and resilient (something that doesn&#8217;t depend on a program being opened in a particular way).</p>
<p>=================</p>
<p>I think in the medium-to-long term programs would be broken by service packs less often if the OS stopped bending over backwards to make programs relying on undocumented and/or broken behaviour keep on working.  If they can&#8217;t be broken, the shim approach (used by appcompat or the bigger brother) is the one to use; make kernel32.dll (or whatever) do the <em>right</em> thing (and reject any and all invalid data/undocumented features/etc.) and then provide a shim to provide the legacy behaviour.</p>
<p>It&#8217;ll probably mean a lot of shims (as all the workarounds in Win32 get moved out into libraries), but it&#8217;ll greatly improve the visibility of broken code.<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191893">
				<div id="div-comment-191893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191893">
			July 7, 2004 at 7:18 pm</a>		</div>

		<p>7/6/2004 10:16 PM Raymond Chen<br />
<br />&gt; ? Now I&#8217;m confused. Then why were you<br />
<br />&gt; recommending that we break those programs?</p>
<p>Microsoft already broke Office 97 for no reason at all (in days when it was supposedly supported i.e. NT4SP4-5-6, along with later days i.e. W2000 except US and W2003 including US).  Microsoft did not care about making friends or avoiding screams of bloody murder.  Microsoft did not and does not care enough to fix these things, and usually no one else has the power to do so.</p>
<p>But when there is a reason, i.e. security, for doing something that might cause comparable breakage, then Microsoft suddenly pretends to care about making friends and avoiding screams of bloody murder.  Some additional breakage is avoided, while the original breakage remains and security is not obtained.  This backwards attitude does not really buy friends and does not reduce the reasons for crying bloody murder.</p>
<p>When a change is documented (and documented correctly) developers usually do have the power to cope with it.  Maybe even the support web site for Photoshop would announce a workaround for old versions, i.e. copy such and such DLL from so and so directory to the system32 or system directory.</p>
<p>By the way, everyone knows that Mr. Chen has no control over drivers and fdisk and many apps.  Most screams of bloody murder concern Microsoft not Mr. Chen personally.  But Mr. Chen personally says that people should not blame Microsoft for problems like broken drivers and broken applications.  Therefore I point out the seriousness of broken Microsoft drivers and broken Microsoft apps and the refusal of fixes for them, and we are correct to blame Microsoft.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191993">
				<div id="div-comment-191993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-191993">
			July 7, 2004 at 11:36 pm</a>		</div>

		<p>Go ahead and blame Microsoft for its own broken drivers and broken applications. Bear in mind however that complaining to me won&#8217;t accomplish much, though perhaps it may make you feel better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192783">
				<div id="div-comment-192783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Florian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040702-00/?p=38583#comment-192783">
			July 9, 2004 at 6:26 am</a>		</div>

		<p>Norman, you say &quot;That has never been a concern of Microsoft&quot;. I remember you having read this weblog for a while now just as I have. And somehow I got quite the opposite impression from Raymond&#8217;s postings.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>