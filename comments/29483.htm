<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (34)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-426883">
				<div id="div-comment-426883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://forbidden-planet.blogspot.com' rel='external nofollow' class='url'>richard</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426883">
			October 3, 2006 at 10:12 am</a>		</div>

		<p>Sounds like you wouldn&#8217;t make it as a scientist. I find scientists are unwilling to believe anything unless it is backed up with hard data that has been published in a respected peer reviewed journal and subsequently reproduced.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426903">
				<div id="div-comment-426903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426903">
			October 3, 2006 at 10:28 am</a>		</div>

		<p>In science it is most important that a claim is falsifiable (<a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Falsifiability" rel="nofollow">http://en.wikipedia.org/wiki/Falsifiability</a>).</p>
<p>And the nice thing with the falsificability is that it leaves the job to prove you wrong to the person who don&#8217;t believe your result.</p>
<p>So, instead of asking Raymond for hard data you should get them yourself to try to falsify his claim that fast-mode is quicker then slow-mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-426923">
				<div id="div-comment-426923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426923">
			October 3, 2006 at 10:57 am</a>		</div>

		<p>Good analogy. &nbsp;Reminds me of something Richard Feynman said about the value of science:</p>
<p>&quot;But we always must make statements about the regions that we have not seen, or the whole business is no use.&quot;</p>
<p>Full quote here:</p>
<p><a rel="nofollow" target="_new" href="http://www.collectedthoughts.com/quote.aspx?id=11306" rel="nofollow">http://www.collectedthoughts.com/quote.aspx?id=11306</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426943">
				<div id="div-comment-426943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426943">
			October 3, 2006 at 11:30 am</a>		</div>

		<p>andy:</p>
<p>That&#8217;s rediculous, and lazy.</p>
<p>Raymond hasn&#8217;t done a peer-reviewed set of experiments providing hard numbers.</p>
<p>He has done a back-of-the-envelope calculation.</p>
<p>If he wants people to belive his numbers, he should back them up somehow.</p>
<p>If you want engineers to believe you, provide numbers. &nbsp;Real numbers.</p>
<p>Posting a patch to the linux-kernel list and saying &quot;I predict this increases performance 200 times&quot; without providing benchmark results will get you laughed out of there. &nbsp;For good reason.</p>
<p>The important thing in science is being able to reproduce someone else&#8217;s results. &nbsp;You can&#8217;t reproduce (or prove wrong) someone&#8217;s &quot;results&quot; if they haven&#8217;t produced any in the first place.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-426953">
				<div id="div-comment-426953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426953">
			October 3, 2006 at 11:34 am</a>		</div>

		<p>&quot;In theory grabbing all the letters at once is faster, but without actual measured results how do you know there&#8217;s any real-world benefit?&quot;&#8211;</p>
<p>&#8211;a variation on the joke where a mathematician starts to present a proof of a new theorem, when a mathematician in the audience calls out, &quot;I have a counterexample!&quot; &quot;That&#8217;s OK,&quot; says the first mathematician, &quot;I have another proof.&quot;</p>
<p>Or, you say to a scientist (or engineer, apparently), &quot;Your argument contains a fallacy; your conclusion doesn&#8217;t follow from your assumptions.&quot; &quot;Well,&quot; he replies, &quot;I&#8217;ll have to see some hard data to support your claim.&quot; (Or, alternatively, &quot;I&#8217;ll have to see some real-world, actual measured results to support your claim.&quot;)</p>
<p>To the man with a hammer, everything looks like a nail, and similarly for the man with &quot;hard data that has been published in a respected peer reviewed journal and subsequently reproduced&quot; or &quot;actual measured results.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426963">
				<div id="div-comment-426963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Euro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426963">
			October 3, 2006 at 11:59 am</a>		</div>

		<p>Actually, he would make a great engineer. Engineering requires great skills at knowing what&#8217;s worth measuring and what&#8217;s not. That&#8217;s why an engineer doesn&#8217;t usually commission a finite-element analysis to verify that a two story house will hold up. That&#8217;s why an engineer will not usually calculate torsion stresses on an ordinary beam, unless s/he has a reason to believe it might an issue.</p>
<p>Remember the adage about an engineer being the guy who can do for $50 what any fool can do for $1000? Well, measuring costs money.</p>
<p>(Graduated as a Civil Engineer abroad, not a licensed Civil Engineer anywhere in the US, so this is not advice: always consult your personal Civil Engineer)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-426973">
				<div id="div-comment-426973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426973">
			October 3, 2006 at 12:13 pm</a>		</div>

		<p>The profound thoughts above notwithstanding, some optimizations simply dominate previous behavior.</p>
<p>One cannot prove this, but it /is/&#8230; in the same sense that Mt. Everest /is/, or that Alma Cogan /isn&#8217;t/.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426983">
				<div id="div-comment-426983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ajb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426983">
			October 3, 2006 at 12:38 pm</a>		</div>

		<p>Vince-</p>
<p>There is a difference between saying &#8216;I predict this will increase performance 200 times&#8217; and saying:</p>
<p>This will reduces the number of client-server roundtrips by 1 per file in the folder. &nbsp;If a roundtrip costs, for example, 1.5 seconds, a 200 file lookup will be only a few seconds instead of 5 minutes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-426993">
				<div id="div-comment-426993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426993">
			October 3, 2006 at 12:38 pm</a>		</div>

		<p>&lt;&lt;try to falsify his claim that fast-mode is quicker then slow-mode&gt;&gt;</p>
<p>No need to.</p>
<p>The fast-X is quicker than slow-X, by definition :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427013">
				<div id="div-comment-427013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427013">
			October 3, 2006 at 3:11 pm</a>		</div>

		<p>You guys are tense.. this is a blog, someone talking about stuff he loves to interact with other people. &nbsp;Blogs practically at the level of a water fountain conversations, if water fountains came with a blackboard to scribble some stuff on.</p>
<p>If this were a published book you paid for, no doubt there would be some extra time and verifications, on top of the already existing one. &nbsp;From my personnal experience, I figure Raymond can probably spend more than an hour verifing a post &nbsp;(and just imagine how many people will put him back in his place if he gets details wrong!) &nbsp;Deeper testing would probably test several days. &nbsp;</p>
<p>I&#8217;ve been maintaining a file browser that&#8217;s using IShellFolder, which had several iteration based on clients complain about its network speeds, and I&#8217;m interested in the topic. &nbsp;We have had these problems.</p>
<p>imho the topic is about the general idea behind it, and not about a specific quoted number of speedup time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-426893">
				<div id="div-comment-426893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-426893">
			October 3, 2006 at 10:21 am</a>		</div>

		<p>Actually, you wouldn&#8217;t make a good engineer.</p>
<p>Scientists (including Computer Scientists) are very good at &#8220;proving&#8221; optimal solutions that turn out to be unworkable in practice.</p>
<p>As engineers the reason we want to see &nbsp;*actual measured results* is because then you know for sure.</p>
<p>See:</p>
<p><a href="http://www.gettysfamily.org/wordpress/?p=26" target=_new rel=nofollow mce_href="http://www.gettysfamily.org/wordpress/?p=26" rel="nofollow">http://www.gettysfamily.org/wordpress/?p=26</a></p>
<p>Also, there are a lot of times that making something 200 times faster in theory has absolutely no real-world benefit. &nbsp;Using a quick-sort instead of a bubble sort on a 10 item list. &nbsp;Giving your CPU a 200 item issue queue. &nbsp;Things like that.</p>
<div class=post>[<i>Naturally, the results were verified afterwards to confirm that the predicted optimization actually helped, but I don&#8217;t have that data. (Because, surprise, <a href="http://blogs.msdn.com/oldnewthing/archive/2006/07/13/664448.aspx" rel="nofollow">people don&#8217;t send me copies of every performance test run anywhere at Microsoft</a>.) But you shouldn&#8217;t need that hard data to realize that the change was worth trying. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427023">
				<div id="div-comment-427023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427023">
			October 3, 2006 at 5:40 pm</a>		</div>

		<p>Vince: &nbsp;It&#8217;s &quot;ridiculous&quot;, not &quot;rediculous&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427033">
				<div id="div-comment-427033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Not Raymond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427033">
			October 3, 2006 at 8:07 pm</a>		</div>

		<p>If I were Raymond you guys would make me quit posting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427063">
				<div id="div-comment-427063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427063">
			October 3, 2006 at 9:24 pm</a>		</div>

		<p>Tuesday, October 03, 2006 3:11 PM by Ulric</p>
<blockquote><p>
  Blogs practically at the level of a water</p>
<p>  fountain conversations
</p></blockquote>
<p>I agree. &nbsp;That&#8217;s why agreements and disagreements get into the comments, and that&#8217;s why conversations fragment along several tangents.</p>
<p>Also consider if a water fountain conversation had one speaker and multiple listeners. &nbsp;Of course some kinds of announcements are designed to operate that way, but they&#8217;re still a lot less popular than typical water fountain conversations.</p>
<p>Oops sorry, this tangent went on longer than expected. &nbsp;I could prove this assertion but don&#8217;t have an envelope at the moment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427113">
				<div id="div-comment-427113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andres</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427113">
			October 4, 2006 at 12:04 am</a>		</div>

		<blockquote><p>
  And you&#8217;re a civil engineer? &nbsp;remind me not to drive across any bridge you design.
</p></blockquote>
<p>Then I suggest you don&#8217;t drive across ANY brigde, because that&#8217;s how they are designed. A bunch of &quot;people who know about bridges&quot; sit for a while doing math, until they are convinced that the bridge will hold.</p>
<p>Of course, the &quot;hard-data approach&quot; may seem better, but it&#8217;s just too expensive&#8230; before I can say how much weight my briedge is goint to hold, I have to spend millions of dollars to build one and start putting weight on it until it breaks. Then I&#8217;ll have &quot;hard data&quot; of what the briedge can hold. Except that maybe I was lucky, so I really need to build 100 briedges, and then see if they all hold the same weight. Only then I can build the briedge I actually wanted to build.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427133">
				<div id="div-comment-427133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">N. Velope</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427133">
			October 4, 2006 at 3:18 am</a>		</div>

		<p>&nbsp; This would be a good time to remind everyone to read the chapter &quot;The Back of the Envelope&quot; in &quot;Programming Pearls&quot; by Jon Bentley. &nbsp;It actually talks about building bridges and programming.</p>
<p><a rel="nofollow" target="_new" href="http://www.cs.bell-labs.com/cm/cs/pearls/bote.html" rel="nofollow">http://www.cs.bell-labs.com/cm/cs/pearls/bote.html</a></p>
<p>and</p>
<p><a rel="nofollow" target="_new" href="http://www.cs.bell-labs.com/cm/cs/pearls/quiz.html" rel="nofollow">http://www.cs.bell-labs.com/cm/cs/pearls/quiz.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427143">
				<div id="div-comment-427143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mattryall.net' rel='external nofollow' class='url'>Matt Ryall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427143">
			October 4, 2006 at 3:36 am</a>		</div>

		<p>The problem is that in general by enhancing performance we degrade some other aspect of the software, typically maintainability.</p>
<p>Degrading maintainability will have a longer-term impact on the speed and performance of the application, so it&#8217;s important to analyse the improvement in short-term performance before making this sacrifice.</p>
<p>That&#8217;s the reason behind the oft-heard, &quot;premature optimisation is the root of all evil&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427153">
				<div id="div-comment-427153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Slombo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427153">
			October 4, 2006 at 4:04 am</a>		</div>

		<p>&quot;The problem is that in general by enhancing performance we degrade some other aspect of the software, typically maintainability.&quot;</p>
<p>While I&#8217;ve not seen the code here, it would appear to me that this optimisation is both obviously faster and (presumably) more readable/maintainable.</p>
<p>How is GetAllFiles() harder than While(FilesExist);GetNextFile();loop</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427073">
				<div id="div-comment-427073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427073">
			October 3, 2006 at 9:53 pm</a>		</div>

		<p>&gt; Actually, he would make a great engineer. </p>
<p>&gt; Engineering requires great skills at knowing what&#8217;s </p>
<p>&gt; worth measuring and what&#8217;s not. That&#8217;s why an </p>
<p>&gt; engineer doesn&#8217;t usually commission a finite-element </p>
<p>&gt; analysis to verify that a two story house will hold &gt; up. That&#8217;s why an engineer will not usually </p>
<p>&gt; calculate torsion stresses on an ordinary beam, </p>
<p>&gt; unless s/he has a reason to believe it might an </p>
<p>&gt; issue.</p>
<p>And you&#8217;re a civil engineer? &nbsp;remind me not to drive across any bridge you design.</p>
<p>People making decisions because of back-of-the-envelope calculations and not actually testing things give us things like the ceiling of the Big Dig collapsing.</p>
<p>The whole issue, if you go back to the original blog entry, was the the &quot;200 times speedup&quot; given was calculated from a really contrived scenario. &nbsp;Some of us were like &quot;nice theory, but we&#8217;d like to see some actual numbers before believing that&#8217;s the real world results&quot;.</p>
<p>From experience I&#8217;ve seen many times people claim that you&#8217;ll get big improvements doing something a different way, only for it to turn out to be the same, or even *worse*. &nbsp;</p>
<p>Estimating, back-of-the-enveloping, and brainstorming are great, and good for a discussiom. &nbsp;They are never a substitute for actual implementation and testing. &nbsp;And some of us prefer our software to actually run faster in real life, not just on the back of some envelope.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427123">
				<div id="div-comment-427123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://codeka.com/blogs' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427123">
			October 4, 2006 at 1:20 am</a>		</div>

		<p>&gt; The whole issue, if you go back to the original blog entry, was the the &quot;200 times speedup&quot; given was</p>
<p>&gt; calculated from a really contrived scenario. &nbsp;Some of us were like &quot;nice theory, but we&#8217;d like to see</p>
<p>&gt; some actual numbers before believing that&#8217;s the real world results&quot;.</p>
<p>Why would you need that? It&#8217;s trivial to see. If you have to do 201 requests in the &quot;slow&quot; way and only 1 in the &quot;fast&quot; way, then it&#8217;s *by definition* 200x faster. Each individual request takes approximately the same amount of time (that&#8217;s what great about networks &#8211; a 1KB request takes about the same time as a 100KB request).</p>
<p>I can&#8217;t believe anyone would need &quot;hard data&quot; to be able to see that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427183">
				<div id="div-comment-427183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427183">
			October 4, 2006 at 8:52 am</a>		</div>

		<p>In the examples, replace letters with 15kg packages which slow down your movement quite a bit.</p>
<p>Soon fetching all of them at once is not the faster way.</p>
<p>This is probably a very trivial optimization, but it&#8217;s easy to think something will bring benefits when it actually does not or (worse) it does effectively slow down for some other interaction.</p>
<p>That said, a (absurd) network connection with 1ms latency, 1kbit/sec bandwidth and 50% error rate (and a 1MB MTU and no hardware error check) will probably kill you in fast mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427233">
				<div id="div-comment-427233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kuwanger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427233">
			October 4, 2006 at 11:14 am</a>		</div>

		<p>&quot;While I&#8217;ve not seen the code here, it would appear to me that this optimisation is both obviously faster and (presumably) more readable/maintainable.</p>
<p>How is GetAllFiles() harder than While(FilesExist);GetNextFile();loop&quot;</p>
<p>While it might not be harder directly, things like caching, swapping, and a slow read medium might make getting a listing of more files than actually necessary can be detrimental, both in performance and in management. &nbsp;So, when one is searching for a specific file in a directory on a remote server, it&#8217;s not necessarily clear that the slow method is actually slower. &nbsp;And it can actually be harder, if one allocates and deallocates a large memory chunk repeatedly (which might actually be proper design) for a whole file listing when a few reads and a simple loop would have done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427323">
				<div id="div-comment-427323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jade Philosopher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427323">
			October 4, 2006 at 1:48 pm</a>		</div>

		<p>The general thrust of the anti-envelope comments remind me of a Feynman observation about results presented at a gravity conference &#8211; they were either obviously wrong or convoluted demonstrations of obvious truths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-427453">
				<div id="div-comment-427453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427453">
			October 4, 2006 at 7:30 pm</a>		</div>

		<blockquote><p>
  While it might not be harder directly, things like caching, swapping, and a slow</p>
<p>  read medium might make getting a listing of more files than actually necessary can</p>
<p>  be detrimental, both in performance and in management.
</p></blockquote>
<p>So what? We&#8217;re not trying to speed up getting only partial directory listings here. We&#8217;re speeding up the SPECIFIC case of Explorer listing a folder&#8217;s contents. The ENTIRE folder&#8217;s contents. If you only want one file, the &quot;slow&quot; method is still there.</p>
<p>I think Jade Philosopher is right. Either that, or people only read half-way before commenting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427663">
				<div id="div-comment-427663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/sw/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427663">
			October 5, 2006 at 11:02 am</a>		</div>

		<p>Dean: alternatively, Explorer could optimise by working out that it will be displaying, say, nine items, and fetching only those nine. (Depending on sort order and what information is needed for the status bar, obviously.)</p>
<p>Just opening my i386 directory on a network server takes around 12 seconds to enumerate the 5,941 objects within &#8211; and it only has to display the first 12, the rest are out of sight! (Come to think of it, displaying the first 12 straight away then fetching the rest asynchronously would be nice too&#8230;)</p>
<div class="post">[<i>So you&#8217;re saying that Explorer should not sort the results? How else can it tell which are the &#8220;first 12&#8221;? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427773">
				<div id="div-comment-427773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">swe dude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427773">
			October 5, 2006 at 12:15 pm</a>		</div>

		<p>&gt; [So you&#8217;re saying that Explorer should not sort the results? How else can it tell which are the &#8220;first 12&#8221;? -Raymond]</p>
<p>Why cannot the server return the first 12 first?</p>
<p>If that&#8217;s not possible, it would at least be possible for explorer to show the first 12 returned files and later insert other files into the shown result if required.</p>
<div class="post">[<i>What is the definition of &#8220;first&#8221;? Alphabetical order? (Sorted <a href="http://blogs.msdn.com/oldnewthing/archive/2005/06/17/430194.aspx" mce_href="http://blogs.msdn.com/oldnewthing/archive/2005/06/17/430194.aspx" rel="nofollow">according to which language</a>?) Order of creation? By song length? Alphabetical by author? <a href="http://blogs.msdn.com/oldnewthing/archive/2005/07/21/441330.aspx" mce_href="http://blogs.msdn.com/oldnewthing/archive/2005/07/21/441330.aspx" rel="nofollow">FindFirstFile is not a SQL query</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427973">
				<div id="div-comment-427973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-427973">
			October 5, 2006 at 2:56 pm</a>		</div>

		<p>Seems to me that some people don&#8217;t understand the difference between a reasonable estimate and a wild guess. &nbsp;And those people feel that they know what makes a good engineer. &nbsp;That&#8217;s rather ironic.</p>
<p>On the other hand, the concept of &quot;falsifiability&quot; in science has been grossly misinterpreted here as removing the burden of proof from the one making a claim. &nbsp;Falsifiability means that a hypothesis *can* be disproven, and a claim is unscientific if it is not falsifiable. &nbsp;It certainly does not mean that a claim is scientifically *true* unless *disproven*!</p>
<p>Software has strong roots in both the science and engineering fields. &nbsp;I think what we&#8217;re seeing in here is a bizarre argument between two groups who are firmly on their own side of the fence and perhaps don&#8217;t realize that the other side even exists.</p>
<p>I&#8217;m pretty sure that Raymond has a good grasp of both sides. &nbsp;The fact is, he&#8217;s neither proposing a scientific theory nor building a bridge. &nbsp;It&#8217;s not necessary to have reams of hard data as long as the logic is sound (which it is) and the estimate is reasonable (which it is).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428273">
				<div id="div-comment-428273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/sw/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-428273">
			October 6, 2006 at 8:08 am</a>		</div>

		<p>&#8220;So you&#8217;re saying that Explorer should not sort the results? How else can it tell which are the &#8220;first 12&#8243;? -Raymond&#8221;</p>
<p>In the Explorer window I just opened, there are four sort order options: Name, Size, Type and Modified. Since none is ticked, no order has been specified; the first 12 returned by the server would fulfil this requirement as well as anything else. Getting any 12 straight away while the other few thousand get retrieved beats an animated flashlight and nothing else until it&#8217;s possible to apply an unspecified and unsolicited order, IMO! (If/when I actually ask for the results to be sorted in some order, that&#8217;s different &#8211; but I haven&#8217;t.)</p>
<p>In this case, the meaning of &#8216;first&#8217; is as obvious as in &#8216;findfirstfile&#8217;: the first one returned, whatever the source order might happen to be. Apart from anything else, it&#8217;s the only meaning which works; to query it is like asking which timezone someone is asking about when they ask what time it is&#8230;</p>
<div class=post>[<i>I think if you look more closely, your &#8220;unsorted&#8221; view is still sorted. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-428493">
				<div id="div-comment-428493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-428493">
			October 6, 2006 at 2:38 pm</a>		</div>

		<p>Couldn&#8217;t you ask the server for all the names (but not the handles) in large chunks, sort the names, then go back and get the handles for the first 15 files synchronously, then display the first 15 files, and only *then* go back and get the rest of the handles asynchronously?</p>
<p>(Now this won&#8217;t work if the redirector&#8217;s implementation of NtQueryDirectoryFile doesn&#8217;t return all the possible attributes that the folder may be sorted by. &nbsp;However, FindFirstFile&#8217;s return structure has members for both size and the various dates, so it should be possible to get that data the first time through.)</p>
<p>And certainly the &quot;fast mode&quot; would still be faster than this. &nbsp;But at least this would alleviate some of the problems with slow mode, because the slowness would be happening in the background.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428623">
				<div id="div-comment-428623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-428623">
			October 7, 2006 at 7:36 am</a>		</div>

		<p>&gt; I think if you look more closely,</p>
<p>&gt; your &#8220;unsorted&#8221; view is still sorted.</p>
<p>Um&#8230;</p>
<p>&gt; Alphabetical order? (Sorted according to</p>
<p>&gt; which language?)</p>
<p>Windows Explorer is showing 4 filenames in a folder:</p>
<p>downloading_vista_0.png</p>
<p>downloading_vista_3.png</p>
<p>downloading_vista_221.png</p>
<p>downloading_vista_-3.png</p>
<p>Windows Explorer is showing a small ascending triangle next to the word for filename. &nbsp;Most likely if I want to then I can find the statement of how this is sorted, but this alphabetical order? &nbsp;Sorted according to which language?</p>
<p>Sure sorting isn&#8217;t a bad thing and I wouldn&#8217;t mind having more options. &nbsp;I&#8217;d like to set things so that Windows Explorer will sort lists in the same order on local drives as it does in ftp views. &nbsp;Lower priority, I might want to set Outlook Express 6 to sort things in the same order as Outlook Express 6. &nbsp;But sometimes maybe it would be OK to say it&#8217;s listing things as it finds them while showing that the search is still under way, like a dog does.</p>
<p>(By the way I didn&#8217;t really capture a screenshot of Internet Explorer downloading Vista RC2 at the 3% point, I only created a file with that name to check how Windows Explorer would sort it. &nbsp;At the 0%, -3%, and 221% points, I captured screenshots.)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/michkap/archive/2006/09/30/778345.aspx" rel="nofollow">Michael Kaplan covered this topic just a few days ago</a>. As for the hyphen, <a href="http://blogs.msdn.com/oldnewthing/archive/2004/05/18/134051.aspx" rel="nofollow">I covered this myself</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-428643">
				<div id="div-comment-428643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TCLIU</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-428643">
			October 7, 2006 at 8:32 am</a>		</div>

		<p>Guys, if you don&#8217;t think fast mode is faster in enough cases to make it useful then you don&#8217;t have to use it.</p>
<p>Personally I think Raymond is spot-on here with his estimate, but that&#8217;ll only affect code that *I* write.</p>
<p>Now I need to get back and benchmark if cout or printf is the fastest way to display the help text for my app. Does anyone here have data on whether processor architecture / SMP affects the performance of stdout? :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428663">
				<div id="div-comment-428663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/sw/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-428663">
			October 7, 2006 at 7:02 pm</a>		</div>

		<p>&#8220;[I think if you look more closely, your &#8220;unsorted&#8221; view is still sorted. -Raymond]&#8221;</p>
<p>I know it *is* sorted &#8211; my point is that I didn&#8217;t *ask* for it to be sorted, the relevant menu indicates no sorting order, and that sorting it is causing problems (a non-trivial delay opening the folder, to achieve a result I didn&#8217;t request in the first place). Explorer not indicating that it is sorted is, arguably, a bug, the fact the implicit &#8216;no sorting&#8217; option doesn&#8217;t actually deliver is just an irritating drawback.</p>
<p>FWIW Unix&#8217;s (GNU&#8217;s?) &#8216;ls&#8217; behaves as I&#8217;d want: for &#8216;small&#8217; numbers of files they&#8217;re sorted by name, anything higher it would take too long, so they&#8217;re unsorted. Explorer could go one better and display results as they come in, as it does already for search operations&#8230;</p>
<p>TCLIU: For real performance gains, just #define them both as noops :-)</p>
<div class=post>[<i>I can see the bug reports already. &#8220;Explorer shows files in scrambled order&#8230; sometimes.&#8221; If you don&#8217;t pick an explicit sort order, then the folder&#8217;s &#8220;natural&#8221; sort order is used. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-428773">
				<div id="div-comment-428773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/sw/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-428773">
			October 9, 2006 at 8:59 am</a>		</div>

		<p>[I can see the bug reports already. &#8220;Explorer shows files in scrambled order&#8230; sometimes.&#8221; If you don&#8217;t pick an explicit sort order, then the folder&#8217;s &#8220;natural&#8221; sort order is used. -Raymond]</p>
<p>I can&#8217;t really see anyone regarding &#8216;Explorer shows files in the order I requested&#8217; (besides, if &#8216;natural&#8217; order actually matters to anyone, why is there no option to specify it?!) as more of a bug than &#8216;Explorer sits twiddling its thumbs for long periods of time&#8217; &#8211; and displaying incrementally rather than waiting for the whole lot to arrive would preserve whatever order is being imposed, at the expense of a bit of CPU time. Sort and display the results as they arrive, everyone&#8217;s happy &#8211; make them wait as long as possible, nobody gains except perhaps the CPU temperature or battery life.</p>
<p>Web browsers have been doing it for years, for faster operations than that!</p>
<p>(On a related note, it would be really nice if XP&#8217;s Notepad didn&#8217;t stop the message pump while trying to open files, too&#8230;)</p>
<div class=post>[<i>This creates the different problem of &#8220;I was about to click on something and <u>it moved</u> and I ended up clicking on the wrong thing.&#8221; As for the related note, edit controls (like all window controls) are single-threaded. There is no special treatment for the WM_SETTEXT message. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-429173">
				<div id="div-comment-429173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061003-00/?p=29483#comment-429173">
			October 9, 2006 at 9:52 pm</a>		</div>

		<blockquote><p>
  This creates the different problem of &quot;I was</p>
<p>  about to click on something and it moved and</p>
<p>  I ended up clicking on the wrong thing.&quot;
</p></blockquote>
<p>Windows Explorer already does that, in Vista, and it is by design.</p>
<p>However I think James&#8217; idea was that Windows Explorer would list files as they&#8217;re found (and my idea was that Windows Explorer would show its status as still in the middle of reading), adding to the list as they come in. &nbsp;The user would click to sort when the user is ready for the display to be reordered.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>