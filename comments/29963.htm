<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (25)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-413713">
				<div id="div-comment-413713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bjorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413713">
			August 25, 2006 at 10:56 am</a>		</div>

		<p>How do you create a &quot;secure screen saver?&quot; I checked Google for the phrase, but couldn&#8217;t find anything except a WinLogon constant and a bunch of articles talking about the C# starter kit.</p>
<p>I&#8217;m curious what the distinctions are, so if you could enlighten me that would be great.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413723">
				<div id="div-comment-413723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413723">
			August 25, 2006 at 11:06 am</a>		</div>

		<p>Bjorn, you don&#8217;t, the system does. It&#8217;s a property of how the screen saver is run, not of how it is written. As soon as the user password-protects the screen saver, it will be run in &quot;secure&quot; mode</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413733">
				<div id="div-comment-413733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.northcode.com' rel='external nofollow' class='url'>Tim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413733">
			August 25, 2006 at 11:41 am</a>		</div>

		<p>Prevent a secure screensaver from doing this may be problematic. The user has to be a willing accomplice, but if they want a secure screensaver to be able to open a web site or start processes outside the job object, all they have to do is have a process running before the screensaver starts. The screensaver can then proxy whatever commands it needs to that running helper process by any number of methods, a shared file, windows message, named pipe, shared memory, &#8230; Cutting off every avenue that the helper application might use sounds like a big job and would end up crippling the screensaver. And maybe that&#8217;s not such a bad idea &#8211; if you really want a secure screen saver.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-413743">
				<div id="div-comment-413743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413743">
			August 25, 2006 at 12:10 pm</a>		</div>

		<p>Q: We know it&#8217;s insecure, but we want to do it anyway.</p>
<p>A: OK.</p>
<p>Q: &#8230; so how do I do it?</p>
<p>A: You don&#8217;t.</p>
<p>Q: &#8230; but I want to!</p>
<p>A: I know you want to do it, but you can&#8217;t anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413763">
				<div id="div-comment-413763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413763">
			August 25, 2006 at 4:01 pm</a>		</div>

		<p>Actually, I just came up with the idea of invoking a program as a screensaver. In order to make a program that runs securely by default, you have to create a low-privilege account, make it login by default, lock it down, make it run your program, and put a wrapper around it so that it can restart automatically if it exits for any reason. And then you still have to deal with avoiding all the crap that Windows likes to pop up on top of your window.</p>
<p>If you just make your program the screensaver for the .DEFAULT hive (and set the timeout to something low, like 1 second), it will run automatically. You don&#8217;t have to create an account for it, figure out how to lock it down, try to avoid pop-ups, or anything else. The only configuration it requires is changing a single registry key.</p>
<p>It even has the advantage of allowing you to remotely access your kiosk via RDP without having to disturb the person viewing it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413773">
				<div id="div-comment-413773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mr. Ed</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413773">
			August 25, 2006 at 5:42 pm</a>		</div>

		<blockquote><p>
  In order to make a program that runs securely<br />
  <br />&gt;by default, you have to create a low-privilege<br />
  <br />&gt;account</p>
<p>Sounds like a great way for malware to easily get to your desktop and phish your password.<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413783">
				<div id="div-comment-413783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WendyHome</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413783">
			August 25, 2006 at 7:36 pm</a>		</div>

		<p>&quot;We know it&#8217;s insecure, but we want to do it anyway&quot;</p>
<p>Now that&#8217;s a scarey statement. &nbsp;Surely the team shouldn&#8217;t need to read security memo&#8217;s to be responsible. Naughty people. &nbsp;I didn&#8217;t even know that I might want an interactive screen-saver fabulous the un-forseen needs that are being planned for. &nbsp;</p>
<p>Setting a password on my screen-saver is a clear, &nbsp;understandable act requesting security. &nbsp;I&#8217;ll wait the few minutes to log-in for interactivity for what-ever they think I&#8217;ll need&#8230;. &nbsp; is this a case of enthusiastic over-engineering by a team that love fiddling with their feature? &nbsp;Oh my.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413813">
				<div id="div-comment-413813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Endurion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413813">
			August 26, 2006 at 2:11 am</a>		</div>

		<p>Back in the days of 98 i worked for an multimedia advertising company and the interactive screensaver was quite a common gimmick. </p>
<p>Marketing speech: Make it so, that the user can click here and there and it opens the browser on that particular URL. The user wants it (though nobody seems to have actually asked the enduser).</p>
<p>We ended up with an agent app that was installed with the screensaver that provided reminder services and sat in the taskbar. The screensaver would write the URL into a file and closed itself. The agent checked for the file in intervals and then started up the browser. Eeeeew!</p>
<p>Security measurements weren&#8217;t really a important part of the decision.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413823">
				<div id="div-comment-413823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mr. X</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413823">
			August 26, 2006 at 2:21 am</a>		</div>

		<blockquote><p>
  &gt; funny things that they got away with on Windows 95 such as taking a snapshot of the user&#8217;s screen and using it as the basis for a jigsaw puzzle that it animated.</p>
<p>Secure Screen savers on Vista get away with funny things. &nbsp;The &quot;Bubbles&quot; screen saver keeps all the information on the screen visible.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413833">
				<div id="div-comment-413833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregYoung</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413833">
			August 26, 2006 at 2:49 am</a>		</div>

		<p>Just from the title &#8230;. &quot;Allow Service to Interact with Desktop&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413863">
				<div id="div-comment-413863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413863">
			August 26, 2006 at 1:48 pm</a>		</div>

		<p>How can I tell whether my screen saver is one that runs on a separate desktop?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis odd alt thread-odd thread-alt depth-1" id="comment-413873">
				<div id="div-comment-413873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413873">
			August 26, 2006 at 2:39 pm</a>		</div>

		<p>On Windows 2000 and up (XP, 2003) &quot;secure&quot; vs. &quot;non-secure&quot; in this case refers to whether you enable the &quot;on resume, password protect&quot; setting. &nbsp;With that setting enabled, the screen saver will run in a separate job on a separate &quot;screen-saver&quot; desktop with no [direct] access to the applications running on the user&#8217;s interactive desktop. &nbsp;When the screen saver exits, any other processes in that job (i.e., directly launched by the screen saver) will be terminated. &nbsp;If the password-protect setting is not enabled, the screen saver runs on the user&#8217;s interactive desktop, can take screenshots, etc.</p>
<p>One way to bypass the job restriction is to launch a child process via DCOM or WMI. &nbsp;Processes started this way are not contained within the job object of the parent process.</p>
<p>All that said, I don&#8217;t know whether/how Vista changes any of this&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413883">
				<div id="div-comment-413883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paulcoddington.info' rel='external nofollow' class='url'>Paul Coddington</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413883">
			August 27, 2006 at 2:06 am</a>		</div>

		<p>&quot;Secure Screen savers on Vista get away with funny things. &nbsp;The &quot;Bubbles&quot; screen saver keeps all the information on the screen visible.&quot;</p>
<p>A similar problem exists in XP &#8211; when FUS is enabled, the logged in user&#8217;s desktop is visible for a short period of time when resuming from hiberation (or returning to the logon screen in general).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413903">
				<div id="div-comment-413903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413903">
			August 27, 2006 at 12:49 pm</a>		</div>

		<p>I think you meant &#8216;unsecure&#8217;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413913">
				<div id="div-comment-413913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zenja</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413913">
			August 27, 2006 at 6:44 pm</a>		</div>

		<p>Who actually owns the computer &#8211; Microsoft or the end user? &nbsp;If I want to do something silly, foolish and ridiculous on MY PC, then who are Microsoft to say what I can and cannot do? &nbsp;This whole philosophy of &#8216;protecting the user from themselves&#8217; has become extreme.</p>
<p>Think of it as banning kitchen knives since some people occasionally cut themselves. &nbsp;Insane.</p>
<p>If the user wishes to do something insecure ON THEIR OWN BOX, then by golly, let them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413923">
				<div id="div-comment-413923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cypherpunks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413923">
			August 27, 2006 at 7:23 pm</a>		</div>

		<p>Then Zenja clicks on the random attachment and whines about &quot;Insecure Windows&quot;</p>
<p>Microsoft cannot win.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-413933">
				<div id="div-comment-413933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413933">
			August 27, 2006 at 8:06 pm</a>		</div>

		<p>Zenja: Then don&#8217;t password-protect your screensaver. If you don&#8217;t want it secure, you don&#8217;t have to HAVE it secure.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413963">
				<div id="div-comment-413963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ross Bemrose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-413963">
			August 28, 2006 at 12:01 am</a>		</div>

		<p>Zenja:</p>
<p>&quot;Who actually owns the computer &#8211; Microsoft or the end user? &nbsp;If I want to do something silly, foolish and ridiculous on MY PC, then who are Microsoft to say what I can and cannot do? &nbsp;This whole philosophy of &#8216;protecting the user from themselves&#8217; has become extreme.&quot;</p>
<p>Here, let me fix that for you.</p>
<p>Who actually owns the computer &#8211; Microsoft or the person who wrote the screensaver I&#8217;m using? &nbsp;If someone I haven&#8217;t ever met wants to do something silly, foolish and ridiculous on MY PC, then who are Microsoft to say what a potentially malicious person can and cannot do? &nbsp;This whole philosophy of &#8216;protecting the user from malware&#8217; has become extreme.</p>
<p>Perhaps you see the point?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-414043">
				<div id="div-comment-414043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414043">
			August 28, 2006 at 10:39 am</a>		</div>

		<p>The problem is that once a malicious actor gets his software on it, he will own your computer, not you. Microsoft&#8217;s job is to prevent the malicious ones from owning your computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414153">
				<div id="div-comment-414153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jpstanley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414153">
			August 28, 2006 at 12:47 pm</a>		</div>

		<p>I remember a fun screen saver story from when I was training for Packard Bell tech support (gosh, it&#8217;d have to be almost twelve years ago now). &nbsp;The PC running Windows 3.1 went into screen saver while the instructor was talking. &nbsp;It was clear he didn&#8217;t know the password. &nbsp;But he did know a trick.</p>
<p>At the password prompt, he pounded on the keyboard for several seconds. &nbsp;Then, when the 486SX was trying to catch up with the keyboard buffer, he hit Ctrl+Alt+Del. &nbsp;Immediately a blue screen popped up: &quot;ssmarque.scr: This program is not responding.&quot; &nbsp;Hit Enter and BAM! &nbsp;Back at the desktop.</p>
<p>I suppose moving the password prompt out of the screen saver binary was a good security move&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-414163">
				<div id="div-comment-414163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drizzt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414163">
			August 28, 2006 at 1:15 pm</a>		</div>

		<p>Well, it&#8217;s a bit stupid but &quot;interactive secure screensavers&quot; have their meaning, after all.</p>
<p>Simply and plain: you can write a simple s.saver that let the user do a few things while it is active. Meanwhile, you protect it with a password, so nobody can access to the desktop and do anything else.<br />
<br />In the end, take the PC to that show/fair/whatever, and look people passing by interacting with what has a full application look, but cannot be crippled or bypassed in any way&#8230;.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414203">
				<div id="div-comment-414203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Weiguo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414203">
			August 28, 2006 at 1:48 pm</a>		</div>

		<p>from Zenja: &quot;If I want to do something silly, foolish and ridiculous on MY PC, then who are Microsoft to say what I can and cannot do?&quot;</p>
<p>perhaps if you want to to something silly, foolish, and ridiculous on YOUR PC, then I agree, Microsoft has no place telling you not to. &nbsp;But they don&#8217;t tell you anything; you&#8217;re the one who&#8217;s gone out and installed a Microsoft OS. &nbsp;If you want to do something silly, foolish, and ridiculous, maybe you should start by setting up an environment which lets you do silly, foolish, and ridiculous things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-414483">
				<div id="div-comment-414483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alexl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414483">
			August 28, 2006 at 10:15 pm</a>		</div>

		<p>yo wizards, this is offtopic but can someone point me to a good explanation of when to use Addref?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414553">
				<div id="div-comment-414553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RC5</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414553">
			August 29, 2006 at 3:54 am</a>		</div>

		<p>The problem I see, is that naturally MS cannot figure out all perfectly valid ways of using a PC and everytime they block a given scenario with no workarounds, they are crippling a 0.1% of their popoulation.</p>
<p>The fair example is quite good.<br />
<br />A simple screen with 5 radio buttons and a text box for inserting an explanation. A button sends the data to the database (a service running on the same machine). Another button unlocks the screen saver [with password and so on].</p>
<p>Maybe other and better ways exist to kiosk mode the workstation, but this is a plain good way to do it. And if it fails and the disk got formatted and the system corrupted and etc, it&#8217;s an isolated single purposed PC which can be reghosted that night.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-414603">
				<div id="div-comment-414603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kiosk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060825-17/?p=29963#comment-414603">
			August 29, 2006 at 5:03 am</a>		</div>

		<p>Is there any definition of what &quot;kiosk mode&quot; should and should not include? Do Windows have any recommended support for it?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>