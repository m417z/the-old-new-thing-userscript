<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (44)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1113073">
				<div id="div-comment-1113073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113073">
			March 18, 2014 at 7:25 am</a>		</div>

		<p>More likely it&#39;s an usability feature. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113083">
				<div id="div-comment-1113083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CmdrKeene</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113083">
			March 18, 2014 at 7:51 am</a>		</div>

		<p>I don&#39;t see how this impacts (negatively or positively) usability. &nbsp;If the mouse immediately gripped the window, the keyboard user could still ignore it and continue using the keyboard. &nbsp;I&#39;m included to agree with Raymond here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman even thread-even depth-1" id="comment-1113093">
				<div id="div-comment-1113093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113093">
			March 18, 2014 at 8:10 am</a>		</div>

		<p>I never noticed this behavior before, but just tried it now (XP). Interesting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113113">
				<div id="div-comment-1113113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113113">
			March 18, 2014 at 8:32 am</a>		</div>

		<p>@Brian_EE &#8211; you&#39;ve never ended up with an annoying window sitting off-screen that you need to get back on screen?</p>
<p>I thought that, and the fix (Alt-Space, arrow key, move mouse) were universal experiences.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113123">
				<div id="div-comment-1113123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113123">
			March 18, 2014 at 9:03 am</a>		</div>

		<p>I wonder if some previous version of Windows only allowed you to move windows with the arrow keys when you initiated the move from the keyboard. Then it wouldn&#39;t really matter that the move wasn&#39;t actually started until you press an arrow key.</p>
<p>The bug would only manifest when mouse support was added, because you would expect to move to start when the command was invoked instead of when you press an arrow key.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113143">
				<div id="div-comment-1113143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dmitry Onoshko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113143">
			March 18, 2014 at 9:10 am</a>		</div>

		<p>Tested that with WinXP SP3. Well, it only worked a few times with calc.exe. Then I&#39;ve tried to resize Notepad.exe&#39;s window and the additional arrow key is not needed for some reason. I think, I&#39;ll try this again a bit later, after rebooting the computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113173">
				<div id="div-comment-1113173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113173">
			March 18, 2014 at 11:01 am</a>		</div>

		<p>You just know that if anybody ever comes around and fixes this minor little silly thing, somewhere, some value-added application by BigCorp will break, because it somehow relied on this behavior. Maybe the developer couldn&#39;t find MoveWindow but did know SendInput&#8230; something like that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113183">
				<div id="div-comment-1113183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113183">
			March 18, 2014 at 11:16 am</a>		</div>

		<p>Tim: Windows had mouse support from day-1, but it had to always be optional since you couldn&#39;t expect all users to have a mouse in the mid-80s.</p>
<p>One of the great things about Windows is that to this very day there are very few things in that can&#39;t be accomplished with a keyboard (changing the width Explorer&#39;s folder tree or viewing its tooltips come to mind).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113203">
				<div id="div-comment-1113203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mashmagar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113203">
			March 18, 2014 at 11:56 am</a>		</div>

		<p>The Move command definitely confused me. I kept trying to drag the window with the mouse and it never worked. It was several years before somebody showed me I could move it with arrow keys. I assumed that was the only option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113213">
				<div id="div-comment-1113213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113213">
			March 18, 2014 at 12:05 pm</a>		</div>

		<p>@Gabe &#8211; the fact that you can use a keyboard for (near enough) to everything &#8211; even in Win 8 / Server 2012 &#8211; is incredibly useful when you&#39;re working on industrial / embedded computers. &nbsp;Even if they have a mouse / trackball / touchpad, if it&#39;s been sitting in a factory for three years, it doesn&#39;t work. &nbsp;The fact you can walk up and do everything necessary on the keyboard is a huge benefit.</p>
<p>Up until Win 8, Start, right, right, right, Enter shuts down without a mouse or a monitor (if it is unlocked). &nbsp;Sometimes remote desktop services can be running well enough to allow you to connect, but not serve up an image. &nbsp;That&#39;s OK, Log in, Start, right, right, right, Enter shuts down (and right, right, right, up, up restarts). &nbsp;Yes you can do it in Win 8 too, but the sequence isn&#39;t burned into my ROM yet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113223">
				<div id="div-comment-1113223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113223">
			March 18, 2014 at 12:11 pm</a>		</div>

		<p>@Damien I&#39;ve always used the right click (Shift+Right Click in Win7) to get that menu, I didn&#39;t realize Alt+Space was the shortcut for it. Now days when it happens I use the Aero Snap hotkeys (Win+[Left,Right,Up,Down]) which is awesome. Aero Snap was in my opinion the single biggest usability enhancement added in Windows 7 (although as Raymond pointed out a few years ago this was always possible, in Windows, it just didn&#39;t have the super cool hot key).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113233">
				<div id="div-comment-1113233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113233">
			March 18, 2014 at 12:54 pm</a>		</div>

		<p>Is the helper function in some sense still the same code, or has the bug/odd design decision been faithfully reproduced in one or more rewrites?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-1113243">
				<div id="div-comment-1113243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113243">
			March 18, 2014 at 12:59 pm</a>		</div>

		<p>In old Explorer, right clicking on that top-left icon of the Explorer window used to show the context menu for currently open location &#8211; was easier to target hot corner than precise positioning over an item to show context menu. Now it shows the window menu just like left click/Alt+Space does. :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mngoldeneagle odd alt thread-odd thread-alt depth-1" id="comment-1113253">
				<div id="div-comment-1113253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113253">
			March 18, 2014 at 1:24 pm</a>		</div>

		<p>@xpclient: If you don&#39;t have anything selected, you could just press the Menu key.</p>
<p>I always forget that key exists.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113263">
				<div id="div-comment-1113263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113263">
			March 18, 2014 at 1:32 pm</a>		</div>

		<p>I&#39;ve been wanting to ask exactly this question for a while, but I always miss the suggestion boxes. Thanks to TehShrike for covering for me! I&#39;m somehow glad to learn that it&#39;s most likely a bug, not intended design.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113273">
				<div id="div-comment-1113273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">eggbox23</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113273">
			March 18, 2014 at 1:52 pm</a>		</div>

		<p>This comes in handy when you have a window that is off the screen; sometimes when you have a laptop that was connected to multiple monitors and then you disconnect those monitors and the window stays in the multi-screen location (off screen). &nbsp;Alt+Space then M then ArrowKey allows you to simply &#39;pick up&#39; the window with the mouse and move it on-screen, very useful and used many (many) times over the years. &nbsp;It may be a bug but it is useful, please don&#39;t fix it!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113293">
				<div id="div-comment-1113293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Muzer_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113293">
			March 18, 2014 at 2:44 pm</a>		</div>

		<p>I remember being very confused by this feature when I was young. It was only a few years after I first discovered it that I actually figured out how to use it.</p>
<p>I doubt it goes back to Windows 1 &#8211; didn&#39;t that not have resizeable windows? Or maybe it was in the old version of Windows 1 that did&#8230; I can&#39;t quite remember the history.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113103">
				<div id="div-comment-1113103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeffrey L. Whitledge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113103">
			March 18, 2014 at 8:22 am</a>		</div>

		<p>&gt; the common helper function waits for the arrow key regardless of the underlying operation.</p>
<p>I feel way better about having to press that arrow key now that I know there is *some* reason for it (even if it&#39;s not a good reason). Thanks for the explanation!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman even thread-even depth-1" id="comment-1113303">
				<div id="div-comment-1113303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113303">
			March 18, 2014 at 4:43 pm</a>		</div>

		<p>@Damien &#8211; I always just Alt-Space X to maximize the screen, but that&#39;s not something I&#39;ve run into enough to have had the opportunity to notice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com odd alt thread-odd thread-alt depth-1" id="comment-1113313">
				<div id="div-comment-1113313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113313">
			March 18, 2014 at 4:58 pm</a>		</div>

		<p>@eggbox23 You can also just hit Win+Up/Left/Right arrow in Windows 7 and above. That initiates snap sequences, which if the app is off screen it will go to the closest monitor.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113323">
				<div id="div-comment-1113323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113323">
			March 18, 2014 at 5:02 pm</a>		</div>

		<p>Entegy. That doesn&#39;t work for non-resizable windows, which might include modal dialog boxes stopping your main application window from regaining focus.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113363">
				<div id="div-comment-1113363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">P</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113363">
			March 19, 2014 at 12:34 am</a>		</div>

		<p>I had always noticed that, but never asked myself about the reasoning behind that. I just press a key before moving the window via the context menu (mostly to find a lost window).</p>
<p>What has really gotten me thinking about, is why half the cursor is displayed on each monitor when moving a window from one monitor to another, yet not when simply moving the cursor from one monitor to another.</p>
<div class="post">[<em>Not sure what you&#39;re talking about.&nbsp;The&nbsp;cursor follows the caption bar. It doesn&#39;t jump to the monitor boundary. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-1113373">
				<div id="div-comment-1113373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113373">
			March 19, 2014 at 1:12 am</a>		</div>

		<p>@MNGoldenEagle, Menu key only works if the focus is on the navigation pane. Right click on hot corner worked even if focus was in the file pane. Menu key in the right pane shows the directory background context menu.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113383">
				<div id="div-comment-1113383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113383">
			March 19, 2014 at 3:52 am</a>		</div>

		<p>@P: Wow, very observant, I never noticed this detail.</p>
<p>I guess that when MS introduced opaque window movement they just took a screenshot of the window, including cursor, and then hide the real cursor.</p>
<div class="post">[<em>Move a window that is constantly updating (e.g. a clock or an animation). Notice that the animation continues, so it&#39;s not a snapshot. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113393">
				<div id="div-comment-1113393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113393">
			March 19, 2014 at 6:52 am</a>		</div>

		<p>Don&#39;t know why everyone here is against fixing the bug. &nbsp;Presumably the fix would be to have the move command immediately start tracking the mouse rather than waiting for the arrow key. &nbsp;This would be a substantial usability win in my book as the arrow key is not very discoverable. &nbsp;I know that in Win98 you could use the Home key instead of an arrow, so when I moved to XP and had to use the arrow key I was stymied for a while (especially since it was my web browser that was stuck off screen :) ).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113473">
				<div id="div-comment-1113473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113473">
			March 19, 2014 at 8:13 am</a>		</div>

		<p>@BJ: I don&#39;t know about you but on my Windows 7 machine, Start, right, right, right, Enter puts my computer to sleep, it doesn&#39;t shut it down.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113493">
				<div id="div-comment-1113493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113493">
			March 19, 2014 at 9:09 am</a>		</div>

		<p>@Brian G: &nbsp;My Win 7 machine with 6 monitors (and 2 ATI video cards) behaves like P&#39;s machine. &nbsp;Also I cannot see the window tracking ahead of the mouse like you describe. &nbsp;Interestingly if you drag a window so that the cursor is split between monitors then drop the window, half of the cursor immediately disappears.</p>
<p>However, I have a huge piece of evidence to disprove the snapshot idea. &nbsp;Change your Normal Select pointer to an animated cursor. &nbsp;Note that while the window is moving the cursor remains animated, even when split between multiple monitors.</p>
<p>I am going to speculate that when not dragging, Windows is using a hardware cursor of some sort, but when dragging it switches to a software cursor for some reason. &nbsp;But I don&#39;t really know enough about that level of graphics to know if that is very good specultion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113503">
				<div id="div-comment-1113503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alexx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113503">
			March 19, 2014 at 9:18 am</a>		</div>

		<p>Here&#39;s a bug I found recently on Windows 7:</p>
<p>&#8211; Open Command Prompt</p>
<p>&#8211; Click the Start button to open the Start Menu</p>
<p>&#8211; Click the Show Desktop button to bring the Desktop to the front</p>
<p>&#8211; Click the Show Desktop button again to bring the Command Prompt window to the front</p>
<p>&#8211; Watch what happens to Command Prompt window</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1113573">
				<div id="div-comment-1113573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113573">
			March 19, 2014 at 10:42 am</a>		</div>

		<p>Here is a bonus question. Why does Windows (Vista+?) screw up the display resolution of a disconnected FUS session? And why it incorrectly recalculates SPI_GETWORKAREA after that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1113603">
				<div id="div-comment-1113603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113603">
			March 19, 2014 at 11:28 am</a>		</div>

		<p>The reason the cursor is immediately moved onto the caption bar on SC_MOVE, is that the move code needs to call SetCapture(), but it will only be effective if the cursor is over the window.</p>
<p>Is SC_SIZE is selected, you can cancel the size by clicking outside the window before using any arrow key. I guess the same reason applies to SC_MOVE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113633">
				<div id="div-comment-1113633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113633">
			March 19, 2014 at 12:45 pm</a>		</div>

		<p>@Raymond: No, P meant that when you move the cursor alone, it will either be on one monitor or the other, but never halve-halve on both. In Window-Move mode the the cursor will move seamlessly between monitors. I guess the hardware cursor thing could make sense, though I expected hardware cursors to have died along with SVGA cards.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113653">
				<div id="div-comment-1113653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random832</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113653">
			March 19, 2014 at 12:59 pm</a>		</div>

		<p>&quot;Is SC_SIZE is selected, you can cancel the size by clicking outside the window before using any arrow key.&quot;</p>
<p>Or, for that matter, by clicking _inside_ the window before using any arrow key. Also, it moves the cursor onto the caption bar again if you moved it between selecting the command and using an arrow key, so it didn&#39;t really need to move it the first time. I suspect this is because it moves the cursor twice (once to the center, and once to the edge) for moving, so it moves the cursor twice (both times to the caption bar) for resizing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113433">
				<div id="div-comment-1113433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113433">
			March 19, 2014 at 7:13 am</a>		</div>

		<p>@P I think you may be observing video-driver-dependent behavior. I&#39;m not sure about that. Anyway, I don&#39;t currently have a multi-monitor machine to test, but I have a good test for you to run to test your snapshot theory. I&#39;ve observed taht if I grab a window in the vicinity of text (for example, just to the right of the vertical part of a letter), I can clearly observe that as I move the window, the window moves *ahead* of the cursor.</p>
<p>I&#39;ve observed this in Windows 7 x64 on NVidia graphics hardware. I think I&#39;ve also seen it on 8. I just tested it on my work machine with XP x86 with old Intel graphics hardware, and it happens, but only a pixel at most whereas I&#39;ve been able to get the window several letters ahead of the cursor on my home machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113683">
				<div id="div-comment-1113683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113683">
			March 19, 2014 at 4:06 pm</a>		</div>

		<p>@alexx: I followed your steps-to-reproduce and didn&#39;t see anything of consequence.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113543">
				<div id="div-comment-1113543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113543">
			March 19, 2014 at 10:05 am</a>		</div>

		<p>@SimonRev thanks for testing that. Not that I&#39;ll ever do anything valuable with the information, but it&#39;s nice to have a bit of curiosity sated. *grin*</p>
<p>Your hardware cursor theory is consistent with my (extremely limited) knowledge and observations.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113713">
				<div id="div-comment-1113713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alexx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113713">
			March 19, 2014 at 5:42 pm</a>		</div>

		<p>@Nick: I forgot to mention that I was using Remote Desktop Connection when I found that bug. I&#39;m not on Win7 right now, but maybe you could reproduce the bug at the console with Aero turned off.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1113673">
				<div id="div-comment-1113673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113673">
			March 19, 2014 at 3:16 pm</a>		</div>

		<p>&gt;Also, it moves the cursor onto the caption bar again if you moved it between selecting the command and using an arrow key, so it didn&#39;t really need to move it the first time.</p>
<p>It needs to call SetCapture *before* you hit arrow keys. Thus it needs to move the cursor.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113733">
				<div id="div-comment-1113733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">P</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1113733">
			March 20, 2014 at 1:01 am</a>		</div>

		<p>@Raymond: I suppose you already understood it based on the other comments, but in case you didn&#39;t, this happens when you&#39;re dragging a window from one display to another. If you position the cursor just right, you will be able to see half the cursor on one display, and half the cursor on the other.</p>
<p>This is different from the usual behavior, which is to show the cursor only on one display.</p>
<p>I also assumed this would be a driver issue, but it has consistently happened on a bunch of computers with AMD, nVidia and Intel adapters. But even so, I don&#39;t think the drivers know anything about window dragging, so I tend to think this change in behavior is eventually initiated by Windows code, even though it may be implemented by driver code. (Note: I&#39;m not a driver developer, so I have no idea what I&#39;m talking about)</p>
<div class="post">[<em>Okay, I see what you mean now. I originally thought you meant that the cursor jumped to the straddle point when you initiated the movie. What you meant was that if you are dragging a window with the mouse, then something funny happens when you move the cursor to the straddle point. I cannot explain. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1114403">
				<div id="div-comment-1114403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1114403">
			March 20, 2014 at 3:01 pm</a>		</div>

		<p>&gt;Reasonably enough, on the first boot after the hardware swap, Windows fell back to the VGA driver at 640&#215;480.</p>
<p>Windows 7 generic VGA driver can run 800&#215;600, and possibly 1024&#215;768.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1114383">
				<div id="div-comment-1114383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1114383">
			March 20, 2014 at 2:35 pm</a>		</div>

		<p>This seems like the right context to complain about something that just happened to me: I upgraded the video card on a PC (running Windows 7) whose primary display is a TV &#8212; native resolution 1280&#215;720. &nbsp;Reasonably enough, on the first boot after the hardware swap, Windows fell back to the VGA driver at 640&#215;480. &nbsp;Then I downloaded the proper driver for the new card &#8230; and could not run its installer, because its &quot;wizard&quot; windows were too tall for the screen, and the advance-the-installation buttons, being as usual at the bottom of the window, were inaccessible. &nbsp;To make matters worse, whoever wrote the installer had screwed up keyboard traversal; pressing Enter focused some random button in the middle of the installer, and the Tab loop did not include the &quot;go on&quot; button. &nbsp;For the same reason, turning on the screen reader did not help.</p>
<p>With some effort I managed to move the wizard so it was cut off at the *top* (you have to turn off &quot;Aero Peek&quot;, and then use keyboard-initiated move, to make this happen at all) but then the *contents* of the window moved back down, making the button inaccessible again.</p>
<p>In the end I had to bypass the installer and use the &quot;Look for a driver in this directory&quot; mode of the Device Manager.</p>
<p>I&#39;m not sure any of this is Microsoft&#39;s fault, but it sure was infuriating.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1114623">
				<div id="div-comment-1114623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1114623">
			March 21, 2014 at 2:04 am</a>		</div>

		<p>@alegr1: it can run at even higher resolutions, but only if the display reports that it supports them. Since the display is a TV, it&#39;s quite possible that it doesn&#39;t report anything but 640&#215;480.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1114693">
				<div id="div-comment-1114693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1114693">
			March 21, 2014 at 5:58 am</a>		</div>

		<p>Yeah, the only option in the resolution selection dialog (which worked fine) was 640&#215;480. &nbsp;That part, I am happy to blame on the TV.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-1114673">
				<div id="div-comment-1114673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1114673">
			March 21, 2014 at 4:20 am</a>		</div>

		<p>@Muzer: Windows 1.0 didn&#39;t have *overlapping* windows. I think it still had a Move command so that you could move a given window to a different part of the screen, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1115583">
				<div id="div-comment-1115583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140318-00/?p=1483#comment-1115583">
			March 25, 2014 at 5:24 am</a>		</div>

		<p>@BJ: On Vista and newer (i.e. everything supported after 04/08/2014), you can hit the windows key, then type in &quot;shutdown -s -t 0&quot; and hit enter to shut down the computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>