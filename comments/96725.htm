<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (28)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-mzzt even thread-even depth-1 parent" id="comment-1304586">
				<div id="div-comment-1304586" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/The+MAZZTer' rel='external nofollow' class='url'>The MAZZTer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304586">
			August 1, 2017 at 8:59 am</a>		</div>

		<p>It&#8217;s worth mentioning I tried this to see if it would work:</p>
<p>echo %MESSAGE%1&gt;result.txt</p>
<p>No dice. cmd.exe takes the full number before the &gt; even if it&#8217;s multiple digits. Since it doesn&#8217;t know what 11 is supposed to be it ignores it outright, and you&#8217;ve just bought 2 for 11, which is quite a bad deal.</p>
<p>Because of legacy compatibility oddities like this, I personally would advise against using batch for anything except simple scripts*, and powershell or a full compiled program for anything complex. The only reason you might want to use batch for something more complex and really be justified would be if the target machine is old enough to lack powershell (and MS does not support any versions of Windows in this configuration anymore so this is increasingly unlikely) and you are working on someone else&#8217;s (eg a workplace) PC with no access to any sort of real development tools (or, maybe you don&#8217;t know powershell or any full development languages. In which case I encourage you to learn powershell. You managed batch, so I know you can do it).</p>
<p>* &#8211; Such as, for example, launching powershell with permissive ExecutionPolicy to run your powershell script I suggested you write.</p>
<p>Free batch redirection tip if you&#8217;ve chosen to ignore all the above:</p>
<p>2&amp;&gt;1 will redirect stderr to stdout, so they both end up in the same stream. Likewise you can simply do 2&gt;file.ext to capture stderr to a file. You could potentially use the for command to figure out if any text was logged there, and thus determine if an error occurred. But that&#8217;s only necessary if the command does not set %ERRORLEVEL% on error.</p>
<p>(Of course, it&#8217;s a lot easier if you use a language that has error handling built in.)</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1304695">
				<div id="div-comment-1304695" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">florian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304695">
			August 1, 2017 at 12:23 pm</a>		</div>

		<p>Wouldn&#8217;t the redirection be 2&gt;&amp;1 (instead of 2&amp;&gt;1)?</p>
<p>About redirection: this link explains how to pipe multiple lines to another program, and this is my most frequently used method to invoke SQL commands:</p>
<p><a href="http://web.archive.org/web/20160101134129/http://www.misanthropicgeek.net/?p=469" rel="nofollow">http://web.archive.org/web/20160101134129/http://www.misanthropicgeek.net/?p=469</a></p>
<p>What was that PowerShell thing everybody is talking about?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1304715">
				<div id="div-comment-1304715" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304715">
			August 1, 2017 at 12:51 pm</a>		</div>

		<p>@Mazzter: I continue to use batch files for &#8220;complex&#8221; scripts that have already been written as batch files, are well-tested, and converting them to The New Thing(TM) would require far more time than I&#8217;d gain from running the &#8220;improved&#8221; versions.  New scripts, perhaps should be written for The New Thing(TM), but inertia tends towards batch files.</p>
<p>&#8220;(Of course, it&#8217;s a lot easier if you use a language that has error handling built in.)&#8221;<br />
&#8220;Batch&#8221; is not a language.  It&#8217;s a set of commands, in a command processor, with a few rudimentary flow-control options.  Let&#8217;s try to keep that in mind.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1304596">
				<div id="div-comment-1304596" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nathan_works</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304596">
			August 1, 2017 at 9:04 am</a>		</div>

		<p>I feel bad asking, because I know I&#8217;ve written bash-script code like &#8220;if [ $var1 -eq 1 ];&#8221; type stuff to see if $var is empty (so it is evaluated like  &#8220;1 -eq 1&#8221;).. but ..   Would quotes/quoting fix the spaces and numbers problem ?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1304615">
				<div id="div-comment-1304615" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Doubleday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304615">
			August 1, 2017 at 9:12 am</a>		</div>

		<p>Tokens, dear boy.  Tokens.</p>
<p>Naturally, one has to be able to process the tokens within some sort of semantic domain.  Which is where a proper scripting language comes in. (See <b>Mazzter</b>, above.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt depth-2" id="comment-1304655">
				<div id="div-comment-1304655" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304655">
			August 1, 2017 at 9:55 am</a>		</div>

		<p>This obvious solution works:<br />
if [ &#8220;$var1&#8221; == &#8220;&#8221; ]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1304685">
				<div id="div-comment-1304685" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr√≠guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304685">
			August 1, 2017 at 12:00 pm</a>		</div>

		<p>Of course, it also works in batch files. I use the following to show help when no parameter is given:</p>
<p>if &#8220;%1&#8243;==&#8221;&#8221; goto help</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1304765">
				<div id="div-comment-1304765" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adamrosenfield.com' rel='external nofollow' class='url'>Adam Rosenfield</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304765">
			August 1, 2017 at 1:59 pm</a>		</div>

		<p>Some really old shells (we&#8217;re talking /bin/sh, not /bin/bash) don&#8217;t support certain fancy modern features like testing for equality with the empty string or testing for non-emptiness.  It&#8217;s for compatibility with these ancient shells that the configure scripts that GNU Autotools spits out have all these crazy tests like:</p>
<p>if test &#8220;x${FOO}&#8221; == &#8220;x&#8221;; then &#8230;</p>
<p>But if you&#8217;re writing shell code for any shell released in the last decade or two, that&#8217;s completely unnecessary.  Just go with:</p>
<p>if [ -z &#8220;$FOO&#8221; ]; then &#8230;</p>
<p>or</p>
<p>if [ &#8220;$FOO&#8221; == &#8220;&#8221; ]; then &#8230;</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1305025">
				<div id="div-comment-1305025" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">heto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1305025">
			August 2, 2017 at 1:24 pm</a>		</div>

		<p>test -z and testing against the empty string are mandated by POSIX, so they should work on any /bin/sh even if it&#8217;s not bash. Then again, a relatively popular UNIX implementation ships with a /bin/sh with poor POSIX compatibility; for some reason, a more compatible sh is available under another path (leaving the path out so as not to identify which product and thus vendor this is). However, even that /bin/sh supports empty strings with [; what I noticed it lacks support for is $(command).</p>
<p>However, using the == operator with test is a bash extension. With POSIX and most (all?) other shells than bash, only one equals sign is accepted.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1304605">
				<div id="div-comment-1304605" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Doubleday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304605">
			August 1, 2017 at 9:07 am</a>		</div>

		<p>I hate to bang on about this. (No, I lie.)  But the first rule of parsing is -don&#8217;t talk about parsing- ignore the &#8220;fluff&#8221; between tokens.  And when I say, &#8220;fluff,&#8221; I mean &#8220;white space.&#8221;<br />
But, of course, this example turns that around by 180 degrees.  Because the <b>set</b> string is implemented as a macro substitution, rather than as a token in its own right, you get this nonsensical case where the lucky [0..2] digit slurves into a random following token to produce an unexpected redirection.<br />
This sort of thing is <i>very</i> difficult to reason about.  I&#8217;ve given up on DOS batch scriptinging and *nix shell scripting (which is actually far, far, worse) in favor of something that actually does the job properly &#8212; a decent scripting language.  Python, Perl, even PowerShell.  I&#8217;d prefer something cross-platform, but then again, the main criterion is that <b>it was not built in the Stone Age.</b></p>
<p>Having said which, I appreciate the fact that my view is in the minority when hiring new IT guys: a good 80% or more of effort is devoted to supporting this nonsense.  And given that, I for one, support Batch File Week!</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1304625">
				<div id="div-comment-1304625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Doubleday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304625">
			August 1, 2017 at 9:19 am</a>		</div>

		<p>I&#8217;m a little paranoid about being accused of going off-topic, so &#8230; Here&#8217;s the thing about Raymond&#8217;s post here.</p>
<p>I can pretty much guarantee that anything you have learned, either at college or at work, would suggest that you don&#8217;t really need to watch out for trailing spaces.</p>
<p>And you are wrong.  Weird, but interesting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1304705">
				<div id="div-comment-1304705" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr√≠guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304705">
			August 1, 2017 at 12:24 pm</a>		</div>

		<p>Batch files are a lot simpler once you stop thinking in terms of regular parsed-and-compiled languages, and forget about tokens, grammars and preprocessors.</p>
<p>Empty your mind. And take these simple facts:</p>
<p>1) Command interpreters interpret lines. Batch files/shell scripts are just a collection of lines, executed in order.<br />
2) A line is a string of space-separated, optionally quoted, parameters, which end in a line delimiter.<br />
3) Before executing a line, the command interpreter will substitute all its variables for their values, and then it will take note of and remove redirections. Without inserting or removing extra spaces.<br />
4) The first parameter in a line is the command. The remainder are passed as a single string to the command (including trailing spaces), which is in charge of parsing it and extracting the parameters. Thus, for the command interpreter, the only &#8220;special&#8221; parameter is the first one (%0 in cmd.exe&#8217;s notation).</p>
<p>That&#8217;s all. There are some wrinkles, mainly in the flow control commands (if, for, case, while&#8230;), but with those four rules and a bit of logic you can work almost everything. If you follow these rules, you will see that there isn&#8217;t anything special about the set command, either &#8211; all the magic happens in rule 3, during expansion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1304735">
				<div id="div-comment-1304735" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Muzer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304735">
			August 1, 2017 at 1:27 pm</a>		</div>

		<p>*nix shell scripting far worse? In that people&#8217;s expectations are higher than for batch, maybe, but could you tell me how it&#8217;s actually worse? The problem listed here (trailing spaces) most definitely doesn&#8217;t occur in Bourne-like shells.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1304785">
				<div id="div-comment-1304785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr√≠guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304785">
			August 1, 2017 at 3:42 pm</a>		</div>

		<p>Unix shell scripts are years ahead of batch files. When Microsoft/IBM came with DOS 1.0 in 1981, the Bourne Shell already was a mature tool. In the NT/2000/XP years, Microsoft worked hard to close the distance (and did a good work, because Unix shells didn&#8217;t have much improvements left). But sadly all this ended with the launch of PowerShell. Now, there is no hope that CMD.exe will ever reach parity with bash.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1304676">
				<div id="div-comment-1304676" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr√≠guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304676">
			August 1, 2017 at 11:58 am</a>		</div>

		<p>&gt; You managed batch, so I know you can do it.</p>
<p>Yes, I can do it. Of course I can. I have lost count on how many languages I know (probably over a dozen, including two or three developed by myself), so learning a new one should be no problem.</p>
<p>Except that it would take time to master. Even more if you account for the effort that would take to translate into PowerShell the batches I have written over the years (more than a hundred, some of which include calls to GNUWin32 commands). In my case, learning, for example, the sub-commands of sed or grep makes more sense than learning to do the same with PowerShell, because I can use them in Unix too, when doing web administration.</p>
<p>Batch files may not be as elegant as PowerShell scripts (you may say they are ugly, and I won&#8217;t disagree). But they do work, and they take no time away from my (paid) work. I guess many people will be in my shoes.</p>
<p>That&#8217;s why I love Batch File Week (will it be a week-and-a-half this year? Please? With a cherry on top? O:-) ).</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1304725">
				<div id="div-comment-1304725" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304725">
			August 1, 2017 at 1:20 pm</a>		</div>

		<p>Also, cmd/command is *still* the least common denominator if you have to maintain Windows installations that don&#8217;t have PowerShell on them, or where you are stuck with PS that is in restricted execution mode. Unix is in a similiar spot, where the Bourne Shell still reigns supreme even though some people wish it would die a quick death.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1304795">
				<div id="div-comment-1304795" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304795">
			August 1, 2017 at 3:57 pm</a>		</div>

		<p>If you&#8217;re still supporting systems that don&#8217;t come with PowerShell pre-installed, you have much, much bigger problem than the choice of your scripting language. Not even Microsoft is supporting an OS that doesn&#8217;t any more, so it may just be time to move on yourself. </p>
<p>And no there&#8217;s no problem at all with restricted mode. A simple &#8220;PowerShell.exe -ExecutionPolicy Bypass -File &#8221; will do the trick. </p>
<p>That&#8217;s also a handy way to provide PowerShell scripts that can easily be executed from Explorer independent of how the system is set up &#8211;<br />
 put the above into a batch script (such a wrapper is probably the only sane reason for writing a new batch file these days).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3 parent" id="comment-1304815">
				<div id="div-comment-1304815" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304815">
			August 1, 2017 at 5:17 pm</a>		</div>

		<p>You instead could use WSH (i.e., cscript) with VBscript or JScript.  I think that&#8217;s been installed with Windows since Windows 98.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4" id="comment-1304845">
				<div id="div-comment-1304845" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304845">
			August 2, 2017 at 12:45 am</a>		</div>

		<p>I prefer batch or PowerShell over VBScript/JScript&#8230;.</p>
<p>Besides I block WSH on every installation since the Windows XP days. :p</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1304745">
				<div id="div-comment-1304745" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304745">
			August 1, 2017 at 1:52 pm</a>		</div>

		<p>This is kind of a repeat: <a href="https://blogs.msdn.microsoft.com/oldnewthing/20060518-07/?p=31153/" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20060518-07/?p=31153/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-the-wench even thread-odd thread-alt depth-1" id="comment-1304826">
				<div id="div-comment-1304826" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Monochrome+Wench' rel='external nofollow' class='url'>Monochrome Wench</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304826">
			August 1, 2017 at 11:28 pm</a>		</div>

		<p>Putting it at the start works?!? Having used batch files for like 30 years i can&#8217;t believe i haven&#8217;t seen it before</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1304875">
				<div id="div-comment-1304875" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304875">
			August 2, 2017 at 3:21 am</a>		</div>

		<p>In case anyone reading yesterday&#8217;s comments wonders what happened to my timeout/t 1&gt;nul, it became timeout/t&gt;nul 1.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1304935">
				<div id="div-comment-1304935" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BZ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304935">
			August 2, 2017 at 7:36 am</a>		</div>

		<p>Regarding environment variable expansion with redirection operator, I have a feeling that this is the type of thing that can be changed now without worrying about backward compatibility because nobody would ever have written code that did this except by mistake. I can&#8217;t imagine someone using a variable to decide what they want to redirect to a file, or interacting with the redirection operator in some other way.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1304995">
				<div id="div-comment-1304995" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1304995">
			August 2, 2017 at 10:59 am</a>		</div>

		<p>set OUTPUT=2<br />
if save-normal-output set OUTPUT=1<br />
some-command %OUTPUT%&gt;output</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1305137">
				<div id="div-comment-1305137" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BZ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1305137">
			August 3, 2017 at 11:11 am</a>		</div>

		<p>That is a contrived example because it can only redirect one thing at a time. How often do you want to redirect EITHER stdout OR stderr? I&#8217;d imagine either none, one, or both.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1305416">
				<div id="div-comment-1305416" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Bonner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1305416">
			August 6, 2017 at 8:04 am</a>		</div>

		<p>How often?  Not often, but there are a LOT of Windows installations out there.  Somebody, somewhere, *would* be broken by this change.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1305166">
				<div id="div-comment-1305166" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1305166">
			August 3, 2017 at 10:03 pm</a>		</div>

		<p>&gt;result.txt (<br />
echo first line<br />
echo second line<br />
echo third line<br />
)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1306345">
				<div id="div-comment-1306345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.passingtheknowledge.net' rel='external nofollow' class='url'>Elias Bachaalany</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170801-00/?p=96725#comment-1306345">
			August 13, 2017 at 12:21 pm</a>		</div>

		<p>I would like to take the opportunity to mention the &#8220;Batchography&#8221; explaining all there is to be explained about Batch files programming. It is written in 2016 and one of the most complete reference book with more than 100 Batch recipes and troubleshooting tips.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>