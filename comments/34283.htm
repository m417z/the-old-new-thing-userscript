<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-304503">
				<div id="div-comment-304503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304503">
			September 8, 2005 at 2:50 pm</a>		</div>

		<p>And GetLastError returns the same error code as WSAGetLastError?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-304523">
				<div id="div-comment-304523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yaytay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304523">
			September 8, 2005 at 3:45 pm</a>		</div>

		<p>Sven&#8217;s comments sums up what&#8217;s annoying about WSAGetLastError &#8211; the fact that it isn&#8217;t documented to return the same as GetLastError.<br />
<br />In all my experiments it does, and I suspect it just returns GetLastError() on Win32, but it ought to be documented.</p>
<p>More importantly, why are there a whole bunch of winhttp errors that don&#8217;t work with FormatMessage?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-304533">
				<div id="div-comment-304533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">456</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304533">
			September 8, 2005 at 4:45 pm</a>		</div>

		<p>Its documented in the WinSock 2 specification:</p>
<p>&quot;This function is implemented in WinSock 2 as an alias for the Win32 function GetLastError(), &#8230;&quot;</p>
<p><a rel="nofollow" target="_new" href="http://paginas.fe.up.pt/~jmcruz/etc/sockets/winsock22.pdf" rel="nofollow">http://paginas.fe.up.pt/~jmcruz/etc/sockets/winsock22.pdf</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-304543">
				<div id="div-comment-304543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304543">
			September 8, 2005 at 5:08 pm</a>		</div>

		<p>Actually it looks kind of stupid even if you are aware of that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-304553">
				<div id="div-comment-304553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304553">
			September 8, 2005 at 5:33 pm</a>		</div>

		<p>How did Win16 communicate errors, if there was no SetLastError (and, I assume, no GetLastError either)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-304573">
				<div id="div-comment-304573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yaytay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304573">
			September 8, 2005 at 5:48 pm</a>		</div>

		<p>456,<br />
<br />You are right, thank you, now I can ignore it with impunity.<br />
<br />Nothing about it in MSDN though.</p>
<p>So which is definitive, MSDN or the Winsock 2 spec?<br />
<br />I would have thought that the comment in the Winsock spec is just a comment about a current implementation and that to be officially an alias for GetLastError it would need to say it in MSDN.</p>
<p>Go on, prove me wrong, show me the dark and dingy corner of MSDN that says it.<br />
<br />Please.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-304623">
				<div id="div-comment-304623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Goran</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304623">
			September 9, 2005 at 5:05 am</a>		</div>

		<p>:-))</p>
<p>I think somebody from Redmond sys administration is going to kill Raymond&#8217;s VSS account! I mean, how long will they put up with him wandering through VSS history to look for trivia of this kind?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-304633">
				<div id="div-comment-304633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-304633">
			September 9, 2005 at 9:23 am</a>		</div>

		<p>Goran, why do you think he looked at the history for this?  It&#8217;s HIGHLY unlikely this stuff is in the source code history.</p>
<p>Instead, he probably just figured it out because he understands the context in which the APIs were developed (knowing Raymond, he most likely also went to the guys who wrote winsock (two of them are still at MS) and confirmed it).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-305003">
				<div id="div-comment-305003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-305003">
			September 10, 2005 at 9:59 am</a>		</div>

		<p>Of all the ugly things in Windows this is one of the most tolerable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-305263">
				<div id="div-comment-305263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050908-19/?p=34283#comment-305263">
			September 12, 2005 at 3:18 pm</a>		</div>

		<p>Thats how my company succeeds in business too.  Just keep getting other people to lower the bar until something bad is tolerable :P</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>