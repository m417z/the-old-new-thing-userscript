<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1 parent" id="comment-1343205">
				<div id="div-comment-1343205" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343205">
			May 29, 2018 at 8:17 am</a>		</div>

		<p>&#8220;Sometimes the string version disagrees with the numeric version&#8221; I assume the Windows team uses some sort of automation here? The build number is set by a main build machine? It is a define that is stringized for the string part?</p>
<p>The WMP team has messed this up a couple of times on their .DLLs and only updated the string and forgotten about the fixed block.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-alexcohn odd alt depth-2" id="comment-1343405">
				<div id="div-comment-1343405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343405">
			May 29, 2018 at 9:27 pm</a>		</div>

		<p>The. catch was that the Resource Compiler had its own precompiler, similar to the C precompiler, but not exactly compatible.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1343255">
				<div id="div-comment-1343255" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343255">
			May 29, 2018 at 9:15 am</a>		</div>

		<p>I believe it should be “Get-Item”.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1343425">
				<div id="div-comment-1343425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343425">
			May 30, 2018 at 12:10 am</a>		</div>

		<p>Nope, just tested with actual Powershell:<br />
PS C:\Windows\system32&gt; (Get-Command C:\Windows\System32\kernel32.dll).FileVersionInfo.FileVersion<br />
6.1.7601.18015 (win7sp1_gdr.121129-1432)<br />
PS C:\Windows\system32&gt; (Get-Item C:\Windows\System32\kernel32.dll).FileVersionInfo.FileVersion<br />
PS C:\Windows\system32&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-warrenelven-ca even depth-2" id="comment-1343475">
				<div id="div-comment-1343475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/warrens' rel='external nofollow' class='url'>warrens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343475">
			May 30, 2018 at 4:56 am</a>		</div>

		<p>Both work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1343515">
				<div id="div-comment-1343515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343515">
			May 30, 2018 at 7:31 am</a>		</div>

		<p>Whoa! Didn&#8217;t know that. It seems even <code>Get-Command c:\windows\commonsettings.ini</code> returns a command of &#8220;application&#8221; type. Wonder what&#8217;s it for.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1343285">
				<div id="div-comment-1343285" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Maggan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343285">
			May 29, 2018 at 9:54 am</a>		</div>

		<p>Yet another version field that can disagree is the AssemblyVersion, although retrieving it is a bit trickier, even though powershell executes in .net.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1343315">
				<div id="div-comment-1343315" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343315">
			May 29, 2018 at 11:10 am</a>		</div>

		<p>I&#8217;ll bite. Here&#8217;s my BoneHead Question:</p>
<p>This is cute and funny and all, but is there some actual use for it? Like for some tricky internationalization or translation activity?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1343345">
				<div id="div-comment-1343345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343345">
			May 29, 2018 at 2:06 pm</a>		</div>

		<p>Oops. I meant this to go on the alphabet article.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1344115">
				<div id="div-comment-1344115" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1344115">
			June 1, 2018 at 5:30 pm</a>		</div>

		<p>Powershell can get the Version of Windows dlls. You can&#8217;t.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1343385">
				<div id="div-comment-1343385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343385">
			May 29, 2018 at 8:50 pm</a>		</div>

		<p>wmic datafile where name^=&#8221;c:\\windows\\notepad.exe&#8221; get version |findstr /i /v /c:&#8221;version&#8221;</p>
<p>Also gets version number.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command odd alt thread-odd thread-alt depth-1 parent" id="comment-1343395">
				<div id="div-comment-1343395" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343395">
			May 29, 2018 at 9:11 pm</a>		</div>

		<p>With <code>Get-Command</code>? Who would have thought!</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1343525">
				<div id="div-comment-1343525" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343525">
			May 30, 2018 at 7:33 am</a>		</div>

		<p>In the &#8220;further reading&#8221; article, it was <code>Get-Item</code>, which is more intuitive to me &#8212; I didn&#8217;t expect <code>kernel32.dll</code> to be some &#8220;command&#8221; (in PowerShell world).</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1343415">
				<div id="div-comment-1343415" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">florian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343415">
			May 29, 2018 at 10:11 pm</a>		</div>

		<p>/* get-version.js */</p>
<p>var FileSystemObject = WScript.CreateObject(&#8216;Scripting.FileSystemObject&#8217;);<br />
for (var i=0; i&lt;WScript.Arguments.length; i++) {<br />
  WScript.Echo(<br />
    (Array(16+1).join(&#039; &#039;) + /* left padding spaces */<br />
    FileSystemObject.GetFileVersion(WScript.Arguments.Item(0))).slice(-16) + &#039;  &#039; +<br />
    WScript.Arguments.Item(i));<br />
}</p>
<p>/* Invoke: cscript //nologo get-version.js [EXEFILE] &#8230; */</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1343495">
				<div id="div-comment-1343495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">florian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180529-00/?p=98855#comment-1343495">
			May 30, 2018 at 7:23 am</a>		</div>

		<p>Ok, it&#8217;s not really command line. And besides my diminished perception, I was also stung by the spelling bee from your next post: WScript.Arguments.Item(0) should also be WScript.Arguments.Item(i), of course &#8212; I was already wondering why all my files had the same version&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>