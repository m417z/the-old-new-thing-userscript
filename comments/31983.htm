<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (26)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-352893">
				<div id="div-comment-352893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-352893">
			March 9, 2006 at 10:15 am</a>		</div>

		<p>&quot;and just paint a custom caption&quot;</p>
<p>I actually had to do this once. A horrendous amount of work, for, as far as I am concerned, very little return. I&#8217;m not sure who I hate more &#8211; whoever decided that &quot;if you ask for a caption you must have a border&quot; or the woever made that requirement for the application I was writing.</p>
<p>It does bring up the question though &#8211; why is this so?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-352923">
				<div id="div-comment-352923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ringzero</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-352923">
			March 9, 2006 at 10:34 am</a>		</div>

		<p>Once again, some developers are confused by another retarded design decision by Microsoft, and Mr. Chen blames the victim.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-352953">
				<div id="div-comment-352953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-352953">
			March 9, 2006 at 10:41 am</a>		</div>

		<p>Would somebody care to enlighten me as to what a window would look like if it had a title bar but no border?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-352993">
				<div id="div-comment-352993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matthew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-352993">
			March 9, 2006 at 11:04 am</a>		</div>

		<p>A little like this, I&#8217;d imagine:<br />
<br />&lt;a href=&quot;<a rel="nofollow" target="_new" href="http://img79.imageshack.us/my.php?image=noborder7mj.png&quot;&gt;Window" rel="nofollow">http://img79.imageshack.us/my.php?image=noborder7mj.png&quot;&gt;Window</a> with no border&lt;/a&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353053">
				<div id="div-comment-353053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Starfish</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353053">
			March 9, 2006 at 11:43 am</a>		</div>

		<p>A maximised window has no border (that you can see, anyway!)<br />
<br />Fixed link:<br />
<br /><a rel="nofollow" target="_new" href="http://img79.imageshack.us/my.php?image=noborder7mj.png" rel="nofollow">http://img79.imageshack.us/my.php?image=noborder7mj.png</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-353093">
				<div id="div-comment-353093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353093">
			March 9, 2006 at 12:20 pm</a>		</div>

		<p>ringzero: Nowhere did I argue that the design was a good one. But even if you don&#8217;t like something, you still have to obey the rules of boolean logic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353103">
				<div id="div-comment-353103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Threetwosevensixseven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353103">
			March 9, 2006 at 12:27 pm</a>		</div>

		<p>It&#8217;s because: if you don&#8217;t have a border, the edges will fray.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353113">
				<div id="div-comment-353113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353113">
			March 9, 2006 at 12:35 pm</a>		</div>

		<p>While I certainly understand the frustration when the thing one is working with does not do EXACTLY what I want it to, if the fallback is not so bad, then where&#8217;s the beef? So you get a border &#8230; at least it does not mean its a sizeable window. Hey &#8211; your competitor&#8217;s windows have borders too!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353123">
				<div id="div-comment-353123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">L7</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353123">
			March 9, 2006 at 12:36 pm</a>		</div>

		<p>What I cannot get is why there is no DrawCaptionBar (and the needed GetCaptionBarSize, etc) or similar API to aid the developer who needs to draw a custom caption bar.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353173">
				<div id="div-comment-353173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdi/pantdraw_1mwe.asp' rel='external nofollow' class='url'>Click here for DrawCaption action.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353173">
			March 9, 2006 at 12:59 pm</a>		</div>

		<p>Oh, you mean DrawCaption()? &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353183">
				<div id="div-comment-353183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kokorozashi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353183">
			March 9, 2006 at 1:02 pm</a>		</div>

		<p>Seems to me that the repeated occurrence of this conversation suggests the need for an additional API of some sort.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353193">
				<div id="div-comment-353193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kokorozashi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353193">
			March 9, 2006 at 1:04 pm</a>		</div>

		<p>D&#8217;oh! That will teach me to comment without refreshing. Maybe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353253">
				<div id="div-comment-353253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Randolpho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353253">
			March 9, 2006 at 1:31 pm</a>		</div>

		<p>&lt;i&gt;Oh, you mean DrawCaption()?&lt;/i&gt;</p>
<p>There you go, Raymond. The next time somebody says &quot;I want a window with a caption, but no border&quot;, you tell them to use a frame and DrawCaption().</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-msdnarchive odd alt thread-odd thread-alt depth-1" id="comment-353333">
				<div id="div-comment-353333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MSDN Archive</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353333">
			March 9, 2006 at 3:50 pm</a>		</div>

		<p>Arguably, this indicates a usability problem. As does a large subset of the &quot;psychic debugging&quot;. I&#8217;m not pointing any fingers; I&#8217;m guilty of that myself. In my heart of hearts I don&#8217;t believe that we&#8217;ll ever fix those bugs. It&#8217;s not sexy work and it doesn&#8217;t drive revenue.</p>
<p>But what do I know? I&#8217;m just some schmuck tester.</p>
<p>&#8211; Drew</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353363">
				<div id="div-comment-353363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ATZ Man</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353363">
			March 9, 2006 at 5:45 pm</a>		</div>

		<p>Style flags and condensed MFC description edited by me:<br />
<br />WS_DLGFRAME: The frame that dialog boxes get, which by recent convention is thick and possibly beveled. No caption though.<br />
<br />WS_BORDER: a border.<br />
<br />WS_CAPTION: a caption. But &#8216;implies&#8217; WS_BORDER.</p>
<p>It&#8217;s hard to help explain this with the bit values, because WS_DLGFRAME is a border, and so is WS_BORDER, but OR&#8217;ing two borders gives you a caption. Russell and Whitehead surely are not taking sides here. But really you should be describing it as an enum field in the middle of the style word. Four options, none of which are what the particular user wants, because someone back in the mists of time exercised some discretion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353393">
				<div id="div-comment-353393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353393">
			March 9, 2006 at 7:30 pm</a>		</div>

		<p>&quot;Or at least, make it look and act like one up to the present time. If you have the power of clairvoyance, you might be able to make it look and act like a caption in future versions of the operating system, but I suspect your psychic powers are not quite powerful enough to pull that off.&quot;</p>
<p>Perhaps you&#8217;d better tell that to the Office team:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/jensenh/archive/2006/03/09/547281.aspx" rel="nofollow">http://blogs.msdn.com/jensenh/archive/2006/03/09/547281.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353433">
				<div id="div-comment-353433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vince P</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353433">
			March 9, 2006 at 10:43 pm</a>		</div>

		<p>Tim:</p>
<p>Many of us are not wearing our mind-reading hats. &nbsp;What exactly should be told to Office and why?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353463">
				<div id="div-comment-353463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353463">
			March 10, 2006 at 12:34 am</a>		</div>

		<p>Or if you want to get really fancy, you can set the window region to crop off the border&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353493">
				<div id="div-comment-353493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353493">
			March 10, 2006 at 4:49 am</a>		</div>

		<p>&quot;if you don&#8217;t have a border, the edges will fray&quot;</p>
<p>Okay, thanks for the explanation ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353533">
				<div id="div-comment-353533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353533">
			March 10, 2006 at 5:53 am</a>		</div>

		<p>IANAL, but the caption bar is PART OF the border. A maximised window actually still has a border! Try maximising a window with fixed width/height, and drag it away from the edge of the screen. You see, there&#8217;s still a border.</p>
<p>And there are definately useability problems with creating a title bar in a client area. Besides from more obvious problems, you don&#8217;t know what accessibilty programs a user might have running, and you have no idea how you&#8217;ll break them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353563">
				<div id="div-comment-353563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353563">
			March 10, 2006 at 8:59 am</a>		</div>

		<p>@Chris Becke &quot;Then, even worse, my boss comes to me, particularly enamored with some new office widget and wants it in the app im developing. Can I drop in a standard implementation of the widget from user32 or shell32 or even a standard OCX? NO&quot;</p>
<p>Well&#8230; I thought the same but then I saw SmartFTP letting me choose a &quot;drawing manager&quot; for the UI and the list seemed to match what was installed on the PC (&#8216;Standard Windows&#8217; style , &#8216;Office 2000&#8217; style, &#8216;Visual Studio&#8217; style etc.). So there has to be a (maybe) &#8216;deeply buried and misdocumented for the competitors&#8217;-way to use the UI from Office and other MS tools.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353473">
				<div id="div-comment-353473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353473">
			March 10, 2006 at 2:26 am</a>		</div>

		<p>@Vince: At a guess, simply the observation that of any App on my grandfathers PC, the one app most likley to deviate from the &quot;normal&quot; is Office.</p>
<p>Ironically its the same reason I despise open source applications on Win32. They *never* use the windows widgets. Simple standard things like menu&#8217;s and file open dialogs always have to be &quot;improved&quot;.</p>
<p>But I can never complain, because while the OOS apps are wasting their time re-inventing a the wheel, the Office team is doing the same damned thing.</p>
<p>Much to the confusion of my grandfather.</p>
<p>Then, even worse, my boss comes to me, particularly enamored with some new office widget and wants it in the app im developing. Can I drop in a standard implementation of the widget from user32 or shell32 or even a standard OCX? NO. The damn thing is hardcoded into office. So I have to (a) re-implement it from scratch, (b) fail to get the behaviour exactly the same anyway, and (c) know that I &#8211; unlike the office team &#8211; wont have the benefit of being able to re-write it per OS flavor and that its going to look really crap on any newer (or older) OS versions I get run on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353593">
				<div id="div-comment-353593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353593">
			March 10, 2006 at 10:31 am</a>		</div>

		<p>@Nawak: No, these are from 3rd party libraries such as those created by companies like BCGSoft, CodeJock and FOSS Software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-353483">
				<div id="div-comment-353483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kyrox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353483">
			March 10, 2006 at 4:46 am</a>		</div>

		<p>&gt;&gt; Ironically its the same reason I despise open source applications on Win32. They *never* use the windows widgets. Simple standard things like menu&#8217;s and file open dialogs always have to be &quot;improved&quot;. But I can never complain, because while the OOS apps are wasting their time re-inventing a the wheel, the Office team is doing the same damned thing. </p>
<p>OOS does this using GTK, Qt or WXWidgets to keep (as much as possible) compatibility of GUI code across all the supported operative systems. BTW most commercial software does this too, just thinking of 3dsmax, photoshop, office, etc.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-353813">
				<div id="div-comment-353813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-353813">
			March 11, 2006 at 12:18 am</a>		</div>

		<p>8&#8217;s got it. &nbsp;Freecell is an app with a fixed maximum width; you can use that to see what&#8217;s up.</p>
<p>Vorn</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-356373">
				<div id="div-comment-356373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060309-09/?p=31983#comment-356373">
			March 20, 2006 at 5:37 am</a>		</div>

		<p>So when calling DrawCaption how do you tell if your caption is active or not (not forgetting to take FlashWindow into account, of course)?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>