<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (58)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-117743">
				<div id="div-comment-117743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117743">
			December 23, 2003 at 11:13 am</a>		</div>

		<p>I bet some of those &quot;special&quot; fixes (like the NMHDR one) have some very &quot;colorful&quot; comments attached to them. ;)</p>
<p>Just curious, how do you know when to use that &quot;fake stack&quot; NMHDR?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117753">
				<div id="div-comment-117753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117753">
			December 23, 2003 at 12:03 pm</a>		</div>

		<p>But WHY?</p>
<p>WHY do you do these things? Surely that only encourages them? If I write software that doesn&#8217;t work, isn&#8217;t it my responsibility to fix it, not rely on someone else to work out what on earth is going wrong and do so?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117763">
				<div id="div-comment-117763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Braden Simpson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117763">
			December 23, 2003 at 12:44 pm</a>		</div>

		<p>As an aside, why is NTFS so hell-bent on fragmenting itself? Even if I have half the harddrive available as contiguous space it seems that a large file will invariably get written across every little chunk it can find before finally encroaching upon a decent sized block. Install several large applications and you automagically end up in fragmentation city complete with harddrive thrashing performance loss&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117773">
				<div id="div-comment-117773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117773">
			December 23, 2003 at 12:54 pm</a>		</div>

		<p>Colen: Look at the scenario from the customer&#8217;s standpoint. You bought programs X, Y and Z. You then upgraded to Windows XP. Your computer now crashes randomly, and program Z doesn&#8217;t work at all.  You&#8217;re going to tell your friends, &quot;Don&#8217;t upgrade to Windows XP. It crashes randomly, and it&#8217;s not compatible with program Z.&quot;  Are you going to debug your system to determine that program X is causing the crashes, and that program Z doesn&#8217;t work because it is using undocumented window messags? Of course not. You&#8217;re going to return the Windows XP box for a refund.  (You bought programs X, Y, and Z some months ago. The 30-day return policy no longer applies to them. The only thing you can return is Windows XP.)</p>
<p>Braden: I don&#8217;t work on NTFS; you&#8217;ll have to ask somebody who does.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117783">
				<div id="div-comment-117783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117783">
			December 23, 2003 at 2:20 pm</a>		</div>

		<p>How come you guys can spot obscure things like case 3 but you can&#8217;t spot blatantly obvious things like explorer drawing the treeview items 1 pixel off in the &quot;Folders&quot; explorer bar? Not only are there double pixels on the dotted line but the tooltips are offset.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117793">
				<div id="div-comment-117793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117793">
			December 23, 2003 at 6:12 pm</a>		</div>

		<p>Raymond: Isn&#8217;t this the sort of thing that compatability mode was designed for? Or would telling it to run in Windows 2000 mode (for example) not help in such cases?</p>
<p>Regardless, I can see *why* you do it, it just seems like a horribly bad idea to me. Give them an inch, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117803">
				<div id="div-comment-117803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117803">
			December 23, 2003 at 6:29 pm</a>		</div>

		<p>&quot;Compatibility mode&quot; changes the behavior of the operating system. Things like, &quot;GetVersion() reports Windows 95 (even though it&#8217;s really Windows XP),&quot; or &quot;If you read the registry to detect what version of IE is running, you will see 4.0 (even though it&#8217;s really 5.1),&quot; or &quot;if you call RegDeleteKey, perform a recursive deletion because that&#8217;s what Windows 95 did.&quot;</p>
<p>It does not mean &quot;Rewrite the innards of the operating system so all undocumented data structures look just like they were in Windows 95.&quot;</p>
<p>And &quot;compatibility mode&quot; doesn&#8217;t help for shell extensions, since Explorer itself does not run in compatibility mode. (Compatibility mode is set for an entire process.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117823">
				<div id="div-comment-117823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117823">
			December 23, 2003 at 11:52 pm</a>		</div>

		<p>&gt;So I had to create a &quot;fake X,Y&quot; </p>
<p>&gt;I had to create a special NMHDR structure<br />
<br />&gt;that &quot;looked like&quot; the stack the program<br />
<br />&gt;wanted to see and pass that special &quot;fake<br />
<br />&gt;stack&quot;. </p>
<p>Does this two things mean that Windows 2000 contains this stuff always?</p>
<p>Did you really do that only that these two programs work? I can&#8217;t believe that!</p>
<p>That compatibility mode enables things like this is fully aceptable, but that windows is full of stuff that is only there for just a few programs is scaring!</p>
<p>Who decided that these buggy software should work with XP? Your manager?<br />
<br />Is this a policy of MS that these kinds of &quot;fixes&quot; must be made?</p>
<p>Why don&#8217;t you write an angry letter to the offending company, let them fix it and block the software via the machanismns in Windows that give you these message boxes that software is too old?</p>
<p>I think the best would be to have an embedded link &quot;Details&quot; and if the user clicks on it Windows should tell the story what idiotic thing that ISV thought of. All those stupid trolls and computer magazines would read this notice and blame the other company and not MS.<br />
<br />The computer-illiterate wouldn&#8217;t understand this text, but they would read that they have to go to the vendor&#8217;s homepage and fix it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117833">
				<div id="div-comment-117833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117833">
			December 24, 2003 at 12:43 am</a>		</div>

		<p>I agree with Christian that the vendors should fix their stuff instead of MS but that &quot;Details&quot; feature is like the kettle calling the pot black. Some of the API is missing so much functionality, it&#8217;s not even funny. Like the built in controls not being able to respond to some style changes (yeah ES_MULTILINE and LB_SORT are really hard for them to respond to in WM_STYLECHANGED) or getting scrollbars to only appear when text overflows a box, etc., etc., etc. The only way to combat for the lack of functionality is extreme stuff like that or rewriting your own stuff from scratch.</p>
<p>I think Microsoft is to blame for the first case because it should have added defragmenting from the start. It would be pretty niave to say that a company that makes defragmenting software should miss out on useful features because it has to use undocumented structures.</p>
<p>The problem here is that there is no (free?) way to communicate with Microsoft developers that you&#8217;re using stuff in undocumented ways and they should test against it when the OS changes so they can harass you to fix your own software when things break during testing instead of after the OS ships. If there is, then I haven&#8217;t heard of it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117843">
				<div id="div-comment-117843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AlisdairM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117843">
			December 24, 2003 at 1:53 am</a>		</div>

		<p>In order to get permission to use the Windows Logo selling your product, you need to pass Microsoft test process.</p>
<p>Can this process not be made more aggressive, using a special version of Windows that specifically does nasty things with undocumented behaviour?  Eg modifying all &#8216;reserved&#8217; parameters in some clear way and renaming all undocumented/unsupported APIs?</p>
<p>Anything abusing the documented system is more likely to fail early.</p>
<p>The thought of tying the OS of the masses to some stone age architecture to support a few abusive programmers scares me.  I suspect Win32 is a lost cause, but hope something more aggressive, along the lines above, can make it into the Longhorn process.</p>
<p>Oh, and make sure MS apps (apart from those shipping with OS) pass this same test suite, or else legal will be crawling all over you!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117853">
				<div id="div-comment-117853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117853">
			December 24, 2003 at 2:56 am</a>		</div>

		<p>Have you tried the checked build, AlisdairM?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117863">
				<div id="div-comment-117863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Reynolds</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117863">
			December 24, 2003 at 3:14 am</a>		</div>

		<p>Why not publish documentation for all the code and structures? Then, companies and software writers can use the correct methods and interfaces to obtain what they need, rather than having to use reverse-engineering to get what they need. At least they will then know what they can and can&#8217;t use, and why:- and it will sort out many of these messes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117873">
				<div id="div-comment-117873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dimmick.demon.co.uk/' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117873">
			December 24, 2003 at 3:26 am</a>		</div>

		<p>David: it&#8217;s called MSDN Library. If it&#8217;s not in MSDN Library, _don&#8217;t use it_!</p>
<p>Actually, we all have to take a view on whether to do something unsupported. I&#8217;ve had to write Pocket PC programs that persist Remote Access phonebook entries across device cold boots, and set them up on installation. The RasSetEntryProperties API allows you to change the phone number, etc, but you can&#8217;t set up the modem through that API. There are no APIs to configure the Unimodem TAPI driver as appropriate.</p>
<p>Luckily, the Unimodem TAPI driver is included in the CE 3.0 and CE.NET Shared Source, including the appropriate data structure. However, this structure is not documented &#8211; my code could still break in future.</p>
<p>I&#8217;d like there to be a public, published API for everything that the user can do through the UI, including changing locale settings, because our customers (we&#8217;re a vertical-market ISV, producing custom data capture applications) need to be able to pick up a unit with a completely flat battery and wiped memory and be up and running again in minutes, with as little user intervention as possible. Forcing the user to enter an additional dial string for configuring a GPRS modem is not on the cards! Ensuring that the device is set to English (UK) locale and GMT London time zone is also required (haven&#8217;t worked this one out yet).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117893">
				<div id="div-comment-117893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry Osterman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117893">
			December 24, 2003 at 7:26 am</a>		</div>

		<p>David,<br />
<br />  The reason we can&#8217;t publish the structures is that it precludes our changing them FOREVER.  I mean FOREVER.  There are structures in NTVDM that have existed since 1984 (or earlier) because there are apps that depend on them.  </p>
<p>And Raymond has already pointed it the answer to a number of other comments:  We can&#8217;t just simply mark the app as being &quot;broken&quot; because it&#8217;s our job to make sure that as many apps as possible work.  You can&#8217;t say &quot;Hey, &lt;Major Software Vendor&#8217;s application that has millions of copies in circulation&gt; isn&#8217;t supported on Windows XP because &lt;Major Software Vendor&gt; doesn&#8217;t follow the rules&quot; if you actually want to ship operating systems.  The companies that use &lt;Major Software Vendors&#8217;&gt; products won&#8217;t buy your new operating system upgrade.  Companies won&#8217;t ditch their word processor just to put in an OS upgrade, they&#8217;ll wait on the upgrade to keep their apps working.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-117913">
				<div id="div-comment-117913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117913">
			December 24, 2003 at 8:53 am</a>		</div>

		<p>&quot;I think Microsoft is to blame for the first case because it should have added defragmenting from the start.&quot;</p>
<p>So you&#8217;re arguing that Microsoft should not ship an operating system until every imagineable OS feature is implemented fully? By this argument, linux shouldn&#8217;t have shipped ext3 because there isn&#8217;t a e3defrag yet.</p>
<p>&quot;Why not publish documentation for all the code and structures?&quot;</p>
<p>That wouldn&#8217;t have helped program (b). Even if they had the documentation on the internal structure, the change to the structure in Windows 2000 was caused by the *compiler*. Or are you saying that Windows should never upgrade the compiler, too?</p>
<p>And, as Larry noted, this would prevent us from ever changing the structure. It turns out that in Windows XP, that very structure was changed to add new features to Explorer. Are you saying that we shouldn&#8217;t have added those features? Should we just plain stop changing Explorer ever again?</p>
<p>&quot;I&#8217;d like there to be a public, published API for everything that the user can do through the UI.&quot;</p>
<p>I discussed this previously. There are some settings which intentionally have no API because that would allow bad people to manipulate them.</p>
<p><a target="_new" href="http://blogs.gotdotnet.com/raymondc/commentview.aspx/441c4836-e2ef-4088-bc06-936d41886fbc" rel="nofollow">http://blogs.gotdotnet.com/raymondc/commentview.aspx/441c4836-e2ef-4088-bc06-936d41886fbc</a></p>
<p>&quot;Who decided that these buggy software should work with XP?&quot;</p>
<p>You, the customer.</p>
<p>&quot;Why don&#8217;t you &#8230; block the software&#8230;?&quot;</p>
<p>I already discussed this.</p>
<p><a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2003/12/19/44644.aspx" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2003/12/19/44644.aspx</a></p>
<p>&quot;ES_MULTILINE and LB_SORT are really hard for them to respond to in WM_STYLECHANGED&quot;</p>
<p>Actually, ES_MULTILINE is incredibly difficult to respond to WM_STYLECHANGED. You see, there are actually two different edit controls in the system, one for single-line and one for multiline. The WM_CREATE handler decides which one to create based on the style passed at creation. Changing it on the fly would mean having to replace one object with the other on the fly.</p>
<p>Changing LBS_SORT on the fly means that you can create inconsistent data structures: The listbox thinks it&#8217;s sorted (and therefore can use binary search and other optimizations) when in reality it isn&#8217;t sorted (because you started with an unsorted listbox and then flipped the LBS_SORT bit).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-117943">
				<div id="div-comment-117943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-117943">
			December 24, 2003 at 2:50 pm</a>		</div>

		<p>I know they&#8217;re two different objects but I don&#8217;t see how hard it is to handle ES_MULTILINE, just save the handle (whatever you get from EM_GETHANDLE), create a new one, set the handle again (but don&#8217;t use SendMessage, just call the internal functions to do so), and if that succeeds destroy the old one or else keep the old stuff the same. You&#8217;ll be doing everything the app developer has to do except this one will keep the HWND value the same.</p>
<p>Flipping the LBS_SORT bit on should assume everything is unsorted and resort everything from scratch.</p>
<p>I&#8217;m not arguing MS should ship defrag stuff from the start, I&#8217;m arguing that if MS doesn&#8217;t add a feature, they shouldn&#8217;t complain (well&#8230; they should complain, but at least they should accept it as a fact of life) that some company had to use something extreme to get it to work because they&#8217;re not going to skip out on a cool feature if it&#8217;s possible for it to work. Doing it your way without touching undocumented stuff will make MS the authority of what software can and cannot do. (Though I still stand by that the NMHDR case above is just plain dumb on their part).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118323">
				<div id="div-comment-118323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.whirlingdervishes.com' rel='external nofollow' class='url'>Hennk Devos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118323">
			December 27, 2003 at 5:23 am</a>		</div>

		<p>Raymond, you know that i will not agree with you on this.<br />
<br />I do agree fully with the NMHDR problem: This is very bad behavior of the programmers.<br />
<br />But you are saying that a company writing a defragger SHOULD NOT BE ALLOWED to build CERTAIN FUNCTIONALITY into their software? This is never going to happen!<br />
<br />As long as you don&#8217;t give us, developers, certain information, we will reverse-engineer and accidents will happen.<br />
<br />As i argued before, why not share information on undocumented things and make it very clear that it will not work in the next Windows version?<br />
<br />What the defrag programmers should have done in my opinion is not start up on a newer OS on which it was not tested. Instead they could display a message: This version of our software is not working on your opersting system. Please go *here* for a free update.&quot;. Then instead of Microsoft patching the OS, they could have helped the developer patch the application.</p>
<p>But please please please, stop telling us which functionality we are allowed to implement for our software. This is completely unacceptable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118333">
				<div id="div-comment-118333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118333">
			December 27, 2003 at 8:20 am</a>		</div>

		<p>If only apps that relied on undocumented behavior were always so conscientious I could be swayed. But your very own program that relies on an undocumented (and changing, as you even noticed yourself) interface <a target="_new" href="http://www.codeproject.com/shell/selecticon.asp" rel="nofollow">http://www.codeproject.com/shell/selecticon.asp</a> doesn&#8217;t follow your own advice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118473">
				<div id="div-comment-118473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.whirlingdervishes.com' rel='external nofollow' class='url'>Henk Devos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118473">
			December 28, 2003 at 1:53 pm</a>		</div>

		<p>Yes i admit, i have sinned many times myself.<br />
<br />The article you refer to is 4 years old, and i did learn some things during that time. That&#8217;s also why i want to have these discussions: Maybe we can figure out a good solution together. and a guideline that programs using undocumented functions should stop themselves from starting up on Windows versions they were not tested on might be exactly the solution we are looking for.<br />
<br />But you also have to admit, this function should have been documented from the start. It&#8217;s a common dialog that many developers want to use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118513">
				<div id="div-comment-118513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118513">
			December 28, 2003 at 2:59 pm</a>		</div>

		<p>(stupid viewstate error)</p>
<p>This article is much newer and doesn&#8217;t do any version checks either.</p>
<p><a target="_new" href="http://www.codeproject.com/shell/foldertasks.asp" rel="nofollow">http://www.codeproject.com/shell/foldertasks.asp</a></p>
<p>Documenting a function isn&#8217;t just writing a web page and a header file. It implies a continuing support commitment, dediciation of testing resources, and a promise that the function will continue to operate as documented for the indefinite future, even if the underlying technology changes radically. Doing this for the &quot;Pick Icon&quot; dialog is pretty silly, since you can always write your own. (I&#8217;ve done it. It&#8217;s not hard.) It&#8217;s not like it&#8217;s impossible to write one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118503">
				<div id="div-comment-118503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/ptorr/archive/0001/01/01/46228.aspx' rel='external nofollow' class='url'>Office Development, Security, Randomness...</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118503">
			December 28, 2003 at 5:23 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-118573">
				<div id="div-comment-118573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.whirlingdervishes.com' rel='external nofollow' class='url'>Henk Devos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118573">
			December 29, 2003 at 12:30 am</a>		</div>

		<p>It&#8217;s easy to do yourself, true.<br />
<br />Once, on Windows NT 4, i mimicked the security dialogs (permissions etc) for my private secured objects. At that time there was no way to bring up the real security dialogs. I did this all using only documented functions. This took me lots of work to program. But then came Windows 2000 with completely changed security dialogs. This was a system specific for one company (Belgian railways) on computers dedicated to this job, so the computers never got upgraded. But if this would have been general-purpose software the result would have been unacceptable on Windows 2000 (or not even have worked).<br />
<br />That is the purpose of common dialogs: when users want to perform the same task, they get the same dialog on the same OS.<br />
<br />If Microsoft suddenly decides to give the pick icon dialog a radical new look then do i have to program several dialogs and run a different one depending on the OS?</p>
<p>About the folder tasks article, it doesn&#8217;t contain any sample code, let alone sample code with version checks in it. It just contains interface definitions. It mentions that it is Windows XP specific and in the comments i say it will not work on Longhorn. In the future i will be more explicit and include clear warnings that version checks are needed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-118723">
				<div id="div-comment-118723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ozemail.com.au/~markhurd/' rel='external nofollow' class='url'>Mark Hurd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-118723">
			December 29, 2003 at 5:21 pm</a>		</div>

		<p>For the significant companies you can sick legal on them for reverse engineering.</p>
<p>Sooner or later there will be a test case on this so that we all know where we stand. With .NET this is even more important.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-135233">
				<div id="div-comment-135233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ozemail.com.au/~markhurd/' rel='external nofollow' class='url'>Mark Hurd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-135233">
			January 11, 2004 at 11:39 am</a>		</div>

		<p>Good reasons here to not use Microsoft software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-135243">
				<div id="div-comment-135243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-135243">
			January 11, 2004 at 11:41 am</a>		</div>

		<p>Does all windows best weblog software suck this bad? &lt;script&gt;alert(&#8216;help&#8217;)&lt;/script&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-135253">
				<div id="div-comment-135253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-135253">
			January 11, 2004 at 11:54 am</a>		</div>

		<p>Welcome all you slashdotters. Here let me insult Windows a bit, just to save you some time.  &quot;Micro$oft sux. Windoze is lame. Linux roolz. If Windows software sucks, it&#8217;s Microsoft&#8217;s fault.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-135323">
				<div id="div-comment-135323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">acceleriter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-135323">
			January 11, 2004 at 5:58 pm</a>		</div>

		<p>Was that really necessary?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-135333">
				<div id="div-comment-135333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-135333">
			January 11, 2004 at 6:53 pm</a>		</div>

		<p>I figured I&#8217;d get all the insults out of the way, then people who wanted to have a meaningful discussion could do so.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-136263">
				<div id="div-comment-136263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://slashdot.org/' rel='external nofollow' class='url'>Anonymous Coward</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136263">
			January 15, 2004 at 3:56 am</a>		</div>

		<p>Actually, Mr. Checn, Windows software sucks because it&#8217;s binary, closed-source, and written to satisfy endlessly diverse commercial interests that conflict with each other.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-136283">
				<div id="div-comment-136283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136283">
			January 15, 2004 at 7:32 am</a>		</div>

		<p>&quot;written to satisfy endlessly diverse commercial interests that conflict with each other&quot; &#8211; that&#8217;s also why it&#8217;s so successful. In the real world, sometimes you have to suck to succeed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-136593">
				<div id="div-comment-136593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://slashdot.org/' rel='external nofollow' class='url'>Anonymous Coward</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136593">
			January 15, 2004 at 1:27 pm</a>		</div>

		<p>You missed my point, which was that whether Windows sucks from a technical perspective (even though it seems inevitable given it&#8217;s goal of satisfying those interests) is utterly irrelevant, because closed source software sucks period. This point is very much exemplified by the disgusting binary hacking you describe on this page. The idea of crawling up the stack to check variables is revolting, and would never happen in a non-proprietary system. I would never want to waste time on my system trying to deal with such nonsense when there are thousands of more productive, interesting things to do that don&#8217;t involve playing with someone&#8217;s regurgitated binary refuse.</p>
<p>In &quot;the real world&quot;, there are better systems, that don&#8217;t force you to waste time in such a manner. Unfortunately, the commercial market for software thinks differently at the moment, but I and many others like me hope it won&#8217;t always be so because we think non-proprietary technology is better for everyone.</p>
<p>BTW, I don&#8217;t see where other (possibly slashdot-reading) folk were flaming you that &quot;Windows sucks, Linux rul3z&quot; so it seems to me that you wanted to instigate such a flame war with your comment.  Care to point out what you were retaliating to?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-136603">
				<div id="div-comment-136603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136603">
			January 15, 2004 at 1:32 pm</a>		</div>

		<p>The insults started with &quot;Does all windows best weblog software suck this bad&quot; and &quot;this sucks&quot; so I thought I&#8217;d forestall them.</p>
<p>So suppose you&#8217;re some app and you want to do something, but after checking the source code, you find that linux won&#8217;t let you it.  (Say you want some custom display behavior for the files in the directory that contains your program&#8217;s data files.)</p>
<p>What do you do? Do you crawl up the stack looking for the information anyway? Do you grovel around KDE&#8217;s internal data structures and patch yourself in? Or do you just shrug your shoulders and say, &quot;Oh well, I guess I can&#8217;t do that.&quot;</p>
<p>What if you really *really* want to do it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-136613">
				<div id="div-comment-136613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">hughk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136613">
			January 15, 2004 at 2:14 pm</a>		</div>

		<p>I had the benefit of working with another large semi-closed source operating system. I say semi, because for a long time it was possible to get source listings of many interesting bits. You found all kinds of interesting things out from the listings and if you were careful *and built in a version check* you used them. Later the listings were dropped, but there were still sources for a lot of the info like the kernel and file system data structures. You accepted that they might change, but that was it.</p>
<p>I can understand your problems with people messing with undocumented stuff, but sometimes its the only option. The only thing that these guys did wrong was to forget the version sanity check.</p>
<p>However, the company that was reaching down the stack frames was really doing something a little dangerous.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-136623">
				<div id="div-comment-136623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136623">
			January 15, 2004 at 2:30 pm</a>		</div>

		<p>Even if they had the version check, that doesn&#8217;t help the customer. Customer upgrades to XP, program says &quot;Sorry, this program doesn&#8217;t work on XP&quot;, customer returns XP to store for refund and tells all her friends, &quot;Don&#8217;t upgrade to XP, its compatibility is awful.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-136733">
				<div id="div-comment-136733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://slashdot.org/' rel='external nofollow' class='url'>Anonymous Coward</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-136733">
			January 15, 2004 at 6:55 pm</a>		</div>

		<p>With GNU ld (guh-new el-dee, a user-space dynamic linker), you can override any library function at run-time by using the LD_PRELOAD environment.  There are some libraries that do this to add transparent compression for example, but it&#8217;s mostly considered a dirty hack.  Despite that, it&#8217;s much cleaner than the method described here. </p>
<p>There&#8217;s nothing technical that stops a software writer from engaging in those kinds of dirty hacks on a GNU/Linux or other non-prorietary system &#8212; the only effective way to stop people from doing it is social pressure.  But it is very effective, because many people and professional distributiors would refuse to use or to distribute software that contains such dirty hacks.</p>
<p>Your KDE example is not a very good one, because it&#8217;s likely you could override some part of a window like the company was trying to do much cleaner way (I&#8217;m no KDE expert though).  A better example with which i&#8217;m more familiar is Linux kernel modules (device-drivers for Linux basically).  There you may have no choice but to use some dirtily-coded commercial proprietary module or you may not use your hardware. The better alternative there is to use different hardware with visible source code, but very often people are stuck.  The only effective method is again social pressure.  This method has seen some effectiveness in getting companies to distribute source code for their drivers, so that if they do include dirty hacks they can be removed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-138673">
				<div id="div-comment-138673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ed</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-138673">
			January 23, 2004 at 6:00 pm</a>		</div>

		<p>In the first example, the defrag program had to resort to undocumented behavior because Microsoft had the attitude of &quot;NTFS doesn&#8217;t need disk defragmentation, it never gets fragmented&quot;.</p>
<p>So when you say, &quot;And then when the NTFS folks added support for defragmenting&#8230;&quot;, why did they add this support???  Because the defrag programs *proved* that defragmentation was necessary.</p>
<p>MS forced the defrag companies to resort to undocumented behaviors because MS refused to believe that it was necessary.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-139523">
				<div id="div-comment-139523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ozemail.com.au/~markhurd/' rel='external nofollow' class='url'>Mark Hurd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-139523">
			January 27, 2004 at 4:16 pm</a>		</div>

		<p>FYI the 1/11/2004 comment (#57592) is NOT from me.</p>
<p>Mark Hurd B.Sc.(Ma.)(Hons.)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-141823">
				<div id="div-comment-141823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/robmen/archive/2004/02/10/70513.aspx' rel='external nofollow' class='url'>when setup isn't just xcopy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-141823">
			February 10, 2004 at 4:01 am</a>		</div>

		<p>Another tour of the MSI file format.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-144743">
				<div id="div-comment-144743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">D.J. Wiendels</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-144743">
			February 16, 2004 at 1:39 pm</a>		</div>

		<p>is it posible to make (new) undocumented structures unavaialble for client software? This would stop the //only-there-for-downwards-compatibillity// stuff from piling up in the future&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-144753">
				<div id="div-comment-144753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-144753">
			February 16, 2004 at 1:45 pm</a>		</div>

		<p>Depends what you mean by &quot;unavailable&quot;. Remember that once you let a DLL into your process it can access anything in the process (because it is now part of the process). If you meant something else by &quot;unavailable&quot;, please elaborate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-145263">
				<div id="div-comment-145263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://francesc.net/post/2/87' rel='external nofollow' class='url'>Anonymous</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-145263">
			February 17, 2004 at 8:15 am</a>		</div>

		<p>First consequences of the Windows source code leak</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-145063">
				<div id="div-comment-145063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.francesc.net/post/2/87' rel='external nofollow' class='url'>Oscar's Road!</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-145063">
			February 17, 2004 at 9:22 am</a>		</div>

		<p>The first one, is that &lt;a href=&quot;<a href="http://www.securitytracker.com/alerts/2004/Feb/1009067.html&quot;&gt;there" rel="nofollow">http://www.securitytracker.com/alerts/2004/Feb/1009067.html&quot;&gt;there</a> has already been found a security bug in IE 5&lt;/a&gt;. It didn&#8217;t take long to find anything! :)&lt;br/&gt;&lt;br/&gt;<br />
<br />The second one is that people have had a look at the </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-145573">
				<div id="div-comment-145573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JustMe2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-145573">
			February 17, 2004 at 4:46 pm</a>		</div>

		<p>I love the fact that Microsoft using hidden and/or undocumented APIs is OK but if other companies use them it is wrong&#8230;</p>
<p>BTW, what every happend to that &#8216;chinese wall&#8217; that seperated the App side of Microsoft from the OS side?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-145603">
				<div id="div-comment-145603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-145603">
			February 17, 2004 at 4:51 pm</a>		</div>

		<p>I personally still believe in the Chinese Wall. And as an OS person, I personally disapprove of using undocumented APIs outside the OS itself regardless of who calls them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-145613">
				<div id="div-comment-145613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JustMe2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-145613">
			February 17, 2004 at 5:15 pm</a>		</div>

		<p>Nice to see that Microsoft court testimony about the seperations boils down to words like believe.  Why isn&#8217;t it a policy?</p>
<p>Also, what happend to Microsoft statements during the antitrust trail that if the sourcecode was released it would harm the security of the USA.  Then Microsoft released the code to China and Russia.  Isn&#8217;t that purjury?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-145633">
				<div id="div-comment-145633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-145633">
			February 17, 2004 at 5:23 pm</a>		</div>

		<p>I do not make policy or make court statements. I was just expressing my opinion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-147853">
				<div id="div-comment-147853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shaun</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-147853">
			February 25, 2004 at 4:39 pm</a>		</div>

		<p>While I can understand your rationale, particularly given that you have to deal with the results of other programmer&#8217;s mistakes, the simple fact is that users want novel functionality. If an undocumented interface or structure is required to make that functionality possible, then we have no option but to use it. </p>
<p>And the truth is that I don&#8217;t see why I should apologise for that, I only resort to undocumented interfaces when there is absolutely no documented way of doing what I need to do. When I do use undocumented interfaces, I write code to sanity check the environment before using the interfaces in question and to disable their use if it isn&#8217;t safe.</p>
<p>Obviously this is still a problem for you, since my application may stop functioning in the next release of windows, but there is simply no other option, no matter how annoying you may find it. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148103">
				<div id="div-comment-148103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.blpb.uminho.pt' rel='external nofollow' class='url'>Manuel Alves</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-148103">
			February 27, 2004 at 4:06 am</a>		</div>

		<p>I liked the discussion until it got onto the Linux/windows thing. I don&#8217;t have any preference for each; I just want to get the job done. As for the money thing, yes its true; you must pay Microsoft for Windows. In Linux case you must pay some guy that runs the system. Generally I prefer to depend on one company rather than on someone that can leave the next day.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-184343">
				<div id="div-comment-184343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-184343">
			June 16, 2004 at 8:35 pm</a>		</div>

		<p>Commenting on this article has been closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-269473">
				<div id="div-comment-269473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sigkill.dk/blog/archives/60-Microsoft-kan-rent-faktisk-finde-ud-af-noget.html' rel='external nofollow' class='url'>SIGKILL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-269473">
			April 7, 2005 at 12:12 pm</a>		</div>

		<p>Hvis der er noget Microsoft kan, s&amp;#229; er det at bevare bagudkompatibilitet (og derved, helt automatisk, fremadkompatibilitet). Microsoft bliver tit kritiseret for at bryde bagudkompatibilitet i nyere udgaver af deres programmer, men, helt &amp;#230;rligt, det er d</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-462513">
				<div id="div-comment-462513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.not-a-kernel-guy.com/2007/01/17/136' rel='external nofollow' class='url'>Not a kernel guy &raquo; ???????????????? ?????????????????????????? - ?????? ????????????????.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-462513">
			January 18, 2007 at 12:16 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.not-a-kernel-guy.com/2007/01/17/136" rel="nofollow">http://blog.not-a-kernel-guy.com/2007/01/17/136</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-488683">
				<div id="div-comment-488683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alekseysanin.wordpress.com/2007/04/03/microsoft-and-backward-compatibility/' rel='external nofollow' class='url'>Microsoft and backward compatibility &laquo; Random Notes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-488683">
			April 2, 2007 at 10:44 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://alekseysanin.wordpress.com/2007/04/03/microsoft-and-backward-compatibility/" rel="nofollow">http://alekseysanin.wordpress.com/2007/04/03/microsoft-and-backward-compatibility/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-610963">
				<div id="div-comment-610963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.joelonsoftware.com/items/2008/03/17.html' rel='external nofollow' class='url'>joelonsoftware.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-610963">
			March 19, 2008 at 2:26 pm</a>		</div>

		<p>Youre about to see the mother of all flamewars on internet groups where web developers hang out. It</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-611563">
				<div id="div-comment-611563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sorokin88.wordpress.com/2008/03/24/%d0%9e-%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%d1%85-%d0%b8-%d1%81%d1%82%d0%b0%d0%bd%d0%b4%d0%b0%d1%80%d1%82%d0%b0%d1%85-%d0%9c%d0%b0%d1%80%d1%81%d0%' rel='external nofollow' class='url'>?? ?????????????????? ?? ????????????????????. ?????????????????????? ???????????????? &laquo; Sorokin88&#8217;s Weblog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-611563">
			March 24, 2008 at 10:56 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://sorokin88.wordpress.com/2008/03/24/%d0%9e-%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%d1%85-%d0%b8-%d1%81%d1%82%d0%b0%d0%bd%d0%b4%d0%b0%d1%80%d1%82%d0%b0%d1%85-%d0%9c%d0%b0%d1%80%d1%81%d0%b8%d0%b0%d0%bd%d1%81%d0%ba%d0%b8%d0%b5/">http://sorokin88.wordpress.com/2008/03/24/%d0%9e-%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%d1%85-%d0%b8-%d1%81%d1%82%d0%b0%d0%bd%d0%b4%d0%b0%d1%80%d1%82%d0%b0%d1%85-%d0%9c%d0%b0%d1%80%d1%81%d0%b8%d0%b0%d0%bd%d1%81%d0%ba%d0%b8%d0%b5/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-614623">
				<div id="div-comment-614623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://daarchitect.wordpress.com/2008/04/02/the-bbc-news-redesign-ramblings/' rel='external nofollow' class='url'>The BBC News Redesign ramblings &laquo; Content Negotiable</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-614623">
			April 2, 2008 at 10:32 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://daarchitect.wordpress.com/2008/04/02/the-bbc-news-redesign-ramblings/" rel="nofollow">http://daarchitect.wordpress.com/2008/04/02/the-bbc-news-redesign-ramblings/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632773">
				<div id="div-comment-632773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.cnblogs.com/westsourcer/archive/2008/05/26/1207958.html' rel='external nofollow' class='url'></a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-632773">
			May 26, 2008 at 10:17 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://www.joelonsoftware.com/items/2008/03/17.html" rel="nofollow">http://www.joelonsoftware.com/items/2008/03/17.html</a><a rel="nofollow" target="_new" href="http://www.newsmth.net/bbstcon.php?board=J" rel="nofollow">http://www.newsmth.net/bbstcon.php?board=J</a>&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632783">
				<div id="div-comment-632783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.cnblogs.com/westsourcer/archive/2008/05/26/1207962.html' rel='external nofollow' class='url'></a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-632783">
			May 26, 2008 at 10:21 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://www.joelonsoftware.com/items/2008/03/17.html" rel="nofollow">http://www.joelonsoftware.com/items/2008/03/17.html</a><a rel="nofollow" target="_new" href="http://www.newsmth.net/bbstcon.php?board=" rel="nofollow">http://www.newsmth.net/bbstcon.php?board=</a>&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-684273">
				<div id="div-comment-684273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://unlogica.com/blog/2008/11/in_defense_of_the_iphone_api_l.html' rel='external nofollow' class='url'>Code and cars</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031223-00/?p=41373#comment-684273">
			November 14, 2008 at 8:42 pm</a>		</div>

		<p>The iPhone API is new. It has yet to mature. Yes, it does use a very mature 20-year-old foundation steeped in the NeXTSTEP heritage as its foundation, there&#8217;s a lot that was removed or didn&#8217;t make the translation from AppKit/Cocoa&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>