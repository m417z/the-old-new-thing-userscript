<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-646753">
				<div id="div-comment-646753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646753">
			July 15, 2008 at 10:09 am</a>		</div>

		<p>In fact, this is the reason why 16-bit extended templates exist in the first place:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2008/07/08/8705314.aspx#8709887" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2008/07/08/8705314.aspx#8709887</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-646763">
				<div id="div-comment-646763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646763">
			July 15, 2008 at 11:12 am</a>		</div>

		<p>I beg your pardon, but there is an inconsistency:</p>
<p>The field named &#8220;dwType&#8221; in the structure declaration is called &#8220;dwFlags&#8221; in the hex dump&#8230;</p>
<div class="post">[<i>Oops, fixed. Thanks. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-646773">
				<div id="div-comment-646773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Don't like to pick...</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646773">
			July 15, 2008 at 11:37 am</a>		</div>

		<p>&#8230;but do you really mean twenty-five years?</p>
<div class="post">[<i>Oops. can&#8217;t do math. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-646823">
				<div id="div-comment-646823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646823">
			July 15, 2008 at 2:10 pm</a>		</div>

		<p>I would be tremendously indebted to you if I could convince you to change your &quot;Exit&quot; entry to:</p>
<p>004C &nbsp;45 26 78 69 74 09 41 6C 74 2B 58 00 // &quot;E&amp;xittAlt+X&quot; + null terminator</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-646833">
				<div id="div-comment-646833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646833">
			July 15, 2008 at 2:24 pm</a>		</div>

		<p>Or better still:</p>
<p>004C &nbsp;45 26 78 69 74 09 41 6C 74 2B 46 34 00 // &quot;E&amp;xittAlt+F4&quot; + null terminator</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-646863">
				<div id="div-comment-646863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646863">
			July 15, 2008 at 4:54 pm</a>		</div>

		<p>I always wished the popup menus had an ID for the purpose of dynamically modifying a menu (e.g. adding an MRU list to the File menu). &nbsp;Without the ID you have to do a string compare on the label which doesn&#8217;t hold up to translations and customizations.</p>
<p>Too bad the VS resource editor doesn&#8217;t support IDs for popup menus. &nbsp;The Visual Studio 2008 menu editor shows the ID property with a grayed out &#8220;ID cannot be edited&#8221; message. &nbsp;If I manually set the id in the rc file it gets overwritten with 65535 the next time the file is saved by the visual menu editor.</p>
<p>Hopefully the VS team will add support for this along with allowing toolbars with 256 color images.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-646903">
				<div id="div-comment-646903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646903">
			July 15, 2008 at 7:57 pm</a>		</div>

		<p>Context Help IDs? They&#8217;re cool, but not exactly a new feature, more a convenience thing. In 3.x you could achieve (mostly) the same thing by tracking if the menus were open (WM_ENTERMENULOOP + WM_EXITMENULOOP, undocumented at the time, IIRC) in a global variable, and as each menu item was highlighted track the current menu ID in a different ID, and then use them when F1 was pressed.</p>
<p>Well, that&#8217;s what I remember anyway, I don&#8217;t have the code lying around at work.</p>
<p>Well-behaved apps of the day (well for a time, anyway) would also put help text in the status bar as each item was selected which was a dumb idea even when 640&#215;480 was an astonishingly high resolution &#8212; except for one app, I forget which, put the menu help text in the title bar. Genius. Ugly, but genius. Tooltips saved the day.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-646953">
				<div id="div-comment-646953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.koroirc.com/' rel='external nofollow' class='url'>Koro</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646953">
			July 16, 2008 at 12:22 am</a>		</div>

		<p>steveg: I&#8217;ve seen this app. I think it was WordPerfect, or failing that, Lotus 1-2-3.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-646973">
				<div id="div-comment-646973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646973">
			July 16, 2008 at 2:01 am</a>		</div>

		<p>Maybe the ID for the popup menu allows one to pop up something if the popup itself is chosen rather than the submenu item?</p>
<p>E.g., you can have Windows show Control Panels in a submenu to open individual control panels, or just click on Control Panels to see the normal window with all of &#8217;em</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-646983">
				<div id="div-comment-646983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646983">
			July 16, 2008 at 4:41 am</a>		</div>

		<p>The versions of the NetWare Administrator that I have do this, although they paint the text themselves which was a minor problem when only 16-bit versions were available, as they only assumed the presence of two window controls. (I haven&#8217;t tried the latest versions to see how well or otherwise they cope with Vista.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-646993">
				<div id="div-comment-646993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-646993">
			July 16, 2008 at 4:59 am</a>		</div>

		<p>So, SB_SIMPLE + SB_SETTEXT(SB_SIMPLEID) for menu help are no longer welcome ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-647013">
				<div id="div-comment-647013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080715-00/?p=21613#comment-647013">
			July 16, 2008 at 11:52 am</a>		</div>

		<p>Apparently I made up the WM_ENTERMENULOOP thing above, I can&#8217;t find them in the source code in app I was thinking of (I know I used the WM_*LOOP items somewhere). Instead good old WM_MENUSELECT was where the status bar action happened.</p>
<pre class="brush: plain; title: ; notranslate" title="">

case WM_MENUSELECT:

if (lParam == 0)

&lt;pre&gt;&lt;code&gt;dwCurrentHelpId = ID_NONE;
&lt;/code&gt;&lt;/pre&gt;

else if (HIWORD(wParam) &amp;amp; MF_POPUP)

{

}

else

&lt;pre&gt;&lt;code&gt;dwCurrentHelpId = LOWORD(wParam);
&lt;/code&gt;&lt;/pre&gt;

if (!(HIWORD(wParam) &amp;amp; MF_SEPARATOR) &amp;amp;&amp;amp; !(HIWORD(wParam) &amp;amp; MF_POPUP))

{

&lt;pre&gt;&lt;code&gt;LoadString(hInst, LOWORD(wParam), (LPSTR) szBuf, 80);

g_theBumBar.SetText(0, (LPSTR) szBuf);

}
&lt;/code&gt;&lt;/pre&gt;

return(0L);

</pre>
<p>(the SetText call is when we ported to 32 bit and sporadic C++. The custom status bar (BumBar) was replaced with the commdlg status bar)).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>