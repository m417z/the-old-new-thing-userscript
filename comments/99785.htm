<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-aadsso-1live-com00034001b11d0d03 even thread-even depth-1" id="comment-1362515">
				<div id="div-comment-1362515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Christian+Ullrich' rel='external nofollow' class='url'>Christian Ullrich</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362515">
			September 20, 2018 at 8:30 am</a>		</div>

		<p>I always believed the 5 was an ERROR_ACCESS_DENIED getting passed through. Interesting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1362535">
				<div id="div-comment-1362535" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.lebeausoftware.org' rel='external nofollow' class='url'>Remy Lebeau</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362535">
			September 20, 2018 at 10:18 am</a>		</div>

		<p>Why not update the official documentation to include the exit codes and make them contractual?</p>
<p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32#BKMK_examples" rel="nofollow">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32#BKMK_examples</a></p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1362645">
				<div id="div-comment-1362645" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362645">
			September 21, 2018 at 1:16 pm</a>		</div>

		<p>Then it would be impossible to add new exit codes.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1364015">
				<div id="div-comment-1364015" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1364015">
			September 28, 2018 at 2:37 pm</a>		</div>

		<p>No, you would just have to document the new ones.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-4" id="comment-1364095">
				<div id="div-comment-1364095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1364095">
			September 28, 2018 at 5:37 pm</a>		</div>

		<p>That would be a breaking change. &#8220;We wrote a program that checks the return value and assumes that code 3 means that LoadLibrary failed. But you introduced a new return value 6 that means &#8220;LoadLibrary failed because the DLL is not signed.&#8221; This is a bug. That situation should be reported as code 3, because that&#8217;s how you documented it. You can&#8217;t make breaking changes like this. Our product relies on the error codes as they were documented.&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1362575">
				<div id="div-comment-1362575" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362575">
			September 20, 2018 at 2:24 pm</a>		</div>

		<p>Maybe future versions could elevate if necessary, to save me having to remember I need an elevated command prompt.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2" id="comment-1362625">
				<div id="div-comment-1362625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362625">
			September 21, 2018 at 1:13 pm</a>		</div>

		<p>But then you wouldn&#8217;t be able to run it silently. It would display an elevation prompt and hang your batch file.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1 parent" id="comment-1362585">
				<div id="div-comment-1362585" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362585">
			September 20, 2018 at 6:30 pm</a>		</div>

		<p>I thought it would just return the error code of the corresponding API like this:<br />
<a href="https://support.microsoft.com/en-us/help/932628/fix-error-message-when-you-use-the-regsvr32-exe-command-line-utility-t" rel="nofollow">https://support.microsoft.com/en-us/help/932628/fix-error-message-when-you-use-the-regsvr32-exe-command-line-utility-t</a></p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2" id="comment-1362635">
				<div id="div-comment-1362635" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362635">
			September 21, 2018 at 1:16 pm</a>		</div>

		<p>If the DLL being registered returns an error, that error code is reported on the screen, but regsvr32 exits with code 5 (&#8220;DLL explicitly failed registration&#8221;).</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1362595">
				<div id="div-comment-1362595" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dimastr.com' rel='external nofollow' class='url'>Dmitry Streblechenko</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362595">
			September 20, 2018 at 7:23 pm</a>		</div>

		<p>Doesn&#8217;t regsvr32.exe (step 3a) launch its sister version of another bitness if the 32 bit version of regsvr32.exe is asked to register a 64 bit dll (and vice versa)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-ramon-sola even thread-odd thread-alt depth-1" id="comment-1362685">
				<div id="div-comment-1362685" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ram%C3%B3n+Sola' rel='external nofollow' class='url'>Ram√≥n Sola</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180920-00/?p=99785#comment-1362685">
			September 21, 2018 at 6:31 pm</a>		</div>

		<p>Those return codes were hinted at the now deleted KB207132 (formerly Q207132) article from Microsoft Support, titled &#8220;INFO: How Regsvr32.exe Registers and Unregisters COM DLLs&#8221;. An archived copy can be recovered from the Wayback Machine, but the sample code appears garbled because the line returns are missing. An even older copy can be located elsewhere and a more elaborated code sample is found in the Visual C++ Samples repository. However, that doesn&#8217;t mean any connection to the official Regsvr tool, obviously!</p>
<p><a href="https://web.archive.org/web/20161219202259/support.microsoft.com/en-us/kb/207132" rel="nofollow">https://web.archive.org/web/20161219202259/support.microsoft.com/en-us/kb/207132</a><br />
<a href="https://github.com/Microsoft/VCSamples/blob/master/VC2010Samples/MFC/controls/regsvr/regsvr.cpp" rel="nofollow">https://github.com/Microsoft/VCSamples/blob/master/VC2010Samples/MFC/controls/regsvr/regsvr.cpp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>