<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-972413">
				<div id="div-comment-972413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Douglas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972413">
			March 14, 2012 at 8:37 am</a>		</div>

		<p>&quot;This saves you from having to record all the mouse activity yourself on the off chance that the mouse might leave the window.&quot;</p>
<p>Or capture the mouse in button down and release capture in button up so that you get all mouse messages, even if they leave the window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-972443">
				<div id="div-comment-972443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972443">
			March 14, 2012 at 10:08 am</a>		</div>

		<p>Isn&#39;t the multimonitor adjustment equivalent to casting to signed short? Just kind of strange that the conversion for input points and output points is not symmetrical.</p>
<div class="post">[<i>I didn&#39;t spend any time studying it. I just made a note and moved on, since it&#39;s not the point of the article. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-972453">
				<div id="div-comment-972453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972453">
			March 14, 2012 at 10:56 am</a>		</div>

		<p>If you want your paint application to work over remote desktop, now you know how.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-972463">
				<div id="div-comment-972463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972463">
			March 14, 2012 at 12:41 pm</a>		</div>

		<p>Why does GetMouseMovePointsEx require the x and y coords, isn&#39;t the timestamp enough?</p>
<div class="post">[<i>That assumes that there can be at most one mouse event per millisecond. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-972493">
				<div id="div-comment-972493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972493">
			March 14, 2012 at 2:18 pm</a>		</div>

		<p>&gt; That assumes that there can be at most one mouse event per millisecond</p>
<p>Okay, so what measures does GetMouseMovePointsEx take to handle the ABA problem then? I assume windows is coded to make sure that 2 equal timestamps can&#39;t share the same x,y coords?</p>
<div class="post">[<i>Yes, there is an ABA race here, but it&#39;s better than nothing. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-972523">
				<div id="div-comment-972523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972523">
			March 14, 2012 at 2:58 pm</a>		</div>

		<p>I like the polygon area algorithm: it&#39;s very simple and it copes with overflows in its accumulator. &nbsp;The only downside is daft results if the curve isn&#39;t simple (like a figure-eight).</p>
<p>I guess it&#39;s very standard but I&#39;ve not seen it before.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-972533">
				<div id="div-comment-972533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972533">
			March 14, 2012 at 3:47 pm</a>		</div>

		<p>&quot;Oh great, now I&#39;m telling people to practice medicine without a license.&quot;</p>
<p>Funny &#8230; when I read that, my first thought was remembering some years ago when my vacation job included setting up web servers &#8211; one of which happened to be a medical one (a European mirror site for Yale medical school&#39;s &#39;GASNet&#39;, the Global Anesthesiology Server Network; the server hardware was stolen in 1999, though the DNS entry is still there today!) We didn&#39;t have rsync in those days, and even universities didn&#39;t have the bandwidth to spare to tar and copy the whole site each night, so I had to hack a Perl script to do the job. (It *almost* worked, but not quite.) The site admin thanked me on the front page, complete with email address (spam not being widespread that far back!)</p>
<p>At which point, I started getting email asking medical advice: &quot;I have a stabbing pain in &#8230; what should I do?&quot;. &quot;Er, try a doctor, not a student moonlighting as sysadmin?&quot;</p>
<p>My second thought was &quot;hm, that might be useful in the endoscopy project I&#39;m working on now&quot;. (Measurement is rather more difficult there than with X-ray or MRI images because of the angles, though.)</p>
<p>On the ABA problem: the default USB mouse polling rate is 125 Hz, which would put each coordinate 8 ms apart &#8211; and since neither the radiologist&#39;s monitor nor his hand-eye coordination will be operating even that fast; if you&#39;re getting more than one mouse position per millisecond, the vast majority won&#39;t relate to actual movements by the operator anyway!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-asklar odd alt thread-odd thread-alt depth-1" id="comment-972543">
				<div id="div-comment-972543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alexander+Sklar' rel='external nofollow' class='url'>Alexander Sklar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972543">
			March 14, 2012 at 10:31 pm</a>		</div>

		<p>[I know, unrelated to the API being discussed but I couldn&#39;t help myself :)]</p>
<p>Don&#39;t you need to add a term to the sum to account for x[n]*y[0] &#8211; x[0]*y[n]?</p>
<div class="post">[<i>x[n] == x[0] and y[n] == y[0], so the missing term is zero. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-972583">
				<div id="div-comment-972583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972583">
			March 15, 2012 at 7:53 am</a>		</div>

		<p>@jas88: Aren&#39;t there higher-performance mice out there that use high-speed USB 2.0 to achieve a faster sample rate (i.e. &lt; 1 ms)? &nbsp;Seems like I remember seeing a review of one awhile back.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-972593">
				<div id="div-comment-972593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972593">
			March 15, 2012 at 8:16 am</a>		</div>

		<p>[Yes, there is an ABA race here, but it&#39;s better than nothing. -Raymond]</p>
<p>I would assume the results are returned in collection order so there is no ABA race.</p>
<div class="post">[<em>Suppose the mouse move from x,y to z,w, then back to x,y all within a single millisecond. Which x,y is the one you are looking for? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-972943">
				<div id="div-comment-972943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120314-00/?p=8103#comment-972943">
			March 17, 2012 at 12:41 am</a>		</div>

		<p>@JamesJohnston: Unfortunately, that&#39;s not possible. USB is a host-polled bus, so the host decides how fast a given device wants to be polled. If the Windows HID driver polls for reports at 125Hz, it only gets reports at 125Hz. There&#39;s no way for the mouse to push HID reports any faster than that &#8211; it can only do it when the host asks for the report.</p>
<p>Now, USB allows for polling rates up to 1kHz, but almost no OS implements it that fast &#8211; usually it&#39;s around 4ms per transaction or so.</p>
<p>A high resolution mouse simply reports larger delta X/Y values every report.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>