<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (42)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-148123">
				<div id="div-comment-148123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148123">
			February 27, 2004 at 10:20 am</a>		</div>

		<p>Since I&#8217;ve never coded a WinForms app (just Asp.Net) I&#8217;m curious &#8211; why do I have to disable the owner of a modal dialog? Doesn&#8217;t modal dialog imply that user cannot interact with the owner until the dialog is dismissed?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148133">
				<div id="div-comment-148133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Sheppard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148133">
			February 27, 2004 at 10:32 am</a>		</div>

		<p>Where does the term &quot;Modal&quot; come from?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148143">
				<div id="div-comment-148143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">theCoach</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148143">
			February 27, 2004 at 10:42 am</a>		</div>

		<p>I am going to make some guesses here. Jerry, he is referring to Win32 apps. You are thinking in terms of the end user, he is describing the coding that is required to respond to a user command to destroy the modal dialog.<br />
<br />This seems like a good candidate for some &quot;Pit of Success&quot; treatment. Sure it makes sense; but it is an invitation for buggy code. Perhaps an api call that did something like DestroyModalDialog( bFocusToParent )  bFocusToParent being a boolean for whether or not to make sure the parent dialog box is enabled.  </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148153">
				<div id="div-comment-148153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148153">
			February 27, 2004 at 10:44 am</a>		</div>

		<p>Jerry: I&#8217;m talking about the case where a program is manually managing modality. If you use built-in functions like DialogBox() then the OS manages the enabling/disabling for you.</p>
<p>Steve: Conceptually, a modal dialog is one that forces you to complete a task before you can continue. The program has been put into a &quot;mode&quot; that you have to complete before you can continue. I don&#8217;t know if that&#8217;s the actual history of the term but that&#8217;s how I think of it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148163">
				<div id="div-comment-148163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148163">
			February 27, 2004 at 11:20 am</a>		</div>

		<p>Steve: Modal comes from the idea of programming &quot;modes&quot;, where instead of working on a given task (eg. using a wordprocessor or a webbrowser), you switch the application into a different mode of operation (eg. changing configuration parameters, or creating mailing labels).</p>
<p>Modeless dialogs do not involve this conceptual switchover, as they act within the context of the current task. Modeless dialogs, however, require that you focus entirely on another task, which can completely change the behavior of the previous task &#8211; and so you have to wait until the new task is finished before you go back. Which is why modal things prevent you from messing with the main application.</p>
<p>As a user interface design principle, modality is to be avoided if at all possible, because it forces the user down a given path and prevents them from having full control over the application. There are cases where it makes sense, but it has been abused really badly in the past.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148173">
				<div id="div-comment-148173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148173">
			February 27, 2004 at 11:21 am</a>		</div>

		<p>Raymond: Yep, that&#8217;s it. I can&#8217;t remember where I first came across the term&#8230; it might have been in an Apple Lisa version of the Apple Human Interface Guidelines, but it dates back to the days of text console displays on mainframes, where each display screen was a different mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148193">
				<div id="div-comment-148193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148193">
			February 27, 2004 at 11:49 am</a>		</div>

		<p>This isn&#8217;t applicable to MFC is it?</p>
<p>Cdialog1Dlg dlg;<br />
<br />m_pMainWnd = &amp;dlg;<br />
<br />INT_PTR nResponse = dlg.DoModal();<br />
<br />if (nResponse == IDOK)<br />
<br />{<br />
<br />// TODO: Place code here to handle when the dialog is<br />
<br />//  dismissed with OK<br />
<br />}<br />
<br />else if (nResponse == IDCANCEL)<br />
<br />{<br />
<br />// TODO: Place code here to handle when the dialog is<br />
<br />//  dismissed with Cancel<br />
<br />}<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148203">
				<div id="div-comment-148203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mikedimmick.blogspot.com' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148203">
			February 27, 2004 at 1:05 pm</a>		</div>

		<p>MFC uses modeless dialogs behind the scenes. The DialogBox API does its own modal message loop internally, which MFC can&#8217;t hook into. This would mean that things like PreTranslateMessage and idle processing would fail to work.</p>
<p>I believe there are other reasons too.</p>
<p>Thankfully, MFC appears to get this right.</p>
<p>See the code in DLGCORE.CPP (if you don&#8217;t have MFC source installed and you&#8217;re writing MFC code, go and install it right now, you&#8217;ll find debugging much easier, IMO).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148213">
				<div id="div-comment-148213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148213">
			February 27, 2004 at 2:28 pm</a>		</div>

		<p>I see, this is about using modeless dialogs and making them act as modal. Then it makes sense even though I still don&#8217;t understand why not just use a modal dialog if I want to show the user a modal dialog. Any processing can (and imo should) run on a worker thread&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148223">
				<div id="div-comment-148223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148223">
			February 27, 2004 at 2:32 pm</a>		</div>

		<p>If you are using a framework that handles for you, then great!  Use the framework and then you don&#8217;t need to worry about this.</p>
<p>But if you want to do it manually, now you know how.  (For example, if you&#8217;re writing your own framework.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148233">
				<div id="div-comment-148233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148233">
			February 27, 2004 at 2:56 pm</a>		</div>

		<p>Let me just make sure I&#8217;m clear on this:</p>
<p>Referring back to your previous discussion on modal dialogs&#8230;</p>
<p>When you create a dialog, you specify its owner.</p>
<p>DialogBox then &#8211; if this owner is not NULL &#8211; disables the owner window, which then disables all of its child windows.</p>
<p>If you specify the desktop window as your owner, this causes problems &#8211; because every top level window is a child of the desktop, and disabling the desktop then disables the dialog.</p>
<p>Disabling / Enabling a window only affect its children, and not windows that are owned by the window being enabled/disabled.</p>
<p>Owned and child windows always appear above their owners in the Z-order. </p>
<p>The question being this:</p>
<p>If you create a window, and give it a modeless dialog (eg. a find window), and then the user does something to show a modal dialog (eg. decides to change app. config), what happens to the modeless find window? Do you have to disable this separately and manually? Or am I missing a piece of the relationship here?</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148243">
				<div id="div-comment-148243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148243">
			February 27, 2004 at 3:01 pm</a>		</div>

		<p>You can run this experiment and answer the question yourself.</p>
<p>Run Notepad, hit Ctrl+F to open the Find dialog, which is modeless.</p>
<p>Now click File, Save As.  This creates a modal dialog.</p>
<p>Now play around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148253">
				<div id="div-comment-148253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148253">
			February 27, 2004 at 3:10 pm</a>		</div>

		<p>Yipes. That&#8217;s fascinating, not the behavior I expected, and slightly scary all in one.</p>
<p>Even with a modal dialog present, I can still do an instance-by-instance replace of text in the control.</p>
<p>Now, that leaves us with another question: what would the *right* way to handle this be?</p>
<p>Personally, if I were implementing notepad, I&#8217;d probably come up with some way of disabling all of my owned windows except the one I&#8217;m using as a modal dialog. So you wouldn&#8217;t be able to activate the find/replace window while you were trying to save.</p>
<p>Ouch &#8211; thanks Raymond &#8211; that&#8217;s weird.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148273">
				<div id="div-comment-148273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148273">
			February 27, 2004 at 7:16 pm</a>		</div>

		<p>Using modeless dlgs and faking modality is also useful in WTL, if you&#8217;re like me and need PreTranslateMessage() to work when the dialog is up. You have to do that to get proper keyboard handling when there are ActiveX controls in the dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148303">
				<div id="div-comment-148303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148303">
			February 28, 2004 at 9:36 am</a>		</div>

		<p>Someone at the eMbedded Visual C++ group should look at this article&#8230; it has the flicker bug in the &quot;send file to device&quot; dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148323">
				<div id="div-comment-148323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joku</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148323">
			February 28, 2004 at 10:50 pm</a>		</div>

		<p>Sometimes i&#8217;ve found it that while filling in a modal dialog, i need to write some text in it that i forgot to copy / find from the now disabled parent/owner. Currently it sometimes works and sometimes maybe not, can&#8217;t remember. </p>
<p>Point is i find useful it that you can scroll/copy from a textbox while the same app has a modal dialog open. Most of the time the modal dialog will have OK/Apply button that does the changes, why should the rest of the app be &#8216;stuck&#8217; while i&#8217;m thinking whether to do the thing in the modal dialog or not? It&#8217;s not like your desktop gets disabled while you are at display properties! And it shouldn&#8217;t!</p>
<p>Or maybe i&#8217;ve just misunderstood the whole thing you are talking here :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148333">
				<div id="div-comment-148333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joku</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148333">
			February 28, 2004 at 10:57 pm</a>		</div>

		<p>Trying to answer my own question.. Maybe apps should use Modal Dialogs only when it is really necessary to disable the owner. </p>
<p>For example, when i press the About box in help menu, what is there in the regular About box that has to disable rest of the UI while viewing it? Maybe it keeps the UI a bit simpler when you can&#8217;t open a ton of dialogs, but as a power user i like control.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148363">
				<div id="div-comment-148363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148363">
			February 29, 2004 at 4:45 pm</a>		</div>

		<p>Someone in the Outlook Express group should read Mr. Chen&#8217;s blog.  In another note someone mentioned that Outlook Express leaks GDIs every time the user changes folders.  Here we can mention the FOUR flickers every time the OE main window recovers focus from a dialog box.  This beats the one flicker that Mark mentioned for Pocket Explorer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148393">
				<div id="div-comment-148393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148393">
			February 29, 2004 at 6:57 pm</a>		</div>

		<p>Joku wrote:<br />
<br />&gt; Trying to answer my own question.. Maybe<br />
<br />&gt; apps should use Modal Dialogs only when it<br />
<br />&gt; is really necessary to disable the owner.</p>
<p>Yep :) If you don&#8217;t need to disable the owner, you shouldn&#8217;t; it removes control from the user, and makes the app less intuitive and fun to use.</p>
<p>&gt; For example, when i press the About box in<br />
<br />&gt; help menu, what is there in the regular<br />
<br />&gt; About box that has to disable rest of the UI<br />
<br />&gt; while viewing it? Maybe it keeps the UI a<br />
<br />&gt; bit simpler when you can&#8217;t open a ton of<br />
<br />&gt; dialogs, but as a power user i like control. </p>
<p>Good question&#8230; I guess it&#8217;s because it&#8217;s not something you generally want to see, so it&#8217;s probably not a good idea to have the window hanging around, but that is indeed an interesting edge case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148453">
				<div id="div-comment-148453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jpayne@NOSPAM.serif.com' rel='external nofollow' class='url'>Jonathan Payne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148453">
			March 1, 2004 at 4:17 am</a>		</div>

		<p>When I use the find and replace while saving feature in Notepad, the replace dialog seems to ignore the tab key while the save dialog is shown.  Odd.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148463">
				<div id="div-comment-148463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Robinson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148463">
			March 1, 2004 at 6:19 am</a>		</div>

		<p>That&#8217;s because Tab and Alt+? for a dialog are handled by calling IsDialogMessage on the HWND of that dialog.</p>
<p>Normally Notepad calls IsDialogMessage(hwndFindOrReplaceDialog) in its main message loop. But while a modal dialog is open, the main message loop isn&#8217;t running; it&#8217;s replaced by one inside the Save dialog.</p>
<p>The Save dialog doesn&#8217;t know about Notepad&#8217;s Replace dialog, so the Save dialog grabs the Tab and Alt+? keys.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148483">
				<div id="div-comment-148483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eva Douzinas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148483">
			March 1, 2004 at 7:21 am</a>		</div>

		<p>If you would like to show another application (exe) as a modal dialog, what is the signal that it is time to re-enable your window? My guess is that you would have to write some sort of hook to get the WM_CLOSE message for the apps main window, but I was wondering if there is a standard recommended approach.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148493">
				<div id="div-comment-148493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Seth McCarus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148493">
			March 1, 2004 at 7:30 am</a>		</div>

		<p>Eva, you normally wait for a process to end by starting it with CreateProcess and using one of the wait functions (e.g. WaitForSingleObject) to wait until the process handle is signalled.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148503">
				<div id="div-comment-148503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148503">
			March 1, 2004 at 8:30 am</a>		</div>

		<p>Jonathan/Tim: That&#8217;s correct. Which is why making &quot;all&quot; UI modeless is very difficult to code. It&#8217;s a very different programming model, since you have to turn everything into a state machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148513">
				<div id="div-comment-148513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eva Douzinas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148513">
			March 1, 2004 at 8:32 am</a>		</div>

		<p>Seth&#8211; if you wait for the process handle to be signaled, it is too late; the app window is already destroyed and the behavior Raymond describes happens (flicker, interloper) since the owner dialog has not been re-enabled in time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148523">
				<div id="div-comment-148523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148523">
			March 1, 2004 at 8:39 am</a>		</div>

		<p>You have to have the cooperation of the program you are launching. Anything else is just a hack.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148533">
				<div id="div-comment-148533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eva Douzinas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148533">
			March 1, 2004 at 9:21 am</a>		</div>

		<p>Raymond&#8211; can you recommend a design pattern for this (high level)? We have control over the applications we are launching. Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148543">
				<div id="div-comment-148543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148543">
			March 1, 2004 at 9:26 am</a>		</div>

		<p>Very simple. Pass the window handle to the launched process. Then the launched process passes that window handle as the owner window for its UI. If you use a system function like DialogBox(), then the proper enabling/disabling happens automatically. If you do some custom UI then you&#8217;ll have to do it manually as described above.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148563">
				<div id="div-comment-148563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">B.Y.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148563">
			March 1, 2004 at 10:16 am</a>		</div>

		<p>Maybe you can explain something I noticed when I first started windows programming, but never felt I understood it 100%: Is there any difference between a parent window and a owner window, other than a child window must be inside its parent, but owned window is not inside the owner window ? Why there&#8217;re Get/SetParent() but no Get/SetOwner() ? But in GetWindow() call, there&#8217;s GW_OWNER, but no GW_PARENT.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-148573">
				<div id="div-comment-148573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148573">
			March 1, 2004 at 10:21 am</a>		</div>

		<p>Owner and parent are very different. I have a note to explain the difference in a future entry, thanks for asking.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-148593">
				<div id="div-comment-148593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-148593">
			March 1, 2004 at 10:33 am</a>		</div>

		<p>BY: Maybe I can answer this&#8230; probably not as well as Raymond could, but here you go:</p>
<p>Parent/Child relationships are part of the window tree, and strongly determine Z-ordering. Changing the parent/child relationship immediately forces changes to the window hierarchy, and requires a re-layout of the window information (thus it&#8217;s a separate function).</p>
<p>Owner/Owned relationships aren&#8217;t part of the Window tree; they only weakly determine Z-ordering. Changing the owner of a window has no immediate effect on the layout of the windows, and as such can be left to GetWindowLong/ SetWindowLong as it doesn&#8217;t need to interface to the Window Manager.</p>
<p>At least, that&#8217;s my rather lame understanding of it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149003">
				<div id="div-comment-149003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-149003">
			March 2, 2004 at 1:31 am</a>		</div>

		<p>Regarding parent/child relationships…</p>
<p>I have once had an attempt to build an appbar stuck at the screen edge. That’s nothing really special. But I had it contain other applications’ top-level windows, those that never were designed to be, so to say, /adopted/.</p>
<p>For the most part, it worked. But it introduced all kinds of system instability.</p>
<p>I’m just curious… what evil things may happen when you take a window that was born to live free on a desktop, and SetParent it into a cage? (Not that I would want to try it again…)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-149093">
				<div id="div-comment-149093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.popcornfilms.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-149093">
			March 2, 2004 at 7:57 am</a>		</div>

		<p>The biggest problem is that activation goes all weird for that one stack of windows. </p>
<p>Heck, check out MDI; that&#8217;s pretty much the same thing you&#8217;re describing :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-159073">
				<div id="div-comment-159073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jtk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-159073">
			March 30, 2004 at 12:34 pm</a>		</div>

		<p>Raymond: I have always wondered what happened to modal dialogs in Windows 2000 (or NT 4, can&#8217;t remember for sure). When most apps show a modal dialog, clicking the owner window causes the title bar of the modal dialog to flash a few times. In some applications (like VS.NET 2003) modal dialogs still work like they always have been (no flashing). Was this change in Windows a deliberate one or is the flashing just a bug?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-159163">
				<div id="div-comment-159163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-159163">
			March 30, 2004 at 3:27 pm</a>		</div>

		<p>The flashing was a feature added to DefWindowProc, as I recall.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-159233">
				<div id="div-comment-159233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jtk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-159233">
			March 30, 2004 at 8:32 pm</a>		</div>

		<p>Any idea what&#8217;s the reason for adding this feature (flashing)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-159253">
				<div id="div-comment-159253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-159253">
			March 30, 2004 at 10:55 pm</a>		</div>

		<p>I thought it was obvious. If you click on a window that is disabled because it has a modal dialog up, it used to be that nothing happens Then you get frustrated and say, &quot;I hate Windows; it always hangs,&quot; and reboot your computer.</p>
<p>The blinking is there to say, &quot;Look over here. This is the window you want.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-182833">
				<div id="div-comment-182833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-182833">
			June 11, 2004 at 1:50 pm</a>		</div>

		<p>Commenting on this article has been closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-201363">
				<div id="div-comment-201363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/08/05/208997.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-201363">
			August 5, 2004 at 11:51 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-201393">
				<div id="div-comment-201393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/08/05/209001.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-201393">
			August 5, 2004 at 11:54 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-258213">
				<div id="div-comment-258213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2005/03/01/382380.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-258213">
			March 1, 2005 at 10:00 am</a>		</div>

		<p>Exploiting the rules for handling of the WM_QUIT message.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-438713">
				<div id="div-comment-438713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/11/02/931674.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040227-00/?p=40463#comment-438713">
			November 2, 2006 at 10:00 am</a>		</div>

		<p>Disable the owner window, but make sure it&#8217;s really the owner.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>