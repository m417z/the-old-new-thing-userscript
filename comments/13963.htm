<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (4)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-833993">
				<div id="div-comment-833993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100521-00/?p=13963#comment-833993">
			May 24, 2010 at 3:38 pm</a>		</div>

		<p>&quot;If you call SH&shy;Auto&shy;Complete a second time&quot; but MSDN says &quot;SHAutoComplete should not be called more than once with the same HWND&quot;, so is it really safe to call again or not?</p>
<div class="post">[<i>Whoa, slow down people, I have two weeks worth of updates/revisions to apply! I&#39;ve updated the article to clarify that the solution requires Windows Vista. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-834033">
				<div id="div-comment-834033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100521-00/?p=13963#comment-834033">
			May 24, 2010 at 8:10 pm</a>		</div>

		<p>&quot;That caution was written based on information I provided back in Windows XP. The memory leak was fixed in Windows Vista, but the documentation was not updated to match. So please mentally insert &quot;On versions of Windows prior to Windows Vista (and versions of Windows Server prior to Windows Server 2008)&quot; at the start of that paragraph. A doc change request has also been submitted, so hopefully the revised documentation will appear soon. &quot;</p>
<p>BTW, on the matter of this, I hate how often in recent versions of the Windows SDK the behavior in the latest version of Windows is mentioned first, then there is something like &quot;Windows Server 2003 and earlier:&quot; then the old behaviors is mentioned, often when the opposite is better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-834073">
				<div id="div-comment-834073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100521-00/?p=13963#comment-834073">
			May 25, 2010 at 12:31 am</a>		</div>

		<p>Thanks so much for that, Raymond. I was never completely happy with my solution of temporarily modifying the global setting, as I indicated in my original comment.</p>
<p>This is the kind of thing I really appreciate about this blog. Thanks again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-834153">
				<div id="div-comment-834153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100521-00/?p=13963#comment-834153">
			May 25, 2010 at 4:16 am</a>		</div>

		<p>I assume there is no undocumented WM_GETIAUTOCOMPLETE that can be used on pre Vista to get a pointer to IAutoComplete[2] to avoid the leak? I&#39;m also guessing it uses SetWindowSubclass and friends to subclass the editbox, so getting the iface pointer ourself by using a offset from the subclassproc is doubly hard (I&#39;m guessing (A lot of guessing here) this thing is in a class, called CAutoComplete or something like that probably?) Would be nice if MS documented how to do it, even if it is ugly and uses hardcoded offsets or whatever so legacy platforms don&#39;t leak.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>