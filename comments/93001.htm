<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (19)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-maurits even thread-even depth-1 parent" id="comment-1226221">
				<div id="div-comment-1226221" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226221">
			February 8, 2016 at 7:08 am</a>		</div>

		<p>Searches<br />
Windows<br />
ProgramFilesCommon<br />
MusicLibrary<br />
PublicLibraries<br />
Common Desktop<br />
CD Burning<br />
OneDriveCameraRoll<br />
SavedPicturesLibrary<br />
MAPIFolder<br />
Common Start Menu<br />
Games<br />
My Video<br />
Quick Launch<br />
ProgramFilesCommonX86<br />
OneDriveDocuments<br />
3D Objects<br />
ConnectionsFolder<br />
PrintersFolder<br />
VideosLibrary<br />
My Pictures<br />
ResourceDir<br />
Common Startup<br />
PublicGameTasks<br />
SyncSetupFolder<br />
CommonVideo<br />
Desktop<br />
History<br />
SamplePictures<br />
SyncResultsFolder<br />
ConflictFolder<br />
RecycleBinFolder<br />
OneDrive<br />
CSCFolder<br />
Ringtones<br />
Common Programs<br />
NetHood<br />
Contacts<br />
UserProgramFilesCommon<br />
Roaming Tiles<br />
Local Pictures<br />
UsersLibrariesFolder<br />
Cookies<br />
LocalizedResourcesDir<br />
CommonRingtones<br />
GameTasks<br />
Favorites<br />
Local Videos<br />
SampleMusic<br />
HomeGroupFolder<br />
SendTo<br />
PublicAccountPictures<br />
ImplicitAppShortcuts<br />
Administrative Tools<br />
My Music<br />
AddNewProgramsFolder<br />
Captures<br />
UserProfiles<br />
InternetFolder<br />
CameraRollLibrary<br />
System<br />
Programs<br />
Camera Roll<br />
UsersFilesFolder<br />
MyComputerFolder<br />
Common Administrative Tools<br />
DocumentsLibrary<br />
Application Shortcuts<br />
Recent<br />
Screenshots<br />
SavedPictures<br />
Common AppData<br />
Local AppData<br />
ThisPCDesktopFolder<br />
CommonPictures<br />
AppsFolder<br />
PrintHood<br />
Development Files<br />
Profile<br />
PhotoAlbums<br />
Downloads<br />
SampleVideos<br />
Local Music<br />
AppUpdatesFolder<br />
CommonDownloads<br />
Local Downloads<br />
OneDriveMusic<br />
Common Start Menu Places<br />
PicturesLibrary<br />
Public<br />
RecordedTVLibrary<br />
HomeGroupCurrentUserFolder<br />
LocalAppDataLow<br />
Roamed Tile Images<br />
CryptoKeys<br />
Original Images<br />
User Pinned<br />
ChangeRemoveProgramsFolder<br />
Common Documents<br />
SystemX86<br />
AccountPictures<br />
OneDrivePictures<br />
CommonMusic<br />
SearchHistoryFolder<br />
ProgramFiles<br />
Fonts<br />
Startup<br />
Recorded Calls<br />
Start Menu<br />
NetworkPlacesFolder<br />
Playlists<br />
DpapiKeys<br />
Personal<br />
OEM Links<br />
SearchHomeFolder<br />
Local Documents<br />
AppData<br />
Libraries<br />
ThisDeviceFolder<br />
SystemCertificates<br />
Links<br />
UserProgramFiles<br />
Common Templates<br />
Cache<br />
Templates<br />
Device Metadata Store<br />
ControlPanelFolder<br />
ProgramFilesX86<br />
SyncCenterFolder<br />
CredentialManager<br />
SearchTemplatesFolder<br />
SavedGames</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1226261">
				<div id="div-comment-1226261" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226261">
			February 8, 2016 at 10:52 am</a>		</div>

		<p>Noting that known folders can be <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb776910(v=vs.85).aspx" rel="nofollow">added dynamically</a>, so this list can change.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf even depth-2" id="comment-1226422">
				<div id="div-comment-1226422" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226422">
			February 9, 2016 at 9:12 am</a>		</div>

		<p>It&#8217;s a bit weird that some names use CamelCase while others use spaces.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt thread-odd thread-alt depth-1" id="comment-1226241">
				<div id="div-comment-1226241" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226241">
			February 8, 2016 at 7:30 am</a>		</div>

		<p>And for a trip down memory lane from before Vista when these things were called special folders:</p>
<p>There is no official way to get the canonical names (IIRC) but they are the same as the value names in the User Shell Folders key. You can however go from the canonical name to the path if you prefix the name with &#8220;shell:&#8221; before handing it to SHParseDisplayName.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1 parent" id="comment-1226271">
				<div id="div-comment-1226271" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226271">
			February 8, 2016 at 11:12 am</a>		</div>

		<p>â€” &#8220;Run this program and it tells you that the canonical name is Personal.&#8221;</p>
<p>LOL! There is nothing personal about &#8220;Documents&#8221; folder. It is a hybrid of &#8220;temp&#8221; folder and &#8220;AppData\Local&#8221;.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-hankhein odd alt depth-2 parent" id="comment-1226281">
				<div id="div-comment-1226281" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Henri+Hein' rel='external nofollow' class='url'>Henri Hein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226281">
			February 8, 2016 at 11:41 am</a>		</div>

		<p>What do you mean?  Few, if any, users treat &#8220;Documents&#8221; as temporary.  Temp and AppData are both personal folders.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1226292">
				<div id="div-comment-1226292" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226292">
			February 8, 2016 at 2:58 pm</a>		</div>

		<p>He means that so many programs treat it as their Temp or AppData folder, that it&#8217;s pretty much unusable as a documents folder.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt depth-3 parent" id="comment-1226311">
				<div id="div-comment-1226311" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226311">
			February 8, 2016 at 4:36 pm</a>		</div>

		<p>Right.  I keep my permanent documents in the &#8220;Documents&#8221; folder.  Temp stuff is in %appdata%\Local\temp, or  whatever magic name is given to C:\Windows\Temp.  The first one is in the %username% hierarchy but not in Documents.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-hikari even depth-4" id="comment-1226321">
				<div id="div-comment-1226321" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Crowther' rel='external nofollow' class='url'>Chris Crowther</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226321">
			February 8, 2016 at 9:13 pm</a>		</div>

		<p>I just wish more software that used %TEMP% actually cleaned up after itself.  Mine contains about a gig of data right now.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1226351">
				<div id="div-comment-1226351" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Juan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226351">
			February 9, 2016 at 5:26 am</a>		</div>

		<p>I guess that, as often happens, is something inherited from the past. &#8220;My Documents&#8221; Folder was introduced by Office for Windows 95. Windows NT had a Personal folder in the user profile. In fact if Office installation detected that it was being installed in Windows NT it used the personal folder as &#8220;My Documents&#8221; and created a new folder altogether if it detected it was being installed in Windows 9x since Windows 95 didn&#8217;t come with user profiles and only created a very basic one if a network was set up but with no security at all.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1226362">
				<div id="div-comment-1226362" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226362">
			February 9, 2016 at 5:44 am</a>		</div>

		<p>User profiles were an option in Windows 95 and they didn&#8217;t need a network.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1226382">
				<div id="div-comment-1226382" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Juan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226382">
			February 9, 2016 at 7:09 am</a>		</div>

		<p>True. I had forgotten that part.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks even depth-3 parent" id="comment-1226372">
				<div id="div-comment-1226372" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226372">
			February 9, 2016 at 7:09 am</a>		</div>

		<p>Windows 95 RTM supports (My) Documents, Desktop, Start Menu etc and AppData (but not Local AppData) and the virtual folders like My Computer, Control Panel and Recycle Bin no matter what the setup is. In single user mode these folders just live in the root of %WinDir%.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4 parent" id="comment-1226532">
				<div id="div-comment-1226532" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Juan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226532">
			February 10, 2016 at 2:30 am</a>		</div>

		<p>Windows 95 RTM did not come with the folder My documents when it came out. It was installed with Office for Windows 95 and later versions. Windows 95 OSR2 and later versions of the Windows 9x had them out of the box. Windows NT did not renamed the Personal folder to &#8220;My Documents&#8221; to match with Windows 9x until Windows 2000.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks even depth-5" id="comment-1226761">
				<div id="div-comment-1226761" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226761">
			February 12, 2016 at 6:38 am</a>		</div>

		<p>This is what I get from trusting a old MSJ article :/</p>
<p>Turns out we are both wrong. OSR2 (at least the first version) does not have a Documents folder out of the box and you cannot create one either but one noticeable change from RTM is that CSIDL_FAVORITES can now be created if you call a undocumented shell function. SHGetSpecialFolderLocation(CSIDL_FAVORITES) is unable to create it so this API only starts working after the folder exists.</p>
<p>SHGetSpecialFolderLocation(CSIDL_PERSONAL) fails with the documented and undocumented APIs on both versions when I tested on clean systems: <a href="http://i.imgur.com/uVYsrNZ.png" rel="nofollow">http://i.imgur.com/uVYsrNZ.png</a></p>
<p>I did not test to see if anything changes in multi-user mode. Maybe Raymond remembers the details?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-raykoopa odd alt thread-odd thread-alt depth-1" id="comment-1226341">
				<div id="div-comment-1226341" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ray+Koopa' rel='external nofollow' class='url'>Ray Koopa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226341">
			February 9, 2016 at 12:49 am</a>		</div>

		<p>And then there are these &#8220;developers&#8221; who don&#8217;t care at all and deal with &#8220;known folders&#8221; by abusing a specifc registry key which includes a warning to not use it by _someone_&#8230; ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1226413">
				<div id="div-comment-1226413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226413">
			February 9, 2016 at 8:37 am</a>		</div>

		<p>Raymond,<br />
You seem to mix-n-match your api-idioms.  Is there a reason why?</p>
<p>After starting with CComPtr, you use win32-Api  ::CoCreateInstance instead of CComPtr::CoCreateInstance.<br />
I generally feel that if you&#8217;re going adopt a tool/feature/library (like CComPtr), you should generally go all-in on it, or not use it at all.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1226431">
				<div id="div-comment-1226431" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226431">
			February 9, 2016 at 10:17 am</a>		</div>

		<p>I neglected to mention that the dice roll specifically picked ATL 2.1, which doesn&#8217;t support CComPtr.CoCreateInstance. (This is actually a lie, because ATL 2.1 doesn&#8217;t have atlalloc.h. The real reason is that I learned ATL with ATL 2.1, so I always forget that there is a CoCreateInstance method directly on CComPtr.)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1226451">
				<div id="div-comment-1226451" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160208-00/?p=93001#comment-1226451">
			February 9, 2016 at 11:55 am</a>		</div>

		<p>Thank you!  I wasn&#8217;t aware that CoCreateInstance ever *wasn&#8217;t* part of CComPtr, as it seems so essential.   But I can see how old habits die hard. :)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>