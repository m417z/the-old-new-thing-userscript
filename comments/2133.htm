<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (21)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1098253">
				<div id="div-comment-1098253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098253">
			January 8, 2014 at 7:31 am</a>		</div>

		<p>Didn&#39;t they test their own code?</p>
<div class="post">[<em>They probably tested on a system with fewer than 5 context menu extensions. &quot;We left room for five!&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098273">
				<div id="div-comment-1098273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098273">
			January 8, 2014 at 8:41 am</a>		</div>

		<p>So you think that this may have been on purpose (&quot;We checked many files on our system, and none of them have more than 5 context menu verbs&quot;)?</p>
<div class="post">[<em>No, not on purpose. But if you don&#39;t test the case where the problem occurs, then testing won&#39;t find the problem. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1098283">
				<div id="div-comment-1098283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Katie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098283">
			January 8, 2014 at 8:43 am</a>		</div>

		<p>Who knows how they ended up with the big number, but I&#39;m amused at the thought that their first tests failed, but they decided that other third-party extensions were the problem. After all, their code works on a fresh install, but then breaks when you install other extensions!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098293">
				<div id="div-comment-1098293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098293">
			January 8, 2014 at 9:00 am</a>		</div>

		<p>@Katie</p>
<p>You&#39;d might be sad to discover that that&#39;s how 99% of QA works&#8230;</p>
<p>&quot;It works on a clean VM with literally nothing other than the OS and our product installed, so clearly there&#39;s nothing wrong with our product!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1098303">
				<div id="div-comment-1098303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098303">
			January 8, 2014 at 9:16 am</a>		</div>

		<p>[They probably tested on a system with fewer than 5 context menu extensions. &quot;We left room for five!&quot; -Raymond]</p>
<p>Apparently their source control system doesn&#39;t have a shell plugin then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098323">
				<div id="div-comment-1098323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098323">
			January 8, 2014 at 9:47 am</a>		</div>

		<p>@Joshua That&#39;s assuming they&#39;re using source control at all, a fact not currently in evidence.</p>
<p>Personally I was guessing they were just returning stack garbage that happened to have a consistent value by accident. But I think it&#39;s funnier that they would carefully leave 5 slots for any extensions that might come after them in the shell&#39;s asking order. Although I&#39;m kind of surprised that the built-in verbs like Open wouldn&#39;t always be first to protect from this case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-1098333">
				<div id="div-comment-1098333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098333">
			January 8, 2014 at 10:56 am</a>		</div>

		<p>Explorer could do with a &quot;no addons&quot; mode for troubleshooting problematic shell extensions like Internet Explorer has for addons. And an official shellex manager to enable/disable them too. Then again not a chance of this happening as now we&#39;re in the age of uber dumbed down UIs &#8211; something like this would be offering too much power/control over the system to the end user. Microsoft can&#39;t have users having that much control!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098343">
				<div id="div-comment-1098343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098343">
			January 8, 2014 at 11:32 am</a>		</div>

		<p>&quot;Uninstalling the buggy shell extension fixed the problem.&quot;</p>
<p>Ah, the &quot;And they lived happily ever after&quot; ending for the vast majority of Explorer problems :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1098353">
				<div id="div-comment-1098353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098353">
			January 8, 2014 at 11:48 am</a>		</div>

		<p>@Paul @Joshua</p>
<p>That&#39;s also assuming that anyone actually uses the shell extension for source control, which isn&#39;t likely.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098363">
				<div id="div-comment-1098363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098363">
			January 8, 2014 at 11:54 am</a>		</div>

		<p>Well, why does the shell allow this? Why doesn&#39;t it handle this functionality? e.g. &quot;give me some menu text to display and a command and I&#39;ll add it to the context menu for you&quot;. This way you can&#39;t claim 29990 empty slots. You just get what you ask for in terms of filled items. Or why doesn&#39;t the shell check after addition how many entries actually have been added and reclaims the unused ones? Or simply use a safe limit of 100 or so per extension? (I&#39;ve never seen an extension use more than, say, 20 or 30 entries.)</p>
<div class="post">[<em>How would you reclaim an unused one? Maybe it&#39;s not currently used but will be added dynamically later? At any rate, shell extensions run with full trust (since they run in-process) so there is a limit to what you can do to stop them from doing bad things. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1098373">
				<div id="div-comment-1098373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098373">
			January 8, 2014 at 12:07 pm</a>		</div>

		<p>@KS: probably because features are not implemented by default. Why does my car allow me to open the door while I&#39;m driving at 50 mph?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008794c744 odd alt thread-odd thread-alt depth-1" id="comment-1098383">
				<div id="div-comment-1098383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Wisefaq' rel='external nofollow' class='url'>Wisefaq</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098383">
			January 8, 2014 at 12:31 pm</a>		</div>

		<p>@Anon</p>
<p>[&quot;It works on a clean VM with literally nothing other than the OS and our product installed, so clearly there&#39;s nothing wrong with our product!&quot;]</p>
<p>That&#39;s how you package an application up for distribution. &nbsp;That way you catch any unexpected dependencies (for example .Net). &nbsp;You then test on a representative sample of PCs in the field, which is what I guess is the point you were getting at.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1098403">
				<div id="div-comment-1098403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098403">
			January 8, 2014 at 1:02 pm</a>		</div>

		<p>@Anon: &quot;That&#39;s also assuming that anyone actually uses the shell extension for source control, which isn&#39;t likely.&quot;</p>
<p>What? Tortoise{SVN,Git} is awesome! And yeah, you can easily wind up with several context menu entries from them.</p>
<p>(Probably the other TortoiseBlahs are too, but besides TortoiseCVS which sucks because it&#39;s building on something that sucks, I haven&#39;t used them.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098413">
				<div id="div-comment-1098413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Hagan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098413">
			January 8, 2014 at 1:02 pm</a>		</div>

		<p>@Wisefaq: Yes, and I was reading only last week that the &quot;Client Profile&quot; was dropped from .NET 4.5 (so only the &quot;full&quot; installer exists) because MS found that so many people were shipping the CP when they actually had dependencies that required the full version. One has to presume that these were all tested only on unclean machines (probably the developer&#39;s) because the problem shows up 100% reliably as &quot;won&#39;t even run&quot; if you install it on a clean machine.</p>
<p>There appears to be no limit to how bad programmers can be and still earn a living.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1098453">
				<div id="div-comment-1098453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098453">
			January 8, 2014 at 8:19 pm</a>		</div>

		<p>@xpclient: You can run Autoruns from SysInternals Suite to disable all non-Microsoft extensions then enable it one by one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098463">
				<div id="div-comment-1098463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098463">
			January 8, 2014 at 9:22 pm</a>		</div>

		<p>Evan: I&#39;m assuming that Anon meant that the developer of the culprit shell extension likely doesn&#39;t use source control. I figured it&#39;s safe to assume that the sort of people who write buggy shell extensions like that also don&#39;t use source control.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-1098473">
				<div id="div-comment-1098473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098473">
			January 9, 2014 at 3:53 am</a>		</div>

		<p>@cheong00, sure there is and there&#39;s also Nirsoft&#39;s Shellexview :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1098483">
				<div id="div-comment-1098483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098483">
			January 9, 2014 at 4:53 am</a>		</div>

		<p>@Ken Hagan, or the IT department won&#39;t allow the programmer to do its job: <a rel="nofollow" target="_new" href="http://search.dilbert.com/comic/Mordac%20The%20Preventer">search.dilbert.com/&#8230;/Mordac%20The%20Preventer</a> (it&#39;s actually quite sad how real this is&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1098493">
				<div id="div-comment-1098493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesNT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098493">
			January 9, 2014 at 6:36 am</a>		</div>

		<p>There are days when it really wouldn&#39;t hurt my feelings if MS banned third-party shell extensions. &nbsp;Of course, I realize this might be a case of the cure being worse than the disease, but still&#8230;</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-davebacher odd alt thread-odd thread-alt depth-1" id="comment-1098753">
				<div id="div-comment-1098753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dave+Bacher' rel='external nofollow' class='url'>Dave Bacher</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098753">
			January 9, 2014 at 4:27 pm</a>		</div>

		<p>@xpclient:</p>
<p>Actually, what I&#39;d like to see copied is Internet Explorer/Chrome/Firefox&#39;s &quot;click-to-run.&quot;</p>
<p>E.G.:</p>
<p>The plug-in &quot;Crash-You&quot; from &quot;Contoso, LLC&quot; is now available for use. [Enable] [Disable]</p>
<p>Basically, a proxy that returns E_ACCESS_DENIED or w/e by default &#8212; some signal to Internet Explorer that &quot;hey, this hasn&#39;t been approved yet.&quot; &nbsp;When the user clicks Enable, then do the initialization. &nbsp;To see what I&#39;m talking about, take a clean Windows 8.1 machine and install Skype desktop &#8212; when you start Internet Explorer, you&#39;ll get a prompt:</p>
<p>The plug-in &quot;Click to Call&quot; from &quot;Microsoft Corporation&quot; is now available. [Enable] [Disable]</p>
<p>Similarly, it would be nice on startup for Explorer to break down what&#39;s slowing it down. &nbsp;For example, Tortoise Git actually has a measurable impact on startup.</p>
<p>As for how this happens, I think I&#39;ve been at that meeting&#8230;</p>
<p>Alice&gt; We need to write some context menu options for Super Fabrikam Pro Ultra Mega Edition</p>
<p>Bob&gt; Does anyone use those anyway?</p>
<p>Alice&gt; Well, our metric server has been offline and the IP address in our &quot;A&quot; record&#39;s been pointed at some server in China, so we don&#39;t actually have metrics or crash reports so&#8230; we&#39;ll just assume yes.</p>
<p>Bob&gt; Oh, OK, that sounds like a reasonable plan.</p>
<p>Alice&gt; So Microsoft makes us say how many we need, how many should I report?</p>
<p>Bob&gt; Well lets make an option screen, and on there let the user pick from a bunch of checkboxes which options they want to appear, and in what order. &nbsp;Lets have a plethora of checkboxes, everyone loves checkboxes.</p>
<p>Alice&gt; Sure! &nbsp;sounds good, so what number do we give?</p>
<p>Bob&gt; I&#39;m pretty sure it doesn&#39;t matter, what&#39;s the upper limit?</p>
<p>Alice&gt; It says here 30000.</p>
<p>Bob&gt; OK, so we&#39;ll tell them 29995. &nbsp;That&#39;ll be a good compromise.</p>
<p>Alice&gt; Awesome, 29995 it is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1098583">
				<div id="div-comment-1098583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KlimaxDanielix</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140108-00/?p=2133#comment-1098583">
			January 9, 2014 at 9:41 am</a>		</div>

		<p>I have Tortoise*, where * stands for CVS, SVN, GIT, Bazaar, Hg. Sometimes standard 17&#39; has insufficient height for entire Context Menu&#8230; :D</p>
<p>(+few more extensions.)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>