<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (29)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-926503">
				<div id="div-comment-926503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Helge Klein</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926503">
			July 25, 2011 at 7:17 am</a>		</div>

		<p>For once, I wrote about something before Raymond ;-) Here is my take on App Paths: <a rel="nofollow" target="_new" href="http://helgeklein.com/blog/2010/08/how-the-app-paths-registry-key-makes-windows-both-faster-and-safer/" rel="nofollow">helgeklein.com/&#8230;/how-the-app-paths-registry-key-makes-windows-both-faster-and-safer</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926523">
				<div id="div-comment-926523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926523">
			July 25, 2011 at 7:38 am</a>		</div>

		<p>I always wondered why there was no pbrush.exe stub for old programs. &nbsp;Now I know why&#8230; shellexecute will still work for legacy apps that want to launch paint.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926533">
				<div id="div-comment-926533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926533">
			July 25, 2011 at 7:41 am</a>		</div>

		<p>Raymond, do you frown upon what the PBrush folks used App Paths for?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926543">
				<div id="div-comment-926543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">VirtualBlackFox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926543">
			July 25, 2011 at 7:42 am</a>		</div>

		<p>Sadly as the console doesn&#39;t support them command line programs still need to rely on PATH and expose all files in their directories (As they did for years anyway)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-joshuaganes even thread-even depth-1" id="comment-926553">
				<div id="div-comment-926553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Joshua+Ganes' rel='external nofollow' class='url'>Joshua Ganes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926553">
			July 25, 2011 at 7:50 am</a>		</div>

		<p>You mention that this will not work if you call CreateProcess or similar. Was this intentional? If so, was it to address compatibility, to save development time, or was it a technical limitation?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926563">
				<div id="div-comment-926563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926563">
			July 25, 2011 at 8:15 am</a>		</div>

		<p>As you probably know, cmd.exe resolves App Paths as well. It&#39;s obviously not using ShellExecute as it passes command lines.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926573">
				<div id="div-comment-926573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MikeCaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926573">
			July 25, 2011 at 8:22 am</a>		</div>

		<p>Joshua &#8211; my guess is to prevent something like</p>
<p>CreateProcess(&quot;myHelper.exe&quot;);</p>
<p>from executing &quot;C:someOtherProgrammyHelper.exe&quot; rather then their own &quot;myHelper.exe&quot;. (If you are using ShellExecute, it implies that you&#39;re executing an action like a User would. If you&#39;re using CreateProcess, you&#39;re executing an action like a cold, unfeeling program which is expected to supply the full path)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926583">
				<div id="div-comment-926583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926583">
			July 25, 2011 at 8:30 am</a>		</div>

		<p>@VirtualBlackFox: that&#39;s what the START built-in is for. I think it&#39;s been around since Windows 95, same as app paths (but I might be wrong).</p>
<p>@Joshua (2nd): I don&#39;t know what cmd.exe you&#39;re using, but mine doesn&#39;t resolve App Paths if I just enter an executable name. What cmd.exe does do (even without START) is launch documents based on their extensions, but this requires that the document in question is on the search path.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926593">
				<div id="div-comment-926593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926593">
			July 25, 2011 at 8:54 am</a>		</div>

		<p>@Mike Caron: Except that (at least according to Helge Klein&#39;s post) &#39;App Paths&#39; is the last place consulted for &#39;myHelper.exe&#39;.</p>
<p>It also has the (unfortunate?) side effect that App Paths is apparently not consulted when running a program from cmd.exe (try running pbrush from there).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chuckop odd alt thread-odd thread-alt depth-1" id="comment-926603">
				<div id="div-comment-926603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/ChuckOp' rel='external nofollow' class='url'>ChuckOp</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926603">
			July 25, 2011 at 9:19 am</a>		</div>

		<p>Presumably you don&#39;t want to mess with console behavior with something that is very specific to Windows and the shell.</p>
<p>You can get the behavior in the console by using the START command:</p>
<p>cd</p>
<p>REM This won&#39;t work</p>
<p>wordpad.exe</p>
<p>REM This will work</p>
<p>start wordpad.exe</p>
<p>[Second attempt to post comment]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926613">
				<div id="div-comment-926613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926613">
			July 25, 2011 at 9:53 am</a>		</div>

		<p>Fortunately 4NT at least handles AppPaths. &nbsp;I actually didn&#39;t know that pbrush was a &quot;redirect&quot; to mspaint.exe, but lo and behold, I type in &quot;which pbrush&quot; in 4NT this morning and it prints out &quot;pbrush is an external : C:WINDOWSsystem32mspaint.exe&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926623">
				<div id="div-comment-926623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926623">
			July 25, 2011 at 10:33 am</a>		</div>

		<p>App paths is one of the coolest features in Windows and Microsoft has done a very poor job of making developers and users aware of it. Also, one strange thing is I see environment variables for system predefined paths but the paths I define myself don&#39;t support environment variables? I can&#39;t use %ProgramFiles%. One has to use absolute paths or Program Files but .. works only if Program Files is on your system drive.</p>
<div class="post">[<i>Did you remember to set the type to REG_<span style="color:#ff0000;">EXPAND</span>_SZ? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926633">
				<div id="div-comment-926633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926633">
			July 25, 2011 at 10:50 am</a>		</div>

		<p>The easiest way to start WordPad is to just run &quot;write&quot; &#8212; it even works from the command line or CreateProcess!</p>
<p>This works because the Windows 3.x and earlier &quot;word processor&quot; was called Write.exe, so apps that displayed READMEs and such expected to be able to run WindowsWrite.exe (or the WindowsSystem32 version). When Win95 came around and replaced Write with WordPad, they made Write a stub that just invokes WordPad so as not to break everything that hardcoded one of those paths.</p>
<p>It&#39;s so convenient (only 5 letters instead of 7) that to this day I only ever type &quot;write&quot; instead of &quot;wordpad&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926643">
				<div id="div-comment-926643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926643">
			July 25, 2011 at 11:31 am</a>		</div>

		<p>&quot;Did you remember to set the type to REG_EXPAND_SZ&quot;</p>
<p>Oops yes of course! Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926673">
				<div id="div-comment-926673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926673">
			July 25, 2011 at 3:06 pm</a>		</div>

		<p>Oops, Gabe was actually saying something completely different, sorry!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926683">
				<div id="div-comment-926683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926683">
			July 25, 2011 at 5:17 pm</a>		</div>

		<p>Of course, if the comment software eats my comment, I don&#39;t need to apologise anyway. (I was apologising for posting a comment that misunderstood him slightly.)</p>
<p>My comment was: App Paths were useful back on XP for running things quickly. I tended to use &quot;winword&quot; to run Word and &quot;excel&quot; to (duh) run Excel. They&#39;re pretty redundant now, for users at least, with the new start menu. I can just type &quot;word&quot; or even &quot;wo&quot; and Windows guesses the right shortcut.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt even thread-even depth-1" id="comment-926693">
				<div id="div-comment-926693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926693">
			July 25, 2011 at 7:01 pm</a>		</div>

		<p>Back in the MS-DOS days I was bitten myself a few times by issues with apps writing to autoexec.bat to add themselves to the path. &nbsp;Games were infamaous for doing this. &nbsp;The most common issue I had was paths that were to long.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926703">
				<div id="div-comment-926703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926703">
			July 25, 2011 at 11:02 pm</a>		</div>

		<p>I think the reason CreateProcess() doesn&#39;t respect App Paths is becuase of the layering thing. CreateProcess, along with many others (Thread, File, etc) is a kernel level API call. You&#39;re aking the kernel to do the task directly, and the kernel has no idea about the fancy things everyone on top uses. It just loads a file and attempts to execute it through the loader.</p>
<p>ShellExecuteEx though, uses the shell conventions, so it can launch documents and other non-executables by using the shell-specific registrations that map documents to applications, app paths, etc. Once it finds the proper command line, ShellExecuteEx passes the kernel a proper command via CreateProcess&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926713">
				<div id="div-comment-926713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ultramage</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926713">
			July 26, 2011 at 6:21 am</a>		</div>

		<p>Wow, thank you so much for this post! All these years I&#39;ve been filling my PATH variable with packages like svn, php, perl, python, and cygwin &#8211; whose installation instructions are just &quot;add directory to PATH&quot;. This will also help prevent dlls shipped with these apps from leaking everywhere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926723">
				<div id="div-comment-926723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926723">
			July 26, 2011 at 7:28 am</a>		</div>

		<p>Chuck Norris can solve the Halting Problem. He will halt the machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926823">
				<div id="div-comment-926823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">about:blank</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926823">
			July 26, 2011 at 10:07 am</a>		</div>

		<p>The Run dialog needs a &quot;Run as administrator privileges&quot; checkbox to be useful to launch programs under Vista/7.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926883">
				<div id="div-comment-926883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926883">
			July 26, 2011 at 11:54 am</a>		</div>

		<p>I don&#39;t think you have to solve the HP. You already know that Windows is running, i.e. autoexec.bat did halt in some way. It would of course still be very much non-trivial and the wrong way to do things.</p>
<p>(Although I&#39;m not sure if I anger you by posting this. You seem to be irritated by YB posting OT side remarks, the nitpicker&#39;s corner might really upset you??)</p>
<div class="post">[<i>You&#39;re assuming nobody has edited autoexec.bat since boot. (And that the user did not perform a Shift+F8 step-by-step boot.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926903">
				<div id="div-comment-926903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926903">
			July 26, 2011 at 12:20 pm</a>		</div>

		<p>@about:blank :</p>
<p>Unless you need a browse button, just use the search box in the start menu. Anything you type into Run will work there too (though it could potentially do something different, if there&#39;s a conflict). In fact even browsing for is faster there really (try typing &quot;C:&quot; and using the arrow keys). Plus it&#39;s one less keystroke to get there!</p>
<p>The punchline is, if you didn&#39;t already know, running something from the search box by pressing shift+enter instead of just enter runs as admin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-926923">
				<div id="div-comment-926923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926923">
			July 26, 2011 at 1:11 pm</a>		</div>

		<p>@AC</p>
<p>There are times when I think Mr. Chen does enjoy calling people out on some of the more &quot;special&quot; things they say. &nbsp;However, there are times he is obviously irritated. &nbsp;One never knows regarding one with the personality of a thermonuclear device. &nbsp;:)</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-926933">
				<div id="div-comment-926933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926933">
			July 26, 2011 at 2:10 pm</a>		</div>

		<p>Jim: Do you mean Ctrl+Shift+Enter? Just Shift+Enter doesn&#39;t do anything different for me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-926983">
				<div id="div-comment-926983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kelden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-926983">
			July 27, 2011 at 1:15 am</a>		</div>

		<p>Why is PowerShell set in the PATH then?</p>
<p>On every new installation of Windows (7 tested), I have</p>
<p>C:WindowsSystem32WindowsPowerShellv1.0</p>
<p>in my PATH</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927063">
				<div id="div-comment-927063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">benjamin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-927063">
			July 27, 2011 at 9:24 am</a>		</div>

		<p>@Gabe: I do the same thing with pbrush. I still call MS Paint &#39;Paintbrush&#39; anyway.</p>
<p>Of course, I also still close windows by double-clicking the top left, so maybe I&#39;m just set in my ways.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927143">
				<div id="div-comment-927143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-927143">
			July 27, 2011 at 11:22 am</a>		</div>

		<p>Gabe: Oops, you&#39;re right, thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927453">
				<div id="div-comment-927453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110725-00/?p=10073#comment-927453">
			July 29, 2011 at 5:12 am</a>		</div>

		<p>What happens if I were to write my new super text editor and decide to call it WORDPAD.EXE and try to set its App Path? &nbsp;Would registration fail or would it register but only ever find MS WORDPAD.EXE as it was registred first?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>