<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (8)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-koldude even thread-even depth-1" id="comment-1281356">
				<div id="div-comment-1281356" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281356">
			January 25, 2017 at 7:42 am</a>		</div>

		<p>To make this more <em>FUN</em> <code>_lock</code> and <code>_unlock</code> are removed as of VS2015.  VS2017 does implement <code>threads.h</code> so there is a platform independent way to synchronize in C on windows via <code>mtx_lock</code>. That said this seems like an X/Y problem overall, so all of that is irrelevant.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1281365">
				<div id="div-comment-1281365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.silverbacknetworks.tech' rel='external nofollow' class='url'>Joshua Bowman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281365">
			January 25, 2017 at 7:54 am</a>		</div>

		<p>You do  what you can, and then you let your children go to bump their heads in their own ways, unfortunately.</p>
<p>HeapLock sounds like a fun constant, now it&#8217;s time to find all the ways I can insert it in old code to give maintainers a heart attack. :D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1281375">
				<div id="div-comment-1281375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281375">
			January 25, 2017 at 8:16 am</a>		</div>

		<p>&#8220;Even in that case, you need to be careful if the inspecting process requires locks that may be owned by the process being inspected, such as shared mutexes.&#8221;</p>
<p>This reminds me how debugging any process using WININET.DLL was a nightmare because it would deadlock the debugger (which tried to download symbols using the same DLL).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1281425">
				<div id="div-comment-1281425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://nbtparse.org' rel='external nofollow' class='url'>Kevin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281425">
			January 25, 2017 at 1:27 pm</a>		</div>

		<p>&gt; because it is an application requirement.³</p>
<p>&gt; ³ This sounds like a circular argument, but hey.</p>
<p>Ha.</p>
<p>In context, it sounds like what they meant to say was &#8220;Under the current design, we use the thread suspension to implement feature X, which is an application requirement.  Changing our design to avoid thread suspension, while still providing feature X, costs more than our budget for this bug (and may be wholly infeasible without a complete rewrite).&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao even thread-even depth-1" id="comment-1281475">
				<div id="div-comment-1281475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281475">
			January 25, 2017 at 9:25 pm</a>		</div>

		<p>FYI, I actually checked and in the release version of the universal CRT, they just use HeapAlloc anyway and only resort to alternatives if that fails.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1281495">
				<div id="div-comment-1281495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281495">
			January 25, 2017 at 10:50 pm</a>		</div>

		<p>And another story in the unending annals of people who have no clue about concurrent programming trying to do so anyhow..</p>
<p>The state of this industry is depressing sometimes.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1281505">
				<div id="div-comment-1281505" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281505">
			January 26, 2017 at 1:25 am</a>		</div>

		<p>That&#8217;s what happens when you say &#8220;everyone can code.&#8221;. No, not everyone can. And even then, mastering things such as concurrent programming is not an easy task.</p>
<p>As a result, badly written software (or languages, like *cough* PHP *cough* ) which should never have been written are set as standards, making people miserable.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-deltics odd alt depth-3" id="comment-1281545">
				<div id="div-comment-1281545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Deltics' rel='external nofollow' class='url'>Deltics</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170125-00/?p=95255#comment-1281545">
			January 26, 2017 at 4:51 pm</a>		</div>

		<p>&#8230; which is when someone comes along and says &#8220;we can make this hard stuff easy for everyone.  Just use this framework/library/toolkit/whatever.  No understanding required.&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>