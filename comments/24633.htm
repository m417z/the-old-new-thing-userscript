<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (68)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-563903">
				<div id="div-comment-563903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-563903">
			October 31, 2007 at 10:09 am</a>		</div>

		<p>Well, usually I agree with you on these things&#8230; but this one is a borderline case that IMO falls on the wrong side of the line.</p>
<p>I sometimes save web page for later rapid and easy consultation. I don&#8217;t expect that HTML will gain extraordinary power and pose a security risk just because I saved it on my computer.</p>
<p>I think Microsoft should consider wrapping saved web pages the same way they wrap executable saved from the web, with at least a warning when I open it again or, better still, a wrapper that sets the trust level of IE to the same trust level that was in effect when the page was saved.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-563943">
				<div id="div-comment-563943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Name required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-563943">
			October 31, 2007 at 11:07 am</a>		</div>

		<p>Absolutely agree with Pierre. If there&#8217;s the possibility of something bad happening off a saved web page (or an html attachment sent via email?) then that&#8217;s A Bad Thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-563953">
				<div id="div-comment-563953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dal' rel='external nofollow' class='url'>dalevine@ra.rockwell.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-563953">
			October 31, 2007 at 11:12 am</a>		</div>

		<p>Rather then argue that a user should reason like a computer, a better case can be made that the computer should reason like the user.</p>
<p>For eaxmple, build protection into the executable and file system so that the OS &quot;knows&quot; where the file came from and how it got there and limit what it can do accordingly.</p>
<p>To the user it&#8217;s the same file, and she doesn&#8217;t need or want to know how or why clicking a file/link makes it appear on the screen. The mechanics of what makes it appear on the screen is an implementation detail. The user expects it to behave correctly in all cases.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-563973">
				<div id="div-comment-563973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-563973">
			October 31, 2007 at 11:20 am</a>		</div>

		<p>I agree with Raymond; if you bring the horse into your city, it&#8217;s your responsibility, not Microsofts.</p>
<p>Same as executables, I guess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-563993">
				<div id="div-comment-563993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-563993">
			October 31, 2007 at 11:56 am</a>		</div>

		<p>I, as well, strongly disagree that Microsoft should manage our offline content. &nbsp;I agree with Raymond&#8217;s assessment.</p>
<p>There&#8217;s a stark and substantial difference between running a saved webpage (which average users do not do) and running an exe file (which nearly every single user ever to touch the internet has done).</p>
<p>I think that difference is really important.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564003">
				<div id="div-comment-564003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skywing</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564003">
			October 31, 2007 at 12:22 pm</a>		</div>

		<p>dalevine: IE and the shell already do this. &nbsp;That&#8217;s why you get the additonal confirmation dialog when initially you try to launch a program that you saved via IE on XPSP2. &nbsp;(This feature requires NTFS to operate and will not necessarily be visible to programs that do not call upon the shell to launch programs.)</p>
<p>Ironically, it seems that people frequently bemoan this feature as useless and annoying. &nbsp;I suppose that you&#8217;re damned if you do and damned if you don&#8217;t? :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564013">
				<div id="div-comment-564013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564013">
			October 31, 2007 at 12:26 pm</a>		</div>

		<p>Some suggestions about security boundaries here are utterly stupid. Websites might contain resources likke images, frames, style sheets etc., so when locally saved, the website should be generally able to read local files. For the same reasons, it should be able to request dynamic resources from webservers.</p>
<p>It can abused this privilege to read arbitrary text files, get their content using .innerHTML, and submit it to a webserver. There&#8217;s no way around: Locally saved websites are more powerful, and that&#8217;s exactly why one should never open an website from an untristed source from a local storage. Competent user know that and respect that &#8211; those who don&#8217;t shouldn&#8217;t complain, because it&#8217;s solely there fault.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564023">
				<div id="div-comment-564023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.einsteintech.net' rel='external nofollow' class='url'>Josh Einstein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564023">
			October 31, 2007 at 12:28 pm</a>		</div>

		<p>I&#8217;m kind of on the border with this. Because it&#8217;d be pretty easy for an app hosting IE to use it irresponsibly. For example, you could envision a mail application that uses Shdocvw to render an email message that it had saved locally to a temp directory. Now perhaps IE considers the temp directory a danger zone, so I don&#8217;t know.</p>
<p>I just know that IE has come under alot of fire for things that really aren&#8217;t &quot;flaws&quot; just things that appear to be dangerous. The problem is we&#8217;re (well, not me) struggling to make the web work more and more like the desktop (again) and all we&#8217;re really doing is running client apps in more complex configurations inside of an activex host. Time to give up the love affair with web apps and focus on better client-side deployment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564033">
				<div id="div-comment-564033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jess Sightler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564033">
			October 31, 2007 at 12:33 pm</a>		</div>

		<p>I&#8217;m not sure who to agree with on this one, as I don&#8217;t fully understand how this &quot;exploit&quot; would happen.</p>
<p>In my experience, IE gives a stern warning and requires you to click through a &quot;this could be unsafe&quot; dialog to run any scripting from a local file.</p>
<p>Why would this case have been any different?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564043">
				<div id="div-comment-564043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew Feldstein</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564043">
			October 31, 2007 at 12:40 pm</a>		</div>

		<p>But users don&#8217;t think of or treat web pages the same as executables&#8211;they aren&#8217;t &quot;programs&quot; in most most users&#8217;s minds.</p>
<p>The web page attached to an email is a good example. &nbsp;(An email comes from the internet too, right?) &nbsp;Why should clicking the link in an email be treated differently than clicking a link in a browser&#8211;it&#8217;s the same action, just executed from within different programs.</p>
<p>The sublety of it mattering what program you&#8217;re running when you&#8217;re performing an action like clicking&#8211;which is &quot;safe&quot; in one place and not in the other&#8211;is beyond most of us.</p>
<p>So I vote with Pierre too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564053">
				<div id="div-comment-564053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564053">
			October 31, 2007 at 12:49 pm</a>		</div>

		<p>I thought IE now goes nuts on ActiveX from anywhere. &nbsp;Anyhow, I think this is mitigated by running IE in a serious sandbox, which on XP is doable with the &quot;DropMyRights&quot; app I found on MSDN. &nbsp;Vista always does it by default now for IE7. &nbsp;(Even if you&#8217;re running as a limited user, you can always clamp down even tighter. &nbsp;This isn&#8217;t limited to IE, mind you, I&#8217;ve run IM programs and the much vaunted FireFox in sort of thing.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564063">
				<div id="div-comment-564063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yosi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564063">
			October 31, 2007 at 12:51 pm</a>		</div>

		<p>Raymond is wrong. This is typical for MS to miss a point in security features.</p>
<p>I never expect web page behave differently just because I saved it on my local disk. Raymond&#8217;s explanation is complete WTF.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564073">
				<div id="div-comment-564073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://michael.carbenay.info' rel='external nofollow' class='url'>mcarbenay</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564073">
			October 31, 2007 at 12:52 pm</a>		</div>

		<p>Errr&#8230; isn&#8217;t IE already lowering the trust level of some types of local web pages ? For example, when I look to a xml file from my computer, IE blocks the javascript of the default style (which is quite annoying&#8230;).</p>
<p>Doesn&#8217;t IE do the same for a scripting-unsafe activeX control ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-564093">
				<div id="div-comment-564093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564093">
			October 31, 2007 at 1:16 pm</a>		</div>

		<p>Wow, lots of you asking for a feature that already exists. It&#8217;s called &#8216;Mark Of The Web&#8217;. When you save this page in IE, it adds a comment to the top of the page saying</p>
<p>&lt;!&#8211; saved from url=(0055)<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/comments/5788080.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/comments/5788080.aspx</a> &#8211;&gt;</p>
<p>When you open the saved file in IE, it uses this information to compute which zone the page was in. Try it: watch the zone indicator in the bottom-right corner. Save this page, reopen it, and you&#8217;ll see that you&#8217;re still in the Internet zone. IE applies the security settings from the correct zone and therefore won&#8217;t initialize something not marked safe-for-scripting. So just saving the page will not allow the security barrier to be breached.</p>
<p>Mark Of The Web has been in IE since version 4.0 according to <a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/ms537628.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/ms537628.aspx</a>. IE 6.0 SP2 (in XP SP2) adds support for it to Multipart HTML (.mht) files, which store a web page and the images and scripts it refers to as a single file.</p>
<p>IE6 SP2 added Local Machine Lockdown which turns off all scripting support, but this feature can be turned off and often is by web developers. This was added as a mitigation for a lot of attacks which forced the browser into the Local Machine zone. If you want to force your page running from a file URL into a different zone you can add a MOTW to the page.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564103">
				<div id="div-comment-564103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564103">
			October 31, 2007 at 1:16 pm</a>		</div>

		<p>Perhaps one solution is for web browsers to have a &quot;Save an Sanitise&quot; command which strips out scripts and so on before saving a basic version of the rendered page to disk. Most of the time when I save a webpage I just want to be able to read what&#8217;s on the screen later without worrying whether the web server/page is still up or running slowly and this would solve that problem while removing all risks. (I&#8217;d be happy with a big &quot;screenshot&quot; of the page provided I could copy &amp; paste text from it.)</p>
<p>I&#8217;m a technical user but I never thought about this before and have saved and later double-clicked lots of web pages without realising the risk. It&#8217;s obvious now that it has been pointed out, of course, but I bet many people don&#8217;t realise it.</p>
<p>HTML seems fairly unique in this context. If you download a JPEG or an MP3 and double-click it later then it&#8217;s treated as data, not code, and is harmless (unless there&#8217;s a buffer-overflow bug in the program handling the data). HTML feels like data to most people most of the time but obviously can contain code/scripts.</p>
<p>I think, as other people have said, IE7 does warn about ActiveX objects for local HTML files, though. I have to click a pop-up every time I test a local copy of a page of mine which uses Flash.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564113">
				<div id="div-comment-564113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564113">
			October 31, 2007 at 1:21 pm</a>		</div>

		<p>For most people a web page is not an application.</p>
<p>And MS is the only one running executables from a web page. If I save a web page from Firefox and view it later, nothing happens.</p>
<p>ActiveX was a bad idea, still is, and MS is the only one implementing it.</p>
<div class=post>[<i>Shhh, don&#8217;t tell anyone that Firefox can run Flash. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564133">
				<div id="div-comment-564133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564133">
			October 31, 2007 at 1:34 pm</a>		</div>

		<p>Well if stuff in the cache counts as &quot;on the local computer&quot; then clicking the &quot;work offline&quot; button would expose the user to risk.</p>
<p>But I doubt the designers would be daft enough to treat cached or saved-for-offline-use stuff as &quot;local&quot; &#8211; they surely are run with remote permissions, just cached locally.</p>
<p>But is you asked a thousant users &quot;is a web page an executable? Is a word document?&quot; the majority would say &quot;no&quot;. So any of you using that term to describe what the users are doing here should think long and hard whether you are using the clearest definition, before trying to advise users.</p>
<p>For a lovely few years in the 90s there was a time where the distinction between &quot;executable&quot; and &quot;document&quot; was relevant. Then macro viruses burst forth, and the &quot;don&#8217;t trust executables&quot; line became a nonsense.</p>
<p>If it&#8217;s true that MS wraps downloaded executable content, but not web pages or doc files, then it would seem that MS has provided an airtight hatchway against only some filetypes, and against others, it&#8217;s provided a decidedly leaky one.</p>
<p>IE, if I remember correctly, modifies saved HTML with some kind of a saved-from line. The files should, one expects, run under the context of the host listed in that line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564153">
				<div id="div-comment-564153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rich Elison</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564153">
			October 31, 2007 at 1:40 pm</a>		</div>

		<p>ActiveX was a bad idea? Why? I can think of a bunch of instances where COM and ActiveX were perfect solutions to the problems we had to solve. So is it really that ActiveX/COM was/is bad? Or is it that you really have no idea what the technology is and just figured you&#8217;d jump on the ActiveX sucks bandwagon? Could you maybe offer some explanation as to what part of ActiveX sucks so some of us could learn something. Because as it stands your post was, still is, a waste of space.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564173">
				<div id="div-comment-564173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564173">
			October 31, 2007 at 2:01 pm</a>		</div>

		<p>Yosi: &nbsp;what is a &#8216;web page&#8217;? &nbsp;</p>
<ul>
<li>is a .txt file on a server a &#8216;web page&#8217;? &nbsp;</li>
<li>
<p>is a .swf file on the local drive a &#8216;web page&#8217;?</p>
</li>
<li>
<p>is an .exe a &#8216;web page&#8217; if it makes http requests? &nbsp;</p>
</li>
</ul>
<p>Is it a WTF to allow any of these to be accessed under full trust? If so, which one(s)?</p>
<p>Security is nice, but at some point, the user&#8217;s expert knowledge is an undeniable necessity. &nbsp;The day that no user can corrupt a machine through careless use is the day that all actual software will become completely useless.</p>
<p>We need to teach users better, get out of their way as much as possible, and never attempt to think it&#8217;s a good thing to dumb them down. &nbsp;There will always be malicious code available somewhere &#8211; why should it be 100% our responsiblity to prevent it running &#8211; surely responsibility falls on the user at some point?</p>
<p>There are always going to be pick-pockets and purse-snatchers in the city&#8230;should citizens be taught to expect that they can walk around as if there weren&#8217;t any? &nbsp;If someone told me they believed that &#8211; well, now THAT would be a WTF.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564183">
				<div id="div-comment-564183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564183">
			October 31, 2007 at 2:06 pm</a>		</div>

		<blockquote><p>
  Pierre B: &quot;I think Microsoft should consider wrapping saved web pages the same way they wrap executable saved from the web, with at least a warning when I open it again or, better still, a wrapper that sets the trust level of IE to the same trust level that was in effect when the page was saved.&quot;
</p></blockquote>
<p>You&#8217;re in luck! Microsoft recently obtained a time machine and has implemented the functionality you requested starting in IE6 on Windows XP SP2.</p>
<p>When you save a file to your local disk from IE, it gets a &quot;mark of the web&quot; keeping it in the security zone from which it was saved. (Google if you&#8217;ve never heard of this.)</p>
<p>If you strip that MoTW out, IE goes into the Local Machine Lockdown zone, which doesn&#8217;t permit most ActiveX to run without the user prompt Raymond mentions. If you click through the prompts warning about dangerous access, it will grant you dangerous access. If this occurs and your computer is harmed, send a message to <a href="mailto:time-machine@microsoft.com">time-machine@microsoft.com</a> and ask them to go back and prevent you from clicking the OK button.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564193">
				<div id="div-comment-564193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://fuxx.h1.ru' rel='external nofollow' class='url'>Sergey</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564193">
			October 31, 2007 at 2:28 pm</a>		</div>

		<p>BTW: It reminds me of mandatory access control, when you can not save file from higher security level to lover.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564213">
				<div id="div-comment-564213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skywing</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564213">
			October 31, 2007 at 2:42 pm</a>		</div>

		<p>Java applets are not comparable to ActiveX controls. &nbsp;Flash applets are compatible to ActiveX controls. &nbsp;If you are tempted to make this comparison between ActiveX and Java (or Flash, or any of othe other enhanced scripting / programming languages for browsers that require native browser extensions to support them), then you are misunderstanding the technology.</p>
<p>ActiveX controls are intended to be used to implement things like a Java plugin, a Flash plugin, and soforth. &nbsp;They are analogous to the similar sort of browser plugins/extensions that implement this sort of functionality on alternative browsers, such as Firefox.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564243">
				<div id="div-comment-564243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564243">
			October 31, 2007 at 3:41 pm</a>		</div>

		<p>This post by Larry Osterman exactly describes whats going on here: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/larryosterman/archive/2006/02/02/523259.aspx" rel="nofollow">http://blogs.msdn.com/larryosterman/archive/2006/02/02/523259.aspx</a></p>
<p>The windows security model is exactly like a firewall: All good and great until someone manages to break through it. And decade of email attachment &quot;exploits&quot; demonstrates just how easy breaking through it is. Windows essentially has no security in depth.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564283">
				<div id="div-comment-564283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gazpacho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564283">
			October 31, 2007 at 5:03 pm</a>		</div>

		<p>If someone is naive enough that they don&#8217;t wonder why they&#8217;re being asked to save a web page and open it later&#8230;</p>
<p>what are the chances that they&#8217;d be able to?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564293">
				<div id="div-comment-564293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Diack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564293">
			October 31, 2007 at 5:05 pm</a>		</div>

		<p>Having been an Active X/COM and DCOM (ugh!) programmer for 8 years now, you might expect me to be a fan of it. But I agree with the bulk of the people here.</p>
<p>Having used it, seen how difficult, insecure and non robust it is both to develop for and use/deployment, it&#8217;s a truly dreadful technology, which I truly wish everyone would stop using.</p>
<p>Just as an example of how weak it (and it&#8217;s relative: Flash is), I was sent a Excel spreadsheet today &#8211; which had (apparently) a flash applet saved in the file for playing &#8220;cat bowling&#8221;. I mean WTF and also what a howling security hole. </p>
<p>Let&#8217;s get back to basic&#8217;s:</p>
<p>1) When did some idiot decide that spreadsheets shouldn&#8217;t just host numeric data and formulae?</p>
<p>Analogously.</p>
<p>2) The same for web pages&#8230;.</p>
<p>Need I go on&#8230;</p>
<p>Mike</p>
<div class=post>[<i>Hate to tell you this, but spreadsheets aren&#8217;t for hosting numeric data and formulae any more. They&#8217;re mostly used as ad hoc databases. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564303">
				<div id="div-comment-564303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gazpacho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564303">
			October 31, 2007 at 5:20 pm</a>		</div>

		<p>&lt;&lt;&quot;Save an Sanitise&quot; command&gt;&gt;</p>
<p>Aside from the &quot;mark of the web&quot; feature already mentioned, do you realize that you&#8217;ve just asked Microsoft to solve the Halting Problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564313">
				<div id="div-comment-564313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564313">
			October 31, 2007 at 5:38 pm</a>		</div>

		<p>Wednesday, October 31, 2007 5:20 PM by Gazpacho</p>
<p>&lt;&lt;&quot;Save an Sanitise&quot; command&gt;&gt;</p>
<p>Aside from the &quot;mark of the web&quot; feature already mentioned, do you realize that you&#8217;ve just asked Microsoft to solve the Halting Problem?</p>
<p>They have the best programmers in the world, they should be able to :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564333">
				<div id="div-comment-564333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564333">
			October 31, 2007 at 5:46 pm</a>		</div>

		<blockquote><p>
  &gt; do you realize that you&#8217;ve just asked Microsoft to solve the Halting Problem?
</p></blockquote>
<p>While stripping out scripts and objects when saving a web page might make the resulting page useless (but then again, the resulting page might still be useful), it&#8217;s hardly close to the Halting Problem. &nbsp;I imagine it&#8217;s about as complex as Outlook not displaying remote content in email messages by default.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564343">
				<div id="div-comment-564343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564343">
			October 31, 2007 at 5:50 pm</a>		</div>

		<p>mikeb, exactly.</p>
<p>I&#8217;m not asking them to analyse the scripts to see if they&#8217;re safe (although doing so is still possible, that&#8217;s what anti-virus does and it hasn&#8217;t solved the halting problem either).</p>
<p>Rather, I am suggesting that scripts be stripped completely, whether safe or unsafe. All I want is to save the current text, images and layout of what is on screen so that I can open it up again as it is. If I can&#8217;t click on certain things anymore, because they had scripts behind them, I don&#8217;t care because all I want is to be able to read what was on the screen again at a later date.</p>
<p>I am also not proposing that the existing Save function be removed as sometimes you want/need the &quot;unsafe&quot; full copy of the page.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564353">
				<div id="div-comment-564353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564353">
			October 31, 2007 at 5:54 pm</a>		</div>

		<p>Websites aren&#8217;t programs, but they can contain script code. This code is restricted, and the restriction is determined by the source domain. If you save it locally, then you have assigned it a new domain with more privileges, and you should account for that.</p>
<p>But claiming that you can&#8217;t expect such a change is ridiculous. As a user of a webbrowser, you should have informed yourself about the cross-domain security model.</p>
<p>Yes, you can generally limit the local file domain too, but not without breaking important functionality (like including locally saved resources).</p>
<p>If you don&#8217;t want such scripts to run, use an editor to remove the scripts. Or do it programmatically automated. Or at least check the scripts. Or disable local scripts (which might already break something). A classical show-but-don&#8217;t execute scripts application is OpenOffice.</p>
<p>As for Firefox: It treats all scripts from local resources as unprivileged as any other scripts. But it still allows to load local source file and access their contents, since they&#8217;re from the same domain (file:).</p>
<p>At any rate, you shouldn&#8217;t discuss MSIE in that context. You can always trivially exploit from any context by simply using one the the at least five known unpatched buffer overflow vulnerabilities (that Microsoft has been informed some years ago but decided to not do anything). Not to mention the ability to instantiate arbitrary ActiveX controls in violation of the policy (because it&#8217;s totally broken and sometimes doesn&#8217;t work), and cross-site scripting is an inherent design feature (that was tried to loosy limited by blacklisting some functions).</p>
<p>Same for ActiveX: If half of Windows consists of COM Controls, each of them can be instantiated from IE (which is broken anyway) and accepts untrusted parameters. You&#8217;d have to check every of them for every possible scenario, and surely you can&#8217;t. That&#8217;s why ActiveX is such a bad idea.</p>
<p>Regarding .NET: Where&#8217;s the sandbox? Surely Microsoft wishes one to be there, but it&#8217;s well known that with .NET 1.1 (and the implemented backward compatibility in .NET 2.0+) you can make unsafe code (marked as safe) bypass the verifier and then access arbitrary memory locations. And not mention that the entire security subsystem of the class library is full of reference protection failures which allow Time-of-check-till-Time-of-use attacks against various Permission objects.</p>
<p>Vista&#8217;s IE Protected Mode: You can easily break out of it if you&#8217;re patient. Michael Howard has extensively discussed this (f.e. by shared objects in the gloabl namespace), and it has been pointed out multiple times that this Protected Mode thing doesn&#8217;t create any new security boundary.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564363">
				<div id="div-comment-564363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gazpacho</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564363">
			October 31, 2007 at 6:00 pm</a>		</div>

		<p>&quot;2) The same for web pages&#8230;.&quot;</p>
<p>I think it happened while you were sleeping under the rock.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-563983">
				<div id="div-comment-563983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DEngh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-563983">
			October 31, 2007 at 11:30 am</a>		</div>

		<p>I agree with Raymond. &nbsp;If we want computers to be generalist machines, they have to be able to *do things* without being hamstrung trying to interpret human intent. &nbsp;*People* have a hard time with that.</p>
<p>If you give enough people enough rope, some will hang themselves. &nbsp;It doesn&#8217;t mean Rope Is Bad, it means People Should Know Rope Can Be Used For Hanging. &nbsp;No one expects the rope to know what it&#8217;s doing is bad for someone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564383">
				<div id="div-comment-564383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564383">
			October 31, 2007 at 7:57 pm</a>		</div>

		<p>&quot;1) When did some idiot decide that spreadsheets shouldn&#8217;t just host numeric data and formulae?&quot;</p>
<p>Conditional processing is a very potent tool in a spreadsheet, and even not abusing Excel as a DB per se. &nbsp;I can think of a D20 character creator that allowed you to build a very complete DnD character. &nbsp;There going to be many more (and less geeky) examples for sure, but its the one I know of first hand.</p>
<p>&quot;I don&#8217;t care because all I want is to be able to read what was on the screen again at a later date&quot;</p>
<p>YOU don&#8217;t care, but a lot of other people just might. &nbsp;Moreover, I&#8217;ve seen and used several pages that use scripting to help determine layout and so on.</p>
<p>&quot;Windows essentially has no security in depth.&quot;</p>
<p>Except when it does. &nbsp;If you&#8217;re running as a limited user, (which Vista forces) that is a huge gain. &nbsp;System hijacking is a lot harder to do without system/admin priviledges. &nbsp;Sure, all of the users files are vulnerable here, but the system isn&#8217;t going to get completely hosed. &nbsp;While you can break out of some of the sandboxes as somebody else said, it just raises the bar that much more. &nbsp;Every extra hoop you force a virus writer to jump through makes it that much harder for them. &nbsp;(Yes, a lot of code in the virus world is shared, but it still increases the difficulty)</p>
<p>Maybe I should dust off that old OS I wrote for school and sell it. &nbsp;It&#8217;s completely secure! &nbsp;Mostly because it has an utterly fake TCP/IP implementation and didn&#8217;t run much beyond itself. &nbsp;Hard to hurt something that is so autistic (to borrow the idea from GitS).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564393">
				<div id="div-comment-564393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564393">
			October 31, 2007 at 8:30 pm</a>		</div>

		<p>&gt; If you&#8217;re running as a limited user, (which Vista forces) that is a huge gain. &nbsp;System hijacking is a lot harder to do without system/admin priviledges. &nbsp;Sure, all of the users files are vulnerable here, but the system isn&#8217;t going to get completely hosed.</p>
<p>I don&#8217;t know about you, but isn&#8217;t something I would consider secure. It also buries anybody who wants to reconfigure parts of their system (Such as %ProgramFiles%) in elevation prompts. Locking off system files from applications shows that there is some hope for windows security, but making it harder for users to do certain things is a huge step back.</p>
<p>This is pretty offtopic isn&#8217;t it</p>
<div class=post>[<i>Not just off topic, but actually <a href="http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx" rel="nofollow">an old topic</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564143">
				<div id="div-comment-564143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://fuxx.h1.ru' rel='external nofollow' class='url'>Sergey</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564143">
			October 31, 2007 at 1:37 pm</a>		</div>

		<p>&gt;&gt; Raymond is wrong. This is typical for MS to miss a point in security features.</p>
<p>Agree</p>
<p>&#8230;</p>
<p>&gt;&gt; For most people a web page is not an application.</p>
<p>The *right thing* here is not to save to file system content which is considered dangerous by security subsystem. Just block it for all levels which lie above security subsystem.</p>
<p>Same as antivirus blocks infected files for all processes and actions and not only explorer.exe and &#8216;launch&#8217; action. You can&#8217;t even read infected file. It is blocked. So blocked content have to be unavailable to all parts of IE (for instance one which saves pages to disk) and not only to part which draws things on screen.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564203">
				<div id="div-comment-564203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564203">
			October 31, 2007 at 2:32 pm</a>		</div>

		<p>ActiveX is bad because there&#8217;s only a minimal sandbox around it (at least in IE &lt;=6). &nbsp;Java applets are comparable to ActiveX controls (well, mostly &#8212; I&#8217;m not sure if you can interact with a Java applet from JS code on the page, but I suspect you can), but they don&#8217;t have as many of the security implications, because there&#8217;s a strict limit on what actions an applet can take.</p>
<p>But ActiveX controls can do anything at all, because there&#8217;s no runtime to limit them. &nbsp;Java can do its sandbox (as can .net) because the runtime has to translate the applet into real code, and it can analyze the bytecode to see whether it performs any action that isn&#8217;t on the whitelist of allowed-applet-actions. &nbsp;Without that interpreter layer, ActiveX code can do anything, because at its core it&#8217;s directly-executable x86 opcodes.</p>
<p>Of course ActiveX *needs* to be able to do absolutely anything, because it&#8217;s used for windows update. &nbsp;(&quot;Full system access? &nbsp;Run setup programs that replace core system DLLs? &nbsp;Sure!&quot;) &nbsp;But that makes it inherently less secure than a browser plugin with an explicit sandbox.</p>
<p>(And it&#8217;s not like Microsoft can change IE to use a sandbox for everything except the WU control, either. &nbsp;Even apart from backwards compatibility concerns, they&#8217;d get hit by a ton of monopoly conspiracies. &nbsp;It would have to be a sandbox for everything, or a sandbox for nothing, and the back-compat stuff at this point means it&#8217;s a sandbox for nothing. &nbsp;Except controls that opt-in to a few restrictions via &quot;safe for scripting&quot; bits, etc.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564223">
				<div id="div-comment-564223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skywing</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564223">
			October 31, 2007 at 2:43 pm</a>		</div>

		<p>Sorry, that should read &quot;Flash applets are *not* comparable to ActiveX controls&quot;. &nbsp;Fingers not typing the correct thing today :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564253">
				<div id="div-comment-564253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564253">
			October 31, 2007 at 4:05 pm</a>		</div>

		<p>&gt; BryanK: &quot;But ActiveX controls can do anything at all, because there&#8217;s no runtime to limit them.&quot;</p>
<p>There&#8217;s a whole *operating system* of runtime to limit them. The problem is that binary executable code running with full system privileges can do anything it wants. Look at Vista&#8217;s IE Protected Mode&#8211;how can ActiveX controls can do &quot;whatever they want&quot; when they don&#8217;t even have write access to most of the disk? </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564403">
				<div id="div-comment-564403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564403">
			October 31, 2007 at 11:07 pm</a>		</div>

		<p>&quot;But claiming that you can&#8217;t expect such a change is ridiculous. As a user of a webbrowser, you should have informed yourself about the cross-domain security model.&quot;</p>
<p>That&#8217;s when I stopped reading. &nbsp;This poster has obviously not spent any time with actual users.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564423">
				<div id="div-comment-564423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Diack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564423">
			November 1, 2007 at 2:12 am</a>		</div>

		<p>That said, Raymond is right. Sadly I know many data files now host &quot;inappropriate&quot; stuff. I&#8217;m still of the old school mind though when he says:</p>
<p>&quot;[Hate to tell you this, but spreadsheets aren&#8217;t for hosting numeric data and formulae any more. They&#8217;re mostly used as ad hoc databases. -Raymond]&quot;</p>
<p>But don&#8217;t get me wrong, while I dislike COM, MS is absolutely right, about the greatness of being a limited user. The number of people I meet who moan about Windows being insecure, until I show them the benefits of running as a limited user&#8230;.</p>
<p>If I had a quid for every time&#8230;.</p>
<p>Mike</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564443">
				<div id="div-comment-564443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564443">
			November 1, 2007 at 4:07 am</a>		</div>

		<p>&quot;That&#8217;s when I stopped reading. &nbsp;This poster has obviously not spent any time with actual users.&quot;</p>
<p>I suppose you mean the ones who think that once they&#8217;re on the internet there is indeed a free lunch&#8230;and free pics of Paris Hilton, with no strings attached? &nbsp;Imho, too many users apparently have an idiot-switch that&#8217;s hard-wired to the green light on their DSL router &#8211; completely rational in &#8216;real&#8217; life, yet ridiculously naive on the net. &nbsp;And&#8230;I don&#8217;t see how this is our problem.</p>
<p>In my online experience, I&#8217;ve gone from ME to XP to Vista with only the firewall in my router standing between my machines and certain doom&#8230;no anti-malware stuff at all. I&#8217;ve always run as admin, my machine has been online 24/7, my browser has been IE, and my email client has been some flavor of Outlook. You want to know how many viruses/etc. I&#8217;ve dealt with? &nbsp;</p>
<p>ZERO. &nbsp;</p>
<p>So why haven&#8217;t I been blasted? &nbsp;Basically, it&#8217;s because I use the internet to get things done, and I know every link that looks too good to be true is exactly that. &nbsp;Yet, I personally know otherwise-intelligent adult people who couldn&#8217;t go for 5 minutes on a setup like mine without having the machine completely locked up on malware &#8211; all because they suffer from the notion that the net is some magical place where you get stuff for free.</p>
<p>In the end, is this really a software problem? &nbsp;I think not. &nbsp;But it is no matter&#8230;Computer Security at this point in time could easily be seen by an outside observer to be a de facto religion, complete with all the dogma and legalism which generally accompanies such.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564473">
				<div id="div-comment-564473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564473">
			November 1, 2007 at 8:59 am</a>		</div>

		<p>&#8230;and yes it might break the handful of pages that use script for important layout but none of the Save-Page-To-Disk methods are immune from breaking things and a Save-and-Sanitise option would be very useful to me and, I suspect, many other people.</p>
<p>So just because YOU don&#8217;t care, a lot of other people just might.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564483">
				<div id="div-comment-564483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564483">
			November 1, 2007 at 9:18 am</a>		</div>

		<p>I find Microsoft&#8217;s pseudo-security highly irritating. It&#8217;s basically CYA. &quot;Look we sent you a warning! It&#8217;s not our fault you ignored it because we send you so many other useless warnings that you&#8217;ve stopped taking any notice of them.&quot;</p>
<p>What is indefensible are the hoops you have to go through to disable the crap MS legal department has dreamed up. To actually stop IE from giving you the idiot message that it has blocked (horror!) Javascript on a web page stored locally. First you have to spend up to an hour Googling and searching the knowledge base. Then you have to do a registry hack, but apparently you have to log on and log off for it to have effect so in practise you keep unsecuring other settings because you weren&#8217;t told to reboot.</p>
<p>I write language learning software. The standard platform is a web page with Javascript (the alternative is Flash). If I wanted to distribute the files on CD to save the university bandwidth I presumably would have to integrate Firefox in the DVD to stop the whole experience being a Microsoft sabotaged nightmare.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564503">
				<div id="div-comment-564503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564503">
			November 1, 2007 at 10:54 am</a>		</div>

		<p>Yosi: &quot;I never expect web page behave differently just because I saved it on my local disk. Raymond&#8217;s explanation is complete WTF.&quot;</p>
<p>No, it&#8217;s not, and you&#8217;re a fool if you don&#8217;t expect something to behave differently when run on your local machine than it does when it&#8217;s run across the internet. If you don&#8217;t understand that (and why that&#8217;s the case), you have no business being around computers, and definitely have no business spending time on blogs about software development and operating systems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564523">
				<div id="div-comment-564523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564523">
			November 1, 2007 at 10:56 am</a>		</div>

		<p>Leo: &quot;I&#8217;m a technical user but I never thought about this before and have saved and later double-clicked lots of web pages without realising the risk. It&#8217;s obvious now that it has been pointed out, of course, but I bet many people don&#8217;t realise it.&quot;</p>
<p>But your not realizing the risk doesn&#8217;t make sense. Why else would IE have supported different security levels for years now, if it didn&#8217;t make a difference somehow. Common sense should tell you that, shouldn&#8217;t it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564543">
				<div id="div-comment-564543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564543">
			November 1, 2007 at 11:00 am</a>		</div>

		<p>&quot;Rather, I am suggesting that scripts be stripped completely, whether safe or unsafe. All I want is to save the current text, images and layout of what is on screen so that I can open it up again as it is. If I can&#8217;t click on certain things anymore, because they had scripts behind them, I don&#8217;t care because all I want is to be able to read what was on the screen again at a later date.&quot;</p>
<p>So what you want is for Internet Explorer to add a &quot;Save as Bitmap&quot; option!? &nbsp;Perfectly safe. &nbsp;All formatted and readable just as it was when you viewed it. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564563">
				<div id="div-comment-564563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Triangle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564563">
			November 1, 2007 at 11:16 am</a>		</div>

		<blockquote><p>
  But your not realizing the risk doesn&#8217;t make sense. Why else would IE have supported different security levels for years now, if it didn&#8217;t make a difference somehow. Common sense should tell you that, shouldn&#8217;t it?
</p></blockquote>
<p>And common sense should tell you that the web page should be given permissions based on where it was generated, not based on wether or not its on the local disk.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564623">
				<div id="div-comment-564623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564623">
			November 1, 2007 at 12:24 pm</a>		</div>

		<p>Checking up on this there is a setting to allow everything to run. Just found it in Advanced | Security.</p>
<p>MS certainly don&#8217;t like to tell you about it though. The tech net article on Local Machine Lockdown doesn&#8217;t even mention the settings (maybe they only exist in IE7 and the article was written before it came out). When I checked up on it for the work machine some time ago I only got the registry hack.</p>
<p>MS made two bad decisions:</p>
<p>The first was to make Administrator the default logon instead of limited user. There were good reasons for this as the noise about UAC shows but MS was right about UAC and all the procrastination has done is give us both UAC and the present mess up with useless security warnings.</p>
<p>The second was to tie IE in with the OS. There is no excuse for this. It was done at the behest of the legal team in the hope it would allow them to wriggle out of the DOJ lawsuit; not only did it not do that, it has been creating problems ever since.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564633">
				<div id="div-comment-564633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564633">
			November 1, 2007 at 12:40 pm</a>		</div>

		<p>&#8212;-And common sense should tell you that the web page should be given permissions based on where it was generated, not based on wether or not its on the local disk&quot;&quot;&#8212;&#8211;</p>
<p>If the web page developer knows about the restrictions he can ensure that by putting in the Mark as Web comment. If it comes from a trusted zone web site than it will be treated as such.</p>
<p>If the question is just getting Javascript and displayed then the comment &lt;!&#8211; saved from url=(0013)about:internet &#8211;&gt; will allow it as it gives the file standard internet permissions. The problem comes if you copy a whole CD of web files over to the hard disk. The links will no longer work because the files that are linked to are on the hard disk and for obvious reasons web pages on the internet are not allowed to access files on the local hard disk.</p>
<p>The alternative of renaming the files from .htm to hta. means that not only do you have to rename every file, which can probably be done as a batch file, but worse, you have to then open every file and go through the source code manually to rename every link to a local file to .hta Ouch! I think I&#8217;m definitely going to be bundling firefox.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564663">
				<div id="div-comment-564663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564663">
			November 1, 2007 at 1:16 pm</a>		</div>

		<p>It appears my last comment on hta was wrong. Once you have hta appearing once then all the other links will open in that window.</p>
<p>Still doesn&#8217;t solve the problems of pop-up windows though.</p>
<p>And here&#8217;s a link to prove there are a lot of other people annoyed and even financially hit by the matter.</p>
<p><a rel="nofollow" target="_new" href="http://www.phdcc.com/xpsp2.htm" rel="nofollow">http://www.phdcc.com/xpsp2.htm</a></p>
<p>Still, at least MS security makes work for all those programmers who live off making utilities that circumvent it!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564713">
				<div id="div-comment-564713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564713">
			November 1, 2007 at 2:44 pm</a>		</div>

		<p>JD, you&#8217;re much more stupid than you claim. The thing that let you not getting infected was PURE LUCK. It just takes one guy to make up a bogus company, buy some adspace from Yahoo, you ivisintg Yahoo and you&#8217;re hosed. We&#8217;ve already seen many such bad guys doing exactly that.</p>
<p>There isn&#8217;t such a thing like good websites and bad websites, they&#8217;re all bad as soon as they include third-party content, what almost all websites do.</p>
<p>And with MSIE, no security setting could save you from that. By design. Ask Microsoft why they still advertises IE as a webbrowser, whereas in fact it&#8217;s an unrestricted and unrestrictable shell.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564723">
				<div id="div-comment-564723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564723">
			November 1, 2007 at 3:18 pm</a>		</div>

		<p>&#8220;Shhh, don&#8217;t tell anyone that Firefox can run Flash. -Raymond&#8221;</p>
<p>A SWF file is not an executable. It is byte code, with a very tight security sandbox (like a Java applet). So it cannot even read a file, much less format your disk, the way an ActiveX control does.</p>
<p>The Flash runtime itself is executable, but you have to actively install it. It does not install itself.</p>
<p>So no, it is far from being the same.</p>
<p>I would expect a regular user to be confused by this, but from you&#8230; sounds like trying to confuse others.</p>
<div class=post>[<i>I was responding to the claim that nobody else &#8220;run[s] executables from a Web page.&#8221; Flash is an executable. (I&#8217;m going to ignore the distinction between DLL and executable since the original author did too.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564733">
				<div id="div-comment-564733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564733">
			November 1, 2007 at 3:27 pm</a>		</div>

		<p>For those that bring Vista protected mode: this does not make ActiveX a good idea. At the time when ActiveX was created, Vista was far away, and everybody was Administrator.</p>
<p>And saving something on my disk does not make it safe. This is why a Flash file (.swf) has no more rights if running from my disk that it does in the web page (in fact, it has less).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564463">
				<div id="div-comment-564463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564463">
			November 1, 2007 at 8:51 am</a>		</div>

		<p>Reply to MS:</p>
<p>&quot;YOU don&#8217;t care, but a lot of other people just might.&quot;</p>
<p>FFS, I suggested an *option* not a *replacement* so view it as such. :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-564743">
				<div id="div-comment-564743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564743">
			November 1, 2007 at 3:54 pm</a>		</div>

		<p>&quot;But your not realizing the risk doesn&#8217;t make sense. Why else would IE have supported different security levels for years now, if it didn&#8217;t make a difference somehow. Common sense should tell you that, shouldn&#8217;t it?&quot;</p>
<p>Because, as I said, I simply had not thought about it. As I also said, it is obvious if you do think about it and put the pieces together. The point I was trying to make was that people don&#8217;t always do that, even technical people like myself and many of the others posting here. Saving something on the screen to disk to look at later feels like such an innocent operation &#8212; it&#8217;s a document, a data file, I&#8217;m just saving it to disk and later I&#8217;m going to view exactly the same thing &#8212; that it isn&#8217;t something many people think about.</p>
<p>Of course it isn&#8217;t REALLY just a document or a data file; it can contain code which can do very bad things, but I believe it&#8217;s easy for people not to realise that. This is backed up by some of the other people posting here, not to mention the fact that IE7 disables local files from launching Flash and other ActiveX controls until you click a warning.</p>
<p>I suspect people who have not delved around in IE&#8217;s security configuration or done any web development are not even aware that IE has different security settings for different sources. Indeed, why does it, really? I can understand more and less trusted websites but why should HTML that happens to be on my local HDD be more trusted than something else, given that saving something to the HDD does not require admin rights or produce any warnings?</p>
<p>&quot;So what you want is for Internet Explorer to add a &quot;Save as Bitmap&quot; option!? &nbsp;Perfectly safe. &nbsp;All formatted and readable just as it was when you viewed it.&quot;</p>
<p>Yes, well, almost. I still want to be able to copy &amp; paste text from the page and I&#8217;d ideally like to be able to click on standard links. (I don&#8217;t care if javascript links are broken.) I&#8217;d also like it to resize the layout when I resize the window (again assuming javascript was not used for layout, which is rare).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-564763">
				<div id="div-comment-564763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-564763">
			November 1, 2007 at 5:06 pm</a>		</div>

		<p>What is hilarious is that Dave pointed out that what I requested is already implemented, and yet people are still saying it&#8217;s a stupid idea.</p>
<p>What is saddening is that in 2007, some are still blaming the end-users for not recognizing security risks. I sure hope I will never use your products.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-565013">
				<div id="div-comment-565013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565013">
			November 2, 2007 at 1:05 pm</a>		</div>

		<p>&#8220;I was responding to the claim that nobody else &#8220;run[s] executables from a Web page.&#8221; Flash is an executable.&#8221;</p>
<p>But you don&#8217;t run the Flash player executable from a web page. You install it. And it cannot be done without the user accepting it.</p>
<p>The only thing you &#8220;run from a web page&#8221; is a .swf, which is not an executable, it is &#8220;interpreted&#8221; in a very tight sandbox with almost zero access to the file system.</p>
<p>With ActiveX you effectively run an application with access to native API written by a random Joe.</p>
<p>The same applies to Java.</p>
<div class=post>[<i>&#8220;But you don&#8217;t run the Flash player executable from a web page. You install it. And it cannot be done without the user accepting it.&#8221; So what&#8217;s the difference then? In both cases, you install a plug-in after the user grants permission. That plug-in has access to the native API. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-565053">
				<div id="div-comment-565053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anomymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565053">
			November 2, 2007 at 1:51 pm</a>		</div>

		<p>Raymond, you&#8217;re obviously ignoring that about half of Windows is implemented as COM modules. Each of them can be sinatntiated. So the problem about ActiveX is not running any new controls, but exploiting a huge amaount of existing ones.</p>
<p>A second, obvious difference is that, if a malicious websites doesn&#8217;t want the user to be asked, it can install its ActiveX control wihtout asking for permissions. This exploit has even been taken so far to getting documented as the standard way to embed ActiveX control!</p>
<div class=post>[<i>I&#8217;m pretty sure that an ActiveX control being installed and run without user permission would be considered a serious vulnerability. Have you reported it? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-565063">
				<div id="div-comment-565063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565063">
			November 2, 2007 at 1:53 pm</a>		</div>

		<p>And as the third issue: An ActiveX control doesn&#8217;t know anything about its security context. It it shall write into files as part of an application, it can do so as well if embedded in a webpage. If you remove all such functionality, it effectvely becomes unusable as portable part or an application.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-565083">
				<div id="div-comment-565083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565083">
			November 2, 2007 at 2:16 pm</a>		</div>

		<p>&#8220;So what&#8217;s the difference then? In both cases, you install a plug-in after the user grants permission.&#8221;</p>
<p>The difference is that an ActiveX runs without asking the user, without being installed, and can originate from any web site (at least with the default settings in older versions of IE).</p>
<div class=post>[<i>I think it&#8217;s disingenuous to call up as examples things that aren&#8217;t true any more. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-565223">
				<div id="div-comment-565223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565223">
			November 3, 2007 at 7:46 am</a>		</div>

		<p>&#8220;I&#8217;m pretty sure that an ActiveX control being installed and run without user permission would be considered a serious vulnerability. Have you reported it?&#8221;</p>
<p>Sure I have reported it, but it&#8217;s not a security vulnerability since IE is documented to be not secure in hosile environment, thus security was never specified at all.</p>
<p>The vulnerability is not use to Interface name (like WMPlayer.WMPlayer.1 for the WMP ActiveX control), but to use a invalid pseudo-protocl &#8220;clsid&#8221; as a &nbsp;syntax &#8220;clsid:{GUID of the control}&#8221;. In this case, the DDE Server does the instantiation instead of IE, bypassing IE&#8217;s policy and potentially triggering unrequested installation of new controls and/or updates of existing controls.</p>
<p>No to mention the side effects of instantiation. TlntSrv.TlntSrvEnum for example, &nbsp;triggered,, when the user had sufficient privileges, the startup of the Telnet Server Service (if installed) on Windows 2000 SP3.</p>
<div class="post">[<i>Sure, you can instantiate a local server, but then what? The server runs and then says &#8220;Sorry, I&#8217;m not an ActiveX control.&#8221; Not sure how anything got installed. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-565263">
				<div id="div-comment-565263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565263">
			November 4, 2007 at 1:41 pm</a>		</div>

		<p>Security zones and the safe for scripting/safe for initialization categories were introduced in IE 3.02 for goodness sake! PLEASE get a clue before posting. The problems with ActiveX components have in many cases been where components were incorrectly marked, which is the fault of the component developer, not of Internet Explorer, exposing capabilities to scripting that were not secure. THEY ARE NOT SET BY DEFAULT &#8211; the developer has to opt in &#8211; but many components were opted in that shouldn&#8217;t have been. This relates only to objects where parameters have been specified in the &lt;object&gt; tag, or scripts target the objects. If no parameters are supplied and script does not target the object, any object can be loaded, but this should not present a security risk as the attacker is not giving any information for it to operate on (this would generally make the object pretty useless, of course).</p>
<p>In addition COM offers the IObjectSecurity interface. This allows the object, once initialized, to discover the zone it&#8217;s running in to permit it to further lock down its capabilities.</p>
<p>There have of course been flaws in the *implementation* of the security model. The local server issue *did* exist because you could specify a file: URL for the codebase parameter, which allowed an executable already on the user&#8217;s system to be loaded. This is possible because the COM local server model requires the server process to register its classes with COM at runtime, so COM loads the program, then waits for it to register its classes. It doesn&#8217;t so the operation times out, but the program still ran. This was fixed over five years ago: bulletin MS02-015. It was rated moderate because the attacker could only run programs already present, and then could not provide command-line arguments, but &#8216;anonymous&#8217; indicates that there was something which could be run that could start the Telnet service, which could then itself be used to connect to the machine, if you could get its IP address and it wasn&#8217;t behind a NAT or firewall and you could then guess a login.</p>
<p>The various settings for whether an object can be initialized or scripted are configured on a per-zone basis and can be adjusted one-by-one, or altogether using the &#8216;level&#8217; slider in Internet Options.</p>
<p>Firefox also has a model for loading binary, native code. It&#8217;s called XPCOM. The ONLY difference from COM &#8211; as it&#8217;s a complete rip-off &#8211; is that there is not a system-wide registry of all components which are independently creatable. Instead the registry of what&#8217;s available is stored in a file in the Firefox installation folder. Some extensions will be pure JavaScript extensions using only the Firefox script extension model, but some are binaries. Firefox does not actually have as robust an extension security model as IE does, but it is less exploitable due to the smaller number of compatible binary extensions possible. COM has in this instance been a victim of its own success.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-565343">
				<div id="div-comment-565343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565343">
			November 5, 2007 at 12:42 pm</a>		</div>

		<p>@Raimond: please don&#8217;t get angry with me.</p>
<p>But this is often your message in this blog (which I like a lot): judge everything in context!</p>
<p>If something looks like a stupid thing today, think about the situation when that thing was created. And you are right.</p>
<p>But let&#8217;s be consistent: if something is safe today, and does not look like such a bad idea, we should also look back and see if at the time when it was created that was also the case.</p>
<div class=post>[<i>Another theme of the blog is that harping on mistakes of the past accomplishes nothing. What&#8217;s done is done. Fix it as best you can, learn from it, and make the next thing better. <a href="http://blogs.msdn.com/oldnewthing/archive/2006/04/03/567318.aspx" rel="nofollow">Until time machines are invented, that&#8217;s the best anyone can do</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-565373">
				<div id="div-comment-565373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565373">
			November 5, 2007 at 1:51 pm</a>		</div>

		<p>Phenomenal. &nbsp;There seems to be an almost limitless supply of people who know nothing about how any Microsoft technology really works, but are damn sure that Microsoft did it all wrong, and know exactly how it &quot;should&quot; be done (namely, by waving their magic wands and making computers both sentient and telepathic).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-565423">
				<div id="div-comment-565423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565423">
			November 5, 2007 at 8:01 pm</a>		</div>

		<p>&#8212;&#8220;but are damn sure that Microsoft did it all wrong, and know exactly how it &#8220;should&#8221; be done&#8221;&#8212;&#8211;</p>
<p>When MS proceeds to break or cripple the applications you have written using standard MS procedures, then you are quite right to say that MS got it wrong.</p>
<p>And as far as &#8220;harping on the mistakes of the past&#8221; Raymond is ignoring something. Those of us that are harping on about the mistakes of the past are not those who made the mistake in the first place, but those who are suffering from it.</p>
<p>And MS is not showing that much intention of learning from its mistakes (insofar as one can talk about it as a monolithic organization). We still have no guarantee that a web program we write that runs fine in IE today will do so tomorrow after MS has applied arbitrary security updates. After all the posts I made on Local Machine lockdown here I found that the next day after I disabled it an update or something had changed the registry and IE would not open a single .swf file, whether from the web or from the local HD. After two hours searching on the web I found an obscure registry file that had appeared. I changed it and it worked until the next day, when I had to change it again.</p>
<p>If lots of moaning here means somebody at MS will pay attention and tell the guys in charge of security updates that it is &nbsp;big deal when they go around and change a setting without telling anybody then all the moaning will have had some effect.</p>
<p>You could argue it is a little unfair to argue this on Raymond&#8217;s blog, when he, more than anybody has defended backward compatibility, but we are not attacking Raymond personally, merely pointing out the chaos that making a mistake and then rectifying it by breaking things causes. </p>
<div class=post>[<i>The pendulum in the &#8220;compatibility vs. security&#8221; battle has swung the other way. Whereas you&#8217;re upset that it&#8217;s happening, far more people are upset that it took so long. Maybe you can get into a room with everybody else and work it out once and for all. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-565323">
				<div id="div-comment-565323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565323">
			November 5, 2007 at 12:30 pm</a>		</div>

		<p>&quot;I think it&#8217;s disingenuous to call up as examples things that aren&#8217;t true any more.&quot;</p>
<p>It was all in the context of &quot;ActiveX *was* a bad idea.&quot; Past tense.</p>
<p>And not everybody switched to Vista/IE7 yet.</p>
<p>Before IE7, everybody lived (for many years) with the sword of Damoc^H^H^H^H^HActiveX above their heads :-) And ActiveX *was* a bad idea.</p>
<p>But there is still a difference, even now: I am asked about the Flash plugin, and I am asked about random ActiveX, ok.</p>
<p>But I have to decide once for Flash (and I know it is from a safe company), then I can just &quot;run&quot; any .swf file, I know I am safe. But I still have to think and decide for every ActiveX out there, with often with very limited information.</p>
<p>Same model with Silverlight and Java, both better ideas than ActiveX.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-565333">
				<div id="div-comment-565333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565333">
			November 5, 2007 at 12:36 pm</a>		</div>

		<p>&quot;components were incorrectly marked, which is the fault of the component developer&quot;</p>
<p>We are talking security. The &quot;developer&quot; was out there to get your computer (and create the armies of &quot;slave&quot; computers to be used for spam, warez, DoS).</p>
<p>So it was not his *fault*, it was intentional. The internet stopped being a nice and friendly place many years before IE3.</p>
<p>So &quot;PLEASE get a clue&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-565483">
				<div id="div-comment-565483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071031-00/?p=24633#comment-565483">
			November 6, 2007 at 12:58 pm</a>		</div>

		<p>&#8220;Fix it as best you can, learn from it, and make the next thing better&#8221;</p>
<p>Agree. But when the answer to &#8220;it was a bad idea&#8221; is &#8220;it is the same as X&#8221; (which is not), it does not sound like lesson learned.</p>
<p>If the answer is &#8220;true, it was bad at the time, but it is fixed now&#8221; then I agree.</p>
<p>Also, some of my posts where not &#8220;targeted&#8221; at you, but where answers to other posts.</p>
<p>Anyway, I will stop here, enough is enough.</p>
<div class=post>[<i>You claimed that allowing plug-ins to run natively was a bad idea. I responded that if it&#8217;s such a bad idea, why do other browsers allow native plug-ins, too? You then compared current Firefox behavior to old IE3 behavior (instead of current IE7 behavior, which is more comparable). -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>