<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-956793">
				<div id="div-comment-956793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Xzibit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-956793">
			January 4, 2012 at 8:00 am</a>		</div>

		<p>Yo dawg, I heard you like clicking, so we put a menu in your menu, so you can click while you click.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-956803">
				<div id="div-comment-956803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-956803">
			January 4, 2012 at 8:25 am</a>		</div>

		<p>As poor as that meme is, in this particular place it&#39;s semi-fitted.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-956983">
				<div id="div-comment-956983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Douglas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-956983">
			January 4, 2012 at 2:31 pm</a>		</div>

		<p>So what if the user presses the context menu key (Shift+F10 if they don&#39;t have one)? Is there a WM_MENUCONTEXTMENU message?</p>
<p>I ask because I&#39;ve had to scold a number of people for using WM_RBUTTONUP to display a context menu instead of WM_CONTEXTMENU. This promotes more ..RBUTTONUP incorrectness, and a continuation of the trend toward anti-keyboard friendly applications.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-957003">
				<div id="div-comment-957003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957003">
			January 4, 2012 at 5:17 pm</a>		</div>

		<p>@Douglas AFAIK, there is no such message. I use &quot;context menus on menu&quot; in my application, and I was unable to handle Shift+F10 or the context menu key. There is no such message and no documented way to intercept keystrokes and handle it.</p>
<p>Raymond, could you tell us why there is no keyboard interface?</p>
<div class="post">[<i>Because the keystrokes which call up a context menu also dismiss it! Maybe that&#39;s why nobody uses this feature. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-957023">
				<div id="div-comment-957023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957023">
			January 4, 2012 at 10:03 pm</a>		</div>

		<p>Why use MF_DISABLED | MF_GRAYED, do you really need both?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-957033">
				<div id="div-comment-957033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957033">
			January 4, 2012 at 10:09 pm</a>		</div>

		<p>The Start menu in XP and 7 does show a nested context menu when you press Shift+F10 or the menu key. &nbsp;Interestingly, in Vista, only Shift+F10 works. &nbsp;I imagine that they&#39;re using a keyboard hook (or message hook, or something similar) to implement that feature.</p>
<div class="post">[<i>Or they&#39;re <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/12/28/10251521.aspx#10251553" rel="nofollow">not using this feature in the first place</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-957043">
				<div id="div-comment-957043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957043">
			January 5, 2012 at 2:52 am</a>		</div>

		<p>I don&#39;t see why you shouldn&#39;t be able to use the context menu key to open a context menu on a main menu. (Ironically in Firefox you can even use the keyboard to open a context menu on a toolbarbutton menu, such as for a bookmark folder, even though you can&#39;t actually open the toolbarbutton menu itself without a mouse. Of course normally if you wanted to do this you would open bookmarks from the main menu.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-957123">
				<div id="div-comment-957123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ArlieD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957123">
			January 5, 2012 at 7:55 am</a>		</div>

		<p>This just seems like a bad idea to start with. &nbsp;I cannot imagine any ordinary user getting this right. &nbsp;I help a lot of older relatives use computers, and context menus really blow their minds to begin with. &nbsp;Accepting a context menu on a context menu is just crazy. &nbsp;It&#39;s also very inconsistent with simply choosing an entry from a context menu. &nbsp;Raymond, for once, this article would have been improved by not being published.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-957203">
				<div id="div-comment-957203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Long</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957203">
			January 5, 2012 at 8:41 am</a>		</div>

		<p>ArlieD: &nbsp;I disagree &#8211; one place where this is a very natural thing to do is on Firefox&#39;s Bookmarks menu. &nbsp;Let&#39;s say I want to delete a bookmark &#8211; how would I try? &nbsp;The first thing I tried was to open the Bookmarks menu and right-click on the relevant bookmark. &nbsp;Bingo &#8211; there&#39;s the Delete option, right there. &nbsp;Very intuitive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-957993">
				<div id="div-comment-957993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kero</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-957993">
			January 8, 2012 at 8:57 pm</a>		</div>

		<p>Dear Raymond, still on the menu.</p>
<p>I&#39;d like to read your story about MN_-messages, which in MSDN mentioned only one: MN_GETHMENU.</p>
<div class="post">[<i>You must be new here. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-958253">
				<div id="div-comment-958253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kero</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-958253">
			January 9, 2012 at 11:40 am</a>		</div>

		<p>Dear Raymond, I apologize if unwittingly violated the rules of your blog link in my example.</p>
<p>But no, I&#39;m not &quot;new here&quot; but a longtime reader of your blog, in confirmation &#8211; <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2010/12/30/10110077.aspx#10110646" rel="nofollow">blogs.msdn.com/&#8230;/10110077.aspx</a> &nbsp;:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-958373">
				<div id="div-comment-958373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ywq</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120104-00/?p=8703#comment-958373">
			January 9, 2012 at 5:58 pm</a>		</div>

		<p>I have a question:I can drag a menu item,and drop it on the same menu.But how can I drag something like a shortcut,and drop it on menu? Like the IE&#39;s favorite menu.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>