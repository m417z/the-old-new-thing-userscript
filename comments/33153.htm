<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-326073">
				<div id="div-comment-326073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326073">
			November 30, 2005 at 11:21 am</a>		</div>

		<p>Did you charge him for finding his bug? :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-326093">
				<div id="div-comment-326093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326093">
			November 30, 2005 at 12:14 pm</a>		</div>

		<p>Another thing that puzzled me was, why was MAX_PATH considered to be a suitable upper limit on the name that marketing assigns to a product?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326163">
				<div id="div-comment-326163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Conti</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326163">
			November 30, 2005 at 2:48 pm</a>		</div>

		<p>Well, how DO you reliably (meaning all the way back to Win95) get the OS name?  What about back to NT v.x?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-326173">
				<div id="div-comment-326173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Moore</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326173">
			November 30, 2005 at 2:53 pm</a>		</div>

		<p>I was surprised there is no built in function to do this. All I could find was</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/getting_the_system_version.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/getting_the_system_version.asp</a><br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326183">
				<div id="div-comment-326183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">useless</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326183">
			November 30, 2005 at 3:45 pm</a>		</div>

		<p>It makes no sense to get the os name as a string.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-326193">
				<div id="div-comment-326193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Conti</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326193">
			November 30, 2005 at 3:55 pm</a>		</div>

		<p>uh, yeah.  At least until you want the string for some utility or asset tracking code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326203">
				<div id="div-comment-326203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326203">
			November 30, 2005 at 4:16 pm</a>		</div>

		<p>Chris&gt; OSVERSIONINFO and OSVERSIONINFOEX have all the flags that identify the OS, it just take a bit of bit-fiddling to work it out in some cases (eg, you have to look for VER_SUITE_PERSONAL in wSuiteMask to tell XP Pro from XP Home).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-326213">
				<div id="div-comment-326213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Conti</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326213">
			November 30, 2005 at 4:51 pm</a>		</div>

		<p>I know about those- the problem is generally future compatibility.  Prior to windows 2000, you could take &quot;Windows NT&quot; and add the version number.  Now you have to revise and re-release code for every OS version that comes out, just to get the string that&#8217;s printed on the front of the box, or in the System Properties dialog/propsheet.</p>
<p>Admins really don&#8217;t like to see software report Windows NT 5.2 if they know that the brand-spankin&#8217; new OS they installed is Windows 2003. Who could&#8217;ve guessed that NT 5.1 would have been XP?  Or that 6.0 would be Vista (assuming it doesn&#8217;t change before it actually ships)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326223">
				<div id="div-comment-326223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326223">
			November 30, 2005 at 5:07 pm</a>		</div>

		<p>For code decisions, it&#8217;s better to look at bits or use LoadLibrary to see if what you want is there. But it sure would be nice if Windows could provide a string that was complete, accurate, and matched the marketing name that was sold to the user. For example, where does OSVERSIONINFOEX tell me that the version I have is Media Center Edition? If I show an MCE user that they simply have Windows XP, will they think my program is wrong and lose confidence in its accuracy?</p>
<p>This is what the SDK recommends:</p>
<p>&quot;You can also detect which version of the Windows XP Media Center Edition is running by querying the following registry entry:</p>
<p>HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionMedia CenterIdent</p>
<p>If the value retrieved is less than 2.0, the version running is Windows XP Media Center Edition (the initial version); if the value is 2.0 or greater and less than 3.0, the version running is Windows XP Media Center Edition 2004; and if it is 3.0 or greater and less than 4.0, the version running is Windows XP Media Center Edition 2005.&quot;</p>
<p>Of course that code would be at the end of a long train of code that would query some combination of GetVersionEx, OSVERSIONINFO,OSVERSIONINFOEX, IsWow64Process, SOFTWAREMicrosoftWindows NTCurrentVersionCurrentType, and SOFTWAREMicrosoftWindows NTCurrentVersionSubVersionNumber.</p>
<p>All I want is a STRING! Even the CPU makers gave up a few years ago and put one in CPUID to prevent this kind of nonsense.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-326233">
				<div id="div-comment-326233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Conti</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326233">
			November 30, 2005 at 5:19 pm</a>		</div>

		<p>&quot;For code decisions, it&#8217;s better to look at bits or use LoadLibrary&#8230;&quot;</p>
<p>I completely agree.  It&#8217;s just annoying that you can&#8217;t get an accurate human-readable string for the purposes of, well, being read by a human.</p>
<p>Not that I would actually label most admins as human, but that&#8217;s a different discussion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326253">
				<div id="div-comment-326253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326253">
			November 30, 2005 at 6:04 pm</a>		</div>

		<p>The easiest way to get the OS name as a string is via WMI, it&#8217;s the caption properly of Win32_OperatingSystem.</p>
<p>Don&#8217;t help so much for older versions but should be pretty future proof.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-326263">
				<div id="div-comment-326263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326263">
			November 30, 2005 at 8:25 pm</a>		</div>

		<p>I use:<br />
<br />HKLMSOFTWAREMicrosoftWindows NTCurrentVersionProductName<br />
<br />or<br />
<br />HKLMSOFTWAREMicrosoftWindowsCurrentVersionProductName</p>
<p>It&#8217;s probably the wrong way to do it (since querying the registry is generally frowned upon) but it works for my use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326733">
				<div id="div-comment-326733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-326733">
			December 1, 2005 at 6:10 pm</a>		</div>

		<p>@brian:</p>
<p>&gt;&gt; It&#8217;s probably the wrong way to do it (since querying the registry is generally frowned upon) but it works for my use. &lt;&lt;</p>
<p>I&#8217;m just waiting of Raymond&#8217;s upcoming &quot;Old New Thing&quot; article about how this behavior caused all sorts of compatibility issues.</p>
<p>I mean, what&#8217;s going to happen to your program when MS comes out with the</p>
<p>HKLMSOFTWAREMicrosoftWindows VistaCurrentVersionProductName</p>
<p>registry key?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-327003">
				<div id="div-comment-327003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051130-16/?p=33153#comment-327003">
			December 2, 2005 at 2:29 pm</a>		</div>

		<p>&quot;I use: HKLM&#8230;ProductName&quot;</p>
<p>That string is non-specific. My XP Pro SP2 system says &quot;Microsoft Windows XP&quot; so to get a complete description you&#8217;ll still need to do all the API/registry black magic to add the service pack and modifiers like &quot;Media Center Edition 2005&quot;.</p>
<p>When Microsoft comes out with &quot;Windows Vista Home Theater Edition 2007&quot; we&#8217;ll be back  editing strings and spelunking new API/registry values our programs can avoid looking dumb to the user who knows what version of Windows they bought.</p>
<p>BTW, Brian, you didn&#8217;t write this piece of software did you?<br />
<br /><a rel="nofollow" target="_new" href="http://www.mustek.com.tw/Download/html/english-xp.html" rel="nofollow">http://www.mustek.com.tw/Download/html/english-xp.html</a><br />
<br />:)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>