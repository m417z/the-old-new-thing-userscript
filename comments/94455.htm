<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (21)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1267335">
				<div id="div-comment-1267335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267335">
			October 5, 2016 at 7:11 am</a>		</div>

		<p>Exercise answer: I&#8217;ve only ever dabbled in straight Win32 programming, and that a long time ago, but I suspect that you could subclass the window to handle TBM_SETPOS yourself, do whatever internal bookkeeping you need to, and then forward it on to the actual control.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1267345">
				<div id="div-comment-1267345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">viila</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267345">
			October 5, 2016 at 7:37 am</a>		</div>

		<p>What if you want to be fancy and do sub-pixel rendering or anti-aliasing so that the four positions aren&#8217;t actually identical? Granted AA would probably be a terrible idea since it would make the thumb look blurry, but subpixel positioning could be done with close to perfect fidelity and you could triple your horizontal resolution.</p>
<p>(I&#8217;ll leave exercise to the reader how to let the user position it that accurately with the mouse&#8230;)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mzzt even depth-2 parent" id="comment-1267385">
				<div id="div-comment-1267385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/The+MAZZTer' rel='external nofollow' class='url'>The MAZZTer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267385">
			October 5, 2016 at 9:50 am</a>		</div>

		<p>Then you invalidate the appropriate draw region when the position changes, which will generate your paint message.</p>
<p>If you do this you probably want to disable the default behavior to avoid getting two messages. Or possibly build your own control from scratch if it&#8217;s practical.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bboorman odd alt depth-3 parent" id="comment-1267395">
				<div id="div-comment-1267395" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267395">
			October 5, 2016 at 10:47 am</a>		</div>

		<p>&gt;Or possibly build your own control from scratch if itâ€™s practical.</p>
<p>That&#8217;s a good way to get featured on thedailywtf</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1267405">
				<div id="div-comment-1267405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267405">
			October 5, 2016 at 11:30 am</a>		</div>

		<p>Gripe time: The Daily WTF is &lt;= 80% made up (with the dubious excuse of &quot;anonymizing&quot;), which, just really? The Real WTF, to use their meme, is why people continue to read it and react as if it isn&#039;t mostly fake.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1267415">
				<div id="div-comment-1267415" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267415">
			October 5, 2016 at 11:30 am</a>		</div>

		<p>And then I spoil my gripe by using =</p>
<p>Sheesh</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1267425">
				<div id="div-comment-1267425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267425">
			October 5, 2016 at 12:26 pm</a>		</div>

		<p>We had a real investigation as to a source code leak when some code that looked like ours ended up there. Turned out it was from somebody else who hired the same consultant. So, not quite as made up as people believe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1267455">
				<div id="div-comment-1267455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267455">
			October 6, 2016 at 1:55 am</a>		</div>

		<p>You&#8217;ve got any source for your claim ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1267465">
				<div id="div-comment-1267465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267465">
			October 6, 2016 at 2:22 am</a>		</div>

		<p>The problem with the daily wtf is that they&#8217;ve done it to death, so it feels like it&#8217;s the same stories just going round and round. The only thing that changes is the stories they build around them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1267475">
				<div id="div-comment-1267475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267475">
			October 6, 2016 at 6:01 am</a>		</div>

		<p>I&#8217;ve seen a system that I had to interface with featured on tdwtf. I think that everyone involved acknowledged that they had made some horrible design decisions early on. (At least one of the project managers did to me.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman even depth-5" id="comment-1267485">
				<div id="div-comment-1267485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267485">
			October 6, 2016 at 6:23 am</a>		</div>

		<p>&gt;And then I spoil my gripe by using =</p>
<p>Not to mention that you also used the less-than sign when I presume you were trying to say greater than 80%. Kind of ruins your argument.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1267515">
				<div id="div-comment-1267515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267515">
			October 6, 2016 at 10:52 am</a>		</div>

		<p>It sure does :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1267525">
				<div id="div-comment-1267525" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267525">
			October 6, 2016 at 11:04 am</a>		</div>

		<p>Joshua: Wel let me clarify that I am sure that the technical details are generally in at least the same ballpark as the submissions, but the stories about people involved they wrap around them I don&#8217;t believe, they smell like someone&#8217;s creative writing assignments. When I hit one such story that was an elaborate description of a meeting about the problem and omg what do we do where the submitter turned up and said &#8220;yeah none of that ever happened I just thought it was wacky!&#8221; that was enough for me.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chd1 odd alt thread-even depth-1 parent" id="comment-1267365">
				<div id="div-comment-1267365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/ChDF+T' rel='external nofollow' class='url'>ChDF T</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267365">
			October 5, 2016 at 8:09 am</a>		</div>

		<p>It seems like the customer was trying to paint the numerical value as part of the trackbar, which results in a different look for every value, because there is a different number written below the actual control.<br />
Of course the customer could just add some kind of label below the trackbar and remove the number rendering code from the custom draw method. However this would break (potentially a lot of) code that updates the trackbar and now would have to update the trackbar and the label. Since the exercise is solving this problem, I guess this is what the customer went with and Raymond chose a very elegant way to implicitly include this in his post.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1267426">
				<div id="div-comment-1267426" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267426">
			October 5, 2016 at 12:27 pm</a>		</div>

		<p>I was about to post something like this. However on reasoning it out I discovered that creating a slider with precision of greater than 1 pixel (that is, more stops than pixels) is silly.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-chd1 odd alt depth-3" id="comment-1267435">
				<div id="div-comment-1267435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/ChDF+T' rel='external nofollow' class='url'>ChDF T</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267435">
			October 5, 2016 at 12:54 pm</a>		</div>

		<p>It kind of is, but sometimes you can&#8217;t avoid it: Imagine a Surface Pro 4 (high pixel density) connected to an external screen (standard pixel density). The window may be opened on the internal screen with a 1-on-1 correspondence of *your unit here* to pixels. Then the window is later moved to the external screen, the same trackbar becomes much smaller pixel wise (though the apparent size stays the same) &#8211; now you have a trackbar where 1 pixel maps to 2 (or more) of *your unit here*.<br />
To make it even more complicated, the new 1 unit distance still requires the same amount of mouse movement.<br />
So you can&#8217;t really ensure that a trackbar is non-silly in a per-screen-dpi-aware world. Coincidentally this is also an example for why it is bad to rely on a trackbar for precise input.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even depth-3" id="comment-1267545">
				<div id="div-comment-1267545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267545">
			October 6, 2016 at 12:26 pm</a>		</div>

		<p>Sometimes number of pixels increase (after resize), and you don&#8217;t want two pixels have the same position number after that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1267785">
				<div id="div-comment-1267785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Cohn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267785">
			October 7, 2016 at 10:41 pm</a>		</div>

		<p>The best approach is to have exactly one stop per pixel (adjusted to DPI). E.g. a slider that represents video progress in integer seconds is OK for typical video files of 10 minutes or more, but looks ugly for instant clips of les than 5 sec, which are so popular nowadays.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1267436">
				<div id="div-comment-1267436" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray Koopa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267436">
			October 5, 2016 at 11:31 pm</a>		</div>

		<p>I think you meant &#8220;&#8230;the code that is listening for the WM_HSCROLL or WM_VSCROLL message&#8230;&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1267546">
				<div id="div-comment-1267546" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt (Visual Studio and Development Technologies MVP with C++ focus)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267546">
			October 6, 2016 at 3:33 pm</a>		</div>

		<p>&#8220;multiple positions have the same visual appearance&#8221; should be &#8220;multiple positions have the same visual appearance under the default drawing logic&#8221;.  When custom draw is added, that rule ceases to be correct.  But the new common controls don&#8217;t have explicit owner-draw window styles the way that listbox and combobox did, so the control doesn&#8217;t have any good way to know whether or not the rule applies.</p>
<p>Which may be why the terminology is different between &#8220;owner-drawn&#8221; and &#8220;custom draw&#8221;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-odd thread-alt depth-1" id="comment-1267595">
				<div id="div-comment-1267595" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161005-00/?p=94455#comment-1267595">
			October 6, 2016 at 7:07 pm</a>		</div>

		<p>The same reason why changing value of html controls with javascript won&#8217;t generate onchange event.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>