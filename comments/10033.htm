<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (19)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-927263">
				<div id="div-comment-927263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927263">
			July 28, 2011 at 7:08 am</a>		</div>

		<p>Real Men write their own keyboard driver which emulates keystrokes. Before breakfast.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927273">
				<div id="div-comment-927273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927273">
			July 28, 2011 at 7:29 am</a>		</div>

		<p>Or you could, you know, have your program disable the screen saver while it runs.</p>
<p>Though I love SendInput. &nbsp;Used it to make a library for .NET so I can simulate keyboard/mouse input with a Wii Remote. &nbsp;Good times.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927293">
				<div id="div-comment-927293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927293">
			July 28, 2011 at 8:10 am</a>		</div>

		<p>The MAZZTer: hmm, fiddling with global state to solve a local problem? &nbsp;Please don&#39;t disable the screensaver while your program is running unless you&#39;re a presentation program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927303">
				<div id="div-comment-927303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927303">
			July 28, 2011 at 8:16 am</a>		</div>

		<p>Mark: Hopefully The MAZZTer is using local means to disable the screensaver. SetThreadExecutionState is perfectly fine for this purpose.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927323">
				<div id="div-comment-927323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Homer S.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927323">
			July 28, 2011 at 9:01 am</a>		</div>

		<p>I once used a dippy bird for such purposes. Everybody was fooled until it let me down, but luckily the unrequested fission surplus was stopped in the end, by my end.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927333">
				<div id="div-comment-927333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mason Wheeler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927333">
			July 28, 2011 at 9:44 am</a>		</div>

		<p>@Mark: Or a full-screen game. &nbsp;I&#39;ve had the screensaver toggle in the middle of long cutscenes/movies before, and it is not a pleasant experience.</p>
<p>Come to think of it, I&#39;ve also had it toggle while watching DVDs and YouTube videos. It can be more trouble than it&#39;s worth sometimes, and there are more legitimate reasons to disable it than you might think at first.</p>
<div class="post">[<i>Or just handle the WM_SYSCOMMAND/SC_SCREENSAVE message. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927343">
				<div id="div-comment-927343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">R. Bemrose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927343">
			July 28, 2011 at 10:09 am</a>		</div>

		<p>@Mason Wheeler:</p>
<p>That really depends on how the application is doing it. &nbsp;In my experience, programs that use a &quot;real&quot; full screen mode don&#39;t get interrupted by screensavers, while ones that fake it, by creating a borderless window the size of your viewing area, do get interrupted by the screen saver. &nbsp;Unless they&#39;ve used some other trick to block it, presumably like what Bob suggested.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927353">
				<div id="div-comment-927353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MikeCaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927353">
			July 28, 2011 at 10:15 am</a>		</div>

		<p>@R Bemrose: It&#39;s not a trick, it&#39;s the whole point of SetThreadExecutionState. It tells Windows &quot;even though the user may not appear to be interacting with the PC, it would be really inconvenient for that user if the system were to sleep or the display were to turn off.&quot; Programs that use it include, but are not limited to:</p>
<ul>
<li>DVD/Video Players</li>
<li>
<p>CD/DVD Burners</p>
</li>
<li>
<p>Games</p>
</li>
<li>
<p>Presentation programs</p>
</li>
<li>
<p>Voice chat clients</p>
</li>
<li>
<p>Backup programs</p>
</li>
<li>
<p>More!</p>
</li>
</ul>
<p>Many of these do not go into fullscreen mode. Some don&#39;t even have UI all the time. However, they still need to block the computer from becoming idle.</p>
<p>(Also, I suspect that fullscreen programs do not necessarily get this protection automatically. They still have to call this function too!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927363">
				<div id="div-comment-927363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/escamilio_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>escamilio@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927363">
			July 28, 2011 at 10:27 am</a>		</div>

		<p>BTW SetThreadExecutionState() does not stop the screen saver from executing&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927373">
				<div id="div-comment-927373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927373">
			July 28, 2011 at 10:59 am</a>		</div>

		<p>Waleri: Indeed, it&#39;s a good thing that it doesn&#39;t, as I need my screen saver to call SetThreadExecutionState!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927393">
				<div id="div-comment-927393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927393">
			July 28, 2011 at 1:22 pm</a>		</div>

		<p>Wait, even with ES_DISPLAYREQUIRED? That&#39;s what the function documentation tells to do for the video player apps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927413">
				<div id="div-comment-927413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927413">
			July 28, 2011 at 2:24 pm</a>		</div>

		<p>Alex: SetThreadExecutionState is actually just a power management function. Its job is to prevent the monitor and/or computer from shutting down automatically. The screensaver is somebody else&#39;s job.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927423">
				<div id="div-comment-927423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lefty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927423">
			July 28, 2011 at 3:50 pm</a>		</div>

		<p>Ok &#8211; I now know more that I need to know about disabling the screensaver without actually pressing any keys. Could someone please explain the answer to the problem about getting my credit card company to not bother with billing me even thogh I don&#39;t pay them anything?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927433">
				<div id="div-comment-927433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927433">
			July 28, 2011 at 3:54 pm</a>		</div>

		<p>@lefty: SendMessage(hWndCreditCard, WM_CLOSE, accountNum, pin);</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927443">
				<div id="div-comment-927443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Why even bother with screensavers anymore?</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927443">
			July 29, 2011 at 5:11 am</a>		</div>

		<p>These days its better to just have the screen go into power save mode.</p>
<p>Power save mode does just as much (if not more) to save your screen (CRT or otherwise) from burn-in and uses even less electricity than a screensaver does.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927513">
				<div id="div-comment-927513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/mark_4000_marksowul.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>mark@marksowul.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927513">
			July 29, 2011 at 7:19 am</a>		</div>

		<p>If I remember correctly, even if you do things right as a media player/etc, if you have the screensaver lock the computer, it will still effect the screensaver after the timeout period. &nbsp;I can&#39;t find the reference but I know that was the observed behavior with Media Center and Windows Media Player.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927663">
				<div id="div-comment-927663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927663">
			July 29, 2011 at 2:13 pm</a>		</div>

		<p>Yeah, that&#39;s the new behavior under the Vista/7 regime. Handling SC_SCREENSAVE (as Raymond mentioned earlier) doesn&#39;t prevent the machine from locking by design. It does work under XP and earlier, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927673">
				<div id="div-comment-927673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ens</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927673">
			July 29, 2011 at 5:57 pm</a>		</div>

		<p>@steveg</p>
<p>I&#39;d recommend PostMessage. &nbsp;Credit card companies like to hang onto their customers&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927733">
				<div id="div-comment-927733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Taylor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110728-00/?p=10033#comment-927733">
			July 30, 2011 at 1:30 pm</a>		</div>

		<p>It might be worth mentioned that sending WM_CHAR cannot be used to change the &#39;shift&#39; state of the keyboard. So while you might be able to fake sending characters to notepad, you will not be able to change the case of the characters.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>