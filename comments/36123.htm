<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (57)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-265803">
				<div id="div-comment-265803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reuben Harris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265803">
			March 21, 2005 at 7:39 am</a>		</div>

		<p>That&#8217;s absolutely hysterical!</p>
<p>I&#8217;m glad someone is logging this stuff&#8230; MS tech support increasingly looks like one of the most thankless jobs in the world.</p>
<p>Sysinternals or someone should make a sort of culprit-identifying tool to detect and display the [module]name of the last caller to each of the global/process settings APIs&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265793">
				<div id="div-comment-265793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dmitry Shaporenkov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265793">
			March 21, 2005 at 7:46 am</a>		</div>

		<p>Nice! It&#8217;s absolutely the best tech story I&#8217;ve seen in last weeks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265823">
				<div id="div-comment-265823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265823">
			March 21, 2005 at 7:47 am</a>		</div>

		<p>Maybe processor affinity should be added to the list of inherited properties at <a target="_new" href="http://msdn.microsoft.com/library/en-us/dllproc/base/child_processes.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/dllproc/base/child_processes.asp</a> (along with anything else that&#8217;s not listed there).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265843">
				<div id="div-comment-265843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265843">
			March 21, 2005 at 8:31 am</a>		</div>

		<p>SetProcessAffinityMask requires admin privileges (well, PROCESS_SET_INFORMATION rights) or it will fail. This is only an issue if people are viewing videos or using poorly written shell extensions while running as admin. </p>
<p>Oh wait, just about ALL of us do that, since so many programs misbehave when you try to run them in a non-godlike fashion. </p>
<p>Well thank goodness that Microsoft has never advocated this kind of chicanery. Uh &#8230;<br />
<br /><a target="_new" href="http://support.microsoft.com/kb/178650/EN-US/" rel="nofollow">http://support.microsoft.com/kb/178650/EN-US/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265853">
				<div id="div-comment-265853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265853">
			March 21, 2005 at 8:36 am</a>		</div>

		<p>Notice that the chicanery is listed as the third choice workaround, not the two actual resolutions. In other words, it&#8217;s only after the customer rejects the two &quot;correct&quot; fixes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265863">
				<div id="div-comment-265863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.1060.org/blogxter/publish/5' rel='external nofollow' class='url'>Steve loughran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265863">
			March 21, 2005 at 9:33 am</a>		</div>

		<p>I thought processor affinity was only a hint; there was nothing to stop the thread/process from being moved. </p>
<p>Didnt know about inheritance, thats why MSDN has to be so thorough; it has to compete with a platform where you can look at the source at debug time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265873">
				<div id="div-comment-265873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://perlmonks.org/?node=theorbtwo' rel='external nofollow' class='url'>James Mastros (theorbtwo)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265873">
			March 21, 2005 at 9:33 am</a>		</div>

		<p>Why does processor affinity inherit?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265883">
				<div id="div-comment-265883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/jeffdav' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265883">
			March 21, 2005 at 9:54 am</a>		</div>

		<p>I thought the reason processor affinity inherited was obvious &#8211; think about it. But apparently it&#8217;s not obvious enough. I&#8217;ll add it to the list of future topics.</p>
<p>Steve Loughran: There are two types of processor affinity, &quot;soft&quot; (just a suggestion) and &quot;hard&quot; (absolute requirement). SetThreadAffinityMask sets hard affinity; SetThreadIdealProcessor sets soft affinity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265893">
				<div id="div-comment-265893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.scarydevil.com/~peter/' rel='external nofollow' class='url'>Peter da Silva</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265893">
			March 21, 2005 at 10:04 am</a>		</div>

		<p>If Explorer ran each window in a new process by default, instead of having that choice hidden in the options, think kind of thing wouldn&#8217;t happen because that inherited affinity would &quot;go away&quot; as soon as you closed that window&#8230; right?</p>
<p>It would also be a lot more stable and reliable in general. Why isn&#8217;t that the default&#8230; is there some reason for running Explorer as a single process that I&#8217;m unable to figure out (my own psychic powers failing me here) or is it just institutional inertia?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265903">
				<div id="div-comment-265903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265903">
			March 21, 2005 at 10:08 am</a>		</div>

		<p>Raymond, there&#8217;s a problem with the Knowledge Base stylesheet (<a target="_new" href="http://support.microsoft.com/common/css/default/xmlContent.css" rel="nofollow">http://support.microsoft.com/common/css/default/xmlContent.css</a>)? It has a rule:</p>
<p>.kb div pre<br />
<br />{<br />
<br />        // various other properties omitted<br />
<br />    white-space: normal;<br />
<br />}</p>
<p>that causes sample code to be flowed in a single paragraph. IE seems to ignore the rule so it doesn&#8217;t show the problem. There was a similar problem in MSDN a while back. Can you pass the information on or let me know who I can contact about this? I don&#8217;t see an appropriate contact address on the web site.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265913">
				<div id="div-comment-265913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com/' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265913">
			March 21, 2005 at 10:19 am</a>		</div>

		<p>&quot;is there some reason for running Explorer as a single process that I&#8217;m unable to figure out&quot;</p>
<p>Performance, I should imagine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265923">
				<div id="div-comment-265923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lundie.ca/' rel='external nofollow' class='url'>Chris Lundie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265923">
			March 21, 2005 at 10:23 am</a>		</div>

		<p>I used to have a problem where every time I previewed an AVI file in Explorer, it would never release the handle, so it became difficult to change or delete AVI files. Turned out to be a bug in RealPlayer, as far as I can tell.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265933">
				<div id="div-comment-265933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ryanmy/' rel='external nofollow' class='url'>Ryan Myers [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265933">
			March 21, 2005 at 10:24 am</a>		</div>

		<p>&quot;If Explorer ran each window in a new process by default, instead of having that choice hidden in the options, think kind of thing wouldn&#8217;t happen because that inherited affinity would &quot;go away&quot; as soon as you closed that window&#8230; right?&quot;</p>
<p>Already available, just turned off by default.</p>
<p>Open an Explorer window, Tools menu, Options, go to the View tab, scroll down, and check &quot;Launch folder windows in a new process.&quot;</p>
<p>&quot;It would also be a lot more stable and reliable in general.&quot;</p>
<p>And much, much slower due to the massive number of context switches that result &#8212; which is why it&#8217;s off by default.  (Plus app compat reasons.)  But it&#8217;s there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265943">
				<div id="div-comment-265943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">l</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265943">
			March 21, 2005 at 10:43 am</a>		</div>

		<p>If you pass the message along about that stylesheet that seems to deliberately break browsers that aren&#8217;t IE, could you please have whoever wrote it come back here and explain exactly why they did this?</p>
<p>I mean, for the Opera &#8216;margin:-20px;&#8217; thing (Google for &#8216;bork&#8217;) there was an explanation that sort-of made sense (it being a side-effect of a very ugly hack for a very different problem); but why anyone would want to set a PRE tag to &#8230; well, basically do the opposite of what a PRE tag is supposed to do? Even when that command is ignored in the only browser they apparently use?</p>
<p>I know this is off topic; it&#8217;s just that this kind of idiocy annoys me to no end every time I need something from MSDN.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265953">
				<div id="div-comment-265953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265953">
			March 21, 2005 at 10:44 am</a>		</div>

		<p>I&#8217;m trying to find the owner of that stylesheet. I suspect the reason is that it&#8217;s a simple oversight.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265963">
				<div id="div-comment-265963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Re:Microsoftrelyingonthesamechicanery' rel='external nofollow' class='url'>David Walker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265963">
			March 21, 2005 at 12:08 pm</a>		</div>

		<p>In SQL 2000, using Data Transformation Services packages with ActiveX data transforms (now we&#8217;re getting technical), all the steps in the DTS package have to be set to run on the main thread if there are any package event handlers.</p>
<p>From <a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>:</p>
<p>If package event handlers coded in Visual Basic are being used, the ExecuteInMainThread property must be set TRUE. Visual Basic does not support free threading, which DTS uses.</p>
<p>Someone else&#8217;s description of the reason: &quot;Visual Basic is an apartment-threaded application and DTS is free-threaded and the two can conflict to produce the error. This is simply overcome by setting each step&#8217;s ExecuteInMainThread property to true.&quot;</p>
<p>I realize that threading models and bugs are not the same thing, but there are cases where we&#8217;re told by Microsoft to run everything in an application on the same thread.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-265973">
				<div id="div-comment-265973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265973">
			March 21, 2005 at 12:10 pm</a>		</div>

		<p>Also, I know that threads and processor affinity aren&#8217;t the same thing either, but I&#8217;ll bet that thread errors show up much more wheh you&#8217;re on a multi-processor machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-265983">
				<div id="div-comment-265983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-265983">
			March 21, 2005 at 12:26 pm</a>		</div>

		<p>Microsoft is not a single entity. There&#8217;s the COM group, the shell group, the VB group&#8230; It&#8217;s entirely possible that advise you get from the VB group conflicts with advice you get from the COM group. In the same way you might decide not to follow the rules set down by your brother. When you say that &quot;Microsoft&quot; told you to do something, you need to be more specific which group was doing the talking.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266013">
				<div id="div-comment-266013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266013">
			March 21, 2005 at 4:09 pm</a>		</div>

		<p>For any given browser, there are always at least 3 CSS solutions to any problem, one of which is a proprietary extension. (That includes our beloved FF.) Two of them will have unintended consequences in other browsers and require further workarounds, or giving up the feature, or simply living with/ignoring effects in other browsers. CSS compatibility is still nasty even across the so-called &quot;fully compliant&quot; browsers (Gecko, Opera, Safari). So don&#8217;t be too hard on the guy who did it.</p>
<p>I won&#8217;t even get into how many times I&#8217;ve become angry at &quot;Microsoft&quot; only to discover that it was a bad shell extension some app installed that trashed my system. Ones that won&#8217;t release file hooks are infurating; I just wish there was an easier way to manage them than the registry. (They&#8217;re a lot like browser plugins.) Maybe there is and I just don&#8217;t know it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266023">
				<div id="div-comment-266023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/mgrier' rel='external nofollow' class='url'>Michael Grier [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266023">
			March 21, 2005 at 4:38 pm</a>		</div>

		<p>For separate windows you can consider separate processes.  For a single window, it&#8217;s very very (very!) hard to correctly synchronize message queues so many/most shell extensions just run in the same process.</p>
<p>This is a path that we&#8217;re pursuing anyways just for better fault isolation but it&#8217;s not an easy fix.  I haven&#8217;t thought about it enough to make a claim like &quot;therefore the windowing system is fundamentally broken&quot; so feel free to make such a claim after thoughtfully considering the same problem on X windows, NeWS, etc.  AFAIK, there&#8217;s no support for a single window hierarchy that spans clients in X; only the WM aggregates windows from multiple clients.  But it&#8217;s been almost 11 years since I&#8217;ve touched X&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266043">
				<div id="div-comment-266043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266043">
			March 21, 2005 at 5:36 pm</a>		</div>

		<p>Ryan Myers replied to Peter da Silva:</p>
<p>&gt;&gt; &quot;If Explorer ran each window in a new<br />
<br />&gt;&gt; process by default, instead of having that<br />
<br />&gt;&gt; choice hidden in the options,<br />
<br />&gt;<br />
<br />&gt; Already available, just turned off by<br />
<br />&gt; default.</p>
<p>Both wrong.  There is a choice hidden in the options (as both said) but it doesn&#8217;t run each window in a new process, it only runs some windows in one separate process from some other windows.</p>
<p>Remember in Windows 95/98, when an option was added to Internet Explorer to browse in a separate process, the frequency of complete hangs/crashes/etc. of the entire Windows system dropped by half?  Maybe at some level this was considered a reduction in performance, but overall it was an improvement.</p>
<p>Windows Explorer really needs the same thing, an option to put every invocation in a separate process.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266063">
				<div id="div-comment-266063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266063">
			March 21, 2005 at 7:17 pm</a>		</div>

		<p>Michael Grier: It&#8217;s entirely possible for one X client to &quot;swallow&quot; another as a sub-window. For example I have a Mozilla plugin that can embed random applications in the browser in order to display file types that aren&#8217;t directly supported by the browser or a plugin. Those applications obviously run as separate processes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266103">
				<div id="div-comment-266103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.virtualdub.org/' rel='external nofollow' class='url'>Phaeron</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266103">
			March 21, 2005 at 9:22 pm</a>		</div>

		<p>Chris Lundie: I wrote an AVIFile handler once that would cause the same symptoms if you manually enabled its &quot;proxy&quot; mode, until I found the handle leak. The XP shell media extension is a magnet for third-party bugs, and unfortunately problems with it will extend into the common file dialog too. :(</p>
<p>Speaking of unwarranted whacking of global settings, for some reason this story reminds me of when I used to use Windows 95. Seems a lot of driver writers at that time couldn&#8217;t find a good way to avoid the &quot;browse for file&quot; dialog on driver installation other than to change the cached Windows CD path to their install folder.  You&#8217;d then blame Windows for being stupid for trying some weird directory in TEMP to install TCP/IP support.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266133">
				<div id="div-comment-266133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266133">
			March 21, 2005 at 11:58 pm</a>		</div>

		<p>&quot;Windows Explorer really needs the same thing, an option to put every invocation in a separate process.&quot;</p>
<p>That would be a great improvement indeed. Another thing that would greatly improve Explorer is making it multi-threaded, looks like it isn&#8217;t at the moment or at least threads block eachother for no reason.</p>
<p>Try opening a SMB share on a computer that doesn&#8217;t respond, explorer completely freezes while waiting for the timeout, the UI doesn&#8217;t even redraw. Is there a seperate UI thread and if so why is it blocked by the filesystem-thread ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266143">
				<div id="div-comment-266143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Goran Pušić</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266143">
			March 22, 2005 at 12:21 am</a>		</div>

		<p>Hilarious! You made this geek&#8217;s day :-))</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266153">
				<div id="div-comment-266153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266153">
			March 22, 2005 at 1:05 am</a>		</div>

		<p>l &#8211; Hanlon&#8217;s Razor: Never attribute to malice that which can be adequately explained by stupidity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266163">
				<div id="div-comment-266163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266163">
			March 22, 2005 at 1:51 am</a>		</div>

		<p>I&#8217;m wondering how .Net manage this affinity mask&#8230; Somebody know ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266193">
				<div id="div-comment-266193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266193">
			March 22, 2005 at 4:18 am</a>		</div>

		<p>I too have seen explorer freeze, really slow down or hang because one window is hung doing something (e.g. accessing a slow/non existant network share or whatever else)</p>
<p>An option (or feature) so that each explorer window is a different process (or thread) and one hung window wont hang the other explorer windows would be very usefull.<br />
<br />Although I am sure that the explorer/shell guys at Microsoft have good reasons for not implementing this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266213">
				<div id="div-comment-266213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dhiren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266213">
			March 22, 2005 at 5:02 am</a>		</div>

		<p><a target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2004/10/13/241725.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/10/13/241725.aspx</a></p>
<p>Raymond answered this when I asked it in the suggestion box a while back:</p>
<p>(quoting the relevent piece of the article)</p>
<p>&quot;Why is explorer.exe monolithic? Why wasn&#8217;t there a desktop.exe, taskbar.exe, etc?&quot;</p>
<p>    Processes are expensive.</p>
<p>So there you have it.  If each instance of explorer was in its own process, the system would crawl (or so I imagine)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266233">
				<div id="div-comment-266233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266233">
			March 22, 2005 at 5:20 am</a>		</div>

		<p>&quot;So there you have it. If each instance of explorer was in its own process, the system would crawl (or so I imagine)&quot;</p>
<p>Maybe that was true on a p100 running win95. But why is it still there ? With all the CPU time spent on visual gadgets in winXP, why not spend a little on fixing explorer ?</p>
<p>I&#8217;m not saying everything should be it&#8217;s own process, but a multithreaded explorer would be nice, so if a filesystem operation doesn&#8217;t respond I can at least cancel it and move on.</p>
<p>btw, Konqueror on my linux system does it the right way, and I haven&#8217;t seen performance problems with it at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266243">
				<div id="div-comment-266243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266243">
			March 22, 2005 at 6:28 am</a>		</div>

		<p>Aargh said:  &quot;btw, Konqueror on my linux system does it the right way, and I haven&#8217;t seen performance problems with it at all.&quot;</p>
<p>Well, on Linux creating processes is cheap.  In fact, having a fast fork() is a major goal of the kernel design team.  Wheras on windows, as dhiren said above, &quot;Processes are expensive&quot;.</p>
<p>It&#8217;s a remnant of the assumptions that the designers built into the systems years ago, and with the advent of multi-processor systems the Linux decision is paying off.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266283">
				<div id="div-comment-266283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266283">
			March 22, 2005 at 7:07 am</a>		</div>

		<p>Um, Explorer does put each window on its own thread. Fire it up under your favorite debugger if you don&#8217;t believe me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266323">
				<div id="div-comment-266323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joku</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266323">
			March 22, 2005 at 7:25 am</a>		</div>

		<p>What about having these 3rd party extensions run in some virtual explorer process? Rename the real one to something else etc. And have some stuff to manage what stuff has been installed into the virtual explorer. Oh and add a managed API for doing the most common extension stuff in XP too..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266363">
				<div id="div-comment-266363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266363">
			March 22, 2005 at 7:31 am</a>		</div>

		<p>&quot;Um, Explorer does put each window on its own thread. Fire it up under your favorite debugger if you don&#8217;t believe me.&quot;</p>
<p>I believe you, the problem is not each window having a different thread, the problem is that there are no seperate threads for the UI and the filesystem stuff. So a non-responding network FS also freezes the UI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266373">
				<div id="div-comment-266373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266373">
			March 22, 2005 at 7:41 am</a>		</div>

		<p>Explorer tries to do heavy filesystem stuff on background threads but sometimes it messes up. But this has drifted far off-topic so I&#8217;ll let it go.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266463">
				<div id="div-comment-266463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dotnetjunkies.com/weblog/sriram' rel='external nofollow' class='url'>Sriram</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266463">
			March 22, 2005 at 9:02 am</a>		</div>

		<p>This is slightly offtopic &#8211; but wouldn&#8217;t it be a good idea for Explorer to have add-in management like IE 6 SP2? I&#8217;ve seen tons of people have problems with shell extensions &#8211; and since it isnt obvious as to how you can remember them, an options UI which lets you turn on and off individual extensions (everything from icon handlers to namespace extensions) might be a usual feature</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266533">
				<div id="div-comment-266533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266533">
			March 22, 2005 at 10:18 am</a>		</div>

		<p>Yes, I read the top half. My point was that you extrapolated from the first half to the second half, concluding that &quot;Microsoft&quot; told you to do something, as if all of Microsoft agreed on the recommendation you received.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266513">
				<div id="div-comment-266513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266513">
			March 22, 2005 at 10:22 am</a>		</div>

		<p>&quot;When you say that &quot;Microsoft&quot; told you to do something, you need to be more specific which group was doing the talking.&quot;</p>
<p>Raymond, did you read the last half of my post and ignore the first half?  I was completely explicit in the post as to who within Microsoft &quot;told&quot; me to do something.  I even included the link in the post:  I was quoting from <a target="_new" href="<a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a></p>
<p>You could probably tell better than I which group within Microsoft authored the content, if that&#8217;s what you want me to tell you, but I thought that including the link at <a target="_new" href="<a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a> it would provide 100% of the relevant information.  I&#8217;m sure it was some part of the SQL server group.  That part is obvious from looking at the link that I provided, which is <a target="_new" href="<a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a></p>
<p>Yes, I did say in the post &quot;there are cases where we&#8217;re told by Microsoft to run everything in an application on the same thread&quot; when I could have reiterated that the example I posted was from the link which I included in its entirety, at <a target="_new" href="<a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="<a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a>&#8220;><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dtsprog/dtspapps_3xur.asp</a></p>
<p>David Walker</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266523">
				<div id="div-comment-266523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266523">
			March 22, 2005 at 10:23 am</a>		</div>

		<p>Aargh!  I don&#8217;t know why the link repeated itself each time I included it, I didn&#8217;t do that on purpose.  I would use a Preview button if the forum software had one&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266573">
				<div id="div-comment-266573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin Olbrantz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266573">
			March 22, 2005 at 11:23 am</a>		</div>

		<p>&quot;Well, on Linux creating processes is cheap.&quot;</p>
<p>I&#8217;d read that in several pieces of literature (rather, that Unix is far superior to Windows as far as process efficiency, such as this), but I didn&#8217;t really know the technical details. Can anybody recommend some literature about how processes differ between Unix and Windows, and why Unix is so much better? Sorry for getting further off topic, but with my attention span, if I don&#8217;t ask now, I&#8217;ll forget about it (like I&#8217;ve done in the past on this topic) :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266663">
				<div id="div-comment-266663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266663">
			March 22, 2005 at 1:14 pm</a>		</div>

		<p>Justin: Arguably, process creation is cheap on Unix because it needs to be cheap. Concurrency and communication between programs are normally done with separate processes. Windows (in its 32-bit versions) was written with the assumption that programs would normally use multithreading for concurrency and DLLs for extensibility, so there wasn&#8217;t the same concern about the cost of creating processes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266673">
				<div id="div-comment-266673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wesha</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266673">
			March 22, 2005 at 1:58 pm</a>		</div>

		<p>Another perfect example of &quot;sweeping the dust underneath the carpet&quot; approach. Don&#8217;t know how to fix a pesky problem? Hide the visible sympthoms!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266743">
				<div id="div-comment-266743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codinghorror.com/blog/' rel='external nofollow' class='url'>Jeff Atwood</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266743">
			March 22, 2005 at 9:24 pm</a>		</div>

		<blockquote><p>
  I thought the reason processor affinity inherited was obvious &#8211; think about it. But apparently it&#8217;s not obvious enough. I&#8217;ll add it to the list of future topics. </p>
<p>Isn&#8217;t it because cross-processor communication is extremely expensive? Thus you would typically want all the &quot;children&quot; of a given process to inherit the same CPU&#8211; unless you have specific reasons for them to be on other CPUs.</p>
<p>Everything&#8217;s a bandwidth problem, if you dig deep enough..
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266763">
				<div id="div-comment-266763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tech support dude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266763">
			March 22, 2005 at 10:54 pm</a>		</div>

		<p>We&#8217;ve experienced many similar problems at the wetware level. Our software has extremely fine-grained internal locking, and has been pretty heavily tested on multiprocessor systems. It turns out that users are really good at creating rendezvous&#8217; by trying to share single mutex-protected objects across all threads on all CPUs, creating pileups of threads behind the object and reducing the overall performance to that of a single-CPU system. Further questioning of various users who were having problems revealed that a large number of them really didn&#8217;t understand threads, ranging from complete incomprehension of the whole concept (&quot;What, you mean you can have two thingies executing as part of the same program? Naaahhh, pull the other one&quot;) to simply not understanding how to manage objects in the presence of multiple threads. Because of this, our documentation now includes a Threads for Dummies-style section right at the start to tell programmers what threads are, how they work, how to manage objects in the presence of multiple threads, etc etc.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266853">
				<div id="div-comment-266853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266853">
			March 23, 2005 at 8:57 am</a>		</div>

		<p>Ryan Myers wrote:</p>
<p>&gt; And much, much slower due to the<br />
<br />&gt; massive number of context switches<br />
<br />&gt; that result &#8212; which is why it&#8217;s<br />
<br />&gt; off by default. (Plus app compat<br />
<br />&gt; reasons.) But it&#8217;s there. </p>
<p>Please explain this &quot;much, much slower&quot; to your MSFT fellows who are proposing to run LUA: if the switch ain&#8217;t set you won&#8217;t be able to execute a second EXPLORER.EXE with administrative rights at all!<br />
<br />So running in different processes is REALLY essential for running with different credentials.<br />
<br />Here &quot;speed&quot; doesn&#8217;t matter,but security.<br />
<br />I&#8217;m working with this switch for years and never found it to slow down my system(s).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266913">
				<div id="div-comment-266913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266913">
			March 23, 2005 at 10:50 am</a>		</div>

		<p>I would have written &quot;The DTS team at Microsoft says to run everything on one thread because of a conflict with VB.&quot;  It&#8217;s a workaround not a preferred configuration.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-266903">
				<div id="div-comment-266903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266903">
			March 23, 2005 at 10:53 am</a>		</div>

		<p>You&#8217;re right, Raymond, I should have clarified my comment by saying that &quot;Microsoft in this case with this software says to run everything on one thread&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-266933">
				<div id="div-comment-266933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.ru/personal/orangy/PermaLink.aspx?guid=b538c52a-ede2-4d12-8b7f-af1132b88ed7' rel='external nofollow' class='url'>Managed Orangy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-266933">
			March 23, 2005 at 2:31 pm</a>		</div>

		<p>То есть, как не надо фиксить баги&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-413793">
				<div id="div-comment-413793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.haidongji.com/2006/08/25/psychic-connection/' rel='external nofollow' class='url'>The Ji Village News &raquo; Psychic connection</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-413793">
			August 25, 2006 at 11:41 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.haidongji.com/2006/08/25/psychic-connection/" rel="nofollow">http://www.haidongji.com/2006/08/25/psychic-connection/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-473373">
				<div id="div-comment-473373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.awasu.com/weblog/?p=364' rel='external nofollow' class='url'>Awasu &raquo; If it was that straight-forward, I wouldn&#8217;t have called the Help Desk!</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-473373">
			February 18, 2007 at 3:38 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.awasu.com/weblog/?p=364" rel="nofollow">http://www.awasu.com/weblog/?p=364</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-481123">
				<div id="div-comment-481123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/tess/archive/2007/03/12/high-cpu-in-gc-and-other-badness-caused-by-setprocessaffinitymask.aspx' rel='external nofollow' class='url'>If broken it is, fix it you should</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-481123">
			March 12, 2007 at 11:31 am</a>		</div>

		<p>I thought I&#8217;d share a support story with you from a very interesting case I have. My customer is running</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-546273">
				<div id="div-comment-546273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mcfunley.com/cs/blogs/dan/archive/2007/09/01/1521.aspx' rel='external nofollow' class='url'>Dan McKinley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-546273">
			September 1, 2007 at 2:32 pm</a>		</div>

		<p>Here&#8217;s a problem:You have an application that&#8217;s hanging permanently or temporarily.The hang does not&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-556313">
				<div id="div-comment-556313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.andrewferguson.net/2007/10/03/psychic-debugging-why-doesnt-xyz-work-it-just-says-lmnop/' rel='external nofollow' class='url'>Andrew Ferguson dot NET &raquo; Blog Archive &raquo; Psychic Debugging: Why doesn&#8217;t XYZ work? It just says LMNOP!</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-556313">
			October 3, 2007 at 8:42 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.andrewferguson.net/2007/10/03/psychic-debugging-why-doesnt-xyz-work-it-just-says-lmnop/" rel="nofollow">http://www.andrewferguson.net/2007/10/03/psychic-debugging-why-doesnt-xyz-work-it-just-says-lmnop/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-571473">
				<div id="div-comment-571473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.rauschkinda.at/blog/index.php?/archives/790-dont-mess-with-my-cpu-affinity,-explorer.exe!.html' rel='external nofollow' class='url'>Rauschkinda.at blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-571473">
			November 27, 2007 at 2:17 pm</a>		</div>

		<p>Vor kurzem ist mir aufgefallen, dass einige Prozesse auf meinem Core2 Duo Windows XP nur einen Prozessorkern nutzen. Ueber den Task Manager &#8211; dort mit Rechtsklick auf den Prozess und &quot;Zugeh�rigkeit festlegen&quot; bzw &quot;Set affinity&quot; &#8211; stellte ich fest, dass</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-571593">
				<div id="div-comment-571593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tacticalgamer.com/hardware-software-discussion/103081-solution-windows-uses-only-one-core-multi-core-system.html#post843291' rel='external nofollow' class='url'>Solution: Windows uses only one core on a multi core system - Tactical Gamer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-571593">
			November 27, 2007 at 4:48 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.tacticalgamer.com/hardware-software-discussion/103081-solution-windows-uses-only-one-core-multi-core-system.html#post843291" rel="nofollow">http://www.tacticalgamer.com/hardware-software-discussion/103081-solution-windows-uses-only-one-core-multi-core-system.html#post843291</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-618393">
				<div id="div-comment-618393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com/?p=384' rel='external nofollow' class='url'>wisefaq.com &raquo; The Case Of The First Problem</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-618393">
			April 12, 2008 at 6:04 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.wisefaq.com/?p=384" rel="nofollow">http://blog.wisefaq.com/?p=384</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-642683">
				<div id="div-comment-642683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.microsoft.co.il/blogs/sasha/archive/2008/06/28/the-case-of-regsvr32-and-the-haunted-dll.aspx' rel='external nofollow' class='url'>All Your Base Are Belong To Us</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050321-00/?p=36123#comment-642683">
			June 28, 2008 at 5:19 am</a>		</div>

		<p>Last week I&amp;#39;ve resolved a simple &amp;quot;debugging&amp;quot; case by phone, and figured that it might benefit</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>