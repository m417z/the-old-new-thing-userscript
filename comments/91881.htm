<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (38)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-1210351">
				<div id="div-comment-1210351" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210351">
			October 30, 2015 at 7:19 am</a>		</div>

		<p>The .zip specification specifies optional fields for NTFS (64-bit MAC times) and Unix (32-bit MA times) but I guess Explorer does not support them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210341">
				<div id="div-comment-1210341" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210341">
			October 30, 2015 at 8:23 am</a>		</div>

		<p>@skSdnW: ZIP gained this ability quite a bit after it was first introduced (sometime between 1993 and 2001, according to the published APPNOTEs), so not supporting it is quite understandable. Also it would provoke suppport calls &quot;sometimes my ZIP extracts to the correct time of the original file, sometimes not. WTF?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210331">
				<div id="div-comment-1210331" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">viila</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210331">
			October 30, 2015 at 8:52 am</a>		</div>

		<p>@engywuck Might&#39;ve been understandable in early 2000s, but, c&#39;mon, it&#39;s been 15+ years!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210321">
				<div id="div-comment-1210321" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210321">
			October 30, 2015 at 9:23 am</a>		</div>

		<p>@viila: if the goal of Explorer is to create Zip files with maximum compatibility, then it&#39;s continued use of MS-DOS timestamps is understandable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210301">
				<div id="div-comment-1210301" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frenchguy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210301">
			October 30, 2015 at 10:06 am</a>		</div>

		<p>@morlamweb: These fields can be safely used anyway, if an extractor can simply ignore any extra field it doesn&#39;t support. The MS-DOS timestamp fields must still be present anyway. And I expect the ZIP extractor used by Explorer to be able to read these fields.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210291">
				<div id="div-comment-1210291" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210291">
			October 30, 2015 at 10:57 am</a>		</div>

		<p>@Raymond: &quot;And the reason the time increases to the nearest two-second interval rather than rounding is so that files do not go backward in time.&quot;</p>
<p>Wouldn&#39;t it be useful to allow files to go backward in time? &nbsp;That way, Windows 7 could have been shipped in 1995.</p>
<p>And all of the problems that need a time machine to solve, would be solvable!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210281">
				<div id="div-comment-1210281" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timothy Byrd (ETAP)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210281">
			October 30, 2015 at 11:09 am</a>		</div>

		<p>&quot;if an extractor can simply ignore any extra field it doesn&#39;t support&quot;</p>
<p>After reading this blog, you can still make the assumption that all extractors were written to do this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210271">
				<div id="div-comment-1210271" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210271">
			October 30, 2015 at 11:16 am</a>		</div>

		<p>@Timothy Byrd: my thoughts exactly. &nbsp;How can one be so sure that all ZIP file extractors would safely ignore those fields that they do not support? &nbsp;If max compatibility is the goal of Explorer (an assumption, I know, but a safe one to make), then creating ZIP files without the new timestamps is the safe way to go.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 even thread-even depth-1" id="comment-1210261">
				<div id="div-comment-1210261" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210261">
			October 30, 2015 at 11:49 am</a>		</div>

		<p>Feature Request From: @frenchguy</p>
<p>Explorer should support the new(ish) timestamp fields for .ZIP files when available.</p>
<p>To: @frenchguy</p>
<p>Request Received. &nbsp;Your feature has been assigned an initial weight of -100 points. &nbsp;The link below will provide you with some insight into the point ranking system.</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/ericgu/archive/2004/01/12/57985.aspx">blogs.msdn.com/&#8230;/57985.aspx</a></p>
<p>Thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210241">
				<div id="div-comment-1210241" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210241">
			October 30, 2015 at 1:54 pm</a>		</div>

		<p>Good news: this post serves as a reminder that for most people in the US and Canada, time changes Sunday.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210231">
				<div id="div-comment-1210231" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Darran Rowe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210231">
			October 30, 2015 at 2:02 pm</a>		</div>

		<p>Although due to rounding errors, the post came to late for those whose time zones changed last week.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210221">
				<div id="div-comment-1210221" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210221">
			October 30, 2015 at 2:32 pm</a>		</div>

		<p>@Timothy Byrd: speaking of ZIP file extractors&#8230;</p>
<p>One project I inherited had a ZIP file extractor DLL. I tracked its source, and found out it was a very old open-source ZIP extractor component written in Delphi. We had a bit of a problem generating ZIP files it would accept; Info-ZIP (the &quot;zip&quot; command on most Unix systems, though we used a Windows build of it) worked reliably, so I standardized on it.</p>
<p>So yeah, problematic ZIP extractors do exist (though that one probably didn&#39;t choke on Unix timestamps in ZIP files).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210211">
				<div id="div-comment-1210211" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob Wiyadabebe-Iytsaboi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210211">
			October 30, 2015 at 2:35 pm</a>		</div>

		<p>@Nick: Doesn&#39;t the time change for all people everywhere from each moment to the next, regardless of their location? ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210201">
				<div id="div-comment-1210201" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210201">
			October 30, 2015 at 2:37 pm</a>		</div>

		<p>@Darran Rowe: or two weeks ago (&quot;Last DST change: DST began at Sáb 2015-10-17 23:59:59 BRT / Dom 2015-10-18 01:00:00 BRST&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1" id="comment-1210191">
				<div id="div-comment-1210191" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210191">
			October 30, 2015 at 8:14 pm</a>		</div>

		<p>Using ZIP these days is a folly by itself. There is 7z and RAR. </p>
<p>Microsoft has dumped ZIP in its update formats in favor of delta-compression scheme. Why not in Office documents and Windows itself? Well, it is not like I am waiting for Microsoft anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210181">
				<div id="div-comment-1210181" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nikos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210181">
			October 30, 2015 at 11:57 pm</a>		</div>

		<p>here is a shell extension based on 7zip that does zipfolders (and 7z/rar folders) that appear to store the file date with better accuracy for windows explorer: (if created by 7zip in the first place)</p>
<p><a rel="nofollow" target="_new" href="http://zabkat.com/blog/compressed-folder-shell-extension.htm">zabkat.com/&#8230;/compressed-folder-shell-extension.htm</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210171">
				<div id="div-comment-1210171" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210171">
			October 31, 2015 at 6:07 am</a>		</div>

		<p>@Fleet Command: 7z and RAR are great compression schemes, but they lack the universality of ZIP. I can send anyone a ZIP file and be almost 100% certain that they will be able to extract files without having to acquire any other tool; I can&#39;t say the same thing about other formats. I&#39;d love to use some other method (7z and BZIP2/XZ&#39;d TAR files are my current favourites) but until they become super-popular the ZIP format is here to stay.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210161">
				<div id="div-comment-1210161" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Piotr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210161">
			October 31, 2015 at 11:23 am</a>		</div>

		<p>@Fleet Command: „Microsoft has dumped ZIP in its update formats in favor of delta-compression scheme. Why not in Office documents and Windows itself?“</p>
<p>Delta compression means sending the difference between an old and a new version. It&#39;s useless for office documents – you would have to send the original along, thus sending more data than before. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1" id="comment-1210151">
				<div id="div-comment-1210151" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210151">
			October 31, 2015 at 2:13 pm</a>		</div>

		<p>@Piotr: It seems you&#39;ve misunderstood the place of emphasis. The emphasis is on dumping not delta. i.e., they had the courage to dump the format in one place. They can do it in another. As another example of dumping ZIP, many of Microsoft self-extracting installers now employ 7z compression. Example: NDP46-KB3045557-x86-x64-AllOS-ENU.exe. (.NET Framework 4.6.)</p>
<p>And the ZIP algorithm in Office documents is not exactly top notch. Recompress them with 7zip Manager (using ZIP compression!) and you get a better size with no compatibility loss. A 12 MB .docx file becomes 9 MB.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210141">
				<div id="div-comment-1210141" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210141">
			November 1, 2015 at 6:01 am</a>		</div>

		<p>&quot;If the file time went backward, then the freshen operation would always report that there were files that needed to be updated.&quot;</p>
<p>No, not if you implemented logic to detect that case. But that&#39;s too hard I guess.</p>
<p>And btw, a 64-bit OS year 2015 should *NOT* be compatible with 16-bit OS from early 80s.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1" id="comment-1210121">
				<div id="div-comment-1210121" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210121">
			November 1, 2015 at 5:18 pm</a>		</div>

		<p>@640k: It is impossible to detect the logic because in doing so, a problem similar to &quot;Did the egg come first or the &nbsp;chick?&quot; occurs. The 64-bit MAC time extension is the only real solution.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1210111">
				<div id="div-comment-1210111" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210111">
			November 1, 2015 at 5:20 pm</a>		</div>

		<p>@Timothy Byrd: If softwares cannot ignore optional fields, we cannot have XML format.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210101">
				<div id="div-comment-1210101" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210101">
			November 1, 2015 at 10:59 pm</a>		</div>

		<p>@cheong00: there are dozens (or maybe hundreds, if counting internal ones) of unzip libraries, some of which go back to the early nineties. Can you garantee none of them will choke on this &quot;extra field&quot; (as it is called in ZIP documentation)? Sure, the concept of &quot;extra field&quot; was in ZIP since the first version, but I&#39;m pretty sure there&#39;s at least one implementation of &quot;that field&#39;s never used anyway&quot;. XML otoh is by definition optional field upon optional field &#8212; and I&#39;ve seen more than one handwritten parser choke when manually editing an otherwise automatically generated file and adding an extra field (or making a typo).</p>
<p>Would it be nice if explorer would use this extra timestamp field upon extraction? Sure. But then you have an extra codepath just for this case, which means another test case for QA, plus at least some support calls &#8212; and all this for an unusual case anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210091">
				<div id="div-comment-1210091" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210091">
			November 2, 2015 at 2:48 am</a>		</div>

		<p>The /FFT switch is also essential if you&#39;re robocopying files up from a local NTFS-format drive to your OneDrive. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210071">
				<div id="div-comment-1210071" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210071">
			November 2, 2015 at 7:17 am</a>		</div>

		<p>@Fleet Command:</p>
<p>Microsoft doesn&#39;t really own the Office formats anymore, the ISO does (ISO-29500). &nbsp;You could wade through all of the (huge) ISO standard to see if better compression could be had without changing the standard. &nbsp;I somehow doubt it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210051">
				<div id="div-comment-1210051" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frenchguy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210051">
			November 2, 2015 at 8:17 am</a>		</div>

		<p>@Engywuck: it is completely safe for Explorer to read these fields if they&#39;re present (they have been in existence for 15 years, so an extractor made in the last few years should definitely support them). The compatibility problems can only arise when creating archives (and writing the aforementioned fields).</p>
<p>@Timothy Byrd: Non-conforming extractors can choke, for all I care. The only reservation I have is &quot;Does any version of the specification allow an extractor to choke on an unknown extra field?&quot; If it does, then Explorer shouldn&#39;t write those fields (to maintain compatibility).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210041">
				<div id="div-comment-1210041" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210041">
			November 2, 2015 at 9:01 am</a>		</div>

		<p>@640k: Why should a newer version of an OS introduce gratuitous incompatibilities with older versions for no good reason?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1210011">
				<div id="div-comment-1210011" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210011">
			November 2, 2015 at 4:42 pm</a>		</div>

		<p>&quot;Microsoft has dumped ZIP in its update formats in favor of delta-compression scheme.&quot;</p>
<p>Wrong!</p>
<p>Microsoft uses .CAB, not .ZIP, since 20 years, and both SetupAPI and MSI support it, directly/internally.</p>
<p>Take a look at the installation media of Windows 9x, ME, NT4, 2000, XP and 2003. Or rename an .MSU to .CAB and double-click it.</p>
<p>&quot;As another example of dumping ZIP, many of Microsoft self-extracting installers now employ 7z compression.&quot;</p>
<p>Have you but read their price tag&quot;?</p>
<p>It says VULNERABLE, good for an escalation of privilege!</p>
<p>I prefer .MSI with an embedded .CAB (or .INF plus .CAB) about all these self-extracting installers: neither SetupAPI nor MSI have the vulnerabilities of ALL this self-extracting cruft.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1210001">
				<div id="div-comment-1210001" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pkarc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1210001">
			November 2, 2015 at 5:19 pm</a>		</div>

		<p>The Old New Thing, Time Machine Edition</p>
<p>=======================================</p>
<p>Why does my unzip utility crash when I try to extract files from a ZIP archive created by Windows Desktop Retro Edition XIV?</p>
<p>10-30-2023 2:00PM</p>
<p>Several years ago we saw that the timestamp of a file would increase by up to 2 seconds when you archived in a ZIP file using Windows Explorer. This was due to a limitation in Explorer&#39;s compression routines that supported only the legacy ZIP archive format of recording file times in MS-DOS format, making those time stamps subject to a two-second resolution limitation. </p>
<p>In response to comments to that article, Explorer was updated to take advantage of optional fields in the ZIP specification that allow for time stamps in &nbsp;NTFS format (64-bit MAC times). &nbsp;ZIP programs that do not understand those optional fields are supposed to ignore them, in which case the MS-DOS time stamp (which is also required to be in the ZIP record for the file) would be used.</p>
<p>However, it turns out that approximately 2% of the ZIP extraction utilities used in the real world crash upon encountering optional fields such as these. &nbsp;Who would have guessed? &nbsp;2% may not seem like a lot, but when your user base reaches into the tens of millions, that 2% can add up to a lot of support incidents.</p>
<p>Bonus Chatter: Even people who have ZIP utilities that do not crash on encountering the option filed occasionally run into problems. For example one program might understand the NTFS formatted time stamp and act on it, while another program only deals with the MS-DOS formatted time stamp. This can result in the two programs repeatedly re-processing the file thinking that the one in the archive is incorrect due to mismatches with what each program thinks the time stamp of the archived file should be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1209951">
				<div id="div-comment-1209951" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frenchguy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1209951">
			November 3, 2015 at 2:29 am</a>		</div>

		<p>@pkarc: To fix the problem, install a conforming unzip utility (insert relevant links).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1209881">
				<div id="div-comment-1209881" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1209881">
			November 3, 2015 at 7:32 am</a>		</div>

		<p>@frenchguy: and if the unzip tool is not a standalone program, but a library embedded in an application? &nbsp;What should the user do in that scenario? &nbsp;Updates for the unzip library may be available, or they may not; the developers may or may not be interested in updating their library, because it may mean rolling updates out to a large user base, for very little benefit. &nbsp;If the MS-DOS timestamps in Zip files produced by Explorer bother you so much, then why not use a different compression tool? &nbsp;You&#39;re not forced to use Explorer for file compression and decompression.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1209811">
				<div id="div-comment-1209811" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1209811">
			November 3, 2015 at 9:53 am</a>		</div>

		<p>Then preprocess your ZIP archives before passing them to the broken program linked against the broken library.</p>
<p>I find it real funny for someone to demand that Explorer be frozen because they don&#39;t want to change and then immediately tell someone else to change their ways. &nbsp;Just what do you think makes an old broken program more important than new programs that could benefit from a correction? &nbsp;Some developers&#39; lack of interest? &nbsp;Because it sure isn&#39;t that these optional fields were sprung on them yesterday or defined in an incompatible manner.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1211951">
				<div id="div-comment-1211951" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1211951">
			November 3, 2015 at 7:40 pm</a>		</div>

		<p>@morlamweb: Same can be said when Microsoft decided to use Unicode filenames in Zip archive. IMO when they implement that, all resistance for changes that made before Unicode filename support (Zip format v6.3.0 published on 2006) are pointless.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1211911">
				<div id="div-comment-1211911" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frenchguy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1211911">
			November 4, 2015 at 7:20 am</a>		</div>

		<p>@morlamweb: To be honest, I don&#39;t really need the extra precision in timestamps (and the MS-DOS timestamps are going to stay, since they&#39;re mandatory). But refusing to take advantage of newer features (especially if they have existed for 15 years) because it would break non-conforming programs is above and beyond maintaining compatibility (which is hard enough to do when it only involves conforming programs).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1211781">
				<div id="div-comment-1211781" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1211781">
			November 4, 2015 at 2:56 pm</a>		</div>

		<p>@cheong00: Explorer supports Unicode filenames; therefore, adding support for Unicode filenames to it&#39;s Zip compression/decompression routines would have enough importance to overcome the famous 100 point deficit for new features. &nbsp;After all, users have the not-unreasonable expectation that file names, even Unicode ones, would survive a Zip compression &amp; decompression round-trip intact. &nbsp;A two-second or less difference in file times, however, would likely go unnoticed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1211761">
				<div id="div-comment-1211761" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1211761">
			November 4, 2015 at 5:44 pm</a>		</div>

		<p>I mean, if you count the number of old Zip libraries that chokes when it see Zip files with Unicode filename entries to the number of Zip library that chokes when it see an extra field that is marked as optional in the standard on day 1, adding extra field is no big deal.</p>
<p>Not to mention that in Zip format version 6.3.2 (2007), they decided to add InfoZip&#39;s way of handling Unicode filename into standard. (By using their way, instead of tweaking the language encoding bit for specify the filename is in UTF-8, they stored UTF-8 filename in extra field 0x7075 and store CP437 compatible filename (I assume that to be the filename in 8.3 format) in the original field)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1211661">
				<div id="div-comment-1211661" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1211661">
			November 5, 2015 at 11:44 am</a>		</div>

		<p>Why complain about a 2 second difference? FAT and therefore zip doesn&#39;t support Daylight Savings Time either. So for about half the year anything zipped comes out shifted by a full hour (and up to 2 seconds).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1212912">
				<div id="div-comment-1212912" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sense</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151030-00/?p=91881#comment-1212912">
			November 5, 2015 at 8:23 pm</a>		</div>

		<p>I, too, think the real argument is minus 100 points for implementing this feature.</p>
<p>Implementing this feature leads to various QA scenarios, probable compatibility issues, possible support calls and much more trouble than anyone bothers. It works as is now, with near to no drawbacks.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>