<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/oldnewthing/20190103-00/?p=100625#respond" style="display:none;">Cancel reply</a></small></h3><p class="must-log-in">You must be <a href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">logged in</a> to post a comment.</p>	</div><!-- #respond -->
	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-koldude even thread-even depth-1" id="comment-1375075">
				<div id="div-comment-1375075" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375075">
			January 3, 2019 at 9:28 am</a>		</div>

		<p>It would be nice to have a <code>UNICODE_ONLY</code> macro that undefs all the ANSI symbols so you can check if you&#8217;re misusing things.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matteo odd alt thread-odd thread-alt depth-1 parent" id="comment-1375095">
				<div id="div-comment-1375095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375095">
			January 3, 2019 at 10:27 am</a>		</div>

		<blockquote><p>While they&#8217;re at it, the customer should consider abandoning the ANSI version altogether and just using the Unicode one.</p></blockquote>
<p>To be honest, in 2019 I would just like to use narrow characters with UTF-8 everywhere and forget forever about the WCHAR tax.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks even depth-2 parent" id="comment-1375125">
				<div id="div-comment-1375125" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375125">
			January 3, 2019 at 1:21 pm</a>		</div>

		<p>Windows 10 supports it but I don&#8217;t see how it can ever be enabled by default (breaks all non-ASCII ANSI legacy apps).</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-koldude odd alt depth-3 parent" id="comment-1375135">
				<div id="div-comment-1375135" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375135">
			January 3, 2019 at 1:58 pm</a>		</div>

		<p>I didn&#8217;t think it did. There are a lot of W only interfaces.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-joshudson even depth-4" id="comment-1375145">
				<div id="div-comment-1375145" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Joshua_______' rel='external nofollow' class='url'>Joshua_______</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375145">
			January 3, 2019 at 2:02 pm</a>		</div>

		<p>Making wrappers in .lib files is easy, especially since you need to recompile new applications with a supporting libc to even use such a thing. (That is, except for the ones compiled against gcc against liberty or sdl2 which already understand.)</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt depth-4" id="comment-1375165">
				<div id="div-comment-1375165" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375165">
			January 3, 2019 at 6:27 pm</a>		</div>

		<p>There is a &#8220;Beta&#8221; checkbox for it in the region settings in the classic control panel. I don&#8217;t remember if it is available for everyone or just insider builds.</p>
<p>But again, no legacy ANSI application with a GUI expects a mismatch between the current locale and the active codepage. This setting only works with Unicode applications (Notepad etc.), English only applications, and ported POSIX command line tools.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-warrenelven-ca even depth-2 parent" id="comment-1375155">
				<div id="div-comment-1375155" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/warrens' rel='external nofollow' class='url'>warrens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375155">
			January 3, 2019 at 4:02 pm</a>		</div>

		<p>Maybe you want that for yourself, but it&#8217;s not a good idea in a global context.  UTF-8 is more efficient at representing ASCII, yes, but significantly less efficient at representing Asian character sets.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1375205">
				<div id="div-comment-1375205" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375205">
			January 4, 2019 at 10:04 am</a>		</div>

		(The content was deleted per user request)
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even depth-3 parent" id="comment-1375215">
				<div id="div-comment-1375215" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375215">
			January 4, 2019 at 10:06 am</a>		</div>

		<p>No, UTF-8 is not &#8220;significantly less efficient at representing Asian character sets&#8221;.  Please read the descriptions and the charts at <a href="http://utf8everywhere.org/" rel="nofollow">http://utf8everywhere.org/</a>.  Specifically, &#8220;The Chinese translation of this manifesto takes 58.8 KiB in UTF-16, and only 51.7 KiB in UTF-8.&#8221;  And there&#8217;s a link to the Chinese translation of that page, which is almost all Asian characters.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-geelaw odd alt depth-4 parent" id="comment-1375255">
				<div id="div-comment-1375255" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Gee+Law' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375255">
			January 4, 2019 at 3:50 pm</a>		</div>

		<p>There is a ton of non-Asian characters in the text in the Chinese version of that manifesto. Moreover, the document is in HTML so it uses even more Latin characters. For Latin characters the rate is 1:2 (UTF-8 vs UTF-16), whereas for Chinese characters it’s 3:2, so a moderate mix of Latin and Asian characters would be about equally efficiently encoded by UTF-8 and UTF-16. A good example scenario of using UTF-16 (or GBwhatever/Big5) would be a txt story book in Chinese instead.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-matteo even depth-5" id="comment-1375275">
				<div id="div-comment-1375275" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375275">
			January 4, 2019 at 4:28 pm</a>		</div>

		<p>A 50% growth of size of Asian-languages text IMO is mostly irrelevant, exactly as a 100% growth of western text was mostly irrelevant for UTF-16 (although, maybe slightly more, given that you often have huge blobs of machine-generated blurbs of ASCII text &#8211; think XML stuff &#8211; while it&#8217;s more likely that Asian languages text is intended for human consumption, so it&#8217;s probably less stuff).</p>
<p>For archival purposes once you zip it the difference mostly disappears, for elaboration I cannot think of a time where a 50% increase of size in memory of <i>textual data</i> would have ever caused me any problem.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com0003bffd09811eab odd alt thread-even depth-1" id="comment-1375105">
				<div id="div-comment-1375105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Paul_Topping2' rel='external nofollow' class='url'>Paul_Topping2</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20190103-00/?p=100625#comment-1375105">
			January 3, 2019 at 10:35 am</a>		</div>

		<p>It&#8217;s very dangerous to mix &#8230;A and &#8230;W references with implicit ones. Type-checking would usually catch any problems but not always, as this example shows. I used to maintain a codebase that was built ANSI but referred to many &#8230;W APIs. It is easy to get this stuff wrong. I agree with kantos&#8217; idea of a UNICODE_ONLY macro.</p>

		<div class="reply"><a rel="nofollow" class="comment-reply-login" href="https://blogs.msdn.microsoft.com/oldnewthing/wp-login.php?redirect_to=https%3A%2F%2Fblogs.msdn.microsoft.com%2Foldnewthing%2F20190103-00%2F%3Fp%3D100625">Log in to Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>
<!-- COMMENTS END -->
</div></td></tr></table>