<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (24)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-137553">
				<div id="div-comment-137553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bryon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137553">
			January 21, 2004 at 7:07 am</a>		</div>

		<p>assume win64.  better people get used to compliant code sooner rather than later.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137563">
				<div id="div-comment-137563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.digiwar.com' rel='external nofollow' class='url'>Jeroen-bart Engelen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137563">
			January 21, 2004 at 7:31 am</a>		</div>

		<p>I aggree. Show us the compliant way. That way we can learn. I know of no excuse for a serious developer not to use the latest Platform SDK.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137583">
				<div id="div-comment-137583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.whirlingdervishes.com' rel='external nofollow' class='url'>Henk Devos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137583">
			January 21, 2004 at 7:45 am</a>		</div>

		<p>Yes please use compliant code.<br />
<br />I have also just made my own code compliant.<br />
<br />What i do is include definitions for the new types in my headers. They can be turned on by a #define.<br />
<br />I do know of very good reasons for not using the latest platform sdk.<br />
<br />Every time when you install a new platform sdk you have a risk of code not compiling or running anymore.<br />
<br />For me this has been the case many times. sometimes it takes me several days to get everything fixed.<br />
<br />So you can only do this when you have enough time to fix everything up, and for example not when you are about to release a new version of your product.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137593">
				<div id="div-comment-137593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim Causey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137593">
			January 21, 2004 at 7:48 am</a>		</div>

		<p>Show us the right way; now that you can download the Platform SDK for free, there is no excuse for not having it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137603">
				<div id="div-comment-137603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137603">
			January 21, 2004 at 7:49 am</a>		</div>

		<p>You should toss the Platform SDK link in your Links section and maybe put some gentle reminders every so often to get it if people don&#8217;t have it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137633">
				<div id="div-comment-137633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Juan Miguel Venturello</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137633">
			January 21, 2004 at 7:53 am</a>		</div>

		<p>I&#8217;d rather see your samples in Win64, since it will get me (and the other people) more exposed to this &#8216;new way&#8217; of coding. The code I do is not Win 64 compliant since it is a huge app I am mantaining but I rather very much sample code on the net, like you, sets what I think should be a fine example.</p>
<p>Thanks for the very good blog,</p>
<p>Juan</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137713">
				<div id="div-comment-137713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeneffect.com' rel='external nofollow' class='url'>Ian Hanschen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137713">
			January 21, 2004 at 10:01 am</a>		</div>

		<p>Win64 compliant code is good.  A lot of people haven&#8217;t gotten into the habit of writing compliant code yet &#8211; more public examples of it can only be a good thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137733">
				<div id="div-comment-137733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137733">
			January 21, 2004 at 10:58 am</a>		</div>

		<p>Jack: done, link added. We&#8217;ll see if it helps any.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137763">
				<div id="div-comment-137763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137763">
			January 21, 2004 at 4:33 pm</a>		</div>

		<p>Something is still strange here.  As mentioned in a previous thread, I use VS6SP5 for programming that will actually be delivered to customers.  In that previous thread we did not discuss the Platform SDK, but since you mention it now, yes I also have the February 2003 Platform SDK installed.  Nonetheless the relevant header file (which I named in the other thread) declares the function type TimerProc() and the function SetTimer() to take parameters of type UINT not UINT_PTR.</p>
<p>I am all in favor of your examples using current headers and valid code.  But I still can&#8217;t figure out how you get different current headers than customers get.</p>
<p>I also still wonder, when you put shims in Windows to make broken programs work, will that include shims to make these two kinds of broken programs work:<br />
<br />(1)  Programs that conformed to broken VS6SP5 implementations<br />
<br />(2)  Programs that had buggly casts inserted in order to get them to compile while the programs&#8217; own code conformed to MSDN&#8217;s datatypes and function prototypes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137783">
				<div id="div-comment-137783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137783">
			January 21, 2004 at 4:44 pm</a>		</div>

		<p>I just downloaded the Platform SDK and took a peek at winuser.h: Its declarations are</p>
<p>typedef VOID (CALLBACK* TIMERPROC)(HWND, UINT, UINT_PTR, DWORD);</p>
<p>WINUSERAPI<br />
<br />UINT_PTR<br />
<br />WINAPI<br />
<br />SetTimer(<br />
<br />    IN HWND hWnd,<br />
<br />    IN UINT_PTR nIDEvent,<br />
<br />    IN UINT uElapse,<br />
<br />    IN TIMERPROC lpTimerFunc);</p>
<p>These match the current MSDN documentation.</p>
<p>So I guess I&#8217;m not looking at the same header file you&#8217;re looking at. (I tried to figure out which header file you were referring to but I couldn&#8217;t find anything in your previous comments that actually named a header file.)</p>
<p>I emphasize again that the type changes from Win32 to Win64 &gt;&gt;have no binary effect on Win32&lt;&lt;.  On Win32, UINT_PTR devolves to UINT, so code that uses UINT is identical to code that uses UINT_PTR when compiled for Win32. It is only when compiling for Win64 that things go wrong.</p>
<p>So I don&#8217;t understand points (1) and (2), since the changes here have no code effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137853">
				<div id="div-comment-137853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137853">
			January 21, 2004 at 5:41 pm</a>		</div>

		<p>&quot;On Win32, UINT_PTR devolves to UINT&quot;</p>
<p>Ordinarily it does not.  If it did then I wouldn&#8217;t get compilation errors when using UINT_PTR.</p>
<p>Now I&#8217;ve done a bit of poking around.  It seems that the February 2003 Platform SDK doesn&#8217;t register its directories with Visual Studio 6.  It doesn&#8217;t say which version of Visual Studio it registers its directories with, but I have the impression that it only registered its directories with Visual Studio .NET 2003 (in my case).  This surely explains why VC++6 is using header files that came from VS6SP5 instead of header files from the February 2003 Platform SDK.</p>
<p>I suppose that in VC++6, every time I create a new project, I can go to its project settings, preprocessor category, and tell it to take include files from the Platform SDK&#8217;s directory.  Now that I know that this didn&#8217;t get automated, I can do it manually.</p>
<p>In fact I just did that to an existing project, and it worked.  It used a declaration of TimerProc with a UINT_PTR parameter, UINT_PTR devolved to UINT as you said, and no error resulted from this part of it.  However, there&#8217;s a new error message:<br />
<br />   error C2668: &#8216;InlineIsEqualGUID&#8217; :<br />
<br />   ????????????????????????<br />
<br />   ??????(???;???????)<br />
<br />I didn&#8217;t code the call to InlineIsEqualGUID, that was put in by the MFC and/or ATL App Wizard.  I wonder if I can figure out how to fix this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137863">
				<div id="div-comment-137863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137863">
			January 21, 2004 at 5:43 pm</a>		</div>

		<p>Mr. Chen, any chance that you can use Unicode?</p>
<p>VC++&amp;&#8217;s error message in the above posting roughly translates to:<br />
<br />   error C2668: &#8216;InlineIsEqualGUID&#8217;:<br />
<br />   Overloaded function call cannot be<br />
<br />   resolved.  (New functionality;<br />
<br />   reference help.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137873">
				<div id="div-comment-137873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137873">
			January 21, 2004 at 5:47 pm</a>		</div>

		<p>I don&#8217;t run this server, sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-137883">
				<div id="div-comment-137883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137883">
			January 21, 2004 at 7:36 pm</a>		</div>

		<p>Norman: in VC6 go to Tools | Options&#8230; | Directories. Add the platform sdk &quot;include&quot; directory *above* the vc98 stuff. Do the same for &quot;bin&quot; and &quot;bin/winnt&quot; to the executables and &quot;lib&quot; to the libraries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-137953">
				<div id="div-comment-137953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dimmick.demon.co.uk' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-137953">
			January 22, 2004 at 2:02 am</a>		</div>

		<p>Google for inlineisequalguid c2668 reveals the following page:</p>
<p><a target="_new" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q243298" rel="nofollow">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q243298</a> &#8211; BUG: Error Message: C2668: InlineIsEqualGUID: Ambiguous Call to Overloaded Function</p>
<p>Basically, ATL declares an InlineIsEqualGUID function, but now so does GUIDDEF.H in the Platform SDK headers. The use of &#8216;using namespace ATL;&#8217; in atlbase.h (a very bad practice) causes the compiler to complain about ambiguity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-138143">
				<div id="div-comment-138143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Catatonic</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138143">
			January 22, 2004 at 2:20 pm</a>		</div>

		<p>Updating the Platform SDK broke one thing for me. The debug version of MS Layer For Unicode (Unicode support library for Win9x) will not link with VC++ 6 anymore. For now, I just build the debug version with native Unicode. But I can&#8217;t debug it on Win9x anymore.</p>
<p>I&#8217;ve heard this was on a to-do list and may be fixed by now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-138193">
				<div id="div-comment-138193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138193">
			January 22, 2004 at 5:38 pm</a>		</div>

		<p>asdf recommended:  &#8216;in VC6 go to Tools | Options&#8230; | Directories. Add the platform sdk &quot;include&quot; directory *above* the vc98 stuff.&#8217;</p>
<p>Done, AND also these two:<br />
<br />C:Program FilesMicrosoft SDKincludemfc<br />
<br />C:Program FilesMicrosoft SDKincludegl</p>
<p>Also did the bin and lib stuff as you recommended.</p>
<p>Now I worry what will happen when we deliver source code to customers, if customers have VS6SP5 but don&#8217;t have the Platform SDK.</p>
<p>Why is the Platform SDK separate from VS service packs?  Why don&#8217;t VS service packs include the header, executable, and library files that the Platform SDK has?  After all, how many platforms are there that are targeted by VS?</p>
<p>(Yeah I know, embedded Windows platforms used to be targeted by add-ons to the ordinary Visual Studio instead of the separate eMbedded tools stuff, so my question was maybe 90% valid historically, but surely my question is 100% valid now.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-138223">
				<div id="div-comment-138223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138223">
			January 22, 2004 at 6:00 pm</a>		</div>

		<p>No, don&#8217;t add the gl stuff to the includes.</p>
<p>You&#8217;re supposed to do:</p>
<p>#include &lt;gl/gl.h&gt;</p>
<p>not</p>
<p>#include &lt;gl.h&gt;</p>
<p>Not sure about the mfc ones though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-138273">
				<div id="div-comment-138273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138273">
			January 22, 2004 at 10:43 pm</a>		</div>

		<p>To asdf:  Thank you again for your advice, and I deleted the gl directory from the includes.</p>
<p>To Mr. Chen:  I know this isn&#8217;t your responsibility, but I also know you sometimes have contacts with them.  How come MSDN still doesn&#8217;t have any plans to include the October 2003 Platform SDK in CD shipments to subscribers?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-138283">
				<div id="div-comment-138283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138283">
			January 22, 2004 at 11:02 pm</a>		</div>

		<p>Actually I don&#8217;t know anybody involved in MSDN subscriptions, sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-138313">
				<div id="div-comment-138313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Hearn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138313">
			January 23, 2004 at 2:17 am</a>		</div>

		<p>Is there any way to get the platform SDK without using their funky ActiveX control (like a direct download or something)? AX Controls give me problems here&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-138383">
				<div id="div-comment-138383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.rotd.org' rel='external nofollow' class='url'>Andreas Magnusson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-138383">
			January 23, 2004 at 8:20 am</a>		</div>

		<p>There should be a link to the cab-files on the page (<a target="_new" href="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm" rel="nofollow">http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm</a>). However I had some trouble to download them using IE6 and the page isn&#8217;t Netscape friendly (the links won&#8217;t show in Netscape). So I ended up by copy the links from IE into Netscape and the download worked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-139043">
				<div id="div-comment-139043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://alias:ndiamond@msdn.discussions.microsoft.com' rel='external nofollow' class='url'>Norman Diamond</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-139043">
			January 25, 2004 at 6:09 pm</a>		</div>

		<p>The link provided by Andreas Magnussen still provides cab files for the February 2003 Platform SDK instead of the October 2003 version.</p>
<p>The file sizes are still almost unthinkable for anyone who uses a wireless modem for their personal internet usage (32kbps where I live, though faster speeds are available in densely populated areas).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-139053">
				<div id="div-comment-139053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rodrigo Strauss</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040121-00/?p=40983#comment-139053">
			January 25, 2004 at 6:23 pm</a>		</div>

		<p>Last PSDK, always</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>