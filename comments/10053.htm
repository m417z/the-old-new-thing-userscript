<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-927043">
				<div id="div-comment-927043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927043">
			July 27, 2011 at 9:11 am</a>		</div>

		<p>I use this technique quite a bit.</p>
<p>Normally I&#39;d ask how to call a function pointer obtained via interop in VB .NET but Raymond sounds grouchy today.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927053">
				<div id="div-comment-927053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">configurator</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927053">
			July 27, 2011 at 9:14 am</a>		</div>

		<p>Some people are C++phobic. I wish there was an easy way to fix that, but I know when I&#39;m not working on a C++ project I&#39;d normally find it easier to calculate the structure size myself than open the C++ compiler.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927083">
				<div id="div-comment-927083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927083">
			July 27, 2011 at 9:53 am</a>		</div>

		<p>I don&#39;t understand this &#8212; I don&#39;t write in C++ or C# much, but I see that even the erroneous code is already using SizeOf. &nbsp;What am I missing?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927093">
				<div id="div-comment-927093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random832</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927093">
			July 27, 2011 at 10:08 am</a>		</div>

		<p>Of course, this is the wrong question. Marshal.SizeOf would give the right answer, <em>if their managed definition of the INPUT struct were correct</em>. And if it&#39;s not, passing a different size will just make it harder to debug (actually, it&#39;ll probably just cause an access violation).</p>
<p>The size being wrong is just a side effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927123">
				<div id="div-comment-927123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927123">
			July 27, 2011 at 10:38 am</a>		</div>

		<p>I agree with Random382 &#8212; you need to fix the structure itself at which point Marshal.SizeOf will return the right value. &nbsp;Of course the associated C++ code can give some nice hints as to what you did wrong, so there is value there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927173">
				<div id="div-comment-927173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927173">
			July 27, 2011 at 12:34 pm</a>		</div>

		<p>Joshua: Marshal.GetDelegateForFunctionPointer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927203">
				<div id="div-comment-927203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927203">
			July 27, 2011 at 7:32 pm</a>		</div>

		<p>There is another way to find out the size by ask Raymond without making Raymond grumpy &#8211; search on the web for what Raymond said:</p>
<p><a rel="nofollow" target="_new" href="http://pinvoke.net/default.aspx/user32.sendinput" rel="nofollow">pinvoke.net/&#8230;/user32.sendinput</a></p>
<div class="post">[<i>The customer got the incorrect declaration <span style="text-decoration:underline;">from that web page</span>. (It has since been fixed, but if you go through the archives, you&#39;ll see that it was wrong in the past.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927213">
				<div id="div-comment-927213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JustSomeGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927213">
			July 27, 2011 at 9:07 pm</a>		</div>

		<p>&quot;This may work, but it makes Raymond rather grumpy&quot; &#8211; yes, but you should be aware that there&#39;s an entire cadre of people here who relish the thought of making Raymond grumpy. My evidence, such as it is, is the continuing practice by some people of doing things that Raymond has already stated he doesn&#39;t like :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927223">
				<div id="div-comment-927223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Amit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927223">
			July 27, 2011 at 10:51 pm</a>		</div>

		<p>I don&#39;t even bother writing a program to print the size anymore. I just attach to a process that compiles with the structure I want to test (usually you have a process like this, or otherwise you wound&#39;t be interested) and ask the debugger to print the sizeof() the structure.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-927313">
				<div id="div-comment-927313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/mark_4000_marksowul.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>mark@marksowul.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927313">
			July 28, 2011 at 8:30 am</a>		</div>

		<p>Better than pinvoke.net:</p>
<p><a rel="nofollow" target="_new" href="http://stackoverflow.com/questions/5122410/accessing-windows-api-constants-and-structs-for-p-invoke/5122534#5122534" rel="nofollow">stackoverflow.com/&#8230;/5122534</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-927683">
				<div id="div-comment-927683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110727-00/?p=10053#comment-927683">
			July 29, 2011 at 6:08 pm</a>		</div>

		<p>Since a .NET programmer (be it in VB.NET or C#) doesn&#39;t need to know how to write program in C++ (for example, I don&#39;t know how to write a program beyond the console program level students were taught to write in school&#8230; :P), I&#39;d say I&#39;m not surprised to see the customer ignore the third part.</p>
<p>Actually if this were a paid support request or the question is asked in these managed newsgroups, I&#39;d expect direct answer be supplied too.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>