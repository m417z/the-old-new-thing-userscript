<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (8)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-396403">
				<div id="div-comment-396403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anders</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-396403">
			June 29, 2006 at 5:06 am</a>		</div>

		<p>Don&#8217;t know why this blog is so light on comments lately, summer might have something to do with it I don&#8217;t know, but I still read it every day, so keep up the good work Raymond</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396413">
				<div id="div-comment-396413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bvleur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-396413">
			June 29, 2006 at 6:05 am</a>		</div>

		<p>I guess Raymond can check the number of readers without them having to comment (if he even cares about his popularity). I&#8217;m reading and enjoying this blog every day just to learn some nice details about windows although I actually never write code a this level. </p>
<p>The tiny details makes this interesting (as the concept is really easy) like: </p>
<p>1. Why do you draw the color bands with empty text and not some kind FillRectangle function? </p>
<p>2. Why does the tools rect change and is bigger than all of your items? I expected it to be set to the size of all your items (so just (0, 0, g_cxItem, g_cItems &amp; g_cyItem)). </p>
<p>3. How does the tooltip disappear now that you won&#8217;t relay a mouse message that it&#8217;s outside of the item-rect? (It will POP because of itemTip becoming -1, but it will reappear as it&#8217;s still in the client-rect right?) </p>
<p>4. You say you can&#8217;t subclass because you would POP the new tooltip. How could there have been a new tooltip if you haven&#8217;t changed the tool you&#8217;re over? Could you have sent a POPUP when UpdateTooltip detects you&#8217;re over a new item to make the new bubble appear as soon as you&#8217;re over a new item?</p>
<div CLASS=post>[<i>(1)&nbsp;I&#8217;ll talk more about using ExtTextOut for solid fills later. (2)&nbsp;Using a tighter tool rectangle just re-creates the problem we&#8217;re trying to solve! (3)&nbsp;Run the program and find out. (4a)&nbsp;By &#8220;the new tooltip&#8221; I mean &#8220;the tooltip with the new text&#8221;. (4b)&nbsp;That would be a change in behavior. There would be no tooltip delay. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-396423">
				<div id="div-comment-396423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-396423">
			June 29, 2006 at 7:27 am</a>		</div>

		<p>I&#8217;m still observing the same effects: </p>
<p>Even without TTS_NOANIMATE, sometimes the tooltip is drawn without animation and border (at least I believe it&#8217;s a tooltip since it&#8217;s yellow). And with that flag, it&#8217;s always without animation and border. But whenever it&#8217;s drawn without border, the window is clipped to the parent (when I resize the partent window). </p>
<p>Is it possible to eliminate animation and still have tooltip that is not clipped? The real &#8220;big&#8221; apps (i.e. IE :) ) don&#8217;t have such problems.</p>
<div CLASS=post>[<i>Maybe you disabled tooltip animations in the control panel? I don&#8217;t know. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396433">
				<div id="div-comment-396433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Filteau</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-396433">
			June 29, 2006 at 9:11 am</a>		</div>

		<p>Why are you creating the tooltip with WS_EX_TRANSPARENT and not WS_EX_TOPMOST ?</p>
<div CLASS=post>[<i>Try it without WS_EX_TRANSPARENT. And there&#8217;s no need to be WS_EX_TOPMOST here. One thing that bugs me is topmost windows that don&#8217;t need to be. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-396443">
				<div id="div-comment-396443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-396443">
			June 29, 2006 at 9:16 am</a>		</div>

		<p>bvleur: ExtTextOut is faster than creating brush and passing it to FillRect (MFC uses it for its CDC::FillSolidRect method). I vaguely remember reading that it&#8217;s also faster than MoveTo/LineTo for horizontal/vertical lines.</p>
<p>Not that it should matter in such simple app anyway :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396743">
				<div id="div-comment-396743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-396743">
			July 3, 2006 at 12:07 am</a>		</div>

		<blockquote><p>
  And there&#8217;s no need to be WS_EX_TOPMOST<br />
  <br />&gt; here. One thing that bugs me is topmost<br />
  <br />&gt; windows that don&#8217;t need to be. -Raymond]</p>
<p>Today for me, buttons in the task bar are showing tooltips more topmost than the task bar itself. &nbsp;Last week for me, buttons in the task bar were showing tooltips more than half obscured by the task bar itself. &nbsp;I did not change any settings and did not receive any Windows Updates during this time. &nbsp;How can we figure out if tooltip windows need WS_EX_TOPMOST or not, and how can we figure out if WS_EX_TOPMOST will even work for them or not?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480973">
				<div id="div-comment-480973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.antcassidy.com/code/?p=23' rel='external nofollow' class='url'>Code &raquo; Blog Archive &raquo; GOTCHA: Tooltips in ActiveX controls in Word, IE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-480973">
			March 11, 2007 at 4:11 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.antcassidy.com/code/?p=23" rel="nofollow">http://www.antcassidy.com/code/?p=23</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543513">
				<div id="div-comment-543513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.deez.info/sengelha/blog/2007/08/28/owner-drawn-tooltips/' rel='external nofollow' class='url'>Steven Engelhardt &raquo; Blog Archive &raquo; Owner-Drawn Tooltips</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060628-05/?p=30703#comment-543513">
			August 28, 2007 at 12:55 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.deez.info/sengelha/blog/2007/08/28/owner-drawn-tooltips/" rel="nofollow">http://www.deez.info/sengelha/blog/2007/08/28/owner-drawn-tooltips/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>