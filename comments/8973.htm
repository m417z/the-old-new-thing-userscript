<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (41)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-951103">
				<div id="div-comment-951103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951103">
			December 5, 2011 at 7:57 am</a>		</div>

		<p>I have seen many uninstallers annoyingly open a web browser on a survey &quot;whine, whine, why did you stop loving us?!&quot;</p>
<p>Waiting for that to finish could easily be &quot;never&quot; since it would be the main browser process, which itself (for me) generally stays open for eternity (or something close).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951113">
				<div id="div-comment-951113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951113">
			December 5, 2011 at 8:07 am</a>		</div>

		<p>While the add/remove programs dialog is open it could have a registry change notification set on the key that hold all the uninstallation entries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951123">
				<div id="div-comment-951123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951123">
			December 5, 2011 at 8:09 am</a>		</div>

		<p>Especially because of the self-delete problem this does not seem to be well-thought-out.</p>
<p>I ended up spawning my uninstaller via rundll32 so that FreeLibrary could be used. (If you think about it hard enough you&#39;ll see why this can work).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-joshuaganes odd alt thread-odd thread-alt depth-1" id="comment-951133">
				<div id="div-comment-951133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Joshua+Ganes' rel='external nofollow' class='url'>Joshua Ganes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951133">
			December 5, 2011 at 8:10 am</a>		</div>

		<p>Clearly this situation isn&#39;t ideal. I wonder if there were any attempts to improve the uninstall process. If so, what ideas were proposed, and why were they rejected? I would think that adding a simple way for the uninstaller to notify Windows of success would go a long way to improving this feature for the future.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951153">
				<div id="div-comment-951153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951153">
			December 5, 2011 at 8:27 am</a>		</div>

		<p>I have often wondered / wished for Windows to provide comprehensive installer / uninstaller functionality.</p>
<p>Some relatively simple way to leave things to the OS so that myriad companies are not rolling their own. Must be something like 95% of all software could be handled w/o the need for extra code to be written (and for those that need it, seems like a few hooks could be added to make them work as well).</p>
<p>I know that install/uninstall are deceptively complex, but having &quot;rolled my own&quot; a few times, and worked with various vendors installer packages, it still seems to be the sort of thing that would be better handled by the OS than by 3rd parties (especially since Windows keeps changing).</p>
<p>I know that Windows takes the attitude that it already provides all of the tools necessary &#8211; and on some level it does. But give me 10 programmers tasked to make an installer, and I&#39;ll give you back 10 solutions &#8211; all of them with shortcomings.</p>
<div class="post">[<i>Then why don&#39;t those 9% of all software use MSI? That&#39;s been around as part of Windows for well over a decade, with redistributables all the way down to Windows 95! -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951163">
				<div id="div-comment-951163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951163">
			December 5, 2011 at 8:43 am</a>		</div>

		<p>@Joshua &amp; Steve</p>
<p>Windows 8 provides full installation/uninstallation services for Metro apps. &nbsp;As far as for the desktop, I am sure Raymond&#39;s standard answer of &quot;We&#39;d need a time machine&quot; applies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951183">
				<div id="div-comment-951183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951183">
			December 5, 2011 at 9:31 am</a>		</div>

		<p>I know that there&#39;s MSI and any app is free to use it. &nbsp;We use WiX, and that&#39;s addressed many of the issues that Steve mentioned. &nbsp;A short, simple XML file describing what needs to be installed gets the job done. &nbsp;That&#39;s not so much the issue. &nbsp;(I wish Nullsoft would output MSI files&#8230; advantage of MSI is that you can easily deploy it via Active Directory, you get repair/maintenance for free, etc.)</p>
<p>My big gripe is that there isn&#39;t a standard method for pushing updates to the client. &nbsp;Sure, there&#39;s Microsoft/Windows Update &#8211; but that&#39;s only for MS products. &nbsp;So every 3rd-party app developer is rolling their own solution. &nbsp;And now my system has 10 different auto-updaters running in the background sucking up memory, instead of just 1. &nbsp;Gross.</p>
<p>I know they have announced that there will be a solution for Metro-style apps on Windows 8 sold in the Windows store, but there needs to be more. &nbsp;The desktop itself badly needs a solution for existing apps. &nbsp;Not every app will be usable with a &quot;tablet-style&quot; interface, but they&#39;ll still need an automatic update mechanism.</p>
<p>And MSI is far from perfect. &nbsp;What if your app depends on other packages? &nbsp;Look at Visual Studio setup for exhibit A of a big mess. &nbsp;I end up with seemingly 30 different MSI packages in my Programs and Features list after installing the Visual Studio product &#8211; they were chained together with a big fat non-MSI bootstrapper. &nbsp;The MSI team badly needs to address the serviceability problems with merge modules so people can start using them again&#8230; or support nesting MSI files&#8230; or something&#8230; &nbsp;Chaining together a bundle of unrelated MSI files in a proprietary, custom bootstrapper EXE and calling that a setup program isn&#39;t really a good solution in my book.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951193">
				<div id="div-comment-951193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951193">
			December 5, 2011 at 9:51 am</a>		</div>

		<p>[Then why don&#39;t those 9% of all software use MSI? That&#39;s been around as part of Windows for well over a decade, with redistributables all the way down to Windows 95! -Raymond]</p>
<p>Because you cannot spawn an exe-wrapped MSI from inside a MSI. Fix that and backport it as far as XP (we are obligated to support our software running on XP for years to come for contractual reasons) or I&#39;m staying away from MSI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951203">
				<div id="div-comment-951203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951203">
			December 5, 2011 at 10:01 am</a>		</div>

		<p>@Joshua:</p>
<p>I saw many insanities done from msi, so I suspect that your scenario can be done too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951223">
				<div id="div-comment-951223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951223">
			December 5, 2011 at 10:10 am</a>		</div>

		<p>@Klimax: Let&#39;s just say that unlocking a system-wide mutex and spawning another copy of the program that created it doesn&#39;t sound like a sustainable idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951233">
				<div id="div-comment-951233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Unix programmer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951233">
			December 5, 2011 at 10:39 am</a>		</div>

		<p>This is one the many reasons an exec()-like API would be useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951243">
				<div id="div-comment-951243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951243">
			December 5, 2011 at 12:15 pm</a>		</div>

		<p>@Joshua:</p>
<p>What the hell then are you doing exactly? (Your previous post isn&#39;t too clear and is missing some things)</p>
<p>@grumpy:</p>
<p>Don&#39;t know about being broken or what fundamental use case is missing. Not that I saw &quot;desperater hoops&quot; or something. You might want to be more specific (links welcome) and being less hostile would be nice too so your point isn&#39;t lost in low sound/noise ratio.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kwadwomi even thread-even depth-1" id="comment-951253">
				<div id="div-comment-951253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Master+Programmer' rel='external nofollow' class='url'>Master Programmer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951253">
			December 5, 2011 at 12:32 pm</a>		</div>

		<p>I believe Add/Remove Programs waited for child processes in XP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951263">
				<div id="div-comment-951263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951263">
			December 5, 2011 at 12:54 pm</a>		</div>

		<p>@Klimax: A product I work on has this thing where it conditionally downloads installs SQL Express depending on some options chosen during install, but only if it doesn&#39;t find a database using the target instance on the machine. Window installer takes a global mutex to prevent two installs from running at the same time. You can figure out the rest from there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951273">
				<div id="div-comment-951273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MSI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951273">
			December 5, 2011 at 1:47 pm</a>		</div>

		<p>@Joshua Isn&#39;t that the whole point of MSI Merge Module? <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa369820%28v=vs.85%29.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/aa369820%28v=vs.85%29.aspx</a> If you had taken the time to study the problem and realize what the real solution was you wouldn&#39;t have ended up with something so hacky as attempting to evade a global mutex.</p>
<p>I did some research for you, and found that the Merge Modules are not produced anymore for SQL Server Express, specifically because you are required to register SQL Server Express (they want your info to sell you product I&#39;d assume) to quote from their blog &quot;If you distribute SQL Server Express without registering you violate the End User License Agreement.&quot;</p>
<p>I would wager than conditionally downloading SQL Express as you are violates their EULA, especially if you are automating the registration portion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951283">
				<div id="div-comment-951283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951283">
			December 5, 2011 at 2:11 pm</a>		</div>

		<p>Is there even a way to wait on child processes using supporting APIs if Programs and Features wanted to? &nbsp;I don&#39;t know of any good way to do that other than by using Job objects, but Jobs can&#39;t be nested in shipping versions of Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951303">
				<div id="div-comment-951303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951303">
			December 5, 2011 at 3:11 pm</a>		</div>

		<p>@MSI: Wasn&#39;t true when I pulled down SQL Express.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951313">
				<div id="div-comment-951313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951313">
			December 5, 2011 at 4:45 pm</a>		</div>

		<p>@Joshua:</p>
<blockquote><p>
  I ended up spawning my uninstaller via rundll32 so that FreeLibrary could be used
</p></blockquote>
<p>Oh, so it your app that Raymond was talking about in articles like this one <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2011/11/17/10237911.aspx" rel="nofollow">blogs.msdn.com/&#8230;/10237911.aspx</a>.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951173">
				<div id="div-comment-951173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951173">
			December 5, 2011 at 9:06 am</a>		</div>

		<p>@SimonRev &#8211; I&#39;m hopeful for Windows 8 giving a much more user-friendly interface for Metro Apps. &nbsp;That world looks like it&#39;s designed better &#8211; to hold the developer&#39;s hand and help them make an app that really integrates with the OS, and other Apps, including installation and operation, far superior to anything MS has done in the past.</p>
<p>However &#8211; this Metro ecology is really not appropriate for many types of desktop software, and does not help the current situation. &nbsp;In fact, I&#39;m worried (along with many others) that it will make my desktop conform to a universe that isn&#39;t of my desire for a desktop PC. &nbsp;I&#39;m all for that for a tablet PC or a phone. &nbsp;But a PC? &nbsp;I have my doubts&#8230;</p>
<p>@Raymond &#8211; at the risk of exposing my own incompetence, my take on MSI has always been that it is horrendously complex. &nbsp;It is awful, in my experience, to work with.</p>
<p>Compare that to Nullsoft&#39;s installer: that is a charm to work with.</p>
<p>For my 2c, I prefer the Nullsoft approach (or the NeXTStep / OS X approach) &#8211; where you simply create a manifest of a sort, fill in a few blanks, and boom, most software is installed and registered (and can be uninstalled &amp; deregistered) by the OS with *very little* understanding on the part of the software developer (and hence very little chance they&#39;ll get it wrong).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-951323">
				<div id="div-comment-951323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951323">
			December 5, 2011 at 5:59 pm</a>		</div>

		<p>I think this could have been fixed if the msiexec process calls something to notify installation status change at the end of each package. That&#39;d somehow fix those 90%of the cases. (While updating the whole list can be slow, I think updating base of specific package ID should be fast)</p>
<p>For those who write installer programs themselves, just make such API call available to them when finish. (Whether they&#39;re calling it or not is not important, at worse if they don&#39;t call it, the situation would have been just the same)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951213">
				<div id="div-comment-951213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">grumpy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951213">
			December 5, 2011 at 10:01 am</a>		</div>

		<p>Probably because MSI is so utterly broken. Just a thought.</p>
<p>An installer engine &nbsp;which fails to support the most fundamental use cases, and is ridiculously slow to boot? Yeah, I wonder why not everyone uses it. Heck, just looking at the desperate hoops various Microsoft products jump through to *try* and package working installers for their software should say it all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951333">
				<div id="div-comment-951333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951333">
			December 5, 2011 at 6:45 pm</a>		</div>

		<p>Couldn&#39;t an MSI that wants to wait for an exe to exit call a function or do some custom action that process creates whatever.exe from the installed/temp files path and then waits on the process handle (with a timeout, if desired) before going on to the next operation? This would only work ok if the exe required no user input, or the install was interactive and the user was told the exe launch was a &#39;step&#39; of the install wizard. [I&#39;m obviously no expert on MSI]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951343">
				<div id="div-comment-951343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951343">
			December 5, 2011 at 7:09 pm</a>		</div>

		<p>@Ivan K: It is my understanding that they shimmed the call to msiexec /u.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-951363">
				<div id="div-comment-951363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951363">
			December 5, 2011 at 9:25 pm</a>		</div>

		<p>@MSI: The biggest reason I think is that MSDE service packs required the application vendor to patch the original MSI package that the MSM was linked with, which was a big problem when SQL Slammer hit in 2003. Thus it was depreciated and in the next SQL Server release removed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-951293">
				<div id="div-comment-951293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951293">
			December 5, 2011 at 2:25 pm</a>		</div>

		<p>[Then why don&#39;t those 9% of all software use MSI? That&#39;s been around as part of Windows for well over a decade, with redistributables all the way down to Windows 95! -Raymond]</p>
<p>Maybe because Microsoft decided that MSI doesn&#39;t need any authoring tools. Nope. Everybody can populate a poorly documented database, no fancy GUI tools necessary. OK, a third company has written their widely used authoring tool, so widely used that MS was forced to emulate their 16-bit installer module for x64. Or maybe because MSIEXEC is so poorly programmed that it takes the whole processor busy (busy loop waiting?) while extracting files with lightning fast speed of about 1 MB/s.</p>
<p>Or maybe because sometimes *the whole MSI subsystem* decides to break so badly that it won&#39;t install or uninstall anything. Like it happened on my Win7 laptop on work.</p>
<div class="post">[<i>The original complaint was &quot;Why doesn&#39;t Microsoft have a unified installer?&quot; The answer is &quot;A unified installer for Windows has existed for over a decade.&quot; Whether that unified installer sucks is a separate issue. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951373">
				<div id="div-comment-951373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/martinelli_2D00_andrea_4000_live.it/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>martinelli-andrea@live.it</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951373">
			December 6, 2011 at 12:01 am</a>		</div>

		<p>Alpha releases of Windows 8 supported AppX packages even for desktop apps.</p>
<p>Raymond, why was that feature removed? MSI is without doubt one of the worst products Microsoft has ever released.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951383">
				<div id="div-comment-951383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">InOut</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951383">
			December 6, 2011 at 12:36 am</a>		</div>

		<p>Use tools. Quite a few of them listed on InstallSite. I am partial to Advanced Installer myself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951393">
				<div id="div-comment-951393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951393">
			December 6, 2011 at 1:26 am</a>		</div>

		<p>MSI is a good idea, but the execution is horrible &#8211; it&#39;s slow and fragile (though recent versions seem to break a bit less) &#8211; I ended up with MSI-based programs that couldn&#39;t be removed/repaired/reinstalled way too many times (I wasn&#39;t alone &#8211; &lt;i&gt;somebody&lt;/i&gt; wrote this msizap tool that somehow fixed the problem). And then there&#39;s the (non-)progress indicator &#8211; why even bother with it, when with each install it fills up a random number of times (I remember a certain Office service pack where I counted the progress bar filling 30 times, then there was a mandatory reboot, after which the progress bar filled a further 10 times &#8211; and I&#39;m not exaggerating).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951403">
				<div id="div-comment-951403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951403">
			December 6, 2011 at 3:27 am</a>		</div>

		<p>Why wouldn&#39;t the Programs and Features folder poll the registry (assuming it is local) and refresh auto-magically?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951413">
				<div id="div-comment-951413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JohnL</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951413">
			December 6, 2011 at 5:51 am</a>		</div>

		<p>@Burak Maybe because if the uninstall really did fail then it could be doing that forever.</p>
<p>MSI has many good points &#8211; but simplicity isn&#39;t one of them, and there&#39;s a lot of things it just can&#39;t do. &nbsp;In many ways it&#39;s got the worst of both worlds &#8211; all the complexity but none of the power. &nbsp;Maybe Chocolatey (<a rel="nofollow" target="_new" href="http://chocolatey.org" rel="nofollow">http://chocolatey.org</a>) will take off&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951443">
				<div id="div-comment-951443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951443">
			December 6, 2011 at 7:17 am</a>		</div>

		<p>@johnL Forever is only as long as the folder is open. AFAIK explorer queries the registry all the time for various things (on XP at least). I don&#39;t see why polling at a 500ms interval would have any unwanted consequences.</p>
<div class="post">[<i><a href="http://blogs.msdn.com/b/oldnewthing/archive/2006/01/24/516808.aspx" rel="nofollow">Polling kills</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951573">
				<div id="div-comment-951573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951573">
			December 6, 2011 at 8:29 am</a>		</div>

		<p>Isn&#39;t there a wait for object (registry key change) API already, just as there is for the file-system? &nbsp;I&#39;ve never needed that functionality, but I&#39;d be surprised if it didn&#39;t already exist.</p>
<p>Even if it doesn&#39;t exist, it&#39;s reasonable to implement using polling and an extra thread and a bit of storage to be able to tell when something changed&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951613">
				<div id="div-comment-951613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951613">
			December 6, 2011 at 9:38 am</a>		</div>

		<p>There is MSI functionality to wrap multiple MSI packages into one virtual product in Programs &amp; Features. See MsiBeginTransaction, MsiEmbeddedUI etc. I hope nobody&#39;s asking for a feature that already exists. Also, the vast majority of the issues with installs are caused by the custom code (custom actions) that people write to get called from the install. A typical development story is to throw a bunch of configuration requirements at the people writing the install, and the result is an unreliable install and more complaints about why installs are so error prone. Configuration belongs in the app, not in the install, and it looks like Microsoft are going to enforce this with AppX.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951623">
				<div id="div-comment-951623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951623">
			December 6, 2011 at 9:45 am</a>		</div>

		<p>Wow look at the hatred here for MSI. I think MSI rocks. It&#39;s the most full-featured and well designed installer system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-951753">
				<div id="div-comment-951753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951753">
			December 7, 2011 at 1:00 am</a>		</div>

		<p>Oh, one more MSI gripe: the Windows Installer service removes privileges for creating symlinks from itself &#8211; this was recently a problem for CoApp, since it&#39;s pretty much designed around symlinks and Windows Installer. They ended up writing their own service which handles creating symlinks (Windows Installer has no problems spawning a service which then isn&#39;t subject to those limitations).</p>
<p>@xpclient: MSI well-designed? Don&#39;t make me laugh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-951953">
				<div id="div-comment-951953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-951953">
			December 7, 2011 at 11:51 am</a>		</div>

		<p>Well I think ender just supported my point. There&#39;s a complaint that MSI sucks because I can&#39;t run my app configuration code from the install. Roll on AppX in the hope that nobody can run their code from an install ;=)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-952023">
				<div id="div-comment-952023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-952023">
			December 7, 2011 at 10:12 pm</a>		</div>

		<p>If that&#39;s not a good strategy, then why does Visual Studio Pre/Post compilation steps wait for all &quot;random background tasks&quot; to finsih? Now you have to register a task scheduler event to contiue to compile. A little consistency please!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-952303">
				<div id="div-comment-952303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-952303">
			December 9, 2011 at 12:40 am</a>		</div>

		<p>@Phil W: huh? Windows Installer runs elevated, and lets you define custom actions. Making symlinks is limited to elevated users, which is why they have to be made at install time &#8211; except that for some weird reason Windows Installer service removes that privilege from itself, requiring you to do extra work (and potentially introduce a security hole to the system) to get the same effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-952313">
				<div id="div-comment-952313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Killed</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-952313">
			December 9, 2011 at 1:00 am</a>		</div>

		<p>[Polling kills. -Raymond]</p>
<p>If someone could hop into his time machine and tell that to guys that wrote Autostart, Network Connection UI, WMI and Bluetooth&#8230; :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-952333">
				<div id="div-comment-952333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Remove the burden of msi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-952333">
			December 9, 2011 at 3:20 am</a>		</div>

		<p>MSI proven technology? Yeah, proven to NOT be useful. By MS!</p>
<ol>
<li>
<p>Now, when msi has existed for over a decade, most of MS&#39; own install packages are still exes.</p>
</li>
<li>
<p>Windows itself isn&#39;t compatible with MSI (uninstall). Case closed.</p>
</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-952473">
				<div id="div-comment-952473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paramanand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111205-00/?p=8973#comment-952473">
			December 10, 2011 at 1:52 am</a>		</div>

		<p>On Windows XP, I sometimes find that after the uninstall the entry for the program remains. And then I again click on the &quot;Remove&quot; button and a dialogs pops up saying &quot;The program might be uninstalled, do you want to remove its entry from the installed program&#39;s list&quot;. After this I click on &quot;Yes&quot; button and the entry is deleted. Given the nature of the list updation (wait for the uninstaller to exit and check registry key) I think the above solution is pretty simple and not too annoying. However not all uninstall operations proceed like this and so this is not the preferred solution by many uninstallers.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>