<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (49)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-272253">
				<div id="div-comment-272253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272253">
			April 22, 2005 at 9:08 am</a>		</div>

		<p>STA?  Out of curiosity, why?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-272263">
				<div id="div-comment-272263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272263">
			April 22, 2005 at 9:17 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/287087" rel="nofollow">http://support.microsoft.com/kb/287087</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272283">
				<div id="div-comment-272283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Payne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272283">
			April 22, 2005 at 9:20 am</a>		</div>

		<p>__super looks like a super (sorry) extension – do you know if there are any plans to standardize it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272293">
				<div id="div-comment-272293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ryan Heath</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272293">
			April 22, 2005 at 9:24 am</a>		</div>

		<p>Cool, reminds me of Paul DiLascia&#8217;s Windows++ ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-272303">
				<div id="div-comment-272303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272303">
			April 22, 2005 at 9:29 am</a>		</div>

		<p>Ok, next stupid question&#8230;  I understand that __super is similar to the C# Base keyword, but why use it?</p>
<p>Is it to be able to derive RootWindow from something other than Window in the future?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272313">
				<div id="div-comment-272313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com/blog' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272313">
			April 22, 2005 at 9:30 am</a>		</div>

		<blockquote><p>
  it&#8217;s just going to be a framework for future samples</p>
<p>Or a sample framework ? Do you plan to cover frameworks architectures and issues ? I&#8217;d love that.</p>
<p>Ha! Rats! No. You wrote it before : You know nothing to MFC ;-)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272323">
				<div id="div-comment-272323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272323">
			April 22, 2005 at 9:41 am</a>		</div>

		<p>Is WM_NCCREATE the very first message that is sent to a window? If this is the case, then it makes ATL&#8217;s thunking pretty much unnecessary.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272333">
				<div id="div-comment-272333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Bundy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272333">
			April 22, 2005 at 10:00 am</a>		</div>

		<p>You&#8217;ve sold us out.  I&#8217;m devastated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272343">
				<div id="div-comment-272343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272343">
			April 22, 2005 at 10:25 am</a>		</div>

		<p>Matt&gt; ATL uses thunks because the designers didn&#8217;t want to use SetWindowLongPtr(GWLP_USERDATA). Doing so would be a barrier to people porting existing code that happened to already store important data in GWLP_USERDATA.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-272353">
				<div id="div-comment-272353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272353">
			April 22, 2005 at 10:26 am</a>		</div>

		<p>If you ever copied, renamed, or reparented a class, you already know how handy __super can be.  It&#8217;s the class hierarchy version of the &quot;..&quot; directory.</p>
<p>We will see more of WM_NCCREATE in July.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272363">
				<div id="div-comment-272363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">carlso</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272363">
			April 22, 2005 at 10:46 am</a>		</div>

		<blockquote><p>
  ATL uses thunks because the designers didn&#8217;t want to use SetWindowLongPtr(GWLP_USERDATA). Doing so would be a barrier to people porting existing code that happened to already store important data in GWLP_USERDATA.</p>
<p>Also, another motivation for ATL thunks is that you won&#8217;t pay the price for the GetWindowLongPtr() lookup on every message processed.  Any comments on how fast GetWindowLongPtr(&#8230;, GWLP_USERDATA) is?</p>
<p>If you&#8217;re unfamiliar with ATL thunks, it basically works like this: For each instance of a &quot;C++ window object&quot;, you create a small piece of code at runtime (called a thunk).  When the window is created, the actual WndProc is replaced by the thunk by calling the SetWindowLongPtr(&#8230;, GWL_WNDPROC, &#8230;) API.</p>
<p>So, instead of calling the original WndProc, Windows will call your thunk instead.  The job of the thunk is to replace the HWND parameter passed to the WndProc with the &quot;this&quot; pointer of the C++ class instance, and the thunk then jumps to the original WndProc.  Because the thunk replaces the HWND with your this pointer, you code up your WndProc as accepting a &quot;this&quot; pointer instead of an HWND as the first parameter.</p>
<p>More details can be found in the article &quot;Thunking WndProcs in ATL&quot; by Fritz Onion that appeared in C++ Report, March 1999: <a rel="nofollow" target="_new" href="http://www.pluralsight.com/articlecontent/cpprep0399.htm" rel="nofollow">http://www.pluralsight.com/articlecontent/cpprep0399.htm</a></p>
<p>Raymond, can you comment on the merits of this technique vs. the GetWindowLongPtr(&#8230;, GWLP_USERDATA) method?</p>
<p>Thanks for another great blog!
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-272373">
				<div id="div-comment-272373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272373">
			April 22, 2005 at 10:53 am</a>		</div>

		<blockquote><p>
  Raymond, can you comment on the merits of this technique vs. the GetWindowLongPtr(&#8230;, GWLP_USERDATA) method?</p>
<p>I think you did an excellent job yourself.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272383">
				<div id="div-comment-272383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272383">
			April 22, 2005 at 11:29 am</a>		</div>

		<p>One thing that I&#8217;ve wondered about the ATL thunks is how future-proof they are. Since they effectively step outside the bounds of the language and embed x86 ASM code into data members, aren&#8217;t they at risk for becoming obselete if x86 is ever abandoned? Although, admittedly, this is a pretty weak argument. The recent entries on the IA64 being a more strict architecture do bring these concerns back to the surface, however.</p>
<p>I guess the nice thing about the ATL thunks is that the dirty work is done by maintainers at Microsoft, so conceivably we don&#8217;t have to worry about it as much.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272393">
				<div id="div-comment-272393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272393">
			April 22, 2005 at 12:17 pm</a>		</div>

		<p>What happens if someone else sets our USERDATA?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-272403">
				<div id="div-comment-272403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272403">
			April 22, 2005 at 12:23 pm</a>		</div>

		<p>Who else would that be? We control the both the window class implementation and the window class consumer. If I were writing a control intended for use by others then that would be a concern but that doesn&#8217;t apply here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272423">
				<div id="div-comment-272423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272423">
			April 22, 2005 at 12:48 pm</a>		</div>

		<p>Does anyone know how to use ATL-style thunks if HandleMessage is a virtual function as it is in the sample program?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272433">
				<div id="div-comment-272433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272433">
			April 22, 2005 at 1:50 pm</a>		</div>

		<p>How about adding some const correctness to your sample?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-272443">
				<div id="div-comment-272443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272443">
			April 22, 2005 at 1:58 pm</a>		</div>

		<p>Matt: Yes, the ATL thunks need to be rewritten for each processor type.</p>
<p>There&#8217;s some horrible nasty code in VS2005 Beta 2 for allocating the thunk from a pool of thunk blocks allocated from virtual memory (if on XP with NX enabled). See atlthunk.cpp if interested. I hope the OS team are aware that ATL is bumming around in the Process Environment Block! Although, since IE uses ATL windowing in some places, and presumably IE was modified to be NX-safe for XP SP2, perhaps they do know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272453">
				<div id="div-comment-272453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jan.vegetband.cz' rel='external nofollow' class='url'>Jan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272453">
			April 22, 2005 at 2:06 pm</a>		</div>

		<p>Using &quot;private&quot; instead of &quot;public&quot; makes this much safer:</p>
<p>class RootWindow : public Window<br />
<br />{<br />
<br />private:<br />
<br /> typedef Window super;</p>
<p>Jan</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272473">
				<div id="div-comment-272473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272473">
			April 22, 2005 at 3:06 pm</a>		</div>

		<p>Err, Ryan, you&#8217;re aware I was discussing the ATL thunk implementation and not Raymond&#8217;s, correct? Your comments look like you were confusing the two. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272483">
				<div id="div-comment-272483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272483">
			April 22, 2005 at 3:36 pm</a>		</div>

		<p>Congrats. You just jumped the shark.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272493">
				<div id="div-comment-272493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com/blog/2005/04/no-need-to-know-your-base-class-name.html' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272493">
			April 22, 2005 at 6:11 pm</a>		</div>

		<p>Just one more question Raymond: Why didn&#8217;t you tell me 10 years ago !</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272413">
				<div id="div-comment-272413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ryanmy/' rel='external nofollow' class='url'>Ryan Myers [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272413">
			April 22, 2005 at 12:30 pm</a>		</div>

		<p>&lt;i&gt;&quot;One thing that I&#8217;ve wondered about the ATL thunks is how future-proof they are. Since they effectively step outside the bounds of the language and embed x86 ASM code into data members, aren&#8217;t they at risk for becoming obselete if x86 is ever abandoned?&quot;&lt;/i&gt;</p>
<p>Uh, no ASM code being stored in data.  Otherwise, you&#8217;d trip over NX protection.</p>
<p>All he&#8217;s doing is casting a pointer to a class (Window *) to another pointer type (void *) and storing that somewhere.  He then retrieves it, casts it back, and calls a method on it, which is perfectly legal.</p>
<p>In fact, he&#8217;s even being careful to observe the  C++ Standard rule that you cannot cast a data pointer to a function pointer or visa versa.</p>
<p>If you eliminate the __super extension as he mentioned, as far as I can tell it&#8217;s perfectly valid C++.  Not portable, since it uses Win32, but a valid program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272503">
				<div id="div-comment-272503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thierry Tremblay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272503">
			April 22, 2005 at 8:19 pm</a>		</div>

		<p>Me think that &quot;m_hwndChild&quot; is never initialized anywhere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis even thread-even depth-1" id="comment-272523">
				<div id="div-comment-272523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272523">
			April 23, 2005 at 3:17 am</a>		</div>

		<p>ATL thunking sounds sort of like the good old CreateProcInstance from Windows 3.1. It&#8217;s a deficiency in C, really, that you have to use assembler to make this sort of thing work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272533">
				<div id="div-comment-272533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">teebee</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272533">
			April 23, 2005 at 9:22 pm</a>		</div>

		<p>oh no not you too Raymond&#8230; I feel so alone now</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272543">
				<div id="div-comment-272543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_Seddon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272543">
			April 23, 2005 at 10:07 pm</a>		</div>

		<p>if you are still using C to write actual programs, there is a good reason that you are feeling lonely &#8212; most other people have joined the 21st century. Raymond is simply updating himself for the 1990s.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272553">
				<div id="div-comment-272553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272553">
			April 23, 2005 at 11:02 pm</a>		</div>

		<p>I hate C++.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272583">
				<div id="div-comment-272583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272583">
			April 24, 2005 at 10:51 am</a>		</div>

		<p>Ever had one of those moments where you suddenly realise you have been missing out on some crucial and amazingly useful programming &#8216;thing&#8217;.</p>
<p>&lt;windowsx.h&gt;</p>
<p>I never even knew this existed!  Alas!  Alas!</p>
<p>and by the way, &lt;3 C++</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272563">
				<div id="div-comment-272563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_Seddon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272563">
			April 24, 2005 at 8:47 am</a>		</div>

		<p>*Everyone* hates C++! It&#8217;s just that some people hate C more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272603">
				<div id="div-comment-272603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Winwood</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272603">
			April 25, 2005 at 3:57 am</a>		</div>

		<p>Hmm, WinCreateWindow, shades of OS/2 Presentation Manager I think ;)</p>
<p>On a serious note to avoid the problem of others using the GWLP_USERDATA you can always use SetProp/GetProp/RemoveProp.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272613">
				<div id="div-comment-272613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anders</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272613">
			April 25, 2005 at 5:02 am</a>		</div>

		<p>Yeah but GetProp is probably even slower than GetWindowLong</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272633">
				<div id="div-comment-272633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AlisdairM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272633">
			April 25, 2005 at 9:18 am</a>		</div>

		<p>For all those wondering &#8216;why don&#8217;t ANSI/ISO standardise __super&#8217;, think about what it would mean in a class with multiple bases.</p>
<p>It is very useful in single-inheritance hierarchies, and there are a lot of those around &lt;g&gt; but writing the private typedef has similar effect (and as you are in charge, works with multiple bases if you really want it to!)  The main advantage of __super is that there is no risk of forgetting to update the typedef if you change your base class.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jeffdav odd alt thread-odd thread-alt depth-1" id="comment-272853">
				<div id="div-comment-272853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jeffdav</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272853">
			April 25, 2005 at 5:37 pm</a>		</div>

		<p>C++?  You hippy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272903">
				<div id="div-comment-272903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">visitor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272903">
			April 26, 2005 at 5:57 am</a>		</div>

		<p>Hmm&#8230; Probably you are 10 (or more) years late here with C++.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272893">
				<div id="div-comment-272893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272893">
			April 25, 2005 at 11:44 pm</a>		</div>

		<p>&gt; For all those wondering &#8216;why don&#8217;t ANSI/ISO standardise __super&#8217;, think about what it would mean in a class with multiple bases. </p>
<p>They would have to make an arbitrary decision whether to choose the first base, be illegal, or be a synonym for __super(0) which picks off the first base&#8230;</p>
<p>Raymond, I noticed that the this pointer is implicitly converted to a void * in the call to CreateWindowEx but down below you reinterpret_cast the lpCreateParams to a Window *. This isn&#8217;t portable, you either have to change that to a static_cast (or C style cast) or do an explicit reinterpret_cast in the CreateWindowEx call.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272933">
				<div id="div-comment-272933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-272933">
			April 26, 2005 at 10:11 am</a>		</div>

		<p>I for one am glad you&#8217;re using C++.  I only wish your co-workers at Microsoft were as into C++ as you are.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-282403">
				<div id="div-comment-282403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/06/13/428534.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-282403">
			June 13, 2005 at 9:02 am</a>		</div>

		<p>Filling a listview with tens of thousands of items.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-292693">
				<div id="div-comment-292693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/07/26/443384.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-292693">
			July 26, 2005 at 10:00 am</a>		</div>

		<p>One is sent at the start of the destruction process, the other at the end.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-292783">
				<div id="div-comment-292783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2004/07/26/443384.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-292783">
			July 26, 2005 at 12:12 pm</a>		</div>

		<p>One is sent at the start of the destruction process, the other at the end.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-292803">
				<div id="div-comment-292803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/07/26/443384.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-292803">
			July 26, 2005 at 12:48 pm</a>		</div>

		<p>One is sent at the start of the destruction process, the other at the end.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-292933">
				<div id="div-comment-292933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/07/27/443824.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-292933">
			July 27, 2005 at 10:00 am</a>		</div>

		<p>Destroying a window that is already being destroyed leads to strange behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-293763">
				<div id="div-comment-293763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/08/01/445998.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-293763">
			August 1, 2005 at 10:00 am</a>		</div>

		<p>Drawing various types of radio buttons.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-294033">
				<div id="div-comment-294033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/08/02/446605.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-294033">
			August 2, 2005 at 10:00 am</a>		</div>

		<p>Drawing the menu checkmark, as an example.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-294223">
				<div id="div-comment-294223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/08/02/446605.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-294223">
			August 3, 2005 at 12:01 pm</a>		</div>

		<p>Drawing the menu checkmark, as an example.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-347853">
				<div id="div-comment-347853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/02/20/535440.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-347853">
			February 20, 2006 at 10:00 am</a>		</div>

		<p>It means the program is spending too much time drawing to the screen and not enough time doing actual work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-417953">
				<div id="div-comment-417953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.strafenet.com/2006/09/08/getwindowlongptr/' rel='external nofollow' class='url'>The Blog of Justice &raquo; GetWindowLongPtr</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-417953">
			September 8, 2006 at 2:03 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.strafenet.com/2006/09/08/getwindowlongptr/" rel="nofollow">http://blog.strafenet.com/2006/09/08/getwindowlongptr/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-596663">
				<div id="div-comment-596663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.csdn.net/fengzi_shen/archive/2008/02/01/2076591.aspx' rel='external nofollow' class='url'>fengzi_shen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-596663">
			January 31, 2008 at 10:28 pm</a>		</div>

		<p>WM_DESTROY 和 WM_NCDESTROY 消息之间有什么区别?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606163">
				<div id="div-comment-606163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/danieb/archive/2008/03/03/pl-stara-mi-o-nie-umiera-czy-kotlet-odgrzewany-rzecz-o-c.aspx' rel='external nofollow' class='url'>Only Human | Devoted to technology v.2.0</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050422-08/?p=35813#comment-606163">
			March 3, 2008 at 12:09 pm</a>		</div>

		<p>Heh.. w ten weekend się zebrałem aby przyjrzeć się co też najnowsze środowisko Visual Studio.Net 2008</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>