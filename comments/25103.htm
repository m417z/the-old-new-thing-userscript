<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (42)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-550223">
				<div id="div-comment-550223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550223">
			September 17, 2007 at 11:00 am</a>		</div>

		<p>Plus, maybe they&#8217;re uninstalling your software on computer A, but they&#8217;re still using it on computer B.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550233">
				<div id="div-comment-550233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550233">
			September 17, 2007 at 11:09 am</a>		</div>

		<p>..Or maybe they&#8217;re uninstalling your software because they want it gone. &nbsp;And if you leave anything behind, they start blogging about how crappy your uninstallers are.</p>
<p>Sigh. &nbsp;It&#8217;s a no-win situation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550283">
				<div id="div-comment-550283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550283">
			September 17, 2007 at 11:44 am</a>		</div>

		<p>&quot;you definitely should not be messing with the profiles of other users.&quot;</p>
<p>Yup. If I was on a unix-type system, and the BOFH decided to remove vim(1) because there were a dirty emacs lover, that would make me upset. However, if they also did a &quot;find /home -name .vimrc | xargs rm&quot; they would find themselves the target of a user revolt of the likes they had never seen! :-)</p>
<p>Don&#8217;t mess with the users&#8217; configs. They may treasure them, have spent time, sweat, tears and blood in getting them just right, (e.g. finally turning off clippy) and they might need them again when they convince you to reinstall the program.</p>
<p>&quot;And if you leave anything behind, they start blogging about how crappy your uninstallers are.&quot;</p>
<p>Per-user data is not program data. Such people merely need to be educated in the ways of multi-user systems. Just because they&#8217;re vocal, it doesn&#8217;t mean they&#8217;re right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550293">
				<div id="div-comment-550293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550293">
			September 17, 2007 at 11:49 am</a>		</div>

		<p>I know this probably isn&#8217;t the right forum, but what would you think of leveraging Windows Installer to remove personal settings? &nbsp;For instance[0], you could enumerate the profiles and install a RunOnce key that would notify the user that software was uninstalled and ask them if they want to remove their personal settings for it? &nbsp;The installer could drop off a mini-MSI file (or perhaps automatically generate it on Uninstall) that would take care of removing those registry keys and settings when the user next logs in. &nbsp;</p>
<p>[0] This is not really how I would do it &#8212; it&#8217;s just an example. &nbsp;A better option might be just have the MSIExec run when the user logs in to enumerate all applications uninstalled since the last login and present them in a check-list box and ask the users to check those apps for which the user wants to keep the settings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550313">
				<div id="div-comment-550313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrkMatter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550313">
			September 17, 2007 at 12:05 pm</a>		</div>

		<p>&quot;Per-user data is not program data&quot;</p>
<p>I must disagree there. Most users consider that files they did not explicitly create are &quot;program data&quot; and should be cleaned up. In fact, they are probably unaware that the AppData folder even exists, and would certainly not deem the files that a program generated without their knowledge to be &quot;theirs&quot;.</p>
<p>In the end, what matters to them is that their disk space get freed, and their registry doesn&#8217;t get bogged down by unused entries. This is not a matter of education, it is simply a matter of satisfying user needs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550333">
				<div id="div-comment-550333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550333">
			September 17, 2007 at 12:14 pm</a>		</div>

		<p>Better still leave just enough of your uninstaller to uninstall the per user setting if chosen. Perhaps best to rename the entry in add remove programs to indicate it is removal only and just for the currently logged in user</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550353">
				<div id="div-comment-550353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">squidbot</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550353">
			September 17, 2007 at 12:19 pm</a>		</div>

		<p>One of our publishers has a list of requirements for software they publish, one of which is, effectively, every trace of registry that changed when our software is installed, must be undone on installation. They run install scenarios and then compare before and after hives to make sure we restore back to the original state, no matter what happens. This drives me NUTS for exactly the reasons you specify. I&#8217;ve not been able to convince them that this is a very bad idea. I&#8217;m glad you wrote this up as it will give me further ammunition to get them to remove this requirement. Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550413">
				<div id="div-comment-550413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550413">
			September 17, 2007 at 12:55 pm</a>		</div>

		<p>Thanks for the article, Raymond. &nbsp;Just to add closure to my suggestion-box topic, I ended up writing my own generic &quot;Don&#8217;t show this again&quot; dialog that saved the check box setting in a configuration file in Application Data. &nbsp;I just couldn&#8217;t bring myself to leave behind registry keys.</p>
<p>The program created an entry in the configuration file based on the user&#8217;s domain appended to their login name, if I remember correctly, and I just had to remember to replace certain characters with underscores. &nbsp;Worked out well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550423">
				<div id="div-comment-550423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrkMatter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550423">
			September 17, 2007 at 1:09 pm</a>		</div>

		<p>@Karellen:</p>
<p>Not all the data that goes in %AppData% is that small. It could be the index for a desktop search software, or temporary files for a peer-to-peer application that must be kept between sessions.</p>
<p>Furthermore, I never said it should be removed without asking the user first. I simply said the user expect you to remove them through an uninstaller, since they are the program&#8217;s files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550433">
				<div id="div-comment-550433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Niels</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550433">
			September 17, 2007 at 1:16 pm</a>		</div>

		<p>Actually, I was just reminded of a scary case. After I tried out Joost some time ago (and weren&#8217;t too impressed with their program selection) and went to uninstall it, I wondered why I still was a bit short on disk space. And noticed they had 500+ MB of cached video floating around in my AppData folder. That&#8217;s the kind of thing I&#8217;d like to see cleaned up on uninstall. It doesn&#8217;t do any harm to remove (it won&#8217;t be missed, ever) and yet can be a pain for the user (taking up his disk space.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550473">
				<div id="div-comment-550473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550473">
			September 17, 2007 at 1:40 pm</a>		</div>

		<p>&quot;And noticed they had 500+ MB of cached video floating around in my AppData folder. That&#8217;s the kind of thing I&#8217;d like to see cleaned up on uninstall. It doesn&#8217;t do any harm to remove (it won&#8217;t be missed, ever) and yet can be a pain for the user (taking up his disk space.)&quot;</p>
<p>Then it should be stored in the TempFolder directory or some other temporary storage or evident location. &nbsp;AppDataFolder is not an appropriate location to store/save temporary stuff.</p>
<p>Bad application design is not a good reason to start having your installer pooch my machine.</p>
<p>There is definitely no universal right answer, but there are universal wrong answers in my opinion.</p>
<p>Involving installation in application design mitigates a majority of these issues.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550483">
				<div id="div-comment-550483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://improfane.pwp.blueyonder.co.uk/' rel='external nofollow' class='url'>Improfane</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550483">
			September 17, 2007 at 1:42 pm</a>		</div>

		<blockquote><p>
  &gt; &quot;or temporary files for a peer-to-peer application that must be kept between sessions.&quot;</p>
<p>  &gt; &quot;Um, strange definition of temporary? On many boxen I&#8217;m aware of, temp files are more transient than cached files. &quot;
</p></blockquote>
<p>They are temporary because they aren&#8217;t finished, they are only temporarily incomplete.</p>
<p>Otherwise you&#8217;ll restart the download everytime you delete the &#8216;temporary&#8217; download file!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550493">
				<div id="div-comment-550493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550493">
			September 17, 2007 at 1:43 pm</a>		</div>

		<p>Ah yes. After checking, each user does have a &quot;Cache&quot; shell folder separate from the &quot;Application data&quot; shell folder. Put caches in there, and they should be deleteable at any time when disk space runs low.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550513">
				<div id="div-comment-550513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550513">
			September 17, 2007 at 2:06 pm</a>		</div>

		<p>But JUST HOW is a user (or a program) supposed to go about removing other per-user data for a program that is no longer wanted or needed?</p>
<p>I am the only &quot;person&quot; who uses my computers, but I occasionally log on with a test username or another account username (like SQL_2005_Server) to do some task or other.</p>
<p>If I uninstall a program while logged in as my regular user, but I have used the program from more than one userid, am I no longer able, forever and ever, to get rid of the old, obsolete, and now useless per-user data for the other users, which might be taking up a lot of space?</p>
<p>Once I log in to those other userids, I can no longer run the uninstall program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550563">
				<div id="div-comment-550563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jess Sightler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550563">
			September 17, 2007 at 2:52 pm</a>		</div>

		<p>I think that there are a lot of cases where the uninstaller should ask you, and if you are an admin it <em>should</em> also ask about other users.</p>
<p>Think about the case of an admin switching from Thunderbird to some other mail client. &nbsp;There could be gigabytes of transient data locally that should be removed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550573">
				<div id="div-comment-550573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrkMatter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550573">
			September 17, 2007 at 2:52 pm</a>		</div>

		<p>&quot;As an administrator, I would not expect an uninstaller to remove all the other users application settings, as those users are not controlling the uninstallation.&quot;</p>
<p>Neither would I, but I would hope this uninstaller sets up a system which will ask other users with application data whether or not they would like to clean it when they first log on. The logistics of such a system, however, are often very complicated and extremely hard to get correctly (And might even be likened to malware, since an &quot;uninstall&quot; doesn&#8217;t really uninstall everything)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550643">
				<div id="div-comment-550643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550643">
			September 17, 2007 at 4:27 pm</a>		</div>

		<p>Shouldn&#8217;t the question be: why do we need an uninstaller in the first place ? Why do applications need to leave their junk all over the system ? Why should it be more complicated than e.g. dragging the application icon from your applications folder to the thrash can ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550663">
				<div id="div-comment-550663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550663">
			September 17, 2007 at 4:45 pm</a>		</div>

		<p>&quot;Why do applications need to leave their junk all over the system ?&quot;</p>
<p>Because, for security reasons, non-admin users should not be able to write directly into the application&#8217;s directory. &nbsp;Because each user needs their own store of settings for each application. &nbsp;Because applications need to have a space to store stuff that should be transferred with a roaming profile and space for stuff that shouldn&#8217;t (e.g. data stores that are too large to transfer efficiently).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550273">
				<div id="div-comment-550273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://improfane.pwp.blueyonder.co.uk/' rel='external nofollow' class='url'>Improfane</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550273">
			September 17, 2007 at 11:30 am</a>		</div>

		<p>Some older installations I&#8217;ve stumbled upon have different &#8216;uninstallation&#8217; modes like automatic and manual.</p>
<p>Manual allows you to remove everything and see it before you get rid of it. Unfortunately it is clumsy done: you can&#8217;t see the entire data (or the value!) as it doesn&#8217;t fit in the list!</p>
<p>I think this &#8216;manual&#8217; uninstallation only removes stuff added at installation time, it doesn&#8217;t check for stuff at runtime.</p>
<p>I have also seen two variations of checkboxes that are opposites:</p>
<p>* preserve my settings (ticked by default)</p>
<p>* remove my settings</p>
<p>I prefer the second one and have it unticked by default.</p>
<p>Peter is right: it&#8217;s an odd situation, people expect uninstall to remove all traces. This is why we keep seeing companies releasing dedicated installers! (Arghh!) One analogy that pops into my head is a recycling bin for applications, the application isn&#8217;t fully removed until the user makes effort to remove it completely via the recycling bin.</p>
<p>Although this links the application itself and its settings too much and probably confuses.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550693">
				<div id="div-comment-550693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.martialdevelopment.com/blog/' rel='external nofollow' class='url'>Chris @ Martial Development</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550693">
			September 17, 2007 at 6:46 pm</a>		</div>

		<blockquote><p>
  This is why we keep seeing companies releasing dedicated installers!
</p></blockquote>
<p>It is? &nbsp;I thought it was because many EXE authoring tools are free, well-documented and easy to use, where as the MSI tools are none of these things?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550343">
				<div id="div-comment-550343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Niels</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550343">
			September 17, 2007 at 12:15 pm</a>		</div>

		<p>But what then about eg. registrations? Say the application creates file type associations in HKCU during first run (it&#8217;s possible and works on XP at least) &#8211; those associations would be stale after uninstalling and might leave the user with some puzzling error messages?</p>
<p>I think I&#8217;ve read somewhere that Vista actually *supports* some kind of per-user associations and possibly class registrations, is that in the easily-uninstallable sense?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550723">
				<div id="div-comment-550723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550723">
			September 17, 2007 at 7:19 pm</a>		</div>

		<p>&quot;Think about the case of an admin switching from Thunderbird to some other mail client. &nbsp;There could be gigabytes of transient data locally that should be removed.&quot;</p>
<p>I see what you&#8217;re saying, but a checkbox at the end of the installer saying &quot;delete user data?&quot; that wipes out gigabytes of my e-mail/contacts/whatever is pretty lethal &#8211; let alone the concept of wiping out gigabytes of other user&#8217;s data!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550393">
				<div id="div-comment-550393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550393">
			September 17, 2007 at 12:38 pm</a>		</div>

		<p>DrkMatter &gt; I just hope I&#8217;m never a user on a system you&#8217;re administering.</p>
<p>If you&#8217;re the kind of admin who goes around deleting files from other users accounts just because you don&#8217;t think they&#8217;ll need them anymore, well, I don&#8217;t want to be anywhere near there. I don&#8217;t care if they&#8217;re backed up.</p>
<p>And if you can&#8217;t spare the disk space for some configuration data, that&#8217;s scary. That&#8217;s going to be, what, 2 or 3 orders of magnitude smaller than any actual user data? Pictures, documents, etc&#8230; are going to dwarf that sort of stuff by *miles*.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550743">
				<div id="div-comment-550743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550743">
			September 17, 2007 at 8:19 pm</a>		</div>

		<p>Just to clear this up&#8230;</p>
<p>User data:</p>
<ul>
<li>documents</li>
<li>
<p>actions, scripts, etc (think Photoshop)</p>
</li>
<li>
<p>savegames</p>
</li>
<li>
<p>exportable configuration</p>
</li>
</ul>
<p>Program data:</p>
<ul>
<li>everything else</li>
</ul>
<p>Configuration files should be kept <em>only</em> in case they can be imported into the next program version without side effects.</p>
<p>Take a look at Total Commander, you can save wincmd.ini and use it in a newer version but it doesn&#8217;t get upgraded with new options and you don&#8217;t even see those in the UI so you don&#8217;t know they are there unless you delete config file and make a new one.</p>
<p>Installer should give you the choice to remove everything it put onto your hard drive.</p>
<p>Isn&#8217;t there a way to somehow sync the roaming profile on demand so that the changes end up where they are supposed to end up (master profile)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550753">
				<div id="div-comment-550753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mr Cranky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550753">
			September 17, 2007 at 8:25 pm</a>		</div>

		<p>What we have here is a failure to communicate.</p>
<p>There are many classes of data; caches, settings, and user-created are the basic areas that come to mind. &nbsp;Caches should be in common temp directories; setting should be in the registry (and small); and user-created data should be stored in their documents folder. &nbsp;The first two should probably be only cleaned up by the OS; the last by no one but the user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550453">
				<div id="div-comment-550453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550453">
			September 17, 2007 at 1:33 pm</a>		</div>

		<p>&quot;It could be the index for a desktop search software&quot;</p>
<p>OK, caches are &quot;user data&quot; that can be deleted. I&#8217;ll grant that. But all caches should go in a temporary folder and should be deleteable *at any time* to recover disk space. The point of a cache is that it can be rebuilt.</p>
<p>&quot;or temporary files for a peer-to-peer application that must be kept between sessions.&quot;</p>
<p>Um, strange definition of temporary? On many boxen I&#8217;m aware of, temp files are more transient than cached files. Certainly it&#8217;s normal for temp files/folders to be cleaned on reboot. Seeing how a program doesn&#8217;t know if it&#8217;s going to be reactived before the next reboot, I don&#8217;t see how such a program is going to do well if it relies on temp files hanging around between sessions. Perhaps you could explain this one a bit more?</p>
<p>&quot;I simply said the user expect you to remove them through an uninstaller, since they are the program&#8217;s files.&quot;</p>
<p>But on a multi-user system, there are typically a lot more users than administrators, and the person doing the uninstallation (the administrator) is not a significant proportion of the people whose profiles you&#8217;re planning on deleting.</p>
<p>As an administrator, I would not expect an uninstaller to remove all the other users application settings, as those users are not controlling the uninstallation. They might have been on holiday or even sabbatical when the email went out asking if anyone was still using the app.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550783">
				<div id="div-comment-550783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550783">
			September 17, 2007 at 8:39 pm</a>		</div>

		<p>@Tom (and all the others too):</p>
<p>Start-&gt;Run: %comspec% /K cd /D %windir%inf &amp;&amp; find /i &quot;StubPath&quot; *.inf</p>
<p>This will show some promising strings containing &#8216;PerUser&#8217; or &#8216;InstallUserConfig&#8217; and even &#8216;Remove&#8217;.</p>
<p>Windows already has the base mechanism! See MSKB 238441 and 250380 for example.</p>
<p>Maybe Raymond can shed some more light on how this is supposed to work?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550883">
				<div id="div-comment-550883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bikedude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550883">
			September 18, 2007 at 5:56 am</a>		</div>

		<p>Less is more.</p>
<p>I just wish MS would issue a statement on what the official policy is. Make it part of the &quot;certified for Vista&quot; program even. (in the meantime, I will point installer-guys to this page)</p>
<p>I had a long discussion with my tool vendor about their tendancy to wipe out all my settings upon reinstalling their tool&#8230; Grrr&#8230; I hate having to set up everything just the way it was again and again&#8230;</p>
<p>My settings are sacred and my own. Stay the h&#8212; away!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-550893">
				<div id="div-comment-550893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550893">
			September 18, 2007 at 6:24 am</a>		</div>

		<p>@Niels: in Windows 2000 and later, HKEY_CLASSES_ROOT is a merged view of HKEY_LOCAL_MACHINESoftwareClasses and HKEY_CURRENT_USERSoftwareClasses (HKEY_CURRENT_USER itself being a link to the &#8216;current&#8217; user&#8217;s profile under HKEY_USERS). File name extensions, COM ProgIDs and COM classes are registered in one or both of these areas, the user-specific settings overriding the machine settings. You may have seen installers (particularly MSIs) asking if you want to install for the current user only or for all users. If authored to write to HKCR, an MSI will write to HKEY_CURRENT_USER or HKEY_LOCAL_MACHINE respectively.</p>
<p>I don&#8217;t believe this has changed in Windows Vista.</p>
<p>Any components that explicitly write to HKCU or the user&#8217;s profile will be detected as needing a repair when an advertised shortcut (which invokes Windows Installer to check the product state before launching the program) is launched by a user that hasn&#8217;t launched the program before. You should explicitly author a RemoveFiles action to remove any folders you create in the user profile when the application is uninstalled. This is all caught by the Windows Installer ICEs (Internal Consistency Evaluators) if you validate your MSI, but sadly few users do. Version 3.0 of the WiX (Windows Installer XML) toolset automatically runs validation, so we see a lot of people on the list asking about this. The WiX construction to do it properly can be found at Rob Mensching&#8217;s blog here: <a rel="nofollow" target="_new" href="http://robmensching.com/blog/archive/2007/04/27/How-to-create-an-uninstall-shortcut-and-pass-all-the.aspx" rel="nofollow">http://robmensching.com/blog/archive/2007/04/27/How-to-create-an-uninstall-shortcut-and-pass-all-the.aspx</a>.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550903">
				<div id="div-comment-550903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550903">
			September 18, 2007 at 6:25 am</a>		</div>

		<p>This is the closest to an official policy from microsoft yet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550913">
				<div id="div-comment-550913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550913">
			September 18, 2007 at 7:19 am</a>		</div>

		<p>The best way is to disable install/uninstall software for all except administrators in multi-user enviroments</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550933">
				<div id="div-comment-550933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550933">
			September 18, 2007 at 9:03 am</a>		</div>

		<p>Don&#8217;t forget about Common Application Data. It&#8217;s better to have one 5GB cache than 10 500MB caches, plus you can clean it up on uninstall.</p>
<p>Another alternative is of course to put caches in %TEMP%. Let the disk cleanup wizard deal with it, if the user needs the space.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-550983">
				<div id="div-comment-550983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://improfane.pwp.blueyonder.co.uk/' rel='external nofollow' class='url'>Improfane</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550983">
			September 18, 2007 at 11:40 am</a>		</div>

		<p>Chris @ Martial Development</p>
<p>It was supposed to say uninstallers, sorry!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-550993">
				<div id="div-comment-550993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-550993">
			September 18, 2007 at 11:47 am</a>		</div>

		<p>&quot;Installer should give you the choice to remove everything it put onto your hard drive.&quot;</p>
<p>And the data that the USE of the program has put onto your hard drive, IF it is easily findable in your Documents folder (and it should be), I suppose should best be left for cleanup by each user.</p>
<p>(Note that Outlook stores its .pst files in a not-easily-findable location. &nbsp;I predict that your half-gigabyte PST file, and every other user&#8217;s half-gigabyte PST file, would not be cleaned up by an uninstall of Outlook.)</p>
<p>Per-user settings (configuration options, settings, etc.) that the USE of the program has added to the registry should or should not be left alone in the registry, depending on each user&#8217;s preference for an uninstall to CLEAN UP, or a reinstall to not force you to re-customize the interface.</p>
<p>I suppose the adage that you can&#8217;t please all of the people all of the time is still true&#8230; &nbsp;</p>
<p>I suppose at first logon by another user after an uninstall, that user could be told that &quot;Outlook has been uninstalled; do you want to remove the old e-mail data?&quot;</p>
<p>But that flies against Raymond&#8217;s insistence that you not ask the user questions to which the user won&#8217;t know the answer. &nbsp;And I agree with that.</p>
<p>Oh well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-551053">
				<div id="div-comment-551053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551053">
			September 18, 2007 at 12:40 pm</a>		</div>

		<p>Sorry, that was kind of long-winded.</p>
<p>Some users prefer that an uninstall would do a complete cleanup of all traces of a program.</p>
<p>Other users wish that a later reinstall would not force them to re-customize their settings.</p>
<p>These two wishes are incompatible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-551083">
				<div id="div-comment-551083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mccoyn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551083">
			September 18, 2007 at 12:50 pm</a>		</div>

		<p>Why not throw all of the old user data into the recycle bin? &nbsp;That way, if the user realizes the app was uninstalled and something is missing it can be recovered for a short time. &nbsp;The next time the user actually needs space, the cleanup wizard will remove the old data.</p>
<p>The tricky part is getting the installer for the next version to find the files in the recycle bin and reuse them if possible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-551123">
				<div id="div-comment-551123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">M Hotchin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551123">
			September 18, 2007 at 5:12 pm</a>		</div>

		<p>Re: recycle bin &#8211; some of us don&#8217;t use that beast. &nbsp;I for ine wouldn&#8217;t like things to end up their &#8216;anyway&#8217;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-551163">
				<div id="div-comment-551163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551163">
			September 18, 2007 at 11:34 pm</a>		</div>

		<p>One more point to add is that with Roaming Profiles you can&#8217;t always change the user&#8217;s configuration data.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-551223">
				<div id="div-comment-551223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">problem</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551223">
			September 19, 2007 at 4:28 am</a>		</div>

		<p>The problem is, we have user specific data that can be deleted (e.g. caches) and user data for the user (documents etc.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-551533">
				<div id="div-comment-551533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://architekturaforum.hu/blogs/gerleim/archive/2007/09/20/k-237-nosan-vicces-registry-matat-225-s.aspx' rel='external nofollow' class='url'>gerleim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551533">
			September 20, 2007 at 6:46 am</a>		</div>

		<p>Raymond Chen mondja: Mit tegyek a felhaszn&#225;l&#243;nk&#233;nti be&#225;ll&#237;t&#225;sokkal a szoftver elt&#225;vol&#237;t&#225;sakor? (What</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-551543">
				<div id="div-comment-551543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bviksoe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-551543">
			September 20, 2007 at 8:02 am</a>		</div>

		<blockquote><p>
  Don&#8217;t forget about Common Application Data&#8230;
</p></blockquote>
<p>When you think about it, cache data will in many cases contain what is considered sensitive/personal data, and cannot be put in a all-user accessible location.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-552053">
				<div id="div-comment-552053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070917-00/?p=25103#comment-552053">
			September 20, 2007 at 6:37 pm</a>		</div>

		<p>Also Common Application Data can&#8217;t be written to by limited users.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>