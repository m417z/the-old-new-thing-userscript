<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-473913">
				<div id="div-comment-473913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-473913">
			February 20, 2007 at 10:15 am</a>		</div>

		<p>&quot;Make sure the prince doesn&#8217;t leave this room until I come and get him.&quot;</p>
<p>&quot;Not to leave the room, even if you come and get him.&quot;</p>
<p>&quot;No, no, until. &nbsp;Until I come and get him.&quot;</p>
<p>&quot;Until you come and get him, we&#8217;re not to enter the room.&quot;</p>
<p>&quot;No, no, no. &nbsp;You stay in the room, and make sure he doesn&#8217;t leave.&quot;</p>
<p>&#8230;</p>
<p>:-P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-473953">
				<div id="div-comment-473953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-473953">
			February 20, 2007 at 10:45 am</a>		</div>

		<p>&nbsp; &nbsp;&quot;Yesterday, I could left click the corner of a rectangle,</p>
<p>move the corner, and the rectangle would resize as the corner</p>
<p>was moved, until the left mouse button was released. &quot;</p>
<p>&#8230;then&#8230;</p>
<p>&nbsp; &nbsp;&quot;Today the rectangle doesn&#8217;t change size until I release</p>
<p>the left mouse button. &nbsp;It then snaps into position as I</p>
<p>want.&quot;</p>
<p>I wonder what crazy stuff will happen to him tomorrow?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-474073">
				<div id="div-comment-474073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://luke.breuer.com' rel='external nofollow' class='url'>Luke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474073">
			February 20, 2007 at 12:33 pm</a>		</div>

		<p>It is interesting that you say LockWindowUpdate was intended for dragging. &nbsp;A while ago I wrote a .NET regular expression testing app (<a rel="nofollow" target="_new" href="http://luke.breuer.com/images/regextest.png" rel="nofollow">http://luke.breuer.com/images/regextest.png</a>); it will execute the regex you are forming every time the regex changes or the text to be searched changes. &nbsp;Due to the Win32 RichTextBox&#8217;s (RTB) slowness, I call LockWindowUpdate on the lower RTB when matching. &nbsp;I discovered that if the amount of text in the lower (locked) RTB exceeds its visible area, every time it is updated it flickers, as well as several other windows on my multiple screens. &nbsp;Outlook 2007&#8217;s e-mail listview and toolbars flicker, quite a bit of Visual Studio flickers, as do the groupbox labels in Process Explorer&#8217;s System Information window. &nbsp;Neither Firefox nor Foobar2000 flicker.</p>
<p>I&#8217;ve noticed this flickering in other circumstances, like minimizing and then maximizing Visual Studio. &nbsp;Might this all have to do with LockWindowUpdate being used incorrectly? &nbsp;Is there much hope for a) figuring out what is going on and b) fixing it? (I am using XP SP2.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474103">
				<div id="div-comment-474103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">B.Y.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474103">
			February 20, 2007 at 1:17 pm</a>		</div>

		<p>SDK documentation often doesn&#8217;t state the intended purpose of various things, leaving the users to guess. This is a big problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-474113">
				<div id="div-comment-474113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mr Echo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474113">
			February 20, 2007 at 1:39 pm</a>		</div>

		<p>So the answer to my question from yesterday is that &quot;dragging&quot; is the semaphore that synchronizes between different apps.</p>
<p>I wonder how this woud work with MultiPoint (<a rel="nofollow" target="_new" href="http://www.microsoft.com/presspass/features/2006/dec06/12-14MultiPoint.mspx" rel="nofollow">http://www.microsoft.com/presspass/features/2006/dec06/12-14MultiPoint.mspx</a>)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474123">
				<div id="div-comment-474123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474123">
			February 20, 2007 at 1:39 pm</a>		</div>

		<p>Few questions about LockWindowUpdate:</p>
<p>1) Does it affect the non-client area? The documentation makes no mention of it.</p>
<p>2) The docs say &quot;A locked window cannot be moved.&quot;. Does that mean I&#8217;m not allowed to move it, or that the move will have no effect, or that it will be deferred until I unlock it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-474133">
				<div id="div-comment-474133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">El Guapo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474133">
			February 20, 2007 at 1:40 pm</a>		</div>

		<p>I also tried to use LockWindowUpdate when adding a lot of items to a ListView. Nevermind if this was wise or not. The point is that the whole desktop and windows on it were flickering like crazy. I quickly learned not to use that function.</p>
<p>Sorry Raymond, but some type of comment in the documentation as to the intended use of the function is definintely called for here. What is the purpose of documentation? Should you intentionally hide information just because it doesnt fit in correctly with your world view?</p>
<p>Just the number of sheer developers having problems with this function should make that obvious to you, unless you are just plain stubborn.</p>
<div class=post>[<i>It appears that everybody is under the impression that I approve of the documentation. You probably also blame Ken Burns for supporting slavery. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474193">
				<div id="div-comment-474193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kuhr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474193">
			February 20, 2007 at 3:56 pm</a>		</div>

		<p>Is there a chance you will demonstrate the proper use of LockWindowUpdate as described above in a modification to your scratch sample during this series on LWU or will you leave this as an exercise to your readers?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-474213">
				<div id="div-comment-474213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474213">
			February 20, 2007 at 5:50 pm</a>		</div>

		<blockquote><p>
  It appears that everybody is under the impression that I approve of the documentation.
</p></blockquote>
<p>Well, it seems clear that many people actually think you WRITE the documentation&#8230;</p>
<p>There is a better description of LockWindowUpdate, if you start at the documentation page for LockWindowUpdate, click on &quot;Painting and Drawing Overview&quot; then &quot;About Painting and Drawing&quot; then &quot;Window Update Lock&quot;.</p>
<p>I&#8217;ll be the first to admit, however, that this extra description is a) really tough to find (unless you already know what you&#8217;re looking for) and b) rather cryptic.</p>
<p>Mind you, Raymond&#8217;s post from yesterday is already the #3 result when you search for LockWindowUpdate on google&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474243">
				<div id="div-comment-474243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474243">
			February 20, 2007 at 9:43 pm</a>		</div>

		<p>Actualy its number #2 now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-474253">
				<div id="div-comment-474253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Metanitpicker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474253">
			February 20, 2007 at 9:59 pm</a>		</div>

		<blockquote><p>
  The mistake was in the initial order to the</p>
<p>  guard. You should have said, &quot;Nobody except</p>
<p>  me is allowed into this room.&quot;
</p></blockquote>
<p>Hey. &nbsp;Who let that nitpicker into a blog whose owner scolds nitpickers?</p>
<blockquote><p>
  And DCX_LOCKWINDOWUPDATE is how you tell the</p>
<p>  window manager, &quot;It&#8217;s me. Let me in.&quot;
</p></blockquote>
<p>Hey! &nbsp;Who let that nitpicker into Win32?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-474263">
				<div id="div-comment-474263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474263">
			February 20, 2007 at 10:15 pm</a>		</div>

		<p>Metanitpicker: Um, what are you talking about? Are you trying to say that computers should talk &quot;casual English&quot; (like a blog), rather than assembly language (like they currently do)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-474313">
				<div id="div-comment-474313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.brick-labs.com/' rel='external nofollow' class='url'>Eric D. Burdo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474313">
			February 21, 2007 at 7:59 am</a>		</div>

		<p>A place I used to work used the LockWindowsUpdate with a semaphore and VB6. &nbsp;It was to prevent the screen from drawing while we did lots of work behind the scenes.</p>
<p>It wasn&#8217;t pretty, but it worked pretty well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474333">
				<div id="div-comment-474333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474333">
			February 21, 2007 at 9:00 am</a>		</div>

		<p>I really love seeing these posts from Raymond (and other MS blogs too) with all sorts of cool stuff about how windows does what it does (and why it does it that way). All the cool stuff you just don&#8217;t see in MSDN :)</p>
<p>Now all we need is for someone from the DirectX team to start blogging about cool stuff to do with that part of windows :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-474403">
				<div id="div-comment-474403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474403">
			February 21, 2007 at 12:22 pm</a>		</div>

		<p>&lt;&lt;Due to the Win32 RichTextBox&#8217;s (RTB) slowness, I call LockWindowUpdate on the lower RTB when matching.&gt;&gt;</p>
<p>In order to temporary &quot;freeze&quot; the RTF you must get the IRichEditOle object (using EM_GETOLEINTERFACE).</p>
<p>IRichEditOle also supports the ITextDocument interface. On that one you call Freeze and Unfreeze.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-474623">
				<div id="div-comment-474623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RIck C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070220-07/?p=27953#comment-474623">
			February 21, 2007 at 6:44 pm</a>		</div>

		<p>&lt;blockquote&gt;Few questions about LockWindowUpdate:</p>
<p>1) Does it affect the non-client area? The documentation makes no mention of it.&lt;/blockquote&gt;</p>
<p>Ivo, that&#8217;s easy enough to answer: &nbsp;start with Raymond&#8217;s scratch application, and test it yourself. &nbsp;Lock the window and attempt to draw on the nonclient area.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>