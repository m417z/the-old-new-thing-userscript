<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (57)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-230803">
				<div id="div-comment-230803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230803">
			November 29, 2004 at 7:20 am</a>		</div>

		<p>And what about the Runas /savecred switch ? You only need to type your password the first time you run your batch.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230813">
				<div id="div-comment-230813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johan Ericsson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230813">
			November 29, 2004 at 7:33 am</a>		</div>

		<p>Grr&#8230;</p>
<p>IMO, that was a bad decision. Consider my problem. I&#8217;m setting up a family member&#8217;s computer environment to use limited-user mode. Everything works fine until I realize that Quickbooks won&#8217;t run in limited user mode.</p>
<p>So, I create a special Admin account for runnin Quickbooks under, and I setup a batch file that launches it using &quot;runas&quot;. I tried piping the password to the runas command, but it won&#8217;t take it. So, my batch file tells the user the password so that they can enter it. How is this more secure than simply allowing the password to be a parameter to the runas command? My solution is also a pain. I guess I need to break out my C++ compiler &amp; MSDN documentation to use &quot;CreateProcessWithLogonW&quot; :(</p>
<p>Also, why couldn&#8217;t the runas /? documentation been more forthcoming regarding this restriction. </p>
<p>Don&#8217;t get me wrong, I love Microsoft&#8217;s new security focus. But there needs to be better ways to accomplish what I&#8217;m trying to do. Otherwise, we will never get people to use the &quot;limited user&quot; mode accounts at all. Its a chicken/egg problem. Software vendors won&#8217;t fix their &quot;limited user mode&quot; bugs until users start demanding it. And users won&#8217;t start demanding it until they start using the &quot;limit user mode&quot;.</p>
<p>I&#8217;m just sick and tired spending every holiday cleaning out my family&#8217;s computers of the latest spyware/adware. I see &quot;limited user mode&quot; as the ultimate solution.</p>
<p>I haven&#8217;t look at EPAL(mentioned above). Perhaps that is a better solution. </p>
<p>Another interesting approach is detailed here:<br />
<br /><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dncode/html/secure11152004.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dncode/html/secure11152004.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230823">
				<div id="div-comment-230823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johan Ericsson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230823">
			November 29, 2004 at 7:37 am</a>		</div>

		<p>Why is /savecred only available in XP Professional?</p>
<p>It seems useful to home users who are using &quot;limited user&quot; mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230833">
				<div id="div-comment-230833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230833">
			November 29, 2004 at 7:55 am</a>		</div>

		<p>@Johann:</p>
<p>Try Microsoft Windows Application Compatibility Toolkit!</p>
<p>It has the features LuaredirectFs and something similar for the registry.<br />
<br />This often (unfortunately not always) helps, because it redirects every write-access to c:Programme (that means if the permission fails) to the user-profile or All Users.</p>
<p>This is really, really great stuff and exactly the right direction to solve this problem!<br />
<br />Make that broken, stupid, idiotic software from idiot-vendors believe they would be admins and silently redirect stuff and make up a fake world.</p>
<p>Does somebody know how LuaredirectFS works? Could I code something similar to play tricks to programms?</p>
<p>Maybe even chroot?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230843">
				<div id="div-comment-230843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230843">
			November 29, 2004 at 8:02 am</a>		</div>

		<p>Whats to prevent a program from hooking that function to see if the user/password dialog will open and then steal the password?</p>
<p>I know it&#8217;s already a problem if an univited program is executing, but what if the user is in a limited account?  That should sort of limit what damage the program can do, but not if it can get the admin password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230863">
				<div id="div-comment-230863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230863">
			November 29, 2004 at 8:07 am</a>		</div>

		<p>@Johan Ericsson</p>
<p><a target="_new" href="http://weblogs.asp.net/aaron_margosis" rel="nofollow">http://weblogs.asp.net/aaron_margosis</a> has some good info on running as non-admin.</p>
<p>You could try two things.</p>
<p>&quot;You can avoid the right-click context menu and make “Run as…” the default action for a particular .exe or .msc shortcut by opening its Properties dialog, clicking Advanced, and checking “Run with different credentials”.  When you invoke the shortcut, you’ll get the RunAs dialog, and the shortcut’s target will run under the account you specify.&quot;</p>
<p>and then use a blank password.  His reason for this is:</p>
<p>&quot;OK, I know you’re bursting already:  “No password?!?!  Are you insane?!?!”  Cool down, now.  Starting with Windows XP, a blank password is actually more secure for certain scenarios than a weak password.  By default, an account with a blank password can be used only for logging on at the console.  It cannot be used for network access, and it cannot be used with RunAs.  The user experience of just clicking on your name to log on can’t be beat for simplicity.  If you can trust everyone who has physical access to the computer not to log on as someone else or abuse the admin account, this is a great way to go.  If not, you can always enable passwords&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230873">
				<div id="div-comment-230873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mateosb.blogspot.com' rel='external nofollow' class='url'>Benjamin Mateos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230873">
			November 29, 2004 at 8:21 am</a>		</div>

		<p>Depending on your final needs, you can also use TQCRunAs application.</p>
<p><a target="_new" href="http://www.quimeras.com/Products/displayproduct.asp?IdProduct=4" rel="nofollow">http://www.quimeras.com/Products/displayproduct.asp?IdProduct=4</a></p>
<p>/r</p>
<p>Benji</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230883">
				<div id="div-comment-230883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">b100dian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230883">
			November 29, 2004 at 8:23 am</a>		</div>

		<p>This sounds like a good idea, but the problem is that it cannot be accepted on a large scale: using a blank password and not mentioning it to anybody may work, but using a blank password and telling everyone to do the same.. will generate password.<br />
<br />So, I am not using this:D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230893">
				<div id="div-comment-230893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">b100dian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230893">
			November 29, 2004 at 8:24 am</a>		</div>

		<p>sorry.. &#8216;will generate troubles&#8217;, not &#8216;password&#8217;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230903">
				<div id="div-comment-230903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230903">
			November 29, 2004 at 8:28 am</a>		</div>

		<p>But in the case of home users (ie. mom and dad) it works great.  Very few people have physical access to there machines anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230923">
				<div id="div-comment-230923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Carl Nettelblad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230923">
			November 29, 2004 at 9:47 am</a>		</div>

		<p>runas /user:foo bar.exe &lt; foo_password.txt</p>
<p>Enter your password in that file. Not that I condone it or anything, I just state the obvious.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230933">
				<div id="div-comment-230933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230933">
			November 29, 2004 at 10:00 am</a>		</div>

		<p>Carl, the obvious would be &quot;echo &quot;password&quot; | runas /user:Administrator win.exe&quot;, that way you don&#8217;t have to create another file with the password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230943">
				<div id="div-comment-230943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://joe.is-a-geek.net' rel='external nofollow' class='url'>Joseph Moore</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230943">
			November 29, 2004 at 10:05 am</a>		</div>

		<p>As I remember, trying to &quot;|&quot; or &quot;&lt;&quot; the password into a RUNAS command from a source file doesn&#8217;t work.<br />
<br />Personally, I&#8217;ve used and recommended TQCRUNAS as a solution for this problem, but I&#8217;m gonna look at this EPAL tool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230953">
				<div id="div-comment-230953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.drml.net/runasnet/runasnet.zip' rel='external nofollow' class='url'>Pat Piccolo (dr.ml)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230953">
			November 29, 2004 at 10:11 am</a>		</div>

		<p>(<a target="_new" href="http://www.drml.net/runasnet/runasnet.zip" rel="nofollow">http://www.drml.net/runasnet/runasnet.zip</a>)</p>
<p>Ask and ye shall receive </p>
<p>&#8230;actually I threw this together using pieces of other code I found on the web about two years ago and blogged it onto a now-extinct server.</p>
<p>Anyway, this is a simple C# app (VS2002 solution source code anyway) that demonstrates using impersonation.  I never login to my PC using an account with local or domain admin rights. I just use this little app to &#8216;promote&#8217; the credentials on a per-process basis. </p>
<p>[download source via the link above]</p>
<p>FYI: Impersonation requires &#8216;ACT AS PART OF THE OPERATING SYSTEM&#8217; privileges.  This is the default for XP, but for Win2k you will need to run SECPOL.MSC (The policy configuration snapin), open up LOCAL POLICIES, then USER RIGHTS ASSIGNMENTS and its the second item in the list. You may need to reboot, or at least logout/login in order for the change to take effect.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230963">
				<div id="div-comment-230963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pat Piccolo (dr.ml)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230963">
			November 29, 2004 at 10:26 am</a>		</div>

		<p>oops&#8230; the code is right but its the version that uses CreateProcessWithLogonW, not impersonation&#8230;I have another version that uses LogonUser (also in advapi32.dll) and then uses the the .net WindowsIdentity to promote the running thread to the credentials of the new user.  It works, but not as good as CreateProcessWithLogonW.</p>
<p>Query: What are some other uses for runasnet, besides running admin tools (like srvmgr and usrmgr) from a domain admin account?</p>
<p>One use I have for it is that I created different user accounts with different internet explorer settings (like disabled javascript, disallow cookies, or other higher-than-normal security settings) and then created shortcuts using runasnet to run iexplore.exe as those users.  Great for testing .net web apps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-230973">
				<div id="div-comment-230973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230973">
			November 29, 2004 at 10:29 am</a>		</div>

		<p>Speaking of feature wishes, I would really like to see the XP command line version of RunAs offer the &quot;protect my computer&quot; option that the GUI RunAs has. Aaron Margosis&#8217; blog shows how useful it can be for IE alone. It would be useful to create a &quot;restricted IE&quot; icon that used that feature.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-230993">
				<div id="div-comment-230993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-230993">
			November 29, 2004 at 10:47 am</a>		</div>

		<p>Actually &quot;Protect my computer&quot; isn&#8217;t very much protection since you&#8217;re still running on the same desktop which means that you can be attacked via messaging.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231013">
				<div id="div-comment-231013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Baird</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231013">
			November 29, 2004 at 11:03 am</a>		</div>

		<p>4NT (<a target="_new" href="http://jpsoft.com" rel="nofollow">http://jpsoft.com</a>) has a nifty little utility called &quot;keystack&quot; which allows you to simulate keyboard input. For example:</p>
<p>start RUNAS /USER:Administrator &quot;somecommand.exe&quot; &amp; keystack &quot;mypassword&quot; enter</p>
<p>This will pop up a new command window and then enter &quot;mypassword&quot; (without the quotes) followed by ther &quot;enter&quot; key. I&#8217;m not a part of the JPSoft company, but I think that 4nt is a great product for admins/devs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231023">
				<div id="div-comment-231023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vorn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231023">
			November 29, 2004 at 11:19 am</a>		</div>

		<p>It should be pointed out that Unix&#8217;s login/user change functions &#8211; login/sh, rlogin/rsh, ssh, su, and sudo &#8211; all require that you input the password manually as well; this is not a feature specific to Windows, and it is the standard operating procedure for nearly all multiuser OSes in the world.  Don&#8217;t yell at Windows for doing it right, please.</p>
<p>(sudo is slightly different from the others &#8211; most of the above-mentioned commands require that you input the password of the user you intend to work as; sudo requires that you enter your own password, and simply gives you temporary root-like privileges.  In most cases your box&#8217;s administrator needs to involve himself in allowing you access to sudo, specifically adding your username to the list of users; also, the administrator has access to a complete log of all commands completed under sudo.)</p>
<p>Vorn</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231033">
				<div id="div-comment-231033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231033">
			November 29, 2004 at 11:20 am</a>		</div>

		<blockquote><p>
  &gt; you can be attacked via messaging. </p>
<p>I was more interested in running IE in a sandbox to minimize the chance that a security exploit could cause trouble.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231043">
				<div id="div-comment-231043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexey Kats</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231043">
			November 29, 2004 at 11:35 am</a>		</div>

		<p>A little correction &#8211; &quot;sudo&quot; has multiple options and can be set to require root password, or your own password, or the password of a user you try to impersonate. Also, you can explicitely specify the account you want to impersonate &#8211; you are not limited to root account only. It&#8217;s a very flexible tool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231053">
				<div id="div-comment-231053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bovine.net/' rel='external nofollow' class='url'>Jeff Lawson [ex-msft]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231053">
			November 29, 2004 at 11:57 am</a>		</div>

		<p>The &quot;Protect My Computer&quot; checkbox on the GUI version of RunAs in WinXP actually implements the &quot;Constrained&quot; level that Mike Howard discusses here:  <a target="_new" href="http://msdn.microsoft.com/security/securecode/columns/default.aspx?pull=/library/en-us/dncode/html/secure11152004.asp" rel="nofollow">http://msdn.microsoft.com/security/securecode/columns/default.aspx?pull=/library/en-us/dncode/html/secure11152004.asp</a></p>
<p>When I was helping the shell team to integrate that feature for WinXP (I implemented the underlying kernel32 &quot;Safer&quot; APIs), there was some debate of also running the application in a Job Object with some JOBOBJECT_BASIC_UI_RESTRICTIONS flags set, but I think that was removed due to wide application incompatiblity.</p>
<p>Note that the decision to make the GUI RunAs only have a single checkbox had to be made in order to make the feature easier to understand.  We could have allowed the selection of fine-grained Normal/Contrained/Untrusted mode, the option of running in a limited Job Object, or running as another user with restrictions, but that would have made the UI so complicated that most people would not even understand it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231063">
				<div id="div-comment-231063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231063">
			November 29, 2004 at 12:01 pm</a>		</div>

		<p>I suppose the ideal solution to running programs like Quickbooks is to use Regmon and Filemon while running the app under a limited account to find out where it is failing and then creating a new user group that has permissions to modify the files/keys that quickbooks requires and adding all the users who need to run Quickbooks to that group.<br />
<br />That might be worthwhile when rolling out an application to a few hundred users, but it&#8217;s far too much hassle to do for a home user, especially with XP Home that has all the user and permissions GUIs stripped out.</p>
<p>I&#8217;ve been running my XP systems with a limited account for a few months and it hasn&#8217;t been too much trouble. My most recent workarounds were for Half Life 2 and DigiGuide which both want to write to their installation directory. </p>
<p>I actually prefer the OSX method where it prompts for a password when an elevated permission is required rather than failing outright. I suppose that leaves people vulnerable to social engineering attacks if they get used to entering their password at every prompt, but I find I only need to do it once every few days.</p>
<p>The browser hijackers are already giving people instructions to click on the information bar in XP SP2, there is not a lot more that can be done to protect people from themselves.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231073">
				<div id="div-comment-231073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231073">
			November 29, 2004 at 12:03 pm</a>		</div>

		<p>&quot;running IE in a sandbox to minimize the chance that a security exploit could cause trouble&#8230;&quot; </p>
<p>The chance is reduced but not eliminated. If somebody can inject code into IE then they can call interfere with any other program that has a window. (E.g., find its window, send some messages, change some properties&#8230;)</p>
<p>I just run all the time as a limited account. Only rarely do I have to do something administrative.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231103">
				<div id="div-comment-231103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lem</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231103">
			November 29, 2004 at 12:29 pm</a>		</div>

		<p>I&#8217;m surprised that no one has mentioned psExec (<a target="_new" href="http://www.sysinternals.com/ntw2k/freeware/psexec.shtml" rel="nofollow">http://www.sysinternals.com/ntw2k/freeware/psexec.shtml</a>), which works as well for running programs under different credentials on the local machine as it does on a remote machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231113">
				<div id="div-comment-231113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231113">
			November 29, 2004 at 12:48 pm</a>		</div>

		<p>One way maybe to get around the problem of programs wanting to write to their installation directory would be to intercept reads/writes to that file. (or redirect with the file is opened) Then redirect to another file, say in Documents and Setting or some place where that user could read/write.  This maybe could be done by hooking CreateFile.  But I can see tons problems in this method.  Maybe there is another way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231133">
				<div id="div-comment-231133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Foolhardy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231133">
			November 29, 2004 at 12:58 pm</a>		</div>

		<p>Jeff, one of the things that annoys me the most about Windows is that it has a powerful and flexible base but the UI is too crippled to use it. Isn&#8217;t it the point of an &#8216;Advanced&#8217; button to hide complex buttons that not everyone understands? The advanced dialog should expose 100% of the system&#8217;s potential.</p>
<p>Job objects with UI restrictions provide a great way to insulate untrusted processes from the rest of the desktop. Unfortunately, the only way I could use them was to create my own tool, jobprc:<br />
<br /><a target="_new" href="ftp://68.62.27.206/pub/jobprccur.zip" rel="nofollow">ftp://68.62.27.206/pub/jobprccur.zip</a></p>
<p>As for how to give elevated privileges only to those programs that need it, where appropriate, how about giving the user membership to the Administrators group but making it a deny-only SID normally (for the shell and it&#8217;s children), giving the user&#8217;s programs a full token only with trusted/necessary programs? The list of trusted programs would be decided by a standard administrator. Digital signing of binaries could also confer trust.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231143">
				<div id="div-comment-231143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231143">
			November 29, 2004 at 1:32 pm</a>		</div>

		<p>The file system and registry redirection and default restricted administrator account appear to be upcoming features of Longhorn.</p>
<p>This article seems to be the most comprehensive so far on the directions Microsoft is moving.</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/en-us/dnlong/html/leastprivlh.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/dnlong/html/leastprivlh.asp</a></p>
<p>I just wish it wasn&#8217;t all so far off.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231153">
				<div id="div-comment-231153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JimB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231153">
			November 29, 2004 at 2:53 pm</a>		</div>

		<p><a href="http://www.sysinternals.com" rel="nofollow">http://www.sysinternals.com</a> have a utility called psexec which will do what you need.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231163">
				<div id="div-comment-231163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231163">
			November 29, 2004 at 3:09 pm</a>		</div>

		<p>I saw a mention of Savecred. If you savecred one thing then there is no security.</p>
<p>EG</p>
<p>Runas Prog1 /admin /savecred</p>
<p>will now allow anyone to type</p>
<p>runas prog2 /admin<br />
<br />and it will work and run in the admin account with the first statement&#8217;s savecred credentials.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231193">
				<div id="div-comment-231193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SrdjanS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231193">
			November 29, 2004 at 3:19 pm</a>		</div>

		<p>Using PSExec I&#8217;ve found some minor gotchas for some Shell APIs. In particular, you can check the following link for one particular problem I encountered:<br />
<br /><a target="_new" href="http://groups.google.com/groups?q=platformsdk+shell+srdjan&amp;hl=en&amp;lr=&amp;selm=f052d26.0409211321.31b15ce0%40posting.google.com&amp;rnum=1" rel="nofollow">http://groups.google.com/groups?q=platformsdk+shell+srdjan&#038;hl=en&#038;lr=&#038;selm=f052d26.0409211321.31b15ce0%40posting.google.com&#038;rnum=1</a></p>
<p>This is clearly related to running the said code in a SYSTEM account which is what PSExec will give you by default. It works OK if you&#8217;re not running in the system account, through the RunAs methods.</p>
<p>Anyways, thought I&#8217;d point out that there <em>could</em> be other potential issues in applications that run using PSExec&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231213">
				<div id="div-comment-231213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231213">
			November 29, 2004 at 4:23 pm</a>		</div>

		<p>@Random</p>
<p>&quot;Second and more important, it is impossible to bring up a control panel with admin rights without logging off. I guess that the reason for this is that privileges are assigned per process, and the control panel sits inside &quot;explorer.exe&quot;. Mr Chen has once explained the reason for this particular design decision: &quot;</p>
<p>Sure you can.  You need to launch a second copy of explorer.exe.  To set up this up you need to logon to the admin account and enable &quot;Launch folder windows in a separate process&quot;.  This has to be enabled on the target account. (i.e. the account you use in runas)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231223">
				<div id="div-comment-231223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231223">
			November 29, 2004 at 4:33 pm</a>		</div>

		<p>@Random.</p>
<p>Here is a better way. Create a shortcut with this:</p>
<p>runas.exe /user:&lt;adminaccount&gt; &quot;control.exe&quot;</p>
<p>This will open the control panels as admin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231243">
				<div id="div-comment-231243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231243">
			November 29, 2004 at 5:53 pm</a>		</div>

		<p>Eandom</p>
<p>AlwaysInstallElevated<br />
<br />HKLMSOFTWAREPoliciesMicrosoftWindowsInstaller </p>
<p>Data type Range Default value<br />
<br />REG_DWORD  0 | 1  0</p>
<p>Description<br />
<br />Directs Windows Installer to use system permissions when it installs a program. By default, Windows Installer uses the user&#8217;s permissions to install programs.</p>
<p>This entry stores the setting of the Always install with elevated privileges Group Policy. Group Policy adds this entry to the registry with a value of 1 when you enable the Always install with elevated privileges policy. If you disable the policy, Group Policy sets the value to 0. If you set the policy to Not configured, Group Policy deletes the entry from the registry and the system behaves as though the value is 0.</p>
<p>Value Meaning<br />
<br />0 (or not in registry) The policy is disabled or not configured. Use the current user&#8217;s permissions, except when installing published or assigned programs.<br />
<br />1 The policy is enabled. Uses system permissions. </p>
<p>This entry extends elevated privileges to all programs. These privileges are usually reserved for programs that have been assigned to the user (offered on the desktop), assigned to the computer (installed automatically), or made available in Add/Remove Programs in Control Panel. This entry lets users install programs that require access to directories that the user might not have permission to view or change, including directories on highly restricted computers.</p>
<p>Change method<br />
<br />To change the value of this entry, use Group Policy. This entry corresponds to the Always install with elevated privileges policy (Computer ConfigurationAdministrative TemplatesWindows ComponentsWindows Installer).</p>
<p> Note</p>
<p>This entry can appear in both HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER. If this entry appears in both subtrees, the value in HKEY_LOCAL_MACHINE takes precedence over the value in HKEY_CURRENT_USER.</p>
<p> Tip</p>
<p>For detailed information about particular Group Policy settings, see the Group Policy Reference (Gp.chm) on the Windows 2000 Resource Kit companion CD.</p>
<p>For general information about Group Policy, see Group Policy in Windows 2000 Help.</p>
<p>To see a table associating policies with their corresponding registry entries, see the Group Policy Reference Table.</p>
<p> Caution</p>
<p>Skilled users can take advantage of the permissions this entry grants to change their privileges and gain permanent access to restricted files and folders. Note that the User Configuration version of this entry is not guaranteed to be secure.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231203">
				<div id="div-comment-231203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamesatuncw.com/blog/archive/2004/11/29/195.aspx' rel='external nofollow' class='url'>James Summerlin's Blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231203">
			November 29, 2004 at 7:10 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231173">
				<div id="div-comment-231173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231173">
			November 29, 2004 at 3:13 pm</a>		</div>

		<p>I regularly reconfigure various aspects of my system, like most geeks do. However, I would still like to run my ordinary software (browser, IM client&#8230;) under a restricted account. I would not have believed how hard this actually is.</p>
<p>First, I *can* run ordinary setup programs as administrator using Run As&#8230; from Explorer. However, this does *not* work with those &quot;new&quot; .msi-Installers.</p>
<p>Second and more important, it is impossible to bring up a control panel with admin rights without logging off. I guess that the reason for this is that privileges are assigned per process, and the control panel sits inside &quot;explorer.exe&quot;. Mr Chen has once explained the reason for this particular design decision: </p>
<p>From <a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2004/10/13/241725.aspx" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2004/10/13/241725.aspx</a></p>
<p>&gt; &quot;Why is explorer.exe monolithic? Why wasn&#8217;t<br />
<br />&gt; there a desktop.exe, taskbar.exe, etc?&quot;<br />
<br />&gt;<br />
<br />&gt;    Processes are expensive.</p>
<p>I wonder if this is still true, and if it is, why we bother with processes at all and don&#8217;t run every single (even 3rd party) Windows service or app as a thread of explorer. &quot;But that would be a horrible security hole!&quot; Oh wait&#8230;</p>
<p>At any rate, I think it&#8217;s another case of a premature optimization sooner or later firing back. It forces me to use an admin account for daily work, which sucks because it makes my system a tiny bit less secure.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231263">
				<div id="div-comment-231263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231263">
			November 30, 2004 at 12:21 am</a>		</div>

		<p>Just hold down the left shift key and right click on the control panel item.  RunAs is now listed on the context menu.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231233">
				<div id="div-comment-231233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231233">
			November 29, 2004 at 4:37 pm</a>		</div>

		<p>@Random</p>
<p>&quot;However, this does *not* work with those &quot;new&quot; .msi-Installers.&quot;</p>
<p>You can.  Open cmd.exe/explorer.exe with admin rights and launch the .msi from there.</p>
<p>Working with a limited account can be funny because you have to relearn howto do some simple tasks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231273">
				<div id="div-comment-231273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231273">
			November 30, 2004 at 1:37 am</a>		</div>

		<p>Basically, what&#8217;s missing is a &#8216;sudo&#8217; equivalent for win32 ? </p>
<p>Looking at the EPAL page, I conclude that&#8217;s basically a LDAP version of sudo (correct?).<br />
<br />So why is there no non-LDAP version ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231283">
				<div id="div-comment-231283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jean-Marc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231283">
			November 30, 2004 at 6:48 am</a>		</div>

		<p>Johan et al., you should check Sanur at:<br />
<br /><a href="http://www.commandline.co.uk/sanur/" rel="nofollow">http://www.commandline.co.uk/sanur/</a><br />
<br />I use it on an XP Home as a workaround for the missing /savecred, and it works pretty fine.</p>
<p>HTH</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231353">
				<div id="div-comment-231353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231353">
			November 30, 2004 at 10:08 am</a>		</div>

		<p>@several people</p>
<p>Thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231313">
				<div id="div-comment-231313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.neovalens.com' rel='external nofollow' class='url'>marco</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231313">
			November 30, 2004 at 8:02 am</a>		</div>

		<p>for the *ultimate* solution check out our NeoExec/AD (www.neovalens.com). NeoExec allows you to manage privileges (group membership and user rights) on a per-application basis.</p>
<p>NeoExec does _not_ use/require a second user account as the privileges are changed on the fly.</p>
<p>It is free for home-users for non-professional use &#8212; and up to 5 computers.</p>
<p>ps: XP Home users go for the &quot;NeoExec Professional&quot; version &#8212; all others get the full power and give the Active Directory version a go.</p>
<p>Marco [alla] neovalens [punto] com</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231463">
				<div id="div-comment-231463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231463">
			November 30, 2004 at 6:19 pm</a>		</div>

		<p>11/29/2004 12:01 PM Edward</p>
<p>&gt; The browser hijackers are already giving<br />
<br />&gt; people instructions to click on the<br />
<br />&gt; information bar in XP SP2, there is not a<br />
<br />&gt; lot more that can be done to protect people<br />
<br />&gt; from themselves.</p>
<p>When first reading, I agreed with that, but later I figured out why people are obeying such things.  Of course part of the problem is social engineering, but part of it isn&#8217;t.</p>
<p>The old Windows Update used to tell people that they must click yes on every security warning popped up by IE, including that they must click yes and accept unsigned ActiveX controls.</p>
<p>Even when the old Windows Update itself wasn&#8217;t running, other things were.  When my parents used Outlook Express and the Windows 98 automatic update informer (whatever it was called) popped up a message advising them to go to Windows Update because patches were waiting, my parents thought that Outlook Express popped that up.  When my wife uses Internet Explorer to read her mail on Yahoo, she still has trouble distinguishing between Internet Explorer&#8217;s buttons and Yahoo&#8217;s web pages&#8217; buttons, and scrollbars, and what needs a single click and what needs a double click.  When Internet Explorer pops up a warning saying that the next page is partly secure but partly insecure, she can&#8217;t distinguish whether that is from Internet Explorer or from Yahoo and I have to tell her to click yes.  When the Windows 98 automatic update informer reports that updates are available, she can&#8217;t distinguish whether that report is from Internet Explorer or from Yahoo.  I&#8217;m the one who understands that it&#8217;s neither, and I take the computer and do a Windows Update.</p>
<p>Anyway, on occasions when people do read what they&#8217;re told in various windows, they have been conditioned to obey and to click yes.  This is not only social engineering.  They have been taught to act this way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231483">
				<div id="div-comment-231483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.luckie-online.de' rel='external nofollow' class='url'>Michael Puff</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231483">
			December 1, 2004 at 1:18 am</a>		</div>

		<p>By the way, how is the keyboard input surpressed while typing the password?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-231503">
				<div id="div-comment-231503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sflint@bmc.com' rel='external nofollow' class='url'>splintor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231503">
			December 1, 2004 at 3:03 am</a>		</div>

		<p>We had a similar problem with signing cab files.</p>
<p>The signcode.exe utlity won&#8217;t accept password as a parameter, and prompts a password dialog.</p>
<p>This was a problem in our nightly automated build.</p>
<p>I ended up writing a small utility that is run before signcode.exe, sleeps in a loop until it finds the appropriate window, and then sends WM_SETTEXT to the password dialog and WM_COMMAND to the OK button.</p>
<p>I guess I could do it with AutoIt3 (<a target="_new" href="http://www.hiddensoft.com/autoit3/" rel="nofollow">http://www.hiddensoft.com/autoit3/</a>) as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-231803">
				<div id="div-comment-231803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cjm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-231803">
			December 1, 2004 at 6:42 pm</a>		</div>

		<p>Random,</p>
<p>If you want to run a control panel as an Administrator within a limited account, hold down shift and right-click the icon.  You&#8217;ll see &quot;Run As&#8230;&quot;.  This works with most of them.  It doesn&#8217;t work for &quot;Folder Options&quot;, though.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-232373">
				<div id="div-comment-232373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jernstrom.org' rel='external nofollow' class='url'>Kimmo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-232373">
			December 5, 2004 at 10:22 am</a>		</div>

		<p>I&#8217;m personally using the freeware utility CPAU from Joeware.net &gt;&gt; <a target="_new" href="http://www.joeware.net/win/free/tools/cpau.htm" rel="nofollow">http://www.joeware.net/win/free/tools/cpau.htm</a></p>
<p>&quot;Summary</p>
<p>Command line tool for starting process in alternate security context. Basically this is a runas replacement. Also allows you to create job files and encode the id, password, and command line in a file so it can be used by normal users.&quot;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-232383">
				<div id="div-comment-232383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-232383">
			December 5, 2004 at 10:29 am</a>		</div>

		<p>It doesn&#8217;t matter how much you encrypt the password. It gets passed in cleartext to CreateProcessAsUser &#8211; that&#8217;s where the hacker attacks. Once there, you have the password after it has been decrypted. Good-bye security.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-232503">
				<div id="div-comment-232503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">1 Litre</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-232503">
			December 6, 2004 at 2:33 am</a>		</div>

		<p>Raymond:</p>
<p>On my home PC, I&#8217;ll take that tradeoff &#8211; I need an account where the kids can play Age of Mythology without being able to run all over the hard disc. Most of the utilities mentioned on this thread are &quot;good enough&quot; for what I&#8217;m doing, on a firewalled machine that doesn&#8217;t use IE/OE.</p>
<p>(Though IMO the fault lies with the application here &#8211; for a game (and an MS-badged game, at that) to require Administrator rights is completely nuts. As long as stuff like that exists, home users won&#8217;t use limited-access accounts).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-233243">
				<div id="div-comment-233243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jernstrom.org' rel='external nofollow' class='url'>Kimmo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-233243">
			December 7, 2004 at 2:43 pm</a>		</div>

		<p>Thanks Raymond,</p>
<p>I appreciate your comment about the security issues of using an application that uses CreateProcessAsUser. In my, and I guess, others as well, circumstances this is the best we can do to be able to run processes with elevated privilgeges. Do you have some other alternatives that would be sufficent secure?</p>
<p>Kind regards //<br />
<br />Kimmo</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-233263">
				<div id="div-comment-233263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-233263">
			December 7, 2004 at 3:03 pm</a>		</div>

		<p>I already gave a link to EPAL in the article.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234303">
				<div id="div-comment-234303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.luckie-online.de' rel='external nofollow' class='url'>Michael Puff</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-234303">
			December 13, 2004 at 9:36 pm</a>		</div>

		<p>May I bring back your attention to my question once again?<br />
<br />&quot;By the way, how is the keyboard input surpressed while typing the password?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-234323">
				<div id="div-comment-234323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-234323">
			December 13, 2004 at 9:48 pm</a>		</div>

		<p>I leave that as a (simple) exercise. Look through the console functions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-234543">
				<div id="div-comment-234543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.luckie-online.de' rel='external nofollow' class='url'>Michael Puff</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-234543">
			December 14, 2004 at 1:15 pm</a>		</div>

		<p>Thank you for your hint. I just found &quot;SetConsoleMode&quot;, &quot;ReadConsole&quot; and &quot;WriteConsole&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375213">
				<div id="div-comment-375213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.ugidotnet.org/alexblog/archive/2006/04/30/39783.aspx' rel='external nofollow' class='url'>Alex's Weblog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-375213">
			April 29, 2006 at 6:23 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-499503">
				<div id="div-comment-499503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adamo.wordpress.com/2007/05/04/people-get-hacked-not-machines/' rel='external nofollow' class='url'>People get hacked, not machines &laquo; Blogs are like opinions. Everybody has one&#8230;</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-499503">
			May 4, 2007 at 4:23 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://adamo.wordpress.com/2007/05/04/people-get-hacked-not-machines/" rel="nofollow">http://adamo.wordpress.com/2007/05/04/people-get-hacked-not-machines/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-697403">
				<div id="div-comment-697403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jernstrom.org/site/2006/01/cpau-create-process-as-user/' rel='external nofollow' class='url'>jernstrom.org &raquo; CPAU (Create Process As User)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041129-00/?p=37183#comment-697403">
			January 2, 2009 at 1:18 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://jernstrom.org/site/2006/01/cpau-create-process-as-user/" rel="nofollow">http://jernstrom.org/site/2006/01/cpau-create-process-as-user/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>