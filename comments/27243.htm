<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (70)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-493313">
				<div id="div-comment-493313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493313">
			April 16, 2007 at 10:04 am</a>		</div>

		<p>Somehow, I have a feeling that programs will find a way around it anyway. Probably involving hacking the registry to turn off power management or something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493333">
				<div id="div-comment-493333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Darren Winsper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493333">
			April 16, 2007 at 10:43 am</a>		</div>

		<p>Essentially, is this process time or real time? &nbsp;Two seconds of real time does seem increadibly short.</p>
<div class=post>[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493343">
				<div id="div-comment-493343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493343">
			April 16, 2007 at 10:52 am</a>		</div>

		<p>Question&#8230; What about apps (such as media players, games with long<br />
cenematic sequences, etc&#8230;) that prevent the screensaver from<br />
appearing? has that changed, or is it just the user-initiated suspend<br />
thats changed?</p>
<div class="post">[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493353">
				<div id="div-comment-493353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493353">
			April 16, 2007 at 10:53 am</a>		</div>

		<p>Doh!</p>
<p>s/This program probably/This code probably/</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493373">
				<div id="div-comment-493373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493373">
			April 16, 2007 at 10:59 am</a>		</div>

		<p>The entire OS should be designed around distrusting application-level programs, because they&#8217;ve proven themselves to be as selfish as they can possibly be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493383">
				<div id="div-comment-493383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Albert Stienstra</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493383">
			April 16, 2007 at 11:22 am</a>		</div>

		<p>I am surprised! My Vista PC has stopped doing any power management<br />
at all! It does not show the screen saver, it does not go into standby<br />
etc. The only thing it does is go into sleep mode when I push the<br />
button. So, that is what I do; nothing automatic here. What can be the<br />
problem? It did work before; until now I had the belief that one of the<br />
updates killed power management. </p>
<div class="post">[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493393">
				<div id="div-comment-493393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493393">
			April 16, 2007 at 11:23 am</a>		</div>

		<p>I like how after Raymond says he&#8217;s no expert and he doesn&#8217;t have the answer, AND points people at the right people to ask questions&#8230; people still post questions here.</p>
<p>Anyway, the answer is, &quot;well, the program&#8217;s just going to have to cope with whatever Windows does, won&#8217;t it?&quot; If software developers haven&#8217;t abused the OS&#8217;s good faith in the past, it wouldn&#8217;t have to set deadlines like this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493403">
				<div id="div-comment-493403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493403">
			April 16, 2007 at 11:25 am</a>		</div>

		<p>I second Adam&#8217;s comments. &nbsp;Not just for<br />
hibernation/standby/sleep requests, but for shutdown, too. &nbsp;At<br />
shutdown you get 5 seconds, which can be a lifetime on a machine with a<br />
fast disk and plenty of memory. &nbsp;But heaven help you if you only<br />
have a megabyte of RAM or if you have other apps contending for the<br />
same resources.</p>
<div class="post">[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>
<p>I would have prefered a scheme that scales to the power of the<br />
machine and/or the number of processes running. &nbsp;For example, send<br />
each process the signal sequentially, momentarily boost their priority,<br />
and given them 150-200 ms. &nbsp;By serializing, you eliminate most of<br />
the contention for I/O, so you might be able to hibernate/shutdown even<br />
faster.</p>
<p>BTW, does anyone have a mnemonic for remembering the differences<br />
between standby, hibernate, and sleep? &nbsp;I can never remember which<br />
mode is which.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493413">
				<div id="div-comment-493413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.1060.org/blogxter/publish/5' rel='external nofollow' class='url'>Steve Loughran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493413">
			April 16, 2007 at 11:29 am</a>		</div>

		<p>This is really good. Really good. &nbsp;I have a (uh oh) system tray applet I wrote myself to do exactly this, because I got fed up with taking the laptop out of the bike and discovering I&#8217;d been cycling home with a spun up hard disk and now had a flat battery with some risk of HDD damage.</p>
<p>I think too many developers thought that if they stopped you suspending, they&#8217;d stop you disconnecting from the network, which was usually their real goal. But the reality is people are going to pick up their laptop and go wherever they go, and apps have to get over that.</p>
<p>What will be interesting is whether forcing apps to deal with this problem will result in apps that adapt better to changes in network state. Now that they can&#8217;t stop you roaming with their laptop, they had better learn to work well in this condition. Except java apps of course, for there is no power management or network state API in Java SE. But that&#8217;s Sun&#8217;s fault, and probably stems from them not having any laptops of their own.</p>
<p>-steve</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493423">
				<div id="div-comment-493423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Sowul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493423">
			April 16, 2007 at 11:41 am</a>		</div>

		<p>So let&#8217;s hope you don&#8217;t accidentally hit suspend when you&#8217;re burning a CD, or recording a television show, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493443">
				<div id="div-comment-493443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493443">
			April 16, 2007 at 11:52 am</a>		</div>

		<p>Lord knows I have tried to use sleep/hib on Vista but I keep running into trouble. If I&#8217;ve had the notebook off for more than about a day, several services fail on resume because they all rush for the network and it&#8217;s not ready yet. There is no knob I can find to tell them to back off. The good news is that Vista does a much more thorough job of logging these problems. Maybe that will lead to action to fix them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493453">
				<div id="div-comment-493453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob Rightmyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493453">
			April 16, 2007 at 12:19 pm</a>		</div>

		<p>So I was responsible for the code which does cancels shutdown/hibernate in a major media type app (read ITunes like) while cd burning / ripping / device transfer is in session. &nbsp;What do you do if your app is burning a CD or worse transferring to a device and the conputer wants to shutdown? &nbsp;You could end up destroying al the meta data on an ipod type device.</p>
<p>Have these problems been considered?</p>
<div class=post>[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493463">
				<div id="div-comment-493463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob H</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493463">
			April 16, 2007 at 12:55 pm</a>		</div>

		<p>I&#8217;m very happy to hear about this change. Closing the lid of my laptop isn&#8217;t a request, it&#8217;s a demand. Unless I&#8217;m running air traffic control software, there&#8217;s nothing more important my computer can do than shut down and not overheat, and I&#8217;d like to think I have more sense than to run air traffic control software on my laptop.</p>
<p>Rob Rightmeyer: If my app is burning a CD, I&#8217;ll accept a coaster. I didn&#8217;t hit Suspend and confirm the action by accident, nor did I close my laptop by accident, and I can hear the CD drive working. If it&#8217;s ripping a CD, I&#8217;d like it to start at the same track next time, but this is such an exceptional case that I&#8217;d be OK if it just started the CD from scratch.</p>
<p>If you&#8217;re transferring data to a device&#8230; well, connections fail anyway. Users yank cords out, power fails, OSes crash. Hopefully the device&#8217;s software is robust enough to deal with these situations without any gereivious damage. And just to soften the blow even more, you probably get several dozen milliseconds to set things right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493483">
				<div id="div-comment-493483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493483">
			April 16, 2007 at 1:16 pm</a>		</div>

		<p>Why do I have a sneaking suspicion that in the end this behavior will be retained for the sake of backward compatibility? &nbsp;Not to mention the legitimate reasons for retaining this behavior stated above. &nbsp;I guess you&#8217;re damned if you do, damned if you don&#8217;t.</p>
<div class=post>[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493493">
				<div id="div-comment-493493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493493">
			April 16, 2007 at 1:47 pm</a>		</div>

		<p>&quot;Two seconds of real time does seem increadibly short.&quot;</p>
<p>When I close the lid of my laptop, I intend to move it after a few seconds. The laptop had better be in standby or there is a risk to damaging the hard disk. What part of &quot;standby NOW&quot; do the programmers not understand?</p>
<p>The reality is today&#8217;s computing environment is more empherical than ever. PnP means devices can come and go &#8211; including that disk with an open file on it. WiFi means network connectivity can be lost any time. Batteries can die at any time. Fast User Switching means the &quot;current user&quot; can change at any time.</p>
<p>This stuff isn&#8217;t new, folks &#8211; deal with it, gracefully, if you please.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493513">
				<div id="div-comment-493513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sergey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493513">
			April 16, 2007 at 2:26 pm</a>		</div>

		<p>People&#8230; Maybe it&#8217;s just time to pay attention how it&#8217;s being done on the rest of the OS?</p>
<p>Example: Linux just saves and then restores the whole memory (including caches) when going into hybernate mode. This means up to several mins before going down (around 1min per each GB of RAM I think), but it also offers same state at the wakeup, not just the windows core programs.</p>
<p>Say if you were working in Blender with a complicated scene you&#8217;ll get everything restored. Even the mp3 song playing in the background. (in again less than a minute for a PC&#8217;s with up to 1GB RAM)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493523">
				<div id="div-comment-493523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cdecl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493523">
			April 16, 2007 at 2:42 pm</a>		</div>

		<p>Well I guess when the user puts the system to sleep/standby/suspend/hibernate/&#8230;, I won&#8217;t have to do anything at all. When the system resumes, everything is still there. If there&#8217;s I/O going on, 2 seconds should be just enough to abort it. Besides, if the user is copying or downloading things, chances are (s)he knows about it, and expects it to fail after resume. A program can ask whether to try again, or just go ahead and try again automatically.</p>
<p>Gee, is it me or is this whole &quot;OMG 2 SECS?!&quot; thing mostly moot? Or is it like, you write an essay in notepad, forget to save (/can/ happen), turn off the computer and have 2 seconds to read and response to, like &quot;hey, do you want to save this? yes? what file name?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493533">
				<div id="div-comment-493533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eman Deriuqer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493533">
			April 16, 2007 at 3:10 pm</a>		</div>

		<p>So, my understanding is that you&#8217;re the expert in this area. Is that correct?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493553">
				<div id="div-comment-493553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.brentdax.com' rel='external nofollow' class='url'>Brent Royal-Gordon</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493553">
			April 16, 2007 at 3:24 pm</a>		</div>

		<p>Somehow, I suspect Windows Update, Windows Installer, and Vista SP1 will still be able to cancel a suspend. &nbsp;And probably Office 2009 as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493563">
				<div id="div-comment-493563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.gibixonline.com' rel='external nofollow' class='url'>Joshua</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493563">
			April 16, 2007 at 3:45 pm</a>		</div>

		<p>@Sergey: As far as I know Windows does this as well with hibernate, granted the mp3 may stop but I have had it work on resume. I guess I don&#8217;t see what you&#8217;re getting at.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493573">
				<div id="div-comment-493573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob Rightmyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493573">
			April 16, 2007 at 3:54 pm</a>		</div>

		<p>Ok, I understand all of the you should, the appliance should be able to, but MS shipped an OS with this api support and documented it, app developers took advantage of it, now the functionality is taken away.</p>
<p>You have left a number of apps looking bad on Vista by doing so. &nbsp;A users does not say, its the apps fault (and is it because they didn&#8217;t think what happens if my api is removed in the next service pack), they say this new OS is bad.</p>
<p>BTW &#8211; sure if a BSOD occurs a user knows something bad happened, but if he was synching 10k tracks and walked away expecting his computer to stay running until it was done, should he need to go and reset the sleep settings prior to doing so. &nbsp;What will Zune do?</p>
<p>Larry&#8217;s idea of a software contract I believe comes int oplay here. &nbsp;Vista violated it here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493583">
				<div id="div-comment-493583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Loughran</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493583">
			April 16, 2007 at 4:05 pm</a>		</div>

		<p>Its really interesting to see people pushing back against this&#8230;usually developer&#8217;s who are doing use-once operations (like burning a DVD).</p>
<p>Here&#8217;s a problem. The future of the desktop is the laptop. These changes to Vista are an acknowlegement of this.</p>
<p>And when you undock a laptop, the system state changes. the external DVD burner? gone. the ethernet network? gone. This is going to happen to apps regardless of whether they get 2s, 5s or 0s warning. The fact you get 2s warning gives you enough chance to do some emergency actions -there&#8217;s nothing you can do to stop the laptop moving. Accept it.</p>
<p>-You can always notify users on wakeup that they shut down and their DVD is a coaster. This code is useful to have anyway, because laptop critical power suspends never came with any warning.</p>
<p>-there is that API call to tell the OS that a thread is busy. If you call it (and remember to keep calling it), the OS wont suspend due to perceived idleness</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493593">
				<div id="div-comment-493593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493593">
			April 16, 2007 at 4:25 pm</a>		</div>

		<p>Why didn&#8217;t the Windows team provide a user interface that automatically displayed to the user which application(s) were refusing to shut down and then allowed the user to decide when to kill them?</p>
<p>Good software is like a good employee. It puts the needs of the person it serves front and center. Arbitrarily killing a process after 2 seconds is a very lame solution. As a user, I don&#8217;t feel that this is really any better than the status quo.</p>
<p>I am really disappointed at the lack of imagination displayed here. Stop thinking like attorneys and politicians and start thinking like engineers again.</p>
<div class=post>[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493603">
				<div id="div-comment-493603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Idon&#039;tgetit' rel='external nofollow' class='url'>ChrisMcB</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493603">
			April 16, 2007 at 4:42 pm</a>		</div>

		<p>I don&#8217;t get it&#8230;. The USER (you know, the one calling the shots, the one that owns the device, the one running the software) tells Vista to go to sleep. And some of you are complaining that Vista actually goes to sleep? That it does what the user wants, and not what some random program manager wanted?</p>
<p>I don&#8217;t think anyone is going to say Vista is a bad OS because it went to sleep when the user told it to go to sleep.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493613">
				<div id="div-comment-493613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">C Gomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493613">
			April 16, 2007 at 4:46 pm</a>		</div>

		<p>Thanks for the note. &nbsp;Since a lot of developers read your blog, they know about something they may not have happened upon and know where to go for more information.</p>
<p>I&#8217;m sure you don&#8217;t like the idea of being an information hub, but sometimes on this noisy network we call the Internet&#8230; well you know&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493623">
				<div id="div-comment-493623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">C Gomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493623">
			April 16, 2007 at 4:49 pm</a>		</div>

		<p>At the risk of admonishing the same way Raymond once admonished me:</p>
<p>&quot;Why didn&#8217;t the Windows team provide a user interface that automatically displayed to the user which application(s) were refusing to shut down and then allowed the user to decide when to kill them?&quot;</p>
<p>But I don&#8217;t want to see an interface. &nbsp;I want the computer to go to sleep.</p>
<p>Better yet, I want to close the laptop and it just goes to sleep automatically. &nbsp;And I don&#8217;t care if the term is sleep or hibernate or innoculate or gyrate. &nbsp;I just want to open the laptop later and go back to work.</p>
<p>Being a new owner of a laptop with Vista, I can appreciate something like this. &nbsp;I have done it several times already.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493633">
				<div id="div-comment-493633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dhiren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493633">
			April 16, 2007 at 4:54 pm</a>		</div>

		<p>&quot;Why didn&#8217;t the Windows team provide a user interface that automatically displayed to the user which application(s) were refusing to shut down and then allowed the user to decide when to kill them?&quot;</p>
<p>Because in the power settings, when windows asks &#8216;what would you like the computer to do when you close the lid&#8217; I&#8217;ve set my notebook to &#8216;hibernate&#8217;.</p>
<p>Now, if I&#8217;ve closed the lid of my notebook, of what use is a confirmation user interface that allows me to decide when to kill apps that dont want to hibernate? &nbsp;The lid is already closed. Closing the lid prompted the hibernation/sleep/shutdown even in the first place. &nbsp;User confirmation is completely pointless. &nbsp;</p>
<p>Obligatory car analogy: if your car refused to switch off after you turned the key to the &#8216;off&#8217; position just because the radio was still playing, you wouldn&#8217;t be impressed at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493653">
				<div id="div-comment-493653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493653">
			April 16, 2007 at 5:00 pm</a>		</div>

		<p>For the people who are saying &quot;How could Visa do this to us!&quot;, I say &quot;How could you do that to the user&quot;.</p>
<p>It&#8217;s their machine, not yours. Sure, if it goes into sleep it might turn the DVD they are burning into a coaster &#8211; but that&#8217;s their choice. They shouldn&#8217;t have to justify their actions. Maybe some DVDs get toasted, and maybe the user will learn to better plan when they hibernate.</p>
<p>Now if only they could translate this concept over to shutdown &#8211; though you&#8217;d probably want to introduce some standard behaviour for saving drafts etc (for unsaved documents).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493663">
				<div id="div-comment-493663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493663">
			April 16, 2007 at 5:01 pm</a>		</div>

		<p>&quot;Stop thinking like attorneys and politicians and start thinking like engineers again.&quot;</p>
<p>Could you elaborate on how ignoring veto requests is a solution that an attorney or politician would come up with, but not an engineer?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493323">
				<div id="div-comment-493323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493323">
			April 16, 2007 at 10:35 am</a>		</div>

		<p>Two seconds? Do you happen to know if that&#8217;s per-process, or for the whole system?</p>
<p>Say you&#8217;ve got a system with a lot of programs on it, some of which have been idle for a while. Then the user hits &#8220;standby&#8221;.</p>
<p>Now, all these programs wake up *at the same time* and run their<br />
&#8220;computer is going into standby&#8221; code. This program probably hasn&#8217;t<br />
been run before since the program was started, so it has to be paged in<br />
from the exe on disk for each program. Lots of reads going on.</p>
<p>Meanwhile, each program, as it gets to run its &#8220;going to standby&#8221;<br />
code starts accessing its state, which needs to get swapped in from the<br />
pagefile, and writing it out to disk, causing cueing a bunch of writes.<br />
As the computer&#8217;s going into standby, you probably want to make sure<br />
the state&#8217;s written, so throw in a couple of sync()s as well.</p>
<p>Multiply this by 20-odd processes (conservative guess?) and your<br />
disk starts thrashing wildly as all these processes tries to get even a<br />
small amount done in the *same* 2-second window.</p>
<p>2 seconds just doesn&#8217;t sound like a lot to me, given how long it can<br />
take windows to redraw the screen sometimes when you unlock it having<br />
been away for a while. I sometimes get a 2-3 second pause before<br />
everything&#8217;s up again in that sort of situation, and it&#8217;s &#8220;only&#8221; going<br />
to be issuing reads then, not writes.</p>
<div class="post">[<i>&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493673">
				<div id="div-comment-493673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493673">
			April 16, 2007 at 6:16 pm</a>		</div>

		<p>&#8212;-&quot;I don&#8217;t think anyone is going to say Vista is a bad OS because it went to sleep when the user told it to go to sleep.&quot;&#8212;&#8211;</p>
<p>But they want it to go to sleep without trashing their data and their hardware. Two seconds just seems too short a time. Even when nothing is stopping standby it still takes my computer around ten seconds to standby.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493433">
				<div id="div-comment-493433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493433">
			April 16, 2007 at 11:43 am</a>		</div>

		<p>James &gt; Well, I would ask the members of the mobile blog as Raymond suggests, but there&#8217;s no &#8220;contact us&#8221;/&#8221;suggestion box&#8221; for the blog, the &#8220;winmobl&#8221; user that posts to the blog has no other contact details (e.g. email), the blog&#8217;s not been posted to in about a year and a half leaving me to wonder if there&#8217;s anyone still there anyway, and for the posts that *do* exist, anonymous comments have been disabled, so I can&#8217;t ask a question if I want to! (And if I did register, I wouldn&#8217;t be surprised if comments were disabled on 18-month old posts &#8211; they&#8217;re disabled after what, 2 weeks(?) on Raymond&#8217;s blog.)</p>
<p>On top of that, the &#8220;wvdroadmap&#8221; article that Raymond links to has no information on the 2-second rule, and the &#8220;help file&#8221; that the page says it is a summary of is an executable that probably won&#8217;t run very well on my Linux/PPC system.</p>
<p>So, I though I&#8217;d ask if he &#8220;happened to know&#8221; a bit more on that particular policy. I didn&#8217;t ask him to go and find out (or write a white paper :), just if he happened to know a bit more about something he&#8217;d already looked into enough to at least post about.</p>
<p>*shrug*</p>
<div class=post>[<i>I don&#8217;t happen to &#8220;know&#8221; anything. As I already noted, &#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; I have heard stuff, I have ideas, but I dare not express them because people will turn my guesses into fact. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493683">
				<div id="div-comment-493683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493683">
			April 16, 2007 at 7:15 pm</a>		</div>

		<p>The problem is&#8230; sometimes I didn&#8217;t ask it to sleep/hibernate (or even shutdown)&#8230; I mistakenly hit those new effing keys they put on new keyboards!</p>
<p>And if you are a keyboard designer, where do you put new keys? If you answered &quot;In a free zone&quot;, you are fired! You of course put them where used keys (like print screen or better, insert, delete etc.) were. You can even use the new keys as excuses to reorganize the whole right part of the keyboard.</p>
<p>The good news is that my 5 euros keyboard is almost correct, the insert-delete-home-end-etc block didn&#8217;t change shape, it just shifted 1-row below to accomodate for print-screen, scroll-lock &amp; co that were displaced by sleep, shutdown &amp; hibernate.</p>
<p>Other more expensive keyboards (even those 150 euros keyboards from MS) all do worse things like shrinking the &quot;0&quot; key on the keypad to accomodate the right arrow, having a shutdown key in place of the escape key, having a right shift and/or return key of funny size, or a &nbsp;half-width backspace to make you type a letter instead of erasing one (good trick since you are already annoyed by the mistake you are trying to remove)</p>
<p>This new keyboards are almost as annoying as the terminal settings in unix/linux.</p>
<p>Sorry Raymond, I needed to vent a little bit&#8230;</p>
<p>To be a little on topic, my hope is that somewhere in the future I will be able to choose when to do a forced sleep (like when I close a laptop lid or hit the power button on the case) and a more mistake-friendly sleep request that i can cancel (when I hit those too powerful new keys)</p>
<p>Or maybe just disable those keys.. THAT would be good.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493693">
				<div id="div-comment-493693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493693">
			April 16, 2007 at 7:17 pm</a>		</div>

		<p>Next step: When the user says &quot;safely remove hardware&quot;, you unmount it without complain. Windows doesn&#8217;t block CD/DVD drives from ejection, why should it block removable drives? Besides the user is going to unplug it anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493473">
				<div id="div-comment-493473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493473">
			April 16, 2007 at 1:08 pm</a>		</div>

		<p>I can&#8217;t help wondering that if an app has been swapped out due to being idle, what exactly is it that it *must* do when a standby event occurs? &nbsp;(Bearing in mind the battery could die at any point anyway, of course.)</p>
<p>2 seconds seems reasonable to me. &nbsp;My experience of standby etc on laptops has so far largely been a case of &quot;Would you just shut the hell down already?&quot;</p>
<p>I remember watching the C9 video about this topic when one of the Vista devs said that when a program says it wants to veto the standby, then Vista just says &quot;Hmm. Interesting. &nbsp;Not gonna happen.&quot; &nbsp;</p>
<p>I think I may have punched the air at the time :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493723">
				<div id="div-comment-493723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493723">
			April 16, 2007 at 8:16 pm</a>		</div>

		<blockquote><p>
  Next step: When the user says &quot;safely remove hardware&quot;, you unmount it without complain. Windows doesn&#8217;t block CD/DVD drives from ejection, why should it block removable drives? Besides the user is going to unplug it anyway.
</p></blockquote>
<p>Because the filesystem doesn&#8217;t always have the HD in a perfectly synchronized state. What I&#8217;d prefer is a way to signal that I want to unmount a HD as part of the hardware &#8211; turn a knob, watch the light go from red to green, and pull the HD out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493743">
				<div id="div-comment-493743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493743">
			April 16, 2007 at 8:51 pm</a>		</div>

		<p>Rob, I agree published API should not break. But that is the price of vendors taking too many liberties and not playing &quot;nice.&quot;</p>
<p>IMO, it is also the price of not knowing who&#8217;s at fault, or at least who contributed to the problem. And as Raymond has pointed out, Vista is helping by logging far more info about PnP, pwr management, etc.</p>
<p>Just yesterday I tried to Remove a USB disk. Vista gave me the usual line that it couldn&#8217;t. (I tried many times) The Event Log says &quot;process ID 4 (System)&quot; prevented the removal. It also told me some other things too, which I took care of.</p>
<p>I&#8217;m glad Vista is giving that info now. Still not happy that System sometimes won&#8217;t let go of idle disks, but that&#8217;s another problem.</p>
<p>Somebody should write a Sidebar gadget to show those event log msgs when pwr mgt or HW removal is denied. :=)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-493753">
				<div id="div-comment-493753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493753">
			April 16, 2007 at 8:51 pm</a>		</div>

		<p>My guess is that 2 seconds is wall time, and while it may be per-process, every process is sent the notification at the same time.</p>
<p>To me, that sounds perfectly reasonable. Simply because 99% of apps would IGNORE THE NOTIFICATION. That is, 99% of apps don&#8217;t need to know when you&#8217;re going into standby or hibernate. The only apps that I can think of that would need to know are the ones people are complaining about here: cd-burning, ipod-transferring, etc. Basically anything that interacts directly with external devices.</p>
<p>But how many instances of iTunes do you run at the same time?</p>
<p>The fact is, for 99% of applications, they won&#8217;t even NOTICE that you just went into/came out of standby.</p>
<p>I do agree with &quot;A&quot; as well. The next logical step is to make &quot;safely remove hardware&quot; work all the time, even if someone has a handle to a file on the device open. Basically, Windows just has to flush its own buffers, and thats it. Give the app 2 seconds (like standby) to finish up with the handle, and let me take the device out. Otherwise, I&#8217;m just going to yank the device out anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493503">
				<div id="div-comment-493503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493503">
			April 16, 2007 at 2:05 pm</a>		</div>

		<p>&quot;What do you do if your app is burning a CD or worse transferring to a device and the conputer wants to shutdown? &nbsp;You could end up destroying al the meta data on an ipod type device. Have these problems been considered?&quot;</p>
<p>Rob, have you considered what would happen if the computer BSOD? Or the absent-minded user unplugs their ipod because they *think* the transfer is done.</p>
<p>At least with normal power mgt, you get a notification and a chance to &quot;cleanup.&quot; No such luck with those other unexpected scenarios.</p>
<p>A properly designed app could withstand the unexpected. For example, with metadata journaling, the app won&#8217;t &quot;end up destroying al the meta data&quot; &nbsp;You might lose the song that was being transfered but it should never trash the entire device.</p>
<p>(I know there&#8217;s no such option with CD burning. Those are the breaks, oh well.)</p>
<p>A blanket &quot;veto suspend&quot; seems like a big kludge to compensate for fragile designs. It&#8217;s a kludge at the expense of a good user experience and of other apps &#8211; remember, *your* app isn&#8217;t the only thing a real user does.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493763">
				<div id="div-comment-493763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493763">
			April 16, 2007 at 9:45 pm</a>		</div>

		<p>&gt; programs that do take the effort to care</p>
<p>&gt; about power management often do it rudely,</p>
<p>&gt; hijacking your computer and preventing you</p>
<p>&gt; from going into standby or hibernation</p>
<p>Even though it has become obvious to long-term readers that you know how many bonuses your colleagues got for rude misfeatures like this, it still would help if you add something like &#8220;Yes my employer is included&#8221;. &nbsp;When you don&#8217;t say that, your complaints still look hypocritical. &nbsp;This is from the viewpoint of someone who waited for Windows Update to download around 60 critical updates, who then stupidly wanted to hibernate the machine and take it away and let the updates install later. &nbsp;Silly me. &nbsp;It would have been better to leave it without the critical updates, eh?</p>
<p>By the way, does anyone know why the redesigned power management documentation is country-specific? &nbsp;(And by the way there are some engineers even in Indonesia who are better at engineering than at English.)</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2006/07/13/664448.aspx" rel="nofollow">I already said it</a>. And you&#8217;re breaking the ground rule on not identifying programs by name. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-493773">
				<div id="div-comment-493773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493773">
			April 16, 2007 at 9:58 pm</a>		</div>

		<blockquote><p>
  Even though it has become obvious to long-term readers that you know</p>
<p>  how many bonuses your colleagues got for rude misfeatures like this,</p>
<p>  it still would help if you add something like &quot;Yes my employer is included&quot;
</p></blockquote>
<p>But you seem to be asking for the exact functionality that was disabled in Vista &#8212; that Windows Update to have been able to abort the hibernate until it finished. Better that the updates failed to install that the hibernate was cancelled (well, even better would have been that they were paused and you could resume where you left off&#8230;)</p>
<p>Is Windows Update able to handle yanking the network cable out gracefully? Apparently not if it can&#8217;t handle going to into hibernate&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493783">
				<div id="div-comment-493783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493783">
			April 16, 2007 at 10:06 pm</a>		</div>

		<p>@Brent Royal-Gordon</p>
<p>&quot;Somehow, I suspect Windows Update, Windows Installer, and Vista SP1 will still be able to cancel a suspend. &nbsp;And probably Office 2009 as well.&quot;</p>
<p>This is one of those cases where you should really try this out before typing. &nbsp;I just started an update I wouldn&#8217;t mind getting hosed (Korean language pack, I think) in case it didn&#8217;t work on Vista and triggered a suspend. Then for good measure I flipped the switch on the PSU. &nbsp;When I turned it back on, guess what? &nbsp;The update was still going where I left it. &nbsp;And WU didn&#8217;t block the suspend.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493813">
				<div id="div-comment-493813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493813">
			April 16, 2007 at 11:18 pm</a>		</div>

		<p>Forced poweroff sounds reasonable for me. Afterall, if the battery runs out, you get hard power down.</p>
<p>If you don&#8217;t want the accidentally stop in midway (like burning a disk), I guess you should always perform those task with your laptop power cord plugged.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493823">
				<div id="div-comment-493823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493823">
			April 16, 2007 at 11:56 pm</a>		</div>

		<p>Monday, April 16, 2007 9:58 PM by Dean Harding</p>
<p>? But you seem to be asking for the exact</p>
<p>? functionality that was disabled in Vista</p>
<p>Huh? &nbsp;I said I wanted to hibernate the computer and take it away, but the unnameable update program prevented going into hibernation.</p>
<p>? Is Windows Update able to handle yanking the</p>
<p>? network cable out gracefully?</p>
<p>Oddly enough, for about 98% of updates it does figure out not to repeat the download. &nbsp;But that was a non-issue in this case, because as stated, I had waited for the downloads to complete.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-493833">
				<div id="div-comment-493833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493833">
			April 17, 2007 at 12:35 am</a>		</div>

		<blockquote><p>
  Huh? &nbsp;I said I wanted to hibernate the computer and take it away,</p>
<p>  but the unnameable update program prevented going into hibernation.
</p></blockquote>
<p>Oh sorry, I thought you meant that Windows Update didn&#8217;t handle the hibernate properly; not that it had simply prevented it. Fair enough then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493843">
				<div id="div-comment-493843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bugvanquisher.spaces.live.com' rel='external nofollow' class='url'>Tanveer Badar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493843">
			April 17, 2007 at 2:08 am</a>		</div>

		<p>This is good for everyone in the long run. I have my UPS drained countless times because one rude game or many rude programs refused to let computer go to sleep in case of power failure, if I was away only for a couple of minutes.</p>
<p>Please stop chanting &quot;[&quot;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&quot; -Raymond]&quot; Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493703">
				<div id="div-comment-493703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Archangel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493703">
			April 16, 2007 at 7:41 pm</a>		</div>

		<p>Stephen: &quot;But they want it to go to sleep without trashing their data and their hardware. Two seconds just seems too short a time. Even when nothing is stopping standby it still takes my computer around ten seconds to standby.&quot;</p>
<p>I don&#8217;t have a copy of Windows (Vista or otherwise) on my laptop (a Dell, for reference) at the moment, so it&#8217;s a bit hard to compare exactly. But when I close the lid currently, it takes approximately two seconds to go to stand by. There&#8217;s a brief flash of disk activity (mostly doing a sync), then *bam*, it&#8217;s done. 10 seconds sounds more like a hibernate kind of timeline to me.</p>
<p>I&#8217;m sure lots of apps would like to do clever things when it suspends, but how many of them actually *need* to? I always saw the whole point of standby being that the machine goes to sleep, and at some later point wakes up with everything in exactly the same state it was before. Yeah, there are a few cases where programs might need to do something clever, but frankly it&#8217;s probably pretty rare compared to all the malfunctioning bits of crapware that just don&#8217;t respond to the message and cancel shutdown regardless.</p>
<p>And yeah, there will be things (like CD burning) where this could cause trouble, but any user who suspends halfway through burning a disc deserves to get a 50c coaster.</p>
<p>I think the Vista engineers have made a great choice here. A few weeks ago my XP box at work went through a phase where it childishly refused to shut down; no doubt one of these not-responding-to-message situations was occurring. Nice to think the newer version would have handled it better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493883">
				<div id="div-comment-493883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493883">
			April 17, 2007 at 3:18 am</a>		</div>

		<p>[quote user=&#8221;Tanveer Badar&#8221;]</p>
<p>Please stop chanting &#8220;[&#8220;I&#8217;m not the expert in this area; I&#8217;m just repeating what I&#8217;ve heard.&#8221; -Raymond]&#8221; Raymond.</p>
<p>[/quote]</p>
<p>Yup. It&#8217;d be better to just put the disclaimer at the article itself, as many people write comment without fully read others comment first. Raymond would in the end repeat many more times than necessary.</p>
<div class="post">[<i>The disclaimer <u>is</u> in the article itself. That&#8217;s why I put it in quotation marks. This just proves that nobody reads the article <u>or</u> the comments. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493893">
				<div id="div-comment-493893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Xavi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493893">
			April 17, 2007 at 4:33 am</a>		</div>

		<p>Interresting article Raymond.</p>
<p>Having the chance to chat to an power management expert, could you tell me if there are any changes in Windows Vista and power management?</p>
<p>(Hope you get the insinuation)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493793">
				<div id="div-comment-493793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493793">
			April 16, 2007 at 10:15 pm</a>		</div>

		<p>All of this sounds pretty reasonable, but still doesn&#8217;t fix the most annoying problem with windows&#8217; power management; the lack of any confirmation when the sleep or on/off buttons are pressed.</p>
<p>It seems that nobody at Microsoft has ever left their laptop on a chair and had a small child come up and press the big shiny button. Or accidentally pressed it themselves (it can be annoyingly close to other keys).</p>
<p>It&#8217;s even worse in no-veto Vista, where unless the app you are working with has an autorestore-type abilily, you *will* lose work.</p>
<p>Add to this that my laptop doesn&#8217;t wake up from sleep anymore in Vista (probably not MS&#8217;s fault, not blaming you) and things can get very annoying.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-493803">
				<div id="div-comment-493803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493803">
			April 16, 2007 at 10:29 pm</a>		</div>

		<p>&gt; It&#8217;s even worse in no-veto Vista, where unless the app you</p>
<p>&gt; are working with has an autorestore-type abilily, you *will* lose work.</p>
<p>That would only be the case if, when thebutton is pressed, the computer SHUTS DOWN. If it just goes into hibernate or sleep, then the application won&#8217;t even realise it just suspended/resumed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493903">
				<div id="div-comment-493903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://gnobal.net' rel='external nofollow' class='url'>Amit Schreiber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493903">
			April 17, 2007 at 6:00 am</a>		</div>

		<p>One other power management annoyance (in Windows XP) is that if a hard drive is shut down because you set a drive shutdown timeout, then when you shut down the computer that drive is woken up just to immediately be shut down again a few seconds later.</p>
<p>This is probably not Windows XP&#8217;s fault, and I have no idea what it&#8217;s like on Windows Vista, but I still wonder if it&#8217;s possible not to wake up the drive during computer shutdown.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493913">
				<div id="div-comment-493913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493913">
			April 17, 2007 at 6:05 am</a>		</div>

		<p>[The disclaimer is in the article itself. That&#8217;s why I put it in quotation marks. This just proves that nobody reads the article or the comments. -Raymond]</p>
<p>Oh, actually I mean have a seperate paragraph beginning with &#8220;Disclaimer:&#8230;&#8221;, just like what you done with &#8220;Nitpicker&#8217;s corner&#8221;.</p>
<p>Separate paragraph with heading makes it more &#8220;detectable&#8221;.</p>
<div class=post>[<i>Remember when blogs didn&#8217;t have to have &#8220;Nitpicker&#8217;s corner&#8221; and &#8220;Disclaimers&#8221;? I miss those days. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493923">
				<div id="div-comment-493923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493923">
			April 17, 2007 at 7:47 am</a>		</div>

		<p>We already have a user interface for when a program doesn&#8217;t want the computer to be shut down. And it typically obscures the dialog that the program has displayed to explain why. So much for a user interface for the sleep key.</p>
<p>I don&#8217;t actually suspend/sleep on lid close, because what I want to do is to carry the laptop from one room to another without losing my TCP connections (wireless LAN), and carrying the laptop with the lid open is too unwieldy.</p>
<p>In fact, several times I&#8217;ve opened someone&#8217;s laptop only to see it resume shutting down&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493943">
				<div id="div-comment-493943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nobody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493943">
			April 17, 2007 at 8:02 am</a>		</div>

		<blockquote><p>
  This just proves that nobody reads the</p>
<p>  article or the comments.
</p></blockquote>
<p>Finally! &nbsp;It&#8217;s about time I got some respect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493953">
				<div id="div-comment-493953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493953">
			April 17, 2007 at 8:04 am</a>		</div>

		<p>Once I was burning a music CD on my laptop, and accidentally hit the lip with my elbow and triggered standby. When I resumed, the CD continued burning, and came out fine (with a few skips though). This was XP and Nero 7.</p>
<p>Also, my wife regularly watches movies and streaming video on the laptop until it drains the battery. When I turn it back on, the show continues to run (until the buffer runs out, at least).</p>
<p>And I agree, when the lid is closed, I&#8217;m not going to look at some UI. I&#8217;m going to pull out whicever cords are connected (dock / power / network), and put the computer in my backpack. The worst effect a program can have is make the computer still run inside the backpack (happened once alreaday).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493963">
				<div id="div-comment-493963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thehungersite.com' rel='external nofollow' class='url'>AndyB</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493963">
			April 17, 2007 at 8:07 am</a>		</div>

		<p>All these comments from people pooping themselves that their app will be forced to shutdown when the user tells it to. lol.</p>
<p>If they&#8217;d read the linked blog to the expert, they&#8217;d have read this:</p>
<p>&quot;That said, we also want to give customers a fallback for critical pre-Windows Vista applications that break under the new model. They will be able to set a power option that restores the veto capability&quot;</p>
<p>I guess that it will be disabled by default, and the user will have to set it, but I have no doubt a poor app will set this tweak in the registry when installed. Life is not any better than before :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493983">
				<div id="div-comment-493983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493983">
			April 17, 2007 at 9:21 am</a>		</div>

		<p>&quot;Could you elaborate on how ignoring veto requests is a solution that an attorney or politician would come up with, but not an engineer?&quot;</p>
<p>Imagine that there had been no science and engineering during the past 100 years. The Wright brothers first flew in 1903. Without engineers, there would be no air transportation. Penicillion was discovered in the 1940&#8217;s. Without scientists, we would have no antibiotics.</p>
<p>Attorneys and politicians would have spent the past 100 years looking for ways to restribute wealth. But the quality of life would not have improved much. Improving life for others takes imagination. This power management thing smells like a legalistic solution because nothing new has been imagined. They simply changed who gets the final say.</p>
<p>Others had given circumstances in which a user might trigger a hibernation unintentionally or without fully realizing the consequences. Smart people who are busy sometimes make mistakes.</p>
<p>How about giving an audible alert if the laptop is closed and something doesn&#8217;t want to shut down?</p>
<p>The &quot;selfish programs&quot; comment by Raymond really irked me. What if your software makes Automation requests of Office or other programs? Do all Microsoft products that provide Automation interfaces honor hibernation requests while servicing an Automation request? How fast do they respond? How can anybody predict what will happen if their single-threaded app is waiting on an Automation server to complete a request? Does every such application now need to be multithreaded?</p>
<p>Being &quot;not selfish&quot; is not as easy as it might seem. The devil is in the details. Raymond shouldn&#8217;t assume that people are &quot;selfish&quot; just because they don&#8217;t meet this particular requirement. Providing excellent software for customers requires balancing thousands of issues.</p>
<p>Case in point: Install Word 2003 and Word 2007 on teh same syatem. Open a document in Word 2007. Then open a document in Word 2003. Now reopen the first document in Word 2007 again. Word 2007 detects that Word 2003 has messed with some of its registry keys and launches a self-repair operation which literally takes more than a minute and uses all available CPU.</p>
<p>Selfish indeed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493993">
				<div id="div-comment-493993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">C Gomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493993">
			April 17, 2007 at 10:35 am</a>		</div>

		<p>We got it all in these comments. &nbsp;A plainly worded informative article that nobody bothered to read until the end, and worthless complaints from Mr. Diamond that added nothing to the discourse.</p>
<p>I&#8217;m glad my Windows systems never have the same problems his does. &nbsp;I extensively used my laptop last night, and it just went into some form of sleeping when I closed the lid. &nbsp;Then it just woke up when I opened it. &nbsp;I also had a USB drive in with ReadyBoost on when I was working, but my girlfriend took it out, then opened the lid and switched users.</p>
<p>Everything just worked. &lt;shrug&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-494063">
				<div id="div-comment-494063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-494063">
			April 17, 2007 at 11:21 am</a>		</div>

		<p>Seems an awful lot of aversion to what is a great step forward&#8230;</p>
<p>On my laptop via the power options I can configure what I want to do based on closing the lid, pressing the sleep button or pressing the power button &#8211; both the button choices are set to ask me what to do, Closing the lid hibernates (I rarely close the lid by accident but often catch the poorly positioned sleep button) &#8211; if I do close the lid when burning a CD / DVD I only have myself to blame if something goes wrong with the process. Even so a duff CD / DVD it is still a better situation than getting home after a 40 minute train journey to find the laptop still on and slowly cooking itself to death.</p>
<p>People also seem to be complaining about applications that are communicating in some way (automation being one example) &#8211; if the applications are on the same PC then they get hibernated together, they wake up together and they are ignorant of what has happened due to the actual process being transparent to them, for the majority of applications the need to even be aware that the PC has been to sleep / hibernated is a non-issue. If the applications were on different machines then it is probably going to fail regardless as I&#8217;m probably taking the laptop to a different location anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493933">
				<div id="div-comment-493933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-493933">
			April 17, 2007 at 7:58 am</a>		</div>

		<p>DriverDude, Steve, ChrisMcB, </p>
<p>Yes, apps should deal with files/devices just &quot;going away&quot; underneath them as best they can, and shouldn&#8217;t have to actually do anything w.r.t. a suspend/resume; it should be totally transparent to them.</p>
<p>*But* &#8211; if MSDN says that your app gets 2 seconds to deal with a standby notification event, but it&#8217;s possible for the kernel to not give you *any* CPU time during that 2 seconds due to it servicing the requests of other apps that are, what&#8217;s the point in the 2-second wait?</p>
<p>Why not just say that you do get a notification of the power change, but not guarantee when &#8211; you might not get the notification (or at least not be able to process the notification, which is effectively the same thing as far as the process is concerned) until after the computer has already resumed.</p>
<p>It&#8217;s not the actual standby behaviour I&#8217;m that concerned about, I&#8217;m sure the MS engineers can make good decisions on what behaviour is appropriate. It&#8217;s how it&#8217;s being documented and presented to developers that concerns me. Don&#8217;t guarantee me something and then fail to deliver. Don&#8217;t tell me I have 2 seconds to respond to something if I don&#8217;t. If you tell me I can&#8217;t do anything on a standby notification, and that I might only get to process it after the computer has resumed, I can work with that. That&#8217;s fine. Just so long as I know what could happen.</p>
<p>How you are expected to write one of these bulletproof never-lose-any-data apps without knowing what behaviour you&#8217;re going to get from the OS when unusual things do happen is beyond me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-494253">
				<div id="div-comment-494253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-494253">
			April 17, 2007 at 1:38 pm</a>		</div>

		<p>&quot;That said, we also want to give customers a fallback for critical pre-Windows Vista applications that break under the new model. They will be able to set a power option that restores the veto capability&quot;</p>
<p>That was the one part that worried me &#8211; I rather hope that we can safely assume there is no programmatic way to enable that. I think they WOULD make it so there was no easy hack for it, because otherwise that would break the whole point of &quot;taking the ball away&quot;&#8230; time will tell on that score I guess. What will count isn&#8217;t whether there are hacks &#8211; it&#8217;s whether they get patched fairly quickly once they get discovered.</p>
<p>However there are other ways that bad programs might be able to get around it, which are *legal* &#8211; &quot;We can’t enable the “idle to sleep” feature on desktop PCs without a reliable mechanism for waking them back up based on scheduled tasks or network activity.&quot;</p>
<p>So, possibly can programatically schedule wakeup tasks to run every second. </p>
<p>My hope though, is that there is a big differentiating line between &quot;system-driven idle to sleep&quot; and &quot;user-driven close the lid to sleep&quot;. I seem to remember in earlier discussions that they planned to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-494703">
				<div id="div-comment-494703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-494703">
			April 18, 2007 at 6:56 am</a>		</div>

		<p>Tuesday, April 17, 2007 10:35 AM by C Gomez</p>
<blockquote><p>
  I&#8217;m glad my Windows systems never have the</p>
<p>  same problems his does.
</p></blockquote>
<p>s/does/do/</p>
<p>I&#8217;m glad for you too. &nbsp;(This isn&#8217;t sarcasm. &nbsp;I wish I knew what makes the difference and I would gladly copy it.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-494813">
				<div id="div-comment-494813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-494813">
			April 18, 2007 at 10:49 am</a>		</div>

		<p>Wow. &nbsp;As soon as I posted here, I saw that &quot;Leave a Comment&quot; on that other blog suddenly appeared for the September 2005 entry. &nbsp;There was no such button yesterday!</p>
<p>I still predict that the blog is defunct. &nbsp;We&#8217;ll see!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-494793">
				<div id="div-comment-494793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-494793">
			April 18, 2007 at 10:46 am</a>		</div>

		<p>Raymond says &quot;If you have questions about the future of power management, you probably should ask the power management folks over on the Windows Mobile PC Team Blog.&quot;</p>
<p>That blog is defunct. &nbsp;There are a total of 7 posts in its entire lifetime, and none are after November 2005.</p>
<p>Furthermore, there is *no way* to contact those folks (as far as I can tell). </p>
<p>It&#8217;s great when you give us other resources &#8212; since some of us realize that you&#8217;e not the expert on everything &#8212; but in this case, that resource doesn&#8217;t really exist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-495543">
				<div id="div-comment-495543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://modsbylaz.planetdiablo.gamespy.com' rel='external nofollow' class='url'>Brother Laz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-495543">
			April 20, 2007 at 2:57 pm</a>		</div>

		<p>I spent 30 minutes today trying to find out how to change the gd* shutdown button so it actually SHUTS DOWN instead of falling asleep and crashing into a telephone pole. Without Google, I&#8217;d still be looking.</p>
<p>For those of you who don&#8217;t have Vista: where would you look for an option to change the effect of a shutdown button on the start menu?</p>
<ul>
<li>Right-clicking on the button;</li>
<li>
<p>Taskbar properties;</p>
</li>
<li>
<p>User account settings?</p>
</li>
<li>
<p>Hell, folder options??</p>
</li>
</ul>
<p>Wrong. The correct option, as the Windows User Experience team decided, is the Advanced button on the Power Management control panel.</p>
<p>I&#8217;m not bitter.</p>
<p>By the way, I&#8217;d gladly use the default sleep option if it didn&#8217;t cause Vista to hang on a black screen. But that&#8217;s to be expected; this computer is well over four weeks old.</p>
<p>Sorry, I&#8217;m just ranting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-495773">
				<div id="div-comment-495773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-495773">
			April 21, 2007 at 9:19 pm</a>		</div>

		<p>Blah, blah, blah&#8230;</p>
<p>How about this:</p>
<p>You work on your new fantastic 3D model in Poser 7, highly detailed geometry and tons of textures, and your scene is so complex that the scene file is ~300MB in size. Then you accidentally hit Suspend on a keyboard. And bang, in two seconds your computer is in S3 state.</p>
<p>You say &quot;Damn, good thing that S3 Suspend/Resume works reliably in Vista&quot; and reach for power button to bring it back on. And you get black screen because you have NVIDIA 8800 GTX/GTS video card and older drivers with broken power management. Or your video works fine but your mouse and keyboard don&#8217;t, so you are stuck without a chance to save your work.</p>
<p>Another version would be &#8212; you accidentally hit Shutdown and since 2 seconds are not enough to save 300MB yet even on fastest desktop drives you again lose your work but this time completely since the original file is partially overwritten and corrupted beyond repair.</p>
<p>I agree that applications should not have a veto on power management because they are usually not as well informed as the OS itself of the current power situation. But, IMO it would be much better to allow user to grant a vetoing right to certain apps he values more than a dead battery.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-495823">
				<div id="div-comment-495823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-495823">
			April 22, 2007 at 11:34 pm</a>		</div>

		<p>We really need two things:</p>
<p>(1) Options to disable whatever the Suspend key or Shutdown key is, or maybe options to ask for confirmation when they&#8217;re pressed. &nbsp;Disabling would be similar to the way some gamers disable some of the keys near Ctrl and Alt.</p>
<p>(2) Options to ask for confirmation when a shutdown option is selected. &nbsp;Hibernation and Shutdown are so far away from each other in that menu, there&#8217;s no way that anyone other than me would slip while mousing, but still&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-496223">
				<div id="div-comment-496223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.robertmoir.com' rel='external nofollow' class='url'>Robert Moir</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-496223">
			April 24, 2007 at 5:35 am</a>		</div>

		<p>You know what&#8217;s funny? After all the hysterical comments in previous blog articles here about how Microsoft need to respect the end user more and just do what the end user asks them to instead of trying to be clever, they finally deliver some code that does that exactly and get flamed for, erm, respecting the end user more by doing what they ask.</p>
<p>You can&#8217;t win.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-549233">
				<div id="div-comment-549233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.nynaeve.net/?p=160' rel='external nofollow' class='url'>Nynaeve &raquo; Blog Archive &raquo; Never, ever, EVER wake a computer from suspend without user consent</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070416-00/?p=27243#comment-549233">
			September 13, 2007 at 11:46 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.nynaeve.net/?p=160" rel="nofollow">http://www.nynaeve.net/?p=160</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>