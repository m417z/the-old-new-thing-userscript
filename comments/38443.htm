<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (58)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-194723">
				<div id="div-comment-194723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johan Johansson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194723">
			July 14, 2004 at 7:12 am</a>		</div>

		<p>I really wish more applications would work correctly with e.g. 120 dpi. I&#8217;m quite tired of not being able to access the bottom right edges of dialogs, where the ok and cancel buttons are commonly placed among other things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194733">
				<div id="div-comment-194733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zero-one-zero.com/vs' rel='external nofollow' class='url'>Jonathan Payne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194733">
			July 14, 2004 at 7:15 am</a>		</div>

		<p>Will Longhorn have better support for high DPI devices?  At the moment, people with high DPI monitors have to decide between applications looking odd or everything displaying far too small.  In an ideal world there would be no link at all between DPI and the size of items on the screen (DPI should only affect display quality).</p>
<p>Perhaps Microsoft should buy all of their developers 300 DPI screens to encourage them to improve this area.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194743">
				<div id="div-comment-194743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194743">
			July 14, 2004 at 8:50 am</a>		</div>

		<p>Certain visual development tools such as Delphi make it very easy to design UI based on pixels, and when the tester sets Large fonts, chaos ensues.</p>
<p>I guess dialog units were supposed to solve this problem. On the other hand, CreateWindow[Ex] seems to accept pixels for x/y/cx/cy. Oh well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194753">
				<div id="div-comment-194753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194753">
			July 14, 2004 at 8:59 am</a>		</div>

		<p>CreateWindow(Ex) isn&#8217;t psychic. It doesn&#8217;t know which dialog box you wanted your DLUs to be relative to.  MapDialogRect, on the other hand, specifies a dialog box relative to which you want the DLUs converted to pixels.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194763">
				<div id="div-comment-194763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://chuacw.hn.org/chuacw/' rel='external nofollow' class='url'>Delphi Developers' Asia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194763">
			July 14, 2004 at 9:09 am</a>		</div>

		<p>Delphi allows one to design UI based on pixels, but it also allows one to scale the UI based on the DPI.</p>
<p>If Delphi is so bad, why would Microsoft hire Anders? Precisely because Microsoft lust after the technology that Anders has created while under Borland&#8217;s employment.</p>
<p>In case anyone doesn&#8217;t know, Anders was the chief architect of Turbo Pascal, Delphi 1-3(or 2?). Now he&#8217;s the chief architect of C#, and CLR.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194773">
				<div id="div-comment-194773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dcc.ufrj.br/~cesarb/' rel='external nofollow' class='url'>Cesar Eduardo Barros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194773">
			July 14, 2004 at 9:39 am</a>		</div>

		<p>Every time I tell people I use a 1600&#215;1200 resolution, they ask things like &quot;how can you read things in such a high resolution&quot; or &quot;isn&#8217;t the text too small&quot; and I always say &quot;I use 132DPI, the font size is the same&quot; (Mozilla is the only oddball which configures default font sizes in pixels, forcing me to do the calculations by hand; however its UI respects the DPI settings).</p>
<p>This because people use low resolutions because they want larger fonts (and most people who tries to use Large Fonts or other nonstandard DPI settings knows it doesn&#8217;t work. It works here only because I&#8217;m using X11, not Windows. Of course Windows itself would display fine, but other programs would display all broken.)</p>
<p>Worse than that is people who specify font sizes in pixels on webpages, which almost always is way too small (I had to set the minimum font size to 7pt on Mozilla to make pages like that at least readable).</p>
<p>I&#8217;ve already found a Windows program that detects when you are using a &quot;nonstandard&quot; DPI, and shows a dialog box warning it won&#8217;t work correctly and asking me to change it back. It was made in Delphi, of course, and there was no way to avoid using it (it&#8217;s the Brazilian income tax report program, IRPF). At least next year the Java version will be ready (and I really hope it doesn&#8217;t get confused by exotic DPI settings).</p>
<p>I second the proposal to autodetect the DPI on Longhorn; this will make it common for developers to have odd DPI settings (thus forcing them to design things properly). If you don&#8217;t want to break things, you can fake a fixed 96DPI to older apps (another appcompat thing?). I believe X11 toolkits don&#8217;t have this problem exactly because both 75DPI and 100DPI were common in the past (nowadays it&#8217;s more common to autodetect).</p>
<p>I also think the font size and the DPI should be separated; you should be able to change the default UI font size without changing the DPI (so Bitstream Vera Sans 12 is the right size even if I want to reduce the default font size to get more free screen area).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194783">
				<div id="div-comment-194783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194783">
			July 14, 2004 at 9:47 am</a>		</div>

		<p>The big compatibility hit with secretly changing the DPI setting is with existing users. You install Longhorn and &quot;Hey, all my screen elements are the wrong size! Stupid Longhorn screwed up my settings. Microsoft programmers are morons.&quot;</p>
<p>Not saying it can&#8217;t be done. Just that it may cause more problems than it solves.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194793">
				<div id="div-comment-194793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vlad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194793">
			July 14, 2004 at 9:49 am</a>		</div>

		<blockquote><p>
  &gt; If Delphi is so bad<br />
  <br />It&#8217;s not a Delphi so bad &#8211; it&#8217;s just a programmers dont care about DPI.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194813">
				<div id="div-comment-194813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194813">
			July 14, 2004 at 10:03 am</a>		</div>

		<blockquote><p>
  Stupid Longhorn screwed up my settings. Microsoft programmers are morons.</p>
<p>Way to personalize everything. The users will bitch no matter what, so do what is <em>correct</em>. This means stuff like making DPI-agnostic coding easy and evangelizing it to the masses.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194823">
				<div id="div-comment-194823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194823">
			July 14, 2004 at 10:12 am</a>		</div>

		<blockquote><p>
  &gt;The problem with DPI on Windows is that it is introduced incorrectly. There should be no Small Fonts and Large Fonts setting because DPI has nothing to do with fonts. In fact, if DPI is set correctly, there should be no difference in apparent size of a font between 640&#215;480 and 1600&#215;1200 because a point (the measuring unit for fonts) is relative to an inch.</p>
<p>Well actually thats the whole point of the trick. The obvious mapping is, there are 72 points in an (virtual) inch, and the display device has some number of dots per virtual inch.</p>
<p>By changing the dots per inch setting, without chaning the physical resolution, the points per dot ratio changes.</p>
<p>In this way, the &quot;Big Fonts&quot; setting is actually entirely correct in its (intended) behaviour as it applies a zoom factor to the entire UI (the entire UI that bothers to MapDialogRect that is).
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194833">
				<div id="div-comment-194833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194833">
			July 14, 2004 at 10:27 am</a>		</div>

		<p>&quot;making DPI-agnostic coding easy and evangelizing it to the masses&quot;.  Already done. It&#8217;s call WinFX. But people complain anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194853">
				<div id="div-comment-194853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://perlmonks.org/?node=theorbtwo' rel='external nofollow' class='url'>James Mastros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194853">
			July 14, 2004 at 10:50 am</a>		</div>

		<p>Note that non-square-pixel modes will becomme more popular, with widescreen laptops.  They seem to do something silly, though, because if you put them in a mode which has an aspect ratio that doesn&#8217;t match the physical aspect ratio of the screen, even the icons don&#8217;t look right, meaning that the video driver doesn&#8217;t agree with the monitor at a pretty basic level, AFAICS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194863">
				<div id="div-comment-194863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194863">
			July 14, 2004 at 10:52 am</a>		</div>

		<p>The only solution is the &quot;Big Stick&quot;: all development environments should change their DPI settings every hour.  All new programs will be written correctly (because their failures will be obvious very quickly), and over time everything will turn out OK.</p>
<p>Randomly switching to different date and digit formats would work a treat, too, as would switching between 32 and 64 bit pointers.</p>
<p>Peter</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194873">
				<div id="div-comment-194873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Merle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194873">
			July 14, 2004 at 10:56 am</a>		</div>

		<p>Is there any way to detect large fonts from inside IE?</p>
<p>That&#8217;s one of the biggest problems I have.  (then again, I&#8217;ve been in the web dev world for many years now)  Users complain about text &quot;disappearing&quot; when really it&#8217;s just off the screen&#8230; or clipped by an absolute size [iframe] where the silly developers hardcoded pixels.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194883">
				<div id="div-comment-194883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Weekes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194883">
			July 14, 2004 at 10:57 am</a>		</div>

		<p>I&#8217;m actually quite surprised to hear that Windows has separate values for horizontal and vertical resolution, since I had assumed the settings available to software would affect the settings available to the user.</p>
<p>Windows only lets me set horizontal DPI (using the on-screen ruler) and assumes square pixels. How do I tell Windows that I have non-square pixels?</p>
<p>Auto-detecting optimal screen dimensions and resolution is easy for a plug-and-play TFT monitor, but how do you work it out for a CRT monitor? The little buttons on my CRT monitor allow me to distort the picture in all sorts of fun ways, and by default it was a little smaller than the visible screen area, probably just to be safe because they knew users wouldn&#8217;t like it if they had to reconfigure it to get part of the display onscreen if it shifts a little. I have it configured to fill the screen, but by default there would be a higher DPI setting because there are less physical inches in the displayed picture.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194893">
				<div id="div-comment-194893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Maas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194893">
			July 14, 2004 at 10:58 am</a>		</div>

		<p>Displaying GUIs legibly at high resolution is such a problem that Apple brags about the low pixel density of its LCD displays as a &quot;feature&quot;!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194903">
				<div id="div-comment-194903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dcc.ufrj.br/~cesarb/' rel='external nofollow' class='url'>Cesar Eduardo Barros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194903">
			July 14, 2004 at 11:06 am</a>		</div>

		<p>Raymond, that&#8217;s why I said you should do it only for new applications. Let the old broken ones stay with 96DPI, and use the real dpi setting for the new ones (since you said WinFX will work fine, make it use the correct DPI by default).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194923">
				<div id="div-comment-194923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194923">
			July 14, 2004 at 11:49 am</a>		</div>

		<blockquote><p>
  Delphi allows one to design UI based on pixels, but it also allows one to scale the UI based on the DPI.</p>
<p>And Delphi gets it wrong. Scaling of dialogs should be based on the <em>font size</em>, not the DPI. If you go by DPI, you are assuming that the font size scales proportionally to the DPI. This is not the case with Large Fonts, where the average character width of MS Sans Serif is <em>more</em> than 125% that of Small Fonts. Hence, scaling based on DPI as Delphi does often results in clipped text when running in Large Fonts.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194933">
				<div id="div-comment-194933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bigbeardy.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194933">
			July 14, 2004 at 12:16 pm</a>		</div>

		<p>It would be nice if you could set the H/V DPI settings individually.  On occasion I connect my PC up to my widescreen TV, and everything goes all short and fat as the pixels are nothing like square any more&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194943">
				<div id="div-comment-194943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194943">
			July 14, 2004 at 12:21 pm</a>		</div>

		<p>Does the widescreen TV really have non-square pixels, or it just has different aspect ratio? I think if you set your mode to something like 1600&#215;900 you&#8217;ll get the correct image with the same H and V DPI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194953">
				<div id="div-comment-194953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194953">
			July 14, 2004 at 12:32 pm</a>		</div>

		<p>What is the recommended way to handle high DPI regarding visual elements? For example, should the 3D (or 2D) borders for controls be twice as wide on 192DPI? What about window splitters, toolbar grippers, etc?</p>
<p>Will the user be able to switch the DPI without rebooting in Longhorn? in XP and 2000 it requires reboot, so I can do all my DPI calculations on startup.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194973">
				<div id="div-comment-194973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Weekes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194973">
			July 14, 2004 at 1:11 pm</a>		</div>

		<p>I&#8217;ve also had a similar problem to Mat Hall before. The problem is that the graphics hardware only did output to TV as an afterthought so it only supported (at least, from the stock drivers) the standard 4:3-ratio resolutions, so I just set the PC res as high as it would go and told the TV to pan and scan, giving the illusion of widescreen, albeit at slightly lower quality, as long as you can persuade your media player software to invert the scaling performed by the TV.</p>
<p>I&#8217;d argue that using different fonts for the different DPI settings was a bad idea in the first place. I think they only did it because MS Sans Serif was a bitmap font and thus couldn&#8217;t be scaled. Now the default font is Tahoma, which is scalable, it should be easier.</p>
<p>As for what Raymond said, I can&#8217;t help but think that it can&#8217;t be too hard to, when performing the upgrade from a previous version to Longhorn, use the new DPI setting that is autodetected along with the previously-configured DPI setting to calculate a new resulting font size which will appear the same as in the beforetime, give or take a few negligible units. Just a bit of arithmetic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194983">
				<div id="div-comment-194983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/larryosterman' rel='external nofollow' class='url'>Larry Osterman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194983">
			July 14, 2004 at 1:46 pm</a>		</div>

		<p>Btw, one of the worst offenders in this category is web browsers (both IE and mozilla fwiw).</p>
<p>My wife runs her machine at 1024&#215;768, but she uses large fonts.  Many windows apps don&#8217;t work right (dialog box clipping, etc), but there are very few web pages that work right, because they can&#8217;t deal with the larger than normal fonts.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195023">
				<div id="div-comment-195023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195023">
			July 14, 2004 at 2:37 pm</a>		</div>

		<p>&quot;If there&#8217;s any sort of &quot;Changes&quot; introduction&#8230;&quot;</p>
<p>Everybody who ran the Windows XP Tour raise your hand.</p>
<p>Nuff said.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195033">
				<div id="div-comment-195033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Catatonic</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195033">
			July 14, 2004 at 2:42 pm</a>		</div>

		<p>LCD&#8217;s usually do have square pixels. 17-inch LCD&#8217;s are usually 5:4 aspect ratio and have a resolution of 1280&#215;1024. (Similar to 1280&#215;960 on a 4:3 CRT.) There are 16:9 LCD&#8217;s that use 1920&#215;1080.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195043">
				<div id="div-comment-195043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195043">
			July 14, 2004 at 2:44 pm</a>		</div>

		<p>You can&#8217;t really have the dialogs scale proportionately with DPI because everything is in integers. Feng Yuan&#8217;s book talks about different ways to get scalable fonts and how GDI loses precision if you do things in a certain order. GDI+ took a different route, as described in <a target="_new" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;307208" rel="nofollow">http://support.microsoft.com/default.aspx?scid=kb;en-us;307208</a></p>
<p>Don&#8217;t depend on GDI to give you accurate values for anything at all. VERTRES, VERTSIZE, and LOGPIXELSY are totally wrong. VERTSIZE is supposed to be equivalent to LOGPIXELSY when you do the unit conversion because it&#8217;s the same measurement but in different units, but it&#8217;s not. LOGPIXELSY seems to be the DPI setting you use and VERTSIZE seems to be some value based on a formula for VGA sizes. I think it&#8217;s made this way for app compatibility (I mean look how many apps mess up when you change any of the display settings) and for multiple monitors that can vary a lot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195083">
				<div id="div-comment-195083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://none' rel='external nofollow' class='url'>Shadeway</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195083">
			July 14, 2004 at 4:50 pm</a>		</div>

		<p>&lt;sorry of my bad english&gt;</p>
<p>Hi all. I lately found mr Cheng weblog.</p>
<p>It looks that you are really a great developer of one of team<br />
<br />that stands behind win32 api, a great api looking<br />
<br />from gui point and sytem stuff. You are cool, man.</p>
<p>lots of code examples, also, nice to see there are<br />
<br />people doing ocassionally asm coding with windows api.</p>
<p>i mean, we live in 2004, the era of vmm&#8217;ed apis, langs, classes (net, java, perl is preliminary<br />
<br />expected to become register-based vmm, current trend things are jit&#8217;s compilers and<br />
<br />portable code).</p>
<p>And still there are alive people thinking, what will become burned<br />
<br />if i port code from ia32 to other hardware architecture, or<br />
<br />just recompile on 64bits.</p>
<p>A lot of respect to you, mr Cheng. Nice to see you. Your&#8217;s guidelines<br />
<br />always welcome.</p>
<p>&lt;/sorry of my bad english&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195093">
				<div id="div-comment-195093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195093">
			July 14, 2004 at 5:37 pm</a>		</div>

		<p>7/14/2004 11:20 AM Raymond Chen</p>
<p>&gt; Right and one of those new applications is<br />
<br />&gt; Explorer. &quot;I upgraded to Longhorn and the<br />
<br />&gt; fonts changed size in all of my folders.[&#8230;]<br />
<br />&gt; Why does Windows always forget my settings?&quot;</p>
<p>But that would be only once per Windows version grade, would it not?  Why does Windows Explorer already forget settings after a few hours or days?  This happens without grading to a new Windows version and the frequency is irritating.  Fortunately not destructive, merely frequently irritating.</p>
<p>But let&#8217;s try imagining if Microsoft would decide to do something right even though it breaks broken compatibility.  Then developers who want to do something right will not be forced to break what they did in order to obtain compatibility.  Developers who do something wrong would be exposed, some might fix their stuff (since they&#8217;d only have to fix it once) though some wouldn&#8217;t.  Sure there would be some people blaming Microsoft, but for a change they might have a reason to learn to blame applications instead.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195103">
				<div id="div-comment-195103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195103">
			July 14, 2004 at 5:43 pm</a>		</div>

		<p>And corporations whose line-of-business progams are broken will be unable to conduct business.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194913">
				<div id="div-comment-194913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-194913">
			July 14, 2004 at 11:20 am</a>		</div>

		<p>Right and one of those new applications is Explorer. &quot;I upgraded to Longhorn and the fonts changed size in all of my folders. I went to a lot of effort to get them exactly the way I want them and now I have to go fix them *again*. Why does Windows always forget my settings?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195013">
				<div id="div-comment-195013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://fastolfe.net/' rel='external nofollow' class='url'>David Nesting</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195013">
			July 14, 2004 at 2:35 pm</a>		</div>

		<p>&gt; &quot;I upgraded to Longhorn and the fonts changed<br />
<br />&gt; size in all of my folders. I went to a lot of<br />
<br />&gt; effort to get them exactly the way I want them<br />
<br />&gt; and now I have to go fix them *again*.</p>
<p>The upgrade process could examine current font and DPI settings, and automatically select a default &quot;base&quot; font size for the new configuration that approximates the look of their old environment while using a proper DPI setting.</p>
<p>If Joe User is currently using Windows with standard defaults, with an assumed DPI of 96, and uses Tahoma at 10pt for his dialog text, and then moves to Longhorn, which detects that he actually has a 120dpi setup, the setup process (preference import) might adjust his 10pt font size down to 8 or 9pt to make it look about the same.</p>
<p>Or perhaps approach it a different way: for upgrading users, use a &quot;Custom&quot; DPI of whatever they&#8217;re currently using today (96dpi?).  For everyone else, do the &quot;Auto-Detect&quot; thing, since they have no preferences to preserve.</p>
<p>If there&#8217;s any sort of &quot;Changes&quot; introduction, something that tries to describe the ways Longhorn differs from its predecessors, maybe include a screen or a blurb about DPIs, and give the user the option at that time to live on the edge and auto-detect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195193">
				<div id="div-comment-195193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195193">
			July 15, 2004 at 1:20 am</a>		</div>

		<p>The general problem that UI designers face when trying to use fonts properly and gracefully handle devices with different DPI settings is that very few applications (nowadays) consist of simple controls and text that can all scale. </p>
<p>No, web pages, and even the simplest XP dialog incorporates many bitmaps. And theres just no way &#8211; without a lot of coding overhead &#8211; to convince bitmaps to scale to different font sizes.</p>
<p>Ideally, if the user selected the &quot;big fonts&quot; 120 dpi mode, then web pages that rendered using the correspondingly larger fonts would also scale up all the grapic elements by 25%.</p>
<p>Of course, once you start down that slippery slope changing the DPI of a device is pointless at best, and damaging to the image quality at worst as, with all the bitmap stretching going on you would achieve the same (or better) results by simply dropping to a 25% lower resolution.</p>
<p>XP makes the problem worse with its highly graphical look. Apps that want to look XP need to incorporate many graphical elements in their UI, amking it very hard to design a UI that can deal with anything other than a single DPI setting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195143">
				<div id="div-comment-195143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/mikhailarkhipov' rel='external nofollow' class='url'>Mikhail Arkhipov (MSFT)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195143">
			July 14, 2004 at 8:33 pm</a>		</div>

		<p>I see now why many Web pages do not work correctly on large high-res displays. They want to be &quot;smart&quot; (gee, I hate dumb software that tries to be smart). They probably detect high DPI value and decide that I should have large fonts active. Then they render text *smaller*. Since I don&#8217;t have large fonts, I now can&#8217;t see anything :-) Or the other way around: script sees high resolution and thinks &#8216;well, this guy won&#8217;t be able to tell anything if I render 8pt, let me try 24pt instead&#8230;&quot; </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195203">
				<div id="div-comment-195203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ibbotson.co.uk/peteri' rel='external nofollow' class='url'>Peter Ibbotson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195203">
			July 15, 2004 at 3:38 am</a>		</div>

		<p>Don&#8217;t forget about printers as well. I&#8217;ve had endless hours of fun trying to sort out which way round paper is. Many printers have different dpi horizontally and vertically.<br />
<br />Worse still Win 9x &amp; WinNT families do this  differently if you swap the printer in and out of landscape mode when it&#8217;s set to portrait then on the 9x family the dpi swaps, on WinNT it doesn&#8217;t.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195213">
				<div id="div-comment-195213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Heffernan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195213">
			July 15, 2004 at 4:26 am</a>		</div>

		<p>Don&#8217;t get all this stuff about Delphi.  My app (&gt;100 dialogs) is written in Delphi and the dialogs scale fine with font scaling.  There are really rather few programs that can say this.  It&#8217;s not about the dev env but rather more about the developer and their attitude to such matters.  If you want your app to work with custom font scaling then you will code accordingly and do lots of testing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195223">
				<div id="div-comment-195223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc Bernard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195223">
			July 15, 2004 at 6:11 am</a>		</div>

		<p>&quot;&quot;making DPI-agnostic coding easy and evangelizing it to the masses&quot;. Already done. It&#8217;s call WinFX. But people complain anyway.&quot;</p>
<p>Right &#8211; I forgot we&#8217;re supposed to stop everything and wait for WinFx&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195233">
				<div id="div-comment-195233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195233">
			July 15, 2004 at 6:45 am</a>		</div>

		<p>&quot;And corporations whose line-of-business progams are broken will be unable to conduct business. &quot;</p>
<p>So provide shims to allow selective reverting to old, broken, behaviour.</p>
<p>The core OS shouldn&#8217;t try to work around broken apps.  That job should be left to appcompat-style shims.</p>
<p>It may be that some applications need a pretty big shim (because they do /lots/ of GDI stuff wrong), but that&#8217;s their own stupid fault.</p>
<p>This way, new programs will do the right thing, correct old programs will do the right thing, and broken old programs will be fixable, as reversion to the old, broken behaviour will be possible on a case-by-case basis.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195283">
				<div id="div-comment-195283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195283">
			July 15, 2004 at 7:48 am</a>		</div>

		<p>I think you&#8217;re underestimating how much work it would be to write a shim that completely virtualizes USER and GDI.</p>
<p>Shims are good for very specific fixes like &quot;This program forgets to pass the XYZ flag to that function.&quot;</p>
<p>They aren&#8217;t good for things like &quot;This program has a fundamentally flawed view of the universe.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195383">
				<div id="div-comment-195383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Windows Mobile</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195383">
			July 15, 2004 at 8:46 am</a>		</div>

		<p>I&#8217;m surprised noone has mentioned the new Windows Mobile 2003 Second Edition OS.. Microsoft apparently spent many resources getting real DPI scaling to work on (CE&#8217;s slimmed-down) GDI engine.  Why haven&#8217;t they done this yet for the desktop?</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwm2k3/html/developing_orientation_and_resolution_aware_apps.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwm2k3/html/developing_orientation_and_resolution_aware_apps.asp</a></p>
<p>Essentially all EXE&#8217;s tagged with a resource tell the GDI linker startup code that it is &quot;DPI-aware&quot; (granted, the only two DPI&#8217;s in CE are 96 and 192, everything is usually a 2x scaling, but MS&#8217;s compatibility modes handle any DPI).  Anything without this resource are assumed to be designed for 96 DPI, and GDI scales each and every windowing and GDI call.  It even scales down things (say, if a 96DPI application performs a screen grab).  Very impressive, and you would think they could have done this on the desktop sooner than Longhorn, without relying on WinFX&#8217;s vector engine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195413">
				<div id="div-comment-195413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Windows Mobile</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195413">
			July 15, 2004 at 9:00 am</a>		</div>

		<p>Raymond,</p>
<p>Core OS change or not &#8211; what&#8217;s interesting here is that, in theory, this shim/change could be accomplished in Linux&#8217;s WINE project and would not be possible in WinXP &#8211; unless Longhorn is really shipping in 2008, in which case I&#8217;d recommend MS to look at patching this into XP SP3 :)</p>
<p>Great question though:</p>
<p>Since the EXE has already bound to the GDI linker, the DLL gets &#8217;96&#8217; returned as the device&#8217;s DPI, and things progress smoothly.  The main drawback is if a DLL wants to show a more detailed bitmap for 192-DPI devices, it would show its 96-DPI, lower-resolution cousin (same goes for icons, etc).</p>
<p>The reverse question is actually more difficult: a good example would be Pocket PC&#8217;s &quot;Today&quot; plugins &#8212; basically the shell EXE does the resource-checking itself (looking to see if a given plugin is DPI-ready) and if it&#8217;s not, it doesn&#8217;t load it &#8212; it loads the DLL under a different EXE file (mstli.exe instead of shell32.exe) which is designed to not be DPI-aware, which then loads the DLL.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195443">
				<div id="div-comment-195443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Windows Mobile</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195443">
			July 15, 2004 at 9:15 am</a>		</div>

		<p>Raymond,</p>
<p>That&#8217;s what is strange &#8211; each and every call that deals with pixels is scaled when the &quot;compatibility mode&quot; kicks in.  GetSystemMetrics, CreateWindow, MoveWindow, GetDeviceCaps and SetWindowPos calls are all scaled too.  It all works out.  If the 96-DPI DLL checks some other window&#8217;s size, it gets cut in half.  Same with GetSystemMetrics.</p>
<p>The only weird things that could happen are if a window sends another window a message, asking for some pixel value (like its dimensions or placement of a control).  There you definitely will run into problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195463">
				<div id="div-comment-195463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195463">
			July 15, 2004 at 9:17 am</a>		</div>

		<p>Unfortunately that&#8217;s not a &quot;weird thing&quot; &#8211; it happens if you say embed an Excel spreadsheet inside a Word document.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195453">
				<div id="div-comment-195453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://fastolfe.net/' rel='external nofollow' class='url'>David Nesting</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195453">
			July 15, 2004 at 9:19 am</a>		</div>

		<blockquote><p>
  And theres just no way &#8211; without a lot of<br />
  <br />&gt; coding overhead &#8211; to convince bitmaps to scale<br />
  <br />&gt; to different font sizes. </p>
<p>Rasterized graphics like BMPs are becoming a thing of the past anyway.  Newer rasterized image formats (such as PNG) actually carry DPI information in the image itself.</p>
<p>So you might have a 96&#215;96-pixel image, which, on a 96dpi display, would be 1-inch square.  The problem, right, is that for some guy with a 192dpi display, that image is 0.5-inches, and looks pretty bad next to text that is twice the apparent size, not to mention throwing layout off.</p>
<p>With a DPI-aware image, though, the renderer sees that it&#8217;s a 96&#215;96-pixel image at 96dpi.  On a 192dpi display, this image should be scaled up to 192&#215;192-pixels.  Relative quality seems to drop for that piece of content, but that&#8217;s unavoidable.  If you compare it against the same rendering at 96dpi, it should appear pretty much identical.</p>
<p>One solution to handle image formats that do NOT carry a DPI preference might be to assume 96dpi.  Someone at 192dpi would see BMP files scaled 2x in both directions in GUI elements.  Some New API might be needed to permit developers to render an image strictly with a 1:1 pixel ratio, should they need to do so.  But really, we should be pushing for vector graphics.</p>
<p>(On a side note, my taskbar icons do seem to scale up with my OS DPI changes&#8211;poorly.  My desktop icons and quick launch icons do not, however.  They look sharp, but are tiny.)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195493">
				<div id="div-comment-195493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Windows Mobile</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195493">
			July 15, 2004 at 9:24 am</a>		</div>

		<p>Excellent point.  On CE, there&#8217;s no object embedding (or rather, very little).  It sounds like it would be the responsibility of the main EXE program to do a Today-like shim, which would definitely be asking too much on the desktop side.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195533">
				<div id="div-comment-195533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195533">
			July 15, 2004 at 10:49 am</a>		</div>

		<blockquote><p>
  Rasterized graphics like BMPs are becoming a<br />
  <br />&gt;thing of the past anyway. Newer rasterized<br />
  <br />&gt;image formats (such as PNG) actually carry DPI<br />
  <br />&gt;information in the image itself.</p>
<p>Ah, dare I ask what you think of the biXPelsPerMeter and biYPelsPerMeter members of the BITMAPINFOHEADER struct then? :P</p>
<p>
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195613">
				<div id="div-comment-195613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Florian Gro&#223;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195613">
			July 15, 2004 at 1:32 pm</a>		</div>

		<p>The diagrem doesn&#8217;t work in Non-IE browsers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195623">
				<div id="div-comment-195623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195623">
			July 15, 2004 at 1:41 pm</a>		</div>

		<p>All my diagrams are written in VML. If you have a browser that supports VML and the diagram doesn&#8217;t work, let me know and I&#8217;ll try to fix it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195643">
				<div id="div-comment-195643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195643">
			July 15, 2004 at 2:06 pm</a>		</div>

		<p>Non-square pixels are still common in many printers.  Futhermore, many printer drivers forget to flip the x and y resolutions when you go into landscape mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195563">
				<div id="div-comment-195563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://msmvps.com/gbvb/archive/2004/07/15/10194.aspx' rel='external nofollow' class='url'>Girish Bharadwaj</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195563">
			July 15, 2004 at 3:02 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195403">
				<div id="div-comment-195403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195403">
			July 15, 2004 at 8:54 am</a>		</div>

		<p>I&#8217;m not saying that it *can&#8217;t* be done. Just that it would be an awful lot of work to virtualize everything via a shim. (Notice that the CE version is a core OS change, not a shim.)</p>
<p>Also what do you do if a non-DPI aware program uses a DLL that *is* DPI-aware?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195433">
				<div id="div-comment-195433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195433">
			July 15, 2004 at 9:08 am</a>		</div>

		<p>&quot;The DLL gets 96 returned as the device&#8217;s DPI and things progress smoothly.&quot;  Well until that DLL say tries to mess with windows from other processes which are not DPI-scaled. You could scale the entire window rectangle, but then the DLL would see another window whose caption height is *not* equal to GetSystemMetrics(SM_CYCAPTION) because it has been scaled by the shim.  Maybe that&#8217;s okay, maybe it isn&#8217;t. Depends on what the app does.</p>
<p>And Win32 apps are known for doing the strangest thing.  More than once I have said, &quot;This is a safe change. Nobody would ever be so crazy as to rely on that,&quot; and been proved wrong.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195723">
				<div id="div-comment-195723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195723">
			July 15, 2004 at 4:25 pm</a>		</div>

		<p>&quot;They aren&#8217;t good for things like &quot;This program has a fundamentally flawed view of the universe.&quot; &quot;<br />
<br />But the flaw is a very specific one&#8211;that there are 96 dots per inch and hence its font-size selections and dialogue element positions work properly.</p>
<p>And unfortunately it seems that even for not passing flags (and so on) that Windows fails to use shims.  There&#8217;s a few dozen appcompat shims, but (judging by the leaked source code) a hell of a lot more hacks to fix buggy apps contaminating the normal code paths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195733">
				<div id="div-comment-195733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195733">
			July 15, 2004 at 4:33 pm</a>		</div>

		<p>&quot;But the flaw is a very specific one&quot; &#8211; yes which requires that nearly every single GDI and USER function be hooked so that the lie can be maintained.</p>
<p>It&#8217;s not like you can just patch LOGPIXELSX to return 96. These apps never call GetDeviceCaps; that&#8217;s why they aren&#8217;t DPI-aware in the first place.</p>
<p>Program calls GetWindowRect &#8211; you need to tweak the return value. Program calls SetWindowRect &#8211; you need to edit the parameters that are passed. Program calls SetWindowRgn &#8211; you have to edit the region. Program calls GetWorldTransform &#8211; you have to remove the scaling transform so the app won&#8217;t barf on it.  If it were just returning 96 from a call to GetDeviceCaps that would be easy.</p>
<p>That leaked code was very old. It predated shims.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195743">
				<div id="div-comment-195743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-195743">
			July 15, 2004 at 5:13 pm</a>		</div>

		<p>DPI awareness should be handled by the OS, and application level developers shouldn&#8217;t have to deal with it for the most part. Period.</p>
<p>Bill Gates has stated that 200-dpi displays will be commonplace. What the heck will you do then?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196283">
				<div id="div-comment-196283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-196283">
			July 19, 2004 at 10:26 am</a>		</div>

		<p>A friend of mine does all UI in MM_TEXT. He obtains size and rezolution of a DC, but draws only in pixel mode. He tell me, that no mapping mode can produce as accurate results, as drawing by pixel. One pixel error is very well noticeable, and he is a perfectionist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196513">
				<div id="div-comment-196513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Child</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-196513">
			July 20, 2004 at 9:22 am</a>		</div>

		<p>My brother just received a new dell d600 laptop.  Since the native resolution of the latop is 1400&#215;1050, Dell has elected to enable Large Fonts by default.  Even WindowsUpdate has some trouble with it.</p>
<p>It really is a problem that will need to be addressed soon.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196623">
				<div id="div-comment-196623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Trent Glascock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-196623">
			July 20, 2004 at 1:18 pm</a>		</div>

		<p>I also have a new laptop where large fonts/&quot;non-standard&quot; DPI was enabled by default.  IE seemed to try to &quot;upsize&quot; images and they ended up looking very blocky.  The standard control panel dialogs also looked very bad.  The only thing that really looked good was the start menu/desktop/explorer icons because of the larger icons.</p>
<p>After a couple of hours I switched to the small fonts/96 DPI and suffer with the small fonts and small icons.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-198473">
				<div id="div-comment-198473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scott Moe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040714-00/?p=38443#comment-198473">
			July 27, 2004 at 6:52 am</a>		</div>

		<p>I write tax preparation software with Delphi we support 95 at 640&#215;480 through XP on high res multi monitor systems.  Our screens are supposed to look like the tax forms and we scale to fit our window.  Every pixel counts, we check the DPI and set the font size in points, but that is not enough. The older versions of Windows, with Large Fonts, report 96 DPI and give you a 12 point font when you ask for a 10.  XP will work correctly but more than half my users are on 98se or earlier.  Every year I google for a way to detect the Large Font setting for these older machines.  I was pleased to find this discussion, but sad that I have still not found what I need.  I know that Windows95 to 2000 holds a setting when the user has selected Large Fonts, but there still seems to be no way to get that  information in my program.  I need to know when to ask for an 8 point font when I really want a 10 point font.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>