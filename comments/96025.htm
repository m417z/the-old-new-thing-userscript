<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1293696">
				<div id="div-comment-1293696" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programmerman.net' rel='external nofollow' class='url'>Nick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293696">
			April 24, 2017 at 7:18 am</a>		</div>

		<p>Combine this with April 12th&#8217;s article and you can build a program to get the current directory of a user-selected drive. Is this the best way to accomplish that? ðŸ¤· But at least you didn&#8217;t have to write your own drive picker dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1293705">
				<div id="div-comment-1293705" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ted M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293705">
			April 24, 2017 at 8:45 am</a>		</div>

		<p>The arbitrary size filter in the previous linked article, combined with the drive filter would be useful for programs that dump large amounts of data to a folder just off of the root of a scratch drive (Video capture utilities, for example)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1293715">
				<div id="div-comment-1293715" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Muzer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293715">
			April 24, 2017 at 9:49 am</a>		</div>

		<p>Could a network location of &#8220;//a&#8221; somehow linked from My Computer (my brain&#8217;s a little rusty on how you make things show up in My Computer so I don&#8217;t know entirely if this is possible) show up as a false positive here? (Not that I suspect anyone would have such a computer name linked into My Computer like this&#8230;)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1293716">
				<div id="div-comment-1293716" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293716">
			April 24, 2017 at 9:50 am</a>		</div>

		<p><code>\\a</code> is not considered a root (it has to be <code>\\a\b</code>), but the underlying point is well-taken. I&#8217;ll add a PathGetDriveNumber.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1293726">
				<div id="div-comment-1293726" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://nbtparse.org' rel='external nofollow' class='url'>Kevin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293726">
			April 24, 2017 at 3:16 pm</a>		</div>

		<p>What happens if your end user has more than 26 drives and is using Volume Mount Points?  Are they just unable to specify all of their devices?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1293745">
				<div id="div-comment-1293745" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293745">
			April 24, 2017 at 4:48 pm</a>		</div>

		<p>You&#8217;ll have to ask the people who want to do this. (And yes, people want to do this. That&#8217;s why I wrote this blog entry. So that when the next person wants to do this, I can just point them at the blog entry.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even depth-2 parent" id="comment-1293755">
				<div id="div-comment-1293755" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293755">
			April 24, 2017 at 6:23 pm</a>		</div>

		<p>That&#8217;s valid question, but in reality if you need that much space, usually you&#8217;ll want to run them in RAID set (either RAID 0 or JBOD if you don&#8217;t need redundancy) or even a SAN array. So drive letters rarely runs out.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-3" id="comment-1293765">
				<div id="div-comment-1293765" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293765">
			April 24, 2017 at 6:25 pm</a>		</div>

		<p>And for companies that has lots of file servers, they usually use DFS to manage the mount points.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-3" id="comment-1294105">
				<div id="div-comment-1294105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danish guy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1294105">
			April 26, 2017 at 1:37 am</a>		</div>

		<p>Not necessary. I have 4 cardreaders in my machine, which eat 4 drive letters each. I guarantee you that it&#8217;s not a good idea to put them in a read array.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1293735">
				<div id="div-comment-1293735" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">William</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293735">
			April 24, 2017 at 4:31 pm</a>		</div>

		<p>That&#8217;s pretty cool and believe it or not, I&#8217;ve seen a programme actually do this before. I don&#8217;t recall what it was, though I thought it was quite clever at the time. I believe it used a fixed path off the root of the drive so you only specified the root drive to create the hierarchy on. Yes, a dropdown list would&#8217;ve achieved the same result but it was a different take on that UI design.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1293775">
				<div id="div-comment-1293775" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293775">
			April 25, 2017 at 1:25 am</a>		</div>

		<p>It is quite surprising that Raymond is continuing such an aged article&#8230; Is this usual for this blog?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1293785">
				<div id="div-comment-1293785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Muzer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293785">
			April 25, 2017 at 3:17 am</a>		</div>

		<p>Very common. Raymond writes the posts in his queue months/years in advance, and quite often has a tendency to remember even older articles he&#8217;s written and refer to them in future ones. I&#8217;ve seen articles from a couple of years ago that follow up on articles from 2003&#8230;</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1293825">
				<div id="div-comment-1293825" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293825">
			April 25, 2017 at 6:08 am</a>		</div>

		<p>Could it be the case that Raymond wrote the entire series of &#8220;choose folder dialog&#8221; long time ago and put the entries on random days in the following years? Or on a random day, like <em>today</em>, Raymond randomly picks a &#8220;continuable&#8221; entry in the archive and extend it? Or is it such a coincidence that Raymond came up with the idea that happened to have had its place in the blog since years ago this morning?!</p>
<p>Series like &#8220;choose folder dialog&#8221; are quite different from, for example, &#8220;The wisdom of seventh graders&#8221;, because the content of the latter arises/is &#8220;born&#8221; from time to time. This blog is like shuffled reading notes of the complete book of history, which I certainly enjoy a lot. BTW I&#8217;ve planned to read the archive from the very beginning but haven&#8217;t got time to do that.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-4" id="comment-1294095">
				<div id="div-comment-1294095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1294095">
			April 25, 2017 at 6:59 pm</a>		</div>

		<p>Well&#8230; Use already posted code and modify it a little to suit a new purpose is both allow him use less effort to write, and easier for us to read (because presumably those who really read it have also read the old program and understand how it works already, they just need to focus on the modified parts which is highlighted.) So why not?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1293795">
				<div id="div-comment-1293795" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1293795">
			April 25, 2017 at 5:03 am</a>		</div>

		<p>One can also occasionally get (lightly) chastised for asking a question which he answered in a blog post over a decade ago.</p>
<p>The only solution really is to read through the entire archives. Don&#8217;t worry, they&#8217;re worth it.</p>
<p>;)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1294135">
				<div id="div-comment-1294135" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Someone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170424-00/?p=96025#comment-1294135">
			April 26, 2017 at 8:26 am</a>		</div>

		<p>&#8220;The CheckÂ­Depth method is method is a bit tricky for a few reasons. First, it treats the null pointer as equivalent to the desktop, so that it is the ancestor of everything. For whatever reason, that&#8217;s what IFolderÂ­Filter gives you, so we accommodate it. &#8221;</p>
<p>My tests under Windows 7 shows that pidlFolder == nullptr happens at the ShouldShow() call when and only for the item &#8220;Computer&#8221;. For whatever reason, even GetEnumFlags() is never called for the &#8220;Desktop&#8221; item (is this correct behavior?).</p>
<p>You can get around the special case (or bug) for the &#8220;Computer&#8221; item when you use ILCombine(pidlFolder, pidlItem) and then work with the result of this call.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>