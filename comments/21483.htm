<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (8)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-649483">
				<div id="div-comment-649483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AsmGuru62</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649483">
			July 24, 2008 at 11:04 am</a>		</div>

		<p>&#8230;uhm&#8230; the Leave called in both cases?!.. I think it is a typo. The code is correct though.</p>
<div class=post>[<i>Fixed, thanks. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649503">
				<div id="div-comment-649503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649503">
			July 24, 2008 at 1:56 pm</a>		</div>

		<p>It&#8217;s been a really long time since I played with this stuff, but isn&#8217;t there a pointer to a window&#8217;s drop target stuffed into one of its properties?</p>
<p>I seem to remember having to hack around this to allow VB6 to support richer drag and drops.</p>
<p>I&#8217;m really rusty on my Win32, but was there a way to get a marshalled pointer to that drop target? &nbsp;Curious for old times sake.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649513">
				<div id="div-comment-649513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649513">
			July 24, 2008 at 1:59 pm</a>		</div>

		<p>Oops&#8230; &nbsp;looks like it&#8217;s explained here:</p>
<p>&quot;The reason why the taskbar doesn&#8217;t do this is that there is no such function GetDropTargetFromWindow function.&quot;</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2004/11/24/269237.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/11/24/269237.aspx</a></p>
<p>I imagine the reason you can&#8217;t is because applications should just start the drag and let the user drop it in the right spot. &nbsp;It&#8217;s drag and drop, not some form of DDE! &nbsp;:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649523">
				<div id="div-comment-649523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649523">
			July 24, 2008 at 2:07 pm</a>		</div>

		<p>Thank you!</p>
<p>I often start a drag&amp;drop operation in IE with e.g. a link by acciedent and don&#8217;t want to navigate to that page.</p>
<p>I didn&#8217;t know that I could press ESC! That&#8217;s a great tip!</p>
<p>(I always tried to drag it to an area that does no harm, like the tray^H^H^H^Hnotification area or let&#8217;s say &quot;the clock&quot; ;-) &nbsp;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649583">
				<div id="div-comment-649583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rune</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649583">
			July 25, 2008 at 9:41 am</a>		</div>

		<p>So&#8230; Is this the preferred way of printing an arbitrary file to a specific printer?</p>
<p>I need to target a specific printer and I can&#8217;t render the documents myself. ShellExecute(&quot;print&quot;, &#8230;) only targets the default printer, but I have a specific printer in mind.</p>
<p>Simulating a file drop provides me with a workaround, but I can&#8217;t help thinking that there surely must be an easier way. How does the shell trick the document&#8217;s application to print to a specific printer?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649843">
				<div id="div-comment-649843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649843">
			July 25, 2008 at 10:41 pm</a>		</div>

		<p>Rune, have you looked at PrintTo?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649973">
				<div id="div-comment-649973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rune</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-649973">
			July 28, 2008 at 8:33 am</a>		</div>

		<p>Thanks Greg! IFileViewer::PrintTo looks promising, but the description of the IFileViewer interface gives me pause. I&#8217;ll just have to give it a try I guess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-650213">
				<div id="div-comment-650213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080724-00/?p=21483#comment-650213">
			July 28, 2008 at 9:02 pm</a>		</div>

		<p>Rune, I just meant using the printto verb instead of the print verb in ShellExecute.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>