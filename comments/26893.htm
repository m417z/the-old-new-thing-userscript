<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (46)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-503293">
				<div id="div-comment-503293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sohail</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503293">
			May 11, 2007 at 10:16 am</a>		</div>

		<p>Batch files! NOOOOOOOOOOOOOOOOOOOoooooooooooooooooo&#8230;&#8230;&#8230;.</p>
<p>splat.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503313">
				<div id="div-comment-503313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smspower.org/maxim/' rel='external nofollow' class='url'>Maxim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503313">
			May 11, 2007 at 10:42 am</a>		</div>

		<p>Alternatively:</p>
<p>for /r /d %%i in (*) do echo %%i</p>
<div class="post">[<i>Nice, but there&#8217;s more to the &#8220;dir&#8221; trick than meets the eye. I&#8217;ll come back to this. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503353">
				<div id="div-comment-503353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503353">
			May 11, 2007 at 11:19 am</a>		</div>

		<p>Or the other alternative (using cygwin)</p>
<p>find -type d -exec echo &#8216;{}&#8217; &#8216;;&#8217;</p>
<p>I do think the cygwin way of doing this kind of thing is substantially friendlier&#8230;</p>
<div class="post">[<i>Woo-hoo, now I have <a href="http://blogs.msdn.com/oldnewthing/archive/2006/03/22/558007.aspx" rel="nofollow">two problems</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503393">
				<div id="div-comment-503393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503393">
			May 11, 2007 at 11:32 am</a>		</div>

		<p>I prefer to use Windows Script Host for these kind tricks. The clumsiness of FileSystemObject can be hidden with some functions and you have all of Javascript (or VBScript) at your disposal for string operations. All the infrastructure is already down on the drive, at least since Windows 95.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503443">
				<div id="div-comment-503443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503443">
			May 11, 2007 at 12:20 pm</a>		</div>

		<p>&quot;You make it sound like you have to re-install perl every time you want to write a perl script.&quot;</p>
<p>And what if you do? &nbsp;For instance, you&#8217;re trying to debug a problem on a customer&#8217;s PC that you&#8217;ve never seen before.</p>
<p>&quot;Umm, do you mind if I install perl, Visual Studio, and Photoshop first before I can start debugging this issue?&quot;</p>
<p>You know, you can use your head and figure out whether it really does cause you two problems instead of taking Raymond&#8217;s word as gospel instead of advice. &nbsp;If it turns out it doesn&#8217;t cause you two problems, then good for you! &nbsp;You deserve a treat for figuring that out yourself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503453">
				<div id="div-comment-503453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">El Guapo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503453">
			May 11, 2007 at 12:21 pm</a>		</div>

		<p>This is a microsoft blog right? You never tried powershell I guess? Maybe you have heard of it. Its something your company makes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503463">
				<div id="div-comment-503463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503463">
			May 11, 2007 at 12:24 pm</a>		</div>

		<p>Might as well mention &quot;for /r /d %I in (.) do @echo %I&quot; as well, which seems to be the method that whoever wrote the help text for the for command recommends. &nbsp;You get names that end in ., but it lists directories that (*) misses.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503473">
				<div id="div-comment-503473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503473">
			May 11, 2007 at 12:28 pm</a>		</div>

		<p>Quoting Abraham Lincoln for a discussion on corporate IT &#8211; brilliant. &nbsp;Totally misunderstanding the quote and using it in absolutely the wrong context &#8211; priceless.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503493">
				<div id="div-comment-503493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bionicbee</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503493">
			May 11, 2007 at 12:30 pm</a>		</div>

		<p>Is there any good documentation on the syntax for batch files? We have some homegrown scripts to do various things but some things are extremely hard to figure out, like how to deal with parentheses in strings, which comes up when trying to parse a PATH envvar on x64 systems for example.</p>
<p>It&#8217;s humiliating (but mostly frustrating) for an expert C++ programmer to spend three hours figuring out how to append a string to another&#8230; in the end I wrote a .net app in five minutes to solve the problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503503">
				<div id="div-comment-503503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503503">
			May 11, 2007 at 12:35 pm</a>		</div>

		<p>&quot;This is a microsoft blog right? You never tried powershell I guess?&quot;</p>
<p>I am pretty sure Raymond was looking to work with the tools already available on the island. That&#8217;s why I mentioned WSH as an alternative as well. If you&#8217;re going to download and MSH, Perl, Python, whatever on 100 or 1000 computers to solve a simple admin problem then you are wasting time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503523">
				<div id="div-comment-503523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503523">
			May 11, 2007 at 12:54 pm</a>		</div>

		<blockquote><p>
  &gt; Is there any good documentation on the syntax for batch files?
</p></blockquote>
<p>Not really &#8211; there&#8217;s 3 decent resources for Windows batch scripting that I know of:</p>
<p>1) cmd.exe&#8217;s help facility (just type &quot;help&quot; or use the /? option for the command you want specific help on).</p>
<p>2) Tim Hill&#8217;s book &quot;Windows NT Shell Scripting&quot; (<a rel="nofollow" target="_new" href="http://www.amazon.com/dp/1578700477/" rel="nofollow">http://www.amazon.com/dp/1578700477/</a>)</p>
<p>3) Google</p>
<p>Unfortunately, cmd&#8217;s batch syntax seems to have grown more or less organically, rather than been designed. &nbsp;In particular the behavior for quoting characters and strings can be strange an unintuitive. So it can be quite painful to do much in the way of string manipulation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503533">
				<div id="div-comment-503533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503533">
			May 11, 2007 at 12:55 pm</a>		</div>

		<p>Thanks for the tip, batch files are still good for a lot of things.</p>
<p>And when I need something more powerful, I have discovered a cool tool a while ago: KiStart <a rel="nofollow" target="_new" href="http://www.kixtart.org/index.asp" rel="nofollow">http://www.kixtart.org/index.asp</a></p>
<p>Needs no installation (just drop 2 files with your script), and has a scripting language, can do ole automation, registry access, reading files, etc, and.</p>
<p>Sure, Perl, Awk, PowerShell, have their place and I use them. But knowing more tools allows you to choose the best for the job.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-ryanbemrose even thread-even depth-1" id="comment-503543">
				<div id="div-comment-503543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ryan+Bemrose' rel='external nofollow' class='url'>Ryan Bemrose</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503543">
			May 11, 2007 at 12:57 pm</a>		</div>

		<p>@bionicbee: If all you want is documentation on commands, search for &quot;command processor&quot; in MSDN, or try &quot;help whatever&quot; at the command-line.</p>
<p>For more in-depth stuff, I highly recommend &quot;Windows NT Shell Scripting&quot; by Tim Hill.</p>
<p><a rel="nofollow" target="_new" href="http://www.amazon.com/Windows-Shell-Scripting-Timothy-Hill/dp/1578700477" rel="nofollow">http://www.amazon.com/Windows-Shell-Scripting-Timothy-Hill/dp/1578700477</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503553">
				<div id="div-comment-503553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503553">
			May 11, 2007 at 12:57 pm</a>		</div>

		<blockquote><p>
  &gt; You never tried powershell I guess? Maybe you have heard of it.
</p></blockquote>
<p>What&#8217;s your point? &nbsp;The fact that PowerShell exists makes old-fashioned batch files useless now? &nbsp;All those little .cmd files in my util directory have not seemed to notice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503563">
				<div id="div-comment-503563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fox Cutter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503563">
			May 11, 2007 at 1:02 pm</a>		</div>

		<p>This is a usefull tip. I&#8217;m always surprised by how much you can do with the command language in Windows. There&#8217;s quite a lot you can do using it without having to go into other applications.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503593">
				<div id="div-comment-503593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cmov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503593">
			May 11, 2007 at 1:42 pm</a>		</div>

		<p>&#8220;[You have to install it on every computer that will run your script, which in a corporate setting can be hundreds or thousands. At some point, the trade-off will be worth it, and you can ignore all my batch file tips. Until then, the tips are there. -Raymond]&#8221;</p>
<p>But for your tips, I would need to install Windows.</p>
<p>Eek.</p>
<div class=post>[<i>If your machines aren&#8217;t already running Windows, then yes, you would have to install Windows, too, and that would be quite a burden. I guess I have to add a new sentence to the nitpicker&#8217;s corner now. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503603">
				<div id="div-comment-503603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.kryogenix.org/' rel='external nofollow' class='url'>Stuart Langridge</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503603">
			May 11, 2007 at 1:56 pm</a>		</div>

		<p>I do this kind of thing all the time. There&#8217;s a certain punk cachet in doing cool things with batch that I enjoy. Sort of a question (although this should maybe have gone to the suggestion box): do you know why usebackq isn&#8217;t the default? It seems slightly odd to me that since a &#8220;syntax&#8221; for &#8220;run a command and get its output&#8221; already existed (backticks) that cmd.exe implemented a different one (single quotes) and then put in the backticks as a config option. This might not be a Raymond question at all; I don&#8217;t know whether the command shell comes under the aegis of the shell team, ironically enough!</p>
<div class=post>[<i>You have your history backwards. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kjkhyperion odd alt thread-odd thread-alt depth-1" id="comment-503623">
				<div id="div-comment-503623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503623">
			May 11, 2007 at 2:01 pm</a>		</div>

		<p>Stuart: thank GOD it isn&#8217;t the default. It is a PAIN to type backquotes on certain keyboard layouts. Also I think single quotes came first and the alternate syntax was added later</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503633">
				<div id="div-comment-503633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.kryogenix.org/' rel='external nofollow' class='url'>Stuart Langridge</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503633">
			May 11, 2007 at 2:04 pm</a>		</div>

		<p>Raymond: ah, OK, if I&#8217;ve got it backwards then I was wrong. Not sure what I&#8217;ve got backwards, mind :)</p>
<p>KJK::Hyperion: backticks are awkward to type? I clearly don&#8217;t have as much experience of alternate keyboard layouts as I need, then!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kjkhyperion odd alt thread-odd thread-alt depth-1" id="comment-503643">
				<div id="div-comment-503643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503643">
			May 11, 2007 at 2:12 pm</a>		</div>

		<p>Stuart: Alt-096 on an Italian layout&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503653">
				<div id="div-comment-503653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">coldacid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503653">
			May 11, 2007 at 2:24 pm</a>		</div>

		<blockquote><p>
  Or the other alternative (using cygwin)
</p></blockquote>
<p>></p>
<blockquote><p>
  find -type d -exec echo &#8216;{}&#8217; &#8216;;&#8217;
</p></blockquote>
<p>></p>
<blockquote><p>
  I do think the cygwin way of doing this kind of</p>
<p>  thing is substantially friendlier&#8230;
</p></blockquote>
<p>I dunno&#8230; I&#8217;m a big fan of Cygwin myself, and I think that the way Raymond showed was far more readable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-503683">
				<div id="div-comment-503683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503683">
			May 11, 2007 at 2:36 pm</a>		</div>

		<blockquote><p>
  You have to install it on every computer that will run your script, which in a corporate setting can be hundreds or thousands.
</p></blockquote>
<p>To be fair, in a corporate setting, installing Monad on hundreds or even thousands of computers is only about ten times as difficult as setting it up on one computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503713">
				<div id="div-comment-503713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503713">
			May 11, 2007 at 5:05 pm</a>		</div>

		<p>I realize it&#8217;s not exactly the point of this post, but for anyone who is interested, you might check out the free AutoIt (<a rel="nofollow" target="_new" href="http://www.autoitscript.com/autoit3/" rel="nofollow">http://www.autoitscript.com/autoit3/</a>). It has an incredibly full-featured API that lets you do nearly anything you&#8217;d want to on Windows. The syntax is a lot like Visual Basic, and you can compile the scripts into a standalone executable, so no need to install libraries, etc.</p>
<p>In any case, it has been very helpful for me in the past.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503723">
				<div id="div-comment-503723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AltMihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503723">
			May 11, 2007 at 5:59 pm</a>		</div>

		<p>Also, <a rel="nofollow" target="_new" href="http://www.robvanderwoude.com/batchfiles.html" rel="nofollow">http://www.robvanderwoude.com/batchfiles.html</a> is an invaluable resource for those who would invest some time in learning the Windows command line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503423">
				<div id="div-comment-503423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503423">
			May 11, 2007 at 12:08 pm</a>		</div>

		<p>[Woo-hoo, now I have two problems. -Raymond]</p>
<p>Yes, but if you solve one of them *once*, it makes *all your other* problems easier to solve from then on. If you&#8217;d installed cygwin/perl/monad/whatever last March when it was originally suggested, you&#8217;d have *already* solved that problem, and would be able to solve this one more easily.</p>
<p>You make it sound like you have to re-install perl every time you want to write a perl script.</p>
<p>&#8220;Give me six hours to chop down a tree and I will spend the first four sharpening the axe.&#8221;</p>
<p>&#8212; Abraham Lincoln</p>
<p>Using batch files to accomplish all your automation goals is like trying to cut down all your trees with a rusty axe. If you could just take a day to leave the forest, find civilisation, and buy a damn chainsaw, you&#8217;ll make the time up later. Honest.</p>
<p>&#8220;No, no, I can&#8217;t take the time out to go and find proper tools &#8211; I&#8217;m too busy doing it slowly!&#8221;</p>
<div class="post">[<i>You have to install it on every computer that will run your script, which in a corporate setting can be hundreds or thousands. At some point, the trade-off will be worth it, and you can ignore all my batch file tips. Until then, the tips are there. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503433">
				<div id="div-comment-503433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503433">
			May 11, 2007 at 12:19 pm</a>		</div>

		<p>&#8220;You make it sound like you have to re-install perl every time you want to write a perl script.&#8221; &#8211; Adam</p>
<p>You are assuming you got the go ahead to install &lt;whatever your technology of choice is by whatever vendor of choice&gt; in the first place &#8211; as Raymond points out in the linked article this is not always trivial or even possible. </p>
<p>If you can dump the permissions of a file system tree on a production server to a file without installing and other software (which could introduce new security issues, training requirements etc.) then surely one line typed in at a cmd.exe prompt is a winner. After all this was only a &#8216;tip&#8217; and not an attempt to promote using batch files in any way.</p>
<div class=post>[<i>I can imagine the support call now. &#8220;Hi, is there a quick way to dump the ACLs on all the directories on our server into a file?&#8221; &#8220;Why yes there is. First, install cygwin.&#8221; *Click*. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503483">
				<div id="div-comment-503483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Ritchie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503483">
			May 11, 2007 at 12:29 pm</a>		</div>

		<p>Outstanding the nitpickability of these folks. &nbsp;Raymond even added &quot;I doubt anybody actually enjoys working with batch files&#8230;&quot;, meaning for those of use who *HAVE* to use batch files and cannot use anything else (locked-down PC, corporate standards, least common-denominator, etc. etc. etc.) then, as Raymond says, &quot;doesn&#8217;t mean tips on using it more effectively aren&#8217;t valid.&quot;</p>
<p>Sheesh.</p>
<p>Looks like Raymond needs a nitpicker&#8217;s prelude to explain why he&#8217;s talking about what he&#8217;s talking about.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kjkhyperion odd alt thread-odd thread-alt depth-1" id="comment-503613">
				<div id="div-comment-503613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503613">
			May 11, 2007 at 1:59 pm</a>		</div>

		<p>Ha! I used &quot;tokens=*&quot; instead of &quot;delims=&quot;. And I use uppercase letters for the variable name, to make tilde expansions non-ambiguous. And you should prefix the &quot;do&quot; command with an @, or the command will be echoed. In other words, I&#8217;d use:</p>
<p>for /f &quot;tokens=*&quot; %%I in (&#8216;dir /ad/s/b&#8217;) do @echo %%I</p>
<p>Also, how to perform an infinite loop: for /l %I in (1,0,1) do &#8230;</p>
<p>Finally a little warning: you can make a pipeline of &quot;for&quot; loops (and, indeed, any built-in command), but be aware that, if there are more than two in the same pipeline, each will be run in a subprocess. The /V and /E options won&#8217;t be passed onto the cmd.exe subprocess, I guess as a bug, and this might screw with !VARIABLE! expansion; in that case, you can sacrifice syntactic sugar by replacing the offending &quot;for&quot; loop with an explicit cmd /e:on /v:on /c &quot;for &#8230;&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503663">
				<div id="div-comment-503663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://digioxy.com' rel='external nofollow' class='url'>Mike C</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503663">
			May 11, 2007 at 2:25 pm</a>		</div>

		<p>Back in the days of DOS, I used a little utility called &quot;Sweep&quot; (<a rel="nofollow" target="_new" href="http://short.stop.home.att.net/freesoft/batch2.htm#sweep" rel="nofollow">http://short.stop.home.att.net/freesoft/batch2.htm#sweep</a>) that did the same thing.</p>
<p>For example, &quot;sweep del *.bak&quot; would delete *.bak files from the current directory and all subdirectories under it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-503673">
				<div id="div-comment-503673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503673">
			May 11, 2007 at 2:30 pm</a>		</div>

		<p>&gt; I doubt anybody actually enjoys working with batch files</p>
<p>/me sheepishly raises hand&#8230;</p>
<p><a rel="nofollow" target="_new" href="http://channel9.msdn.com/ShowPost.aspx?PostID=51329" rel="nofollow">http://channel9.msdn.com/ShowPost.aspx?PostID=51329</a></p>
<p><a rel="nofollow" target="_new" href="http://channel9.msdn.com/ShowPost.aspx?PostID=189460" rel="nofollow">http://channel9.msdn.com/ShowPost.aspx?PostID=189460</a></p>
<p>My particular favorite has to be xargs.bat, which allows the charmingly anaOStic</p>
<p>dir /b /a:-d *.cpp | xargs start</p>
<p>or</p>
<p>dir /b /a:-d *.cpp | xargs /addquotes start &quot;&quot;</p>
<p>(to placate start&#8217;s weird argument syntax)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503763">
				<div id="div-comment-503763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">telcor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503763">
			May 11, 2007 at 10:28 pm</a>		</div>

		<blockquote><p>
  &gt; You have to install it on every computer that will run your script, which in a corporate setting can be hundreds or thousands.</p>
<p>  To be fair, in a corporate setting, installing Monad on hundreds or even thousands of computers is only about ten times as difficult as setting it up on one computer.
</p></blockquote>
<p>Which supposes one already went through the bureaucracy to gain approval for installing software domain-wide</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503783">
				<div id="div-comment-503783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503783">
			May 12, 2007 at 12:36 am</a>		</div>

		<p>Adam, I won&#8217;t go over how wrong your post as a whole is, but the quote you use stands out. I believe the meaning is that if you give people too much time for a task they&#8217;ll waste time on things that don&#8217;t actually help with the task.</p>
<p>If you have someone who has unlimited free time because they have no job and don&#8217;t have to pay rent or buy food an acceptable solution might be to create a new programming language, build a community, and have the community come up with tools to solve their problem. People who have limited time have to devote all of it to actually solving the problem, not configuring new platforms.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503793">
				<div id="div-comment-503793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://gnobal.net' rel='external nofollow' class='url'>Amit Schreiber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503793">
			May 12, 2007 at 1:41 am</a>		</div>

		<p>Steve Miller (creator of Dependency Walker) has a DOS toolbox application collection. One of these applications is global.exe, which let&#8217;s you run a command for each subdirectory with some additional options. See his applications page for more details:</p>
<p><a rel="nofollow" target="_new" href="http://www.stevemiller.net/apps/" rel="nofollow">http://www.stevemiller.net/apps/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503803">
				<div id="div-comment-503803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ookii.org' rel='external nofollow' class='url'>Sven Groot</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503803">
			May 12, 2007 at 4:40 am</a>		</div>

		<p>Ah, batch files. I can never quite decide whether to feel nostalgic about them or just install PowerShell and say &quot;good riddance&quot;. :P After spending a brief time (like, 30 minutes) with Exchange 2007 and PowerShell, the latter is more likely. :)</p>
<p>They are a good solution sometimes when you can&#8217;t go off installing new stuff, but WScript also fits that description and is a lot more flexible. Bottom line, unless what I need to do really is nothing more than a simple sequence of commands, I tend to not use batch files.</p>
<p>Anti-nitpickers corner: this isn&#8217;t to say the tips aren&#8217;t useful and/or you should stop giving them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503823">
				<div id="div-comment-503823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503823">
			May 12, 2007 at 9:49 am</a>		</div>

		<p>I love tips like this &#8211; I still have &quot;which.bat&quot; from one of the earlier tips posts, where people argued over which was the most elegant solution.</p>
<p>I admit I don&#8217;t yet see the appeal of the</p>
<p>&quot;for /r /d %I in (.) do @echo %I&quot;</p>
<p>over</p>
<p>for /f &quot;delims=&quot; %%i in (&#8216;dir /ad/s/b&#8217;) do echo %%i</p>
<p>&#8230;but that just makes me look forward more to the &quot;I&#8217;ll come back to this.&quot; post.</p>
<p>I notice very few people saying in the C posts &quot;OMGWTFBBQ use Perl/Python/Java/Bash!&quot; &#8211; why should this post be different? It&#8217;s a post about cmd commands, it&#8217;s blatantly obvious that there are alternatives out there, but that&#8217;s no more the point than in the C language posts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503863">
				<div id="div-comment-503863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cmov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503863">
			May 12, 2007 at 6:13 pm</a>		</div>

		<p>&quot;[If your machines aren&#8217;t already running Windows, then yes, you would have to install Windows, too, and that would be quite a burden. I guess I have to add a new sentence to the nitpicker&#8217;s corner now. -Raymond]&quot;</p>
<p>No, it&#8217;s allright -_-&#8216; I was just kinda silly :p</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-503973">
				<div id="div-comment-503973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-503973">
			May 14, 2007 at 1:07 am</a>		</div>

		<p>One trick I liked in Dos batch files is that you can have functions, you just need to simulate them with recursion, e.g.</p>
<p>if &quot;%1&quot;==&quot;/foo&quot; goto foo</p>
<p>if &quot;%1&quot;==&quot;/bar&quot; goto bar</p>
<p>@rem call function foo</p>
<p>call %0 /foo fooargs</p>
<p>@rem call function bar</p>
<p>call %0 /bar barargs</p>
<p>goto exit</p>
<p>:foo</p>
<p>@echo foo &#8211; args %2</p>
<p>goto exit</p>
<p>:bar</p>
<p>@echo bar &#8211; args %2</p>
<p>goto exit</p>
<p>:exit</p>
<p>The idea of a language which forces you to do this is oddly charming.</p>
<p>Though it turns out that in Windows, you can actually do this</p>
<p>@rem call function foo</p>
<p>call :foo fooargs</p>
<p>@rem call function bar</p>
<p>call :bar barargs</p>
<p>goto :EOF</p>
<p>:foo</p>
<p>@echo foo &#8211; args %2</p>
<p>goto :EOF</p>
<p>:bar</p>
<p>@echo bar &#8211; args %2</p>
<p>goto :EOF</p>
<p>Call now allows you to call labels as :label, and :EOF is a built in end of file label. Now that&#8217;s progress ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-504023">
				<div id="div-comment-504023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hayden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-504023">
			May 14, 2007 at 7:25 am</a>		</div>

		<p>CMD.EXE&#8217;s &quot;help&quot; command is a riot. Somebody has carefully (and reasonably completely) documented all of the cute and fun bits of the script language. It just most people don&#8217;t know it&#8217;s there (&quot;help&quot; on DOS5/6 wasn&#8217;t wildly useful) and some of the more magically useful bits aren&#8217;t where you might expect (PUSHD creating temporary drive mappings for UNC paths, for example).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504033">
				<div id="div-comment-504033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-504033">
			May 14, 2007 at 8:46 am</a>		</div>

		<p>Raymond is rejecting cygwin not on technical basis. It&#8217;s because his employer doesn&#8217;t want him to appreciate other vendors applications.</p>
<div class="post">[<i>You may notice that I don&#8217;t appreciate Microsoft applications either. I&#8217;m an equal-opportunity shunner. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-504173">
				<div id="div-comment-504173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-504173">
			May 14, 2007 at 11:51 am</a>		</div>

		<p>I think Raymond wasn&#8217;t &quot;rejecting&quot; CYGWIN, but if you read the linked article &quot;now you have two problems&quot; href=<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/03/22/558007.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/03/22/558007.aspx</a> all will be clear.</p>
<p>I hope the link works.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504273">
				<div id="div-comment-504273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Legolas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-504273">
			May 14, 2007 at 4:07 pm</a>		</div>

		<p>Hey thanks for this. I don&#8217;t think I realized that you could specify no delims at all by using that option, when I wrote my last batch file. Time to go back and see if this simplifies things, it might well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-504553">
				<div id="div-comment-504553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-504553">
			May 15, 2007 at 2:13 pm</a>		</div>

		<blockquote><p>
  Which supposes one already went through the bureaucracy to gain approval for installing software domain-wide
</p></blockquote>
<p>Not all corporate structures are completely hidebound. Installing something like perl shouldn&#8217;t be all that hard, given its long history and the rather minimal security risks of having it there when you aren&#8217;t using it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504643">
				<div id="div-comment-504643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">arnshea</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-504643">
			May 15, 2007 at 5:36 pm</a>		</div>

		<p>Thanks for the tip! &nbsp;Another one I&#8217;ve found useful is enabling delayed environment variable expansions (cmd /V:on). &nbsp;That plus xcopy /D makes selectively deploying directory contents across a network onto an XPe target a cinch.</p>
<p>For nostalgia they&#8217;re stored in c:bin. &nbsp;The XP command shell may not be bash but it&#8217;s got quite a few hidden gems for the &quot;not quite worth a program&quot; level of automation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-505373">
				<div id="div-comment-505373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ema</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-505373">
			May 17, 2007 at 4:09 am</a>		</div>

		<p>Ooc, I really like Raymond&#8217;s intellectual honesty&#8230;if every guy at his workplace were like him there where no FUD against other OSes and Windows would be a better product.</p>
<p>End of Ooc,</p>
<p>Cheers,</p>
<p>Ema! ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-507683">
				<div id="div-comment-507683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.personalblimp.com' rel='external nofollow' class='url'>Jim Vaglia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-507683">
			May 23, 2007 at 9:14 pm</a>		</div>

		<p>I didn&#8217;t receive Access with my copy of Office for XP so why did I receive a Microsoft Access security update? I removed Windows medea 6 security update so shouldn&#8217;t streams play just fine in other media players?</p>
<div class="post">[<i>Did you try using the <code>for</code> command? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-534983">
				<div id="div-comment-534983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.synesthesia.co.uk/blog/archives/2007/05/14/links-106/' rel='external nofollow' class='url'>Synesthesia &raquo; Links Roundup for 2007-05-14</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070511-00/?p=26893#comment-534983">
			August 10, 2007 at 8:04 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.synesthesia.co.uk/blog/archives/2007/05/14/links-106/" rel="nofollow">http://www.synesthesia.co.uk/blog/archives/2007/05/14/links-106/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>