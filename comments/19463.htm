<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (52)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-701563">
				<div id="div-comment-701563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">OB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701563">
			January 16, 2009 at 10:56 am</a>		</div>

		<p>The web service is as useless as the one that tells you why Windows Error Reporting knows your crash bucket.</p>
<p>It&#8217;s useless because people who try tried using it in the past got garbage results, and no longer bother to even try the feature.</p>
<p>I&#8217;ve attempted to use the web service, on a well known file type, because I knew that I needed to download software to run it and thought &quot;hey! there may actually be a use for this feature, for once!&quot; . &nbsp;Of course, After clicking the link and loading a browser and watching it redirect, I got an unhelpful response. I didn&#8217;t get download information, I didn&#8217;t get a description of the file type. Really, I didn&#8217;t get anything more than I would have done in the first place &#8211; load up the company website and search for the download link.</p>
<p>Now, I know that this will be blamed on the company that registered the link. Not Microsoft&#8217;s fault, right? &nbsp;Sorry, it&#8217;s your feature and you set the guidelines for its usage, and you are responsible for its experience.</p>
<p>I have to click through the web service choice dialog to get to my list of local apps (typically I&#8217;m on a &nbsp;machine that I haven&#8217;t associated .log with Notepad yet, for example), so the web service screen is useless to me, and even when it could be useful it does not provide any value.</p>
<p>It could conceivably be helpful to less experienced users. But it is not. They treat it as an error box and close it.</p>
<p>I know Microsoft has usability experts, but they really don&#8217;t have the influence they need to ensure that customers have positive interactions with the software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701573">
				<div id="div-comment-701573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pete</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701573">
			January 16, 2009 at 11:12 am</a>		</div>

		<p>How do you propose Microsoft forces developers to register their file extensions service? &nbsp;Should they refuse to let people develop software for windows if they arn&#8217;t very good at it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701583">
				<div id="div-comment-701583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Narr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701583">
			January 16, 2009 at 11:30 am</a>		</div>

		<blockquote><p>
  How do you propose Microsoft forces developers to register their file extensions service?
</p></blockquote>
<p>They could make it a logo requirement?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701593">
				<div id="div-comment-701593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701593">
			January 16, 2009 at 11:31 am</a>		</div>

		<p>What if it&#8217;s a proprietary format registered with <a rel="nofollow" target="_new" href="http://www.iana.org/assignments/media-types/" rel="nofollow">http://www.iana.org/assignments/media-types/</a> ? (Note, I&#8217;m not sure whether they ensure uniqueness of file extensions.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701633">
				<div id="div-comment-701633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701633">
			January 16, 2009 at 12:04 pm</a>		</div>

		<p>I would be happy as a pig in the mud if Windows 7 (or 8..) tracked mime types and used that to launch applications. &nbsp;Yes, I realize there&#8217;s a lot of technical problems with tracking metadata, especially when the file is sent across the network, but MS is full of smart people, I&#8217;m sure they could figure it out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701643">
				<div id="div-comment-701643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701643">
			January 16, 2009 at 12:05 pm</a>		</div>

		<p>That &quot;my software is the most important on Earth&quot; mentality is soo prevalent. Those resident &quot;update check&quot; programs (how about just using scheduler service?), popping up to foreground (hey, Internet Explorer, you won against those pesky people who crippled SetForegroundWindow), etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701663">
				<div id="div-comment-701663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tsrblke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701663">
			January 16, 2009 at 12:16 pm</a>		</div>

		<p>You could always just bundle your software with something else that people are going to need to download, that seems to be the hot ticket item these days.</p>
<p>You want <font color=red>Product&nbsp;X from company&nbsp;X</font>, how about <font color=red>Product&nbsp;Y from Company&nbsp;Y</font>. So team up with another world dominating company and just force your shovelware onto the computer (then you&#8217;ve pre-empted everything.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701673">
				<div id="div-comment-701673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701673">
			January 16, 2009 at 12:23 pm</a>		</div>

		<p>I have never used this feature in my life, but how are the results presented? &nbsp;If it&#8217;s alphabetical order, just name your company AAA Software. &nbsp;I imagine most people go for the first result.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701683">
				<div id="div-comment-701683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">79'er</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701683">
			January 16, 2009 at 12:52 pm</a>		</div>

		<p>Why cant Microsoft ATLEAST populate it with known programs. I mean, hell we all hear from Raymond how the appcompat team goes through great lengths to make sure popular software runs on the next version of windows. Why not add the known extensions to the list? Does not seem like a big ask to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701703">
				<div id="div-comment-701703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701703">
			January 16, 2009 at 1:11 pm</a>		</div>

		<p>Raymond, you must have hit a sore point today. &nbsp;I haven&#8217;t seen whining this bad since my brother (aged three at the time) didn&#8217;t get a tricycle for Christmas.</p>
<p>Not that Microsoft (or Raymond) needs defending, but you whiners need to realize that MS is a very large company with lots of divisions, and that there is no single person who knows everything about every product or service. &nbsp;Given the number of engineers working at MS and the number of new products and services being developed, it is simply impossible to enforce consistent engineering, quality and look &amp; feel standards across the entire company. &nbsp;Even then, budgetary restrictions mean that little-used products and services are simply not going to get the money needed to bring them up to the standard simply because there is little or no return on the investment.</p>
<p>Instead of whining and saying the product sucks, why not try something constructive like proposing ways to improve the product and submit them to the appropriate authority?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701713">
				<div id="div-comment-701713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrkMatter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701713">
			January 16, 2009 at 1:15 pm</a>		</div>

		<p>It could become quite a big ask, especially if you take into account the on-boarding process it would require from the companies distributing said known programs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701723">
				<div id="div-comment-701723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701723">
			January 16, 2009 at 1:35 pm</a>		</div>

		<p>@OB: &quot;I have to click through the web service choice dialog to get to my list of local apps&quot;</p>
<p>Wow! So, let&#8217;s see. Double-click the file, see the dialog appear, click once to select choosing it yourself, click OK. That&#8217;s wwaayyy too much work!</p>
<p>One double-click and two single ones! I can understand why it&#8217;s a problem for you; you&#8217;re afraid you&#8217;ll strain yourself.</p>
<p>@76&#8217;er: &quot;Why cant Microsoft ATLEAST populate it with known programs&quot;</p>
<p>OK. Populate a list of every known program on the planet that handles JPEG files, for viewing, creating, editing, manipulating, publishing, whatever. Nice short list, right?</p>
<p>Now, how do you order the list? Popularity? Company revenue? Alphabetically? Doesn&#8217;t matter. Somebody will complain because you listed their competitor first, or a product they don&#8217;t like, or a more expensive one, or one with a funny sounding name that they have trouble pronouncing, or some other ridiculous thing. Because people like to whine and complain about the most ridiculously stupid things. You know, like the people whining in the last couple threads about the file extension web service and dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701733">
				<div id="div-comment-701733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wang-Lo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701733">
			January 16, 2009 at 1:43 pm</a>		</div>

		<p>@Pete: &quot;Should [Microsoft] refuse to let people develop software for windows if they arn&#8217;t very good at it?&quot;</p>
<p>You mean, before being allowed to perform a procedure that could have a significant impact on the inescapable daily experience of tens of millions of people, a person would first need to demonstrate at least a minimum level of competence in his craft? &nbsp;</p>
<p>Have you any idea of the calibre of disaster such a novel concept might engender? &nbsp;Why, if such a program could be put into effect, there&#8217;s no telling where it might lead. &nbsp;Once software developers as a class are brought under control, who would be next? &nbsp;Would you want to test doctors and certify lawyers? &nbsp;Would plumbers and electricians need some sort of license?</p>
<p>What a freakin nightmare!</p>
<p>No. &nbsp;software development via total chaos has served us quite well for two decades. &nbsp;I think we&#8217;re better off leaving things as they are. &nbsp;</p>
<p>-Wang-Lo.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701743">
				<div id="div-comment-701743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701743">
			January 16, 2009 at 2:09 pm</a>		</div>

		<p>KenW: His complaint is not that &quot;it takes X number of clicks&quot;. &nbsp;His complaint, and I think it is valid, is that &quot;it takes X number of clicks when previously it only took X &#8211; Y number of clicks&quot;. &nbsp;I wonder if you would be so condescending if Microsoft changed Explorer to require an additional click when opening a directory or copying files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701753">
				<div id="div-comment-701753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mvadu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701753">
			January 16, 2009 at 2:22 pm</a>		</div>

		<p>&quot;Of course, things get exciting when a user installs both your program and the garage program, but that&#8217;s a conflict for the user to resolve. It is not your position to declare unilaterally that you are more important than that person in a garage.&quot;</p>
<p>I can only wish all developer read it, understand it, and implement it.</p>
<p>Day in and day out i come across so many softwareâ€™s which try to claim that they better know about an extension. Every picture viewwer claims they know JPEG better, every browser claims they know better about web pages etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701763">
				<div id="div-comment-701763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701763">
			January 16, 2009 at 2:38 pm</a>		</div>

		<p>Microsoft web service versus Google search&#8230;</p>
<p>Google wins.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701773">
				<div id="div-comment-701773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrismcb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701773">
			January 16, 2009 at 2:45 pm</a>		</div>

		<p>I&#8217;m in the process of release v2.1 of an app. My app handles about a dozen extensions. At install time if the extension is not already associated, I associate it to my program.</p>
<p>I also present a dialog, with checkboxes, and tell them what program that exe that extension is already associated with. I never overwrite an extension unless they tell me to.</p>
<p>Personally I see the biggest problem with the aforementioned website is its lack of knowledge. But Microsoft is letting the onus of updating it to the developers. Unfortunately this breaks down if the developers don&#8217;t know about the service. Personally I didn&#8217;t know I can request an update. I am already sending my application in.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701793">
				<div id="div-comment-701793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moritz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701793">
			January 16, 2009 at 3:27 pm</a>		</div>

		<p>I have a similar, yet different question, and I couldn&#8217;t find any information on it on the net:</p>
<p>If an application exclusively locks a file, I cannot rename or delete it, and Windows reports the file as locked, but doesn&#8217;t tell me which application keeps the lock. Adobe Reader is the only application I know that somehow manages to tell Windows that it has locked the file (and the Windows error messages tells the user) &#8211; how?!</p>
<p>Thanks :)</p>
<p>-a regular reader</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701803">
				<div id="div-comment-701803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701803">
			January 16, 2009 at 3:28 pm</a>		</div>

		<p>Wang-Lo, the medical and legal professions have been around for hundreds (thousands?) of years, and for most of that time they also existed with no rules or guidelines, or completely ass-backwards rules and guidelines.</p>
<p>The software profession is barely 50 years old. &nbsp;It stands to reason that any profession so immature is going to have a bit of a cowboy or artisan element. &nbsp;As software &quot;engineers&quot;, we simply don&#8217;t have the collective experience necessary to systematize the whole process. &nbsp;Some people believe it&#8217;s impossible; maybe they&#8217;re right, maybe they&#8217;re wrong, but regardless, you can&#8217;t very well force a bunch of standards and practices on an industry where there&#8217;s still so little consensus among experts.</p>
<p>What do you honestly think would happen if Microsoft decided (and found a way to enforce) that every piece of software written for Windows would have to pass through their own design and code review process before being permitted to run on a standard PC? &nbsp;My guess is public outcry, followed swiftly by a crack.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701813">
				<div id="div-comment-701813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701813">
			January 16, 2009 at 3:52 pm</a>		</div>

		<p>Mark &#8212; like IApplicationAssociationRegistrationUI? &nbsp;<a href="http://msdn.microsoft.com/en-us/library/bb776329.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/bb776329.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701823">
				<div id="div-comment-701823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701823">
			January 16, 2009 at 4:07 pm</a>		</div>

		<p>Moritz: Interesting. &nbsp;It seems that dialog is shown during SHFileOperation(). &nbsp;It appears as if the name of the locking program is shown only when called from Explorer. &nbsp;Perhaps Explorer has some internal housekeeping to support this. &nbsp;It doesn&#8217;t work for every program, but it does work for Microsoft Word.</p>
<p>Perhaps they are using some obscure Shell interface.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701833">
				<div id="div-comment-701833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hyacinth Bucket, pronounced 'Bouquet'</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701833">
			January 16, 2009 at 4:13 pm</a>		</div>

		<p>I&#8217;m quite sorry, but I refuse to allow my immaculate, high society application find itself in a list with common rapscallion executables. You can be assured that I will be calling my sister Violet to discuss this matter presently! You know Violet, she&#8217;s the one with a Mercedes, swimming pool and room for a pony.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701843">
				<div id="div-comment-701843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701843">
			January 16, 2009 at 4:18 pm</a>		</div>

		<p>Moritz and John &#8212; this is accomplished via IFileIsInUse, new in Vista. &nbsp;See this article for more information:</p>
<p><a rel="nofollow" target="_new" href="http://shellrevealed.com/blogs/shellblog/archive/2007/03/29/Your-File-Is-In-Use_2620_-Demystified.aspx" rel="nofollow">http://shellrevealed.com/blogs/shellblog/archive/2007/03/29/Your-File-Is-In-Use_2620_-Demystified.aspx</a></p>
<p>Actually, XP also supported this technique but not via IFileIsInUse; if the object in the ROT was a standard ole object (IOleObject), XP would use that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701853">
				<div id="div-comment-701853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moritz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701853">
			January 16, 2009 at 4:42 pm</a>		</div>

		<p>@Jonathan: Thanks for the enlightenment! I&#8217;ve actually seen this article, but thought that Adobe must do something differently, because it worked on XP. As you said, this is also explained in the referenced post.</p>
<p>Anyone skilled enough to write a &quot;wrapper&quot; that looks up the program (and registers in the ROT), if the application itself didn&#8217;t register itself in the ROT? :) There&#8217;s too little application support for this nice little effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701863">
				<div id="div-comment-701863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701863">
			January 16, 2009 at 5:32 pm</a>		</div>

		<p>Nice use of &quot;rapscallion&quot;; don&#8217;t see that one every day.</p>
<p>I just got done spending like 20 minutes debugging and disassembling SHFileOperation() and found all the running object table stuff. &nbsp;Sadly, I didn&#8217;t have anything better to do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701873">
				<div id="div-comment-701873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701873">
			January 16, 2009 at 6:01 pm</a>		</div>

		<p>@John, &quot;It seems that dialog is shown during SHFileOperation(). &#8230;. Perhaps they are using some obscure Shell interface.&quot;</p>
<p>The Shell team talks about to IFileIsInUse: &nbsp;<a rel="nofollow" target="_new" href="http://shellrevealed.com/blogs/shellblog/archive/2007/03/29/Your-File-Is-In-Use_2620_-Demystified.aspx" rel="nofollow">http://shellrevealed.com/blogs/shellblog/archive/2007/03/29/Your-File-Is-In-Use_2620_-Demystified.aspx</a></p>
<p>@Aaron G, &quot;The software profession is barely 50 years old.&quot;</p>
<p>Yeah, but can&#8217;t we learn from the other profession&#8217;s experience?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701883">
				<div id="div-comment-701883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701883">
			January 16, 2009 at 6:33 pm</a>		</div>

		<p>About listing companies alphabetically, and naming your company AAA Software: &nbsp;The site <a rel="nofollow" target="_new" href="http://www.microsoft.com/windows/antivirus-partners/windows-vista.aspx" rel="nofollow">http://www.microsoft.com/windows/antivirus-partners/windows-vista.aspx</a> lists several anti-virus vendors.</p>
<p>The order appears to be random, and each time you refresh the page, they are displayed in a different order.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701893">
				<div id="div-comment-701893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hobie-wan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701893">
			January 16, 2009 at 7:11 pm</a>		</div>

		<p>RE: John</p>
<p>Yeah, I get to deal with people all the time that have associated backups from our program with Adobe Acrobat because you can only open them from within the backup tool and didn&#8217;t get properly associated for double clicking. = /</p>
<p>RE: Moritz</p>
<p>Off topic, but google for &quot;unlocker&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701903">
				<div id="div-comment-701903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kaenneth</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701903">
			January 16, 2009 at 7:34 pm</a>		</div>

		<p>One of my many peeves is 3 letter extensions. You arn&#8217;t really limited to that anymore in Windows (.dvr-ms files for example), but because some software would choke horribly it&#8217;s best avoided.</p>
<p>For example, a web browser I found (not FF or IE) that when downloading a file would only consider the first three characters of an extension, so for a file named like &#8216;*.mpeg&#8217; it would look in the Windows file association table for &quot;.mpe&quot; (also ignoring the MIME types)</p>
<p>I found this was a fix for a previous buffer overrun vulnerability where a long extension would crash the browser.</p>
<p>Windows Media Player associates with .mpg, .mpeg, and .mpe, however, another popular media player only associates itself with .mpg and .mpeg files.</p>
<p>So, a user who is using multiple non-Microsoft clients, for browsing and playing media, and thinks they have their associations set properly, can click a &#8216;.mpeg&#8217; file, and seemingly have WMP &#8216;steal&#8217; the file association, when in fact it&#8217;s a combination of multiple flaws in the other software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-701913">
				<div id="div-comment-701913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701913">
			January 16, 2009 at 7:43 pm</a>		</div>

		<p>That&#8217;s not pre-emptively reserving a file extension. &nbsp;That&#8217;s exclusively reserving a file extension.</p>
<p>Pre-emptively reserving a file extension would be submitting the association before developing the app.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701603">
				<div id="div-comment-701603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701603">
			January 16, 2009 at 11:52 am</a>		</div>

		<p>Ben:</p>
<p>Uh, I&#8217;m pretty sure MIME types have nothing to do with file extensions. Some operating systems may use file extensions to try to calculate MIME types (remember, MIME types are for use on the heterogenous internet), but that&#8217;s almost certainly OS-dependent.</p>
<p>For instance, an attachment to an programatically generated email may not have a meaningful filename, let alone an extension, but it should have a MIME type describing what the data *is*.</p>
<p>Alternative methods of getting the MIME type might be to store it as metadata in the filesystem independently of the filename, or calculating the MIME type on-the-fly by inspecting the contents of the file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701923">
				<div id="div-comment-701923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701923">
			January 16, 2009 at 8:45 pm</a>		</div>

		<p>&quot;The web service is as useless as the one that tells you why Windows Error Reporting knows your crash bucket&quot;</p>
<p>You mean the service that told me my user&#8217;s bluescreens were caused by their wireless driver and linked me directly to the manufacturer&#8217;s download page for the update?</p>
<p>apart from anything else, i&#8217;m privately convinced a bluescreen that occurred with winpcap on my computer was only solved (obscure kernel memory bug) because I submitted feedback on that page</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701783">
				<div id="div-comment-701783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701783">
			January 16, 2009 at 3:17 pm</a>		</div>

		<p>I must say, a common control for associating extensions is *well* overdue. &nbsp;Anyone in Shell?</p>
<div class=post>[<i>I like how something that <a href="http://msdn.microsoft.com/en-us/library/cc144154(VS.85).aspx" rel="nofollow">already exists</a> can be bemoaned as overdue. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701933">
				<div id="div-comment-701933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">79'er</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701933">
			January 16, 2009 at 11:58 pm</a>		</div>

		<p>@KenW</p>
<blockquote><p>
  &gt;Now, how do you order the list? Popularity?</p>
<p>  &gt;Company revenue? Alphabetically? Doesn&#8217;t</p>
<p>  &gt;matter. Somebody will complain because you</p>
<p>  &gt;[snip]
</p></blockquote>
<p>You sound like a MS fanboi. The existing list has &quot;no particular older&quot;. So when MS populates it preemptively it will retain &quot;no particular order&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701943">
				<div id="div-comment-701943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701943">
			January 17, 2009 at 4:52 am</a>		</div>

		<blockquote><p>
  a person would first need to demonstrate at least a minimum level of competence in his craft?
</p></blockquote>
<p>They ALREADY do. Hey, Windows software programmers are rarely self-grown nerds. Usually, they come from a school or another and get interviews before being hired.</p>
<p>But that&#8217;s not enough to make high quality software.</p>
<p>Are per-project quality controls by usuability experts, i18n experts, graphics artists, etc. enough?</p>
<p>I don&#8217;t think so. I&#8217;m pretty sure Microsoft has those, but I (that&#8217;s subjective, I admit, but isn&#8217;t that the REAL problem?) find that Microsoft software isn&#8217;t significantly better or more finished than software of small companies without much quality control (e.g. Opera vs Internet Explorer).</p>
<p>One thing is sure: It makes software development very expensive.</p>
<p>Another thing: Quality of software is highly subjective. For example, in MY opinion, every recent Instant Messagery client violates any UI design principle that have ever been implicitly or explicitly designed. My sister don&#8217;t think so, and actually LIKE what I hate in those IM clients.</p>
<p>Another example: I don&#8217;t like that software be intimately integrated in the system (such as IE), making it hard to install several versions at a time, or uninstalling any of them, and letting other software depend on it. I like software provided as a single copy-able directory. But I&#8217;m sure that system integration is a quality REQUIREMENT for some teams.</p>
<p>What I like with MS Windows, and probably explains its success is that everybody can develop Windows software. Consequently we have much choice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-701963">
				<div id="div-comment-701963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701963">
			January 17, 2009 at 5:50 am</a>		</div>

		<p>Quoting chrismcb:</p>
<p>At install time if the extension is not already associated, I associate it to my program.</p>
<p>I also present a dialog, with checkboxes, and tell them what program that exe that extension is already associated with. I never overwrite an extension unless they tell me to.</p>
<p>End quote.</p>
<p>I believe 7zip is even more non-intrusive (in a painful way :-). The Windows version doesn&#8217;t even associate the &quot;.7z&quot; extension, you have to open the program and register it yourself via one of their dialogs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-701953">
				<div id="div-comment-701953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-701953">
			January 17, 2009 at 4:52 am</a>		</div>

		<p>&quot;One of my many peeves is 3 letter extensions. You arn&#8217;t really limited to that anymore in Windows (.dvr-ms files for example), but because some software would choke horribly it&#8217;s best avoided.&quot;</p>
<p>The &quot;some software&quot; includes the FindFirstFile() API, since you cannot depend on your customer having disabled 8dot3 on all their file systems and so a search for *.ext will deliver hits for *.ext4 (because it &quot;cleverly&quot; searches the 8dot3 aliases as well).</p>
<p>Result? You&#8217;re better off sticking to 3-letter extensions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-702003">
				<div id="div-comment-702003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702003">
			January 18, 2009 at 5:17 pm</a>		</div>

		<p>&quot;The Windows version doesn&#8217;t even associate the &quot;.7z&quot; extension, you have to open the program and register it yourself via one of their dialogs.&quot;</p>
<p>It kind of annoys me that the first time you run 7-Zip you&#8217;ve got to run it as an Administrator to do just that. Hopefully a newer version will support per-user file associations :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-702013">
				<div id="div-comment-702013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702013">
			January 18, 2009 at 5:48 pm</a>		</div>

		<p>The last thing we need is non-os &quot;reserved&quot; file extensions. Gawd, imagine if file extensions had been reserved since DOS (or even CP/M) days? Half of the readers of this blog would be asking why they have to save &quot;MyWork.@$%&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702023">
				<div id="div-comment-702023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702023">
			January 18, 2009 at 6:27 pm</a>		</div>

		<p>&quot;Another example: I don&#8217;t like that software be intimately integrated in the system (such as IE), making it hard to install several versions at a time, or uninstalling any of them, and letting other software depend on it.&quot;</p>
<p>Hear hear. &nbsp;As I type this, my IE installation is fundamentally broken (the Back dropdown doesn&#8217;t work, and I get an Automation error if I have the temerity to hit Ctrl-F), but my only option to try to repair it is to reinstall the whole OS (since I can&#8217;t reinstall IE alone). &nbsp;It&#8217;s just not worth it, so I installed a different browser.</p>
<p>&quot;The &quot;some software&quot; includes the FindFirstFile() API, since you cannot depend on your customer having disabled 8dot3 on all their file systems and so a search for *.ext will deliver hits for *.ext4 (because it &quot;cleverly&quot; searches the 8dot3 aliases as well). &nbsp;Result? You&#8217;re better off sticking to 3-letter extensions.&quot;</p>
<p>That doesn&#8217;t follow. &nbsp;In fact if you use longer filenames then *your* software is guaranteed not to find stray files with the wrong extension, since you&#8217;re searching for the longer one. &nbsp;It&#8217;s only those poor deluded applications still searching for three-letter extensions that will get into trouble. &nbsp;(And if you&#8217;re worried about those, just avoid some of the common prefixes and it&#8217;ll usually be fine.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-702383">
				<div id="div-comment-702383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">craigbarkhouse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702383">
			January 19, 2009 at 6:25 pm</a>		</div>

		<p>Gah, meant to say set the Win95TruncatedExtensions registry value to 0. &nbsp;The default is 1.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702303">
				<div id="div-comment-702303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702303">
			January 19, 2009 at 4:01 pm</a>		</div>

		<p>&quot;That doesn&#8217;t follow. &nbsp;In fact if you use longer filenames then *your* software is guaranteed not to find stray files with the wrong extension, since you&#8217;re searching for the longer one. &nbsp;It&#8217;s only those poor deluded applications still searching for three-letter extensions that will get into trouble.&quot;</p>
<p>Yes it&#8217;s a weak example, I admit, but the case that caught us was a batch file that happily trashed all *our* files as part of some random Act of Maintenance relating to the *other* application. Even once we&#8217;d figured it out, we had trouble explaining to the end-user that the computer hadn&#8217;t distinguished between *.ext and *.ext4 (or equivalent). After nearly 15 years of exposure to long filenames, getting users to understand the implications of short ones is pretty much impossible. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-702473">
				<div id="div-comment-702473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://brandonlive.com' rel='external nofollow' class='url'>Brandon Paddock</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702473">
			January 20, 2009 at 12:58 am</a>		</div>

		<p>This is why nobody should be using 3 letter extensions any more, and why all of our new MSFT formats are suffixed with &quot;-ms&quot; (like .search-ms, .searchConnector-ms, and .library-ms).</p>
<p>@Brian &#8211;</p>
<p>What do you mean that Windows should &quot;track mime types and use that to launch applications?&quot; &nbsp;Track MIME types where? &nbsp;That is, where does the MIME type come from? &nbsp;Files don&#8217;t have a way to tell the OS about that, except via the file extension. &nbsp;Well, that is unless they implement a property handler and return System.MIMEType. &nbsp;But how do you know which property handler to use? &nbsp;You would&#8217;ve had to know the MIME type in advance :)</p>
<p>Of course, if you click a link on a web page that returns a file with the MIME content type of &quot;image/jpeg&quot; &#8211; IE knows to create it with a .jpg extension. &nbsp;The server didn&#8217;t have to tell it to use that extension, it just knows (because of a MIME database that Windows keeps in the registry).</p>
<p>So in effect, Windows already tracks the MIME type and uses that to decide how to open a file that you downloaded. &nbsp;The extension is basically shorthand for the MIME type, it lets Windows tag the file with an identifier that essentially corresponds to a MIME type in a manner that doesn&#8217;t require new filesystem attributes to be created or troublesome alternate stream sort of solutions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702373">
				<div id="div-comment-702373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">craigbarkhouse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702373">
			January 19, 2009 at 6:23 pm</a>		</div>

		<p>Ken Hagan:</p>
<p>&#8216;The &quot;some software&quot; includes the FindFirstFile() API, since you cannot depend on your customer having disabled 8dot3 on all their file systems and so a search for *.ext will deliver hits for *.ext4 (because it &quot;cleverly&quot; searches the 8dot3 aliases as well).&#8217;</p>
<p>Actually, even if you disable 8dot3 (set the NtfsDisable8dot3NameCreation registry value to 1), a FindFirstFile() will still match .ext4 files to the pattern *.ext. &nbsp;This is due to an insane backwards-compatibility feature called Windows 95 Truncated Extensions. &nbsp;To restore sanity, set the Win95TruncatedExtensions registry value to 1, in the same place as NtfsDisable8dot3NameCreation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-702483">
				<div id="div-comment-702483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702483">
			January 20, 2009 at 3:39 am</a>		</div>

		<p>&lt; Of course, if you click a link on a web page that returns a file with the MIME content type of &quot;image/jpeg&quot; &#8211; IE knows to create it with a .jpg extension. &nbsp;The server didn&#8217;t have to tell it to use that extension, it just knows (because of a MIME database that Windows keeps in the registry).</p>
<p>So in effect, Windows already tracks the MIME type and uses that to decide how to open a file that you downloaded. &gt;</p>
<p>IE is not windows; in order for windows to do this thing, it would have to be a documented and supported API &#8211; something that allows you to put in &#8216;image/jpeg&#8217; and get back a list of extensions (default first, i guess), get a short list of handlers for that type, and map from extension to type. This last thing fixes some of the problems with .mpg, .mpeg, and .jpg/.jpeg, but that&#8217;s actually fairly uncommon. Regardless, IE does this, not windows. If windows did it, I could write an app and associate it to image/jpeg instead of a small list of images. I could also do things like image/*, which is a reasonable thing for photoshop to do.</p>
<p>What I find odd (speaking of filesystem stuff) is that windows has had support for symlinks for years (via the join command), but doesn&#8217;t seem interested in adding tool support. symlinks are ridiculously useful, but use them at your peril in windows &#8211; deleting one in explorer behaves wrong in two distinct ways, depending on what&#8217;s in the destination.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702653">
				<div id="div-comment-702653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702653">
			January 20, 2009 at 1:56 pm</a>		</div>

		<p>@craigbarkhouse</p>
<p>&quot;To restore sanity, set the Win95TruncatedExtensions registry value to 1, in the same place as NtfsDisable8dot3NameCreation.&quot;</p>
<p>Thanks. I&#8217;d no idea. Next question: D&#8217;ya think it would be OK to force that value on all our customer systems as part of our installer? (Ducks for cover.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-702663">
				<div id="div-comment-702663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702663">
			January 20, 2009 at 1:59 pm</a>		</div>

		<p>In fact&#8230; (sorry, I should have included this in my previous reply)</p>
<p>Are these registry keys ever useful? As far as I can see, software vendors cannot depend on their presence and end-users cannot know whether they are needed or not. Therefore, it is never safe to change them from the defaults.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702803">
				<div id="div-comment-702803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702803">
			January 20, 2009 at 6:50 pm</a>		</div>

		<p>Personally, I think an app should be utterly forbidden from changing that setting, but might want to *read* it and change its behaviour accordingly. &nbsp;(eg. if it&#8217;s searching for HTML files, using *.htm will normally catch both .htm and .html files, but if the setting is changed then it&#8217;ll know it has to ask for both separately.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-702873">
				<div id="div-comment-702873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://brandonlive.com' rel='external nofollow' class='url'>Brandon Paddock</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702873">
			January 21, 2009 at 3:33 am</a>		</div>

		<p>@Cooney &#8211;</p>
<p>Well, as I said, there&#8217;s no good convention for a file to identify itself as being of a certain MIME type, *other* than by its file extension.</p>
<p>Keying off of the MIME type isn&#8217;t specific to IE, though. &nbsp;The wininet / URLMON APIs do this (and I&#8217;m guessing WinHTTP does as well). &nbsp;In Windows 7, the shell uses MIME content type as the most common indicator of how to handle a file returned from an OpenSearch data source. &nbsp;Of course it does so by mapping the server specified MIME type to an extension.</p>
<p>I agree it might be nice to be able to register handlers based on MIME type instead of extension. &nbsp;It&#8217;s something we&#8217;ve looked at in the past, and may look at again some day.</p>
<p>You can already go from a file extension to a MIME type using the shell APIs. &nbsp;You simply get the IQueryAssociations for the association element (in this case, the file extension you care about) and ask for ASSOCSTR_CONTENTTYPE. &nbsp;</p>
<p>Or you can use the FindMimeFromData API (a URLMON function).</p>
<p>I&#8217;m less sure about APIs for going the other way. &nbsp;I think GetClassFileOrMime might be helpful in some cases. &nbsp;Otherwise you can just read the Extension value from the HKEY_CLASSES_ROOTMIMEDatabaseContent Type&lt;MIME TYPE GOES HERE&gt; key.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702963">
				<div id="div-comment-702963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-702963">
			January 21, 2009 at 1:00 pm</a>		</div>

		<p>&quot;Personally, I think an app should be utterly forbidden from changing that setting, &#8230;&quot;</p>
<p>The easiest way to enforce that is not to have added the entry in the first place. Meanwhile, back in the real world&#8230;</p>
<p>&quot;&#8230; but might want to *read* it and change its behaviour accordingly. &nbsp;(eg. if it&#8217;s searching for HTML files, using *.htm will normally catch both .htm and .html files, but if the setting is changed then it&#8217;ll know it has to ask for both separately.)&quot;</p>
<p>So because the entry exists, we have to code for both possibilities, but cannot (reasonably) exploit either for our own benefit. Gee, thanks!</p>
<p>I suppose you could take the view that turnkey systems based on Windows, where every app is vetted by the vendor, the vendor could choose to enable one of these settings during installation, and then depend on it remaining set because they totally control the entire system configuration.</p>
<p>Conversely, you could take the view that any system with third party apps cannot presume such total control and must therefore leave the setting at its default value. Therefore, all third party apps can reasonably assume the default behaviour.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-703163">
				<div id="div-comment-703163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WebDancer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-703163">
			January 22, 2009 at 7:59 am</a>		</div>

		<p>@Ken:</p>
<p>Users, and e.g. domain admins, should be able to change this. Applications/installers should NOT change system settings, and definitely not a setting with this kind of impact.</p>
<p>Application should try to handle the environment they live in, and not &quot;fix&quot; bad programming with system tweaking! But if an app would function better with a particular setting, it could help the user configure it, after a proper warning/explanation of the (side-)effects.</p>
<p>Only really bad apps assume &quot;default&quot; settings, like e.g. the color of UI elements. And they are some of the reasons why your app should not (secretly) change system behaviour; the users must be aware of, and accept, the effects of this (good and bad).</p>
<p>On the other hand, knowing <em>all</em> settings which might affect your app can be quite difficult, especially when they are not even mentioned in the documentation (for e.g. FindFirstFile()).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-703283">
				<div id="div-comment-703283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090116-00/?p=19463#comment-703283">
			January 22, 2009 at 5:47 pm</a>		</div>

		<p>&quot;On the other hand, knowing <em>all</em> settings which might affect your app can be quite difficult, especially when they are not even mentioned in the documentation (for e.g. FindFirstFile()).&quot;</p>
<p>Well exactly. I&#8217;m right with you on the &quot;apps should try to handle the environment they are given&quot;, but there comes a point when something is so obscure that there&#8217;s no chance of applications doing so. When that happens, even the owner of the system (your domain admin or whatever) daren&#8217;t risk changing the setting, so it becomes essentially useless.</p>
<p>The &quot;ChangeNotify&quot; privilege is another example. Almost all the documentation I&#8217;ve ever seen (MS and third-party) says &quot;For heaven&#8217;s sake don&#8217;t deny this privilege from any users you care about!&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>