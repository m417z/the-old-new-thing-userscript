<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-569723">
				<div id="div-comment-569723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">yellow</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-569723">
			November 23, 2007 at 11:45 am</a>		</div>

		<p>MenuHelp isn&#8217;t that bad, and if there&#8217;s nothing more to GetEffectiveClientRect then what you wrote, then I guess it&#8217;s not that bad either. Sure I could do those things myself, but IMHO there&#8217;s next to no advantage.</p>
<p>Regedit uses MenuHelp, and it seems not to be bothered by any menu index problems. IMHO why would GetEffectiveClientRect be awful if it can be useful (only) when combined with ShowHideMenuCtl? These functions can accomplish fairly common tasks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569793">
				<div id="div-comment-569793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Narcolepsy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-569793">
			November 23, 2007 at 1:47 pm</a>		</div>

		<p>I suppose it might be allright.</p>
<p>If you&#8217;ve got a group of bars, each of which sits in a tray, and contain controls/windows of their own, there&#8217;s almost no need to use it.</p>
<p>The bigger task is working out;</p>
<p>The size of the tray from a group of dynamic bar positions.</p>
<p>If the floating bar is in a sensible location to be dropped onto the tray.</p>
<p>If the bar is going to be dropped, it&#8217;s location in the tray.</p>
<p>If the tray can be sized to fit a bar on the basis of a given client window.</p>
<p>(Don&#8217;t mention activation)</p>
<p>By the time that&#8217;s all done, working out why there&#8217;s additional padding seems almost trivial&#8230;. Crazy maybe&#8230;.. In fact, what they hey, I already have that darn client rect, I&#8217;ll just grab it and use it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569813">
				<div id="div-comment-569813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-569813">
			November 23, 2007 at 3:13 pm</a>		</div>

		<p>a truly obscure function with a documentation so spartan, it really doesn&#8217;t want to be used&#8230;</p>
<p>I don&#8217;t understand this bit in your article:</p>
<p>&quot;The first two integers in the array are ignored.&quot; That&#8217;s not at all in the MSDN doc</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569883">
				<div id="div-comment-569883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-569883">
			November 23, 2007 at 9:38 pm</a>		</div>

		<p>From MSDN article of ShowHideMenuCtl():</p>
<p>The second value in the first pair must be the handle to the application&#8217;s main menu.</p>
<p>If these two function are designed to work together, I&#8217;d think the first two parameters are hardly irrelevant. (It make sense to also subtract menu area from effective client area, doesn&#8217;t it?)</p>
<p>On a second thought, Vista has changed so that menus are invisible until you press &quot;Alt&quot;, perhaps that changes the &quot;formula&quot; for GetEffectiveClientRect()?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569933">
				<div id="div-comment-569933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-569933">
			November 24, 2007 at 8:29 am</a>		</div>

		<p>Choeng: That isn&#8217;t Vista so much as Explorer and IE7.</p>
<p>If other programs want that behaviour then they have to be changed to have it, so APIs like the one in question are unlikely to have changed. (It would break a lot if they did.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569963">
				<div id="div-comment-569963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">overlord pebkac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-569963">
			November 24, 2007 at 11:49 am</a>		</div>

		<p>It would be a support nightmare too. Heck, I&#8217;d be puzzled for a while by the new behaviour myself.</p>
<p>But if there are for instance 2 gadgets at the bottom, like a status bar and a static, would this function be called twice, in practise? Once to determine where the static goes, and once more to determine what&#8217;s really left?</p>
<p>Much thanks BTW for extensively documenting this function in a clear way. Too bad the MSDN doc says it&#8217;s deprecated, which could mean that this function gets dropped sometime. Though maybe (if I&#8217;ll use the 2 functions) I could copy the wine version into my project, since I&#8217;m writing free software anyway ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-570003">
				<div id="div-comment-570003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-570003">
			November 24, 2007 at 10:42 pm</a>		</div>

		<p>&quot;It would be a support nightmare too. Heck, I&#8217;d be puzzled for a while by the new behaviour myself.&quot;</p>
<p>That reminds me of an unrelated something&#8230; for a while Safari for Windows lost it&#8217;s titlebar. &nbsp;There was space for it but no text, and clicking did nothing (using ALT and arrow keys seemed to work and made menus drop down from nowhere). &nbsp;That was odd. &nbsp;It seems fixed in the latest version though.</p>
<p>Narc: I imagine this function was designed well before the more complex rebar control (which is even less complex than the docking toolbar stuff you&#8217;re describing). &nbsp;But it should still work ok&#8230; as long as you recall it every time something happens that would change the size of a docked control, in order to get the new ClientRect. &nbsp;Of course, this isn&#8217;t as simple a scenario as using it with a simple toolbar and statusbar with ShowHideMenuCtl&#8230; in fact you probably wouldn&#8217;t use ShowHideMenuCtl on a rebarband or floating toolbar dock area, just the individual bars (and I would have no clue if that function would even work).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-570053">
				<div id="div-comment-570053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shantanu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-570053">
			November 26, 2007 at 12:50 am</a>		</div>

		<p>Hi,</p>
<p>The following MSDN page:</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/EN-US/library/bb775674.aspx" rel="nofollow">http://msdn2.microsoft.com/EN-US/library/bb775674.aspx</a></p>
<p>&#8230; mentions the following</p>
<p>&quot;The first control (first two INTs in lpInfo) is skipped completely. Pass two zeros.&quot;</p>
<p>The part about the first two INTs being ignored should probably be mentioned in the main doc!!! :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-570433">
				<div id="div-comment-570433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Donnelly (MSFT)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-570433">
			November 26, 2007 at 3:07 pm</a>		</div>

		<p>&#8212; The part about the first two INTs being ignored should probably be mentioned in the main doc!!! &#8212;</p>
<p>Consider it done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-571013">
				<div id="div-comment-571013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shantanu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071123-00/?p=24403#comment-571013">
			November 27, 2007 at 2:27 am</a>		</div>

		<p>&lt;quote&gt;</p>
<p>Consider it done.</p>
<p>&lt;/quote&gt;</p>
<p>&quot;Thanks!&quot; :)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>