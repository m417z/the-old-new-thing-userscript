<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (27)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-351173">
				<div id="div-comment-351173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AsmGuru62</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351173">
			March 2, 2006 at 12:35 pm</a>		</div>

		<p>I am not sure, but &quot;(HMENU) 0&quot; is suspicious. The control ID (child window ID) should not be zero.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351203">
				<div id="div-comment-351203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351203">
			March 2, 2006 at 1:26 pm</a>		</div>

		<p>[quote]<br />
<br />I&#8217;ve written Windows code, and I don&#8217;t know the particulars of WM_COMMAND.<br />
<br />[/quote]</p>
<p>Looks like Windows code you&#8217;ve writen was a bunch of &quot;declare sub&quot; in VB, dude.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351213">
				<div id="div-comment-351213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351213">
			March 2, 2006 at 1:34 pm</a>		</div>

		<p>JD: There are 2 basic types of questions that beginners tend to ask.</p>
<p>One is &quot;How do I do X?&quot; In that case, the user knows what he wants to do but simply doesn&#8217;t know where to look, and a quick redirect to the correct term or page of documention (i.e. &quot;look up WM_COMMAND in MSDN&quot;) will solve the problem. Even with 20 years of experience I still need to ask these questions when learning a new environment or language.</p>
<p>The other question is &quot;Why isn&#8217;t X working?&quot; Sometimes X is difficult, even for non-beginners. In this case though, he knew that WM_COMMAND was what he needed, he just seemingly ignored all the documentation for it.</p>
<p>What I&#8217;m interested in, though, is how this differed in 16-bit Windows. Back then WPARAMs were actually word-length, so they didn&#8217;t have a high word. How did WM_COMMAND work, or what was it used for, then?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351243">
				<div id="div-comment-351243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lolerskatez!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351243">
			March 2, 2006 at 1:52 pm</a>		</div>

		<p>Im 13373r than j00 a11! Wargh check out ma size of ma controlz!</p>
<p>ROFLCOPTER!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351263">
				<div id="div-comment-351263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351263">
			March 2, 2006 at 2:05 pm</a>		</div>

		<p>Gabe, in Win16 32-bit LPARAM contained both control handle and notification code &#8211; it was possible because handles were 16-bit. LOWORD(lParam) was handle, HIWORD(lParam) was notification code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351273">
				<div id="div-comment-351273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351273">
			March 2, 2006 at 2:06 pm</a>		</div>

		<p>Give a man a fish and he&#8217;ll eat for a day.<br />
<br />Try to teach a man to fish and he&#8217;ll bitch at you for not just giving him the fish.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351283">
				<div id="div-comment-351283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351283">
			March 2, 2006 at 2:13 pm</a>		</div>

		<p>Mike:<br />
<br />&quot;Try to teach a man to fish and he&#8217;ll bitch at you for not just giving him the fish.&quot;<br />
<br />Thanks for the laugh! You are so right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351293">
				<div id="div-comment-351293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351293">
			March 2, 2006 at 2:30 pm</a>		</div>

		<p>You&#8217;ve just made it more confusing, it doesn&#8217;t happen much, and I don&#8217;t like to admit it, but this time the MSDN docs are more clear then yours.</p>
<p>Now that we&#8217;re restating the obvious anyway and I&#8217;m confused&#8230; That the WM_COMMAND from a clicked button &quot;smells like&quot; a menu selection is very useful. But to make it almost exactly the same instead of havig it smell like it, the same ID?_* has to be used for both the accelerator and the button control&#8230; Right?</p>
<p>And I could not find any information on TrackPopupWindow. I tried this:<br />
<br /><a rel="nofollow" target="_new" href="http://search.msdn.microsoft.com/search/results.aspx?qu=TrackPopupWindow&amp;View=msdn&amp;st=b&amp;c=4&amp;s=1&amp;swc=4" rel="nofollow">http://search.msdn.microsoft.com/search/results.aspx?qu=TrackPopupWindow&#038;View=msdn&#038;st=b&#038;c=4&#038;s=1&#038;swc=4</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351303">
				<div id="div-comment-351303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351303">
			March 2, 2006 at 2:46 pm</a>		</div>

		<p>I guess TrackPopupWindow should be TrackPopupMenu[Ex] instead.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351313">
				<div id="div-comment-351313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jay B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351313">
			March 2, 2006 at 4:32 pm</a>		</div>

		<p>You know&#8230; sometimes even the blatantly obvious can stare you in the face and you overlook it. &nbsp;It happens to everyone at one time or another.</p>
<p>Sometimes it just helps to have a fresh set of eyes look at something. &nbsp;Sometimes its good to leave a problem alone for a bit and come back to it with your own fresh set of eyes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351323">
				<div id="div-comment-351323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Moorhouse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351323">
			March 2, 2006 at 5:25 pm</a>		</div>

		<p>I know jack about Win32, but I love trying to solve these. Who needs the Times&#8217; crossword when you have Raymond and Larry? The downside is that I am usually the first to get caught in labrynthine snarl that is MSDN.</p>
<p>Three failure points occur to me:<br />
<br />1)Russell expects the control ID in the notification to be 0, and it&#8217;s not. (HMENU) 0 may somehow transform into 1000, I don&#8217;t know and I&#8217;m having trouble finding out. Looks like a cast to me. At any rate, while there may be reasons not to use 0 here, it doesn&#8217;t say so in the linked documentation.</p>
<p>2)Russell is expecting the ID to appear in the HIWORD of the wParam. It comes in the LOWORD. This is mentioned in the linked documentation, and Raymonds reaction seems to imply that this is the problem.</p>
<p>3)Russell is, as he states, listening in the wrong place for this message. He&#8217;s trying to have it recieved by the combobox, when it&#8217;s the combobox&#8217;s parent that should be recieving it. This isn&#8217;t terribly clear from the linked documentation; it seems to be saying that WM_COMMAND is a seperate message that is sent when a control sends some other message to it&#8217;s parent.</p>
<p>If you read the rest of the thread, #2 turns out not to be the problem, that is just a typo in Russell&#8217;s post (or so he claims). #3 appears to be the issue. He would have found this out if he&#8217;d read the docs for CBN_SELENDOK more carefully, but that&#8217;s not what Raymond posted. Raymond is either being overly subtle about his sarcasm (very likely), or he didn&#8217;t read the whole thread.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-351343">
				<div id="div-comment-351343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351343">
			March 2, 2006 at 5:36 pm</a>		</div>

		<p>The problem is #3, as Norman Bullen pointed out later in the thread:<br />
<br /><a rel="nofollow" target="_new" href="http://groups.google.com/group/comp.os.ms-windows.programmer.win32/msg/c2d8d7e6d9588b3b" rel="nofollow">http://groups.google.com/group/comp.os.ms-windows.programmer.win32/msg/c2d8d7e6d9588b3b</a></p>
<p>The very first sentence of the WM_COMMAND documentation says that WM_COMMAND is sent &quot;when a control sends a notification message to its parent window&quot;. If you think this could be made clearer, please elaborate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-351363">
				<div id="div-comment-351363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351363">
			March 2, 2006 at 6:45 pm</a>		</div>

		<p>But it isn&#8217;t &quot;the&quot; notification message sent by a control to its parent. There are other notifications such as WM_NOTIFY and WM_PARENTNOTIFY.</p>
<p>And how would that fit into the rest of the sentence? Don&#8217;t forget the menu and accelerator scenarios in the intro blurb.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351373">
				<div id="div-comment-351373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Moorhouse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351373">
			March 2, 2006 at 6:46 pm</a>		</div>

		<p>&quot;A telegram is sent when we draw your ticket, when we send a telegram to the winner after judging all entries, or when all other contestants are eliminated.&quot;</p>
<p>How is it obvious to us that the subject of the sentence (the telegram in the main clause) is the same thing as the subject(?) of the second conditional clause (the telegram to the winner)? If they are indeed the same thing, why mention them seperately? The fact that that sentence in the documentation metions the word &quot;message&quot; twice similarily raises the possibility, in my mind, that we&#8217;re talking about two seperate messages.</p>
<p>I get the feeling that the obviousness of this solution to Russell&#8217;s problem lies, as you say, in the context of the Win32 API. Someone familiar with its ins and outs is likely saying &quot;Of course it&#8217;s the same message! What other message could there possibly be?&quot; at this point. But where else can someone with less experience turn to when unfamiliar with this message and its context?</p>
<p>What Russell did miss was the third sentence of the documentation of the CBN_SELENDOK, which more clearly indicates that the one is wrapped within the other. That&#8217;s what cleared this up for me, even before I read the remainder of the thread.</p>
<p>I feel really nervous about offering advice here, but since you asked, I&#8217;m gonna. It may be possible to reduce confusion by dropping the word &#8216;message&#8217; in reference to the notification enclosed in the WM_COMMAND (or even replace &#8216;message&#8217; with &#8216;code&#8217;, so as to match the documentation in the wParam parameter), but there may be naming conventions or rules in place that would make this a less than optimal solution. We might do better to use an extra sentence or two instead.</p>
<p>&quot;The WM_COMMAND message is sent when the user selects a command item from a menu or when an accelerator keystroke is translated. It is also the message sent to a control&#8217;s parent window when certain actions are taken on that control; in this case the WM_COMMAND message encloses a notification code related to that action.&quot;</p>
<p>This probably violates all sorts of naming specs and conventions. Just thought I&#8217;d try.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351393">
				<div id="div-comment-351393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.delovski.hr' rel='external nofollow' class='url'>Igor Delovski</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351393">
			March 2, 2006 at 7:41 pm</a>		</div>

		<p>As I was learning this from Petzold, I had to draw myself some sort of spreadsheet to understand it.</p>
<p>My wm_command handler starts like this:</p>
<p>static int &nbsp;StdOnWM_Command (HWND hwnd, WPARAM wParam, LPARAM lParam)<br />
<br />{<br />
<br /> &nbsp; short &nbsp; &nbsp; &nbsp; wNotifyCode = HIWORD (wParam); &nbsp; // notification code, 0 if menu, 1 if accel<br />
<br /> &nbsp; short &nbsp; &nbsp; &nbsp; item_id &nbsp; &nbsp; = LOWORD (wParam); &nbsp; // item, control, or accelerator identifier<br />
<br /> &nbsp; HWND &nbsp; &nbsp; &nbsp; &nbsp;ctlHwnd &nbsp; &nbsp; = (HWND) &nbsp;lParam; &nbsp; &nbsp;// handle of control, NULL if menu</p>
<p>&#8230;</p>
<p>plus, there&#8217;s something I did not expect until it bite me: edit box recieves notifications during its creation, but if you don&#8217;t have everything set up and initialized &nbsp;properly at the time, it can produce random crashes.</p>
<p>It drove me crazy!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351403">
				<div id="div-comment-351403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Delovski</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351403">
			March 2, 2006 at 7:47 pm</a>		</div>

		<p>&#8230; edit box recieves above mentioned notification on WM_CREATE only if it has initial text.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351193">
				<div id="div-comment-351193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351193">
			March 2, 2006 at 1:15 pm</a>		</div>

		<p>LOL</p>
<p>OMG that Russell didn&#8217;t even *read* MSDN on WM_COMMAND! It says right there &quot;The high-order word specifies the notification code if the message is from a control&quot; and he&#8217;s passing (HMENU) 0! &nbsp;Haha! Talk about missing the obvious!</p>
<p>ROFLMAO</p>
<p>Is that the response you&#8217;re looking for? Raymond, you&#8217;re an &#8230; well you clearly demonstrate the old-skool Win32 devs who look down on devs who make mistakes.</p>
<p>Very little of what you wrote above is &quot;obvious&quot; in the sense that normal people in this world use the term. Perhaps you have been working with the Windows APIs for over a decade and this is second nature to you, and you have had to debug and diagnose problems due to developers who made these kinds of mistakes, and that has made you insensitive.</p>
<p>I&#8217;ve written Windows code, and I don&#8217;t know the particulars of WM_COMMAND. The info you laid out above is useful, and not directly obvious from the MSDN article. A nice table illustrating the three scenarios (control, menu, accelerator) and what they fill in the params with would be an improvement to the article and make it more &#8216;obvious&#8217;.</p>
<p>Sure it&#8217;s easy to say &quot;RTFM n00b, it&#8217;s right freaking there&quot; and bemoan how these people should be doing their homework and *thinking* through the problem. But from the question it seems that Russell (&#8216;this person&#8217;) did do some due diligence and has simply barked up the wrong tree.</p>
<p>Your insight here was welcome and use, the attitude that this is belaboring the obvious (and implying that it&#8217;s a waste of your time to impart such wisdom directly to the plebes) is odious and reflects badly on you.</p>
<p>Why does it make you feel better to hand out some condescention (OMG did I spell that wrong?) with the fishing pole when someone asks for a fish? I guess you&#8217;re the drill sargeant (lol learn2spell, n00b) whose rough on his men but earns their respect? Do continue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351353">
				<div id="div-comment-351353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351353">
			March 2, 2006 at 6:35 pm</a>		</div>

		<p>How about &quot;WM_COMMAND *is* the notification message sent by a control to its parent window&quot;. &nbsp;No ambiguity there. &nbsp;There&#8217;s definitely ambiguity in the MSDN statement, although I think most people will parse it correctly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351463">
				<div id="div-comment-351463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351463">
			March 3, 2006 at 7:10 am</a>		</div>

		<blockquote><p>
  Simulating a menu selection is exactly the<br />
  <br />&gt; same, except that (according to the rules<br />
  <br />&gt; above), you set the high-order word of the<br />
  <br />&gt; wParam to zero.</p>
<p>That&#8217;s obvious if you have some way of knowing which of the above rules is the obvious one to add an invisible phrase to. &nbsp;If you guess wrong about which rule, you might not even add an invisible phrase, you might just obey the rule where you have to say which control is sending the message. &nbsp;The invisible phrase that needs adding is exactly this, &quot;Simulating a menu selection, you set the high-order word of the wParam to zero&quot;.</p>
<p>Another needed addition to the page on WM_COMMAND would say &quot;(except when the notification is sent by WM_NOTIFY or other message, as described in documentation for the individual control)&quot;.</p>
<p>Also a bunch of pages on notification-style notifications need some editing in order to distinguish the constant as a constant, and say what typedef identifier has to be used in declaring a variable. &nbsp;I copied some stuff from the MSDN page on one notification (forgot which one, sorry) and it wouldn&#8217;t compile because the stated syntax resulted in using a constant as a typename. &nbsp;I never did find out what the correct name of the typedef identifier was. &nbsp;I gave up and found some other way to code around it. &nbsp;Later I noticed a bunch of descriptions of notifications suffer from the same writing style.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-351513">
				<div id="div-comment-351513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351513">
			March 3, 2006 at 11:43 am</a>		</div>

		<p>Norman, please be specific. Where do you want the parenthetical remark added? Where are the &quot;bunch of pages&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351643">
				<div id="div-comment-351643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351643">
			March 5, 2006 at 5:22 pm</a>		</div>

		<p>It doesn&#8217;t have to be a parenthetical. Just explain as you did here. Or put in a small table:</p>
<p>MESSAGE SOURCE: Menu<br />
<br />WPARAM (high part): 0<br />
<br />WPARAM (low part): IDM code for menu<br />
<br />LPARAM: 0</p>
<p>MESSAGE SOURCE: Accelerator<br />
<br />WPARAM (high part): 1<br />
<br />WPARAM (low part): IDM code for accelerator<br />
<br />LPARAM: 0</p>
<p>MESSAGE SOURCE: Control<br />
<br />WPARAM (high part): notification code (defined by control)<br />
<br />WPARAM (low part): Control ID<br />
<br />LPARAM: handle to control window</p>
<p>Quibble about the wording if you want, but a table makes this clearer that there are threee cases and which params are what. Parsing it is much easier than parentheticals or trying to change a word or two. &nbsp;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351663">
				<div id="div-comment-351663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351663">
			March 5, 2006 at 10:58 pm</a>		</div>

		<p>Friday, March 03, 2006 11:43 AM by oldnewthing</p>
<p>&gt; Norman, please be specific. Where do you<br />
<br />&gt; want the parenthetical remark added?</p>
<p>Thank you for your interest. &nbsp;I think that the MSDN page on WM_COMMAND is not as obvious as you think it is, for the reasons I stated. &nbsp;I already did run into problems and got help from MVPs (or maybe one MVP and one other ordinary newsgroup participant). &nbsp;They explained that when simulating a menu invocation we have to disobey the instructions about saying which control sent the command, we have to make it look as though the command came from the menu not from the control. &nbsp;When reading your posting and seeing that you cited someone else with a variation on the same problem, I was relieved to see I wasn&#8217;t the only one.</p>
<p>&gt; Where are the &quot;bunch of pages&quot;?</p>
<p>Various notification messages from individual controls. &nbsp;MSDN has subsections on individual controls, including subsubsections on the messages, notifications, structures, etc. for each individual controls. &nbsp;Each notification gets its own page. &nbsp;A bunch of them confuse constants (a numeric value saying which kind of notification) with datatypes (what kind of structure is pointed to by a pointer), and in one case I never could figure out what the datatype was supposed to be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-351683">
				<div id="div-comment-351683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351683">
			March 6, 2006 at 2:50 am</a>		</div>

		<p>&quot;when simulating a menu invocation we have to disobey the instructions about saying which control sent the command, we have to make it look as though the command came from the menu not from the control.&quot;</p>
<p>Um, the rule about which control sent the command doesn&#8217;t apply if you want to simulate a menu action; it applies if you want to simulate a control, which you aren&#8217;t. If you want to simulate a menu, then follow the menu rules. You&#8217;re not disobeying anything.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-351693">
				<div id="div-comment-351693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351693">
			March 6, 2006 at 4:05 am</a>		</div>

		<p>} lParam<br />
<br />} Handle to the control sending the message if<br />
<br />} the message is from a control. Otherwise,<br />
<br />} this parameter is NULL.</p>
<p>Handle to the control sending the message if the message is from a control (except if the message is a simulated menu command even when it was sent from a control). &nbsp;Otherwise (including if the message is a simulated menu command sent from a control) this parameter is NULL.</p>
<p>How can you say that the page makes that obvious?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-351713">
				<div id="div-comment-351713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-351713">
			March 6, 2006 at 6:13 am</a>		</div>

		<p>Because it says what it is, how it is? </p>
<p>IMHO it&#8217;s safe for the docs to assume that the reader writes the window procedures and Send or Post Message calls, or atleast knows thoroughly about them. And if you don&#8217;t care about a certain WM_COMMAND you received, return FALSE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-355403">
				<div id="div-comment-355403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-355403">
			March 16, 2006 at 5:27 am</a>		</div>

		<p>Friday, March 03, 2006 11:43 AM by oldnewthing<br />
<br />&gt; Where are the &quot;bunch of pages&quot;?</p>
<p>Since I needed to look at NMHDR yesterday, it reminded me. &nbsp;There are a bunch of structures that start with an NMHDR, and depending on the kind of notification, the application should cast the pointer to a type that points to the larger structure. &nbsp;There are probably identifiers that are typedef&#8217;ed for the structure and pointer types, but MSDN isn&#8217;t saying. &nbsp;I couldn&#8217;t figure out what to cast it to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632823">
				<div id="div-comment-632823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bobobobo.wordpress.com/2008/02/09/windows-function-references/' rel='external nofollow' class='url'>Windows function references &laquo; Bobobobo&#8217;s Weblog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060302-10/?p=32093#comment-632823">
			May 26, 2008 at 11:29 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://bobobobo.wordpress.com/2008/02/09/windows-function-references/" rel="nofollow">http://bobobobo.wordpress.com/2008/02/09/windows-function-references/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>