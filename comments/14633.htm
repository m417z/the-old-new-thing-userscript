<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-819013">
				<div id="div-comment-819013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819013">
			March 12, 2010 at 7:55 am</a>		</div>

		<p>Joel Spolsky also mentioned this situation a long time ago. Granted, it was in passing; the article was more focused on the trust Bill Gates puts in his employees.</p>
<p><a rel="nofollow" target="_new" href="http://www.joelonsoftware.com/items/2006/06/16.html" rel="nofollow">http://www.joelonsoftware.com/items/2006/06/16.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-819033">
				<div id="div-comment-819033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819033">
			March 12, 2010 at 8:35 am</a>		</div>

		<p>Something&#8217;s missing here.</p>
<p>1/1/1900 is natural. &nbsp;Fine.</p>
<p>If Lotus 1-2-3 had a bug where 1900 was incorrectly considered as a leap year, that accounts for a single day of error. &nbsp;So Visual Basic starts at 12/31/1899. &nbsp;Fine.</p>
<p>But from 12/30/1899 to 1/1/1900 is two days. &nbsp;Where did the other day go?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819053">
				<div id="div-comment-819053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819053">
			March 12, 2010 at 9:01 am</a>		</div>

		<p>Days since midnight on 12/30/1899 (which is 00:00:00 on 12/31/1899) is only one day off from the start of 1/1/1900. &nbsp;It all depends on your definition of &quot;since&quot; and how that applies to dates!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819113">
				<div id="div-comment-819113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819113">
			March 12, 2010 at 9:43 am</a>		</div>

		<p>Maurits: Lotus decided that day 1 would be 1/1/1900, which made day 0 12/31/1899. Then the incorrect leap year causes VB&#8217;s day 0 to be 12/30/1899.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819223">
				<div id="div-comment-819223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819223">
			March 12, 2010 at 12:10 pm</a>		</div>

		<p>Regarding Joel&#8217;s article, I really love him for late binding, For Each and With.</p>
<p>The two others, Date and Variant have their problems. I won&#8217;t hold those against him, since they were both requirements for being an Excel macro language.</p>
<p>That said, Variants should have been kept local to the Excel library. That way they wouldn&#8217;t have infected Visual Basic proper and optional parameters and parameter arrays might have been implemented more sanely.</p>
<p>The discontinuities in the Date format are horrible. If it was really necessary for Excel to emulate Lotus 1-2-3 that accurately (it still had to import / export if I recall correctly, so I&#8217;m not convinced) the weird format should have been kept local to Excel. Don&#8217;t get me wrong, Visual Basic is better for having a way to store dates, but a more linear format would have been better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819233">
				<div id="div-comment-819233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819233">
			March 12, 2010 at 1:42 pm</a>		</div>

		<blockquote><p>
  The discontinuities in the Date format are horrible. If it was really necessary for Excel to emulate Lotus 1-2-3 that accurately (it still had to import / export if I recall correctly, so I&#8217;m not convinced) the weird format should have been kept local to Excel.
</p></blockquote>
<p>It probably was. Afaik the main problem with excel&amp;co is lack of typing. You never know if a number represents a date, a normal number or something else, since that is only decided when it gets formatted for display.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819253">
				<div id="div-comment-819253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roger Gammans</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819253">
			March 12, 2010 at 2:53 pm</a>		</div>

		<p>In the UK the 1/1/1970 is a really bad example date to use for an epoch start. Well sort of.</p>
<p>At least on library uses the epoch / epoch+6 months to test for daylight saving time rules.</p>
<p>Now the really alert (or merely elderly) can see where I&#8217;m going with this but in 1970 the UK was in the middle of a two year trial of DST (summer time) and double summer time. So using the simple test based on this date and extrapolating is going to end in pain.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819263">
				<div id="div-comment-819263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.vacant-nebula.com' rel='external nofollow' class='url'>kip</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819263">
			March 12, 2010 at 4:38 pm</a>		</div>

		<p>@David Walker: &quot;midnight on 12/30/1899 (which is 00:00:00 on 12/31/1899) is only one day off from the start of 1/1/1900&quot;</p>
<p>No, midnight on 12/30/1899 is 1899-12-30 00:00:00, which is exactly 48 hours (not 24!) before the start of 1/1/1900.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819283">
				<div id="div-comment-819283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819283">
			March 12, 2010 at 10:54 pm</a>		</div>

		<p>And that&#8217;s the problem with midnight. &quot;Midnight on &lt;date&gt;&quot; is inherently ambiguous.</p>
<p>Midnight on March 12, 2010 &#8211; it could either refer to the time between March 11 and March 12, or March 12 and March 13. There is no standard.</p>
<p>E.g., after 23:59:59.9999&#8230; and 00:00:00.00000&#8230; is midnight which technically belongs to both days. (Midnight can be defined as 24:00:00 the previous day, or 00:00:00 the following).</p>
<p>That&#8217;s why contests ending at midnight tend to add an extra second or subtract a second to make it clear. &quot;Contest closes 23:59:59 EST on &lt;date&gt; or &quot;Contest starts 00:00:01 PDT on &lt;date&gt;&quot; &#8211; it leaves no legal ambiguity</p>
<p>The fact we&#8217;re arguing whether midnight Dec 30, 1899 is the period between Dec 29-30, or 30-31 is proof even we can&#8217;t get it right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819333">
				<div id="div-comment-819333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bc-programming.com' rel='external nofollow' class='url'>BC_Programmer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819333">
			March 14, 2010 at 9:06 am</a>		</div>

		<blockquote><p>
  &gt;That said, Variants should have been kept local to the Excel library. That way they wouldn&#8217;t have infected Visual Basic proper and optional parameters and parameter arrays might have been implemented more sanely.
</p></blockquote>
<p>Visual Basic had Variant variables in Version 2.0; VBA didn&#8217;t merge with it until Version 4, so VB had the Variant type before &nbsp;that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819363">
				<div id="div-comment-819363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819363">
			March 14, 2010 at 2:20 pm</a>		</div>

		<p>How did MSFT set the 640k limit? It was IBM who decided to use Intel&#8217;s 8088 in the IBM PC and created the memory map which reserved the high 384k for device memory, leaving the low 640k of the 8088&#8217;s address space for use applications.</p>
<p>Besides, it&#8217;s not like Lotus had to worry about fitting their app into 640k anyway. The original IBM PC, which Lotus 1-2-3 ran on, could only be expanded to hold 256k of RAM and 360k on the floppy drives. Of course Lotus wouldn&#8217;t sell much if they required top-of-the-line computers to run their product, so they had to run in 128k of RAM. And obviously that space had to include room for the user&#8217;s data, so Lotus 1-2-3 had to fit in well under 128k!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819353">
				<div id="div-comment-819353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819353">
			March 14, 2010 at 12:11 pm</a>		</div>

		<p>The reason why newly developed COM APIs in 2010 has this *BUG*? Because another company&#8217;s dos app had to fit in 640k ram? lol.</p>
<p>Don&#8217;t blame this bugs on other defunct companies, MSFT was the company that set the 640k limit. Although it&#8217;s poetic justice that MS still has to eat it&#8217;s own dogfood after all this years.</p>
<p>Not to say that MS has had the opportunity to fix this several times. But didn&#8217;t do it.</p>
<p>1. Excel doesn&#8217;t have to emulate lotus123 bugs (could have used a better import function).</p>
<p>2. Excel VBA doesn&#8217;t have to use Excel bugs.</p>
<p>3. COM doesn&#8217;t have to use buggy Excel VBA dates.</p>
<p>4. New interfaces in 2010 doesn&#8217;t have to use COM and it&#8217;s buggy dates.</p>
<div class=post>[<i>It&#8217;s hardly a simply tweak to the import function. You have to reverse-engineer the formulas and macros, too, in order to know where to insert &#8220;+1&#8221; or &#8220;-1&#8221;. Example: Given the formula &#8220;LOOKUP(A1,D50:D90,E50:E90)&#8221;, do you need to do a +1 to compensate for the date bias? Items 2 and 3 introduce discontinuities. You are welcome to use 4 in your own interfaces; just accept that you can&#8217;t interoperate with anybody who does use the existing VARIANT type. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819953">
				<div id="div-comment-819953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-819953">
			March 16, 2010 at 10:25 am</a>		</div>

		<p>&lt;&lt;.. is midnight which technically belongs to both days. (Midnight can be defined as 24:00:00 the previous day, or 00:00:00 the following).</p>
<p>Bad define&#8230;is the same as saying binary has number 2 or octal has number 8. After 1 follows 0 / after 7 follows 0. So is the same in time, you dont have 24, you have 23:59:59 and then 00:00:00 follows, and that is midnight. So midnight is the beginning, never the end.</p>
<p>Now if someone is saying &quot;midnight 30 Dec 1899&quot; that is 48 hours before the year is finishing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-820153">
				<div id="div-comment-820153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100312-00/?p=14633#comment-820153">
			March 17, 2010 at 7:35 pm</a>		</div>

		<blockquote><p>
  Visual Basic had Variant variables in Version 2.0
</p></blockquote>
<p>VB2 was released after Joel&#8217;s interview, so I highly suspect they were added to VB for consistency with Excel Basic.</p>
<blockquote><p>
  It probably was. &#8230;
</p></blockquote>
<p>So if a cell is referenced by a date calculation function but is formatted as a double, it wouldn&#8217;t get imported properly. I think nowadays we would have solved this differently, but I see why they did it. That doesn&#8217;t excuse Basic though.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>