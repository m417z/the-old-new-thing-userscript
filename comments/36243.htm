<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (54)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-262093">
				<div id="div-comment-262093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.die.de/blog' rel='external nofollow' class='url'>thomas woelfer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262093">
			March 9, 2005 at 7:15 am</a>		</div>

		<p>Raymond,</p>
<p>well, sometimes its extremely hard to find the right api, with so many apis hanging around :-)</p>
<p>WM_MY0.02$<br />
<br />thomas woelfer</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262103">
				<div id="div-comment-262103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">double click</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262103">
			March 9, 2005 at 7:23 am</a>		</div>

		<p>For double click time there is also SetDoubleClickTime and GetDoubleClickTime.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262113">
				<div id="div-comment-262113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262113">
			March 9, 2005 at 7:29 am</a>		</div>

		<p>A contributory factor may be that most SystemParametersInfo options aren&#8217;t supported by Windows as a whole, only by specific versions of it; so if you&#8217;re writing an application that is to run on Windows, you have to wrap most SystemParametersInfo calls with fallback code to deal with the case when the user&#8217;s particular version of Windows doesn&#8217;t support that particular option.<br />
<br />Which is no excuse, but at least it&#8217;s some sort of explanation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262123">
				<div id="div-comment-262123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.uesp.net' rel='external nofollow' class='url'>Dave H.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262123">
			March 9, 2005 at 7:31 am</a>		</div>

		<p>I second the &quot;its hard to find the right api&quot; statement&#8230;</p>
<p>It makes perfect sense once you know about it, the problem is how to know about it. Its similarily difficult to know exactly what is undocumented and not recommended. &quot;Undocumented&quot; is the same as &quot;a document that exists but I can&#8217;t find&quot; and &quot;a document I didn&#8217;t look for&quot;.</p>
<p>This isn&#8217;t to excuse bad application behaviour, but it can help explain it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262133">
				<div id="div-comment-262133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262133">
			March 9, 2005 at 7:33 am</a>		</div>

		<p>People use the registry keys because they can browse the registry a lot easier than they can browse through the functions of the Win32 API.  Since people don&#8217;t necessarily understand the design decisions of the underlying systems, they don&#8217;t <em>know</em> about temporary settings and such.</p>
<p>Basically, if you are trying to figure things out, it&#8217;s easier to browse the registry than it is to consult MSDN, and what&#8217;s in the registry seems to make plenty of sense because it&#8217;s so nice and readable.</p>
<p>The fact that you don&#8217;t understand it honestly shows that you&#8217;re too close to the system.  Now that I know Win32 better and can figure it out, I don&#8217;t make those kinds of mistakes, but 90% of people don&#8217;t have <em>time</em> to memorize so much.  There&#8217;s only so much you can push into your head before other stuff gets pushed out :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262143">
				<div id="div-comment-262143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262143">
			March 9, 2005 at 7:53 am</a>		</div>

		<p>Jack: Makes sense. So what&#8217;s the solution? Should the registry include documentation in the form of dummy keys called &quot;Don&#8217;t use this key, call SystemParametersInfo instead&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262153">
				<div id="div-comment-262153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://carrieandtim.com/' rel='external nofollow' class='url'>Tim Danner</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262153">
			March 9, 2005 at 8:05 am</a>		</div>

		<p>Dummy registry keys could help. It might be handy to have a document that mapped system registry keys to APIs so that after a coder browses the registry to find the right (wrong) key, they could find the right way to do it.</p>
<p>But I think the real solution is the .NET Framework. Using the object browser, it&#8217;s pretty easy to find System.Windows.Forms.SystemInformation and see all of its properties. And Longhorn promises a comprehensive managed API.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262163">
				<div id="div-comment-262163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262163">
			March 9, 2005 at 8:21 am</a>		</div>

		<p>&quot;It still puzzles me why people go to the undocumented registry keys to change these settings when there is a perfectly good documented function for doing it. Especially when the documented function works and the undocumented registry key is unreliable.&quot;</p>
<p>I agree with the others, it can be hard to find the right API for the job.  Take a simple example, change the wallpaper.  No matter how hard you look, the obvious choices just don&#8217;t exist; SetWallpaper, SetSystemWallpaper, SetDeskWallpaper, etc.  In fact I&#8217;m not aware of a single Win32 or Shell API that has &quot;wallpaper&quot; in it.  So if you&#8217;ve never done this before it&#8217;s rather difficult to find the SPI_SETDESKWALLPAPER option for the SystemParametersInfo API.  Sure if you do enough searches you&#8217;ll eventually find it, but many developers would give up before that and just go for the registry key which is easy to find and change.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262173">
				<div id="div-comment-262173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262173">
			March 9, 2005 at 8:29 am</a>		</div>

		<p>The good news is that SystemParametersInfo&#8217;s interface is so incredibly complicated that you HAVE to spend the time reading the docs to understand it. This is in contrast to RegEnumKeyEx&#8217;s subtle lpcName behavior, which is easy to overlook.</p>
<p>Let&#8217;s see, uiParam passes in the size of what&#8217;s in pvParam, unless pvParam is pointing to an integral type. Not that this prevents errors, since many of the param struct sizes are identical (e.g., ACCESSTIMEOUT and FILTERKEYS, STICKYKEYS and TOGGLEKEYS). Sometimes pvParam isn&#8217;t a pointer at all, but a BOOL or other type passed by value. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262183">
				<div id="div-comment-262183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Somebody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262183">
			March 9, 2005 at 8:32 am</a>		</div>

		<p>I&#8217;ll add my &quot;me too&quot; to this thread. When I searched for &quot;set wallpaper&quot; on msdn.microsoft.com the top link was som KB article about &quot;Using Paint Program and Active Desktop, Users Can Override Wallpaper Set by System Policy&quot;.  WTF!?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262203">
				<div id="div-comment-262203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262203">
			March 9, 2005 at 8:43 am</a>		</div>

		<p>Is there some list somewhere of all of the changes made if you select &quot;Optimise for Best Performance&quot; in that dialog box under System in Windows XP? (I don&#8217;t have a Windows XP box handy to check where exactly the option is, sadly.)</p>
<p>In particular I&#8217;m interested in how to programmatically switch from the &quot;Luna&quot; interface to the &quot;Classic&quot; interface. I regularly use computers on an Windows network which doesn&#8217;t support the profile roaming thing, so every time I log in I must reconfigure the system to suit myself. I briefly attempted to write a tool to automate this in the past, but couldn&#8217;t find all of the information I needed to programmatically do what I was doing manually.</p>
<p>It would be especially useful if I could do all of this with only temporary settings, as then I could use it for other people&#8217;s computers without messing up their stored profile settings. I&#8217;m a little wary, though: what happens if (for example) you open up the Display properties control panel and press OK while the temporary settings are in effect? Does it commit all of the temporary changes to the registry, or is it clever enough not to do that?</p>
<p>(In the past I did this kind of thing on Windows 2000 machines by exporting bits of the registry once I&#8217;d configured it all how I wanted it, then having a small tool which imported the registry file and did whatever was necessary to get the settings loaded. I seem to remember part of this involved killing off explorer.exe and starting it up again. It was horrible, but it was also quick and easy to do.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262213">
				<div id="div-comment-262213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262213">
			March 9, 2005 at 8:51 am</a>		</div>

		<p>Raymond said:  &quot;It still puzzles me why people go to the undocumented registry keys to change these settings when there is a perfectly good documented function for doing it.&quot;</p>
<p>It doesn&#8217;t surprise me at all.</p>
<p>The API is huge.  It&#8217;s not always obvious that something is wrapped in an API.  When Windows first started dictating how to organize my files with standard directorys like &quot;Program Files&quot; and &quot;My Documents&quot;, many of us just thought it was a convention.  It certainly wasn&#8217;t obvious that this was a configurable scheme that the system was fully aware of.  It was just last year that I discovered the Shell functions to get handles on these special folders.</p>
<p>There is often more than one way to do something, as the previous commenter pointed out with SPI_GET_DOUBLECLICKTIME.  Sometimes there are ways that seem equivalent but vary is subtle ways, like GetDeviceCaps(hdc, HORZRES/VERTRES) versus SPI_GETWORKAREA versus GetMonitorInfo() versus GetSystemMetrics().</p>
<p>Sometimes there isn&#8217;t an API for what you want to do, like finding the name and company of the registered user, but it seems obvious to explore the Registry for a workaround.</p>
<p>Sometimes the documentation is wrong.  GetStockObject docs have had DEFAULT_GUI_FONT and SYSTEM_FONT wrong for who knows how long.  (And do I have to use SPI_GETNONCLIENTMETRICS to determine the LOGFONT used in menus, or can I trust that it will always match DEFAULT_GUI_FONT?)</p>
<p>What the MSDN documentation needs is a giant index in the form:  &quot;If you want to do X, see API Y.&quot;</p>
<p>I don&#8217;t mean this as a slam against anyone.  It&#8217;s just a list of the reasons why I&#8217;m not at all surprised that programmers often find something other than the right way to do what they need.</p>
<p>It would be like picking on you for not capitalizing Registry even though it&#8217;s clearly documented in one of the MS style guides as a word that should be documented. :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262223">
				<div id="div-comment-262223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.phm.lu' rel='external nofollow' class='url'>Philippe Majerus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262223">
			March 9, 2005 at 8:53 am</a>		</div>

		<p>I think adding dummy values for comments in the registry isn&#8217;t the solution as it would make it larger and slow down systems.<br />
<br />But what about including the complete key name as a keyword in the recommanded API to use instead, so that once these developers found the key, a search on its path in MSDN will give them the function they&#8217;re looking for ?</p>
<p>Also, to change the desktop wallpaper, SPI_SETDESKWALLPAPER is outdated as it doesn&#8217;t work with non BMP images (ie JPEG, GIF and others, starting with IE4 Active Desktop).<br />
<br />IActiveDesktop::SetWallpaper is the new function for it, and SPI_SETDESKWALLPAPER should be used as a fallback when the ActiveDesktop interface is missing.<br />
<br />This is something that should be explained on the SystemParametersInfo page in MSDN Library IMO.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262233">
				<div id="div-comment-262233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://david.acz.org/' rel='external nofollow' class='url'>David Phillips</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262233">
			March 9, 2005 at 8:55 am</a>		</div>

		<p>How about a registry browser that includes documentation about various keys and values?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262243">
				<div id="div-comment-262243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262243">
			March 9, 2005 at 8:58 am</a>		</div>

		<p>Speaking of SystemParametersInfo, it&#8217;d be nice if Windows Messenger would actually check to see if we had the minimize animations on when it &quot;minimizes&quot; to the task bar.</p>
<p>If someone is knowledgeable enough to disable the minimize animation, then its safe to assume they know where the system tray is and how it works. (Isn&#8217;t there a useless message box that comes up as well? Official IM clients always treat their users as if they were complete idiots it seems.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262253">
				<div id="div-comment-262253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262253">
			March 9, 2005 at 9:09 am</a>		</div>

		<p>Ben, the settings are stored in HKLMSOFTWAREMicrosoftWindowsCurrentVersionExplorerVisualEffects</p>
<p>If there&#8217;s an SPIActionGet value then that is the uiAction in SystemParametersInfo that gets the setting. If there&#8217;s a RegPath value then you read that path in HKCU to get the setting.</p>
<p>To see what happens when you click Apply, use RegMon. I&#8217;d bet it commits to the registry immediately.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262263">
				<div id="div-comment-262263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulrich Elsner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262263">
			March 9, 2005 at 9:16 am</a>		</div>

		<p>Adding dummy keys to the registry might help but would only work for new Windows versions. </p>
<p>It might be more helpful if every relevant MSDN documentation contained a comment in the order of &#8216;Use this API function rather than changing registry key HLM/xxx/yyy&#8217;. The important thing here is that the registry key is spelled out explicitly so that searching for the registry key will find the correspondig API.</p>
<p>This would help at least those people who don&#8217;t just blindly change the registry value but try to figure out the consequences first.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262303">
				<div id="div-comment-262303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rfredell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262303">
			March 9, 2005 at 9:32 am</a>		</div>

		<p>using my standard approach when looking for unknown apis i searced the headers first. wallpaper returns 18 results in 3 files (mshtmcid.h, shlobj.h, winuser.h). a quick glance tells me im going to have to search msdn for iactivedesktop and spi_setdesktopwallpaper. at this point ive spent ~2 minutes and have a good idea of how do to what i need to. </p>
<p>admittedly, finding how to set the wallpaper is relatively easy using this approach compared to setting, say, the icon label font. font returns 4095 results&#8230;more than i want to look through. searching through the results for icon gives 2 matches, spi_geticontitlelogfont and spi_seticontitlelogfont. exactly what i want.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262313">
				<div id="div-comment-262313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262313">
			March 9, 2005 at 9:52 am</a>		</div>

		<p>&quot;When I searched for &quot;set wallpaper&quot; on msdn.microsoft.com the top link was&quot;</p>
<p>Um&#8230; the top link? &quot;Top link&quot;?! There is your problem, right there. Since when has the top link and the top link alone been even of the slightest use in any set of search results ever, from anything?</p>
<p>Take my advice. Follow my foolproof scheme for finding stuff out, and don&#8217;t stop at step 1. I&#8217;ll go through a simple example, step by step:</p>
<p>0. Load VS.NET 2002 docs.<br />
<br />1. Search for &quot;set wallpaper&quot;. 135 topics.</p>
<p>At this point, you should not stop, but instead continue to follow the steps.</p>
<p>2. Sort by location.<br />
<br />3. Look through for anything marked &quot;Platform SDK&quot;. (This was easier with VC6, I think &#8212; now the prefixes to the words &quot;Platform SDK&quot; make this approach more time-consuming. Certainly not impossible, though.)<br />
<br />4. Note the only page in a &quot;Platform SDK&quot; section with a title that looks like it describe a Win32 functions is &quot;SystemParametersInfo&quot;.<br />
<br />5. See nothing obvious, apart from the IActiveDesktop methods (put them on your mental queue). Therefore, use &quot;SystemsParametersInfo&quot; as a starting point, since, being a Win32 function, it&#8217;s slightly less unlikely to be the right answer than any of the other items, and it may provide some clues as to terminology or have something in the remarks section that points one in the right direction.<br />
<br />6. Look at it, read carefully, discover it is the one.</p>
<p>(Had you failed in step 6, you would have gone through your mental queue of items to look at for more clues. This is particularly handy for terminology. For example, my inclination would have been to search for &quot;desktop background&quot;, and the presence of the &quot;Wallpaper&quot; items in the results would have given me a clue to try a search for &quot;Wallpaper&quot; if the &quot;desktop background&quot; search comes up with nothing.)</p>
<p>Obviously, I knew what to look for, which can help a bit :) But I&#8217;ve used this approach for a bunch of other stuff and always turned up trumps.</p>
<p>And sure enough, when I was looking for how to set the desktop background a few years ago, I found that very function pretty quickly.</p>
<p>I am on Raymond&#8217;s side for this kind of thing.</p>
<p>It might be a question of attitude. If you want to find something out, there is probably a function to do it, and you should look pretty hard to find it before giving up. If you have to resort to tweaking the registry, you&#8217;re going at it the wrong way, so try harder. (But I will admit that if the terminology is not what you expect, which it sometimes isn&#8217;t, then searching the registry can be helpful, as the names can give clues.)</p>
<p>Do other people not think this way? (Maybe not!) How hard does it have to be to find something before you resort to the dirty approach?</p>
<p>I&#8217;m not suggesting that the SDK docs are the greatest ever, just that the information is in there&#8230; somewhere&#8230; probably&#8230; and it sholud be given more than a cursory glance and a quick skim before resorting to ugly hacks.</p>
<p>P.S. please don&#8217;t get put off by my self-righteousness. My code is just as bad as yours :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262323">
				<div id="div-comment-262323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262323">
			March 9, 2005 at 9:56 am</a>		</div>

		<p>I wrote a little cheat-sheet a while ago on any interesting settings functions:</p>
<p>GetDeviceCaps<br />
<br />GetSystemMetrics<br />
<br />SystemParametersInfo<br />
<br />GetMonitorInfo<br />
<br />GetSystemInfo<br />
<br />DeviceCapabilities<br />
<br />IsProcessorFeaturePresent</p>
<p>Anyone got any more I overlooked?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262343">
				<div id="div-comment-262343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262343">
			March 9, 2005 at 10:24 am</a>		</div>

		<p>If you can&#8217;t find the existing API that accomplishes the task you need, you&#8217;re just being lazy. It&#8217;s like being lost, uninterested in studying the map, and refusing to ask for directions all at once.</p>
<p>There are plenty of free online developer communities, newsgroups, and websites from which you can gather information you don&#8217;t yet have. If you don&#8217;t know, ask.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262353">
				<div id="div-comment-262353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Almost Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262353">
			March 9, 2005 at 10:26 am</a>		</div>

		<blockquote><p>
  &gt; A &quot;readme&quot; entry in those keys might also be helpful, even though I can forsee someone at a Windows Annoyances site writing an app to enum the whole registry and delete all values named &quot;readme&quot;, for people who just can&#8217;t stand having all that &quot;useless&quot; data lying around. ;) &lt;&lt;</p>
<p>How about the reverse then?  Microsoft could provide a .REG file for developers that would insert a whole bunch of &quot;readme&quot; keys into the registry.</p>
<p>Then as new tools are released they could also update the documentation in the registry.<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262373">
				<div id="div-comment-262373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262373">
			March 9, 2005 at 10:50 am</a>		</div>

		<p>Adrian said:<br />
<br />&quot;What the MSDN documentation needs is a giant index in the form: &#8216;If you want to do X, see API Y.&#8217;&quot;</p>
<p>My thoughts exactly. This is something that has been needed since the beginning, and it&#8217;s what made programming in Win32/MFC so frustrating when I started out. I&#8217;d be like &quot;ok, I want to do this. I know it&#8217;s possible, 99% of windows programs do it.&quot; and I&#8217;d spend 3 days digging through the documentation before I&#8217;d finally find what I needed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262383">
				<div id="div-comment-262383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray Trent</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262383">
			March 9, 2005 at 10:53 am</a>		</div>

		<p>Seems to me that the simplest, most standard, and most &quot;discoverable&quot; way of solving the registry key documentation problem would be to put them in a help file and enable context sensitive help in regedit/regedt32.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262393">
				<div id="div-comment-262393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262393">
			March 9, 2005 at 11:08 am</a>		</div>

		<p>FFS. The whole point is that you <em>don&#8217;t</em> go buggering about in the registry. Adding help to regedit would just encourage this behaviour.</p>
<p>A better enhancement to regedit would be context-sensitive help of a different manner. It would watch for you searching for data that could me manipulated by an API and, if it detects you are doing this, print up a big message box calling you a cu<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262403">
				<div id="div-comment-262403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262403">
			March 9, 2005 at 11:08 am</a>		</div>

		<p>Argh, hit the mouse button by mistake, sorry about that&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262413">
				<div id="div-comment-262413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262413">
			March 9, 2005 at 11:59 am</a>		</div>

		<p>While we&#8217;re on about tweaking system setup without using the registry, I&#8217;ve been wondering if there&#8217;s any way to programmatically:<br />
<br />Set the default position of: the dialog that comes up when you hit CTRL-ALT-DEL, the dialog that comes up when you lock/unlock your computer and the dialog that comes up asking you to log in.<br />
<br />I know it&#8217;s a pointless little thing, but I do like to see my desktop wallpaper, and I always have at least 20 windows open, so the only time I ever get to see it is when I&#8217;ve locked my computer or logged out, but then the aforementioned dialog box is covering the wallpaper in the center. What I&#8217;d really like to do is move it to the upper right hand corner programmatically. Is this possible?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262423">
				<div id="div-comment-262423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.honestillusion.com' rel='external nofollow' class='url'>James Curran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262423">
			March 9, 2005 at 12:13 pm</a>		</div>

		<blockquote><p>
  &gt;&gt; Unfortunately for the application, the format of the registry key is different between Windows 95 and Windows 2000, and it ended up crashing. &lt;&lt;&lt;</p>
<p>So, were you then forced to patch Win2K, so that this program would keep working??&#8230;
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262433">
				<div id="div-comment-262433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.die.de/blog' rel='external nofollow' class='url'>thomas woelfer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262433">
			March 9, 2005 at 12:17 pm</a>		</div>

		<p>Raymond,</p>
<p>i don&#8217;t think adding stuff to the registry is the right way to go. you see, imo, the problem is not the systemparameters relevant registry keys. the problem is the documentation: it <em>is</em> possible to find stuff in msdn, but it&#8217;s hard.</p>
<p>this is beeing caused by the docs beeing somewhat &#8216;short&#8217; &#8211; and not very well linked.</p>
<p>in a lot of cases, the docs don&#8217;t even contain any really useful information, so it&#8217;s necessary to actually write simple test programs to check out what the docs really want to say.</p>
<p>and this is the case with the win32 api docs as well as with the .net docs.</p>
<p>to be fair: msdn imo is by far better than any other documentation i&#8217;ve seen from other companies (especially when taking into account how much stuff is in there) &#8211; however, they still leave much to be desired&#8230;. as becomes obvious, when people are using strange methods (like tweaking reg keys) when &#8216;official&#8217; apis are available.</p>
<p>iow: i think adding to the registry is not the way to go. adding to the quality of the docs would be more apropriate&#8230;</p>
<p>WM_MY0.02<br />
<br />thomas woelfer</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262443">
				<div id="div-comment-262443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Somebody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262443">
			March 9, 2005 at 12:20 pm</a>		</div>

		<p>That sounds like the documentation chapter in the Unix Haters&#8217; Handbook.  It went something like:</p>
<p>1. Guessing command names<br />
<br />2. The Oral Tradition<br />
<br />3. Keeping your personal unix guru fed<br />
<br />4. How to ask questions on usenet<br />
<br />etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262283">
				<div id="div-comment-262283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/michkap/archive/2005/03/09/390839.aspx' rel='external nofollow' class='url'>Sorting It All Out</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262283">
			March 9, 2005 at 12:23 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262293">
				<div id="div-comment-262293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/michkap/archive/0001/01/01/390839.aspx' rel='external nofollow' class='url'>Sorting It All Out</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262293">
			March 9, 2005 at 12:24 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262473">
				<div id="div-comment-262473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262473">
			March 9, 2005 at 2:06 pm</a>		</div>

		<p>My example about the setting the wallpaper seems to have been a popular one, many people have since commented on it.  I agree just because a quick 2 minute search doesn&#8217;t yield the correct API doesn&#8217;t mean you should give up and go straight for the undocumented reg key.  But setting the wallpaper is a very simple example, what about more complex problems?  How long are you supposed to look for an API before you give up and do it another way?</p>
<p>Another example from a problem I faced recently, I needed to know if a registry hive was volatile or persisted to disk on shutdown.  I could not find a &quot;RegIsHiveVolatile&quot; API.  I never did find a function, in the end I resorted to comparing it against the list of persisted hives at HKLMSYSTEMCurrentControlSetControlhivelist.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262483">
				<div id="div-comment-262483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262483">
			March 9, 2005 at 2:38 pm</a>		</div>

		<p>&quot;put them in a help file and enable context sensitive help in regedit/regedt32.&quot;</p>
<p>This also means that the help file will have to be translated into 20+ languages &#8211; because the rule for Windows is that everything has to be translated into every language &#8211; to address a small audience that probably all can read English anyway.</p>
<p>Perhaps a wiki mapping registry keys to APIs&#8230;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262493">
				<div id="div-comment-262493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Thresher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262493">
			March 9, 2005 at 2:42 pm</a>		</div>

		<p>SPI_GETNONCLIENTMETRICS is great if you&#8217;re running classic windows but doesn&#8217;t seem to return the correct window caption font if XP themes are enabled. How should that be handled?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262503">
				<div id="div-comment-262503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.debian-administration.org/' rel='external nofollow' class='url'>Steve Kemp</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262503">
			March 9, 2005 at 3:24 pm</a>		</div>

		<p>Long time reader &#8211; first comment.</p>
<p>  You probably mean &#8216;disable&#8217; rather than &#8216;diable&#8217;, honest I&#8217;m not a Spelling Nazi!</p>
<p>Steve<br />
<br />&#8212;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262513">
				<div id="div-comment-262513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeka.com/blogs/' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262513">
			March 9, 2005 at 3:47 pm</a>		</div>

		<p>This is sort of off-topic, but while on the subject of desktop wallpapers and the equivalent settings for registry keys, the registry key HKEY_CURRENT_USERControl PanelDesktopWallpaper maps to that SPI_SETDESKWALLPAPER setting, but what about the various combinations of TileWallpaper and WallpaperStyle (which basically map to the Tile, Stretch and Center settings in the Display Properties dialog).</p>
<p>I haven&#8217;t been able to find the equivalent API which sets those settings.  Probably just missed some obvious thing, however&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262523">
				<div id="div-comment-262523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262523">
			March 9, 2005 at 4:29 pm</a>		</div>

		<p>Raymond:<br />
<br />I&#8217;m not sure of the true solution to this problem.  I like the solution you mention of a Wiki. </p>
<p>I would like some sort of integration with the local system.  Like a registry editor that downloads some tree layout description data and will show you your local registry with the annotated documentation.  Of course, not included with Windows.  Maybe some small MSDN download.  Anything that wouldn&#8217;t require the 100+ language translation you talk about.</p>
<p>I think this would pretty much be the holy grail of navigating the registry.  regedit + downloadable documention that&#8217;s probably available in a wiki-type format online.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262273">
				<div id="div-comment-262273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262273">
			March 9, 2005 at 9:21 am</a>		</div>

		<p>David&gt;<br />
<br />&gt;How about a registry browser that includes documentation about various keys and values? </p>
<p>An *old* version of NU (from like 1997 or so) had this feature. They had their own registry editor with a 3-pane view, the bottom pane showed docs on whatever key you were currently looking at. I don&#8217;t know why it didn&#8217;t survive, it seemed like a neat idea.</p>
<p>I like some of the suggestions I&#8217;ve seen, especially putting reg key names in the API docs pages so you can search on the key name to find the API.<br />
<br />A &quot;readme&quot; entry in those keys might also be helpful, even though I can forsee someone at a Windows Annoyances site writing an app to enum the whole registry and delete all values named &quot;readme&quot;, for people who just can&#8217;t stand having all that &quot;useless&quot; data lying around. ;) </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262533">
				<div id="div-comment-262533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262533">
			March 9, 2005 at 5:24 pm</a>		</div>

		<blockquote><p>
  to address a small audience that probably all can read English anyway.</p>
<p>I first parsed that as &quot;to address the small audience that can actually read english&quot; and immediately thought of Cletus the slack jawed yokel. Not that I&#8217;m being provincial or anything.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262543">
				<div id="div-comment-262543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://en.wikipedia.org/wiki/User:Jamesday' rel='external nofollow' class='url'>James Day</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262543">
			March 9, 2005 at 6:07 pm</a>		</div>

		<p>Information in the registry (where people are looking for it, regardless of whether they should be) and a wiki would be interesting.</p>
<p>There doesn&#8217;t seem to be a rule that the Windows API function names must be translated into 20 languages, so why would the registry hints need to be in 20 different languages? </p>
<p>I have much doubt that Microsoft would do the wiki right. My bet is on legal tying it up with lots of restrictive licensing and indemnification terms. Instead of making it public domain so any contributor can easily reuse the whole of the work they have partially contributed to and thereby increasing their incentive to build there. That&#8217;s based on my look at the wiki software a Microsoft employee did and what Microsoft is doing with it &#8211; I read the legal terms and walked away. There are better places to build things than there. And yes, if it&#8217;s PD people can reuse it. That&#8217;s part of the point &#8211; to make this stuff available everywhere, distributed by everyone, in anything.</p>
<p>Likely also that Microsoft wouldn&#8217;t use the wiki platform which has been best proved in the wild (Mediawiki).</p>
<p>Have some doubts on the culture also. Developers are developing applications and don&#8217;t necesarily (or generally at all if they have a choice) want to limit their market to Windows. Would Microsoft want to exclude porting and compatibility details for other platforms and interfaces or libraries? Developing with Windows as one target platform, but not the only one, that&#8217;s the sort information I&#8217;d be after.</p>
<p>But&#8230; I could be wrong. And I&#8217;d like to be.</p>
<p>I&#8217;m a bit biased on the wiki side though &#8211; I&#8217;m one of the technical team for the world&#8217;s largest and most popular wikis, hosted by Wikimedia. Though all my income-producing developing has been for Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262553">
				<div id="div-comment-262553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Somebody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262553">
			March 9, 2005 at 6:20 pm</a>		</div>

		<p>Dear God, please don&#8217;t let this blog turn into Slashdot. Please!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262563">
				<div id="div-comment-262563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Somebody else</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262563">
			March 9, 2005 at 7:10 pm</a>		</div>

		<p>I know what you mean, Somebody, the level of distrust in the postings is rather high  ;-)</p>
<p>Seriously, the only restriction Raymond has mentioned is that Microsoft is generally obligated to distribute official documentation in all languages.  A community wiki would be excempt from this requirement, but would therefore be unofficial and unsupported &#8212; it&#8217;s a tradeoff.</p>
<p>BTW, The fact that Raymond is allowed to blog (as are many other Microsoft employees) should tell you that &quot;legal tying it up&quot; is unlikely.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262573">
				<div id="div-comment-262573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262573">
			March 9, 2005 at 7:27 pm</a>		</div>

		<p>Coming from someone whose main non-HTML UI experience is in nT logon scripts, I know why I constantly do it: I&#8217;ve been conditioned by a wide range of software that offers no APIs of any kind and rarely even have friendly interfaces. Almost everything I need to do via logon script has to be done by editing the registry or ini files. When I go to change windows settings if I&#8217;m in a hurry and can&#8217;t quickly find an api, I just naturally do the same &#8211; after all, the script runs prior to UI init, so I don&#8217;t have to worry about unrefreshed stale info.</p>
<p>I do consider it a cheap hack, and always try to replace it with more scalable methods when I come across them, but many times that&#8217;s the best I can do with an hour of googling when I&#8217;m building something and just need it to work for now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262593">
				<div id="div-comment-262593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Conti</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262593">
			March 9, 2005 at 8:05 pm</a>		</div>

		<p>Dean:<br />
<br />Check out IActiveDesktop and WALLPAPEROPT/SetWallpaperOptions</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/ifaces/iactivedesktop/SetWallpaperOptions.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/ifaces/iactivedesktop/SetWallpaperOptions.asp</a><br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262603">
				<div id="div-comment-262603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262603">
			March 9, 2005 at 8:12 pm</a>		</div>

		<p>Yes every user of MSDN knows how hard it can be to find some stuff.  Some random stuff is easy but other random stuff is nearly impossible to find.  Google is your friend in such cases.  It still doesn&#8217;t always find everything, but it helps a lot.  Finding APIs becomes almost as easy as finding undocumented registry keys&#8230;</p>
<p>3/9/2005 2:38 PM Raymond Chen </p>
<p>&gt; the rule for Windows is that everything has<br />
<br />&gt; to be translated into every language</p>
<p>At first I wondered where you got that from, but then noticed you meant Windows itself and not MSDN.  Yeah that rule is obeyed in most of Windows.  The Japanese version of MSDN is missing quite a lot of pages (neither Japanese nor English being present) and has a number of English-only pages.</p>
<p>&gt; &#8211; to address a small audience that probably<br />
<br />&gt; all can read English anyway.</p>
<p>Wrong.  Most companies have a few employees who can speak English.  That&#8217;s far removed from the idea that most employees speak English.  Some of my co-workers have to ask for help even when they have English-language MSDN pages open on their screen.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262623">
				<div id="div-comment-262623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262623">
			March 9, 2005 at 9:06 pm</a>		</div>

		<p>My biggest gripe with MSDN is that it always manages to pull up the Windows CE documentation before anything else.  I see where I can tell it to only search Windows CE, but I have yet to figure out how to tell it to never search Windows CE.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-262643">
				<div id="div-comment-262643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262643">
			March 9, 2005 at 9:40 pm</a>		</div>

		<p><a target="_new" href="http://www.google.com/microsoft.html" rel="nofollow">http://www.google.com/microsoft.html</a></p>
<p>is your friend for searching MSDN.</p>
<p>Works a lot better for me than the MSDN search.</p>
<p>YMMV.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-262663">
				<div id="div-comment-262663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J. Edward Sanchez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-262663">
			March 10, 2005 at 12:57 am</a>		</div>

		<p>I just use a regular Google search, but with a &quot;site:msdn.microsoft.com&quot; qualifier.</p>
<p>I have this set up as an &quot;msdn&quot; Smart Keyword in Firefox, and as an &quot;msdn&quot; Search Prefix in IE:</p>
<p><a target="_new" href="http://www.google.com/search?q=site:msdn.microsoft.com+%s" rel="nofollow">http://www.google.com/search?q=site:msdn.microsoft.com+%s</a></p>
<p>The Firefox Smart Keyword can be set up by creating a regular bookmark, and filling in the &quot;Keyword&quot; field. The IE Search Prefix can be set up using Tweak UI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-263073">
				<div id="div-comment-263073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Blekhman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-263073">
			March 12, 2005 at 4:37 am</a>		</div>

		<p>“What the MSDN documentation needs is a giant index in the form: &#8216;If you want to do X, see API Y.”</p>
<p>There is such index already. It called “Table of Contents”.</p>
<p>I read here a lot of lamentations about how difficult it is to retrieve information from MSDN. It’s so huge, its index is so immense, search delivers so many hits, etc. etc. It seems that people completely forgot to use anything besides Index and Search tabs. Of course there will be countless results for search “set wallpaper” when you search several GB of compressed text! But, hey, it’s so easy to type a few words and hit Search button, then let the MSDN to read my mind and figure out what I want to find.</p>
<p>If I don’t know what function to use I always start from TOC. Then rarely there is a need to fall back on index or brute force search. I’m using index only to quickly peep function’s parameters or class’ members. However, with help of IntelliSense I don’t need index most of the time. I’m using search quire rarely, only if I’m stuck or want to check whether there is some KB article on the topic. When I found what I need in Index or Search, then I always press Synchronize button to see where I am in the TOC. It always helps to read several topics before and after, too.</p>
<p>At the first time people reluctant to go to TOC. Because it requires thinking about what do you want to find before hitting buttons. And thinking is always painful. But once one’s accustomed to this habit it saves literary hours of tedious searches.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-263243">
				<div id="div-comment-263243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bonemanblog.blogspot.com' rel='external nofollow' class='url'>Steven Bone</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-263243">
			March 12, 2005 at 8:54 pm</a>		</div>

		<p>Sometimes it is hard to follow these &quot;rules.&quot;  Take for instance the Distributed Transaction Coordinator, or DTC for short.  If you wanted to get or change any particular setting related to DTC you can&#8217;t do it the same way across OS versions.  In Windows 2003, there is the IDtcNetworkAccessConfig interface you can use.  To change the same settings on Windows XP, the registry appears the only option.  Furthermore, the upcoming Windows 2003 SP1 DTC changes (which mirror the XP SP2 changes) has not updated the API to reflect the change (at least in the SP1 RC2 version of the SDK documentation).  Specifically, there is no updated method of allowing or disallowing specific transaction permissions such as inbound or outbound, so the API is useless &#8211; back to registry keys!  Checking the DTC authentication level never had an API &#8211; just some registry keys documented in a KB article.  I  hope they fix this oversight for the final SP1 release &#8211; but in the meantime, what is a developer expected to do?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-263263">
				<div id="div-comment-263263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-263263">
			March 13, 2005 at 7:57 am</a>		</div>

		<p>If there&#8217;s no API to do it, then it might be worthwhile to take the risk of registry hacking. The important point is simply that there is a risk, and registry poking isn&#8217;t the best way; things may change, your program may break, and in any event you have to muck about with all that RegOpenKey stuff.</p>
<p>But some people seem to think of registry hacking as the first port of call. To me, this is akin to doing something like reading filenames by doing &quot;system(&quot;dir&gt;fred.txt&quot;)&quot; and then extracting columns 30 and onwards of all lines of &quot;fred.txt&quot; except the first and last few. It&#8217;s a solution, sure, and it probably worked at the time, but it&#8217;s flaky as hell, and to top that off pointless because there is a documented API that will do it for you much more easily.</p>
<p>(I pick that fairly strange example because I&#8217;ve seen it done, and because most people will probably agree it&#8217;s not reliable.)</p>
<p>Just surprised that people are so willing to get down and dirty without worrying about it. It&#8217;s impossible, as always, to supply any hard-and-fast rules, because there are always exceptions. But as a guiding principle, it&#8217;s sensible to try as hard as possible to avoid registry poking&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-263273">
				<div id="div-comment-263273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-263273">
			March 13, 2005 at 8:00 am</a>		</div>

		<p>Whoops, sorry, cmd.exe prints filenames starting at column 40.</p>
<p>4nt.exe starts the filenames at column 36, which of course is one potential problem :) There&#8217;s the whole DIRCMD can of worms, too, not to mention DOSKEY macros and whatnot. (That&#8217;s just in case there was any confusion that this could be made to work without a vast amount of effort and lots of confusing breakages along the way :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-264403">
				<div id="div-comment-264403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Somebody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050309-00/?p=36243#comment-264403">
			March 15, 2005 at 6:35 pm</a>		</div>

		<p>&quot;Of course there will be countless results for search “set wallpaper” when you search several GB of compressed text!&quot;</p>
<p>Why is it searching so many documents in the first place? I went to MSDN not TechNet.  Why would I care about wallpaper policies and how users can overwrite them?</p>
<p>&quot;But, hey, it’s so easy to type a few words and hit Search button, then let the MSDN to read my mind and figure out what I want to find.&quot;</p>
<p>Yep. I&#8217;ll use the simplest and quickest way to find what I need.  I&#8217;ve already got a whole load of crap in my head when I&#8217;m developing. I don&#8217;t need any more.  The suggestion to use Google seems to work the best.</p>
<p>&quot;At the first time people reluctant to go to TOC. Because it requires thinking about what do you want to find before hitting buttons. And thinking is always painful. But once one’s accustomed to this habit it saves literary hours of tedious searches. &quot;</p>
<p>You find some rhyme and reason in the TOC.  Good for you.  I don&#8217;t.  Which sub category of &quot;Win32 and COM Development&quot; should I expand to find out how to set the wallpaper?  Graphics and Multimedia? Platform SDK? User Interface?  Which sub-category? Which sub-sub-category?  Isn&#8217;t a game of &quot;The Great API Quest&quot; fun when you have a deadline to meet?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>