<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (45)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-512313">
				<div id="div-comment-512313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx' rel='external nofollow' class='url'>BradC</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512313">
			June 7, 2007 at 10:06 am</a>		</div>

		<p>Excellent point. Reminds me of Alex P&#8217;s post (linked by my name) called Pounding A Nail: Old Shoe or Glass Bottle?</p>
<p>&quot;A client has asked me to build and install a custom shelving system. I&#8217;m at the point where I need to nail it, but I&#8217;m not sure what to use to pound the nails in. Should I use an old shoe or a glass bottle?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512333">
				<div id="div-comment-512333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Golden Hammer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512333">
			June 7, 2007 at 10:21 am</a>		</div>

		<p>rundll32. Problem solved.</p>
<div class="post">[<i>Um, no. <a href="http://blogs.msdn.com/oldnewthing/archive/2004/01/15/58973.aspx" rel="nofollow">Now you have two problems</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512343">
				<div id="div-comment-512343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gnox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512343">
			June 7, 2007 at 10:37 am</a>		</div>

		<p>&gt;&gt; decided what technology they&#8217;re going to use to solve it</p>
<p>The technology decision is 99% of the time out of question for a number of reasons. If they had put the question differently, the answer would have not satisfied them.</p>
<p>Q: How do I put my laptop programmatically ?</p>
<p>A: Use SetSystemPowerState etc etc</p>
<p>Q: How do I put my laptop into standby mode from VBScript?</p>
<p>A: VBScript does not support that directly. You can however use the xxx.yyy COM Object or write a wrapper yourself which calls SetSystemPowerState using standard VB or C++.</p>
<p>There&#8217;s quite a difference.</p>
<div class="post">[<i>I realized that my point wasn&#8217;t sufficiently clear. The follow-up question is fine, but it should go to a VBScript discussion group. Asking the core development team won&#8217;t get you very far since they don&#8217;t provide VBScript wrappers. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512403">
				<div id="div-comment-512403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512403">
			June 7, 2007 at 11:49 am</a>		</div>

		<p>Sorry to tell you, but at least for SetSystemPowerState rundll32 is a valid an excellent solution, since it wraps values into corresponding types. </p>
<p>rundll32.exe kernel32.dll,SetSystemPowerState 1 1</p>
<p>or, even better:</p>
<p>rundll32.exe powrprof.dll,SetSuspendState</p>
<p>However, wrapping structs and other complex types is not supported.</p>
<div class="post">[<i>rundll32 does not wrap values into &#8220;corresponding&#8221; types. I don&#8217;t know where people make up this stuff. Rundll32 <a href="http://support.microsoft.com/kb/q164787/" rel="nofollow">passes four parameters</a>: HWND, HINSTANCE, LPSTR, and int. You can verify this by writing a test program. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512413">
				<div id="div-comment-512413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wang-Lo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512413">
			June 7, 2007 at 11:59 am</a>		</div>

		<p>How to inflate a bicycle tire with a potato.</p>
<p>Materials:</p>
<p>(1) a five-pound sack of potatos, available at any grocery store</p>
<p>(2) a flexible hose with a valve stem connection, left over from when you broke your previous bicycle pump</p>
<p>(3) a UPS truck left idling at the curb by its driver, commonly found throughout any modern city</p>
<p>(4) a ball-point pen &#8212; look in your shirt pocket</p>
<p>Procedure:</p>
<p>(1) Remove one potato from the sack. &nbsp;Close the sack.</p>
<p>(2) Use the pen to drive a hole through the potato. &nbsp;Long way through is better.</p>
<p>(3) Force the cut end of the hose through the hole in the potato. &nbsp;Connect the other end to your valve stem.</p>
<p>(4) Open the driver&#8217;s door of the idling truck and place the sack of potatos on the gas pedal.</p>
<p>(5) Quickly run around to the back of the truck and jam the potato forcefully into the exhaust pipe.</p>
<p>Warnings:</p>
<p>(1) By the time the engine stalls, pressure in the exhaust pipe will reach about 125 psi. &nbsp;Be careful not to burst your tire.</p>
<p>(2) Do not stand behind the exhaust pipe. &nbsp;If the connection fails, bits of flexible hose and hot potato can reach speeds of 1000 fps.</p>
<p>(3) When the UPS driver finds the sack of potatos, a flat tire will be the least of your worries.</p>
<p>-Wang-Lo.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512443">
				<div id="div-comment-512443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512443">
			June 7, 2007 at 12:13 pm</a>		</div>

		<p>1) Purchase Visual Studio 2005.</p>
<p>2) Run a wizard to generate TODO-laden code.</p>
<p>3) Create dialogs as needed.</p>
<p>4) Fill in the TODOs with your code.</p>
<p>5) Compile, test, debug, build an installer to deal with dependencies such as a 30MB .NET 2.0 runtime, etc.</p>
<p>-OR-</p>
<p>Use VBScript/JScript and WMI (free and on every system since at least Windows 2000) to change the settings. For a lovely interface, use HTAs. Deploy the 800-byte script using advanced techniques such as email, COPY or a USB key.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512473">
				<div id="div-comment-512473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Let down</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512473">
			June 7, 2007 at 12:27 pm</a>		</div>

		<p>Every time I saw this in the pre-blog, my immediate reaction was &quot;Sweet, Raymond&#8217;s going to explain how to inflate a bicycle tire with a potato!&quot;. You can imagine my disappointment</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512483">
				<div id="div-comment-512483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512483">
			June 7, 2007 at 12:33 pm</a>		</div>

		<blockquote><p>
  Wang-Lo
</p></blockquote>
<p>I thought your method was going to involve taking pressurized air from one of the tires of the UPS truck.</p>
<p>Note: In this method bag of potatoes is available for use in discouraging interference from UPS driver.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512513">
				<div id="div-comment-512513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512513">
			June 7, 2007 at 1:00 pm</a>		</div>

		<p>OK Dave, if it&#8217;s that easy, show us the script.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512553">
				<div id="div-comment-512553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512553">
			June 7, 2007 at 1:19 pm</a>		</div>

		<p>(Without meaning to pick on Raymond, who quite reasonably noted that he&#8217;s not a VB person, but for the benefit of the audience&#8230;)</p>
<p>The example that Raymond provided at the end of this article is actually Visual Basic.NET code using the .NET Platform Invoke feature. The original Visual Basic had a very similar mechanism which would probably look something like this:</p>
<p>Declare Function SetSystemPowerState Lib &quot;kernel32&quot; Alias &quot;SetSystemPowerState&quot; (ByVal fSuspend As String, ByVal fForce As Boolean) As Boolean</p>
<p>(I&#8217;m not much of a VB person either, but I&#8217;m forced by employer to occasionally maintain an ancient VB6 app, so I can roughly remember how to do that.)</p>
<p>The question given in the article was specifically asking about VBScript, which doesn&#8217;t have any mechanism for importing functions from arbitrary DLLs. However, I suspect the question was referring to the use of VBScript in the Windows Script Host, in which case it might well already have an API for doing this, or failing that it can instantiate COM objects so you could (if you&#8217;ve got your heart set on Visual Basic) use VB6 or VB.NET to write a COM wrapper library to call from your script.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512573">
				<div id="div-comment-512573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">coditza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512573">
			June 7, 2007 at 1:51 pm</a>		</div>

		<p>Okay, use a c or c++ app where you have to, but that implies you have visual stdion or the express versions. What if, I don&#8217;t want to install all of those (let&#8217;s say I have all the software I need, licenses and stuff)? Is there anything like the &#8220;free&#8221; gcc already provided by windows? Why not? It&#8217;s so hard to provide a cmd line only compiler for Windows? All I want is an already shipped compiler (and linker) with a minimum library set (heck, with LoadLibrary I am pretty much set). No, you can&#8217;t develop commercial applications with it, but for small tools it&#8217;s ok.</p>
<div class=post>[<i>I&#8217;m sure the antitrust lawyers would have a field day if Windows came with a copy of Visual C++, even just the command line edition. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512583">
				<div id="div-comment-512583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wolf Logan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512583">
			June 7, 2007 at 2:07 pm</a>		</div>

		<p>&quot;Is there anything like the &quot;free&quot; gcc already provided by windows?&quot;</p>
<p>There&#8217;s csc.exe (in C:WindowsMicrosoft.NETFrameworkvXXX), which is a &quot;free&quot; command line C# compiler. Using the same interop mechanism as Raymond points out in his VB.NET sample, you can write a nice, little program to shutdown the computer (or do whatever) using just notepad and csc. You won&#8217;t be able to write C++ code, and therefore some of the more esoteric COM techniques won&#8217;t be available, but if you need that level of support, you should really grab one of the &quot;real&quot; dev environments.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512653">
				<div id="div-comment-512653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512653">
			June 7, 2007 at 3:40 pm</a>		</div>

		<p>&quot;Okay, use a c or c++ app where you have to, but that implies you have visual stdion or the express versions.&quot;</p>
<p>A simple search for &quot;microsoft command line compiler&quot; will tell you how to obtain cl.exe and set up your build environment.</p>
<p>I downloaded the platform SDK for Windows XP, clicked &quot;Start | Programs | Microsoft Platform SDK for Windows XP SP2 | Open Build Environment Window | yadda yadda&quot; to open the build environment window. &nbsp;Then I wrote a program to shut down the PC using SetSystemPowerState (using vi as my editor, but I could have used notepad). &nbsp;Then I compiled it with &quot;cl test.cpp user32.lib Advapi32.lib&quot;. &nbsp;And it works. &nbsp;No Visual Studio necessary as far as I can tell.</p>
<p>Then I deployed it to my Vista laptop by copying the .exe and double clicked it to run it. &nbsp;Oh yeah, I had to set up a shortcut first to pass a command-line parameter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512703">
				<div id="div-comment-512703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512703">
			June 7, 2007 at 5:02 pm</a>		</div>

		<p>&quot;All I want is an already shipped compiler&quot;</p>
<p>No, Coditza, the compiler is not &quot;already shipped&quot; with Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512713">
				<div id="div-comment-512713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512713">
			June 7, 2007 at 5:03 pm</a>		</div>

		<p>Maybe I was wrong&#8230; if a compiler actually ships with .NET, as Wolf Logan says. &nbsp;Interesting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512723">
				<div id="div-comment-512723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wolf Logan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512723">
			June 7, 2007 at 5:12 pm</a>		</div>

		<p>Technically, I suppose it can only be considered &quot;already shipped with Windows&quot; in the case of Vista, which ships .NET on the disk. On the other hand, .NET is available as an optional automatic download via Windows Update, and was included (as a redist package) with at least several commercial apps, so the likelihood of you finding .NET on any given Windows installation is pretty high.</p>
<p>Every version of .NET, though, has included the csc compiler. And .NET assemblies carry their own metadata, so the equivalent of the Windows header files are also already there. You can do plenty of useful development work &quot;right out of the box&quot; (at least on Vista), but it&#8217;s a pretty rough experience compared to Visual Studio.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512733">
				<div id="div-comment-512733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512733">
			June 7, 2007 at 5:15 pm</a>		</div>

		<p>I thought it would have something to do with letting the potato ferment, and produce gases, which would have to build sup sufficient pressure (maybe a lot of pressure), then &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512743">
				<div id="div-comment-512743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512743">
			June 7, 2007 at 5:41 pm</a>		</div>

		<blockquote><p>
  Is there anything like the &quot;free&quot; gcc</p>
<p>  already provided by windows?
</p></blockquote>
<p>not only is the microsoft command-line compiler free, and VC++ Express Edition,</p>
<p>but &#8216;gcc&#8217; is also available for Windows as &quot;MinGW&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512753">
				<div id="div-comment-512753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Archangel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512753">
			June 7, 2007 at 5:45 pm</a>		</div>

		<p>Maybe that says something about the background of the questioner?</p>
<p>You certainly can set mouse acceleration from a shell script in Unix-like systems via xset. You can also put the machine to sleep from any environment that can write to /sys/power/state in Linux (no doubt that&#8217;s different elsewhere, but I can&#8217;t remember what it is). Maybe the questioner was used to Unix and thought he could do the same?</p>
<p>Of course that&#8217;s really just an extension to Raymond&#8217;s original point &#8211; in the environment he&#8217;s in, those are potatoes. Doesn&#8217;t matter that they might be bicycle pumps elsewhere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512813">
				<div id="div-comment-512813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512813">
			June 7, 2007 at 6:45 pm</a>		</div>

		<p>[I&#8217;m sure the antitrust lawyers would have a field day if Windows came with a copy of Visual C++, even just the command line edition. -Raymond]</p>
<p>Um, why? Every other sensible OS has shipped with its own dev tools (well, not OS2) for a while now. Windows is the odd man out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-512823">
				<div id="div-comment-512823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512823">
			June 7, 2007 at 7:26 pm</a>		</div>

		<blockquote><p>
  Every other sensible OS has shipped with its own dev tools (well, not OS2) for a while now.
</p></blockquote>
<p>They also ship with web browsers, media players and so on and nobody complains. What&#8217;s up with that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512863">
				<div id="div-comment-512863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512863">
			June 7, 2007 at 8:14 pm</a>		</div>

		<blockquote><p>
  They also ship with web browsers, media players and so on and nobody complains. What&#8217;s up with that?
</p></blockquote>
<p>I&#8217;ve always wondered that myself. The average person EXPECTS a system to have this functionality at minimum when buying a new computer anymore. Just because it&#8217;s &quot;the bundled&quot; doesn&#8217;t mean you have to stay with it. Most people I&#8217;ve known learn this pretty quickly, even if they don&#8217;t know where to get quality replacements.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512873">
				<div id="div-comment-512873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512873">
			June 7, 2007 at 8:20 pm</a>		</div>

		<blockquote><p>
  &gt; How do I put my laptop into standby mode from VBScript?</p>
<p>  &gt; How do I change the user&#8217;s mouse acceleration from a batch file?
</p></blockquote>
<p>Some of the comments are spot-on, but let&#8217;s take a step back and look at why these questions are being asked. &nbsp;Every Windows system has a command processor for batch files. &nbsp;Nearly every Windows system has VBScripting. &nbsp;With these tools it isn&#8217;t even necessary to run market surveys to find out if nearly every Windows system has a command line version of MSBuild (with or without anti-trust worries). &nbsp;Even if someone thinks the batch script command language is ugly, they might want to use it because it&#8217;s available. &nbsp;They might even have learned this reasoning by reading a very famous blog.</p>
<p>Thursday, June 07, 2007 6:45 PM by Cooney</p>
<blockquote><p>
  Every other sensible OS has shipped with its</p>
<p>  own dev tools (well, not OS2) for a while now.
</p></blockquote>
<p>Macs didn&#8217;t used to do so. &nbsp;Vista does now. &nbsp;XP Pro and some versions of Vista can get gcc from Microsoft though they have to do extra downloading to get it. &nbsp;If I&#8217;m not mistaken, both XP Pro and Home can get .Net&#8217;s compilers from Microsoft though they have to do extra downloading to get them. &nbsp;XP Home can&#8217;t get Microsoft&#8217;s distribution of gcc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512903">
				<div id="div-comment-512903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Angstrom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512903">
			June 7, 2007 at 9:08 pm</a>		</div>

		<p>Norman: It&#8217;s not gcc; I&#8217;m sure there&#8217;s someone at Microsoft whose job it is (in some sense) to prevent any GNU/FSF programs from shipping with Windows. &nbsp;Very likely a lawyer.</p>
<p>Stu: that&#8217;s exactly the sort of shortsighted software development that leads to half the posts here and 90% of the posts at Worse Than Failure.</p>
<p>Just because it&#8217;s a silent, invisible crash now, for you, doesn&#8217;t mean it&#8217;s always going to be silent and invisible forever, nor that it isn&#8217;t already a very noisy one for some users. &nbsp;I&#8217;m sure people with the debug kernel turned on would love a command-line shutdown tool that instead popped up a modal dialog asking if you wanted to debug rundll32, interrupting the shutdown.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512943">
				<div id="div-comment-512943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512943">
			June 7, 2007 at 9:52 pm</a>		</div>

		<p>Hmmm, &quot;when all you have is a hammer, everything looks like a nail&quot;</p>
<p>rundll32: if only I had a nickle for every hung or crashing rundll32 process because some commercial software idiot thought it was a golden hammer. And there are so many rundll32 command lines in the registry, that when you see a hung rundll32 in Processes, it&#8217;s hard to tell who screwed up&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-512673">
				<div id="div-comment-512673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512673">
			June 7, 2007 at 4:32 pm</a>		</div>

		<p>Raymond: I understand this is your blog and you have the right to say what you want, but please stop misqouting Jamie Zawinski, you may hate regular expressions or despise people that are forced* to use tools not entirely suited to the job they wish to do, but just quoting Zawinski is as bad as those people who quote Dijkstra whenever somebody mentions any form/dialect of BASIC (as occurs on certial blogs/forums).</p>
<p>Secondly, a silent and invisible crash (as happens when rundll is used with &#8216;incompatible&#8217; functions) is not, in any way that a normal user would care about, a crash.</p>
<p>I understand that you don&#8217;t like to see your work misused, but I would consider using rundll more of a clever hack or kludge that works than something overtly bad.</p>
<p>*Yes, forced, many corporate security policies will ban arbitary .exe&#8217;s on user machines, or you may have to implement these in pre-existing scripts where creating a new dependency is not allowed/practical.</p>
<div class=post>[<i>It&#8217;s not a comment on regular expressions (which I myself am a fan of); I just like the joke pattern. And if you&#8217;re willing to corrupt the stack and take a 1/256 chance that the suspend will fail, then at least document it so your customers know what they&#8217;re up against. And if you are constrained by what you can do, then say so. Otherwise people will just say, &#8220;Don&#8217;t use a potato. Use a bicycle pump.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512983">
				<div id="div-comment-512983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-512983">
			June 8, 2007 at 12:12 am</a>		</div>

		<p>Thursday, June 07, 2007 9:08 PM by Angstrom</p>
<blockquote><p>
  It&#8217;s not gcc; I&#8217;m sure there&#8217;s someone at</p>
<p>  Microsoft whose job it is (in some sense) to</p>
<p>  prevent any GNU/FSF programs from shipping</p>
<p>  with Windows.
</p></blockquote>
<p>It is gcc. &nbsp;Though I already stated my agreement with you on the other part, it doesn&#8217;t ship with Windows, it requires a separate download from Microsoft. &nbsp;XP Pro can install Windows Services for Unix. &nbsp;Server 2008, and if I recall correctly some versions of Vista, have a Start menu entry that will automatically open Internet Explorer to a Microsoft page where Subsystem for Posix Applications can be downloaded. &nbsp;The gcc compiler that is included is gcc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513003">
				<div id="div-comment-513003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513003">
			June 8, 2007 at 12:34 am</a>		</div>

		<p>&quot;(Note: I don&#8217;t speak Visual Basic, so I may have gotten the details wrong, but I hope you get the idea.)&quot;</p>
<p>I worked at a company in the Netherlands for a while, they were developing an MFC application to drive some custom hardware. One of the developers there said he went to a Microsoft conference in the US and one of the Microsoft guys giving a presentation about C++ said &quot;Visual Basic is for lesser mortals. Real men use C++&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513023">
				<div id="div-comment-513023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">foxyshadis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513023">
			June 8, 2007 at 12:57 am</a>		</div>

		<p>DriverDude, with good ol&#8217; Process Explorer, you can see the command line of the rundll32, at least that can get you closer to matching it up. ;)</p>
<p>It&#8217;s quite understandable to want to do as much from a single language/script as possible, but VBScript has some pretty hard limits &#8211; like binary file/registry IO, and APIs. Being able to load .Net libraries eases many of the limitations, however.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513043">
				<div id="div-comment-513043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kuwanger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513043">
			June 8, 2007 at 3:14 am</a>		</div>

		<blockquote><p>
  &gt; Every other sensible OS has shipped with its own dev tools (well, not OS2) for a while now.</p>
<p>  They also ship with web browsers, media players and so on and nobody complains. What&#8217;s up with that?
</p></blockquote>
<p>Not to be horribly off-topic, but MS wasn&#8217;t prosecuted for shipping with a web browser. &nbsp;They were prosecuted because they went out of their way to threaten OEMs who wanted to install a competing web browser alongside MS&#8217;s offering. &nbsp;Ie, they were trying to be anti-competitive. &nbsp;The issue then was whether MS was in a position where this anti-competitiveness was illegal. &nbsp;The fact that merely offering software, bundled with the OS or otherwise, could be construed as anti-competitive is disturbing, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513053">
				<div id="div-comment-513053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513053">
			June 8, 2007 at 3:59 am</a>		</div>

		<p>If rundll could be given alternative function syntaxes, then these would not be potatoes.</p>
<p>Does such a program exist? It would be so astonishingly useful to those of us who mostly program in php or perl.</p>
<p>That people misuse rundll isn&#8217;t surprising. The command has no on-system help via &#8216;-h&#8217; or &#8216;/?&#8217; or &#8216;help&#8217;, so people will use it as best they can. If they learn from a trusted source (colleague, &quot;useful tips&quot; website) that it can be used to shut down the machine with an incantation, and on testing they find that it works, why should they suspect that there is an evil pixie that will make it sometimes not work?</p>
<p>Many of us who use scripting languages exclusively simply would not think to look in MSDN, since almost nothing we normally do is related to that.</p>
<p>Though speaking of which, anyone know for a list of rundll-callable Windows functions with the correct format? (Yes, I did search msdn).</p>
<p>As for the potato/tyre thing: simple go to the person with the pump, and say &quot;I will give you this fine potato&#8230;&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513063">
				<div id="div-comment-513063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513063">
			June 8, 2007 at 4:36 am</a>		</div>

		<blockquote><p>
  &gt; How do I put my laptop into standby mode from VBScript?
</p></blockquote>
<p>strServer = &quot;.&quot;</p>
<p>Set objWMI = GetObject(&quot;winmgmts:\&quot; &amp; strServer &amp; &quot;rootcimv2&quot;)</p>
<p>strWQL = &quot;select * from Win32_ComputerSystem&quot;</p>
<p>Set objInstances = objWMI.ExecQuery(strWQL,,48)</p>
<p>For Each objInstance in objInstances</p>
<pre><code>p_PowerState = 3

p_Time = &amp;quot;20051205044912.546875+060&amp;quot;

' Uncomment next line to actually execute the method!

' intResult = objInstance.SetPowerState(p_PowerState, p_Time)

WScript.Echo &amp;quot;Result: &amp;quot; &amp;amp; intResult
</code></pre>
<p>Next</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513073">
				<div id="div-comment-513073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">arun.philip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513073">
			June 8, 2007 at 4:48 am</a>		</div>

		<p>Appreciate it that you&#8217;ve stopped the nitpickers corner [Considering you were having to think up whacky nitpicks, and preempt them]</p>
<p>Has it stopped the nitpickers?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513133">
				<div id="div-comment-513133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513133">
			June 8, 2007 at 6:13 am</a>		</div>

		<p>&#8220;Go ahead, write that program, and then call it from your batch file. &#8221;</p>
<p>But then you have two problems&#8230;.</p>
<div class="post">[<i>You don&#8217;t have to install a runtime to run a native app (assuming you wrote it with this purpose in mind). Heck, you don&#8217;t even need to install it at all &#8211; you can run it directly over the network. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513163">
				<div id="div-comment-513163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513163">
			June 8, 2007 at 8:25 am</a>		</div>

		<p>&quot;Many of us who use scripting languages exclusively&quot;</p>
<p>My advise is to take a look at some non-scripting languages as well. You&#8217;ll find the transition a lot easier than you might think and it will allow you to choose the right tool for the job in different situations. It&#8217;ll also be good for your CV and open up more choices about what kind of work you do.</p>
<p>I don&#8217;t mean this in a derogatory way. Something I have noticed over the years is that people can be scared off by the &quot;big&quot; languages. People I&#8217;ve known have been stuck using one particular language, say a scripting language or VB, and felt that learning a &quot;proper&quot; (for lack of a better word) language was beyond their abilities, but it&#8217;s not.</p>
<p>I can understand being put off by C++ but these days there&#8217;s C# and Java and if you can understand VB or a scripting language then you shouldn&#8217;t have any trouble learning either of those. The basic concepts and flow of logic are exactly the same and the syntax differences are more like learning a regional dialect than a completely different language.</p>
<p>I&#8217;d argue that C# is actually easier to understand than Perl, too.</p>
<p>All it takes is a bit of reading and a bit of time. The basic concepts are the same in almost all languages (ignoring the &quot;functional programming&quot; languages, anyway).</p>
<p>C++ can be a pain to learn because it&#8217;s full of caveats and complexities which take years to get the hang of, or even know they&#8217;re there. You have to trip over a lot of things in C++ before you can really consider yourself a good C++ programmer, in my opinion. C# and Java are cleaner and slimmer lanaguages which you can pick up and understand very easily, and they&#8217;re also great gateways into C++ if you want to go there one day (but you don&#8217;t have to, C# is fine for just about everything on the Windows platform, assuming you are not writing drivers or high-performance games, etc.).</p>
<p>The overhead to writing a piece of code in C# are not much (if at all) greater than a scripting language, in terms of what you have to understand and the boiler-plate stuff you have to write to, for example, pull in a library, but the benefit is they are better designed and more structured so you will generally write better code (which also feeds back into what you may write in scripting languages) and you&#8217;ll gain access to APIs that you might not be able to call from a scripting language (which is Raymond&#8217;s point, I guess).</p>
<p>There&#8217;s no reason, other than fear of the unknown, to say that you&#8217;ll only use scripting languages. You&#8217;re missing out on a very useful set of tools if you think that way. I&#8217;ve seen a lot of people who were afraid to take what they thought was a big leap, but when they did they found it was surprisingly easy.</p>
<p>Of course, scripting languages have a place. I have to confess that I&#8217;m not a big fan of them but I still write the odd bit of VBScript glue here and there. The point is to arm yourself with a bigger toolbox so you aren&#8217;t constrained into using a hammer when what you really need is a sander.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513173">
				<div id="div-comment-513173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513173">
			June 8, 2007 at 8:39 am</a>		</div>

		<p>My take-away on this is to not get too particularly fixated on one tool. The command line is extensible via a lot of things &#8230; sometimes, you have to use C. A one page C program can save a lot of tears from somewhere else.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513313">
				<div id="div-comment-513313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mihai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513313">
			June 8, 2007 at 1:05 pm</a>		</div>

		<p>If you want to do Windows development without installing a compiler (and all the headers), you can always use debug.</p>
<p>It&#8217;s been there since early MS-DOS.</p>
<p>Ok, it is not a compiler, but it is enough to call the one or two Win32 APIs required.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513443">
				<div id="div-comment-513443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513443">
			June 8, 2007 at 5:17 pm</a>		</div>

		<p>Would people actually be willing to USE a bigger, badder rundll32? Something that checks ESP after the call and puts up a big error box in case of mismatch? Would they agree to use a syntax like the below? [argv0 being a placeholder name, of course.]</p>
<p>argv0 kernel32.dll SetSystemPowerState b=bb true true</p>
<p>argv0 user32.dll GetSystemMetrics i=u 76 &gt;&gt; sm_cxscreen.txt</p>
<p>argv0 /CDECL /GETLASTERROR somedll.dll _cfunc v=ii 42 999</p>
<p>(Or, as is more likely, someone trying to start a screensaver the not-quite-right way&#8230;)</p>
<p>argv0 user32.dll SendMessageA u=puup $fgwnd 0x0112 0xF140 0</p>
<p>Because, you see, I&#8217;ve got some code already written along those lines. If people are interested I suppose I could clean it up for external release.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513243">
				<div id="div-comment-513243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">name required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513243">
			June 8, 2007 at 11:07 am</a>		</div>

		<p>Wang &#8211; I had a slightly longer term version which involved fermenting the potatoes, I&#8217;m sure they give off gas under such circumstances*. Of course, there would be certain beneficial side-effects with my version of the &quot;code&quot;. Warning: can cause the ocular system to crash.</p>
<p>* Caveat: I am not a bootlegger†</p>
<p>† RIP </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513693">
				<div id="div-comment-513693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig Ringer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513693">
			June 10, 2007 at 9:32 am</a>		</div>

		<p>@coditza</p>
<p>Download the Visual C++ Express Edition. It&#8217;s not hard, and provides a rather good tool. The only thing I&#8217;ve really been bugged by the lack of so far is a profiler, and that might just be my inability to find it.</p>
<p>I build cross platform software so I use MinGW (gcc for Windows), the VC++ Express Edition (which also includes a command line cl.exe), and gcc on Linux &amp; Mac OS X quite a lot. Do you know how much I paid for any of those? $0.</p>
<p>Some years ago I too used to be annoyed by the lack of a quality free compiler on win32. Especially when it came to C++. Thankfully it&#8217;s just not an issue anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513753">
				<div id="div-comment-513753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ExOrPhine</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513753">
			June 11, 2007 at 4:12 am</a>		</div>

		<p>This worked for me pretty well:</p>
<ol>
<li>
<p>Connect the potato and the tire with a usual tube</p>
</li>
<li>
<p>Deflate the potato and concurrently inflate the tire</p>
</li>
<li>
<p>If it doesn&#8217;t work &#8211; reiterate</p>
</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-513973">
				<div id="div-comment-513973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pc486</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513973">
			June 11, 2007 at 2:18 pm</a>		</div>

		<p>I cannot accept an answer of &#8220;write it in &lt;lower-level language X&gt;,&#8221; even if it&#8217;s just a small executable that makes one or two calls. Let me first say that I don&#8217;t use Windows as a platform for anything, work or home (but I do enjoy this and other Microsoft blogs). There may be something I&#8217;m missing here with the way Windows does its job. That said, I fully understand a developers feelings of wanting to (maybe forced too) script in something higher level. I write scripts all the time in evil bourne/bash to ugly Perl to any one of my own domain specific languages (translation: Lisp). I can get more done in 10 lines of script than a C++ or C# program can in 500. The act of starting a new project/directory+makefile just to make some syscall or low-level call is a significant developer performance hit as well as a maintenance problem.</p>
<p>OK, now down to problem solving. Others have pointed out rundll, but Raymond shot that down by showing that it cannot create arbitrary calls. It is possible to create arbitrary calls out of some languages with tools like SWIG (<a href="http://www.swig.org/" target=_new rel=nofollow rel="nofollow">http://www.swig.org/</a>) or Lisp&#8217;s Common Foreign Function Interface (<a href="http://common-lisp.net/project/cffi/" target=_new rel=nofollow rel="nofollow">http://common-lisp.net/project/cffi/</a>). But what about a SWIG/CFFI like command-line tool that can be passed a symbol and the symbol signature to make the call? In other words, is there a &#8220;correct&#8221; rundll?</p>
<p>&#8211; Tristan</p>
<div class=post>[<i>It&#8217;s not &#8220;write it in &lt;lower-level language&gt;. It&#8217;s &#8220;At the end of the day, it&#8217;s a call in the designated target language. You&#8217;ll need to bridge the gap.&#8221; Maybe there&#8217;s a &#8220;p/invoke&#8221;-like way of doing it, maybe somebody else bridged it for you. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-513983">
				<div id="div-comment-513983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-513983">
			June 11, 2007 at 2:20 pm</a>		</div>

		<p>Usin Win32_PointingDevice in a WMI script that sets DoubleSpeedThreshold or QuadSpeedThreshold is all it takes to solve the mouse problem, same principle as DC&#8217;s PowerState script. You can do some serious stuff with WMI and VBScript. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-514433">
				<div id="div-comment-514433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andreister</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-514433">
			June 12, 2007 at 3:33 am</a>		</div>

		<p>OK, I&#8217;ve come across one post from Raymond (<a href="http://blogs.msdn.com/oldnewthing/archive/2004/01/15/58973.aspx" target="_new" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2004/01/15/58973.aspx</a>) about calling convention and rundll. I&#8217;m assuming calling SHExitWindowsEx via rundll would also fail because SHExitWindowsEx is merely a wrapper on ExitWindowsEx. </p>
<p>Then, if yes, it looks like this Microsoft article (<a href="http://support.microsoft.com/?kbid=234216" target="_new" rel="nofollow">http://support.microsoft.com/?kbid=234216</a>) about shutdown on Win98 is not valid, right? It suggests using &#8220;rundll32.exe shell32.dll,SHExitWindowsEx X&#8221; to restart Windows 98/Me automatically.</p>
<p>Or back in time of Win98, ExitWindowsEx had a different signature?</p>
<p>Thanks,</p>
<p>Andrew</p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2006/04/24/582152.aspx" rel="nofollow">I already discussed this</a>. Most KB articles are not reviewed by the product team; it&#8217;s just a bunch of product support people helping each other out. Maybe their advice is good, maybe not. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-516503">
				<div id="div-comment-516503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.yanivpessach.com/' rel='external nofollow' class='url'>Yaniv Pessach</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070607-00/?p=26523#comment-516503">
			June 18, 2007 at 4:17 pm</a>		</div>

		<p>I agree with Raymond that the product teams (and Raymond in particular) should not have to explain how to make a specific API call from (a possibly very long) list of programming languages. That’s a bit backwards.</p>
<p>I also agree that rundll32.dll is overused, and often mis-used.</p>
<p>However, there seems to be a real need to easily make an API call without having to write the 15-lines programs that makes such a call. &nbsp;Even I, as a developer, encounter this mental barrier that &nbsp;‘writing a whole program to…’ takes too much time/attention.</p>
<p>To deal with this apparent need, I took some time this weekend to write a simple program to execute an arbitrary DLL method call with arbitrary parameters from the command-line. &nbsp;For example, execute</p>
<blockquote><p>
  RunAnyDLL user32.dll MessageBoxA UINT 0 LPSTR Welcome LPSTR goodbye UINT 1
</p></blockquote>
<p>A v0.1 version of this tool is available on tool available on <a rel="nofollow" target="_new" href="http://www.yanivpessach.com/shared/runanydll/" rel="nofollow">http://www.yanivpessach.com/shared/runanydll/</a> .</p>
<p>The current version uses .NET (it emits a module using the .NET interop), but I may rewrite it to use straight C/++. Feedback most welcome.</p>
<p>// Yaniv Pessach</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>