<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-195903">
				<div id="div-comment-195903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/larryosterman' rel='external nofollow' class='url'>Larry Osterman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-195903">
			July 16, 2004 at 7:36 am</a>		</div>

		<p>Does this work for RTL languages as well?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195923">
				<div id="div-comment-195923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-195923">
			July 16, 2004 at 8:23 am</a>		</div>

		<p>It seems curious to me that this functionality is (apparently) part of IE, and not part of something such as Uniscribe.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195933">
				<div id="div-comment-195933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-195933">
			July 16, 2004 at 8:52 am</a>		</div>

		<p>You know, DrPizza, I was just thinking that myself.</p>
<p>I was incredibly surprised that this code didn&#8217;t touch Uniscribe at all.</p>
<p>Mind you, I find Uniscribe a bear to work with anyway, so I&#8217;m not entirely surprised.</p>
<p>Raymond &#8211; why not Uniscribe?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195943">
				<div id="div-comment-195943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nicholas Allen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-195943">
			July 16, 2004 at 8:54 am</a>		</div>

		<p>Larry, I believe this will fail for things like embedded bidi.</p>
<p>Uniscribe has built in support for linking and fallback.  It probably does something similar to this internally because a lot of it boils down to calls to something like ExtTextOut.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195973">
				<div id="div-comment-195973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-195973">
			July 16, 2004 at 10:29 am</a>		</div>

		<p>I didn&#8217;t know about Uniscribe. MLang was added in Internet Explorer 4.0; Uniscribe didn&#8217;t show up until Internet Explorer 5.0.</p>
<p>I welcome anybody to write an equivalent version that uses Uniscribe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196003">
				<div id="div-comment-196003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196003">
			July 16, 2004 at 11:34 am</a>		</div>

		<p>I thought the font &quot;Microsoft Sans Serif&quot; (added in Windows 2000) was supposed to solve this problem. It seems to be capable of displaying Roman/Cyrillic/Thai/Korean/Japanese/etc. characters, provided the necessary language support is installed on the system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196013">
				<div id="div-comment-196013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196013">
			July 16, 2004 at 11:37 am</a>		</div>

		<p>Raymond: Fair enough :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196053">
				<div id="div-comment-196053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196053">
			July 16, 2004 at 1:25 pm</a>		</div>

		<ol>
<li>I thought Arial Unicode MS does include all Unicode characters (or a pretty good approximation thereof).
<p>2. How does this handle bidi? How about combining characters?</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196063">
				<div id="div-comment-196063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.io.com/~mdahmus/blog/' rel='external nofollow' class='url'>M1EK</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196063">
			July 16, 2004 at 1:37 pm</a>		</div>

		<p>I had to do this on OS/2 in order to get Unicode text display working for Java, which sneers at puny concepts like codepages.</p>
<p>And I like how you picked Thai, which is the weirdest character set I ever had the displeasure to attempt to handle.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196083">
				<div id="div-comment-196083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196083">
			July 16, 2004 at 2:15 pm</a>		</div>

		<p>Jonathan,</p>
<p>Arial Unicode MS isn&#8217;t part of the stock Windows distribution, and it&#8217;s also HUGE (about 25MB!) so it&#8217;s not really something most people want to have loaded when it&#8217;s not necessary.</p>
<p>It&#8217;s a pity there isn&#8217;t a GDI mode or an alternative function which does all this stuff for you. Obviously it can&#8217;t be the default, because in some cases it&#8217;s important to use one font and one font alone and there are already loads of apps out there, but the option to have Windows do the right thing to solve this very common problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196093">
				<div id="div-comment-196093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196093">
			July 16, 2004 at 3:01 pm</a>		</div>

		<p>If you have Windows 2000 or better, my understanding is that GDI will do font linking automatically if your font is Tahoma, MS Sans Serif, a few select others. (I&#8217;m not the expert on this subject, so my answer to follow-up questions will likely be &quot;I don&#8217;t know.&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196043">
				<div id="div-comment-196043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.stevex.org/dottext/archive/2004/07/16/531.aspx' rel='external nofollow' class='url'>stevex.Text</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196043">
			July 16, 2004 at 3:29 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196103">
				<div id="div-comment-196103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196103">
			July 16, 2004 at 3:56 pm</a>		</div>

		<p>As a test I opened Notepad (first simple Unicode-enabled app which sprang to mind) and created an empty file with a name containing Thai, Cyrillic, Arabic and Greek characters to see what would happen in the title bar, which on my system is rendered in Tahoma. I assume title bar captions are rendered through TextOut, although of course they might not be!</p>
<p>It doesn&#8217;t appear to have worked, although the copy of Tahoma on my system does seem to contain lots of Thai, Cyrillic and Arabic characters. It did stumble on a few of the Arabic ones, though.</p>
<p>I&#8217;ll have to test this properly with a simple test app sometime, I guess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196173">
				<div id="div-comment-196173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.binaryc.com/' rel='external nofollow' class='url'>Brian</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196173">
			July 17, 2004 at 11:05 am</a>		</div>

		<p>I&#8217;m curious as to the point of TextOutTryFL.  Why not just put else { TextOut(hdc, x, y, psz, cch); } inside TextOutFL ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196183">
				<div id="div-comment-196183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J. Edward Sanchez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-196183">
			July 17, 2004 at 11:42 am</a>		</div>

		<p>Because the caller might want to know whether the operation succeeded as requested. You could accomplish that using a special return code, but then the caller might also want to take some other action (i.e., warn the user) instead of just falling back to TextOut() in case of a problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-200353">
				<div id="div-comment-200353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-200353">
			August 2, 2004 at 10:23 am</a>		</div>

		<p>Commenting closes after two weeks.</p>
<p><a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-662213">
				<div id="div-comment-662213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.jdlh.com/en/2008/08/26/simple_script_detection/' rel='external nofollow' class='url'>Jim DeLaHunt, world-ready &raquo; Simple script-detection algorithm for font switching?</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040716-00/?p=38413#comment-662213">
			August 26, 2008 at 7:03 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.jdlh.com/en/2008/08/26/simple_script_detection/" rel="nofollow">http://blog.jdlh.com/en/2008/08/26/simple_script_detection/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>