<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-joshuaganes even thread-even depth-1" id="comment-985393">
				<div id="div-comment-985393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Joshua+Ganes' rel='external nofollow' class='url'>Joshua Ganes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985393">
			May 16, 2012 at 7:09 am</a>		</div>

		<p>If the ladder company was repeatedly involved in lawsuits from people who were injured by using them as bridges, you can be sure that the warning would start popping up on all new ladders. It would always be present like &quot;Caution: Hot&quot; on coffee cups.</p>
<p>I like the term &quot;grabby extension&quot;. Is that a rigorously-defined technical term?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985403">
				<div id="div-comment-985403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985403">
			May 16, 2012 at 7:10 am</a>		</div>

		<p>I find it hard to imagine how a bug that causes &quot;I can&#39;t run anything from the Start menu&quot; to last more than a day or two on the developer&#39;s machine before they attempt to investigate the problem and try to fix it. One can only assume that the developers just think their Start menus are inexplicably broken and ship the software anyway!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-985413">
				<div id="div-comment-985413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985413">
			May 16, 2012 at 7:43 am</a>		</div>

		<p>Presumably the software was developed and tested on a version of Windows before explorer started using IContextMenu::InvokeCommand in this way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985423">
				<div id="div-comment-985423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">No One</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985423">
			May 16, 2012 at 7:52 am</a>		</div>

		<p>@Gabe: Or the developers and testers both only use desktop shortcuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-985433">
				<div id="div-comment-985433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985433">
			May 16, 2012 at 7:53 am</a>		</div>

		<p>Or the developer is one of those people who use desktop icons or quick launch icons to run all the software they use (plus Win-E and &quot;Win-R cmd Enter&quot; for the file manager and the shell).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985453">
				<div id="div-comment-985453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985453">
			May 16, 2012 at 8:36 am</a>		</div>

		<p>I bet the compat flag was added for CopyTo and MoveTo because people kept putting them in context menus. It sort of makes sense.</p>
<p>@Cesar: Or they&#39;re shell isn&#39;t explorer. It happens.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-985463">
				<div id="div-comment-985463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985463">
			May 16, 2012 at 8:43 am</a>		</div>

		<p>THis is where the blacklist should be useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985493">
				<div id="div-comment-985493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kimmo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985493">
			May 16, 2012 at 10:26 am</a>		</div>

		<p>Ray, glad that you&#39;re still around (b)(p)(i)tching &lt;&#8211; in a good way. Thanks /k</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-985513">
				<div id="div-comment-985513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985513">
			May 16, 2012 at 12:41 pm</a>		</div>

		<p>Hmm, I wonder if that is why the shell extension of a popular image viewer crashes my explorer when invoked from a search result view &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985553">
				<div id="div-comment-985553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985553">
			May 16, 2012 at 2:22 pm</a>		</div>

		<p>Not to sound grumpy, but if the way verbs work turns out to be different depending on whether it&#39;s invoked from the context menu, programmatically, or from the toolbar, you should take the design of the system back to the drawing board.</p>
<div class="post">[<i>Verbs invoked by context menu and programmatically are supposed to be the same. Toolbar is totally unrelated. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-985533">
				<div id="div-comment-985533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985533">
			May 16, 2012 at 1:27 pm</a>		</div>

		<p>Well on Windows 8, Copy To and Move To are part of the Command Store (and Ribbon) so they can be added to context menu with this tweak and so far I haven&#39;t noticed any side effects:</p>
<p>Windows Registry Editor Version 5.00</p>
<p>[HKEY_CLASSES_ROOT*shellWindows.CopyToMenu]</p>
<p>&quot;ExplorerCommandHandler&quot;=&quot;{3852C2E2-4A16-4b11-8E71-F8904C37EC3D}&quot;</p>
<p>&quot;CommandStateSync&quot;=&quot;&quot;</p>
<p>&quot;Icon&quot;=&quot;imageres.dll,-5304&quot;</p>
<p>[HKEY_CLASSES_ROOT*shellWindows.MoveToMenu]</p>
<p>&quot;ExplorerCommandHandler&quot;=&quot;{F60C3E02-214A-462b-9B07-56EA38545A13}&quot;</p>
<p>&quot;CommandStateSync&quot;=&quot;&quot;</p>
<p>&quot;Icon&quot;=&quot;imageres.dll,-5303&quot;%</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985823">
				<div id="div-comment-985823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985823">
			May 17, 2012 at 6:02 pm</a>		</div>

		<p>Raymond, next time read a post before replying to it.</p>
<p>I hate to draw this out, because it will be a bore to other readers, but since you apparently have issues with text comprehension, here goes:</p>
<p>Verbs invoked by context menu and programmatically are supposed to be the same, but they aren&#39;t. That&#39;s what the article is about, and this is a severe shortcoming in the design of the whole system.</p>
<p>Toolbar items are completely unrelated, but that again is part of the problem. It&#39;s a flaw that shows that people didn&#39;t think the design through properly.</p>
<p>If the system had been designed properly (and this isn&#39;t deep stuff, so there is no excuse for getting it wrong) the whole problem the article describes wouldn&#39;t exist. Someone who can look at IContextMenu and not cringe should be banned from programming.</p>
<div class="post">[<i>But why should toolbar buttons and context menus share the same execution model? How would you like to create an IContextMenu for every button on your toolbar? (And you forget that the toolbar thing was purely internal to Explorer; it&#39;s not part of any public interface. Explorer thought it would be clever and unify toolbar buttons and context menus for the purpose of its toolbar, and look what happened.) And how would you unify command-based invoke and menu-based invoke? It seems you&#39;re trying to unify two things that have no common ground. (In one case, you have a string and no menu. In the other case, you have a menu and no string.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-985893">
				<div id="div-comment-985893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DumpCOM.now</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-985893">
			May 18, 2012 at 6:48 am</a>		</div>

		<p>I blame this on COM. Unfortunately it&#39;s even more obfuscated in windows.next</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-986013">
				<div id="div-comment-986013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-986013">
			May 18, 2012 at 4:20 pm</a>		</div>

		<p>@DumpCOM.now: This has nothing to do with COM; it&#39;s caused by a poor interface specification. You would have gotten the exact same problem if you let the same blockhead design an interface for use with Java, DCOP, D-Bus, or anything else.</p>
<p>@Raymond: You&#39;re starting to rave irrationally. Just stop defending the indefensible, you&#39;ll feel better. [Note: most readers can probably skip the rest of this post, it&#39;s just tearing Raymond&#39;s reply apart, but if you read it, chances are I won&#39;t write anything you haven&#39;t already thought.]</p>
<p>@But&#8230;: Because there&#39;s no reason toolbar buttons that act on an object couldn&#39;t be put in the context menu instead, so a well designed system will be agnostic from where the action is performed.</p>
<p>@How&#8230;: Toolbar buttons that don&#39;t act on objects weren&#39;t under discussion, you know that.</p>
<p>@(And&#8230;): It went wrong because the ill-designed system caused different behaviour when not used from the toolbar. And of course because whoever wrote the MoveTo and CopyTo implementation (and the broken context menu extensions) can&#39;t read documentation, but that just shows that it&#39;s easier to get the implementation wrong than right, and that you won&#39;t notice that you did it wrong, at least when /you/ test it.</p>
<p>@And&#8230;: You should be ashamed to even ask this. Menus and such shouldn&#39;t even come into play at this point, rather extension writers should implement actions to perform on objects. (Let&#39;s call them verbs to stick with current terminology.) No implementer should have to care from where it was invoked.</p>
<p>@It&#8230;: No common ground? [expletive deleted] What about the thing that actually needs to be done?</p>
<p>@(In&#8230;): As already stated, that doesn&#39;t matter in a well-designed system.</p>
<div class="post">[<i>The people who wrote the toolbar said, &quot;Hey, instead of inventing a whole new interface, let me reuse this existing one. This is just an internal thing (not documented or third-party extensible), so no need to get all fancy.&quot; I can&#39;t see which side of the fence you&#39;re arguing, whether it was a good idea to unify toolbar, verbs, and context menus, or that it was a bad idea. Personally, I wouldn&#39;t have unified them, because well you can see what went wrong when they were unified. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-986033">
				<div id="div-comment-986033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-986033">
			May 18, 2012 at 7:55 pm</a>		</div>

		<p>Is there a simialr issue that would cause drag-and-drop to stop working? &nbsp;If so, how do you find the fautly app?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-986583">
				<div id="div-comment-986583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-986583">
			May 22, 2012 at 11:35 am</a>		</div>

		<p>[&#8230;&quot;Hey, instead of inventing a whole new interface, let me reuse this existing one. This is just an internal thing (not documented or third-party extensible), so no need to get all fancy.&quot; &#8230;]</p>
<p>My interpretation of that would be COM interfaces are too heavyweight by the time this starts to sound like a good idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-986763">
				<div id="div-comment-986763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120516-00/?p=7613#comment-986763">
			May 23, 2012 at 1:55 am</a>		</div>

		<p>Raymond, the reason you can&#39;t see what I&#39;m arguing is that you don&#39;t actually read what I type. The answer to your question is in my previous posts, and I also disagree that the toolbar people caused the root of mess (unless the same coincidentally also designed the architecture of the verb system), and I&#39;ve explained why in previous posts.</p>
<p>Joshua, COM interfaces aren&#39;t heavyweight (they&#39;re just vtables really) and as I wrote above, unifying toolbar buttons that act on objects and context menu items is a good thing. The problems are caused by bad interface design.</p>
<div class="post">[<i>When you say that something is bad <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/07/09/3769001.aspx" rel="nofollow">you have to say what would be better</a>. All you&#39;re saying is &quot;they should be unified&quot; but I have not seen a concrete proposal as to how it should be done. (Because it <span style="text-decoration:underline;">was</span> done, but apparently not to your satisfaction.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>