<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (43)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-848693">
				<div id="div-comment-848693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">R. Bemrose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848693">
			July 26, 2010 at 7:12 am</a>		</div>

		<p>Unfortunately, I know one application that misuses the Vista/7 elevation manifest. &nbsp;Every time you start the program, it starts its auto-updater, and the auto-updater always triggers a UAC prompt, despite my user having write privileges to its directory and HKLM registry entries.</p>
<p>I could say what program it is, but I suspect it would just be removed if I did. &nbsp;Lets just say it&#39;s a popular gaming IM program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848703">
				<div id="div-comment-848703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vladimir</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848703">
			July 26, 2010 at 7:14 am</a>		</div>

		<p>One annoying problem with Vista&#39;s auto-elevation filename heuristic is that it overrides any manifests specified in the application. I once wrote a tool called &quot;patch.exe&quot; (or perhaps it just had &quot;patch&quot; in the filename, can&#39;t remember now), and couldn&#39;t figure out why would running it pop up an elevation prompt. Ultimately I found the setting that controlled this heuristic and turned it off system-wide.</p>
<p>Of course, that bit me back a few times when old installers would throw cryptic error messages at me. Specifically, WISE installers would say that a &quot;Wise un-install wizard was already running&quot; or something on that note.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848713">
				<div id="div-comment-848713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848713">
			July 26, 2010 at 7:20 am</a>		</div>

		<p>Then there are installers that don&#39;t check for the necessary privileges until 99% into the install, installers that don&#39;t provide a per-user install even though there&#39;s no reason against it and my all time favorite, installers that do a per-user install but require admin privileges. A popular instant messenger had the added bonus of doing a system-wide install that only worked for the user that installed it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848733">
				<div id="div-comment-848733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dylan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848733">
			July 26, 2010 at 7:40 am</a>		</div>

		<p>I didn&#39;t know XP did this until recently, but I was pleasantly surprised by the way it actually asked what account I wanted to use. &nbsp;Vista forces elevation unless you rename the file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848743">
				<div id="div-comment-848743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ookii.org' rel='external nofollow' class='url'>Sven</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848743">
			July 26, 2010 at 7:44 am</a>		</div>

		<p>Althoug this is getting a bit off-topic, I&#39;ve also manifests misused. A popular weather add-on for Flight Simulator X needs to have write permissions to FSX&#39;s program directory, which is typically in Program Files, so the way they did this was by having a requireAdministrator manifest. Which means that it would always want to elevate, despite the fact that my FSX installation isn&#39;t in Program Files and my user account has write permissions where it&#39;s installed.</p>
<p>Even more unfortunately, this add-on couldn&#39;t connect to FSX if it was running as a different user; not a problem for &quot;protected administrators&quot; that elevate using their own token, but I run as an actual limited user, so the only way this would work is if I elevated FSX as well. I ended up using a resource editor to change the add-on&#39;s manifest.</p>
<p>More on topic, one thing that&#39;s annoying in Vista/7 is that there&#39;s no easy way to override the heuristic to detect installations in the absense of a manifest. Since as you say, the consequence of a false positive is &quot;program doesn&#39;t work&quot;. And yes, this has happened to me with programs that had no manifest, weren&#39;t installers, but Vista/7 decided they were.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848753">
				<div id="div-comment-848753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848753">
			July 26, 2010 at 8:48 am</a>		</div>

		<p>@Sven: &quot;in Vista/7 is that there&#39;s no easy way to override the heuristic to detect installations in the absense of a manifest&quot;. &nbsp;But doesn&#39;t Vista (or 7) ask you, after what it thinks was an installation that might not have worked, if it really worked right, and if not, if you want to re-run it in XP mode (or with elevated privileges, or something)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848783">
				<div id="div-comment-848783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">unekdoud</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848783">
			July 26, 2010 at 10:33 am</a>		</div>

		<p>Windows developers use game theory five times a day, I guess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848793">
				<div id="div-comment-848793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">XP x64</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848793">
			July 26, 2010 at 10:46 am</a>		</div>

		<p>Btw why does XP x64 edition and Server 2003 have a run as admin option in the Compatibility tab which XP 32-bit doesn&#39;t have?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848803">
				<div id="div-comment-848803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Administrator</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848803">
			July 26, 2010 at 10:50 am</a>		</div>

		<p>I never ran XP as non-admin so can anyone tell me does XP have the ability like Vista&#39;s UAC to elevate by prompting but without supplying any admin credentials?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848813">
				<div id="div-comment-848813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">XP x64</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848813">
			July 26, 2010 at 10:56 am</a>		</div>

		<p>I am referring to the &quot;Allow non administrators to run this program&quot; option in XP x64&#39;s compatibility tab. I mean even having that option in 32-bit XP&#39;s GUI and making non-admin default would have made users aware not to run as admin and developers not to require admin privileges for legacy apps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848823">
				<div id="div-comment-848823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">XP x64</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848823">
			July 26, 2010 at 11:04 am</a>		</div>

		<p>Or is that only an admin shim sort of like asInvoker?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848853">
				<div id="div-comment-848853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848853">
			July 26, 2010 at 11:50 am</a>		</div>

		<p>Reading all this, I wonder if a useful compatability shim would be application manifest lies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848883">
				<div id="div-comment-848883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexander Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848883">
			July 26, 2010 at 1:11 pm</a>		</div>

		<p>@ XP X64:</p>
<p>Because XP x64 (AKA Windows Server 2003 client SKU) is an OS different from XP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848913">
				<div id="div-comment-848913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848913">
			July 26, 2010 at 2:34 pm</a>		</div>

		<p>@Dichotomy: Debugger wants debug privilege.</p>
<p>1) Only service debugging requires this privilege.</p>
<p>2) You just gave away the farm.</p>
<p>It turns out that most so-called fine-grained privileges either equate to the same thing or could be accomplished with clever permission setting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848943">
				<div id="div-comment-848943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848943">
			July 26, 2010 at 6:34 pm</a>		</div>

		<p>That said, I&#39;d still be grateful if Windows will extend to auto-elevate those applications which filename contains &quot;setup&quot; and &quot;installer&quot;&#8230;</p>
<p>There&#39;s plenty of installer applications exist in the wild that have default naming like &quot;XXX-1.1.0.1-installer.exe&quot;&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848953">
				<div id="div-comment-848953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848953">
			July 26, 2010 at 7:08 pm</a>		</div>

		<p>@administrator: XP does the same as if you ran Vista/Win7 as a non-admin: it prompts for a username/password of an admin</p>
<p>in vista/win7, the difference is, you still get some sort of prompt even if you <em>ARE</em> an admin (but you don&#39;t need a username/password, just a elevate/cancel box)</p>
<p>@dichotomy:</p>
<p>I&#39;ll admin most of the individual permissions are too fine-grained for mere mortals to dabble with, but the user/group system of windows/NTFS is demonstrably better than the ugo bits of linux, for multi-user systems at least (and the problem is unsolvable without breaking backwards compatability, which is why selinux doens&#39;t work with many programs)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848963">
				<div id="div-comment-848963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">XP x64</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848963">
			July 26, 2010 at 7:10 pm</a>		</div>

		<p>@Alexander Grigoriev, everyone including you and me knows that. That doesn&#39;t answer why or tell any thing about that secretive option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848873">
				<div id="div-comment-848873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848873">
			July 26, 2010 at 12:21 pm</a>		</div>

		<p>Ok, now on Win7 I have a program that says &quot;asInvoker&quot; in its manifest, but &quot;7&quot; still wants to run it with elevated rights, and I have NO OPTION to run it *asInvoker*. Man, I simply want to run it with NORMAL RIGHTS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848973">
				<div id="div-comment-848973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848973">
			July 26, 2010 at 7:49 pm</a>		</div>

		<p>I actually use the NT access rights functionality a lot, mainly to make certain registry keys and files read-only for (otherwise legitimate) software.</p>
<p>No, I don&#39;t want a quick starter. That just wastes memory when I don&#39;t use it.</p>
<p>And if you want to have your program check for updates, plan a low-frequency job like Safari. Don&#39;t have a blighter constantly running in the background checking the date every five minutes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-848983">
				<div id="div-comment-848983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848983">
			July 26, 2010 at 8:48 pm</a>		</div>

		<p>@XP x64</p>
<p>Yes, it does. &nbsp;They are different operating systems with different feature sets. &nbsp;I don&#39;t see what&#39;s so secret about that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-848903">
				<div id="div-comment-848903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dichotomy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-848903">
			July 26, 2010 at 2:22 pm</a>		</div>

		<p>It&#39;s rather amusing that Window people tout NT&#39;s fine-grained privilege model as being a huge advantage over Unix&#39;s omnipotent-root one, but nobody uses these permissions. In reality, we just speak in terms of &quot;administrator&quot; and &quot;non-administrator&quot;.</p>
<p>Really, programs should specify what *privileges* they require in their manifests, those requests should be shown to the user, and programs should have only those privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849003">
				<div id="div-comment-849003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849003">
			July 26, 2010 at 10:13 pm</a>		</div>

		<p>I had some tax software do the same thing &#8211; it ran the auto-updater on startup, requiring admin. Well, the user isn&#39;t admin, but needs admin to run the program so the program could auto-update, and without, it won&#39;t run. Nevermind that there were no updates.</p>
<p>Disabling that functionality worked.</p>
<p>Most auto-updaters don&#39;t require elevation &#8211; you just check, download, then run the update you downloaded, which can ask for elevation. The updater should check and download. If updates aren&#39;t executable, have a helper do it, but checking shouldn&#39;t require elevation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849033">
				<div id="div-comment-849033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849033">
			July 27, 2010 at 1:58 am</a>		</div>

		<p>“Most auto-updaters don&#39;t require elevation &#8211; you just check, download, then run the update you downloaded, which can ask for elevation.”</p>
<p>This fails spectacularly with a certain popular VM runtime. It&#39;s installer would apparently download the update, then ask for elevation and, once elevated, be unable to find the downloaded update. Great design.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849053">
				<div id="div-comment-849053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849053">
			July 27, 2010 at 3:29 am</a>		</div>

		<p>Sadly I&#39;ve never needed to run regedit as a limited user, but even when I only want to look at my own HKCU it still wants to elevate. (Insert obligatory Dalek joke here.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849063">
				<div id="div-comment-849063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849063">
			July 27, 2010 at 3:43 am</a>		</div>

		<p>Just read this and am I understanding this correctly that installers named setup.exe on XP have their access rights elevated even when run as non-administrator uses? &nbsp;If so, I understand wanting to make installers work better for non-technical end users, but isn&#39;t this a security hole? &nbsp;If I send Joe or Jane Average User my spyware program, conveniently packaged as a setup.exe, they can install it even w/o admin privileges?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849073">
				<div id="div-comment-849073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849073">
			July 27, 2010 at 4:44 am</a>		</div>

		<p>@Mike, no it&#39;s not a security hole. If a non-admin runs setup.exe they get a RunAs prompt and have to enter Administrator credentials to run it (or they can select to just run it as themselves IIRC). If they don&#39;t know the credentials, it&#39;s not going to getthem any further.</p>
<p>As to those saying they get a prompt on Vista/7 with an AsInvoker manifest, that implies there is something wrong with either the manifest itself or how it was embedded. An embedded manifest will always override AppCompat shims.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849083">
				<div id="div-comment-849083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">XP x64</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849083">
			July 27, 2010 at 5:37 am</a>		</div>

		<p>@Nick, they are not completely different operating systems but two codebases of the mostly same OS with same feature set.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849093">
				<div id="div-comment-849093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849093">
			July 27, 2010 at 5:51 am</a>		</div>

		<p>@XPx64, I believe that was an option primarily aimed at Terminal Server scenarios which slipped into XP x64 as a result of it basically being a slightly tweaked version of Server 2003 x64.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849113">
				<div id="div-comment-849113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849113">
			July 27, 2010 at 6:41 am</a>		</div>

		<p>@AndyC: &quot;An embedded manifest will always override AppCompat shims.&quot;</p>
<p>I&#39;m not sure if this will solve nik&#39;s problem, but in Windows 7 you may need a new section in your manifest to override the Program Compatibility Assistant.</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/dd371711(VS.85).aspx" rel="nofollow">msdn.microsoft.com/&#8230;/dd371711(VS.85).aspx</a></p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/cjacks/archive/2009/06/18/pca-changes-for-windows-7-how-to-tell-us-you-are-not-an-installer-take-2-because-we-changed-the-rules-on-you.aspx" rel="nofollow">blogs.msdn.com/&#8230;/pca-changes-for-windows-7-how-to-tell-us-you-are-not-an-installer-take-2-because-we-changed-the-rules-on-you.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849233">
				<div id="div-comment-849233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alasdair King</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849233">
			July 27, 2010 at 9:32 am</a>		</div>

		<p>Windows Vista and later does auto-elevate more than just &quot;setup.exe&quot; &#8211; anything with &quot;Install&quot; or &quot;Setup&quot; in the filename will do it, I believe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849283">
				<div id="div-comment-849283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Humus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849283">
			July 27, 2010 at 1:11 pm</a>		</div>

		<p>I once wrote an graphics sample called N-Patches.exe, which triggered the UAC prompt in Vista. Took me quite a while to figure out what the heck was going on since no other samples had this problem. I think I ended up renaming it Tessellation.exe or something like that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849343">
				<div id="div-comment-849343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849343">
			July 27, 2010 at 4:41 pm</a>		</div>

		<p>@Anonymous Coward I tried that once with a specific web key that I didn&#39;t want installers writing to. &nbsp;Turns out if a certain company&#39;s installers can&#39;t write to them they treat it as a fatal error and roll back the entire install.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849353">
				<div id="div-comment-849353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849353">
			July 27, 2010 at 4:42 pm</a>		</div>

		<p>Err that should be registry key&#8230; I was thinking of the fact that it controlled loading add-ons for a popular web browser.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849363">
				<div id="div-comment-849363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849363">
			July 27, 2010 at 4:57 pm</a>		</div>

		<p>@Marquess:</p>
<p>That&#39;s not too surprising. &nbsp;As a limited user the only &quot;safe&quot; place to write files is your temp folder. &nbsp;And once you&#39;ve elevated with different credentials, &quot;the temp folder&quot; now points somewhere else. &nbsp;(In fact, depending on the user profile setup, the admin might not even be able to access the limited user&#39;s folders; I&#39;m not sure whether that applies to their temp folder as well or not, but it&#39;s certainly possible, and would horribly break things.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849383">
				<div id="div-comment-849383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849383">
			July 27, 2010 at 10:38 pm</a>		</div>

		<p>Heh, t5he elevation tripped me up when I was updating a music player program by a fruit company. I didn&#39;t realise that elevated apps ran as though they were logged in as the person you&#39;re elevating to. I expected a more Linux/Unix like behavior od &quot;sudo&quot; which can let you do things as root, but outside root. I guess elevation is more like &quot;su&quot; where you basically log in&#8230;</p>
<p>Took me a bit to figure that out &#8211; thought I lost stuff.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849373">
				<div id="div-comment-849373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asmodeus_dhoine</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849373">
			July 27, 2010 at 9:15 pm</a>		</div>

		<p>I have a question, unrelated to this post. I would really-really appreciate if you answered it.</p>
<p>In Linux systems there is a centralized repository of software that you can install from *and update* from one location. Of course, user can also install applications from other sources, but they can register with package manager.</p>
<p>Why is there no mechanism in Windows for software to register with Windows Update and update automatically? A program (or installer) could say &quot;Hi, Windows Update! It&#39;s me, Adobe Photoshop v. 12! Here&#39;s the address where my updates will be, please check this every now and then&quot;. This would take a burden of going through all installed applications to update them and also will alleviate the need in 3rd party updaters running in background. </p>
<p>I realize that this might be a security risk, since updates would be coming from unverified sources, but that could be addressed by, let&#39;s say, color-coded entries in Windows Update updates list or something like that. Risk should be explained to user and user must accept conditions before using this system.</p>
<p>Why can&#39;t Windows users have nice things like this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849413">
				<div id="div-comment-849413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">peterchen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849413">
			July 28, 2010 at 5:54 am</a>		</div>

		<p>@Miral &quot;That&#39;s nto surprising&quot; &#8211;</p>
<p>for a user, it is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849443">
				<div id="div-comment-849443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asmodeus_dhoine</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849443">
			July 28, 2010 at 7:20 am</a>		</div>

		<p>@ Marquess</p>
<p>Yes, this would entail some work and I doubt that would be a lot of work, but at the same time that would help companies keep their userbase on the latest software and avoid &quot;This crap doesn&#39;t work!&quot; feedback from users, using Product 1.0 when there&#39;s 1.6 already out. It&#39;s just so much easier for everybody.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849423">
				<div id="div-comment-849423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849423">
			July 28, 2010 at 7:01 am</a>		</div>

		<p>@Miral:</p>
<p>Two simple solutions:</p>
<p>1. Don&#39;t download if you can&#39;t install, but download *after* receiving elevation.</p>
<p>2. Admins always have full rights in users&#39; folders, as that makes their job much easier (they can just set rights at will anyway). So just run the installer with the path as a command line argument.</p>
<p>@asmodeus: “Why can&#39;t Windows users have nice things like this?”</p>
<p>IIRC, this is entirely possible, but the companies just aren&#39;t that much interested in this. This would entail work, after all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-849863">
				<div id="div-comment-849863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849863">
			July 30, 2010 at 7:28 am</a>		</div>

		<p>Once we had a helper executable called &lt;something&gt;setup.exe which was called by the main program to do some per-user setup. Needless to say, Vista&#39;s auto-elevation of everything named &lt;something&gt;setup.exe broke it (it depended on the redirection of writes to Program Files). That was worked around by renaming that executable, and later fixed (the software does not depend on the redirection of writes to Program Files anymore, and also does not use a separate helper executable too).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-849973">
				<div id="div-comment-849973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gechurch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-849973">
			July 31, 2010 at 8:54 am</a>		</div>

		<p>@asmodeus_dhoine</p>
<p>Microsoft wrote BITS &#8211; the Background Intelligent Transfer Service &#8211; to solve exactly this problem. It is intended to be a service applications that like to check for updates can register with. The update checks can then happen automatically in the background, at low priority, and without the overhead of creating yet another process. The BITS service has existed since at least Windows XP, yet it is surprisingly under-utilised, much to my chagrin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-850013">
				<div id="div-comment-850013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-850013">
			August 1, 2010 at 12:12 pm</a>		</div>

		<blockquote><p>
  Alasdair King: Windows Vista and later does auto-elevate more than just &quot;setup.exe&quot; &#8211; anything with &quot;Install&quot; or &quot;Setup&quot; in the filename will do it, I believe.
</p></blockquote>
<p>Why isn&#39;t this trivial fix back-ported to XP?</p>
<blockquote><p>
  Gechurch: Microsoft wrote BITS&#8230;it is surprisingly under-utilised, much to my chagrin.
</p></blockquote>
<p>It&#39;s because it&#39;s api, docs, and other stuff about it SUCK. MS&#39; goal with bits was not to give the user a better experience. It was developed as a back-door in windows to patch the os without the use knowing or could stop it. Bits and windows update is also tightly integrated with WGA and DRM, which does not help the users or other software developers in any way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-850033">
				<div id="div-comment-850033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Falcon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100726-00/?p=13323#comment-850033">
			August 1, 2010 at 9:34 pm</a>		</div>

		<p>@640k:</p>
<p>&quot;&gt; Alasdair King: Windows Vista and later does auto-elevate more than just &quot;setup.exe&quot; &#8211; anything with &quot;Install&quot; or &quot;Setup&quot; in the filename will do it, I believe.</p>
<p>Why isn&#39;t this trivial fix back-ported to XP?&quot;</p>
<p>It&#39;s been mentioned before that a &quot;simple&quot; fix can be far more complicated and risky than it seems to outsiders. In this particular case, some commenters here gave examples of the updated auto-elevation heuristic breaking compatibility. Now, imagine if an OS update introduced this problem &#8211; breaking compatibility by upgrading from Windows XP to Windows Vista is one thing; breaking it on an existing installation of Windows XP is quite another.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>