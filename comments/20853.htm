<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (29)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-668163">
				<div id="div-comment-668163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668163">
			September 17, 2008 at 12:19 pm</a>		</div>

		<p>But you&#8217;ve just run an article that told us how to use the least significant bits of a HANDLE! (I suppose you could call it &quot;balance&quot;.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668173">
				<div id="div-comment-668173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668173">
			September 17, 2008 at 12:41 pm</a>		</div>

		<p>Exactly; this seems like a mixed message to me. &nbsp;A program that relies on kernel handles always being multiples of 4 is ok, but a program that relies on window handles always being multiples of 2 is bad. &nbsp;I suppose someone will point out that the kernel handle implementation detail is documented whereas the window handle implementation detail is not documented. &nbsp;I understand that, but doesn&#8217;t Microsoft reserve the right to change implementation details at any time? &nbsp;If Microsoft &quot;fixed&quot; window handles to always be multiples of 2, isn&#8217;t it just as &quot;safe&quot; to rely on that as it is to rely on kernel handles being multiples of 4? &nbsp;And if enough programs relied on kernel handles being multiples of something other than 4 would Microsoft &quot;fix&quot; that detail as well?</p>
<p>My ultimate goal in life is to create a poorly written program so popular that Microsoft changes their implementation details to suit it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668183">
				<div id="div-comment-668183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.nickfitz.co.uk/' rel='external nofollow' class='url'>Nick Fitzsimons</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668183">
			September 17, 2008 at 12:51 pm</a>		</div>

		<p>&quot;I suppose someone will point out that the kernel handle implementation detail is documented whereas the window handle implementation detail is not documented. &nbsp;I understand that, but doesn&#8217;t Microsoft reserve the right to change implementation details at any time?&quot;</p>
<p>There is a pretty hefty distinction between documentation stating &quot;X is guaranteed to be Y&quot; and documentation stating that &quot;X is Y but this is an implementation detail and is subject to change&quot;.</p>
<p>If kernel handles are guaranteed to be multiple of four then it isn&#8217;t an implementation detail, it&#8217;s part of the specification.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-668193">
				<div id="div-comment-668193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668193">
			September 17, 2008 at 1:13 pm</a>		</div>

		<p>Ken Hagan: The difference is that the definition for file handles includes the fact that the low bit is always clear (in fact there are Win32 APIs that use the low bit in a handle to signal changes in behavior). &nbsp;The definition for window handles has no such guarantee.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668203">
				<div id="div-comment-668203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Abigail</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668203">
			September 17, 2008 at 1:38 pm</a>		</div>

		<p>Oh, John. I hope no one ever sets out to do that for the programs I code. And for MS, I&#8217;m sure it&#8217;s happened before&#8230; :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668213">
				<div id="div-comment-668213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668213">
			September 17, 2008 at 1:55 pm</a>		</div>

		<p>the phrase &quot;implementation detail&quot; pretty much means &quot;something that happens just now, but isn&#8217;t documented and might change&quot; so I don&#8217;t really understand people talking about &quot;documented implementation details&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668223">
				<div id="div-comment-668223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668223">
			September 17, 2008 at 2:16 pm</a>		</div>

		<blockquote><p>
  A program that relies on kernel handles always being multiples of 4 is ok
</p></blockquote>
<p>He didn&#8217;t say this&#8230; he just gave a technical example of why one could want to do this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668233">
				<div id="div-comment-668233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668233">
			September 17, 2008 at 3:23 pm</a>		</div>

		<p>&quot;But you&#8217;ve just run an article that told us how to use the least significant bits of a HANDLE!&quot;</p>
<p>IMO, even if it&#8217;s &quot;documented&quot; in the NT kernel line, it&#8217;s still evil to use. It doesn&#8217;t properly works with &quot;special&quot; handles (STD handles and current process handle).</p>
<p>In other words, it&#8217;s not proper Win32 code. For NT native code, it&#8217;s less evil; just bad programming practice.</p>
<p>Ulric wrote:</p>
<p>&quot;He didn&#8217;t say this&#8230; he just gave a technical example of why one could want to do this.&quot;</p>
<p>Yes, Raymond told us:</p>
<p>&quot;(This series was written in response to Igor Levicki being unable to imagine &quot;how this can save anything (in terms of performance)&quot;</p>
<p>Raymond just gave his &quot;imagination&quot;. This doesn&#8217;t make it good practice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668253">
				<div id="div-comment-668253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668253">
			September 17, 2008 at 4:52 pm</a>		</div>

		<p>Ah, it&#8217;s another version of the programmer&#8217;s 100 bottles of beer on the wall song:</p>
<p>100 implementation detail dependencies</p>
<p>fix one</p>
<p>release again</p>
<p>101 implementation detail dependencies</p>
<p>repeat until implementation detail dependencies is zero</p>
<p>This could take a while. &nbsp;;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xepol odd alt thread-odd thread-alt depth-1" id="comment-668273">
				<div id="div-comment-668273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Xepol' rel='external nofollow' class='url'>Xepol</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668273">
			September 18, 2008 at 1:50 am</a>		</div>

		<p>I&#8217;m still all for breaking software that uses &quot;undocumented features&quot; and putting the blame squarely where it belongs &#8211; on the developers who made up their own rules as they went along.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668283">
				<div id="div-comment-668283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668283">
			September 18, 2008 at 2:56 am</a>		</div>

		<p>&quot;and putting the blame squarely where it belongs &#8211; on the developers who made up their own rules as they went along.&quot;</p>
<p>How? If Microsoft just does that, the blame will be put on Microsoft!</p>
<p>Hey, the new version of Windows is broken, it isn&#8217;t compatible with &lt;big software of big company&gt; and with &lt;my favorite software&gt;!</p>
<p>Microsoft engineers surely maliciously put incompatibilities to force migration to newer software! Evil Microsoft!</p>
<p>I think backwards compatibility is reason #2 of Windows success, even if on the long run, it makes a system full of hacks.</p>
<p>(The reason #1 is the excellent Windows 3.x which provided a powerful graphical and multitasking for 640K computers).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668293">
				<div id="div-comment-668293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668293">
			September 18, 2008 at 4:19 am</a>		</div>

		<p>@Xepol: Ah, the luxury. Even though I work on a small company we still have to work around other companies inability to correctly integrate with our devices.</p>
<p>One such company has a bug in its communication with our devices and we get to take the blame for it. Why? Because the customer only sees that the communication doesn&#8217;t work with our devices. It works with other devices. Never mind that our devices communicate using a different protocol. It&#8217;s our fault, it&#8217;s always our fault. The same goes for Microsoft, if a program doesn&#8217;t work in Windows, it&#8217;s always Microsoft&#8217;s fault (no, I&#8217;m not being ironic, from a non-technical customers point of view it&#8217;s true).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668303">
				<div id="div-comment-668303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com' rel='external nofollow' class='url'>Dale</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668303">
			September 18, 2008 at 4:23 am</a>		</div>

		<p>Darn straight of the Product X dev acknowledging a problem, and getting it fixed.</p>
<p>&quot;Should only take five years, ten tops.&quot;</p>
<p>Oh the joys of application compatibility and legacy code!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-668313">
				<div id="div-comment-668313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668313">
			September 18, 2008 at 4:42 am</a>		</div>

		<p>&quot;If Microsoft just does that, the blame will be put on Microsoft!&quot;</p>
<p>Not if done properly. However, the effect will be the same anyway. &quot;Product X doesn&#8217;t work on Windows N+1&#8230; it&#8217;s clearly the fault of Product X&#8217;s developers, but I&#8217;m just going to stick with Windows N anyway.&quot;</p>
<p>People would not pay to upgrade to Windows N+1 and ALSO Product X N+1 just to get a version which works on the latest version of Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668323">
				<div id="div-comment-668323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668323">
			September 18, 2008 at 7:50 am</a>		</div>

		<p>&quot;You can finally use those odd handles once the next version of Product X comes out and the current version falls out of support. Should only take five years, ten tops.&quot;</p>
<p>Yeah, because backporting a patch to fix this issue, along with the other bugs, in the next minor/bugfix release of the current version is &#8230; what? Too hard? Oh no! The burden of a vendor actually fixing bugs in a product while it&#8217;s still being supported!</p>
<p>WTF?!?</p>
<p>I hope no-one is actually paying this vendor for this &quot;support&quot;, if the vendor isn&#8217;t using that money to fix the bugs that the product has.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668333">
				<div id="div-comment-668333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668333">
			September 18, 2008 at 8:19 am</a>		</div>

		<blockquote><p>
  &gt; I hope no-one is actually paying this vendor for this &quot;support&quot;, if the vendor isn&#8217;t using that money to fix the bugs that the product has.
</p></blockquote>
<p>For what ? Supporting a fix noone really needs (it works) ?</p>
<p>You should be grateful they fixed it in future releases, few software vendors would have done so.</p>
<p>(beside, it could even be argued this is a bug at all. it&#8217;s the use of an undocumented &quot;feature&quot;. There are entire products based only on the use of undocumented features).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668423">
				<div id="div-comment-668423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668423">
			September 18, 2008 at 12:15 pm</a>		</div>

		<p>Karellen:</p>
<p>I&#8217;m a long-time developer, currently working on Windows. &nbsp;There is a rather large set of reasons why an application might not comply to relevant API specs:</p>
<p>They are wrong (e.g., the icon description was correct for about windows 2.0. &nbsp;It&#8217;s wrong now)</p>
<p>Various coder magazines (both MSFT and non-MSFT) have published useful shortcuts that turn out to be a bad idea.</p>
<p>The specs have changed (this has especially happened in the network space)</p>
<p>They are ambiguous to be point of uselessness. &nbsp;(The sin function, for example, used to not specify whether it took radians or degrees)</p>
<p>The program had to work in a particular way, and the APIs or data structures had to be rather steamrollered to make everything work</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668493">
				<div id="div-comment-668493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Lill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668493">
			September 18, 2008 at 1:17 pm</a>		</div>

		<p>I was one of the original developers for the first few versions of Microsoft Project for Windows (oops, I wasn’t supposed to let that out) and I was the one who implemented this hack.</p>
<p>It was a dark and stormy day, way back in early 1990, when test discovered that project was running out of memory unrepentantly on non-protect mode Windows 2.01 running on 640K RAM and with no expanded memory cards installed. &nbsp;I traced the problem to the fact that Project 40 or so Windows controls to display its task from window and each of these controls required a few hundred bytes to be allocated from the user heap. &nbsp;At some point, Windows would need to reallocate the user heap but couldn’t because of memory fragmentation, locked code segments, etc.</p>
<p>We were close to our ship date and the only solution I could come up with that wouldn’t impact the rest of the code base was to implement my own set of Windows controls (list boxes, edit controls, labels, buttons, combo boxes, etc) that supported the exact same Windows messages but minimized the memory required and made sure that memory was not allocated from the user or GDI heaps. &nbsp;My only problem was that I needed an easy way for my message pump to be able to identify whether a window handle was a real Windows window or one of my windows, so I could forward the message to the right code. &nbsp;I noticed that Window handles at that time were just byte offsets into the user heap and that these offsets were always even, so I hacked my code to use odd handles to identify my windows. &nbsp;I knew that this was going to cause some grief for the Windows guys in the future, but this was the only way I could squeeze Project into 640K.</p>
<p>I left Project to form the original MSN team in 1992 and got some blowback from this. &nbsp;Windows/NT apparently had to do some rework after discovering this issue during backwards compatibility testing. &nbsp;That cost the Windows team some time and money, but Project has probably contributed better than $10B in profits to Microsoft over the years so it was probably a good trade off.</p>
<p>I’ve since run into two of the developers on the Windows side that had to deal with this, and we still chuckle about the good old days. &nbsp;It’s amazing that this code has remained in Project for something like 18 years. &nbsp;I guess, if it works, don’t mess with it.</p>
<p>&#8211;Jeff Lill</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668523">
				<div id="div-comment-668523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668523">
			September 18, 2008 at 3:30 pm</a>		</div>

		<p>I think the right approach (long overdue) for Microsoft would be: not to work around third party bugs, but when an user tries to start some cr@pware, put a nice message box:</p>
<p>&#8211;This version of Cr@ptastic Entertainment Dung Throwing Turnament may not run correctly in this version of Windows because of bugs in it. Contact Cr@ptastic Entertainment for a fix. Click this button for more technical details. Click this button to run it anyway&#8211;</p>
<p>This would keep the ISV developers in the line. And Microsoft&#8217;s legal department does have enough bodies to protect against Cr@ptastic Entertainment legal threats.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668343">
				<div id="div-comment-668343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668343">
			September 18, 2008 at 10:06 am</a>		</div>

		<p>&quot;For what ? Supporting a fix noone really needs (it works) ?&quot;</p>
<p>Depends. There are other implementations of Win32 than just Microsoft&#8217;s you know.</p>
<p>&quot;You should be grateful they fixed it in future releases, few software vendors would have done so.&quot;</p>
<p>WTF? I should be grateful that vendors actually comply to relevant API specs?!? Should I also be grateful if they release software that doesn&#8217;t randomly delete my hard drive? Rubbish. This is what vendors are *supposed* to do. This is what I&#8217;m paying them for when I buy their software, and when I pay for support. I should not be &quot;grateful&quot; to someone for upholding their end of a contract or bargain, I should *expect* it.</p>
<p>Seriously, the reason why most software is so damn awful is because of attitudes like this which *don&#8217;t* demand that bugs, once discovered, are fixed; which assumes it&#8217;s acceptable for software which you&#8217;ve paid money for to be broken.</p>
<p>Demand more from your vendors!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668563">
				<div id="div-comment-668563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668563">
			September 18, 2008 at 6:07 pm</a>		</div>

		<p>&quot;to implement my own set of Windows controls (list boxes, edit controls, labels, buttons, combo boxes, etc) that supported the exact same Windows messages but minimized the memory required and made sure that memory was not allocated from the user or GDI heaps.&quot;</p>
<p>Nowadays, this would be called windowless controls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668413">
				<div id="div-comment-668413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DEngh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668413">
			September 18, 2008 at 12:01 pm</a>		</div>

		<p>@Karellen: &nbsp;backports can be a huge PITA when the fix crosses with other, more-recent patches or changes for new functionality. &nbsp;Development &amp; testing cost real money and if there&#8217;s no market for a three-year-old version, where&#8217;s the incentive for a business to spend on it? &nbsp;By definition (for this thread) the software is working correctly for those that have it installed.</p>
<p>&#8230;.and even if it *is* done, convincing customers to install a new version in production when the old one is proven &amp; working correctly isn&#8217;t simple, either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668573">
				<div id="div-comment-668573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668573">
			September 18, 2008 at 7:44 pm</a>		</div>

		<p>Adam V,</p>
<p>I understand that was the logic behind putting those numerous kludges into Windows. Unfortunately, it backfired. The users got used to the idea, that all problems of the third party software is caused by Windows.</p>
<p>At least, Vista could have had such dialogs of shame.</p>
<p>And actually, XP SP doesn&#8217;t hesitate to say that the driver X is incompatible with the update.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668533">
				<div id="div-comment-668533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam V</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668533">
			September 18, 2008 at 4:04 pm</a>		</div>

		<p>Alexandre:</p>
<p>Try reading this <a href="http://blogs.msdn.com/oldnewthing/archive/2003/12/24/45779.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/12/24/45779.aspx</a> and then you&#8217;ll see why. I&#8217;d quote it, but it&#8217;d be the entire post.</p>
<p>If you upgrade to Windows X+1, and now that LOB app that you have to run *every day* pops up this stupid little box before it lets you run it, are you upset at the old version of the program, or are you upset at the new version of Windows? <a href="http://blogs.msdn.com/oldnewthing/archive/2003/12/23/45481.aspx#45510" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/12/23/45481.aspx#45510</a> And which one can you return and get your money back?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668543">
				<div id="div-comment-668543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668543">
			September 18, 2008 at 4:50 pm</a>		</div>

		<p>@Karellen: &quot;Depends. There are other implementations of Win32 than just Microsoft&#8217;s you know.&quot;</p>
<p>Ummm&#8230; No, there aren&#8217;t. Win32 specifically refers to 32-bit versions of Microsoft Windows. Any other implementations might be compatible with Win32, but they aren&#8217;t &quot;implementations of Win32&quot;.</p>
<p>&quot;Seriously, the reason why most software is so damn awful is because of attitudes like this which *don&#8217;t* demand that bugs, once discovered, are fixed; which assumes it&#8217;s acceptable for software which you&#8217;ve paid money for to be broken.&quot;</p>
<p>Sorry, but you&#8217;re wrong. If the current version of my product is 5, and a bug is discovered in 3 by someone who purchased it then but hasn&#8217;t bothered to upgrade since, they&#8217;re out of luck. If they want bug fixes, they need to stay current; the bug may have been fixed in v4, but they didn&#8217;t get it, and it&#8217;s not a bug for the current v5 or the immediately prior v4. Anything before v4 is out of date and out of support.</p>
<p>I&#8217;m all for vendors supporting their customers, but it goes both ways; the customer has to continue to support me. Continuing to run an outdated version and expecting ongoing work isn&#8217;t supporting me, but adding a burden, and I have enough of those.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668613">
				<div id="div-comment-668613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668613">
			September 19, 2008 at 4:39 am</a>		</div>

		<p>Vista has such dialogs of shame.</p>
<p>And it doesn&#8217;t contribute to its sales.</p>
<p>I need VS2002, it says me it&#8217;s incompatible, therefore I need XP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-668693">
				<div id="div-comment-668693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668693">
			September 19, 2008 at 12:03 pm</a>		</div>

		<p>&quot;Imagine another piece of software that uses the same trick, but uses the bit for a different purpose.&quot;</p>
<p>In fact, in this case, this is exactly what is happening:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/10/05/477802.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/10/05/477802.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-668643">
				<div id="div-comment-668643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-668643">
			September 19, 2008 at 8:13 am</a>		</div>

		<p>Whether documented or not, using the lower bits of a handle is fraught with risk. Imagine another piece of software that uses the same trick, but uses the bit for a different purpose. Can you prove that you never release the handles that you&#8217;ve changed &quot;into the wild&quot; where the other software might encounter them and misbehave? Can you prove that you never accept handles &quot;from the wild&quot; that might have originated from the other software. Bear in mind that the other software might be in-process. For example, it might be a library that was incorporated into a shell extension.</p>
<p>It seems to me that the effort required to prove it is safe exceeds the effort required to use an alternative mechanism (like a map that you maintain privately). A significant part of the risk is that not all of the code involved is code that you wrote. (Raymond will recognise this scenario. :) He is a clever guy, though, so he can probably *still* think of a counter-example.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-669183">
				<div id="div-comment-669183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bwhacks.com/forums/hardware-software/35457-another-example-software-issues-resulting-bad-development-not-os.html#post634889' rel='external nofollow' class='url'>Another example of software issues resulting from bad development and not the OS - BWHacks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080917-00/?p=20853#comment-669183">
			September 22, 2008 at 5:09 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.bwhacks.com/forums/hardware-software/35457-another-example-software-issues-resulting-bad-development-not-os.html#post634889" rel="nofollow">http://www.bwhacks.com/forums/hardware-software/35457-another-example-software-issues-resulting-bad-development-not-os.html#post634889</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>