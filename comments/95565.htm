<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1 parent" id="comment-1286125">
				<div id="div-comment-1286125" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286125">
			February 24, 2017 at 8:27 am</a>		</div>

		<p>Which reminds me, what was the initial purpose of the Shell Icons key? I remember using it back on Windows XP to give some custom 48*48-capable icons to some standard file types like .reg files, because I didn&#8217;t like the upscaled look&#8230;</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1286135">
				<div id="div-comment-1286135" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuri Khan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286135">
			February 24, 2017 at 8:46 am</a>		</div>

		<p>The Shell Icons registry key was available as far back as Windows 95.</p>
<p>The original Windows 95 release only had 16- and 256-color icons. A post-release add-on, Windows 95 Plus!, contained (among other things) multiple hi-color icon themes which its configuration utility activated by rewriting that key.</p>
<p>Perhaps supporting Plus! was the keyâ€™s sole intended purpose.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-scott-brickey even thread-odd thread-alt depth-1" id="comment-1286155">
				<div id="div-comment-1286155" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Scott+Brickey' rel='external nofollow' class='url'>Scott Brickey</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286155">
			February 24, 2017 at 9:02 am</a>		</div>

		<p>and here my assumption was that the app was intentionally trying to manipulate the system image lists in a bastardized attempt to do some sort of theming</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1286225">
				<div id="div-comment-1286225" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286225">
			February 24, 2017 at 12:04 pm</a>		</div>

		<p>See also <a HREF="https://blogs.msdn.microsoft.com/oldnewthing/20091202-00/?p=15823">don&#8217;t go changing the carpet</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1286295">
				<div id="div-comment-1286295" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286295">
			February 24, 2017 at 7:57 pm</a>		</div>

		<p>What about Shell_GetCachedImageIndex ?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks odd alt depth-2 parent" id="comment-1286315">
				<div id="div-comment-1286315" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286315">
			February 25, 2017 at 3:55 am</a>		</div>

		<p>All *shell* functions that interact with the system imagelist are safe to use but that does not mean it is a good idea. On Windows 95 the system imagelist is shared by all processes and therefore it is pretty rude to add your own images just because you don&#8217;t want to create a private imagelist. The system imagelist is supposed to make the system faster by caching icons that are used often.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1286345">
				<div id="div-comment-1286345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286345">
			February 25, 2017 at 2:37 pm</a>		</div>

		<p>I think we&#8217;ve long passed the point where we have to worry about Windows 95 :)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1286325">
				<div id="div-comment-1286325" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Haim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286325">
			February 25, 2017 at 9:24 am</a>		</div>

		<p>People should know by now that naming a class with a &#8220;C&#8221; prefix is not cool anymore. The nineties are long gone</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1286385">
				<div id="div-comment-1286385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286385">
			February 26, 2017 at 2:21 am</a>		</div>

		<p>I just assumed it was an mfc snippet, as opposed to qt or whatever. The _T() macro is a bit old school for Windows code but. But I bet Modern IDE&#8217;s could make it look flash again.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-deskrule odd alt thread-odd thread-alt depth-1 parent" id="comment-1286375">
				<div id="div-comment-1286375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/deskrule' rel='external nofollow' class='url'>deskrule</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286375">
			February 26, 2017 at 1:37 am</a>		</div>

		<p>to be fair to people that &#8220;misuse image lists&#8221;, once upon a time the shell assigned an empty &#8220;shell&#8221; imagelist to each process that requested one, so one got into the habit of using it more liberally. E.g. what is the &#8220;recommended&#8221; way to add a custom overlay image nowadays?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks even depth-2" id="comment-1286455">
				<div id="div-comment-1286455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170224-00/?p=95565#comment-1286455">
			February 26, 2017 at 4:02 pm</a>		</div>

		<p>It was not completely empty, it contains the first 5 or so images from the &#8220;global&#8221; imagelist (off the top of my head; unassociated file, closed folder, shortcut arrow overlay). Every process gets a new copy because some apps are buggy and NT was all about security and stability. It was shared on 9x because a lot of stuff was shared by all processes there. There is a function in shell32 you can call to get the fully populated list.</p>
<p>If you are not displaying the items exactly like the shell does then the shell imagelist is the wrong choice and you should use your own list (IMHO) but you might be able to pull it off with custom draw in listviews and treeviews.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>