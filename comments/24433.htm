<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (37)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-568953">
				<div id="div-comment-568953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">IanA</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-568953">
			November 21, 2007 at 11:35 am</a>		</div>

		<p>&quot;I&#8217;m not sure why the command processor folks decided to write documentation this way rather than the more traditional manner of putting it into MSDN or the online help&quot;</p>
<p>I guess it was done to help &#8216;legacy&#8217; Users, used to MSDOS (those most likely to use the command prompt?) where this was a typical practice. Of course, in old MSDOS days &#8216;online help&#8217; and &#8216;MSDN&#8217; were not around.</p>
<p>Although you are &#8216;not sure&#8217; I think you may guess the same, but I enjoyed the swipe at &quot;Editors&quot; that your uncertainty allowed&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-568963">
				<div id="div-comment-568963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://willrickards.net' rel='external nofollow' class='url'>Will Rickards</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-568963">
			November 21, 2007 at 11:37 am</a>		</div>

		<p>Thanks for the tip.</p>
<p>I&#8217;m using this (just implemented after I read your article) to correct a problem I was having. &nbsp;My cmd.exe always started in the H: drive. &nbsp;I could not figure out why. &nbsp;But by using the autorun I made it always change to the directory I want it to be, namely %HOME%.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-568983">
				<div id="div-comment-568983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nugae</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-568983">
			November 21, 2007 at 12:16 pm</a>		</div>

		<p>/? documentation is available wherever the cmd.exe program is available. It doesn&#8217;t require an Internet connection, it doesn&#8217;t require CDs full of documentation and massive programs to interpret and present that documentation. It never gets out of step with the program it is documenting.</p>
<p>Definitely it should be eliminated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569043">
				<div id="div-comment-569043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569043">
			November 21, 2007 at 12:44 pm</a>		</div>

		<p>What happens if you set Autorun to cmd.exe?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569053">
				<div id="div-comment-569053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569053">
			November 21, 2007 at 12:47 pm</a>		</div>

		<p>LOL. &nbsp;It does exactly what I hoped it wouldn&#8217;t do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569073">
				<div id="div-comment-569073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569073">
			November 21, 2007 at 12:57 pm</a>		</div>

		<p>It keeps launching cmd.exe until you run out of resources. &nbsp;Fortunately, it doesn&#8217;t open a new window for each instance. &nbsp;However, setting AutoRun to &quot;start&quot; results in the (un)desired effect. &nbsp;Nice!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569083">
				<div id="div-comment-569083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://barrkel.blogspot.com/' rel='external nofollow' class='url'>Barry Kelly</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569083">
			November 21, 2007 at 12:58 pm</a>		</div>

		<p>It looks to me that what&#8217;s missing is the distinction between interactive, login and nested shells.</p>
<p>Having commands for the startup of an interactive shells and login shells is usually quite useful. Interactive shell startup can add aliases, or do the chdir being demonstrated here. Login shells might run a program like fortune, for a qotd effect.</p>
<p>Finally, non-interactive nested shells such as those used in backquoting don&#8217;t have nearly as much use for such initialization.</p>
<p>It seems to me to add up to a deficiency in cmd.</p>
<div class=post>[<i>And people complain about feature creep. Name any program that distinguishes among those three scenarios. Remember the days when command line tools just did what they were told and didn&#8217;t try to second-guess you? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569093">
				<div id="div-comment-569093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569093">
			November 21, 2007 at 1:04 pm</a>		</div>

		<p>The documentation is available both in the on-line help for Windows and on TechNet (once in general for cmd.exe, and once specifically describing the Autorun key), as per your suggestions. The TechNet links are the following:</p>
<p><a rel="nofollow" target="_new" href="http://technet2.microsoft.com/windowsserver/en/library/fdc12a63-df4e-49e7-94d6-177536b18eb61033.mspx?mfr=true" rel="nofollow">http://technet2.microsoft.com/windowsserver/en/library/fdc12a63-df4e-49e7-94d6-177536b18eb61033.mspx?mfr=true</a></p>
<p><a rel="nofollow" target="_new" href="http://technet2.microsoft.com/windowsserver/en/library/149b2fc7-4715-4e57-9d49-dd7f4d84a1bc1033.mspx?mfr=true" rel="nofollow">http://technet2.microsoft.com/windowsserver/en/library/149b2fc7-4715-4e57-9d49-dd7f4d84a1bc1033.mspx?mfr=true</a></p>
<p>While it seems that the primary reason that you didn&#8217;t already find these is for lack of looking, if we require a justification for the command processor being able to list its own help text, then I think doing so is just as valid a tradition (in keeping with the expectations of those familiar with DOS or UNIX/Linux) as the newer tradition of putting documentation elsewhere. In addition, it&#8217;s my experience that I usually want information on command-line parameters when I am, in fact, already at the command line; incidentally, help for PowerShell is provided in the same format.</p>
<p>As regards the use of the Autorun entry: I personally use it to set Administrator&#8217;s command prompt to use red text rather than the standard grey, so as to distinguish an elevated prompt from a standard one at a glance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569113">
				<div id="div-comment-569113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hajo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569113">
			November 21, 2007 at 1:09 pm</a>		</div>

		<p>&quot;Like I said, I&#8217;m sure there must be some valid reason for the AutoRun setting, but I haven&#8217;t yet found one.&quot;</p>
<p>The AutoRun setting on my machines point to a batch file that contains, among other things, a line like</p>
<p>doskey /macrofile=&quot;%HOMEDRIVE%%HOMEPATH%doskey.mac&quot;</p>
<p>Very handy to have some shortcuts to frequently used commands with cryptic options.</p>
<p>Another tip what to do with it comes from Aaron Margosis: On &lt;<a rel="nofollow" target="_new" href="http://blogs.msdn.com/aaron_margosis/archive/2007/06/25/follow-up-on-setting-color-for-all-cmd-shells-based-on-admin-elevation-status.aspx&gt;" rel="nofollow"></a><a href="http://blogs.msdn.com/aaron_margosis/archive/2007/06/25/follow-up-on-setting-color-for-all-cmd-shells-based-on-admin-elevation-status.aspx&#038;gt" rel="nofollow">http://blogs.msdn.com/aaron_margosis/archive/2007/06/25/follow-up-on-setting-color-for-all-cmd-shells-based-on-admin-elevation-status.aspx&#038;gt</a>; he describes how to highlight CMD windows running with elevated user rights.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569153">
				<div id="div-comment-569153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ERock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569153">
			November 21, 2007 at 1:20 pm</a>		</div>

		<p>I had a soundcard that didn&#8217;t natively support work in a command window. I liked the features it had under Win95 but I wanted to run DOS things also.</p>
<p>It seemed to use this trick to run a TSR or some kind of initialization thingie to enable Soundblaster emulation while in a window. And it was much appreciated by me at least at tht time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569173">
				<div id="div-comment-569173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.vacant-nebula.com/' rel='external nofollow' class='url'>Kip</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569173">
			November 21, 2007 at 1:21 pm</a>		</div>

		<p>&quot;I&#8217;m not sure why the command processor folks decided to write documentation this way rather than the more traditional manner of putting it into MSDN or the online help&quot;</p>
<p>I prefer it this way. &nbsp;Maybe because I only actually have to look up stuff on MSDN once in a blue moon, but I can never seem to find what I&#8217;m looking for. &nbsp;In fact, I typically use Wikipedia now.</p>
<p>At the very least, it&#8217;d be nice if all of the commands, when run with /?, would give you the URL to the MSDN page on that command&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569193">
				<div id="div-comment-569193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Somedude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569193">
			November 21, 2007 at 1:36 pm</a>		</div>

		<p>Kip: for effective Microsoft searching, use google&#8217;s site search.</p>
<p>for example, to find the cmd documentation:</p>
<p>cmd.exe help site:microsoft.com</p>
<p>First result! &nbsp;I can&#8217;t believe how often Microsoft&#8217;s own search function completely messes me around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569203">
				<div id="div-comment-569203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569203">
			November 21, 2007 at 2:11 pm</a>		</div>

		<p>It&#8217;s not only that it&#8217;s hard to find what you&#8217;re looking for in MSDN; it&#8217;s that often you don&#8217;t know what to look for in the first place.</p>
<p>One trick I&#8217;ve figured out is to search for your topic, then when you find something that could be relevant, sync the page with the table of contents. &nbsp;Usually there will be something in or nearby the current page in the TOC that is useful (and of course this information will not show up in your searches). &nbsp;Otherwise, the search functionality in MSDN is COMPLETELY USELESS. &nbsp;Microsoft should just strip out the search functionality completely and save people countless hours of frustration.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569213">
				<div id="div-comment-569213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://thomasmccorkell.me.uk/' rel='external nofollow' class='url'>Thomas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569213">
			November 21, 2007 at 2:15 pm</a>		</div>

		<p>It&#8217;s very nice for loading doskey macros (I have shortcuts for navigating round, plus &quot;mcd&quot;=&quot;md &#8230; cd &#8230;&quot;, &quot;ls&quot;=&quot;dir&quot;, your &quot;whereis&quot;, etc.). I don&#8217;t set any environment variables in there &#8211; they&#8217;re all configured via Control Panel. I found that trying to do more complicated stuff in AutoRun made things break in various unexpected ways.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569243">
				<div id="div-comment-569243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pdw</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569243">
			November 21, 2007 at 2:37 pm</a>		</div>

		<p>&#8220;Name any program that distinguishes among those three scenarios.&#8221;</p>
<p>Unix shells :)</p>
<div class=post>[<i>They only distinguish two (login vs non-login; interactive and non-interactive are treated the same) and even then only because they are told whether they are the login shell or not. Windows doesn&#8217;t have a character mode login shell. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569253">
				<div id="div-comment-569253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sandman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569253">
			November 21, 2007 at 2:44 pm</a>		</div>

		<p>&lt;i&gt; Name any program that distinguishes among those three scenarios.&lt;/I&gt;</p>
<p>Bourne shell, csh, and ksh all do I believe. Generally via the -i and -l switches and also by using isatty() on stdin and stdout.</p>
<p>Of course since VC++2005 deprecates isatty() , I guess that wouldn&#8217;t be wise to use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569263">
				<div id="div-comment-569263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569263">
			November 21, 2007 at 2:45 pm</a>		</div>

		<p>Sounds similar to how its done in various UNIX shells, such as BASH&#8217;s .bashrc where you can put stuff to be run. Also Powershell has something similar.</p>
<p>Thanks for mentioning this, as I&#8217;ve sometimes wanted to do what &#8216;ak&#8217; above describes :) (thanks to ak as well!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569273">
				<div id="div-comment-569273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.einsteintech.net' rel='external nofollow' class='url'>Josh Einstein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569273">
			November 21, 2007 at 2:53 pm</a>		</div>

		<p>I use AutoRun to ensure that vcvarsall.bat is always run for every command prompt that I open, whether it be from Start -&gt; Run -&gt; cmd.exe (a hard habit to break) or right clicking a folder and running command prompt here. While I could dissect the batch file and load it all into the environment, I&#8217;d rather just use the one that comes with Visual Studio.</p>
<p>This way i know I can always run csc.exe, wsdl.exe, or whatever no matter how I got to the command prompt.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569283">
				<div id="div-comment-569283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569283">
			November 21, 2007 at 3:06 pm</a>		</div>

		<p>Raymond asked if there were any command line utilities that &quot;know&quot; what mode they&#8217;re in. &nbsp;Well, I know of one: devenv.exe (a.k.a., Visual Studio). &nbsp;It will decide whether to load environment customizations based on whether you&#8217;re command-line or not.</p>
<p>So if your build depends on the customizations, it will work in interactive mode, but not when you try to automate it.</p>
<p>And as Raymond says: this is horrid. &nbsp;It took us a day or so to figure out because it&#8217;s so counter-intuitive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569293">
				<div id="div-comment-569293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pdw</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569293">
			November 21, 2007 at 3:54 pm</a>		</div>

		<p>AIUI, Unix shells traditionally have three cases:</p>
<ul>
<li>Interactive login shell: read /etc/profile and ~/.profile</li>
<li>
<p>Any interactive shell: read the script specified by the ENV environment variable</p>
</li>
<li>
<p>Read nothing for non-interactive shells.</p>
</li>
</ul>
<p>The more featureful shells (bash, zsh) allow you to specify a script for the last case as well. Most shells also maintain a SHLVL variable to see how deep a shell is nested.</p>
<p>Now, I&#8217;m not saying all of this is necessarily useful (changing the behavior of non-interactive shells is actively evil, as you&#8217;ve pointed out). And the way it&#8217;s all configured in Unix is utterly chaotic.</p>
<p>And I don&#8217;t think you even can reliably distinguish interactive and non-interactive CMDs in Windows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-569343">
				<div id="div-comment-569343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569343">
			November 21, 2007 at 5:40 pm</a>		</div>

		<p>Legitimate use: preventing German spies from using your computer if you leave it unlocked by mistake.</p>
<p>HKCUSoftwareMicrosoftCommand ProcessorAutoRun = checkforgermanspies.bat</p>
<p>checkforgermanspies.bat:</p>
<p>@echo off</p>
<p>:BEGIN</p>
<p>if &quot;%ANSWER%&quot;==&quot;&quot; goto INTERROGATE</p>
<p>if &quot;%ANSWER%&quot;==&quot;Minnie Mouse&quot; goto RIGHTANSWER</p>
<p>goto WRONGANSWER</p>
<p>:INTERROGATE</p>
<p>echo Who is Mickey Mouse&#8217;s girlfriend?</p>
<p>set /p ANSWER=</p>
<p>goto BEGIN</p>
<p>:WRONGANSWER</p>
<p>echo Sound the alarm!</p>
<p>exit</p>
<p>:RIGHTANSWER</p>
<p>echo Sorry for all the trouble, citizen.</p>
<p><a rel="nofollow" target="_new" href="http://www.timeswrsw.com/N0506042.HTM" rel="nofollow">http://www.timeswrsw.com/N0506042.HTM</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569373">
				<div id="div-comment-569373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569373">
			November 21, 2007 at 6:58 pm</a>		</div>

		<p>I actually worked on something once where correctly identifying (and behaving differently based on the type of) logon session was important, but can&#8217;t remember for the life of me what it was now.</p>
<p>One valid reason for cmd.exe spewing it&#8217;s help text: if your internet access goes down. &nbsp;I can see this being redirected to a text file for easier browsing, though.</p>
<p>That autorun key is definitely a bomb waiting to explode. &nbsp;Once upon a time it could have been useful for an admin to put something helpful (or unhelpful, depending on who the admin is&#8230;) to the user in there, but these are not innocent times any more.</p>
<p>I just put &quot;exit&quot; in mine &#8211; oh joy!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569393">
				<div id="div-comment-569393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569393">
			November 21, 2007 at 7:23 pm</a>		</div>

		<p>First, I use the /? help all the time. &nbsp;Is there documentation elsewhere? &nbsp;I&#8217;ve certainly never seen it.</p>
<p>Second, the AutoRun function is very useful. &nbsp;The problem is that it doesn&#8217;t go far enough &#8212; there should be another key or two to specify additional commands, and an extra command line parameter (that&#8217;s automatically included when backquote recursing) to avoid running those extra commands. &nbsp;That way you can set up some commands that run all the time (eg. to set up basic environment variables) and some that only run for interactive command prompts. &nbsp;Easy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xepol odd alt thread-odd thread-alt depth-1" id="comment-569413">
				<div id="div-comment-569413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Xepol' rel='external nofollow' class='url'>Xepol</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569413">
			November 21, 2007 at 7:33 pm</a>		</div>

		<p>I suppose it makes up for the functionality lost when autoexec.bat and config.sys went the way of the dodo &#8211; no nice convenient way to get your cool command line prompt utilities into memory (like doskey).</p>
<p>I don&#8217;t know how useful this in currently, but I imagine it&#8217;s like other less useful reverse compatibly parts of windows &#8211; someone still needs them to do something stupid and MS hasn&#8217;t had the nerve to say &quot;hard cheese, buddy, time to update past windows 3.1!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569143">
				<div id="div-comment-569143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569143">
			November 21, 2007 at 1:18 pm</a>		</div>

		<p>I used to have a really long line of gunk in there, now its &quot;just&quot;: </p>
<p>title Console [%username%@%userdomain%] &amp;&quot;%ALLUSERSPROFILE%..CommonCmdInit.cmd&quot; &quot;%cd%&quot; &amp;cd &quot;..%username%desktop&quot;&gt;nul 2&gt;&amp;1 &amp;echo r0&gt;nul</p>
<p>CmdInit.cmd does a whole lot of stuff, figures out if the user is admin, if so, it changes the color to red. It also sets up a bunch of aliases and adds some stuff to %path% etc. here are some random snippets form it (are we getting off topic now?):</p>
<p>if exist &quot;%systemroot%system32cacls.exe&quot; &quot;%systemroot%system32cacls.exe&quot; &quot;%systemroot%system32configsystem&quot;&gt;nul 2&gt;nul&amp;&amp;color 0c</p>
<p>doskey alias=IF &quot;[$1]&quot;==&quot;[]&quot; (doskey/macros:ALL) ELSE (doskey $*)</p>
<p>doskey vcd=pushd %%$*%%</p>
<p>doskey ie=start iexplore.exe $*</p>
<p>doskey e=IF &quot;$1&quot;==&quot;&quot; (explorer /e,.) ELSE (explorer /e,$*)</p>
<p>doskey where=cmd/c (setlocal^^^&amp;set &quot;pe=.;%%path%%&quot;^^^&amp;@for %%a in ($1) DO @for %%b in (%%PATHEXT%%) DO @for %%c in (%%~na%%b) DO @if NOT &quot;%%~$pe:c&quot;==&quot;&quot; echo.%%~$pe:c)</p>
<p>set PROMPT=$M$+$P$G</p>
<p>set FP_NO_HOST_CHECK=</p>
<p>set LS_OPTIONS=-bhAC &#8211;color=auto &#8211;recent &#8211;streams</p>
<p>set GREP_OPTIONS=&#8211;binary-files=text -d skip &#8211;color=auto</p>
<p>it also checks for recursion and some env vars (%_MSDEV_BLD_ENV_% etc) so it knows when not to do its magic</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569433">
				<div id="div-comment-569433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569433">
			November 22, 2007 at 1:54 am</a>		</div>

		<p>Hmm&#8230; if one were truly evil, they&#8217;d set autorun &nbsp;to something like echo &quot;C:&gt;&quot;; pause; exit</p>
<p>Or just have it contain merely&#8230; &quot;exit&quot;</p>
<p>Would definitely confuse a bunch of people at work, where Windows CE and Windows Mobile require dropping to the command prompt at one point or another. Hmm&#8230; an idea to prank people with&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569463">
				<div id="div-comment-569463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569463">
			November 22, 2007 at 5:15 am</a>		</div>

		<p>I imagine this key might well be abused by malware.</p>
<p>Speaking of online help, it annoys me to no end that, since Windows XP, it does not document exit codes (aka errorlevels). I happen to know from DOS and Windows 2000 times that find.exe returns 0 when it finds the text, 1 when it doesn’t; but if I were a new Windows XP user, I would have no way to discover it. I am still at a loss on whether ping.exe returns anything useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569473">
				<div id="div-comment-569473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.asvguy.com' rel='external nofollow' class='url'>Burak KALAYCI</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569473">
			November 22, 2007 at 8:15 am</a>		</div>

		<blockquote><p>
  I&#8217;m not sure why the command processor folks decided to write documentation this way
</p></blockquote>
<p>I think it shows the dedication, love and respect to the product &#8211; having help embedded and making the product self contained.</p>
<p>It&#8217;s saying this to me: &#8216;We know this will be a part of a bigger system but let the user who lives and breathes in the command processor window survive without any external dependencies. There will be such users, &#8211; we are such users&#8217;&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569553">
				<div id="div-comment-569553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://xolox.ath.cx' rel='external nofollow' class='url'>Peter</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569553">
			November 22, 2007 at 12:59 pm</a>		</div>

		<p>@centaur: &quot;I am still at a loss on whether ping.exe returns anything useful.&quot;</p>
<p>Are you looking for official documentation or multiple exit codes? Otherwise, isn&#8217;t this enough:</p>
<blockquote><p>
  ping msdn.com
</p></blockquote>
<p>&#8230; (success)</p>
<blockquote><p>
  echo %ERRORLEVEL%
</p></blockquote>
<p>0</p>
<blockquote><p>
  ping doesnotexist
</p></blockquote>
<p>&#8230; (errormsg)</p>
<blockquote><p>
  echo %ERRORLEVEL%
</p></blockquote>
<p>1</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569603">
				<div id="div-comment-569603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569603">
			November 22, 2007 at 4:20 pm</a>		</div>

		<p>I have something similar to ak&#8217;s script in my Vista autorun entry&#8230; I make the color white on red if the command prompt is running elevated (instead of using cacls, my version tried to create a file in system32&#8230; I just changed it to use cacls instead, thanks ak!)</p>
<p>Here it is if anyone else wants to use it:</p>
<p>@echo off</p>
<p>cacls &quot;%systemroot%system32configsystem&quot; &gt; nul 2&gt; nul &amp;&amp; goto admin</p>
<p>:user</p>
<p>echo.</p>
<p>title User: Command Prompt</p>
<p>color 07</p>
<p>goto end</p>
<p>:admin</p>
<p>title Command Prompt</p>
<p>color 4F</p>
<p>goto end</p>
<p>:end</p>
<p>Remember there is no need for an &quot;Administrator&quot; prefix since Windows will automatically add one to consoles. &nbsp;The color just helps me remember not to use the console to relaunch explorer or other apps.</p>
<p>My old script was something like:</p>
<p>echo. &gt; &quot;%systemroot%system32delete.me&quot; 2&gt; nul</p>
<p>if exist &quot;%systemroot%system32delete.me&quot; goto admin</p>
<p>:user</p>
<p>&#8230;</p>
<p>:admin</p>
<p>del &quot;%systemroot%system32delete.me&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569673">
				<div id="div-comment-569673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569673">
			November 23, 2007 at 5:43 am</a>		</div>

		<p>&gt;Otherwise, the search functionality in MSDN is COMPLETELY USELESS. &nbsp;</p>
<p>&gt;Microsoft should just strip out the search functionality completely and</p>
<p>&gt;save people countless hours of frustration.</p>
<p>At the risk of appearing to jump on the MS-bashing bandwagon here, MSDN&#8217;s search really is pretty awful. &nbsp;At work we have a Google alias set up (despite having a full corporate MSDN subscription available locally) and use that to search MSDN, because the native search is so bad. &nbsp;Could someone please, please make this&#8230; well, at least less awful?</p>
<div class="post">[<i>Wow, if only there were a <u>Feedback</u> link on the MSDN search page. (Remember, feedback needs to be <a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/10/5386979.aspx" rel="nofollow">actionable</a>. &#8220;This sucks&#8221; is not actionable. &#8220;I searched for X but got Y instead&#8221; is actionable.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569823">
				<div id="div-comment-569823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569823">
			November 23, 2007 at 3:41 pm</a>		</div>

		<p>Getting the online help for command-line tools in Windows doesn&#8217;t require internet access.</p>
<p>On XP, it&#8217;s in the Start menu, in &quot;Help And Support&quot;</p>
<p>type &quot;CMD&quot;, it&#8217;s all there.</p>
<p>Raymond is right in questioning why the online help is in the .exe. &nbsp;It&#8217;s not right to do this: help needs to be handled by the documentation team and be TRANSLATED in multiple language.</p>
<p>Personally, I used JPSoft&#8217;s 4NT.</p>
<p>when you do /? for any commant, it launches WinHelp with the proper page.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569833">
				<div id="div-comment-569833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569833">
			November 23, 2007 at 3:43 pm</a>		</div>

		<p>Note that man pages and &quot;/?&quot; are not the same thing.</p>
<p>/? is suposed to be only for short reminder of parameters, while all the explanatory stuff is suposed to be in a separate doc. &nbsp;On Windows, it&#8217;s not man pages, it&#8217;s HTML help. &nbsp;In any case, my point is man pages are not embedded in the executable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-569733">
				<div id="div-comment-569733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569733">
			November 23, 2007 at 11:46 am</a>		</div>

		<p>&quot;If you type cmd /? at a command prompt, the command processor will spit out pages upon pages of strange geeky text. I&#8217;m not sure why the command processor folks decided to write documentation this way&#8230;&quot;</p>
<p>Raymond: &nbsp;Sorry to harp on your first paragraph, but &#8230; surely you know that if you type &quot;anycommand /?&quot; at a command prompt, like &quot;dir /?&quot; or &quot;time /?&quot;, you&#8217;ll get some documentation on what that command is supposed to do. &nbsp;(For most commands, anyway.)</p>
<p>Maybe it&#8217;s a *standard* for command-prompt commands? &nbsp;Left over from the standard for DOS commands, perhaps?</p>
<p>The &quot;cmd&quot; command does lots of things, and its built-in help is more complete and thorough than the built-in help for most commands. &nbsp;Don&#8217;t complain because it&#8217;s thorough! &nbsp;Seeing that complaint is very strange. &nbsp;Do you think terse documentation is preferable to good documentation? &nbsp;Should the subject be treated only in outline?</p>
<p>Type &quot;for /?&quot; to get a similarly long and very useful explanation of what the &quot;for&quot; command does.</p>
<p>There&#8217;s no reason to kill these &quot;man pages&quot; (in *nix terminology), and no reason there can&#8217;t be MSDN documentation also. &nbsp;The more documentation the better, as long as the different sources don&#8217;t contradict each other!</p>
<p>The creators of the command have the most control over the text displayed from using /?, and maybe they wanted the documentation to be complete and correct. &nbsp;Don&#8217;t fault them for that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-569953">
				<div id="div-comment-569953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Name, Title And Comment Required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-569953">
			November 24, 2007 at 10:02 am</a>		</div>

		<p>&quot;Unix shells :)&quot;</p>
<p>&quot;Bourne shell, csh, and ksh all do I believe.&quot;</p>
<p>And so on&#8230;</p>
<p>I find it amusing how a bunch of commenters felt the urge to tell a blogger whose name appears in the Linux kernel credits about these crazy &quot;Unix&quot; shells, especially when they&#8217;re wrong about how these shells behave.</p>
<p>Is the assumption that anyone who works at Microsoft must never have used Unix?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-570013">
				<div id="div-comment-570013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-570013">
			November 25, 2007 at 10:36 am</a>		</div>

		<p>&gt;Could someone please, please make this&#8230; well, at least less awful?</p>
<p>Actually it looks like it&#8217;s </p>
<p>&lt;a href=&#8221;<a href="http://www.codinghorror.com/blog/archives/000428.html%22%3Ealready" target="_new" rel="nofollow"></a><a href="http://www.codinghorror.com/blog/archives/000428.html" rel="nofollow">http://www.codinghorror.com/blog/archives/000428.html</a>&#8220;&gt;already been fixed&lt;/a&gt;. &nbsp;Apologies for the premature grumbling.</p>
<p>&gt;Wow, if only there were a Feedback link on the MSDN search page.</p>
<p>I&#8217;m aware of that, but I think submitting a link to Google with the text &#8220;Learn, guys&#8221; probably wouldn&#8217;t go down too well :-).</p>
<div class="post">[<i>You forgot to read the other half of my comment. The part that talks about actionable feedback. &#8220;You suck&#8221; isn&#8217;t actionable. &#8220;I searched for X using the search keyword Y and couldn&#8217;t find it&#8221; is actionable. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-573913">
				<div id="div-comment-573913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ialonso/archive/2007/12/04/another-good-reason-why-i-think-we-should-deprecate-autorun-setting-from-command-processor.aspx' rel='external nofollow' class='url'>La bodeguita de Nacho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071121-00/?p=24433#comment-573913">
			December 4, 2007 at 6:34 am</a>		</div>

		<p>The cause for this nasty to diagnose behavior was that in customer&#8217;s machine, when you ran &amp;quot;cmd.exe</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>