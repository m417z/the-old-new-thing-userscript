<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1 parent" id="comment-1253416">
				<div id="div-comment-1253416" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253416">
			June 22, 2016 at 7:20 am</a>		</div>

		<p>I had the unfortunate requirement of using a WinRT API in a win32 app that also supports older SDKs and MinGW (shameless plug; <a href="https://github.com/WndSks/Win32WinRTInterop_ShareContractSource" rel="nofollow">https://github.com/WndSks/Win32WinRTInterop_ShareContractSource</a> ) and that was not fun, never doing that again. When trying to do it at the lowest level you have to interact with interfaces that seem to be computer-generated, there are hundreds of them, all with really long names and probably not meant to be used by any human.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1253575">
				<div id="div-comment-1253575" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253575">
			June 23, 2016 at 9:42 am</a>		</div>

		<p>Yup. The interfaces were designed to be projected into something less awkward to use. There wasn&#8217;t much expectation that human beings would deal with them directly.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks even depth-3 parent" id="comment-1253585">
				<div id="div-comment-1253585" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253585">
			June 23, 2016 at 10:03 am</a>		</div>

		<p>Why was there not much expectation? Why was the share API never promoted for use in desktop apps? It does not even work correctly in desktop apps until Win10. MS usually want apps to light up on newer versions. In the past this was GetProcAddress and trying to create the new COM interfaces but starting with Win8 there were basically no new shell features and no helper functions for dealing with the new WinRT stuff. It&#8217;s the same story with Action Center in 10, no shell32 goodies and I don&#8217;t want to generate XML and deal with low-level undocumented interfaces just to get basic notification and tile support.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-4" id="comment-1253595">
				<div id="div-comment-1253595" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253595">
			June 23, 2016 at 10:11 am</a>		</div>

		<p>As you may have noticed, Windows 8 had a specific point of view with respect to separating new from old.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-archangelpip even thread-odd thread-alt depth-1 parent" id="comment-1253425">
				<div id="div-comment-1253425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253425">
			June 22, 2016 at 7:29 am</a>		</div>

		<p>Hmm, that link to the CCoInitialize class is using CoInitialize and CoUninitialize.<br />
I thought that when you used any WinRT objects in an application, you had to use RoInitialize.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1253435">
				<div id="div-comment-1253435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Curious</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253435">
			June 22, 2016 at 8:57 am</a>		</div>

		<p>&#8220;The Windows Runtime provides the RoInitialize function, which is a thin wrapper around CoInitializeEx.<br />
Despite the fact that CoInitializeEx is usually sufficient, I suggest you use RoInitialize. This function allows future improvements to be made to the Windows Runtime without potentially breaking classic COM. It’s analogous to OleInitialize, which also calls CoInitializeEx and then some. The point is that there’s nothing mysterious about your application’s main thread.&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-chris_guzak even depth-3 parent" id="comment-1253505">
				<div id="div-comment-1253505" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Guzak' rel='external nofollow' class='url'>Chris Guzak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253505">
			June 22, 2016 at 3:33 pm</a>		</div>

		<p>CoInit and RoInit do the same thing in desktop apps. they have slightly different behavior in modern processes. this can never change so it is fine to depend on it.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks odd alt depth-4" id="comment-1253546">
				<div id="div-comment-1253546" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253546">
			June 23, 2016 at 7:27 am</a>		</div>

		<p>Citation needed?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-archangelpip even depth-4" id="comment-1253698">
				<div id="div-comment-1253698" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253698">
			June 24, 2016 at 3:02 am</a>		</div>

		<p>This is actually directly contradictory to the official MSDN documentation.<br />
The documentation for CoInitializeEx actually says<br />
&#8220;You should call Windows::Foundation::Initialize to initialize the thread instead of CoInitializeEx if you want to use the Windows Runtime APIs or if you want to use both COM and Windows Runtime components. Windows::Foundation::Initialize is sufficient to use for COM components.&#8221;<br />
If you notice, it doesn&#8217;t limit it to WinRT API in new processes, so it also includes WinRT API in Win32 processes too. Another thing to note, Windows::Foundation::Initialize is in roapi and it calls RoInitialize.<br />
Using CoInitializeEx actually feels like a compatibility issue waiting to happened.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1253455">
				<div id="div-comment-1253455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253455">
			June 22, 2016 at 9:11 am</a>		</div>

		<p>I tried disambiguation. Is it a pattern? <a href="https://en.m.wikipedia.org/wiki/Projection" rel="nofollow">https://en.m.wikipedia.org/wiki/Projection</a>. Anyways must be something like that DirectX absrtacting graphics thing?. Anyway, I&#8217;m more interested in typescript at the moment. Because Javacscript isn&#8217;t the best, even with hints. &#8220;Ansi C&#8221; Javascript would be awesome.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1253475">
				<div id="div-comment-1253475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253475">
			June 22, 2016 at 10:07 am</a>		</div>

		<p><a href="https://www.infoq.com/presentations/windows-api-winrt" rel="nofollow">https://www.infoq.com/presentations/windows-api-winrt</a> </p>
<p>A little over 16 minutes in.  It is a way of presenting WinRT objects so that they appear native to the language.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matthew-manelahotmail-com odd alt depth-2" id="comment-1253495">
				<div id="div-comment-1253495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matthew+Manela' rel='external nofollow' class='url'>Matthew Manela</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253495">
			June 22, 2016 at 11:51 am</a>		</div>

		<p>Projection is a fairly widely used term with many meanings, both in computer science and in plenty of other disciplines. A common theme to the various meanings is that it usually involves a transformation that changes form but preserves function or meaning in some way. Think of shadow puppets: you are using light to project an image of your 3 dimensional hand onto a 2 dimensional surface. The form is changed because you&#8217;re losing a dimension, but it&#8217;s still an image of your hand, so in a sense the original meaning was preserved.</p>
<p>In computer science in general, this pattern is followed. Projection usually means taking some concept, code, api, what have you, and then transforming it in some way that is useful, but still preserves the original semantics as much as possible. This applies to the specific case Raymond is talking about: the low-level ABI is projected into the syntax and usage of each different language, but the semantics are preserved: calling widget.Method() in C# or widget.method() in JavaScript or widget-&gt;Method() in C++/CX will all end up running the same widget code. They&#8217;re just adapted to the conventions of each language.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1253485">
				<div id="div-comment-1253485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt (Visual Studio and Development Technologies MVP with C++ focus)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253485">
			June 22, 2016 at 10:12 am</a>		</div>

		<p>Wasn&#8217;t it enough to have bool, _Bool, BOOL, and BOOLEAN?  Do we really need to add &#8220;boolean&#8221; on top of all that?  Should we look forward to types named boole, Boole, and BOOLE?</p>
<p>Also, this &#8220;direct access&#8221; looks messier than real-COM-with-smart-pointers.  Are all the `GetAddressOf()` calls an artifact of the `WRL::ComPtr` choice of smart pointer?  Is there a choice?  (Note that I don&#8217;t want HRESULTs wrapped in exceptions and thrown, like the &#8220;Modern C++ Windows Runtime&#8221;&#8230; I just want my smart pointers to be smart, not get in the way)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-hardon odd alt depth-2 parent" id="comment-1253555">
				<div id="div-comment-1253555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/gdalsnes' rel='external nofollow' class='url'>gdalsnes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253555">
			June 23, 2016 at 7:57 am</a>		</div>

		<p>Wonder why it is not called Boolean, like System.Boolean, instead of inventing a new type that doesn&#8217;t exist in .NET.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-3" id="comment-1253565">
				<div id="div-comment-1253565" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253565">
			June 23, 2016 at 9:40 am</a>		</div>

		<p>If it were called Boolean, then wouldn&#8217;t it conflict with System.Boolean? And if it reused the type from System.Boolean, how would you use it from JavaScript?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt depth-2" id="comment-1253645">
				<div id="div-comment-1253645" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253645">
			June 23, 2016 at 2:50 pm</a>		</div>

		<p>boolean is at least 10 years old. It is unsigned char just like NTs BOOLEAN but maybe in those days they were still trying to maintain a strict wall between Win API and NT API for anyone outside MS.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-robrobpaveza-net even thread-even depth-1" id="comment-1253625">
				<div id="div-comment-1253625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Rob+Paveza+%5Bmsft%5D' rel='external nofollow' class='url'>Rob Paveza [msft]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253625">
			June 23, 2016 at 1:45 pm</a>		</div>

		<p>Two nits: 1.) While generally pushed, not all ABI methods must return an HRESULT, but if they don&#8217;t, they can&#8217;t throw exceptions.  2.) You shouldn&#8217;t use CCoInitialize there.  &#8220;New applications should call CoInitializeEx instead of CoInitialize. If you want to use the Windows Runtime, you must call Windows::Foundation::Initialize instead.&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1253925">
				<div id="div-comment-1253925" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253925">
			June 27, 2016 at 3:28 am</a>		</div>

		<p>Uhm, if I need both OLE (e.g. drag&amp;drop) and Windows Runtime (e.g. compass), what should I call (CoInitializeEx, OleInitialize, RoInitialize, Windows::Foundation::Initialize, something else) and in which order?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks even depth-2 parent" id="comment-1253945">
				<div id="div-comment-1253945" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253945">
			June 27, 2016 at 7:55 am</a>		</div>

		<p>You can stack STA Co* and Ole*: HRESULT hr = OleInitialize(); if (SUCCEEDED(hr)) DoSomething(), OleUninitialize();</p>
<p>I would assume that you can stack MTA Co* and Ro* as well?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1253965">
				<div id="div-comment-1253965" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160622-00/?p=93725#comment-1253965">
			June 27, 2016 at 8:46 am</a>		</div>

		<p>Almost.</p>
<p>You see, Windows::Foundation::Initialize ( <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/hh404185.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/windows/desktop/hh404185.aspx</a> ) mentions that the otherwise undocumented RO_INIT_SINGLETHREADED flag is not supported for desktop applications.</p>
<p>At best, you can use it in an MTA thread, but that implies marshaling.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>