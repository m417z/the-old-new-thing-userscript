<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1045273">
				<div id="div-comment-1045273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045273">
			March 14, 2013 at 7:24 am</a>		</div>

		<p>&nbsp; &nbsp;hr = m_pAnimationVariableRed-&gt;GetIntegerValue(&amp;red);</p>
<p>&nbsp; &nbsp;if (SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;hr = m_pAnimationVariableGreen-&gt;GetIntegerValue(&amp;green);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;if (SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hr = m_pAnimationVariableBlue-&gt;GetIntegerValue(&amp;blue);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Draw()</p>
<p>If you&#39;re going to animate 100 objects then I&#39;m going to need a wider monitor.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045293">
				<div id="div-comment-1045293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045293">
			March 14, 2013 at 7:54 am</a>		</div>

		<p>&quot;One of the annoying bits about Windows Animation is that you have to set up a bunch of stuff just to get things started. You need an animation manager, which is the object that runs the show. You also need an animation timer whose job is to tell the animation manager what time it is.&quot;</p>
<p>Welcome to 3D world Microsoft. You need a &quot;scene&quot; where the show takes places. You need a &quot;camera&quot;, the very thing that you see things through. You need light(s) to illuminate the objects / or you can embed the lights inside the objects. So NO Ray, those annoying bits are necessary. Use Ray&#39;s example on WMA folks, and you will make one step closer to 3D programming. I hardly can wait to shed off all the controls in WinForms and the only thing left in the world to be WPF (or the equivalent in other OS&#39;es)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045303">
				<div id="div-comment-1045303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kawa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045303">
			March 14, 2013 at 9:22 am</a>		</div>

		<p>I don&#39;t usually write in C++, but when I do I have experts like Chen hold my hand for every line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045323">
				<div id="div-comment-1045323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S&#246;k&#246;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045323">
			March 14, 2013 at 10:10 am</a>		</div>

		<p>@Danny: &quot;annoying&quot; != &quot;unnecessary&quot;. Also, Direct3D (<a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Microsoft_Direct3D" rel="nofollow">en.wikipedia.org/&#8230;/Microsoft_Direct3D</a>). You (apparently) heard it here first.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045333">
				<div id="div-comment-1045333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dsn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045333">
			March 14, 2013 at 10:14 am</a>		</div>

		<p>@jon</p>
<p>If only there was some kind of looping mechanism in C that Raymond could use :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045343">
				<div id="div-comment-1045343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045343">
			March 14, 2013 at 11:21 am</a>		</div>

		<p>@Jon: All of my COM-related code looks like that. I tried some rather elaborate alternatives having to do with templates and exceptions, but the results tended to be slower, more fragile, more difficult for other developers to modify &amp; understand, or some combination of all the preceding. It ends up being simpler the way Raymond coded it above, I think.</p>
<p>One alternative I do use, if the nesting gets too deep or modifications are likely in the middle, is to use goto.</p>
<p>(Now I&#39;ve done it. I&#39;ve started a holy war. Sorry, Raymond.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045363">
				<div id="div-comment-1045363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045363">
			March 14, 2013 at 12:05 pm</a>		</div>

		<p>COM is just ugly to program. &nbsp;Personally I use a rather simple macro to convert HR failures to exceptions as well as logging the line of code where the error occurred. &nbsp;</p>
<p>Something like:</p>
<p>HR(m_pAnimationVariableRed-&gt;GetIntegerValue(&amp;red));</p>
<p>HR(m_pAnimationVariableGreen-&gt;GetIntegerValue(&amp;green));</p>
<p>HR(m_pAnimationVariableGreen-&gt;GetIntegerValue(&amp;blue));</p>
<p>I find much easier to read, if performance isn&#39;t critical and I am already using exceptions.</p>
<p>Note: &nbsp;If you don&#39;t want exceptions, you can get the same effect without all the indenting by simply:</p>
<p>hr = m_pAnimationVariableRed-&gt;GetIntegerValue(&amp;red);</p>
<p>if (SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp;hr = m_pAnimationVariableGreen-&gt;GetIntegerValue(&amp;green);</p>
<p>if (SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp;hr = m_pAnimationVariableBlue-&gt;GetIntegerValue(&amp;blue);</p>
<p>if (SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp;Draw()</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045393">
				<div id="div-comment-1045393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045393">
			March 15, 2013 at 12:01 am</a>		</div>

		<p>@Paul M. Parks:</p>
<p>The use of goto won&#39;t turn into a big a thing as you may think, especially not in this situation. The issues with goto stemmed from people using it everywhere resulting in unreadable code. The use of goto here allows you to jump over all of the function calls that will never get executed when you are in a failed condition, so it simplifies the code and doesn&#39;t make it any harder to read or follow. I really don&#39;t think you will get attacked by a velociraptor here.</p>
<p>I also think the situation has changed drastically since goto obtained the stigma that it still has. Modern languages are a totally different beast. This means that the need for goto has decreased dramatically too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045403">
				<div id="div-comment-1045403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon R</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045403">
			March 15, 2013 at 5:35 am</a>		</div>

		<p>if (!SUCCEEDED(hr))</p>
<p>&nbsp; &nbsp;return hr;</p>
<p>(Assuming the function signature allows it to return the status)</p>
<p>???</p>
<div class="post">[<em>That requires RAII, which the sample code doesn&#39;t use. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045413">
				<div id="div-comment-1045413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045413">
			March 15, 2013 at 7:07 am</a>		</div>

		<p>@Simon R: &nbsp;That&#39;s usually a safe assumption with COM programming. &nbsp;COM strongly encourages you to make your COM-related functions return HRESULTs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1045423">
				<div id="div-comment-1045423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045423">
			March 15, 2013 at 8:47 am</a>		</div>

		<p>@Crescens2k: Yeah, that&#39;s pretty much what I was saying.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1045433">
				<div id="div-comment-1045433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130314-00/?p=4953#comment-1045433">
			March 16, 2013 at 2:23 am</a>		</div>

		<p>@Sökö</p>
<p>Pff, you missed my post by a mile. Read again and tell me when you stumble upon &quot;WPF&quot; word then go to your snarky comment about Direct3D and cry. Oh, you might read this as well: <a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Windows_Presentation_Foundation" rel="nofollow">en.wikipedia.org/&#8230;/Windows_Presentation_Foundation</a></p>
<p>But lemme quote from the beginning of article: &quot;Rather than relying on the older GDI subsystem, WPF utilizes DirectX&quot;. Now you can go and cry.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>