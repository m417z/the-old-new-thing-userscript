<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (7)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-mike_diack even thread-even depth-1 parent" id="comment-1250775">
				<div id="div-comment-1250775" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Diack' rel='external nofollow' class='url'>Mike Diack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250775">
			May 31, 2016 at 12:54 am</a>		</div>

		<p>Incidental (non-error checking comment) &#8211; Am I not right in thinking you should not use the preprocessor at all (for #define or #include) before #including a precompiled header? You seem to have done that with the Unicode #defines?</p>
<p>Useful code though!</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-archangelpip odd alt depth-2 parent" id="comment-1250785">
				<div id="div-comment-1250785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250785">
			May 31, 2016 at 2:53 am</a>		</div>

		<p>You are right there. But you also don&#8217;t normally need to define the Unicode defines because Visual Studio puts them on the command line.<br />
Also, don&#8217;t forget, stdafx.h is only a precompiled header if you set it to be one. If you create a console application using the basic win32 template, you have a choice to add a precompiled header. If you deselect it, the default template still uses the same files which include stdafx.h.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mike_diack even depth-3" id="comment-1250805">
				<div id="div-comment-1250805" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Diack' rel='external nofollow' class='url'>Mike Diack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250805">
			May 31, 2016 at 7:44 am</a>		</div>

		<p>True. :)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1250795">
				<div id="div-comment-1250795" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JFG</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250795">
			May 31, 2016 at 2:54 am</a>		</div>

		<p>Certain #define names/values flag an option in the header, so it *must* be done before the header is included.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hankhein even depth-2" id="comment-1250856">
				<div id="div-comment-1250856" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Henri+Hein' rel='external nofollow' class='url'>Henri Hein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250856">
			May 31, 2016 at 12:35 pm</a>		</div>

		<p>You will understand that I can not fail to refuse to disagree with you.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1250885">
				<div id="div-comment-1250885" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250885">
			May 31, 2016 at 2:25 pm</a>		</div>

		<p>I&#8217;m probably not being very imaginative, but in what circumstances would something care about the focused desktop item (especially as opposed to the currently selected item(s))?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-raykoopa even thread-even depth-1" id="comment-1250925">
				<div id="div-comment-1250925" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ray+Koopa' rel='external nofollow' class='url'>Ray Koopa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160530-00/?p=93535#comment-1250925">
			June 1, 2016 at 3:27 am</a>		</div>

		<p>I can&#8217;t think of any use-case for this&#8230; who would do that? =3 Though, coding wise surely interesting&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>