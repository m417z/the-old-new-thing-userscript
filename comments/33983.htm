<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (39)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-309733">
				<div id="div-comment-309733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309733">
			September 30, 2005 at 10:08 am</a>		</div>

		<p>I have Windows XP &lt;b&gt;Professional&lt;/b&gt;. Can I write device drivers too?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309743">
				<div id="div-comment-309743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309743">
			September 30, 2005 at 10:57 am</a>		</div>

		<p>Military Intelligence<br />
<br />Jumbo Shrimp<br />
<br />Visual Basic Professional<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309753">
				<div id="div-comment-309753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miles Archer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309753">
			September 30, 2005 at 10:58 am</a>		</div>

		<p>As a former VB programmer, I bet there is a clever way to do this. However, for the maintainer out there, I hope he didn&#8217;t succeed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309763">
				<div id="div-comment-309763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KristofU</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309763">
			September 30, 2005 at 11:09 am</a>		</div>

		<p>It&#8217;s a funny story but you didn&#8217;t answer his question.<br />
<br />Can it be done or not? And why not?<br />
<br />( I&#8217;m a C++ programmer btw, don&#8217;t know too much about VB )</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309793">
				<div id="div-comment-309793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan McCarty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309793">
			September 30, 2005 at 11:26 am</a>		</div>

		<p>If this was &#8217;95, the chatter probably had VB 6 or lesser, and while you could make calls to the 16/32-bit API, VB didn&#8217;t support callbacks.  So even with a bit of devilry I don&#8217;t see how you could set up your driver entry points (much less &quot;compile&quot; to a DLL).</p>
<p>It would make for a pretty neat hack, though, maybe on par with writing a book without the letter e or something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-309803">
				<div id="div-comment-309803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309803">
			September 30, 2005 at 11:30 am</a>		</div>

		<p>The question was about writing device drivers, not applications. Device drivers are written to a different API from Win32 and must observe very complex requirements. Plus you&#8217;d have to port the VB runtime library to kernel mode &#8211; the work required to do that would be greater than just writing the driver in C to begin with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309813">
				<div id="div-comment-309813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">spork</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309813">
			September 30, 2005 at 11:44 am</a>		</div>

		<p>The VB runtime would drag a whole raft of dependencies along, wouldn&#8217;t it?  Imagine having to have audio support configured in order to use your VB-based mouse driver, or somesuch.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309833">
				<div id="div-comment-309833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BTX</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309833">
			September 30, 2005 at 11:48 am</a>		</div>

		<blockquote><p>
  &gt;Plus you&#8217;d have to port the VB runtime library to kernel mode </p>
<p>so this is not possible with pure VB code?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309843">
				<div id="div-comment-309843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.luckie-online.de' rel='external nofollow' class='url'>Michael Puff</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309843">
			September 30, 2005 at 12:02 pm</a>		</div>

		<p>Same happens with Delphi over and over again. A friend of mine once wrote this short note, that tells, why it doesn&#8217;t work: <a rel="nofollow" target="_new" href="http://www.luckie-online.de/Developer/Artikel/GrenzenDelphi.shtml" rel="nofollow">http://www.luckie-online.de/Developer/Artikel/GrenzenDelphi.shtml</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-309863">
				<div id="div-comment-309863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309863">
			September 30, 2005 at 12:22 pm</a>		</div>

		<p>&quot;So this is not possible with pure VB code?&quot;</p>
<p>It depends on what you mean by &quot;pure VB code&quot;.  Are you referring to VB the language or VB the runtime environment?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309873">
				<div id="div-comment-309873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://perlmonks.org/?node=theorbtwo' rel='external nofollow' class='url'>theorbtwo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309873">
			September 30, 2005 at 12:32 pm</a>		</div>

		<p>Isn&#8217;t Microsoft now encouriging people to write drivers in C++, and even CLR?  (Please, correct me if I&#8217;m wrong; I don&#8217;t generally follow device-driver trends.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-edge odd alt thread-odd thread-alt depth-1" id="comment-309883">
				<div id="div-comment-309883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309883">
			September 30, 2005 at 12:33 pm</a>		</div>

		<p>Michael:</p>
<p>There&#8217;s no reason that a driver couldn&#8217;t be written in Delphi for NT. For &#8216;9x, you&#8217;d be correct that you wouldn&#8217;t be able to do it, but for NT it would be possible using a modified RTL.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309893">
				<div id="div-comment-309893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309893">
			September 30, 2005 at 1:13 pm</a>		</div>

		<p>You probably could write one in VB6. I wrote a mouse/cursor controller in QBasic (on Win95, for an intro to computers project) using peek and poke :) I know that isn&#8217;t a device driver (it just read from the driver&#8217;s place in memory), but if you had access to memory directly, its not impossible(at least on non-NT systems), right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309923">
				<div id="div-comment-309923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin Olbrantz (Quantam)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309923">
			September 30, 2005 at 2:56 pm</a>		</div>

		<p>A while ago I saw an ad on a web page for an OCX that allowed VB programs to handle IRQs, I/O and other driver-type things. I don&#8217;t think I could sleep for a week after seeing that :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309943">
				<div id="div-comment-309943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://matthew.chaboud.com' rel='external nofollow' class='url'>Matthew Chaboud</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309943">
			September 30, 2005 at 3:06 pm</a>		</div>

		<p>I think it would be easier for me to write a VB app that emitted the assembly for a driver than it would be for me to try and get the VB runtime environment into kernel mode.</p>
<p>That said, the year and change I spent working on a VB project (which integrated VB, STL, MFC, QT, and straight Win32 into one application) has still left me waking up at night.  Perhaps I&#8217;m just not the right person for the job.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309953">
				<div id="div-comment-309953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">microbe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309953">
			September 30, 2005 at 3:13 pm</a>		</div>

		<p>Drivers don&#8217;t have to be in kernel mode, at least on Linux. All you need is to be able to read/write an I/O port. I bet this is possible on Windows too.</p>
<p>Of course, only very simple drivers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-309963">
				<div id="div-comment-309963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309963">
			September 30, 2005 at 4:13 pm</a>		</div>

		<p>Let&#8217;s see if I learned something from my OS book. I think Windows drivers have to be in kernel mode, as opposed to Linux, where they run in user-mode. Even the windowing subsystem runs in kernel mode, which is the base of some (valid) rants from the Linux boys.<br />
<br />Now, having (read and write) access to memory doesn&#8217;t do the trick by itself, since the driver still need to manage other (privileged) system resources like the IRQ table (in order to reserve an interrupt for himself), I/O ranges, etc.<br />
<br />So, even if the developer use an OCX like the one described by Justed a few comments ago, he still needs to compille his driver&#8217;s code, the OCX and the VB-runtime to a DLL that can run in kernel-mode. Just like Raymond said, all that work is way harder than writting the driver in C in the first place.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309773">
				<div id="div-comment-309773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309773">
			September 30, 2005 at 11:14 am</a>		</div>

		<p>VB can call Windows API functions, so you probably *could* do it from VB, at least for a relatively simple driver. It&#8217;d probably be harder than doing it in C, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310013">
				<div id="div-comment-310013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.livejournal.com/users/merle_/' rel='external nofollow' class='url'>Merle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310013">
			September 30, 2005 at 6:56 pm</a>		</div>

		<p>I think I know the OCX Justin is talking about.  The name escapes me: it&#8217;s been about eight years, and the things the OCX gave you access to were scary.</p>
<p>And I didn&#8217;t think win95 drivers ran in kernel mode &#8212; I thought the distinction only existed in NT-based OSes (NT/2k/XP).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-309973">
				<div id="div-comment-309973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-309973">
			September 30, 2005 at 5:03 pm</a>		</div>

		<p>Eric: Not all Linux drivers run in user mode.  (In fact, the low-level drivers for almost all devices don&#8217;t.  However, the low-level driver for the video card, for instance, is distinct from the actual GUI rendering code.  The rendering code runs in usermode, the driver runs in kernel mode.  Similarly, the WPA/WPA2 supplicant runs in user mode, while the wireless card driver runs in kernel mode, but both are required before a WPA or WPA2 network may be used.)</p>
<p>If you want almost all drivers to be in user mode, try a microkernel OS.  I&#8217;ve heard that the Hurd is a microkernel.  I know that Minix is.</p>
<p>microbe&#8217;s point was that not all drivers *have* to run in kernel mode.  If all they need to do is make I/O requests to ports (memory-mapped I/O won&#8217;t work, though, so I think this precludes most PCI devices), then they can run in usermode, if they&#8217;re run by root.  Hence the &quot;only very simple drivers&quot; comment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310023">
				<div id="div-comment-310023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310023">
			October 1, 2005 at 1:34 am</a>		</div>

		<p>Michael Puff wrote:<br />
<br />&gt; A friend of mine once wrote this short<br />
<br />&gt; note that tells why it doesn&#8217;t work:<br />
<br />&gt; <a rel="nofollow" target="_new" href="http://www.luckie-online.de/Developer/Artikel/GrenzenDelphi.shtml" rel="nofollow">http://www.luckie-online.de/Developer/Artikel/GrenzenDelphi.shtml</a></p>
<p>/Now/ I understand !!</p>
<p>&quot;even if someone makes itself the work the DEVICE Driver kit (DDK) into Delphi LANGUAGE &#8216;translates&#8217;, it will determine, that does not have selbige language some features, those is extensively used there&quot;!</p>
<p>One of the few sentences perfectly translated by google was at the end: &quot;I hope that was clear enough.&quot; !!</p>
<p>:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310033">
				<div id="div-comment-310033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310033">
			October 1, 2005 at 3:09 am</a>		</div>

		<p>Re. microkernels, check out L4Ka.  Even the memory manager is in userspace.  (That still doesn&#8217;t mean drivers can have the same dependencies as applications, which is the key problem here.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310053">
				<div id="div-comment-310053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310053">
			October 1, 2005 at 4:28 am</a>		</div>

		<blockquote><p>
  It would make for a pretty neat hack, though,<br />
  <br />&gt; maybe on par with writing a book without the<br />
  <br />&gt; letter e or something.</p>
<p>I don&#8217;t know if you were purposefully alluding to this, but someone did in fact write a book of over 50,000 words without using the letter &#8216;e&#8217;.  <a rel="nofollow" target="_new" href="http://spinelessbooks.com/gadsby/index.html" rel="nofollow">http://spinelessbooks.com/gadsby/index.html</a></p>
<p>&gt; Isn&#8217;t Microsoft now encouriging people<br />
  <br />&gt; to write drivers in C++, and even CLR?</p>
<p>I don&#8217;t see anything wrong with writing device drivers in C++.  You would probably have to stay away from STL things that require support from whatever windows calls libstdc++, but you could certainly take advantage of some OO features.</p>
<p>I can&#8217;t see a CLR device driver ever existing though.  As someone said already, it would require the runtime VM being able to run in the kernel and that would be a SIGNIFICANT undertaking.</p>
<p>&gt; You probably could write one in VB6. I wrote<br />
  <br />&gt; a mouse/cursor controller in QBasic (on Win95,<br />
  <br />&gt; for an intro to computers project) using peek<br />
  <br />&gt; and poke :) I know that isn&#8217;t a device driver<br />
  <br />&gt; (it just read from the driver&#8217;s place in<br />
  <br />&gt; memory), but if you had access to memory<br />
  <br />&gt; directly, its not impossible(at least on non-NT<br />
  <br />&gt; systems), right?</p>
<p>The fact that you were doing this in DOS, which has no concept of usermode/kernel mode (or memory protection, privilege, etc) is why it was simple to do such a thing.</p>
<p>&gt; A while ago I saw an ad on a web page for an<br />
  <br />&gt; OCX that allowed VB programs to handle IRQs,<br />
  <br />&gt; I/O and other driver-type things. I don&#8217;t think<br />
  <br />&gt; I could sleep for a week after seeing that</p>
<p>I&#8217;m not familiar with this at all, but I would imagine that this works by having a surrogate / stub kernelmode driver written in C that just presents an interface to the hardware that the VB code can call.</p>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310083">
				<div id="div-comment-310083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310083">
			October 1, 2005 at 8:43 am</a>		</div>

		<blockquote><p>
  &gt; Isn&#8217;t Microsoft now encouriging people<br />
  <br />&gt; &gt; to write drivers in C++, and even CLR? </p>
<p>&gt; I don&#8217;t see anything wrong with writing device drivers in C++. You would probably have to stay<br />
  <br />&gt; away from STL things that require support from whatever windows calls libstdc++, but you could<br />
  <br />&gt; certainly take advantage of some OO features. </p>
<p>Actually, MS throws up some big caveats for developing drivers in C++.  It mostly has to do w/ C++ generating code &quot;behind the scenes&quot; (e.g, array constructors and such) and the developer not being able to explicitly control if this code goes into pageable or non-pageable memory.  A couple of years ago MS produced a white paper about it for devcon.</p>
<p>We develop our drivers in C++ and have run into this sort of issue before.  There&#8217;s places in our driver code with big warning comments like &quot;don&#8217;t move this seemingly-safe-to-page method to pageable memory because it&#8217;s keeping intrinsic function xx in nonpageable memory!&quot;.  egads.  All told, though, we prefer dealing w/ this sort of thing to coding in C.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310093">
				<div id="div-comment-310093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programme.luckie-online.de' rel='external nofollow' class='url'>Luckie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310093">
			October 1, 2005 at 10:47 am</a>		</div>

		<p>@Willi:<br />
<br />&quot;There&#8217;s no reason that a driver couldn&#8217;t be written in Delphi for NT. For &#8216;9x, you&#8217;d be correct that you wouldn&#8217;t be able to do it, but for NT it would be possible using a modified RTL.&quot;</p>
<p>It needs more than just modify the RTL. The resulting PE File must be modified as well, because the one genarted by Delphi wouldn&#8217;t be accepted by the kernel.<br />
<br />But you are right, Nico managed it for NT but he had tu surrender when Windows 2000 was released. ;)</p>
<p>For the others a short translation:<br />
<br />Delphi was developed and optimized for writing GUI applications for Windows. You can&#8217;t tell the Dephi Compiler to compile a PE file that will be accepted by the kernel.<br />
<br />The C headerfiles use special language features you can&#8217;t port to Delphi that easy. For example Microsoft specific calling conventions like fastcall and so on. Therfore there are no Units available for Delphi and you can start from the scratch with assembler, because ther is noch Memory Manager, no Compiler Magic, there&#8217;s nothing you can rely on.<br />
<br />It might work but you will come to the conclusen, that it needs a lot of work and a HexEditor, but it doesn&#8217;t make sense.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310113">
				<div id="div-comment-310113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">autist0r</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310113">
			October 1, 2005 at 12:35 pm</a>		</div>

		<p>GregF, what kind of driver did you write ?! Because there is no VB compiler that generates a sys and like Raymond said, the VB API doesn&#8217;t work in kernel mode&#8230; Unless you&#8217;re talking about a non-kernel driver ?</p>
<p>For C++ in KMD simply write a base class to have new and delete who are kernel friendly. You cannot use global objects because there is no atexit() call. WDK should change this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310123">
				<div id="div-comment-310123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">msemack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310123">
			October 1, 2005 at 2:26 pm</a>		</div>

		<p>There are toolkits that allow you to write Windows &quot;drivers&quot; in VB.  They&#8217;re user-mode drivers, though.</p>
<p><a rel="nofollow" target="_new" href="http://www.jungo.com/windriver_windows.html" rel="nofollow">http://www.jungo.com/windriver_windows.html</a></p>
<p>Basically, they have a &quot;universal&quot; driver that runs in kernel mode.  Your user-mode driver is basically a DLL which calls the kernel-mode component of WinDriver.  The kernel-mode part does all of the I/O on your behalf.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310133">
				<div id="div-comment-310133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Ken@Alverson.net' rel='external nofollow' class='url'>Ken</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310133">
			October 1, 2005 at 4:48 pm</a>		</div>

		<p>The man was simply ahead of his time :)</p>
<p>With the advent of the UMDF (<a rel="nofollow" target="_new" href="http://www.microsoft.com/whdc/driver/wdf/default.mspx" rel="nofollow">http://www.microsoft.com/whdc/driver/wdf/default.mspx</a>), writing drivers in Visual Basic .Net is not only supported, it&#8217;s encouraged!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310103">
				<div id="div-comment-310103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310103">
			October 1, 2005 at 11:56 am</a>		</div>

		<p>You *can* write drivers in VB (I have actually done this once) but its not really a good plan. You CAN write perfectly functional Services, though, even though Microsoft don&#8217;t recommend this, it works just fine if you have taken the time to understand what a good well-behaved Service should do &#8212; and NOT do.</p>
<p>It used to be perfectly normal to use little chunks of Assembler in QBASIC for hardware control. Ah, yes, the good old days.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310173">
				<div id="div-comment-310173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310173">
			October 2, 2005 at 2:15 pm</a>		</div>

		<blockquote><p>
  I don&#8217;t know if you were purposefully alluding<br />
  <br />&gt;to this, but someone did in fact write a book of<br />
  <br />&gt;over 50,000 words without using the letter &#8216;e&#8217;.<br />
  <br />&gt;<a rel="nofollow" target="_new" href="http://spinelessbooks.com/gadsby/index.html" rel="nofollow">http://spinelessbooks.com/gadsby/index.html</a> </p>
<p>If this sort of thing interests you, you should check out Ella Minnow Pea: A Progressively Lipogrammatic Epistolary Fable (<a rel="nofollow" target="_new" href="http://www.amazon.com/exec/obidos/tg/detail/-/0967370167/" rel="nofollow">http://www.amazon.com/exec/obidos/tg/detail/-/0967370167/</a>)</p>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310183">
				<div id="div-comment-310183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310183">
			October 2, 2005 at 4:00 pm</a>		</div>

		<p>Reminds me of someone I was talking to at a conference or something, who said that WINS does not work. &quot;I put a WINS server on the same subnet as my workstations, and they still couldn&#8217;t find any servers&quot;, he said. I said, &quot;did you point the workstations to the WINS server?&quot;. He said, &quot;what?&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310193">
				<div id="div-comment-310193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310193">
			October 2, 2005 at 7:19 pm</a>		</div>

		<p>No mention of kernel level VB hacking can pass without a mention of egg troll&#8217;s classic usenet post:</p>
<p><a rel="nofollow" target="_new" href="http://tinyurl.com/8qfxt" rel="nofollow">http://tinyurl.com/8qfxt</a></p>
<p>400 biters &#8211; exceptional!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310213">
				<div id="div-comment-310213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">memet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310213">
			October 2, 2005 at 8:35 pm</a>		</div>

		<p>I&#8217;m surprised nobody but &#8216;Andrew W&#8217; has made a comment about why you can&#8217;t write in high level languages.<br />
<br /> It is because the higher the level of the language, the more it does stuff behind the scenes. Which actually means that it executes code and accesses memory. Kernel drivers have a very specific mandate of not executing, or touching memory locations under certain circumstances (e.g. not touching paged memory while running &gt; DIRQL).<br />
<br /> I remember seeing a hack where a VB app was made to be multithreaded (by calling raw Win32 methods). It was interesting to see a development tool like that be pushed beyond its limit. But much more than the VB runtime, I think the actual compiler of VB would not be safe to even write the most trivial of a device driver.<br />
<br /> Especially given that the language does not have constructs such as pragma for flagging the executable with paging information &#8211; which C++ does have, and allows it to be remotely suitable for kernel programming.</p>
<p> Of course, I&#8217;m sure you could really hack this thing, and flag the entire driver to reside in non-paged memory. But let&#8217;s not even go there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310483">
				<div id="div-comment-310483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kbiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310483">
			October 3, 2005 at 2:25 pm</a>		</div>

		<p>Dan said, &quot;VB didn&#8217;t support callbacks. So even with a bit of devilry I don&#8217;t see how you could set up your driver entry points (much less &quot;compile&quot; to a DLL).&quot;</p>
<p>Actually VB did support call backs, just not officially.  You could use the three undocumented VarPtr, StrPtr, and ObjPtr, which you would have to use anyway to interact directly with a lot of the Windows API.</p>
<p>I still wouldn&#8217;t recommend it though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310493">
				<div id="div-comment-310493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spaces.msn.com/members/msolnit' rel='external nofollow' class='url'>Matt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310493">
			October 3, 2005 at 2:27 pm</a>		</div>

		<p>Dan McCarty,</p>
<p>VB 5 and 6 did in fact support callbacks, using the AddressOf operator.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310653">
				<div id="div-comment-310653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick Nack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310653">
			October 4, 2005 at 9:49 am</a>		</div>

		<p>ATI&#8217;s radeon drivers requires .net framework.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-310943">
				<div id="div-comment-310943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310943">
			October 4, 2005 at 11:06 pm</a>		</div>

		<p>Tuesday, October 04, 2005 9:49 AM by Nick Nack<br />
<br />&gt; ATI&#8217;s radeon drivers requires .net framework.</p>
<p>For display of property sheets and maybe the icon and menus in the notification area?  Or for the driver itself?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-310953">
				<div id="div-comment-310953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Picky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-310953">
			October 4, 2005 at 11:26 pm</a>		</div>

		<blockquote><p>
  ATI&#8217;s radeon drivers requires .net framework. </p>
<p>&gt; For display of property sheets and maybe the icon and menus in the notification area? Or for the driver itself?</p>
<p>Just for the control panel.  Not the driver itself.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-347673">
				<div id="div-comment-347673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/drnick/archive/2006/02/15/532214.aspx' rel='external nofollow' class='url'>Nicholas Allen's Indigo Blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050930-10/?p=33983#comment-347673">
			February 18, 2006 at 3:12 pm</a>		</div>

		<p>To answer a question I&#8217;ve heard a couple times now, WCF is almost entirely written in C#.&amp;amp;nbsp; And,&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>