<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (21)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-271673">
				<div id="div-comment-271673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dmitriy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271673">
			April 20, 2005 at 9:20 am</a>		</div>

		<p>Raymond are you not contradiciting yourself?<br />
<br />&gt; In practice, this means that the DC brush color is not trustworthy once you relinquish control to other code<br />
<br />Well, when your code returns you lost control.<br />
<br />Another words where is the guarantee that control uses your brush right away?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis odd alt thread-odd thread-alt depth-1" id="comment-271683">
				<div id="div-comment-271683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271683">
			April 20, 2005 at 9:27 am</a>		</div>

		<p>The trouble is that Windows doesn&#8217;t support the stock DC brush. Only certain specific versions of Windows support it.<br />
<br />In a corporate context that&#8217;s OK because you have some control; but in the wider world you can&#8217;t go excluding people from your market like that, so you have to have code that handles the other versions anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271693">
				<div id="div-comment-271693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271693">
			April 20, 2005 at 10:10 am</a>		</div>

		<p>If every DC has a DC brush, how does GetStockObject(DC_BRUSH) know which one to return?  Does it really just a return a magic handle value which the SelectObject call knows about?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271703">
				<div id="div-comment-271703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271703">
			April 20, 2005 at 10:20 am</a>		</div>

		<blockquote><p>
  SelectObject(hdc,GetStockObject(DC_BRUSH);<br />
  <br />&gt; SetDCBrushColor(hdc, RGB(00,0xff;00);<br />
  <br />&gt; PatBlt(0,0,200,200,PATCOPY)<br />
  <br />&gt; SetDCBrushColor(hdc,RGB(00,00,0xff);<br />
  <br />&gt; PatBlt(0,0,200,200,PATCOPY);</p>
<p>Did MSDN run out of closing parens? I will donate a few so the example compiles:</p>
<p> )))</p>
<p>:-)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-271713">
				<div id="div-comment-271713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271713">
			April 20, 2005 at 10:24 am</a>		</div>

		<p>Universalis: True, if you need to run on Windows 98, then you can&#8217;t use this.</p>
<p>Adrian: GetStockObject(DC_BRUSH) returns the DC brush. The DC brush doesn&#8217;t have a color itself; it takes its color from the DC. That&#8217;s the whole point of the DC brush.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271803">
				<div id="div-comment-271803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frank</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271803">
			April 20, 2005 at 12:21 pm</a>		</div>

		<p>Will this also work in metafiles?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271833">
				<div id="div-comment-271833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271833">
			April 20, 2005 at 3:00 pm</a>		</div>

		<p>Raymond&gt; I think the question was how does GetStockBrush(DC_BRUSH) know which DC you mean, since there is no HDC parameter?</p>
<p>Simon Cooke&gt; You bet I&#8217;m still supporting Win 98 and Me. The people who buy my software still use 98, and I sure as hell am not going to give up sales (meaning, lose money) by supporting only 2K+.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis odd alt thread-odd thread-alt depth-1" id="comment-271843">
				<div id="div-comment-271843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271843">
			April 20, 2005 at 3:37 pm</a>		</div>

		<p>Only about 5% of PC users use Windows XP. Similar proportions for 2000, NT4, and 98.<br />
<br />The remaining 80% of PC users use Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271773">
				<div id="div-comment-271773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271773">
			April 20, 2005 at 11:38 am</a>		</div>

		<p>&#8230; of course, if you&#8217;re still supporting Windows 98 today, 7 years after it came out, I feel for you, I really do.</p>
<p>Still, at least you&#8217;re not supporting Windows ME, right? *evil grin*</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271873">
				<div id="div-comment-271873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271873">
			April 20, 2005 at 7:46 pm</a>		</div>

		<p>It&#8217;s magical in a similar way that monochrome DDBs use the BkColor and TextColor of the DC it&#8217;s selected in as their palette as opposed to monochrome DIBs that use a palette stored in the bitmap header. GDI has all sorts of neat tricks like this hidden that not many people seem to know about (another one is that you can get the stock 1&#215;1 monochrome bitmap handle by passing a 0 width or 0 height to certain bitmap creation functions).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271923">
				<div id="div-comment-271923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian Tyborowski</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271923">
			April 21, 2005 at 5:23 am</a>		</div>

		<p>Unfortunately most of people give up 98 &#8211; including Microsoft, Matrox, freeware coders &#8211; no support, no drivers, even no apps anymore. I hate situation when I can&#8217;t use some software because one feature of XP, which could be, rather, easily implemented or just skipped, as unnecessary, under 98 &#8211; either by app&#8217;s coder or Microsoft. I.e. GUI+ and some of statistics functions &#8211; maybe it&#8217;s harder but in my opinion it needs only some exports [at least w/ faked, nearly empty functions] and modifications of blits. I.e. alpha effects could be done by simple, imperfect trick like that one used by Avast!. Then you get uprising compatibility and functionality.<br />
<br />Hmmm&#8230; Maybe it&#8217;s time to get my hands on such things :) .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271933">
				<div id="div-comment-271933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271933">
			April 21, 2005 at 8:48 am</a>		</div>

		<p>Adrian, why would Microsoft want to do the harder work to support Windows 98? They would rather you buy a new OS from them, and this is one way they can subtly apply pressure on you to do it. Obsolescence is not a feature of software, but you can build it in if you have a dominany market position.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-271943">
				<div id="div-comment-271943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-271943">
			April 21, 2005 at 8:55 am</a>		</div>

		<p>Moi: If you want to continue supporting Windows 98 then more power to you. It means that you can&#8217;t take advantage of features that don&#8217;t exist in Windows 98. Or are you saying Windows should never add any new features?  Should Windows 1.0 have been the last version of Windows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272163">
				<div id="div-comment-272163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Kalmes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-272163">
			April 21, 2005 at 3:39 pm</a>		</div>

		<p>This seems like a brittle way to implement WM_CTLCOLORSTATIC.  What if you have a custom control that queries WM_CTLCOLORSTATIC and WM_CTLCOLORDLG while drawing?  Is it true that the standard Windows controls will always use the brush immediately before sending any other CTLCOLOR messages?  (presumably yes)</p>
<p>It seems strange to force the drawing code to remember that the brushes it gets may become invalidated and change colors at odd times.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272233">
				<div id="div-comment-272233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-272233">
			April 22, 2005 at 3:08 am</a>		</div>

		<p>Okay Raymond, and now read my post in the context of Adrian&#8217;s post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-272273">
				<div id="div-comment-272273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-272273">
			April 22, 2005 at 9:19 am</a>		</div>

		<p>What do you suggest should be done to fix it? Should Windows stop adding features so people won&#8217;t be tempted to use them?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272593">
				<div id="div-comment-272593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-272593">
			April 25, 2005 at 3:56 am</a>		</div>

		<p>I believe Adrian already did this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272803">
				<div id="div-comment-272803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Ellis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-272803">
			April 25, 2005 at 1:21 pm</a>		</div>

		<p>Raymond, should you call DefWindowProc directly, or should you call it via CallWindowProc?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-289033">
				<div id="div-comment-289033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/07/06/436043.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-289033">
			July 6, 2005 at 10:00 am</a>		</div>

		<p>To position multiple child windows at one go.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-289353">
				<div id="div-comment-289353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/07/07/436043.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-289353">
			July 7, 2005 at 11:31 am</a>		</div>

		<p>To position multiple child windows at one go.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-289363">
				<div id="div-comment-289363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/07/06/436043.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050420-28/?p=35843#comment-289363">
			July 7, 2005 at 11:31 am</a>		</div>

		<p>To position multiple child windows at one go.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>