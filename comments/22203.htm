<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-632553">
				<div id="div-comment-632553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632553">
			May 23, 2008 at 10:26 am</a>		</div>

		<p>Is this the reason why it&#8217;s a bad idea to associate one of the Ctrl-X, Ctrl-C or Ctrl-V to an accelerator in a window that contains some edit controls ? The keystroke would be intercepted by the window instead of going to the editbox ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632583">
				<div id="div-comment-632583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632583">
			May 23, 2008 at 2:16 pm</a>		</div>

		<p>These sort of postings are my favorite. Keep up the good work, Raymond!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632613">
				<div id="div-comment-632613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrismcb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632613">
			May 23, 2008 at 8:11 pm</a>		</div>

		<p>Man if ONLY pies were this easy!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632623">
				<div id="div-comment-632623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">yme</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632623">
			May 23, 2008 at 11:27 pm</a>		</div>

		<p>Near the end, in &#8220;&#8230; tells you which window the user typed the key into; if that message is part of the first dialog &#8230;&#8221;, I guess &#8220;message&#8221; should be &#8220;window&#8221;?</p>
<div class=post>[<i>Fixed, thanks. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632643">
				<div id="div-comment-632643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">poenits</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632643">
			May 24, 2008 at 5:08 am</a>		</div>

		<p>If WM_KEYUP/KEYDOWN messages are sent to a top-level window, TranslateAccelerator is never called.</p>
<p>I&#8217;d add else TranslateAccelerator(msg.hwnd, hAccel, &amp;msg);</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632653">
				<div id="div-comment-632653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632653">
			May 24, 2008 at 6:10 am</a>		</div>

		<p>&quot;Is this the reason why it&#8217;s a bad idea to associate one of the Ctrl-X, Ctrl-C or Ctrl-V to an accelerator in a window that contains some edit controls ? The keystroke would be intercepted by the window instead of going to the editbox ?&quot;</p>
<p>I&#8217;d say it was a bad idea just because of the confusion. &nbsp;Whether it was the edit box or the window, you can bet at least one person would want their ctrl-x to be intercepted by the other one</p>
<p>(and why do ctrl-insert, shift-insert and shift-delete never get the wub?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632683">
				<div id="div-comment-632683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632683">
			May 25, 2008 at 1:44 am</a>		</div>

		<p>Wait a minute, semantically GetForegroundWindow is wrong. &nbsp;But in practice, how could it be wrong? &nbsp;</p>
<p>If you are getting the keyboard messages, then the user is not working in another application. &nbsp;You have the keyboard the focus; &nbsp;the foreground window is one of your windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632693">
				<div id="div-comment-632693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bigfoot</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632693">
			May 25, 2008 at 8:55 am</a>		</div>

		<p>&quot;Easy as pie&quot;</p>
<p>How easy is this?</p>
<p>Is it so easy even a caveman could do it? (ok, ok, caveperson)</p>
<p>Does the type of pie affect this, and is it relative? I prefer cherry over apple &#8211; is cherry easier for me and harder for someone else?</p>
<p>Who knew that Windows had such subtleties!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632703">
				<div id="div-comment-632703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632703">
			May 25, 2008 at 12:54 pm</a>		</div>

		<p>&quot;If you are getting the keyboard messages, then the user is not working in another application. &nbsp;You have the keyboard the focus; &nbsp;the foreground window is one of your windows.&quot;</p>
<p>It might have been the foreground window when the key was pressed, but there is no guarantee that it still is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632713">
				<div id="div-comment-632713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">blip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632713">
			May 25, 2008 at 5:43 pm</a>		</div>

		<p>@Ulric: Getting focus doesn&#8217;t mean raising to the top. Assuming that ruins everything for those who configure Windows to set focus on mouse hover. Those who hate it also turned on auto-raise, which sucks. But focus-on-hover is great, you should try it! (with 0ms delay, of course)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632733">
				<div id="div-comment-632733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632733">
			May 26, 2008 at 12:40 am</a>		</div>

		<p>@blip, The ForeGround window is not the window on top. &nbsp;It is defined as the one the user is working in, not the Z order.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-632743">
				<div id="div-comment-632743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632743">
			May 26, 2008 at 7:45 am</a>		</div>

		<p>@Ulric: The reason you shouldn&#8217;t use GetForegroundWindow() is because the code is executed asyncronously from the keypress (during the message queue loop), and the user may have switched the foreground window before the code is executed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-632753">
				<div id="div-comment-632753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080523-00/?p=22203#comment-632753">
			May 26, 2008 at 8:43 am</a>		</div>

		<p>@Andy:</p>
<p>Many programmers ignore that Windows is a preemptive multitasking OS. Sad but true.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>