<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (12)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-610923">
				<div id="div-comment-610923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan_works</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-610923">
			March 19, 2008 at 10:06 am</a>		</div>

		<p>The customer&#8217;s comment seems more like your regular entries where the correct plan of action is not to tell the customer how to do what they ask, but get them to say what they really want. By backing away from the specific request to a more big-picture &quot;what are you trying to do/accomplish,&quot; since what they originally ask for is usually wrong or doesn&#8217;t make sense..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-610943">
				<div id="div-comment-610943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-610943">
			March 19, 2008 at 12:22 pm</a>		</div>

		<p>There&#8217;s also the (very useful) CreateStreamOnHGlobal function (so you never give the HGLOBAL directly)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-610953">
				<div id="div-comment-610953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">herd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-610953">
			March 19, 2008 at 1:23 pm</a>		</div>

		<p>Does this work with virtual folder trees as well?</p>
<p>I could imagine that the cFileName member of the FILEDESCRIPTOR structure could hold subfolder names like &quot;.SubFldFile.txt&quot; and the shell would create the folder on the fly if it does not exist already, else show me the [this folder already contains a folder named &#8216;SubFld&#8217;&#8230;] dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-610933">
				<div id="div-comment-610933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-610933">
			March 19, 2008 at 11:07 am</a>		</div>

		<p>The customer can replace their &quot;dummy file&quot; with a FILEGROUPDESCRIPTOR with cItems equal to the count of files, and with each item being an IStream pointer (where reads from the stream give data from the original files &#8212; I bet there&#8217;s a shell interface to create this type of IStream object, but I&#8217;d have to look it up).</p>
<p>This would give the same effect as dragging multiple files from a folder, but since the source isn&#8217;t Explorer, the user doesn&#8217;t actually have to go select all those files. &nbsp;They can simply drag some &quot;single object&quot; from the customer&#8217;s program instead.</p>
<p>(This will also work when the target isn&#8217;t Explorer (aka isn&#8217;t a directory). &nbsp;What they&#8217;re asking for (finding the target path) won&#8217;t work in that case.)</p>
<p>It *sounds* like what they want to accomplish is copying a bunch of files while only making the user drag a single item. &nbsp;But of course, if that&#8217;s not really it, then this solution won&#8217;t help either. &nbsp;:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-610993">
				<div id="div-comment-610993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-610993">
			March 19, 2008 at 8:25 pm</a>		</div>

		<p>Thanks for this series, really helpful</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-611003">
				<div id="div-comment-611003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">non-english</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-611003">
			March 20, 2008 at 5:53 am</a>		</div>

		<p>What does the phrase &quot;What a drag&quot; mean?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-611013">
				<div id="div-comment-611013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">clipboard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-611013">
			March 20, 2008 at 6:00 am</a>		</div>

		<p>Is this info useful for programs to store virtual files in the clipboard? Is that possible?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-madq42 odd alt thread-odd thread-alt depth-1" id="comment-611023">
				<div id="div-comment-611023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MadQ1' rel='external nofollow' class='url'>MadQ1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-611023">
			March 20, 2008 at 8:29 am</a>		</div>

		<p>@non-english: In this particular case it is definition #18 at <a rel="nofollow" target="_new" href="http://dictionary.reference.com/browse/drag" rel="nofollow">http://dictionary.reference.com/browse/drag</a></p>
<p>&quot;(noun) 18. Slang. someone or something tedious; a bore: It&#8217;s a drag having to read this old novel.&quot;</p>
<p>Raymond is really just using it as a rethoric device, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-611063">
				<div id="div-comment-611063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-611063">
			March 20, 2008 at 12:26 pm</a>		</div>

		<p>@MadQ</p>
<p>I like the way you explain &quot;what a drag&quot; means but leave it to &quot;non-english&quot; to work out what rhetorical device means.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-madq42 odd alt thread-odd thread-alt depth-1" id="comment-611083">
				<div id="div-comment-611083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MadQ1' rel='external nofollow' class='url'>MadQ1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-611083">
			March 20, 2008 at 2:24 pm</a>		</div>

		<p>Teach someone how to fish ;-) If he followed the link, he was already at the right place. Also, if he speaks any germanic- or latin-based language (or Greek,) he&#8217;ll know what it means.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-611893">
				<div id="div-comment-611893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas Nilsson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-611893">
			March 24, 2008 at 4:29 pm</a>		</div>

		<p>Any recommendations / hints to allow users to drag-n-drop a IShellLink (created-on-the-fly as an IStream) from an app-window to the desktop?</p>
<p>Thanks in advance,</p>
<p>Andreas Nilsson</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-612523">
				<div id="div-comment-612523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080319-00/?p=23073#comment-612523">
			March 25, 2008 at 2:24 pm</a>		</div>

		<p>You could create whatever kind of stream (probably backed by a fairly large amount of memory? &nbsp;or possibly something that reallocates memory on the fly as needed), create an instance of ShellLink (the default object that implements IShellLink), QI for IPersistStream, then save the IShellLink to the stream you created above. &nbsp;Then hand that stream off to the DnD interfaces.</p>
<p>At least, I *think* that should work (though I don&#8217;t know how the shell would know if the object being passed to it is also a shell link: maybe there&#8217;s a flag in the FORMATETC stuff). &nbsp;Never tried it. &nbsp;:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>