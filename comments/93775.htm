<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (25)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-jeremytais even thread-even depth-1 parent" id="comment-1254325">
				<div id="div-comment-1254325" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/SimonRev' rel='external nofollow' class='url'>SimonRev</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254325">
			June 29, 2016 at 7:07 am</a>		</div>

		<p>Am I the only one who feels vaguely guilty &#8212; like I am lying under oath &#8212; when I check the &#8220;I solemnly swear that &#8216;Visual Studio&#8217; is a game&#8221; checkbox that appears when you press Win+G?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1254405">
				<div id="div-comment-1254405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254405">
			June 29, 2016 at 8:07 am</a>		</div>

		<p>It&#8217;s hard to really nail down a good definition for &#8220;game&#8221;. I&#8217;ve heard good arguments for things like Stack Overflow and even Facebook as each being a &#8220;game&#8221; by some reasonable definitions. I see no reason why Visual Studio couldn&#8217;t be a game.</p>
<p>Especially as sometimes one has a tough time with the boss fights…</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1254435">
				<div id="div-comment-1254435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin Puetz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254435">
			June 29, 2016 at 9:27 am</a>		</div>

		<p>I&#8217;m not seeing a problem here &#8211; VS even has achievements! <a href="https://channel9.msdn.com/achievements/visualstudio" rel="nofollow">https://channel9.msdn.com/achievements/visualstudio</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1254505">
				<div id="div-comment-1254505" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254505">
			June 29, 2016 at 10:42 pm</a>		</div>

		<p>And, of course, the achievements you can earn &#8211; <a href="https://channel9.msdn.com/achievements/visualstudio" rel="nofollow">https://channel9.msdn.com/achievements/visualstudio</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1254335">
				<div id="div-comment-1254335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254335">
			June 29, 2016 at 7:11 am</a>		</div>

		<p>Sorry &#8211; pet peeve of mine &#8211; &#8220;&#8230; by using the using statement&#8221;. No, you cannot. The using statement is used to clean up resources by calling Dispose at the end of its embedded statement. You can simplify your use of namespaces by using a using directive.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1254365">
				<div id="div-comment-1254365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programmerman.net/' rel='external nofollow' class='url'>Nick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254365">
			June 29, 2016 at 7:50 am</a>		</div>

		<p>There are two uses of the using keyword in C#. Raymond is referring to the one where you declare you&#8217;re using namespaces at the top of the file, like using System; or using System.Linq;.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1254385">
				<div id="div-comment-1254385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programmerman.net/' rel='external nofollow' class='url'>Nick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254385">
			June 29, 2016 at 7:54 am</a>		</div>

		<p>Oh I see now, sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt thread-even depth-1 parent" id="comment-1254345">
				<div id="div-comment-1254345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254345">
			June 29, 2016 at 7:23 am</a>		</div>

		<p>No dice roll on the ComPtr class? My problem with all of this is that if I go to MSDN.com and search for &#8220;IGameBarStatics&#8221; I get zero results. MSDN assumes that nobody uses plain C++ anymore.</p>
<p>Also, you can just change _tcslen to lstrlen and the tchar.h issue would go away although it is the only thing in this post that is still the oldnewthing ;)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-archangelpip even depth-2" id="comment-1254425">
				<div id="div-comment-1254425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254425">
			June 29, 2016 at 9:03 am</a>		</div>

		<p>Yeah, you have to balance between knowing the ABI and the projection to get the documentation on these things. It is easy enough to piece things together from the headers, but having to look through the headers is the problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tautvydas-zilys odd alt depth-2" id="comment-1254666">
				<div id="div-comment-1254666" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Tautvydas+Zilys' rel='external nofollow' class='url'>Tautvydas Zilys</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254666">
			June 30, 2016 at 9:53 am</a>		</div>

		<p>When I need to find documentation for it, I usually fire up ILSpy and open Windows.winmd with it (with Windows 10 SDK it&#8217;s in UnionMetadata folder). You can observe all the interface names, including aggregation, activation and static factories there, along with name overloading too.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1254415">
				<div id="div-comment-1254415" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mackenzie Zastrow</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254415">
			June 29, 2016 at 8:53 am</a>		</div>

		<p>Can you do the same from C# if you&#8217;re not writing a Store app? </p>
<p>I know there&#8217;s <a href="https://github.com/kennykerr/modern" rel="nofollow">https://github.com/kennykerr/modern</a> for C++, I wonder if there&#8217;s something for C#.  (I tried searching, but couldn&#8217;t find anything).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1254445">
				<div id="div-comment-1254445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matteo Italia</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254445">
			June 29, 2016 at 10:40 am</a>		</div>

		<p>Ah, but now you cannot film the heisenbug that happens only in the &#8220;game bar not shown&#8221; branch!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1254455">
				<div id="div-comment-1254455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">12BitSlab</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254455">
			June 29, 2016 at 11:13 am</a>		</div>

		<p>If a developer wanted to take the stance that their software is not a game or that the developer did not want anything more than just a screen shot taken of the software, these techniques would make it trivial to stop the recording.  Simply minimize the software, make the windows invisible, etc.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1254485">
				<div id="div-comment-1254485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254485">
			June 29, 2016 at 7:18 pm</a>		</div>

		<p>Hey check out this great game called Remote Desktop.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1254525">
				<div id="div-comment-1254525" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254525">
			June 30, 2016 at 1:12 am</a>		</div>

		<p>Don&#8217;t give evil people ideas ! :o</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1254495">
				<div id="div-comment-1254495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254495">
			June 29, 2016 at 10:15 pm</a>		</div>

		<p>Thank you for writing out the namespace, Raymond. I get really annoyed when I&#8217;m looking for hints how to do stuff on the internet, and people post some code without any namespaces in it at all (also no Using stateme&#8230; uh directives). Trying to figure out all the namespaces for their stuff is &#8230; bleh.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1255435">
				<div id="div-comment-1255435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RKZENITH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1255435">
			July 7, 2016 at 11:03 am</a>		</div>

		<p>Agreed.  That using directive is one of the worst design decisions on the language side of .NET.  It allows poor developers, who hardly understand the code while writing it, to take shortcuts that make it more difficult for even skilled developers during subsequent maintenance cycles.  For every second saved by not typing out just enough for Intellisense to pick up what you were going for, an hour is squandered trying to figure out _which_ namespace some random object is coming from.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1254515">
				<div id="div-comment-1254515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254515">
			June 30, 2016 at 12:46 am</a>		</div>

		<p>I&#8217;d like to use the GameBar&#8217;s ability to take screenshot of fullscreen games via an API (preferably in a .NET C# app), but I have a hard time figuring out if it is possible. It seems it isn&#8217;t. Or at least, it isn&#8217;t documented.</p>
<p>All the examples I can find are :<br />
&#8211; using GDI+ to take a screenshot of the desktop (which usually results in a black screenshot)<br />
&#8211; using Windows.Media.Capture.ScreenCapture (only available on Windows Phone 8.1 :()<br />
&#8211; using convoluted DirectX hooking APIs à la Fraps. Seems overly complicated. I&#8217;d like to avoid that.<br />
&#8211; using the Windows Media 9 Screen Capture codec&#8230; Hum, I don&#8217;t think it&#8217;s what I want. Plus, it&#8217;s very old.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1254545">
				<div id="div-comment-1254545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254545">
			June 30, 2016 at 4:29 am</a>		</div>

		<p>Now this is a new level of API uglyness.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1254595">
				<div id="div-comment-1254595" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254595">
			June 30, 2016 at 7:46 am</a>		</div>

		<p>That&#8217;s because we&#8217;re using the raw ABI, which as another commenter noted, was not intended for human consumption. Humans are intended to use one of the projections, such as C++/CX or Modern C++.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-tautvydas-zilys even depth-3 parent" id="comment-1254665">
				<div id="div-comment-1254665" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Tautvydas+Zilys' rel='external nofollow' class='url'>Tautvydas Zilys</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254665">
			June 30, 2016 at 9:51 am</a>		</div>

		<p>Now, if that was the case, wouldn&#8217;t projections be available for desktop applications (and their requirements like dynamic loading) too? :)</p>
<p>We had to write a whole lot of raw ABI code since our application still works on Windows XP, but we wanted to enable additional functionality if you happen to run on Windows 10 (e. g. Speech Recognition). That code is all shared with WinRT application version too. C++/CX doesn&#8217;t really allow your binary to work on XP.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4 parent" id="comment-1254695">
				<div id="div-comment-1254695" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254695">
			June 30, 2016 at 1:42 pm</a>		</div>

		<p>@Tautvydas Zilys Could you refactor the platform specific functionality into its own DLL compiled with C++/CX, and then dynamically load the dlls based on platform?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-tautvydas-zilys even depth-5" id="comment-1254836">
				<div id="div-comment-1254836" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Tautvydas+Zilys' rel='external nofollow' class='url'>Tautvydas Zilys</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254836">
			July 1, 2016 at 1:25 pm</a>		</div>

		<p>Well, that was one of the options we considered, but we went against it because we would have to invent a C API for all of the interop with the DLL (or something like COM, which would kinda defeat the purpose) as we&#8217;d have to link the DLL against different CRT (our main app is still built with VS2010). We went with pure COM approach since we thought that would allow us to write less code. Error handling is super annoying in C++/CX anyway, so it&#8217;s not like it was that much harder. I think we made the right call. I just thought it was funny that Raymond claimed that those APIs are not meant for human consumption.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-4" id="comment-1254725">
				<div id="div-comment-1254725" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254725">
			June 30, 2016 at 4:37 pm</a>		</div>

		<p>Meh, if you&#8217;re still targeting an unsupported version of the OS then you might have to put up with some ugliness as a trade-off. Like cross platform code. You could roll your own projection or adapter or whatevs.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1254715">
				<div id="div-comment-1254715" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160629-00/?p=93775#comment-1254715">
			June 30, 2016 at 3:23 pm</a>		</div>

		<p>Why doesn&#8217;t the game bar work with my mfc application? It comes up and I can press record but it says &#8220;Nothing to record. Play some more&#8221; after several seconds.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>