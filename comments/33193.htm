<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (11)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-325333">
				<div id="div-comment-325333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325333">
			November 28, 2005 at 12:19 pm</a>		</div>

		<p>Since I don&#8217;t have a setup with HSM enabled, I just now manually set some files to offline (via SetFileAttributes) to test some things out with some of the shell extensions I&#8217;ve written.  I&#8217;ve got some tweaks to make to my property sheet extensions: they show up when they shouldn&#8217;t.</p>
<p>Looks like Windows Explorer (XP SP2) automatically disables thumbnails for offline files, so my thumbnail handler won&#8217;t need to do any extra work.  However XP&#8217;s Filmstrip view does show offline files in the preview area.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-325343">
				<div id="div-comment-325343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.guyswithtowels.com' rel='external nofollow' class='url'>Tim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325343">
			November 28, 2005 at 12:23 pm</a>		</div>

		<p>This sounds like a useful flag for things like Webdrive to apply to their virtual files.  I do like Webdrive, but the trouble is, Explorer is always downloading jpegs to preview them, or downloading thumbs.db, etc, and it slows things down.</p>
<p>A friend once came to my house to use my broadband connection to upload a large EXE (a demo file).  It was going really slowly, and then we realised that as Webdrive was uploading it, Explorer was downloading the EXE so that it could extract the icon to show it to me in the window.  Ngghh.  (In the end, we used command line ftp).</p>
<p>In summary, more things should use this flag when appropriate.</p>
<p>Or would that be bad?  Is it &#8216;only&#8217; for tapes?  Or just for &#8216;files that take a long time to get&#8217;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-325373">
				<div id="div-comment-325373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325373">
			November 28, 2005 at 5:11 pm</a>		</div>

		<p>A better (IMNSHO) solution would be for Explorer (and other programs) to ALWAYS ASK before opening files.  It needn&#8217;t be intrusive.  Just have a &quot;view thumbnails&quot; link.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-325383">
				<div id="div-comment-325383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325383">
			November 28, 2005 at 5:46 pm</a>		</div>

		<p>It&#8217;s for offline files, which would include anything on secondary storage.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-325313">
				<div id="div-comment-325313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325313">
			November 28, 2005 at 11:45 am</a>		</div>

		<p>My university used to use this with UNIX based systems.  During holidays, all the undergrad files ended up migrating to the optical storage jukeboxes.  (The postgrads and staff worked during holidays so their new files pushed the undergrad ones out.)</p>
<p>So when we all came back, the first thing we discovered was that access to our files was *really* slow.  Even the first login takes ages as your .cshrc had to be fetched (in competition with everyone else).  It didn&#8217;t take too long before everyone figured you cat all of your files to bring them back.  So everyone did.</p>
<p>And every few terms/semesters that broke the optical jukeboxes!  Moral of the story:   HSM only works if the people using it understand the point and cooperate :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-325463">
				<div id="div-comment-325463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harvey Pengwyn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325463">
			November 29, 2005 at 5:19 am</a>		</div>

		<p>In one company I worked for, we were doing something like this on an IBM Mainframe, we thought there was an automatic tape retrieval system so we had some batch jobs to get these files. They were not the most efficient things in terms of minimising retrievals but we didn&#8217;t care as we thought it was an automated system&#8230;.<br />
<br />Then we got a phone call from a rather annoyed operator, it turned out that what happened was that the command caused a message to appear on a console and someone had to go and get the tape and load it into the drive. After the first 10 or so instructions to get the same tape they began to lose their sense of humour about it&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-325493">
				<div id="div-comment-325493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.robertmoir.co.uk' rel='external nofollow' class='url'>Robert Moir</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325493">
			November 29, 2005 at 11:22 am</a>		</div>

		<p>You&#8217;re lucky if they phoned you Harvey, We tended to just cancel jobs if we thought they were doing something wrong.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-325753">
				<div id="div-comment-325753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-325753">
			November 29, 2005 at 7:19 pm</a>		</div>

		<p>Do you work at the same place I do?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-326803">
				<div id="div-comment-326803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-326803">
			December 1, 2005 at 11:08 pm</a>		</div>

		<p>Of course there are several RTLs that require you to open a file before you can determine its size, even if that&#8217;s all you want&#8230; sigh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-327243">
				<div id="div-comment-327243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">denis bider</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-327243">
			December 4, 2005 at 7:38 pm</a>		</div>

		<p>Hello Raymond,</p>
<p>I am right now writing just such a program, a server that needs to retrieve file information and send it to a client.</p>
<p>The problem is that some information, like the file link count, is available from the system only by first opening the file.</p>
<p>Now, I want to send the client the file link count if the client requested it. However, I don&#8217;t want this to cause the file to be loaded from the tape, either.</p>
<p>Can I open the file with FILE_FLAG_OPEN_NO_RECALL in order to achieve this?</p>
<p>Will this flag cause the open to succeed immediately, without causing anything to be loaded from the offline resource? Or will stuff still be loaded from the offline resource, even if I use this flag?</p>
<p>All I want to use the handle for is to call GetFileInformationByHandle().</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-328303">
				<div id="div-comment-328303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">denis bider</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051128-10/?p=33193#comment-328303">
			December 7, 2005 at 8:54 am</a>		</div>

		<p>No comment? :(</p>
<p>I wouldn&#8217;t bug, but the little there is about this flag in MSDN Library could be interpreted either way:</p>
<p>&quot;FILE_FLAG_OPEN_NO_RECALL &#8211; The file data is requested, but it should continue to be located in remote storage. It should not be transported back to local storage. This flag is for use by remote storage systems.&quot;</p>
<p>What bothers me is &quot;The file data is requested&quot;. What does that mean? I am not requesting file data, I just want to use the handle to call GetFileInformationByHandle() without causing any loading of optical media or tapes.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>