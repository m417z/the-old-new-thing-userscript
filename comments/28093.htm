<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-470883">
				<div id="div-comment-470883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roger Wilco</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-470883">
			February 8, 2007 at 12:35 pm</a>		</div>

		<p>I have a psychic debugging question for you. Sometimes (maybe 25% of the time) my computer becomes non-responsive when I switch users on XP. The monitor loses its connection and goes into power save mode, the keyboard and mouse still have power (light up) but do not respond &#8212; for example the caps lock key does not toggle the light on the keyboard. I have to cold boot my computer. Any psychic debugging ideas?</p>
<p>Also, this may be related, when I try to use the guest account explorer never runs.</p>
<p>Hosed XP installation? Driver issue? Any ideas?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-470893">
				<div id="div-comment-470893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">The Notorious O.T.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-470893">
			February 8, 2007 at 3:19 pm</a>		</div>

		<p>My brakes are squealing. &nbsp;Where do you think I should get them fixed? &nbsp;Any ideas?</p>
<p>&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-470903">
				<div id="div-comment-470903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-470903">
			February 8, 2007 at 3:23 pm</a>		</div>

		<p>Roger Wilco &#8211; this is off-topic, so I&#8217;ll be brief. &nbsp;If networking is still fine, the chances are it&#8217;s Winlogon/terminal services failing; if networking stops, it&#8217;s probably something kernel-side.</p>
<p>Since Win32k will have to reconnect your session to the console keyboard, video and mouse, you&#8217;re probably better off posting this to someone with extensive knowledge of such drivers.</p>
<p>Alternatively, get a firewire cable and hook up a kernel debugger with a good internet connection &#8211; you can learn a lot by stepping through Winlogon&#8217;s calls before the crash. &nbsp;For the explorer failure, trace from userinit.exe.</p>
<div class=post>[<i>Okay, if you folks want to discuss this further, please take it to a newsgroup or something. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-470953">
				<div id="div-comment-470953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-470953">
			February 8, 2007 at 9:20 pm</a>		</div>

		<p>I ran into a similar problem when working on a wizard for Windows Vista. When launching the app, the wizard would briefly appear and then disappeared from the screen.</p>
<p>It turned out the associated MUI file (the separate resource file in Vista) wasn&#8217;t in the right directory. Windows would try to load the program but it would fail because it couldn&#8217;t find the resources.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-470983">
				<div id="div-comment-470983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stop it</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-470983">
			February 9, 2007 at 12:22 am</a>		</div>

		<p>This is a blog with clearly specified topics! I don&#8217;t get it why people thinks this is a general computer support forum. I find such posts offensing, maybe trolling?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-470913">
				<div id="div-comment-470913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.chaosinmotion.com/blog/' rel='external nofollow' class='url'>William Woody</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-470913">
			February 8, 2007 at 5:11 pm</a>		</div>

		<p>*sigh*</p>
<p>I wish this had been posted two weeks ago when I was diagnosing the very problem&#8211;and fixed it with with the very solution you specified.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-471083">
				<div id="div-comment-471083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.crazyontap.com' rel='external nofollow' class='url'>AlmostAlive</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471083">
			February 9, 2007 at 12:27 pm</a>		</div>

		<p>I read this the other day and it really struck me as odd. &nbsp;</p>
<p>&#8220;If the property sheet manager tries to create the dialog corresponding to a property sheet page, but the call to CreateDialog failsâ€ , then the property sheet manager deletes that page and tries the next page.&#8221;</p>
<p>Why on earth does the property sheet manager do that? &nbsp;That seems like the worst possible thing to do. &nbsp;Would it not be way smarter to simply fail with a reasonable error than cycle through property pages looking for something that works? &nbsp;That way I might not need psychic debugging. &nbsp;Isn&#8217;t it always better to fail early than fail late?</p>
<div class=post>[<i>Imagine what the world would be like if that were the case. (Hint: Shell extensions.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-471153">
				<div id="div-comment-471153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.rsynnott.com/self-parody.html' rel='external nofollow' class='url'>Robert Synnott &raquo; Blog Archive &raquo; Self-Parody?</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471153">
			February 9, 2007 at 3:43 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.rsynnott.com/self-parody.html" rel="nofollow">http://blog.rsynnott.com/self-parody.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-471183">
				<div id="div-comment-471183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.crazyontap.com' rel='external nofollow' class='url'>AlmostAlive</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471183">
			February 9, 2007 at 7:05 pm</a>		</div>

		<p>&#8220;Imagine what the world would be like if that were the case. (Hint: Shell extensions.)&#8221;</p>
<p>I see where you&#8217;re coming from but that doesn&#8217;t completely invalidate my point. &nbsp;A buggy shell extension could keep property pages in explorer from showing up at all but then a buggy shell extension could do a lot worse anyway. &nbsp;At least if it simply fails, the buggy extension might get fixed. &nbsp;Instead this weird behavior becomes part of the API. </p>
<p>The Windows API is extremely forgiving of problems in applications. &nbsp;It seems like a case of short-term gain for long-term problems to me.</p>
<div class=post>[<i>The buggy shell extension isn&#8217;t doing this on purpose. Perhaps the uninstaller ran into a problem and deleted the resource DLL but forgot to delete the registration. Now the user can&#8217;t open any property sheets. Assuming the user even knows what vendor&#8217;s shell extension&#8217;s uninstaller messed up, it was probably a non-reproducible fluke (file in use, power loss at a bad time), which makes a fix less likely. Or worse, it was an overly aggressive virus checker that deleted it. Result: &#8220;Windows is a piece of crap. I can&#8217;t open any property sheets any more, and reinstalling doesn&#8217;t help. I should have bought a Mac.&#8221; If a page can&#8217;t be created, would you prefer that the property sheet spontaneously dismiss itself and return an error? What should Explorer do if it gets such an error? Tell the user, &#8220;Sorry, you lose&#8221;? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-471253">
				<div id="div-comment-471253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471253">
			February 9, 2007 at 10:17 pm</a>		</div>

		<p>Hmmm&#8230; Is there any places that store those silently adopted errors that we can read from&#8230; perheps a debugger?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-471323">
				<div id="div-comment-471323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.crazyontap.com' rel='external nofollow' class='url'>AlmostAlive</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471323">
			February 10, 2007 at 3:25 pm</a>		</div>

		<p>&quot;Perhaps the uninstaller ran into a problem and deleted the resource DLL but forgot to delete the registration.&quot;</p>
<p>Shouldn&#8217;t that be caught somewhere else entirely as opposed to the property sheet manager? &nbsp;</p>
<p>Don&#8217;t get me wrong, I fully understand your position. &nbsp;The solution provided is good for the user: they can see their property sheets even if everything else has gone wrong and nothing has trapped the problem until just that moment. &nbsp;But that solution is terrible for developers. &nbsp;Isn&#8217;t catching the problem where it occurs is better for everyone than simply ignoring the problem at the lowest level?</p>
<p>&quot;Assuming the user even knows what vendor&#8217;s shell extension&#8217;s uninstaller messed up&quot;</p>
<p>Of course, they&#8217;ll never know. &nbsp;Windows will never know. &nbsp;The shell extension registration will stay in the registry forever. &nbsp;The property sheet manager will try and load that property sheet every time for years and years and fail every time. &nbsp;And ultimately thats the reason some people have to reinstall Windows every few years.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-471333">
				<div id="div-comment-471333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DGmon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471333">
			February 11, 2007 at 2:39 am</a>		</div>

		<p>2 AlmostAlive:</p>
<p>with great power comes great responsibility. if the extension is buggy there&#8217;s nothing shell can do, but to try and catch.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-471393">
				<div id="div-comment-471393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Pritchard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471393">
			February 11, 2007 at 8:31 pm</a>		</div>

		<p>Surely Windows could identify the faulting shell extension, look it up on the internet, email the author, inform him or her of the error, help with the debugging process, receive the fixed build and install it?</p>
<p>Come on Microsoft, you&#8217;re not even trying!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-471413">
				<div id="div-comment-471413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-471413">
			February 11, 2007 at 11:41 pm</a>		</div>

		<p>I second David&#8217;s idea of automatically spamming the authors of buggy shell extensions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-473433">
				<div id="div-comment-473433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070208-02/?p=28093#comment-473433">
			February 18, 2007 at 10:46 am</a>		</div>

		<p>How about this:</p>
<p>Explorer:</p>
<p>&#8216;Shell extension &#8220;Yadda, yadda&#8221;, from &#8220;Unfinished Software, Co&#8221; needed to display property page for this type of document has failed to initialize. Would you like Explorer to try loading the offending extension in the future?&#8217;</p>
<p>[[No]] [Yes]</p>
<p>Or would that be too psychic to implement?</p>
<div class="post">[<i>You know how shell extensions work. You tell me. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>