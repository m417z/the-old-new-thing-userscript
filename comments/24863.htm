<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-557323">
				<div id="div-comment-557323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sohail</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557323">
			October 8, 2007 at 11:29 am</a>		</div>

		<p> while ((hwndTry = GetLastActivePopup(hwndWalk)) != hwndTry) {</p>
<p>Isn&#8217;t this undefined behaviour?</p>
<div class="post">[<i>I leave fixing this error as an exercise for the reader. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557333">
				<div id="div-comment-557333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tyberius Prime</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557333">
			October 8, 2007 at 12:00 pm</a>		</div>

		<p>I would love if there was a public api for this. My quest in alt-tab replacement has</p>
<p>struggled to find the right windows for a long time now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557353">
				<div id="div-comment-557353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557353">
			October 8, 2007 at 1:10 pm</a>		</div>

		<p>I particularly hated the Windows 95 Alt+Tab list which skipped dialogs with invisible parents. It seems to basically use the same list that the task bar did.</p>
<p>Tyberius, Windows 3.x used to have an undocumented export named GetNextQueueWindow which provided this functionality. (My problem was trying to work out which window will activate after the current window is minimised, which skips minimised windows, then looks for topmost windows, but if there are no other windows then I give up&#8230; desktop perhaps?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557403">
				<div id="div-comment-557403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://cs.usu.edu.ru/home/skrobov/' rel='external nofollow' class='url'>A. Skrobov</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557403">
			October 8, 2007 at 3:12 pm</a>		</div>

		<p>2Marvin: the order in the sequence is the Z-order. Same as for tabbing through controls in a dialog box.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557363">
				<div id="div-comment-557363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557363">
			October 8, 2007 at 1:15 pm</a>		</div>

		<p>I am wondering, what do you need the while loop for? If GetLastActivePopup returns the *last* active popup, will you get anything different if you call it again? In particular, the second GetLastActivePopup call is applied to an owned window, and the documentation states that you won&#8217;t get anything new, which is also confirmed by my testing. (Another question came up while testing: Why does GetAncestor(hwnd, GA_ROOTOWNER) return hwnd instead of the owner for owned windows without the WS_POPUP style?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557393">
				<div id="div-comment-557393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marvin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557393">
			October 8, 2007 at 2:33 pm</a>		</div>

		<p>What is the *order* of Windows in Alt-Tab sequence? I constantly hit situations where some windows are moved far away in the sequence without any apparent (to me) reason. Usually I have 3 actively used windows: <font color="red">Program A</font>, <font color="red">Program B</font> and a browser. There also might be a lot of other rarely used windows open. When I try to switch between <font color="red">Program A</font>, <font color="red">Program B</font> and/or browser quite often one of them will appear far in the queue instead of being close to others. I think it might have something to do with minimizing a window but I am not positive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557413">
				<div id="div-comment-557413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MathiasR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557413">
			October 8, 2007 at 3:20 pm</a>		</div>

		<p>A few days ago I had a strange bug&#8230; suddenly, the task list and alt+tab seemed to show *all* windows, even windows which are not supposed to be visible in the task list or alt+tab. I had to reboot to fix the problem. (Vista + SP1 beta)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557433">
				<div id="div-comment-557433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Grijan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557433">
			October 9, 2007 at 12:08 am</a>		</div>

		<p>Yes, AFAIK, the Alt+Tab order is the same as the Z-order, which makes sense, because that way you can quickly reach the last two or three tasks, which are the ones you mos probably need, if you are working with a group of applications (IMHO, one of the most common scenarios for Alt+Tab use).</p>
<p>But I, being myself a hard Alt+Tab user, have found an annoyance that sometimes drives me nuts, and that may be what Marvin refers to. Most times, when you minimize a window (I&#8217;m also used to do that with Alt+Space, M), it goes to the bottom of the ZOrder. But sometimes (about one out of five times), it just goes back the second active window, and gets activated by the next &quot;blind&quot; Alt+Tab. I haven&#8217;t been able to find any rule for this. I use the same applications all time (mostly Windows Explorer, Firefox, Thundebird, and Visual Basic 6), and this can happen with any app.</p>
<p>Also, there is another annoying behavior I can&#8217;t understand. Visual Studio 6&#8217;s version of MSDN, when opened from the VB IDE, behaves as if it were a child of VB&#8217;s main window, but also get shown in the Alt+Tab list, and guess what? It also makes strange things with the switch order. It seems to happen too with topmost windows, which stay at the start of the list, no matter what you do, but at least this time it has some sense&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557443">
				<div id="div-comment-557443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sucky proggy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557443">
			October 9, 2007 at 4:16 am</a>		</div>

		<p><font color="red">Program XYZ</font> also tamper with the alt+tab order.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557463">
				<div id="div-comment-557463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557463">
			October 9, 2007 at 6:18 am</a>		</div>

		<p>I&#8217;ve had a few instances (although I forget which apps have triggered it) where I minimise an application, and then Alt-Tab completely misbehaves &#8211; for example, say I have apps A, B and C: say I&#8217;m on A and hit alt-tab once takes me to B in the chain, hit alt-tab again, and it takes me to C, then another Alt-Tab takes me back to A and it the cycle continues. Worth adding that when Alt-Tab starts doing this, focus and auto-raise stop working. I&#8217;ve sometimes been able to fix it by minimising all running apps with Win-D, Alt-Tab&#8217;ing the cycle one, clicking on one window on taskbar to bring it up and everything rights itself&#8230; but this doesn&#8217;t always work.</p>
<p>Odd.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557473">
				<div id="div-comment-557473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Grijan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557473">
			October 9, 2007 at 10:31 am</a>		</div>

		<p>To sucky proggy: I wasn&#8217;t complaining about a determinate program bug, but trying to explain a couple of scenarios in which many programs are involved. I don&#8217;t believe we have to blame any of those programs. On the other hand, the algorithm that determines the Z-order of minimized windows or out-of-process child windows seems to act weirdly sometimes. That&#8217;s what I wanted to expose. And IMHO that is completely on-topic, because it&#8217;s directly related to the way Alt+Tab works.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557593">
				<div id="div-comment-557593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557593">
			October 9, 2007 at 12:56 pm</a>		</div>

		<p>Raymond, you have mis-read the original commentor:</p>
<p>&quot;For example, if you have window A owns window B owns window C, they are all visible, and C is modal to the rest, then suddenly all three disappear from the ALT+TAB.&quot;</p>
<p>A owns B owns C, C is modal. C only has one owner.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-557633">
				<div id="div-comment-557633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Good Point</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557633">
			October 9, 2007 at 5:31 pm</a>		</div>

		<p>So, is Excel 2003&#8217;s behavior with regards to Alt+Tab, designed to be annoying, or is it just a coincidence?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-557643">
				<div id="div-comment-557643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Good Point</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-557643">
			October 9, 2007 at 5:33 pm</a>		</div>

		<p>&quot;I constantly hit situations where some windows are moved far away in the sequence without any apparent (to me) reason&#8230;.</p>
<p>I think it might have something to do with minimizing a window but I am not positive.&quot;</p>
<p>I see this when moving windows to the background (Alt+Esc), especially with Office apps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-558273">
				<div id="div-comment-558273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marvin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-558273">
			October 11, 2007 at 3:06 pm</a>		</div>

		<p>Thanks to everybody who confirmed I am not insane.</p>
<p>With regards to the Z-order this is nuts. Can you look at somebody&#8217;s monitor and determine what the Z-order of his windows is? The user expectation, I think, is that Alt-Tab would favor MRU windows and not rely on some invisible and hard to determine order. It shouldn&#8217;t matter how I switched from application A to application B: through a mouse click, minimizing A, Alt-Tab or anything else. When I click Alt-Tab I want to see A as the nearest choice.</p>
<p>Am I unreasonable?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-558643">
				<div id="div-comment-558643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thelins.se/johan' rel='external nofollow' class='url'>Johan Thelin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071008-00/?p=24863#comment-558643">
			October 12, 2007 at 1:28 pm</a>		</div>

		<p>As Acer seems to be having some problems with this &#8211; I added a small fix to remove one of their windows from the Alt-Tab list. Thanks to Raymond for hinting me on how to get it done.</p>
<p><a rel="nofollow" target="_new" href="http://www.thelins.se/johan/2007/01/efficient-month-starts-now.html" rel="nofollow">http://www.thelins.se/johan/2007/01/efficient-month-starts-now.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>