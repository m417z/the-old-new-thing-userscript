<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (61)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-254603">
				<div id="div-comment-254603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike R</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254603">
			February 11, 2005 at 7:09 am</a>		</div>

		<p>It still simply amazes me that people seem to think everything MS produces uses undocumented code. I discovered the above mentioned function years ago, and have used it once or twice in my own custom controls. DrawEdge is another nice function to have :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254613">
				<div id="div-comment-254613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.merrioncomputing.com' rel='external nofollow' class='url'>Duncan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254613">
			February 11, 2005 at 7:14 am</a>		</div>

		<p>Visual basic programmers have had windowless controls for even longer &#8211; although they were called &quot;lightweight&quot; controls&#8230;presumably to hide the complexity of concepts like &quot;windows&quot; from us ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254623">
				<div id="div-comment-254623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Swaim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254623">
			February 11, 2005 at 7:27 am</a>		</div>

		<p>PowerBuilder does the same thing with their DataWindow. One of the things that they used to demo was a DataWindow with a bunch of &quot;controls&quot; on it vs. the same number of Windows controls. The datawindow would always render faster.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254643">
				<div id="div-comment-254643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.avocadosoftware.com/csblogs/' rel='external nofollow' class='url'>Derick Bailey</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254643">
			February 11, 2005 at 7:47 am</a>		</div>

		<p>I think embedded objects, like Flash and Media Player, are also &quot;Windowed&quot; objects. Most pop-up menu systems for web sites have issues with this, and end up showing up &quot;behind&quot; the windowed object. Although IE has had a fix for this, for years. I believe Mozilla / Netscape also have a fix for this, now. I don&#8217;t remember the details, off hand, though, cause I haven&#8217;t done this in about 8 months.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254663">
				<div id="div-comment-254663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254663">
			February 11, 2005 at 8:00 am</a>		</div>

		<p>I am not sure but I do believe the IFRAME is a window with handles as well. That is the only thing that will allow Z indexing over the select element in HTML. Which is one of those quirky things we have to do in Dynamic HTML is put an IFRAME below anything like pop out menus. Because everything can properly Z index over an IFRAME but only the IFRAME can Z index higher than a select element. Something I have always wished they would fix.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254673">
				<div id="div-comment-254673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254673">
			February 11, 2005 at 8:09 am</a>		</div>

		<p>Um, that was fixed over five years ago.<br />
<br /><a target="_new" href="http://msdn.microsoft.com/library/en-us/dnie55/html/dnie55ie55.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/dnie55/html/dnie55ie55.asp</a><br />
<br />&quot;&#8230; iframes could not play in the world of z-index-positioned elements. &#8230; In Internet Explorer 5.5, this feature is now supported.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254683">
				<div id="div-comment-254683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254683">
			February 11, 2005 at 8:10 am</a>		</div>

		<p>Their implementation of horizontal scrollbars behave weird in IE. If you resize the window to have a thin height, it shrinks instead of disapearing. And the scaled down version also has some drawing/hit detection issues.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254693">
				<div id="div-comment-254693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254693">
			February 11, 2005 at 8:17 am</a>		</div>

		<p>MS Access does the same (or at least it did around version 2.0 when I touched it for the last time :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254713">
				<div id="div-comment-254713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.4guysfromrolla.com/ScottMitchell.shtml' rel='external nofollow' class='url'>Scott Mitchell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254713">
			February 11, 2005 at 8:58 am</a>		</div>

		<p>Is the &lt;SELECT&gt; not being windowless the reason why it will bleed through DIVs?<br />
<br /><a target="_new" href="http://www.faqts.com/knowledge_base/view.phtml/aid/10146" rel="nofollow">http://www.faqts.com/knowledge_base/view.phtml/aid/10146</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254723">
				<div id="div-comment-254723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254723">
			February 11, 2005 at 9:13 am</a>		</div>

		<p>A lot of Microsoft applications use windowsless controls. Use Spy++ on any of the Office dialog boxes and you&#8217;ll see they have their own way of doing things (Forms3?). </p>
<div class=post>[<i>Remainder of comment deleted because Wikipedia is citing me as the source. I&#8217;m not the source. &#8220;Jonathan&#8221; is the source. If &#8220;Jonathan&#8221; wants to reference it from Wikipedia, then &#8220;Jonathan&#8221; can put it on his own web site and link to it there. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254733">
				<div id="div-comment-254733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.apptranslator.com' rel='external nofollow' class='url'>Serge Wautier</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254733">
			February 11, 2005 at 9:14 am</a>		</div>

		<blockquote><p>
  Clearly Internet Explorer cannot create a real HWND for every element in an HTML page.</p>
<p>What do you mean by element ? we&#8217;re speaking of controls here. Do HTML forms contain that many checkboxes, edit fields et al ?</p>
<p>I understand there can be thousands of HTML elements in a page but only very few of them are actually controls. So I don&#8217;t quite understand why windowless controls are so important.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254743">
				<div id="div-comment-254743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Barry Kelly</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254743">
			February 11, 2005 at 9:22 am</a>		</div>

		<p>Delphi has had windowless controls since &#8217;95 (for Win 3.1) and would have been in design for longer than that. Of course, Delphi&#8217;s windowless controls didn&#8217;t take focus, and were essentially graphical only controls: things like toolbar buttons and labels.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254753">
				<div id="div-comment-254753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frederik Slijkerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254753">
			February 11, 2005 at 9:43 am</a>		</div>

		<p>Aha, that explains why buttons in IE look ugly and stretched when they are beyond a certain width. IE probably just stretches a pre-drawn bitmap.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254763">
				<div id="div-comment-254763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/mgrier' rel='external nofollow' class='url'>Michael Grier [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254763">
			February 11, 2005 at 9:44 am</a>		</div>

		<p>Little bit &#8216;o history from my point of view:</p>
<p>The windowless controls we have today originated from how Access internally managed high-cardinality items.  Specifically for the data grid, Access (long before 1996) couldn&#8217;t possibly have afforded to create HWNDs for each cell.  So there were these things called &quot;KTs&quot; (KonTrol?) that you could put on Access forms/surfaces which basically followed the &quot;flyweight object&quot; pattern.</p>
<p>For Sterling (I was hired in Aug 1994 to help rush out the next version of Access which was a major reachitecture, fixed all the known problems, etc. etc. etc you can fill in the rest of the blanks from the standard &quot;we&#8217;re changing the whole world!&quot; script)&#8230; the old forms/ui folks from Access were working on a whole new forms package which formalized the KT pattern using COM as the basis.  (Not so flyweight any more but patterns like tear-offs were established since the windowless controls couldn&#8217;t afford to carry around all those vtable pointers.)</p>
<p>Sterling, of course, never shipped except like how most projects like it ship &#8211; bits and pieces of it dribbled into various products.</p>
<p>The Access forms folks (cool code name I can&#8217;t recall) joined forces with a team doing similar work in systems and formed Forms^3, which shipped as part of Office as a partial replacement for the Office Dialog Manager and I also believe it shipped with VS &#8217;98, but I can&#8217;t call in what capacity.  It was supposed to replace Ruby as VB5&#8217;s forms package but the compatibility wasn&#8217;t close enough.  (I did put together a demo where we used forms3 in design mode and auto-generated the MFC message tables to give a VB-like form based app design experience for VC++.)</p>
<p>Forms^3 evolved into the mshtml crowd and thus you have the html renderer inheriting all the activex/windowless-controls/IFrame stuff.  (But they also acquired some of the folks doing the MSN information reader from way back when; I recall the code name but I guess it was called &quot;MSN explorer&quot; then?  No relationship to the new MSN explorer.  The important thing is that these folks brought text flow and dynamic layout issues to the party.)</p>
<p>Meanwhile, ODM and WDM still survive, VB ended up breaking Ruby compatibility in a much much bigger way and Sterling mostly shipped eventually just like Cairo did.  Except for some really cool demo-ware where you could auto-build hierarchies of tables from the data grid.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254773">
				<div id="div-comment-254773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">foobar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254773">
			February 11, 2005 at 9:47 am</a>		</div>

		<blockquote><p>
  Is the &lt;SELECT&gt; not being windowless the reason why it will bleed through DIVs? </p>
<p>Yes.  Although there is a way to fix this problem &#8211; clip the area that you want to cover.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254783">
				<div id="div-comment-254783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Manip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254783">
			February 11, 2005 at 9:50 am</a>		</div>

		<p>I don&#8217;t want to sound like I&#8217;m trying to flame but this is why VC++ devs should learn about the full functionality of &quot;Windows Forms&quot; first so they can better understand the capabilities of app-/windows/. Or better to produce a prototype in VB(6) or .Net. </p>
<p>Some C++ people might be shocked by the amount of experience I carried over from VBA to VC++. And no, funny guy, I don&#8217;t mean GOTO jumps. You do gain a much better understanding of the Win32 API and app-/windows/ programming concepts in general. </p>
<p>I have also been known to explain windowing concepts which I see as being simple to much better VC++ devs. Mainly because they look at it &quot;bottom up&quot; and get all confused or don&#8217;t completely understand what they are trying to do (might also explain why VC++ devs produce such ugly UIs).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254793">
				<div id="div-comment-254793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254793">
			February 11, 2005 at 9:51 am</a>		</div>

		<p>Serge Wautier: Using Win32 for some elements and windowless controls for others just makes a bad situation worse. See the above discussion for the problems that &lt;iframe&gt; and &lt;select&gt; have caused over the years.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254803">
				<div id="div-comment-254803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254803">
			February 11, 2005 at 10:00 am</a>		</div>

		<p>Ummm Raymond,</p>
<p>If it is fixed please explain to me this quick code I threw together to show you Z indexing still don&#8217;t work on select tags in IE 5.5, 6.0, 6.1 or what ever else you want. Because there are thousands of web developers that do this on a daily basis because there is no way around it.</p>
<p>Sorry for length just copy and paste code below and save as htm file view in IE</p>
<p>&lt;HTML&gt;<br />
<br />&lt;HEAD&gt;<br />
<br />&lt;script Language=&quot;JavaScript&quot;&gt;<br />
<br />var FrameVisable = true;<br />
<br /> function HideIframe()<br />
<br /> {<br />
<br />   var myframe = document.getElementById(&quot;Iframe1&quot;);<br />
<br />   if(FrameVisable)<br />
<br />   {<br />
<br />      FrameVisable = false;<br />
<br />      myframe.style.visibility = &quot;hidden&quot;;<br />
<br />      form1.DisableButton.value = &quot;Show Iframe&quot;<br />
<br />   }<br />
<br />   else<br />
<br />   {<br />
<br />      FrameVisable = true;<br />
<br />      myframe.style.visibility = &quot;visible&quot;;<br />
<br />      form1.DisableButton.value = &quot;Hide IFrame&quot;<br />
<br />   }<br />
<br /> }<br />
<br />&lt;/script&gt;<br />
<br />&lt;/HEAD&gt;<br />
<br />&lt;BODY&gt;<br />
<br />&lt;iframe id=&quot;Iframe1&quot; style=&quot;position:absolute;left:400px;top:10px;z-index:4;width:200px;height:200px&quot;&gt;&lt;/iframe&gt;<br />
<br />&lt;form id=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;&gt;<br />
<br />   &lt;input id=&quot;DisableButton&quot; style=&quot;position:absolute;left:200px;top:10px&quot; type=&quot;Button&quot; name=&quot;b1&quot; value=&quot;Hide IFrame&quot; onclick=&quot;HideIframe();&quot;&gt;</p>
<p>   &lt;div id=&quot;Text1&quot; style=&quot;position:absolute;left:400px;top:10px;z-index:5&quot;&gt;This is some long text in a div tag&lt;/div&gt;<br />
<br />    &lt;select id=&quot;select1&quot; style=&quot;position:absolute;left:400px;top:10px;z-index:1&quot; size=&quot;1&quot; name=&quot;D1&quot;&gt;<br />
<br />    &lt;option&gt;This is some long text to stretch it out&lt;/option&gt;<br />
<br />    &lt;/select&gt;<br />
<br />&lt;/form&gt;</p>
<p>&lt;/BODY&gt;<br />
<br />&lt;/HTML&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254813">
				<div id="div-comment-254813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254813">
			February 11, 2005 at 10:05 am</a>		</div>

		<p>Oh and feel free to change the div tags to p tags or any other html tags you want, same effect</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254823">
				<div id="div-comment-254823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254823">
			February 11, 2005 at 10:11 am</a>		</div>

		<p>You can direct IE questions to the IE team &#8211; I included a link to their blog.</p>
<p>The web page I referenced said &lt;iframe&gt; was fixed; &lt;select&gt; is still windowed (as I noted in the main article).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254833">
				<div id="div-comment-254833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Office Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254833">
			February 11, 2005 at 10:19 am</a>		</div>

		<p>In reply to Jonathan, Office has several different internal UI technologies (many with their own TLAs). Before it was one product, each team developed their own system of doing things, and because it&#8217;s less efficient to rewrite everything every cycle, we still maintain just about all of them, and very recently, there has been a movement to begin consolidating them into an emerging new UI platform (first seen in Office 2003)&#8230; Of course there is tremendous irony adding a new UI technology (12th or 13th time we&#8217;ve reinvented this wheel) to remove some of the old ones&#8230; But you do have to meet the needs of all of the pre-existing technologies before you can use a new one. And it was also inspired by &quot;DirectUI&quot;.</p>
<p>While I&#8217;m discussing office on this blog (which talks a lot about app compatibility), one interesting thing that we have done (probably because of too many cross-Windows version bugs being discovered) is wrap chunks of the Windows APIs in wrapper code in the core Office DLL (MSO.DLL). When Windows changes between versions, we can isolate our code this way. Sometimes it also lets us work on unexpected scenarios (for example, network shares with funny permissions). That&#8217;s just one of the ways that we get new versions of an application like Word or PowerPoint to run on older systems unmodified (and share code in the process). So in addition to Windows changing its APIs trying to make past apps future compatible, Office changes its internal code to make present apps backwards compatible.</p>
<p>Eventually, the burden of building and testing these apps on so many versions of Windows becomes too great, so we sometimes let go of old version compatability (Win9x left us in Office 2003). Contrary to popular belief, it is not because we want to force customers to upgrade Windows. The time we save allows us to build a better system. Unfortunately for Windows, they don&#8217;t have as much luxury in that department as Office does&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254843">
				<div id="div-comment-254843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.eightypercent.net' rel='external nofollow' class='url'>Joe Beda</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254843">
			February 11, 2005 at 10:22 am</a>		</div>

		<p>Frederik Slijkerman:<br />
<br />&gt; Aha, that explains why buttons in IE look ugly and stretched when they are beyond a certain width. IE probably just stretches a pre-drawn bitmap.</p>
<p>If I remember correctly (and I may be mistaken) this was done because the theme code mixes up the use of resolution vs. size.  When drawing a nine-grid theme background, the shell APIs just allow for a final size &#8212; regardless of resolution.</p>
<p>When printing then the size ends up being very large and so the border is vanishingly small.  The hack around this was to assume that if the button was beyond a certain size then we must be going to a printer.  In that case, disable the fancy stretching behavior and just do a simple stretch.</p>
<p>Joe</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254853">
				<div id="div-comment-254853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.eightypercent.net' rel='external nofollow' class='url'>Joe Beda</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254853">
			February 11, 2005 at 10:24 am</a>		</div>

		<p>err &#8212; should have said &quot;theme API&quot; instead of &quot;shell API&quot; up there.  (But it was the shell team that implemented those APIs).</p>
<p>In Avalon we worked hard to make sure that resolution and control size are two different things to avoid issues like this.</p>
<p>Joe</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254863">
				<div id="div-comment-254863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254863">
			February 11, 2005 at 10:30 am</a>		</div>

		<p>We have been asking them Raymond ;-) For yes well over 5 years well before since that article was posted we have been telling them. I have seen that msdn article before. I keep hoping someday somewhere in Redmond someone like Raymond or Larry Osterman while pooring through their code may stumble upon it and fix it for real.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254873">
				<div id="div-comment-254873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254873">
			February 11, 2005 at 10:38 am</a>		</div>

		<p>Creating a windowless combo box is &quot;very hard&quot; because the dropdown part of the combo box extends beyond the window boundaries of its parent &#8211; this practically requires a separate window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254883">
				<div id="div-comment-254883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254883">
			February 11, 2005 at 11:00 am</a>		</div>

		<p>It&#8217;s not hard, I&#8217;ve done something like that before one day because I was bored. You just make a large window that spans your monitor and manage all the fake subwindows yourself by using a region. So esentially it&#8217;s like a layer with all your windows on it and if you change the z-order for it, all the windows in that layer become that new z-order. I don&#8217;t recomend shipping a program that does things that way though.</p>
<p>I think this layer with all the windows on it method is how mac osx does things but I can be wrong, I&#8217;ve never actually taken a look at it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254893">
				<div id="div-comment-254893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254893">
			February 11, 2005 at 11:48 am</a>		</div>

		<p>True, I agree it is hard but that post saying it is fixed really needs to come down. It has never been fixed in IE. And no I am not throwing a Jab out there, I prefer IE as a browser but there are a great many things like this that are not issues in Firefox. Z indexing is correct in FF. </p>
<p>Javascript has never been a fun language for me so I try to use it as little as I can. But Dynamically moving around IFrames is just a basic thing we have been doing for years because of the Select tag.</p>
<p>So anyway Raymond sorry if I was rude and I just made a comment on the Iframe I think is windowed as well because of that problem. Then you came back with that same link we have been getting from the IE team for years just kind of pissed me off. You can&#8217;t believe everything you read in MSDN. Which might be why the MS blogs are so popular. A lot of minds collaborating and thinking in different directions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254903">
				<div id="div-comment-254903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254903">
			February 11, 2005 at 12:17 pm</a>		</div>

		<p>Are you saying that &lt;iframe&gt; still cannot be z-ordered in IE 5.5? Please be specific what &quot;it&quot; is when you say that the &quot;the post saying it is fixed really needs to come down&quot;. From what I can gather you&#8217;re really complaining about &lt;select&gt;, which nobody claimed was fixed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254913">
				<div id="div-comment-254913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timothy Fries</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254913">
			February 11, 2005 at 12:35 pm</a>		</div>

		<blockquote><p>
  Creating a windowless combo box is &quot;very hard&quot; because the dropdown part of the combo box extends beyond the window boundaries of its parent &#8211; this practically requires a separate window.</p>
<p>But the dropdown isn&#8217;t always visible.  Is there a technical reason I&#8217;m missing that would make it difficult for the combo box base (the edit field and dropdown button) be non-windowed, and create a real window to show the dropdown when it&#8217;s needed?  After all the work the IE team did reimplementing all the other controls, the absence of the windowless combo box is rather curious.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254933">
				<div id="div-comment-254933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254933">
			February 11, 2005 at 2:13 pm</a>		</div>

		<p>Surely it isn&#8217;t gluttony to have the combo box dropdown as a live window, especially if only one is active at any given time (two if someone rigged a goofy D&amp;D scheme).</p>
<p>It would be hard to believe they spent their time duplicating the control functionality without referring to the original code. THAT is what the &quot;unfair advantage&quot; boils down to, that I whined about many moons ago. That&#8217;s not to say that edit controls, combo boxes, buttons, etc. are rocket science, but still&#8230;</p>
<p>I&#8217;m nobody&#8217;s mortal enemy, I&#8217;m just trying to keep it real.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254653">
				<div id="div-comment-254653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.electricminds.org' rel='external nofollow' class='url'>Erbo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254653">
			February 11, 2005 at 7:53 am</a>		</div>

		<p>Speaking of Mozilla/Netscape, I&#8217;m pretty sure they also use &quot;windowless&quot; controls, for the same reasons, and also so they can promulgate a platform-independent look-and-feel.  Also, Java Swing applications do the same thing (the older AWT uses windowed controls), again, for similar reasons.  Nobody accuses *them* of &quot;cheating.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254703">
				<div id="div-comment-254703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254703">
			February 11, 2005 at 8:30 am</a>		</div>

		<p>Erbo:</p>
<p>&gt; Speaking of Mozilla/Netscape, I&#8217;m pretty sure<br />
<br />&gt; they also use &quot;windowless&quot; controls</p>
<p>Of course they do. They even go further than that, the address bar and the toolbars and the status bar and most controls in the configuration dialog are not windows either.</p>
<p>&gt; Nobody accuses *them* of &quot;cheating.&quot;</p>
<p>That’s not cheating, that’s reinventing the wheel :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254943">
				<div id="div-comment-254943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://reduction.blogspot.com' rel='external nofollow' class='url'>pete diemert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254943">
			February 11, 2005 at 4:57 pm</a>		</div>

		<p>I&#8217;d like to toss in a minor vent with regards to Windowless controls and, specifically, the insights of &quot;Office Mike&quot;.  I&#8217;ve known about ODM for quite some even before I worked at MS.  I&#8217;m sure that every UI developer since the early days of Excel has run Spy (no ++ back then) over some MS dialogs and noticed, viola!, no HWNDs.  Back in 16-bit days I believe the limit on Window handles was even more extreme (I could be wrong but I think it was something like 16K handles for the ENTIRE desktop).  So, if you were in the business of building UI toolkits that were scalable, what MS was doing with Excel was very interesting.  To further up the ante once you had basic Windowing you then quickly wanted some more juicy features like &quot;logical transparency&quot; (i.e. I&#8217;d really like my dialog background to &quot;show through&quot; the background of my static text / pushbuttons, group box, etc..), non-rectangular clipping, and single pass rendering (very sweet when done offscreen)&#8230; A lot of this is now available with HWND but writing compatible code, as in the case with Office described earlier, means that you often have to consider the least common denominator.  The end result was that when it came to any &quot;heavy lifting&quot; UI with a potentially information dense display the first step was to bid farewell to HWND, say hello to HRGN and use HWND only when dealing with the desktop (as in the case of popups).</p>
<p>The vent is simply this; if Excel, Office, and now IE have all figured out, for one reason or another, that the HWND just doesn&#8217;t cut it, why, after all this time, when I try to create a form with the latest and greatest Windows SDK, the VS form designer (and control toolkit) will place nothing but Windowed controls?  As an ironic side note, I&#8217;ve noticed that VS itself sees some of the advantages of the &quot;IE Windows SDK&quot; with the mysterious &quot;HTMLite&quot; control popping up in the install.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254963">
				<div id="div-comment-254963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://reduction.blogspot.com' rel='external nofollow' class='url'>pete diemert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254963">
			February 11, 2005 at 5:50 pm</a>		</div>

		<p>Raymond, understood.  Let me rephrase my vent; Why hasn&#8217;t MS, to date, added &quot;industrial strength&quot; features to the Windows SDK that all of its own apps already require? Like no limit on window handles (by this I mean LOTS of handles is the norm rather than the exception), various clipping and transparency with little cost, and implicit offscreen rendering?  If the goal of Windows SDK is to take &quot;insanely hard&quot; but very fundemantal OS tasks and make them easily usable by 3rd party devs shouldn&#8217;t we expect the same attention to real world UI issues?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254973">
				<div id="div-comment-254973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254973">
			February 11, 2005 at 6:05 pm</a>		</div>

		<p>In my opinion, that&#8217;s beyond the scope of the Win32 Platform SDK. The Win32 Platform SDK describes the Windows platform. It&#8217;s job is not to give you a UI framework library. That&#8217;s what things like VB and MFC are for. It is my impression that WinFX is close to the UI framework that you&#8217;re describing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-254983">
				<div id="div-comment-254983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A kid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254983">
			February 11, 2005 at 6:55 pm</a>		</div>

		<p>Your blog is very intersting for me to understand the innerworking od Microsoft. Can you tell me of a blogger that almost does the same thing, but working for microsoft</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255013">
				<div id="div-comment-255013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255013">
			February 11, 2005 at 10:23 pm</a>		</div>

		<p>The special case for &lt;SELECT&gt; elements has caused me pain to no end.  They always apparently have the highest zIndex because everything else is drawn dynamically.  So if you want to pop up a div you have to do all sorts of special coding to get it to cover up the select list.  I have wondered why it was so, however.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255023">
				<div id="div-comment-255023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.xxeo.com/' rel='external nofollow' class='url'>Dru Nelson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255023">
			February 11, 2005 at 11:21 pm</a>		</div>

		<p>I&#8217;m glad he finally answered this question for me.</p>
<p>It would be nice though if MS came up with a solution that would enable their developers to accomplish the same thing as the IE team, instead of just keeping it to themselves.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-254953">
				<div id="div-comment-254953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-254953">
			February 11, 2005 at 5:20 pm</a>		</div>

		<p>Because managing windowless controls is **insanely hard** &#8211; there is no pre-made infrastructure for it; you have to write it all yourself. The average Win32 program does just fine with boring old HWNDs. Foisting windowless control management on everybody would drive most progammers insane. (&quot;You&#8217;re teling me that in order to display a dialog box with some text, an icon, and an OK button, I have to implement an IOleInPlaceSiteWindowless object?&quot;)</p>
<p>Furthermore, you can&#8217;t mix windowless and windowed controls without running into problems like the ones mentioned above. So it&#8217;s all or nothing. (Besides, Office doesn&#8217;t even use ActiveX windowless controls &#8211; they have their own private system. So there would be nothing for VS to show anyway.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255033">
				<div id="div-comment-255033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Bastard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255033">
			February 12, 2005 at 2:02 am</a>		</div>

		<p>Dru, it&#8217;s called hard work. You spend a lot of time writing windowless controls and you get them to work like you want them to. Anyone else can do the same thing the IE team did using the tools provided. That&#8217;s precisly the point, HWND provide you with a generic way to build most of the common control,if you don&#8217;t want the constraints associated with being generic, and want to do whatever the hell you want, that&#8217;s precisly what a windowsless control is. The thing is, if you want none of the constraint, you gotta to do it all yourself, nearly from scratch. You can&#8217;t have it both&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255043">
				<div id="div-comment-255043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.studentclub.ro/ovidiupl/' rel='external nofollow' class='url'>Ovidiu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255043">
			February 12, 2005 at 7:04 am</a>		</div>

		<p>Why can&#8217;t I open more than 60-70 Internet Explorer windows on Windows XP? My laptop has 1 GB of RAM and yet I can only open a few dozen IE windows; it doesn&#8217;t matter whether there&#8217;s a single process (and windows are created with Ctrl+N) or 70 processes, each having one window.</p>
<p>On systems with less memory (256 MB), the OS stalls at about 50-60 IE windows. On a machine with 1 GB of main memory, I get about 70-75 windows.</p>
<p>The truly awkward thing is that once I hit this limit, the machine becomes totally useless. I can&#8217;t even start Task Manager, open the Start Menu, nothing! Running apps can&#8217;t create new dialogs, the system is dead.</p>
<p>Please, don&#8217;t tell me about memory limits &#8211; I don&#8217;t buy that when I have 700 MB free. The resource count (kernel handles) is also reasonably low, and I thought Windows NT and its successors never had the kind of limitations Windows 95 had on user and GDI resources.</p>
<p>I can constantly reproduce this behavior on any given Windows XP machine. I&#8217;ve tested this on a dozen machines so far. If you want me to, I can record a test for you and publish it as a WMV video. I&#8217;ve known this bug since XP appeared, I haven&#8217;t seen it solved yet (currently I use XP + SP2 + all current patches) and I&#8217;m very curious about what the answer might be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255053">
				<div id="div-comment-255053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255053">
			February 12, 2005 at 8:17 am</a>		</div>

		<p>Now you&#8217;re off topic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255073">
				<div id="div-comment-255073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.studentclub.ro/ovidiupl/' rel='external nofollow' class='url'>Ovidiu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255073">
			February 12, 2005 at 12:26 pm</a>		</div>

		<p>Sorry for being off-topic. It seems to me that using windowless controls is a good way of preserving system resources, but Internet Explorer&#8217;s behavior is completely weird. It just seemed a good place to ask the question. Again, I apologize for disturbing the thread.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255063">
				<div id="div-comment-255063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.mozillazine.org/gerv/archives/007537.html' rel='external nofollow' class='url'>Hacking for Christ</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255063">
			February 12, 2005 at 12:34 pm</a>		</div>

		<p>You heard it from the horse&#8217;s mouth &#8211; IE doesn&#8217;t use standard Windows controls. So all those who continue to complain about how XUL &quot;re-invents the wheel&quot; by doing its own widgets, and how that has to be the cause of our allegedly poor performance (did you start Firefox recently?) can finally pipe down. Raymond Chen is a Microsoft guy who writes a fascinating technical blog called The Old New Thing. While hoping I never have to use any of the technologies he discusses, he writes so well and comes out with such great historical nuggets that it&#8217;s essential reading&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255083">
				<div id="div-comment-255083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smempire.org' rel='external nofollow' class='url'>Orlphar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255083">
			February 12, 2005 at 12:56 pm</a>		</div>

		<p>Sorry to be cliche, but Ovidiu, use a better browser.</p>
<p><a target="_new" href="http://www.mozilla.org" rel="nofollow">http://www.mozilla.org</a><br />
<br /><a target="_new" href="http://www.opera.com" rel="nofollow">http://www.opera.com</a></p>
<p>And no, this isn&#8217;t a trolling attempt, it&#8217;s just a suggestion that might fix your problem by avoiding it.</p>
<p>Also, even when using IE, I haven&#8217;t experienced that.  That includes the time I ran one of those scripts that keeps on spawning new windows.  Of course, it did slow down a bit, but the machine was usable once I managed to stop the script.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255093">
				<div id="div-comment-255093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.studentclub.ro/ovidiupl/' rel='external nofollow' class='url'>Ovidiu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255093">
			February 12, 2005 at 1:03 pm</a>		</div>

		<p>I use IE, Firefox, Opera and Netscape constantly as I do web pages every once in a while. I still consider IE to be the most performant browser (and with the proper settings it&#8217;s also very secure). That&#8217;s why I&#8217;m baffled by this behavior (simple test: Open a IE window, navigate to <a target="_new" href="http://www.google.com/" rel="nofollow">http://www.google.com/</a> and press Ctrl+N. My machine gets locked after 70-75 new windows). I would have expected IE to use very few USER resources (I knew for quite a while it doesn&#8217;t use HWNDs). I don&#8217;t know about GDI resources. I was hoping to get an answer here, but I gave up. Still an IE fan, though :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255103">
				<div id="div-comment-255103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Diego</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255103">
			February 12, 2005 at 1:15 pm</a>		</div>

		<p>That&#8217;s probably a good discussion for another thread, but not this.</p>
<p>So, I&#8217;m surprised. It looks like windows really have different widget implementations, just like &quot;other OS&quot;. The difference here is that they LOOK the same, and nobody has noticed it until you said it. Very smart move.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255153">
				<div id="div-comment-255153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matthew W. Jackson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255153">
			February 13, 2005 at 7:37 pm</a>		</div>

		<p>Windowed controls are horrible in terms of resource usage and overall performance, but its hard to write windowless controls that act just like the standard Windows controls everyone is used to.  Actually, we shouldn&#8217;t have to&#8211;that&#8217;s what GUI toolkits are for.  We should only have to write a new control if it does something that no other control does, and writing a multi-line text box from scratch is no easy task.  It&#8217;s not impossible, but I&#8217;d rather spend my time on more productive things.  Not to mention re-implementing IME would be a serious hurdle.</p>
<p>This is why I was initially disappointed when .NET had System.Windows.Forms, which is based entirely around Windowed controls.  Even VB6 had basic support for windowless controls.  But the backwards-compatability was nice, I suppose, and not having to jump through hurdles just to subclass a control was a big plus.  It just seems like it should have been Microsoft.Windows.Forms and not System.Windows.Forms, in the same manner that the registry APIs in .NET aren&#8217;t in System, but I digress.</p>
<p>And I don&#8217;t mean to completely criticize the product, either.  It&#8217;s much better than many previous attempts, but until Whidbey it was lacking in several key areas&#8230;mainly with regards to advanced controls, theming support, and text rendering that doesn&#8217;t look horrible on screen.  I&#8217;m sure glad these have been addressed, as I was getting tired of addressing them myself over and over in my projects, and P/Invoke to fix things always seems like a hack and not a solution when I&#8217;m doing managed work (Not to mention the security issues with calling unmanged code).</p>
<p>And seeing as Avalon appears to use windowless controls (except for when you&#8217;re hosting/interoping with a SWF control, I&#8217;d wager), I can&#8217;t complain too much, except that Avalon isn&#8217;t here yet.  But at least I can finally play with the preview version, if I change my theme, but i digress again.</p>
<p>And Avalon was certainly too big of a project to have been included in version 1 of .NET, and if it had been I&#8217;m sure it would not have been as good as it have been, so SWF is a great temporary solution.</p>
<p>And in regards to Diego&#8217;s comment about different wigit implementations (Win32, Office, IE), they really *don&#8217;t* look or act the same.  Office controls annoy me in many ways.  I can spot an Office from a Win32 control with a few seconds of use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255223">
				<div id="div-comment-255223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rafael 'Monoman' Teixeira</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255223">
			February 14, 2005 at 7:23 am</a>		</div>

		<p>Well, just to tell what a I did about the &lt;SELECT&gt; problems (besides z-ordering, it has issues with CSS formatting).</p>
<p>I wrote an entirely DHTML/Javascript solution, with automatic positioning/resizing of the list pane, and even support for pagination of the list. I wrote it using VB6/XSLT, some 4 years ago. </p>
<p>Maybe I can recreate it as an ASP.NET Custom control for easier reuse&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255343">
				<div id="div-comment-255343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.craigberntson.com' rel='external nofollow' class='url'>Craig Berntson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255343">
			February 14, 2005 at 9:41 am</a>		</div>

		<p>FoxPro has used bitmapped controls since the Windows version appeared over 10 years ago. Version 9.0 was just released and it still uses them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-255363">
				<div id="div-comment-255363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255363">
			February 14, 2005 at 10:19 am</a>		</div>

		<p>&quot;Now you&#8217;re off topic. &quot;<br />
<br />Well, I dunno about that.  The entire justification for windowless controls (the reason one would put up with their massive coding effort and non-standard appearance) is to keep resource usage managable.</p>
<p>Yet IE still uses a huge number of USER and GDI resources.  I suppose it&#8217;s possible that it&#8217;d be even worse without the windowless controls, but still&#8230; it&#8217;s pretty gross, and pretty frustrating.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-255513">
				<div id="div-comment-255513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brad Baker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-255513">
			February 14, 2005 at 3:36 pm</a>		</div>

		<p>People in this discussion mentioned &quot;clipping&quot; the select field area when moving a higher z-order DIV over a select field.</p>
<p>Can they please expand on this and the general approached used?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256013">
				<div id="div-comment-256013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan McCarty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-256013">
			February 15, 2005 at 8:04 pm</a>		</div>

		<p>KiwiBlue: Actually, Access 2.0 created its forms by rendering the form&#8217;s controls at run-time into an on-screen bitmap.  It then used two on-screen lightweight controls to (convincingly) imitate the control that currently had focus.  Since Access 2.0 originally ran on Win 3.1, what they were able to accomplish on 16-bit Windows was pretty advanced at the time.</p>
<p>I&#8217;m waxing a bit off-topic, but FWIW, Access 2.0 had one of the finest forms designers I&#8217;ve ever seen.  It was a pleasure to work with. Kudos to the original team.</p>
<p>(For the record, I spent way too of my life developing for Access 2.0.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-256023">
				<div id="div-comment-256023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan McCarty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-256023">
			February 15, 2005 at 8:05 pm</a>		</div>

		<p>KiwiBlue: Actually, Access 2.0 created its forms by rendering the form&#8217;s controls at run-time into an on-screen bitmap.  It then used two on-screen lightweight controls to (convincingly) imitate the control that currently had focus.  Since Access 2.0 originally ran on Win 3.1, what they were able to accomplish on 16-bit Windows was pretty advanced at the time.</p>
<p>I&#8217;m waxing a bit off-topic, but FWIW, Access 2.0 had one of the finest forms designers I&#8217;ve ever seen.  It was a pleasure to work with. Kudos to the original team.</p>
<p>(For the record, I spent way too of my life developing for Access 2.0.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-256293">
				<div id="div-comment-256293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-256293">
			February 17, 2005 at 3:30 am</a>		</div>

		<p>User32 IS a GUI toolkit. What is this obsession with running off and writing windowless controls anyway. I mean &#8211; &quot;proper&quot; windowed controls implement a certain set of functionality that contributes to their heavyweightness.  Any full featured windowless control is surely going to have re-implemented enough of that to be heavy all over again?</p>
<p>Anyway, is the core Win32 windowing system so ossified that it couldnt be lightened up? Why ARE we worried about user32 handle limits still?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-264783">
				<div id="div-comment-264783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/saraford/archive/2005/03/16/397077.aspx' rel='external nofollow' class='url'>Sara Ford's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-264783">
			March 16, 2005 at 4:46 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-409623">
				<div id="div-comment-409623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/08/16/702526.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-409623">
			August 16, 2006 at 10:00 am</a>		</div>

		<p>You&#8217;ll probably use it too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-448383">
				<div id="div-comment-448383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://aspadvice.com/blogs/rbirkby/archive/2006/12/04/WPF_2F00_E-December-2006-CTP-Released.aspx' rel='external nofollow' class='url'>C# Nuggets : WPF/E December 2006 CTP Released</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-448383">
			December 4, 2006 at 4:30 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://aspadvice.com/blogs/rbirkby/archive/2006/12/04/WPF_2F00_E-December-2006-CTP-Released.aspx" rel="nofollow">http://aspadvice.com/blogs/rbirkby/archive/2006/12/04/WPF_2F00_E-December-2006-CTP-Released.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-453493">
				<div id="div-comment-453493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/12/16/1305524.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-453493">
			December 16, 2006 at 2:56 pm</a>		</div>

		<p>It has its ups and downs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453523">
				<div id="div-comment-453523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/12/16/1305524.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-453523">
			December 16, 2006 at 5:40 pm</a>		</div>

		<p>It has its ups and downs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483453">
				<div id="div-comment-483453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.xobni.com/asmith/archives/23' rel='external nofollow' class='url'>Xobni Man Walking &raquo; Blog Archive &raquo; Reinventing Code</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050211-00/?p=36473#comment-483453">
			March 19, 2007 at 6:14 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.xobni.com/asmith/archives/23" rel="nofollow">http://blogs.xobni.com/asmith/archives/23</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>