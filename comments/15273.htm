<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-802693">
				<div id="div-comment-802693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802693">
			January 14, 2010 at 7:39 am</a>		</div>

		<p>Possibly the script is sandboxed and the filesystem object enforces the access controls. But the vulnerable scripting object doesn&#8217;t enforce them.</p>
<p>If the script already executes with the privilegues of the process without internal access control(like all native code does) then the vulnerability is of course not in the scripting object.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802703">
				<div id="div-comment-802703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802703">
			January 14, 2010 at 7:47 am</a>		</div>

		<p>There&#8217;s only one way to make a sever secure.</p>
<p>Remove it from the network, lock it in a solid cage and throw away the key.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802723">
				<div id="div-comment-802723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SMW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802723">
			January 14, 2010 at 8:03 am</a>		</div>

		<p>&quot;There&#8217;s only one way to make a sever secure.</p>
<p>Remove it from the network, lock it in a solid cage and throw away the key.&quot;</p>
<p>But don&#8217;t include any vents, or else Tom Cruise will rappel down from above and steal your data.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802743">
				<div id="div-comment-802743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.henke37.cjb.net/' rel='external nofollow' class='url'>Henke37</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802743">
			January 14, 2010 at 8:45 am</a>		</div>

		<p>@W Permissions are done on an user basis by the OS. This is outlined in some of the other crackpot vulnerability posts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802753">
				<div id="div-comment-802753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://arnshea.blogspot.com/' rel='external nofollow' class='url'>arnshea</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802753">
			January 14, 2010 at 11:17 am</a>		</div>

		<p>Hilarious! &nbsp;Almost as good as a &quot;vulnerability&quot; description that starts with &quot;Run this script from an elevated command prompt&#8230;.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802763">
				<div id="div-comment-802763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802763">
			January 14, 2010 at 11:18 am</a>		</div>

		<p>Henke37: W is right. If this object is marked safe for scripting, it&#8217;s additionally guaranteeing it can&#8217;t execute arbitrary code, and shouldn&#8217;t be able to write to arbitrary locations.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802783">
				<div id="div-comment-802783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">_</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802783">
			January 14, 2010 at 11:58 am</a>		</div>

		<p>Raymond, i am sorry you have to read the stupid comments above. It is so embarrassing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802803">
				<div id="div-comment-802803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802803">
			January 14, 2010 at 12:09 pm</a>		</div>

		<p>This reminds me of a common weakness across several systems I used to see trying to implement &quot;security&quot; features.</p>
<p>These systems would have a &quot;login&quot; dialog, or perhaps some kind of kiosk UI. &nbsp;They managed to block Ctrl-Alt-Del and Ctl-Shift-Esc. &nbsp;But not F1.</p>
<p>F1 would open the help viewer, then you could go through the motions of asking the help viewer to open a different .hlp file. &nbsp;(I guess this would be .chm today.) &nbsp;In the file open dialog, you could browse to system32 and right-click on cmd to open it.</p>
<p>I saw a similar weakness in a kiosk system that used IWebBrowser2 to present its UI. &nbsp;You could right-click the control, select &quot;view source&quot;, and get to the shell via notepad.</p>
<p>Is this a bug in the shell, the help viewer, or IWebBrowser2? &nbsp;Well, if the program wanted to lock down the user, they shouldn&#8217;t have provided these entry points to begin with. &nbsp;It&#8217;s not reasonable to expect the authors of reusable components to do your security work for you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802813">
				<div id="div-comment-802813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick M.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802813">
			January 14, 2010 at 12:11 pm</a>		</div>

		<p>[Golf claps for a Doug Adams quote]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802833">
				<div id="div-comment-802833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Tyrrill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802833">
			January 14, 2010 at 1:47 pm</a>		</div>

		<p>@Paul:</p>
<p>Your comments are a huge insult to those who design, improve, and set up systems which are actually secure.</p>
<p>Or did you just intend to interrupt this thread with your &quot;humor&quot; while people who understand the issues discuss them seriously?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802843">
				<div id="div-comment-802843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802843">
			January 14, 2010 at 1:56 pm</a>		</div>

		<p>&quot;Your comments are a huge insult to those who design, improve, and set up systems which are actually secure&quot;</p>
<p>no, because anyone who actually designs systems that try to be secure would be nodding along to that</p>
<p>note that I said &quot;try to be secure&quot; because those in the know also recognise no general-purpose internet-enabled system can ever be totally secure</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802853">
				<div id="div-comment-802853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802853">
			January 14, 2010 at 2:03 pm</a>		</div>

		<p>Mark, safe for scripting shouldn&#8217;t make that guarentee. As an administrator the mindset shouldn&#8217;t be, &quot;The control says it is safe, I will blindly use it&quot; but &quot;The control says it is safe so I will test it out and confirm it before I allow it to be used&quot;.</p>
<p>Lets face it, would a malicious control advertise &quot;I&#8217;m unsafe, if you use me I will grab personal data and send it off to some one for them to use for bad things&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802863">
				<div id="div-comment-802863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">a random passerby</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802863">
			January 14, 2010 at 2:04 pm</a>		</div>

		<p>@Jeff,</p>
<p>Most of my friends who are into computer security would agree with Paul. &quot;Perfect network security&quot; is like &quot;bug-free software&quot;. I&#8217;m sorry, but it doesn&#8217;t exist.</p>
<p>If you&#8217;re so certain that you can make it happen, though, enough so that you feel the need to be offended by a little security humor, then by all means apply for a job at Google. Based on recent events, they&#8217;d probably be in the market for security gurus right about now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802873">
				<div id="div-comment-802873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://arnshea.blogspot.com/' rel='external nofollow' class='url'>arnshea</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802873">
			January 14, 2010 at 2:32 pm</a>		</div>

		<p>@random passerby, Hear Hear.</p>
<p>@Crescens2k, testing is good but testing has its limits. &nbsp;Every conditional in a program represents a potential vulnerability. &nbsp;Lowballing 10% of lines of code to be conditionals/branches and at 1000 lines of code you&#8217;re already talking about 2^100 possible states.</p>
<p>Throw in code injection, whether through dynamically loaded libraries or dynamically generated code, and, as they say in parts of New York City: fuggedaboutit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802893">
				<div id="div-comment-802893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802893">
			January 14, 2010 at 3:31 pm</a>		</div>

		<p>@Anonymous HTML Help can&#8217;t open other CHM files from its UI, you&#8217;d have to specify them on the command line for HTML Help so it wouldn&#8217;t help you here (pun not intended).</p>
<p>@Jeff Tyrrill I actually find Paul&#8217;s comment accurate, and not insulting at all. &nbsp;You, on the other hand, seem a bit naive. &nbsp;It is impossible to have a 100% secure server. &nbsp;There will always be bugs somewhere in a sufficiently complicated system. &nbsp;Even if you magically make a system with no bugs that is 100% secure&#8230; you have to have human users otherwise the system isn&#8217;t very useful. &nbsp;Those users will always be the weakest links, perfect system or not.</p>
<p>Hmm&#8230; why is the capcha textbox autocompleting? &nbsp;It needs autocomplete=&quot;off&quot; on its tag attributes, or whatever it is. :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802903">
				<div id="div-comment-802903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802903">
			January 14, 2010 at 3:49 pm</a>		</div>

		<p>@arnshea</p>
<p>I guess I need to apologise since I seemed to have been totally unclear as to what I was getting at. The whole tone of that post was not how the code should be secure but actually how a system administrator should be aware of what is going on and lock things down apropriately.</p>
<p>It was suggested to use and check for a components safe for scripting state but I said that is not possible since you can&#8217;t rely on safe for scripting since it could be possible for a component to say, yes I am safe and then do bad things.</p>
<p>But even with a component which isn&#8217;t malicious it is always possible to do accidental bad things. So the best thing to do is have someone figure out these problems and then make sure that if you do use the component, it should be used in such a way that the component will not cause any problems. (Ie, by running the process with reduced privilages).</p>
<p>In this case nothing beats having a properly locked down server with properly configured ACLs on the file system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802913">
				<div id="div-comment-802913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802913">
			January 14, 2010 at 4:52 pm</a>		</div>

		<p>Dan,</p>
<p>HTML help UI provides many ways to open a file dialog. Use Options-&gt;Internet options (besides of the obvious View Source).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802923">
				<div id="div-comment-802923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Tyrrill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802923">
			January 14, 2010 at 8:09 pm</a>		</div>

		<p>Point taken, to those who believe I was unfairly critical of Paul.</p>
<p>I don&#8217;t guarantee that systems I work on are 100% secure, and I don&#8217;t expect others to either. But there are many decisions that almost entirely move a system in the direction of being more secure (or less secure). Also, when viewed on the level of a <em>specific vulnerability</em>, many times it really is a binary issue&#8211;fixing the bug makes that vulnerability go away.</p>
<p>I felt like making a sweeping statement in the second post akin to &quot;we can&#8217;t be secure no matter how hard we try&quot; had the implicit meaning &quot;so why bother?&quot; thus negating the very useful point that Raymond was making, which was why I responded so strongly. It felt to me like a platitude that served no positive purpose.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-802883">
				<div id="div-comment-802883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802883">
			January 14, 2010 at 3:23 pm</a>		</div>

		<p>@JeffTyrill: you have servers you personally guarantee are 100% secure and will never ever ever be compromised?</p>
<p>I think you&#8217;re forgetting the long history of very surprising things being hacked/compromised.</p>
<p>Is that encryption you&#8217;re using secure? Really? Is the implementation secure? Prove someone hasn&#8217;t broken it, or doesn&#8217;t have a personal data centre.</p>
<p>Is your OS provably secure? Pffft. Of course it isn&#8217;t &#8212; that&#8217;s why you regularly patch it. </p>
<p>Is the firmware in all your network devices in your network been hacked because you unknowingly bought it after a foreign security agency? Or is the device insecure (I have a friend who tests network device security for a living. He&#8217;s *never* found a device without security issues).</p>
<p>Your hackles may have been riled, but sheesh, this is the internet, after all, what do you expect?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-802963">
				<div id="div-comment-802963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100114-00/?p=15273#comment-802963">
			January 15, 2010 at 4:20 am</a>		</div>

		<p>Uploading scripts and running them as SYSTEM is asinine, not just insecure.</p>
<p>The point stands that if you stop the user from doing that, which you should, they will attempt to find another way in.</p>
<p>How many times do we see &quot;Update to X. A vunerability has been found in X which may allow a remote attacker to take control of your system.&quot;</p>
<p>I saw that a while back in something innocuous like MSPaint and laughed a little on the inside.</p>
<p>I have a really secure server at home.</p>
<p>It&#8217;s midway through installing Windows 2003, it&#8217;s no longer connected to the mains and I have been known to use it as a seat. Currently it&#8217;s got my tablet docking station on it.</p>
<p>I doubt any remote attacker will be able to commandeer it!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>