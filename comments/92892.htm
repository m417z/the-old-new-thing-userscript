<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (7)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-raykoopa even thread-even depth-1 parent" id="comment-1224051">
				<div id="div-comment-1224051" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ray+Koopa' rel='external nofollow' class='url'>Ray Koopa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224051">
			January 20, 2016 at 8:14 am</a>		</div>

		<p>I wonder what the use-case scenario was in 16-bit Windows for the RegOpenKey function to behave like that.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1224072">
				<div id="div-comment-1224072" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224072">
			January 20, 2016 at 9:10 am</a>		</div>

		<p>As noted in the linked article, Win16 had a different handle model.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1224053">
				<div id="div-comment-1224053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224053">
			January 20, 2016 at 8:46 am</a>		</div>

		<p>For compatibility functions like that, it would be cool if the equivalence with the new function was stated more explicitly, preferentially in source code form. Something like:</p>
<p>{<br />
  if (lpSubKey == NULL || lpSubKey[0] == &#8221;) {<br />
    *phkResult = hKey;<br />
    return ERROR_SUCCESS;<br />
  }<br />
  return RegOpenKeyEx(&#8230;);<br />
}</p>
<p>That would make special compatibility cases obvious, and also would show what to pass to the new function if you want it to behave like the old function for the normal cases.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt thread-even depth-1" id="comment-1224062">
				<div id="div-comment-1224062" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224062">
			January 20, 2016 at 8:53 am</a>		</div>

		<p>I seem to recall that the Ex version might not always give you a new handle on Win9x. If you want to make your own (working) version of shlwapi!SHRegDuplicateHKey you have to do something special?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1224151">
				<div id="div-comment-1224151" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224151">
			January 20, 2016 at 3:04 pm</a>		</div>

		<p>Link &#8220;16-bit compatibility behavior&#8221; is a 404. More import trouble?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2" id="comment-1224161">
				<div id="div-comment-1224161" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224161">
			January 20, 2016 at 3:55 pm</a>		</div>

		<p>See yesterday&#8217;s article for an explanation and workaround.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1224651">
				<div id="div-comment-1224651" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MarcK4096</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160120-00/?p=92892#comment-1224651">
			January 25, 2016 at 5:36 am</a>		</div>

		<p>I bet it wasn&#8217;t, but one could have made a case to drop Reg­Open­Key completely from the 64-bit version of Advapi32.dll.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>