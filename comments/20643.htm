<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (25)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-673423">
				<div id="div-comment-673423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673423">
			October 6, 2008 at 1:34 pm</a>		</div>

		<p>HWND GetActiveForegroundWindowEx2(BOOL bSpecial)</p>
<p>{</p>
<p>&nbsp; &nbsp;if(bSpecial)</p>
<p>&nbsp; &nbsp;{</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;return GetForegroundWindow();</p>
<p>&nbsp; &nbsp;}</p>
<p>&nbsp; &nbsp;else</p>
<p>&nbsp; &nbsp;{</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;return GetActiveWindow();</p>
<p>&nbsp; &nbsp;}</p>
<p>}</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673433">
				<div id="div-comment-673433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673433">
			October 6, 2008 at 2:09 pm</a>		</div>

		<p>@John: That was a joke, right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-673463">
				<div id="div-comment-673463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673463">
			October 6, 2008 at 3:08 pm</a>		</div>

		<p>You&#8217;re right, of course, about the &quot;passing a special flag&quot; solution not being effective in real life. &nbsp;</p>
<p>In a perfect world, a flag called &quot;DontUseThisUnlessYouReallyNeedToAndYouKnowWhatYoureDoingAndYouHaveReadTheDocFirst&quot; would actually work and not be abused.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673473">
				<div id="div-comment-673473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673473">
			October 6, 2008 at 3:27 pm</a>		</div>

		<p>Who said programs have only a single thread and a single input queue? &nbsp;In normal circumstances, GetActiveWindow() only returns the current thread&#8217;s active window. If you use mutliple threads, you are SOL.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673483">
				<div id="div-comment-673483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673483">
			October 6, 2008 at 4:08 pm</a>		</div>

		<p>&lt;chills&gt; I&#8217;m really going to have to start watching what I say :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673493">
				<div id="div-comment-673493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tpasoft.com' rel='external nofollow' class='url'>Kevin Provance</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673493">
			October 6, 2008 at 4:09 pm</a>		</div>

		<p>I got all excited there for a sec. &nbsp;GetFocalWindow?? &nbsp;I was like, &quot;wow, what&#8217;s this new thing I&#8217;ve never heard about??&quot; &nbsp;And then I saw the footnote. &nbsp;Day ruined. &nbsp;Thanks Raymond. &nbsp;&lt;g&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673503">
				<div id="div-comment-673503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673503">
			October 6, 2008 at 4:41 pm</a>		</div>

		<p>In the end, it all boils down to a cargo cult programming. Get this example from the web or from MSJ, fudge it till it does what you want, voila. No need to read the docs and learn something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673523">
				<div id="div-comment-673523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673523">
			October 6, 2008 at 5:55 pm</a>		</div>

		<p>@Josh:</p>
<p>Obviously :)</p>
<p>@Ben:</p>
<p>True, but I don&#8217;t think there is much of a use case for this scenario.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-673533">
				<div id="div-comment-673533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673533">
			October 6, 2008 at 5:57 pm</a>		</div>

		<p>Methinks Ben needs to read the WHOLE post&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673553">
				<div id="div-comment-673553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Duke of New York</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673553">
			October 6, 2008 at 6:54 pm</a>		</div>

		<p>&#8216;It&#8217;s like calling a land line a &quot;wired cell phone&quot;&#8217;</p>
<p>You might be surprised at how many software developers say &quot;forward backslash.&quot; There are at least two, enough to surprise the heck out of me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673563">
				<div id="div-comment-673563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">hexatron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673563">
			October 6, 2008 at 8:37 pm</a>		</div>

		<p>Of course, all this is made thoroughly opaque by the documentation of these functions.</p>
<p>GetForegroundWindow:</p>
<p>The GetForegroundWindow function returns a handle to the foreground window (the window with which the user is currently working). The system assigns a slightly higher priority to the thread that creates the foreground window than it does to other threads.</p>
<p>GetActiveWindow:</p>
<p>The GetActiveWindow function retrieves the window handle to the active window attached to the calling thread&#8217;s message queue.</p>
<p>Perhaps not the clearest possible distinction&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673573">
				<div id="div-comment-673573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673573">
			October 7, 2008 at 4:29 am</a>		</div>

		<p>This is why getting full, unambiguous documentation for functions out there in good time is so important.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673583">
				<div id="div-comment-673583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bitvise.com/' rel='external nofollow' class='url'>denis bider</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673583">
			October 7, 2008 at 4:47 am</a>		</div>

		<p>This is an example of poor naming. Functionality tends not to be abused as much if it is named appropriately.</p>
<p>Instead of silently modifying the behavior of GetActiveWindow(), it should have been deprecated and replaced with something like GetOwnActiveWindow() and GetGlobalActiveWindow().</p>
<p>This would have made things much clearer to users, and would embed a pointer that would help people understand &lt;i&gt;why&lt;/i&gt; one function &quot;works better&quot; in some circumstances than the other.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673593">
				<div id="div-comment-673593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Levine</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673593">
			October 7, 2008 at 6:03 am</a>		</div>

		<p>Here&#8217;s the documentation for GetActiveWindow()&#8230;</p>
<p>&quot;Return Value</p>
<p>The return value is the handle to the active window attached to the calling thread&#8217;s message queue. Otherwise, the return value is NULL. &quot;</p>
<p>There&#8217;s a lot of interpretation and knowledge required to go from that to the understanding that Raymond has of its behavior; several additional lines of explanation would go a long way. The world outside Redmond did not write Windows and we do not have access to the source code; we should not be required to be insiders to write correct code to the Windows API.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673603">
				<div id="div-comment-673603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kL</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673603">
			October 7, 2008 at 7:55 am</a>		</div>

		<p>In Cocoa Apple solved this problem by making it so incredibly awkward to get system-wide frontmost window (you need old carbon calls or&#8230; AppleScript!), that people give up and just use API for getting current process&#8217; frontmost/key window :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673613">
				<div id="div-comment-673613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Butler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673613">
			October 7, 2008 at 8:17 am</a>		</div>

		<p>The problem seems to be a case of people picking the first function that &#8216;sounds&#8217; like it might do what they are looking for &#8211; without first reviewing the total set of window-related functions. &nbsp;If they discover a function called GetForgroundWindow() and imagine, or more likely, hope this is what they wanted without exploring further then they are simply poor developers. &nbsp;Whatever Microsoft choose to do, these people are going to screw something up at some point and we&#8217;ll have a handful of people with hindsight saying, well of course Microsoft shouldn&#8217;t have called it CreateWindow(), they should have called it AttemptToCreateWindowButSomethingMightHappenToPreventSuccess_Remarks_SeeAlso_AttemptToCreateWindowButSomethingMightHappenToPreventSuccessEx()</p>
<p>There are a few commentators here that seem to think it&#8217;s the documentation&#8217;s fault that people get it wrong, but I think if someone looks at a function called GetActiveWindow() and GetForegroundWindow() and then sees the documentation has different descriptions, and the remarks section of one refers to a case where you would want to use the other, but can&#8217;t be bothered to understand the distinction, then it is down to the programmer who decided to use the first function they find with an sort of right sounding name.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673633">
				<div id="div-comment-673633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MadQ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673633">
			October 7, 2008 at 10:42 am</a>		</div>

		<p>@Duke of New York: That&#8217;s even worse than &quot;Backward Backslash&quot;, which would at least be correct.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673663">
				<div id="div-comment-673663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673663">
			October 7, 2008 at 12:54 pm</a>		</div>

		<p>Dean: I&#8217;m missing something then. &nbsp;Each thread gets its own input queue (you can attach them, but that isn&#8217;t always acceptable). &nbsp;Per Raymond, GetActiveWindow() returns the &quot;active&quot; window for the current input queue. &nbsp;</p>
<p>The implication is that if the program has multiple input queues, it won&#8217;t return the &quot;topmost window in my process&quot;. &nbsp;Rather, it returns the topmost window on the current thread.</p>
<p>Did I miss something?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673713">
				<div id="div-comment-673713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673713">
			October 7, 2008 at 3:57 pm</a>		</div>

		<p>Hooray for cargo cult programming!</p>
<p>Forget wasting time understanding what you&#8217;re doing! Just try random stuff until it &quot;seems&quot; to work, or ask other kids on the net what they&#8217;ve found &quot;seems&quot; to work!</p>
<p>Fortunately, ${NEW_TECHNOLOGY} (be it Java or Python or C# or whatever) is so amazing and easy to use that anyone can write perfect code, and thus will be immune to all the mistakes that were the fault of ${OLD_TECHNOLOGY}.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673723">
				<div id="div-comment-673723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673723">
			October 7, 2008 at 4:12 pm</a>		</div>

		<p>Most bad programming practices are language-independent.</p>
<p>In the end, bad programmers always win!</p>
<p>Yipee!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673683">
				<div id="div-comment-673683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673683">
			October 7, 2008 at 1:43 pm</a>		</div>

		<p>It&#8217;s not really relevant that GetActiveWindow only returns it for the current thread. </p>
<p>The vast majority of application only have one thread. &nbsp;Generally the multithreaded app do all UI in a single UI thread. &nbsp;Furthermore, generally anyone that wants to know the active window would be doing it from the same thread, anyway. &nbsp;Making an app that uses multiple UI threads is *very* complicated and very much an edge case &#8211; and I&#8217;ve worked on huge video editing and 3D CAD applications.</p>
<p>I do agree with some comments above that GetForegroundWindow could have had a better name that implies when you see it that it returns windows that may not belong to you. &nbsp;It could have used another name or returned the process handle to imply it, etc. It&#8217;s a reasonable suggestion &#8212; though of course it&#8217;s too late now :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-673773">
				<div id="div-comment-673773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673773">
			October 8, 2008 at 12:26 am</a>		</div>

		<p>Ulric, generally apps that do UI in multiple threads are like Explorer or IE in that they show separate, unrelated windows with each thread. Indeed, I&#8217;ve written one myself. In these cases, each thread would only want its own active window.</p>
<p>It&#8217;s hard to imagine a scenario where a process has multiple UI threads and needs one to find another&#8217;s active window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-673853">
				<div id="div-comment-673853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-673853">
			October 8, 2008 at 11:45 am</a>		</div>

		<p>MS could change the behaviour of GetForegroundWindow() so that it returned NULL unless the application was on an administrator approved list of &quot;apps allowed to wrest control of the UI away from the end-user&quot;.</p>
<p>But then someone would post some code to the web that added your app to this list at install time. Still, at least a vigilant end-user could remove it afterwards.</p>
<p>But then, your app would crash and your product support team would tell the end-users &quot;What do you expect? You broke our installation!&quot;.</p>
<p>Gosh that&#8217;s a depressing train of thought. Is that the sort of stuff the Windows team have to think about every day? How do they stay sane? Why don&#8217;t they all just end up as axe-wielding homocidal maniacs bent on the grizzly extermination of all &quot;application programmers&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674023">
				<div id="div-comment-674023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://grayraven.com/JimNtexas' rel='external nofollow' class='url'>Jim Howard</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-674023">
			October 8, 2008 at 2:39 pm</a>		</div>

		<p>These api&#8217;s usually come up when management tells the windows developer that our application must pop up on top and seize control of the mouse and keyboard from all other processes, because we&#8217;re so special.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674773">
				<div id="div-comment-674773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://eleccham.valleyhold.org' rel='external nofollow' class='url'>Gordon Schumacher</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081006-00/?p=20643#comment-674773">
			October 11, 2008 at 10:52 am</a>		</div>

		<p>Required caveat: I am not MS-bashing here; I am well aware of how hard a task is at hand, and *nobody* does it right. &nbsp;MS has kept a remarkably consistent API over the years. &nbsp;That is to say &#8211; &quot;all software sucks, all hardware sucks&quot;&#8230;</p>
<p>@Ken Hagan:</p>
<p>&quot;Gosh that&#8217;s a depressing train of thought. Is that the sort of stuff the Windows team have to think about every day? How do they stay sane? Why don&#8217;t they all just end up as axe-wielding homocidal maniacs bent on the grizzly extermination of all &quot;application programmers&quot;?&quot;</p>
<p>Probably because they realize that there&#8217;s an equal proportion of potential axe-wielding homicidal maniacs bent on the grisly extermination of &quot;those guys who keep changing the rules for Win32 programming&quot;&#8230; and that there are more of them than there are Microsoft employees&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>