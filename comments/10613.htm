<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-914323">
				<div id="div-comment-914323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914323">
			May 20, 2011 at 8:50 am</a>		</div>

		<p>While I certainly wouldn&#39;t say &quot;How dare you show us an alternative method that isn&#39;t available on Windows 2000!&quot;, I do have to admit that while very interesting, this isn&#39;t practical for many of us who do have to write software that still runs on Windows XP.</p>
<p>Certainly, the day our Product Management gives us the go ahead to drop XP, stuff like this will be useful. &nbsp;But since we barely dropped Win95 support 5 years ago, I doubt that day is coming any time soon. (Which I find sad, since there is a ton of stuff in Vista and Win 7 that would make my life easier if I could use it).</p>
<p>Anyway, thanks for the tip, I hope I can use it someday.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-914353">
				<div id="div-comment-914353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GrumpyYoungMan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914353">
			May 20, 2011 at 9:57 am</a>		</div>

		<p>@SimonRev</p>
<p>Amazing. &nbsp;Raymond goes out of his way to preempt such comments and you go ahead and do it anyway. &nbsp;Any sympathy I might have had for you was erased instantly. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-914363">
				<div id="div-comment-914363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914363">
			May 20, 2011 at 10:06 am</a>		</div>

		<p>Can pre-emptive snarky comments get stars? &nbsp;One is surely deserved here!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-914383">
				<div id="div-comment-914383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914383">
			May 20, 2011 at 10:11 am</a>		</div>

		<p>Microsoft has indeed been making improvements to APIs of Windows. Case in point: GetNamedPipeClientSessionId.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-914393">
				<div id="div-comment-914393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bradley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914393">
			May 20, 2011 at 10:17 am</a>		</div>

		<p>Why would you want to do this in the real world? It seems to go out of it&#39;s way to get a bitmap that may or may not work on the OS, and one that might not be the size you asked for. This sounds like a &quot;clever hack&quot; that is just going to cause problems, when it would be FAR easier and safer to just create a bitmap the &quot;normal&quot; way.</p>
<div class="post">[<i>Consider an app with 500 UI widgets, and when some event occurs, each widget needs to redraw its cached image. You could create and destroy 500 temporary bitmaps or use the same temporary bitmap 500 times. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-914413">
				<div id="div-comment-914413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914413">
			May 20, 2011 at 11:53 am</a>		</div>

		<p>@GrumpyYoungMan</p>
<p>My point was in no way to complain. &nbsp;I hope that nothing in my original post could be construed as &quot;snarky&quot;. &nbsp;</p>
<p>The fact is I appreciate having these little tidbits pointed out. &nbsp;Unfortunately, XP is victim of its own success and shows no sign disappearing any time soon, leaving 3rd party developers (and in fairness, many teams internal to Microsoft as well) more or less stuck using decade old APIs until XP is finally completely end of lifed.</p>
<p>That said, I am glad to know of one more tool that I hope I could use one day.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-914443">
				<div id="div-comment-914443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914443">
			May 21, 2011 at 1:48 am</a>		</div>

		<p>Guess I don&#39;t get the snark. I use Windows 2000, but I don&#39;t see the problem &#8211; Microsoft doesn&#39;t support Win2k since July 2010, so&#8230; XP however is 2014.</p>
<p>Of course, if this article was written in 2008, I suppose it would&#39;ve been appropriate then. In which case it appears Raymond&#39;s queue is around 3 years deep. Which means Raymond&#39;s new pre-emptive snarks about XP will probably be misunderstood as XP is unsupported when we see them in 2014.</p>
<p>Looks like an interesting API and someone had the foresight to include a &quot;oops&quot; parameter to let it be used in interesting ways.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-914493">
				<div id="div-comment-914493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914493">
			May 22, 2011 at 2:47 pm</a>		</div>

		<p>it&#39;s not necessary to do something like call GdiFlush before using the bits of the bitmap?</p>
<div class="post">[<i>All the standard rules apply. I don&#39;t see where I suggested otherwise. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-914503">
				<div id="div-comment-914503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914503">
			May 22, 2011 at 5:49 pm</a>		</div>

		<p>Isn&#39;t FillRect function drawing on the the bitmap bits that are being directly accessed right after, or did I misunderstand the sample? </p>
<p>If so, isn&#39;t syncing with GDIflush() required at that point, if not, why?</p>
<div class="post">[<i>Yes, it is necessary. That&#39;s a bug. But it also has nothing to do with the conversion to use BeginBufferedPaint. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-914933">
				<div id="div-comment-914933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110520-00/?p=10613#comment-914933">
			May 24, 2011 at 9:03 pm</a>		</div>

		<p>it would be best to update the sample for posterity; it&#39;s already spending many lines on premultiplying alpha blending; might as well make it 100% correct</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>