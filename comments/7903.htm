<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (28)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-977263">
				<div id="div-comment-977263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977263">
			April 9, 2012 at 7:39 am</a>		</div>

		<p>Ok, but there&#39;s got to be some limit on how far you are willing to go to fix other people&#39;s bugs. &nbsp;Then again, I remember reading the blog entry about manually pushing a hundred bytes on the stack so people can continue to abuse rundll32. &nbsp;So I guess there is no limit. &nbsp;Your life must suck.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977273">
				<div id="div-comment-977273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Caron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977273">
			April 9, 2012 at 7:56 am</a>		</div>

		<p>In real life, you can sue people for violating contracts.</p>
<p>Sigh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977293">
				<div id="div-comment-977293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Compatibility price</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977293">
			April 9, 2012 at 8:32 am</a>		</div>

		<p>Microsofts first mistake of many: &quot;Bending over and taking it.&quot;</p>
<p>X years later we see how desperate microsoft were to keep their few customers happy.</p>
<p>Oh and surprise, guess who&#39;s paying the performance penalties and the api mess confusion for all these &quot;compatibility-fixes&quot;.</p>
<p>What they should have done is to say to the customer using a buggy software to report the bug to the developers of switch to a more stable software.</p>
<p>Doesn&#39;t you find it odd that when ever microsoft does something stupid that goes against common sense its not microsoft that pays the price in the end but its users.</p>
<p>I for one would love to be able to permanently turn of ALL compatibility fixes and workarounds.</p>
<p>1. That way i would avoid depending on undocumented compatibility &quot;fixes&quot; when i write programs.</p>
<p>2. It would reveal all the software that does stupid things, i love to publicly file bug reports. My shame-list is long already. Best way to make developers get off their ass and fix the bugs. Works like a charm for security bugs ;D that they would otherwise try to hide.</p>
<p>3. The performance gain, woho !</p>
<div class="post">[<i>If you don&#39;t want to accommodate compatibility in your code, then go ahead and pass NULL. See how many customers you get. If you want to see the shame list, just look at the Application Compatibility Database. And as we saw some time ago, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/07/23/4003873.aspx" rel="nofollow">in most cases, the performance gain is minuscule</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977313">
				<div id="div-comment-977313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977313">
			April 9, 2012 at 8:42 am</a>		</div>

		<p>&quot;Compatibility price&quot;&#39;s definition of the word &#39;few&#39; is one that I&#39;m not familiar with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-977323">
				<div id="div-comment-977323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977323">
			April 9, 2012 at 8:56 am</a>		</div>

		<p>There&#39;s something to be said for a &quot;developer mode&quot; switch that enforces strict behavior. &nbsp;Running on a chk build with Application Verifier turned on, Driver Verifier turned on, and a kernel debugger attached gets you a good portion of the way there.</p>
<div class="post">[<i>The great thing about making a strict version of the operating system is that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/07/18/10187351.aspx" rel="nofollow">nobody will run it</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-977333">
				<div id="div-comment-977333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977333">
			April 9, 2012 at 9:40 am</a>		</div>

		<p>&quot;Running on a chk build with Application Verifier turned on, Driver Verifier turned on, and a kernel debugger attached gets you a good portion of the way there.&quot;</p>
<p>I don&#39;t know about you, but in the Win7 checked build, I can&#39;t even play Mahjong Titans (or was it Freecell?). Without App Verifier.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977343">
				<div id="div-comment-977343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977343">
			April 9, 2012 at 10:12 am</a>		</div>

		<blockquote><p>
  I don&#39;t know about you, but in the Win7 checked build, I can&#39;t even play Mahjong Titans (or was it Freecell?). Without App Verifier.
</p></blockquote>
<p>That sucks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-977353">
				<div id="div-comment-977353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977353">
			April 9, 2012 at 11:39 am</a>		</div>

		<p>The idea of a &quot;strict mode&quot; is not so that you can play FreeCell on it, but rather so that you can verify your application isn&#39;t mistakenly relying on a Windows safety net.</p>
<p>That said, there are the occasional kooks out there who like to selfhost some variation of &quot;strict mode&quot; (like me, and apparently like alegr1.) &nbsp;I find lots of bugs this way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcohn even thread-even depth-1" id="comment-977363">
				<div id="div-comment-977363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977363">
			April 9, 2012 at 11:52 am</a>		</div>

		<p>Can&#39;t you pass the same pointer twice, giving same sizes for small and big icons? Or this will also bump into some incompatible extensions?</p>
<div class="post">[<i>How do you destroy the first icon if its handle got overwritten by the second one? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977373">
				<div id="div-comment-977373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977373">
			April 9, 2012 at 11:58 am</a>		</div>

		<p>Several parts of the .NET framework also cause Windows checked build to complain loudly. &nbsp;No one on the .NET team seemed to care, however.</p>
<p><a rel="nofollow" target="_new" href="https://connect.microsoft.com/VisualStudio/feedback/details/306816/system-windows-forms-control-wmpaint-always-calls-beginpaint" rel="nofollow">connect.microsoft.com/&#8230;/system-windows-forms-control-wmpaint-always-calls-beginpaint</a></p>
<p>It&#39;s very difficult to impress on third-party developers that they should test their applications using the checked build when Microsoft won&#39;t do the same for their developer runtimes (which creates false positives for the third-party developer to wade through).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977383">
				<div id="div-comment-977383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/analisnudesette_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>analisnudesette@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977383">
			April 9, 2012 at 12:10 pm</a>		</div>

		<p>Nobody wants to run Windows checked builds because few of the people who know they even exist can justify setting up and doing additional testing using a dedicated (virtual) machine, where most likely nothing actually works anyway, even before you throw in third-party components.</p>
<p>Don&#39;t confuse people ignoring a flawed solution with a lack of desire for a good solution. :) It&#39;s an example of the politician&#39;s logic that you quoted a while ago. (&quot;Something was needed. Checked builds are something. Therefore checked builds must be what was needed.&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977393">
				<div id="div-comment-977393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977393">
			April 9, 2012 at 12:31 pm</a>		</div>

		<blockquote><p>
  So I guess there is no limit. &nbsp;Your life must suck.
</p></blockquote>
<p>I don&#39;t understand these kind of comments. Thinkering and working around bugs is always a part of engineering. It&#39;s sad if you don&#39;t like your job.</p>
<p>And whenever you want to run an application or help your relatives fix their computer, you should be really grateful for everyone who makes programs work instead of being an idealistic PITA</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977403">
				<div id="div-comment-977403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chentiangemalc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977403">
			April 9, 2012 at 1:07 pm</a>		</div>

		<p>I love these people who live in some idealistic fantasy world and always begging to have all this stuff switched off, they have no idea what it breaks. Working with appcompat issues daily I&#39;m continually thankful for Raymond&#39;s efforts in these areas.</p>
<p>The WinRT (Metro) app model in Windows 8 does potentially move away from the need for this app compat patching though&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977413">
				<div id="div-comment-977413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977413">
			April 9, 2012 at 1:15 pm</a>		</div>

		<p>It seems to me that there&#39;s a straightforward solution to developers not using checked builds to catch errors &#8212; make public prerelease versions (Technology Preview, Beta) of Windows only available as checked build. &nbsp;You want to be a &quot;launch partner&quot; and have the logo for Windows 9 compatible on launch day? &nbsp;Make your app work on the checked build. &nbsp;Development houses that can&#39;t be bothered can still develop for Windows.next and get the logo, they&#39;ll just have to wait for RTM.</p>
<p>@Leo: Anyone who cares about testing already has virtual machines with different Service Packs, different versions of .NET installed, etc. &nbsp;Having one running the latest checked build really shouldn&#39;t be a great additional burden. &nbsp;If the checked build comes bundled with apps that fail the checks, then Microsoft really needs to clean those up. &nbsp;Nothing says &quot;Our security culture is a sham&quot; quite like positive reports from your own automated analysis tools.</p>
<p>Maybe that&#39;s the solution &#8212; report Microsoft products triggering checked build warnings as potential security flaws. &nbsp;Get the SDL folks investigating each invalid parameter to see if it creates a vulnerability.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977423">
				<div id="div-comment-977423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977423">
			April 9, 2012 at 1:58 pm</a>		</div>

		<p>Regarding the crash in Extract, MSDN has this to say: Beginning with the .NET Framework version 4, the Assembly Cache Viewer (Shfusion.dll) [the implementation that crashed when passing NULL] is obsolete and has been removed.</p>
<p>As for the non-crashing case, I wouldn&#39;t bother with working around the bug. If someone doesn&#39;t implement the contract correctly then simply don&#39;t show the icon. But if you hide bugs they will never get fixed.</p>
<p>And if you want to properly guard against crashing extensions, you have to extract your icons in a helper process anyway. If the crash report dialogues get too painful, you can use SEH to terminate the process nicely on the second and subsequent crash. But always let the helper crash at least once, otherwise no one will know that something went wrong and hence no one can fix it. At least when you crash Microsoft can notify the developer or create a shim.</p>
<p>If the problem doesn&#39;t get fixed within a reasonable time frame and customers complain, I would probably unregister the crashing extension or even shim, but I&#39;m not going to change my Extract call if it follows the contract. The only way to detect bugs is to break when they occur; it may be more painful in the short term but if you don&#39;t follow this principle bugs can linger for decades, inconveniencing many more people.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977433">
				<div id="div-comment-977433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977433">
			April 9, 2012 at 2:08 pm</a>		</div>

		<p>@Christian: &nbsp;Obviously there is value in providing application compatibility, but it&#39;s all work that could have been avoided if people didn&#39;t write bad code in the first place. &nbsp;However, there is no incentive for people to write better code since application compatibility is maintained so vigorously. &nbsp;People (including myself) are stupid and lazy and will do whatever they can get away with. &nbsp;If you want them to write better code then you have to give them no other option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977453">
				<div id="div-comment-977453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tud</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977453">
			April 9, 2012 at 2:57 pm</a>		</div>

		<p>[The great thing about making a strict version of the operating system is that nobody will run it. -Raymond]</p>
<p>What is the main drawback to making EVERY copy of the OS run &quot;strict&quot;? If it&#39;s speed, you could enable it randomly in, say, 1 out of 100 times.</p>
<p>It would break backwards compatibility completely of course, so it would have to be enabled for &quot;new versions&quot; only (the introduction of Metro apps, for example, is a wonderful opportunity to break compatibilities).</p>
<div class="post">[<i>&quot;Randomly, about once every three months, Windows runs horribly slow and apps start behaving erratically. Windows is a piece of junk.&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-977483">
				<div id="div-comment-977483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977483">
			April 9, 2012 at 9:13 pm</a>		</div>

		<p>If there aren&#39;t business related consequence, sometimes I do wish Microsoft publish News Flash on new entries of Application Compatability Database, much in the same style as Hall of Shame.</p>
<p>People who litters around deserve to be punished in some way&#8230; In an afterthought, maybe it&#39;d be embrassing if some of Microsoft&#39;s product would be on the list a lot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977493">
				<div id="div-comment-977493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977493">
			April 10, 2012 at 12:38 am</a>		</div>

		<blockquote><p>
  If you don&#39;t want to accommodate compatibility in your code, then go ahead and pass NULL. See how many customers you get.
</p></blockquote>
<p>Raymond, as a developer, why do you care about how many customers you get?</p>
<p>That is the job of the sales team.</p>
<p>If the sales teams determines that such issues are hurting their sales figures, then discussion about addressing it may be worthwhile. That may include educating other people or it may end up just working around their mistakes.</p>
<p>But instead of ever letting such a discussion proceed, you seem fully willing to work around it, even when you are not in the wrong.</p>
<p>Why? Or you a developer or are you sales?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977503">
				<div id="div-comment-977503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977503">
			April 10, 2012 at 1:21 am</a>		</div>

		<p>James, in this case the point may be moot since the crashing extension is deprecated and the worst you&#39;ll get is a missing icon. Nothing you&#39;ll lose customers over.</p>
<p>However, I&#39;ve been in a situation myself where our software had to talk to Office (that was for the administrators). We were calling the object model correctly, but unpredictably the Office application would crash and sometimes even corrupt files. Since it was pretty much a given that even if Microsoft could be persuaded to do something, the fix would arrive much too late for us, we had to work around it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977513">
				<div id="div-comment-977513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977513">
			April 10, 2012 at 2:44 am</a>		</div>

		<p>@James: Microsoft is in the business of selling an operating system that can run my programs. If the next version of their OS doesn&#39;t run my programs, I won&#39;t use it, until such time as there&#39;s an indispensable program that requires me to upgrade the OS. Lower adoption rates would in turn compel fewer developers to write such software. If Microsoft adhered to the position that application developers should write things so they don&#39;t break with the next version of Windows, they would be dependent on those developers for when they could ship the next version. Try explaining that to sales and see if they agree that shipping isn&#39;t that important as long as you&#39;re &quot;in the right&quot;. I&#39;m sure MS already does its darndest to educate people and put pressure on them when they can, but that only goes so far. In the end, you want to ship, even if Contoso is not fixing their payroll app because they don&#39;t see the value in Windows 2042 (but their customers do, for other applications).</p>
<p>If you&#39;re not Microsoft, things look differently. You may not even have any third parties you&#39;re dependent on. Contoso Payroll may not be installed on any of your customer&#39;s machines, so you don&#39;t have to interoperate with it. Your customer may accept &quot;sorry, that won&#39;t work because Contoso wrote their software wrong, please contact them&quot;. You may be able to tell sales &quot;it&#39;s your job to sell whatever we&#39;re making, not our job to make sure you can sell it&quot;. The truth will probably be somewhere in the middle, since few people would want to be out of a job over a discussion on technical excellence. You seem to assume that discussions like this are never held within MS and development is martyring themselves to fix things when they don&#39;t have to &#8212; something tells me that&#39;s not right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-977563">
				<div id="div-comment-977563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977563">
			April 10, 2012 at 8:00 am</a>		</div>

		<p>I was about to say what JM just said, in response to Tud and others. &nbsp;Raymond has explained this at length before: &nbsp;</p>
<p>If a user upgrades to a new version of Windows, and some of their critical applications stop working (since the new OS now enforces a contract more strictly), the users are going to say &quot;The new version of Windows sucks! &nbsp;Don&#39;t buy it!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977623">
				<div id="div-comment-977623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977623">
			April 10, 2012 at 9:32 am</a>		</div>

		<p>@JM: &quot;sorry, that won&#39;t work because Contoso wrote their software wrong, please contact them&quot; is the essence of a line we often have to tell our customers, where Contoso is some form of antivirus software.</p>
<p>We don&#39;t like antivirus software all that much anymore due to the high support cost, which is in turn due to the terrible performance and odd issues because they do some of the most incredible undocumented hacks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977803">
				<div id="div-comment-977803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken White</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977803">
			April 11, 2012 at 10:00 am</a>		</div>

		<p>@James: &quot;Raymond, as a developer, why do you care about how many customers you get?&quot;</p>
<p>What do you think pays the developer&#39;s salary? Yep, that&#39;s right &#8211; sales of the software they&#39;re developing. Do you even work in the software industry (retail or corporate software)? Or are you just a developer that works on software used in-house at your company? I&#39;m suspecting the latter (actually, I&#39;m expecting you to be a developer in a small ISP that has no experience with selling to the general consumer market or corporations). Sales keep the company in business, and pay the salaries of not only the sales staff, but the programmers, admin staff, tech support staff, and even the janitorial services people.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-977863">
				<div id="div-comment-977863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rasmus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977863">
			April 11, 2012 at 6:05 pm</a>		</div>

		<p>Oh dear the mess&#8230;</p>
<p>So to summarize:</p>
<p>Compatibility shims exists because microsoft is afraid of bad PR no matter how stupid / misinformed the person spreading the bad PR is ?</p>
<p>Sales better than correctly informed developers.</p>
<p>Sales better than performance and the impact it have on nature (So much for microsoft saying they care about nature and make green software).</p>
<p>Make sales at any cost even lie, redirect blame, hide real cause of problem make it obscure.</p>
<p>Yes, i agree with Ben Voigt. Providing a checked build only is a good way to force lazy developers to fix their bugs that they hid away. But i would go further than that if they want the logo certificate they will have to pass with the checked build even after RTM.</p>
<p>What i hear is more hypocritical bullshit. Even from developers i assume is from outside microsoft that have obviously a lazy reason they don&#39;t want microsoft to change or just stupid and drinking the kola-id microsoft provides.</p>
<p>Remember windows vista and what it did with old windows xp programs ?</p>
<p>Where was all this sales-above-all-else-bullshit back then ?</p>
<p>[If you don&#39;t want to accommodate compatibility in your code, then go ahead and pass NULL. See how many customers you get. If you want to see the shame list, just look at the Application Compatibility Database. And as we saw some time ago, in most cases, the performance gain is minuscule. -Raymond]</p>
<p>I would implement error messages that reflect what program is to blame for the crashing. Putting blame and shame were shame it should be.</p>
<p>The big problem with the Application Compatibility Database is that its not very many that know about or what it really is for.</p>
<p>A shame list is meant to be public and very easily accessible to put pressure on the developers to fix the bugs instead of being lazy. Thats why its called a shame list !</p>
<p>Microsoft already have the processes in place to make this happen.</p>
<p>The Windows Logo Program Certification Process. If the developers want it then their software is required to pass all tests with the compatibility stuff completely turned off. Full hardcore strict mode.</p>
<p>Yes they will complain and wine like the spoiled snotty brats they are but after the complaining and whining they will comply anyway. (All parents know this)</p>
<p>For instance when windows crash it doesn&#39;t suggest what software was the cause because microsoft got no balls and dosen&#39;t want to get sued and get bad pr.</p>
<p>This can easily be solved by modifying the terms of use agreement when developers program for the operating system. No unjustified lawsuits due to own fault, check!</p>
<p>Telling the user about what software probably caused the crash or why it didn&#39;t run correctly is good very effective and motivating for developers to do their jobs and check their work.</p>
<p>@DWalker &quot;If a user upgrades to a new version of Windows, and some of their critical applications stop working (since the new OS now enforces a contract more strictly), the users are going to say &quot;The new version of Windows sucks! &nbsp;Don&#39;t buy it!&quot;</p>
<p>Thats just another poor excuse.</p>
<p>Solution: Inform the user of why their software stopped working. (Come on now, the general population of the <em>planet</em> isn&#39;t at the same level of stupidity as those in america. Users will understand that its not the new version of windows fault.</p>
<p>As with guns and car (licenses) if you are too stupid to use it properly than you shouldn&#39;t use it in the first place)</p>
<p>Tell the user that software is doing something wrong (ie incorrect use of api) and is not compatible with the new version of windows.</p>
<p>The manifest and certificate can tell what version of windows it have been tested with and supports</p>
<p>All i hear are poor excuses of why not to fix the root problem. Money (sales), bad stupid pr, assumptions that all users are morons therefore treat them all as such and dont tell them the truth because they do not understand words or honest explanations.</p>
<p>Did i miss anything ? Does that pretty much sum it up ?</p>
<p>It&#39;s evil spiral that will only get worse and worse. It started small and got big.</p>
<p>Windows 7 actually did compatibility a bit better. Instead of adding more compatibility crap into windows they added a virtual environment for software that doesn&#39;t work on windows 7.</p>
<p>Using VMs are nearly perfect. Yes some hardware stuff doesn&#39;t work like 3d gaming but that can be fixed by adding support for it.</p>
<p>Microsoft are treating all its users as complete morons. What they should do is inform and educate them.</p>
<p>( I know microsoft is an american company and as such got christian, religious, influences that is &quot;education is bad&quot; &quot;science is evil&quot; but you have to grow up eventually or get left behind. Microsoft likes to say they innovate, well put your actions were your mouth is ! )</p>
<p>oh dear this got long, were you see only problems i see solutions out the wazoo</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-977933">
				<div id="div-comment-977933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Rasmus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-977933">
			April 12, 2012 at 12:51 am</a>		</div>

		<p>Your assumption that the cause of bugs can automatically be determined is crazy bullshit. Example: Yesterday I discovered that the online help of my program does not open anymore but gives &quot;DDE conversion failed&quot;. After googling, it turns out that the Reader no longer understands it &quot;DDE application name&quot; which was used by all older versions but requires a new one. How can you auto-detect such kind of problem, to automatically inform the user about the root cause?</p>
<p>How would you determine which layer in the I/O system is guilty for wrong data or &quot;device is unaccessible&quot; because it depends on some very subtile &quot;backward compatible&quot; behavior (for example when accessing some external USB/ATA/Bluetooth device, having installed antivirus software + an harddisk imaging software + a DVD burning software + a driver for virtual CD drives + some anti-piracy driver installed by a game)?</p>
<p>That said, I will not use a separate &quot;checked&quot; version of Windows. I dont have the time to install and maintain it. I develop within VisualStudio or Delphi, run and test the software there, so the only good solution would be a switch in Windows to configure additional checking (for all or only for some processes).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-978073">
				<div id="div-comment-978073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tud</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-978073">
			April 12, 2012 at 10:27 am</a>		</div>

		<p>I wrote a long-ass response yesterday but apparently it got swallowed by the intertube monster. That&#39;s the second time it happens here. It even had fancy words from game theory like &quot;Nash equilibrium&quot;, &quot;tit for tat&quot;, &quot;precommitment&quot; and all!</p>
<p>But now you won&#39;t get to read it. Ever.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-978313">
				<div id="div-comment-978313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120409-00/?p=7903#comment-978313">
			April 13, 2012 at 6:08 pm</a>		</div>

		<p>Tud, a lot of people here are frustrated by the commenting system. When you post a comment here it gets swallowed. Always. The only way to prevent it is to copy the text of your post, refresh the page and paste it back in and post it as quickly as you can. It&#39;s been reported but no one does anything about it.</p>
<div class="post">[<i>In fact just yesterday, the site administrators applied another patch to try to fix the comment bugs. So it&#39;s definitely not the case that no one does anything about it. In fact, it&#39;s probably the #1 issue for the site administrators. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>