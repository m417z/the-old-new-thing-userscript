<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1039773">
				<div id="div-comment-1039773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039773">
			February 15, 2013 at 7:05 am</a>		</div>

		<p>More often than not it seems the fault lies with Contoso; those guys suck!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1039783">
				<div id="div-comment-1039783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Henke37</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039783">
			February 15, 2013 at 7:45 am</a>		</div>

		<p>So, was the original team related to Contoso?</p>
<div class="post">[<em>Nope. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039793">
				<div id="div-comment-1039793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039793">
			February 15, 2013 at 8:40 am</a>		</div>

		<p>Nice. Ah yes the downside in allowing garbage into your memory space is you get the support requests for somebody else&#39;s garbage. Unfortunately the classical model of processes is the only model understood by managers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1039813">
				<div id="div-comment-1039813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Douglas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039813">
			February 15, 2013 at 9:32 am</a>		</div>

		<p>&quot;Fortunately, this is debugging and not rocket surgery&quot;</p>
<p>Does one require less knowledge and skill than the other?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039823">
				<div id="div-comment-1039823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039823">
			February 15, 2013 at 9:37 am</a>		</div>

		<p>So if they just waited a bit they&#39;d see the exception report with clear traces of Contoso?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1039833">
				<div id="div-comment-1039833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039833">
			February 15, 2013 at 9:42 am</a>		</div>

		<p>@John: Just look at their wiki page. Contoso Bank, Contoso Pharmaceuticals, Contoso University, Contoso News Agency, Software Developement. It&#39;s like they&#39;re some evil corporation taking over the world, but this can&#39;t be because they&#39;re just a fictional entity thought up by Microsoft, right? Ha-ha. Ha-ha, ha&#8230; Gotta lock my door.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039843">
				<div id="div-comment-1039843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039843">
			February 15, 2013 at 9:59 am</a>		</div>

		<p>&quot;Fortunately, this is debugging and not rocket surgery&quot;</p>
<p>&quot;Does one require less knowledge and skill than the other?&quot;</p>
<p>not really about skill but if you mess up the rocket surgery the rocket could exploade costing millions of dollars and lives. If you messe up debugging you have to emm, try again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1039853">
				<div id="div-comment-1039853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039853">
			February 15, 2013 at 4:22 pm</a>		</div>

		<p>The big problem with rocket surgery is the malpractice insurance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039873">
				<div id="div-comment-1039873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039873">
			February 15, 2013 at 9:19 pm</a>		</div>

		<p>It seems to me like this hang should be temporary. Shouldn&#39;t WEP generate the report and then &quot;unhang&quot;, somehow releasing the request made by the Y component, while simultaneously producing a report of the cause of the crash?</p>
<p>Maybe the next question is &quot;Why did WEP hang?&quot;</p>
<div class="post">[<em>The only way to &quot;unhang&quot; the process is to terminate it, at which point it&#39;s too late to generate the crash report. WER can&#39;t generate the report until the user gives permission, because generating the report includes transmitting information to Microsoft to ask, &quot;Hey, I hit this failure, do you want me to capture any data beyond the default crash dump?&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1039883">
				<div id="div-comment-1039883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039883">
			February 15, 2013 at 10:12 pm</a>		</div>

		<p>@kog: &quot;if you mess up the rocket surgery the rocket could exploade costing millions of dollars and lives. If you messe up debugging you have to emm, try again.&quot;</p>
<p>Unless you&#39;re debugging a rocket.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039893">
				<div id="div-comment-1039893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039893">
			February 16, 2013 at 4:44 am</a>		</div>

		<p>Debugging a rocket: <a rel="nofollow" target="_new" href="http://ti.arc.nasa.gov/m/pub-archive/176h/0176%20(Havelund).pdf" rel="nofollow">ti.arc.nasa.gov/&#8230;/0176%20(Havelund).pdf</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1039933">
				<div id="div-comment-1039933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039933">
			February 17, 2013 at 7:53 pm</a>		</div>

		<p>[The only way to &quot;unhang&quot; the process is to terminate it, at which point it&#39;s too late to generate the crash report. WER can&#39;t generate the report until the user gives permission, because generating the report includes transmitting information to Microsoft to ask, &quot;Hey, I hit this failure, do you want me to capture any data beyond the default crash dump?&quot; -Raymond]</p>
<p>Close all open handles. Anybody waiting for it gets WAIT_ABANDONED_*. Since they&#39;re external to the calling process, WAIT_ABANDONED_* should already be handled. I can&#39;t believe I had to write that.</p>
<div class="post">[<em>Um, WAIT_ABANDONED is not a valid status code when waiting for a process handle. And you didn&#39;t clean up other externally-visible state, like window handles, or remove the process from the Process List (because some apps do FindProcessByName). And then you have the impossible situation of a process that still exists but is not present in the process list. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039943">
				<div id="div-comment-1039943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1039943">
			February 18, 2013 at 6:03 am</a>		</div>

		<p>@Joshua: Yanking a program&#39;s infrastructure out from under it is simply delaying when the program is going to crash and burn. See <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2005/09/12/463977.aspx" rel="nofollow">blogs.msdn.com/&#8230;/463977.aspx</a> for possible things that can happen when a program is presented with WAIT_ABANDONED; the answer to &quot;What can I do with invalid handles?&quot; is &quot;Not much.&quot;</p>
<p>Terminating a hung process is probably better all around because you don&#39;t leave programs in unstable states where they think that everything&#39;s OK but in reality nothing is!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1040033">
				<div id="div-comment-1040033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1040033">
			February 18, 2013 at 9:06 am</a>		</div>

		<p>Wow. Raymond got it ErikF didn&#39;t. My general idea is whatever handles that are being used for the LPC would be closed anyway when WER terminates the process so it could potentially close them now. I overlooked LPC by Windows messaging as opposed to kernel32 handles.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1040183">
				<div id="div-comment-1040183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1040183">
			February 18, 2013 at 8:41 pm</a>		</div>

		<p>Microsoft is just an umbrella corporation for Contoso.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1040193">
				<div id="div-comment-1040193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130215-00/?p=5233#comment-1040193">
			February 18, 2013 at 9:21 pm</a>		</div>

		<p>I had assumed that WER was going to silently create a small crash dump and then at some later point send it to MS, whereupon MS might say &quot;next time you hit this crash, capture additional information X&quot;.</p>
<p>Regardless, it sounds like you&#39;re saying WER put up UI to ask if the user wants to give permission. Did the user who reported the issue not notice the UI, or did they ignore it because they didn&#39;t realize it had to do with their issue?</p>
<div class="post">[<em>(It could have been done the way you suggested, but that means everybody has to hit the crash <span style="text-decoration:underline;">twice</span> before the information can be collected. And if the problem is sporadic, it may never get collected since it would require lightning to strike twice.) This happened in a lab, so there is nobody to look at the screen. The testing system reported &quot;test X is unresponsive&quot; and the developers connected to the machine and found this. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>