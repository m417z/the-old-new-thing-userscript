<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (22)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-968673">
				<div id="div-comment-968673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968673">
			February 28, 2012 at 7:08 am</a>		</div>

		<p>What do you gain by forcing the app to be signed? (Other than keeping evil companies like VeriSign in business)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968683">
				<div id="div-comment-968683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968683">
			February 28, 2012 at 7:09 am</a>		</div>

		<p>Can you just remove the damn icons, though? &nbsp;Maybe by specifying GUID_NULL or something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968693">
				<div id="div-comment-968693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968693">
			February 28, 2012 at 9:59 am</a>		</div>

		<p>@asf: In this particular case, you can inject a new root certificate and sign with that. Normally I would not advocate such behavior but Microsoft continues to be stupid in this regard.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968703">
				<div id="div-comment-968703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tyler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968703">
			February 28, 2012 at 10:23 am</a>		</div>

		<p>@asf Pretty much, you know other then insuring that the install is stable once it&#39;s finished and doesn&#39;t start blues screening in the middle of the process. But really, who cares about the user&#39;s PC being USABLE when they pull it out of the box?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968713">
				<div id="div-comment-968713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968713">
			February 28, 2012 at 11:06 am</a>		</div>

		<p>@Tyler: The only thing a digital certificate proves is that somebody somewhere paid VeriSign (or another root CA) a couple hundred bucks.</p>
<div class="post">[<i>Are you suggesting that the price isn&#39;t high enough to dissuade malware authors from applying for a certificate? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968723">
				<div id="div-comment-968723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tud</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968723">
			February 28, 2012 at 11:47 am</a>		</div>

		<p>@Tyler are you implying that signed software can&#39;t be shitty and crash, or even that it is less shitty on average? Signed only means they paid to have someone say &quot;Yes, this app was compiled by Asus&quot; (I have plenty of signed software showing weird messages in Engrish).</p>
<p>(@Raymond Why would a computer manufacturer include malware in the first place? Can&#39;t they inject a new certificate? Isn&#39;t malware as profitable as normal-ware?)</p>
<p>I was going to say here that maybe Microsoft could enforce a mandatory &quot;Windows Software Certification&quot; for included &quot;value-added software&quot; (it&#39;s mandatory for hardware after all).</p>
<p>And by the way, when I had the pleasure of having to reinstall Windows 7 in my Asus computer (using the built-in recovery partition), I could see what I assume must be the &quot;Unattended Windows Setup&quot;: a large white semitransparent window covering the whole desktop saying &quot;System setup in progress-please do not touch&quot; while setup assistants frantically appeared and disappeared in the background (as if it was all being done with emulated keypresses and mouse clicks). I wanted to record the whole process: it was like watching a Lego machine moving and sorting balls around (e.g. <a rel="nofollow" target="_new" href="http://youtu.be/N9VBQ3hW6t8" rel="nofollow">http://youtu.be/N9VBQ3hW6t8</a>) at high speed, all while hoping that none of the balls fall out of the tracks (not that I am implying that it could have failed â€” I know it was 100% robust software that could never go wrong due to a very small unpredicted circumstance). The whole process took at least 20 reboots and used to apparently halt for a minute or two every now and then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968733">
				<div id="div-comment-968733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968733">
			February 28, 2012 at 11:49 am</a>		</div>

		<p>Does anything about this post mention anything having to be signed? You need the GUID that the app uses to create the icon. Anyone can make a GUID for free. No one pays Verisign anything.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968743">
				<div id="div-comment-968743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968743">
			February 28, 2012 at 12:06 pm</a>		</div>

		<p>Nevermind, I see where it says it now&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968753">
				<div id="div-comment-968753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968753">
			February 28, 2012 at 12:59 pm</a>		</div>

		<p>[Are you suggesting that the price isn&#39;t high enough to dissuade malware authors from applying for a certificate? -Raymond]</p>
<p>I suppose it&#39;s enough to stop most of the people most of the time, but plenty of malware can be quite profitable.</p>
<p>Do you trust the root CAs to do their due diligence? I certainly don&#39;t.</p>
<div class="post">[<i>&quot;Enough to stop most of the people most of the time&quot; is better than &quot;not trying to stop anybody at all.&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968763">
				<div id="div-comment-968763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968763">
			February 28, 2012 at 2:01 pm</a>		</div>

		<p>I&#39;m hoping it just needs a valid signature from a certificate from a trusted issuer, like the rest of Windows, rather than stipulating one particular CA as with the bizarre Winqual hoop.</p>
<p>[Are you suggesting that the price isn&#39;t high enough to dissuade malware authors from applying for a certificate? -Raymond]</p>
<p>It&#39;s high enough to be an irritant to non-commercial developers, but I doubt it&#39;s a significant issue for malware authors. Having said that, the money isn&#39;t the big barrier, but the refusal to sell to individual developers &#8211; a policy Verisign seem to have reversed now, so fingers crossed for my own application!</p>
<div class="post">[<i>If you manage to score a contract with an OEM to have your software preinstalled on all their machines, I would hazard that you are no longer a non-commercial developer. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968773">
				<div id="div-comment-968773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968773">
			February 28, 2012 at 2:49 pm</a>		</div>

		<p>[&quot;Enough to stop most of the people most of the time&quot; is better than &quot;not trying to stop anybody at all.&quot; -Raymond]</p>
<p>Probably. &nbsp;The silver lining is that the people smart enough to jump through the hoops probably don&#39;t want to trash your computer; better to be part of a botnet than to lose all your data.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968783">
				<div id="div-comment-968783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968783">
			February 28, 2012 at 3:06 pm</a>		</div>

		<p>This leaves the obvious question as to whether this is possible after setup.</p>
<div class="post">[<i>After setup, the user controls the settings. All the unattend file does is set the initial conditions. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968803">
				<div id="div-comment-968803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968803">
			February 28, 2012 at 8:19 pm</a>		</div>

		<p>[If system builders were allowed to add, then they would cheerfully add 20 new icons to the notification area. -Raymond]</p>
<p>I have a rule that my bosses never seem to understand until it&#39;s too late: never run a factory load.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968793">
				<div id="div-comment-968793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968793">
			February 28, 2012 at 5:20 pm</a>		</div>

		<p>But I don&#39;t want to replace. I want to *add* and still make sure they don&#39;t get hidden as they do by default upon manual installation. Especially some icons which repeatedly get hidden even after setting them to always show icon and notification.</p>
<div class="post">[<i>If system builders were allowed to add, then they would cheerfully add 20 new icons to the notification area. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-968823">
				<div id="div-comment-968823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968823">
			February 29, 2012 at 4:40 am</a>		</div>

		<p>[If system builders were allowed to add, then they would cheerfully add 20 new icons to the notification area. -Raymond]</p>
<p>And why couldn&#39;t Microsoft limit how many icons can be added during automated deployment? They already lock the OS in numerous ways.</p>
<div class="post">[<i>As noted in the article, the limit is four. Network, Volume, plus two more. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968833">
				<div id="div-comment-968833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968833">
			February 29, 2012 at 6:32 am</a>		</div>

		<p>People, please. &nbsp;OEM installs are bad enough as it is. &nbsp;We need less crapware, not more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968843">
				<div id="div-comment-968843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968843">
			February 29, 2012 at 6:51 am</a>		</div>

		<p>I&#39;m kind of curious, what happens when you remove that shovelware? &nbsp;Does it just revert to the defaults?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968813">
				<div id="div-comment-968813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968813">
			February 29, 2012 at 2:42 am</a>		</div>

		<p>[Are you suggesting that the price isn&#39;t high enough to dissuade malware authors from applying for a certificate? -Raymond]</p>
<p>But your article says: &quot;The path you know how to get, because it&#39;s where the **application was installed**&quot;</p>
<p>Are you suggesting that requiring signing in this case will hinder malware authors, given that the potential malware has already had the chance to run arbitrary code during its install?</p>
<div class="post">[<i>Good point. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968993">
				<div id="div-comment-968993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-968993">
			February 29, 2012 at 11:56 am</a>		</div>

		<p>@Colin: My guess is that you would just have two less &quot;promoted&quot; icons in the notification area. After all, you can always customize the notifications if you don&#39;t like what&#39;s there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-969013">
				<div id="div-comment-969013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-969013">
			February 29, 2012 at 12:56 pm</a>		</div>

		<p>Nobody mentioned here about the liability. You can be sued or un-sued if you are agree to install something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-969133">
				<div id="div-comment-969133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-969133">
			March 1, 2012 at 9:03 am</a>		</div>

		<p>&quot;[If you manage to score a contract with an OEM to have your software preinstalled on all their machines, I would hazard that you are no longer a non-commercial developer. -Raymond]&quot;</p>
<p>True: you are also unlikely to be a malware developer, though, which is why I thought this aspect was broader than notification icons. (The signing requirement here isn&#39;t to ensure that if an OEM starts bundling malware that malware doesn&#39;t get a promoted notification area icon!). Also, OEMs are not the only users of unattended installations; corporate, academic and even individual users go this route too. Of course if you&#39;re customising the system installation, you could presumably add and use your own root CA anyway.</p>
<p>Signing in itself isn&#39;t an unreasonable requirement &#8211; I sign my own software, using a Startcom certificate at present (seeing a lawyer on Monday to get a Verisign one).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-asklar odd alt thread-odd thread-alt depth-1" id="comment-969863">
				<div id="div-comment-969863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alexander+Sklar' rel='external nofollow' class='url'>Alexander Sklar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120228-00/?p=8213#comment-969863">
			March 6, 2012 at 12:21 am</a>		</div>

		<p>Another reason we implemented the signing requirement is so that apps could not spoof other apps&#39; TN icons/promo state. This becomes especially interesting when a certain ISV decides to switch their app from wow64 to native x64, or just updates their version number (which they happen to use in their folder name under &quot;Program Files&quot;) and wants TN icon promotion state to &quot;continue working&quot; (i.e. if the user selected &quot;show in notification area&quot; for the wow64 app, keep the setting for the new version). In SP1 onwards, you can &quot;spoof&quot; your own TN icon if the new app is signed by the same Publisher.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>