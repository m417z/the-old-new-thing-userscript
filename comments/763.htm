<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (6)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1130483">
				<div id="div-comment-1130483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Henri Hein</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140611-00/?p=763#comment-1130483">
			June 11, 2014 at 11:49 am</a>		</div>

		<p>Since we are on the subject of the Recycle Bin, I had a strange issue where SHFileOperation aborted because of an error it encountered traversing the Recycle Bin on a removable drive (a USB flash memory drive). &nbsp;I know IFileOperation superseded SHFileOperation, but I need to support XP, and mostly asking because I&#39;m intellectually curious why SHFileOperation would have an issue with the Recycle Bin, since they are both owned by the Shell.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1130493">
				<div id="div-comment-1130493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Derlin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140611-00/?p=763#comment-1130493">
			June 11, 2014 at 2:05 pm</a>		</div>

		<p>Since Folder Redirection is frequently coupled with Offline Files (it may be required, though I&#39;m not sure), the local copy would already exist as part of the offline file synchronization. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-harry-johnston even thread-even depth-1" id="comment-1130503">
				<div id="div-comment-1130503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Harry+Johnston' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140611-00/?p=763#comment-1130503">
			June 11, 2014 at 3:03 pm</a>		</div>

		<p>@Maurits: it&#39;s on the network. &nbsp;Has to be, really, or the content of the Recycle Bin for your Documents folder would change depending on which computer you were using; it would also empty itself unexpectedly if the machine is configured to not keep local profiles, and so on. &nbsp;I don&#39;t see that the security issue is significantly different than the case of &quot;deleting&quot; a local file.</p>
<p>@Derlin: you can do folder redirection even if offline files are disabled. &nbsp;However, the offline files functionality does behave differently for redirected folders, which may result in it turning itself on unexpectedly. &nbsp;(I forget the exact details; I think it ignores the setting on the share, so to turn it off you have to disable it in group policy.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1130513">
				<div id="div-comment-1130513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140611-00/?p=763#comment-1130513">
			June 11, 2014 at 3:03 pm</a>		</div>

		<p>@Maurits It has to be on the network. &nbsp;When files are moved to the Recycle Bin they do not cross volume boundaries (so the operation is as fast as a delete). &nbsp;Every drive on your system has an invisible folder used to store recycled files from that drive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1130473">
				<div id="div-comment-1130473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140611-00/?p=763#comment-1130473">
			June 11, 2014 at 11:39 am</a>		</div>

		<p>&gt; a network Recycle Bin location is created to hold the files deleted from My Documents</p>
<p>Is this location on the network, or is it local?</p>
<p>If it&#39;s on the network, that means when you delete a file from the network, it&#39;s not *really* deleted, which could be a security issue if the user expected it to be deleted.</p>
<p>If it&#39;s local, then deleting a file from the network involves copying it locally, which creates interesting performance conundra.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com odd alt thread-odd thread-alt depth-1" id="comment-1130533">
				<div id="div-comment-1130533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140611-00/?p=763#comment-1130533">
			June 11, 2014 at 10:56 pm</a>		</div>

		<p>Vista beta 2 had a network Recycle Bin feature without using folder redirection but it was removed in RC1: <a rel="nofollow" target="_new" href="http://www.techrepublic.com/article/investigating-windows-vistas-recycle-bin-properties/">http://www.techrepublic.com/&#8230;/investigating-windows-vistas-recycle-bin-properties</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>