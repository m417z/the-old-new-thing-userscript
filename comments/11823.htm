<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (6)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-886293">
				<div id="div-comment-886293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110105-00/?p=11823#comment-886293">
			January 5, 2011 at 7:33 am</a>		</div>

		<p>So, why WAS it returning ERROR_BAD_NETPATH? &nbsp;Shouldn&#39;t it have still worked, even if it did access the network?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-886343">
				<div id="div-comment-886343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110105-00/?p=11823#comment-886343">
			January 5, 2011 at 8:51 am</a>		</div>

		<p>Perhaps the computer was a laptop and wasn&#39;t connected to the corporate network at the time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-886393">
				<div id="div-comment-886393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">configurator</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110105-00/?p=11823#comment-886393">
			January 5, 2011 at 2:47 pm</a>		</div>

		<p>So if you get a special folder to save your pictures in and it doesn&#39;t exist &#8211; where are you supposed to save the picture instead?</p>
<p>[Assume a picture-saving program that can&#39;t access UI conveniently; e.g. a game where you press printscreen but you can&#39;t pause the game to show a save as dialog].</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-886353">
				<div id="div-comment-886353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110105-00/?p=11823#comment-886353">
			January 5, 2011 at 8:53 am</a>		</div>

		<p>Dan: Reading between the lines, it looks like the user had redirected their profile folder to a network share that was offline. The function attempted to connect the share so that it could verify the folder existed (since they told it to do that), and timed-out.</p>
<p>If you told the function &quot;return the path *and* ensure the path exists&quot;, it has to actually check that the path exists before returning&#8211; otherwise the function would only be doing half of what you told it to do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-886403">
				<div id="div-comment-886403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110105-00/?p=11823#comment-886403">
			January 5, 2011 at 5:18 pm</a>		</div>

		<p>@configurator: Perheps creates a folder in My Documents that matches your application name&#8230; I&#39;ve seen lots of online games that support screen captures do this.</p>
<p>Btw, nothing stops your from allowing users to set the path in &quot;Options&quot; screen&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-887003">
				<div id="div-comment-887003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nikos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110105-00/?p=11823#comment-887003">
			January 8, 2011 at 4:32 am</a>		</div>

		<p>there is an issue with network paths in general. Windows explorer seems to be obtaining contents from network drives very quickly but if you try regular shell API (IShellFolder etc) in a program to enumerate remote items, then chances are it will take ages, at least the first time round (from then on it seems that there is some caching)</p>
<p>If there is any documentation about how to speedup network access in general, I wasn&#39;t able to find it. If you have any ideas please tell us where to find this kind of information</p>
<p>thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>