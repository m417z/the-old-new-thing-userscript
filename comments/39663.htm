<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (23)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-167103">
				<div id="div-comment-167103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-167103">
			April 23, 2004 at 9:51 am</a>		</div>

		<p>That&#8217;s pretty cool. Two questions:<br />
<br />1: How heavy is that parsing and traversal?<br />
<br />2: could you defer the calculation until needed and just cache the current mouse position?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-167113">
				<div id="div-comment-167113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-167113">
			April 23, 2004 at 10:09 am</a>		</div>

		<ol>
<li>It&#8217;s up to the implementation of IAccessible.<br />
<br />2. Certainly. This was just a Q&amp;D program.</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-167253">
				<div id="div-comment-167253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/ptorr/' rel='external nofollow' class='url'>Peter Torr</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-167253">
			April 23, 2004 at 8:12 pm</a>		</div>

		<p>(About to look clueless &#8212; hey, I&#8217;m a PM!)</p>
<p>Aren&#8217;t you freeing an invalid g_pszText the first time round?</p>
<p>And wouldn&#8217;t you want to VariantInit(&amp;vtChild) to begin with?</p>
<p>(OK, back to making coffee for the devs&#8230;)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-167263">
				<div id="div-comment-167263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-167263">
			April 24, 2004 at 12:16 am</a>		</div>

		<ol>
<li>LocalFree is documented to do nothing when passed NULL.
<p>2. The pvarChild parameter to AccessibleObjectFromPoint is an [out] parameter, so you don&#8217;t need to initialize the value on the way in.</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-167393">
				<div id="div-comment-167393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-167393">
			April 25, 2004 at 11:29 am</a>		</div>

		<p>But, g_pszText is never initialized to NULL though, therefore the first call to LocalFree is called on a random pointer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-167403">
				<div id="div-comment-167403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-167403">
			April 25, 2004 at 11:55 am</a>		</div>

		<p>Global pointer variables are initialized to NULL by default.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-168733">
				<div id="div-comment-168733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/saraford/archive/2004/04/27/121814.aspx' rel='external nofollow' class='url'>Sara Ford's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-168733">
			April 28, 2004 at 1:51 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-177473">
				<div id="div-comment-177473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TomTom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-177473">
			May 25, 2004 at 6:11 pm</a>		</div>

		<p>I did as the instruction says and I got the following error. </p>
<p>(&#8216;accessibility&#8217; is the name of the project.)</p>
<p>accessibility error LNK2019: unresolved external symbol _AccessibleObjectFromPoint@16 referenced in function &quot;void <strong>stdcall RecalcText(struct HWND</strong> *,unsigned int,unsigned int,unsigned long)&quot; (?RecalcText@@YGXPAUHWND__@@IIK@Z)</p>
<p>I use VC7.1. Did anyone have this error?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-177483">
				<div id="div-comment-177483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-177483">
			May 25, 2004 at 6:16 pm</a>		</div>

		<p>The documentation for AccessibleObjectFromPoint says</p>
<p>Library: Use Oleacc.lib.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-177513">
				<div id="div-comment-177513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TomTom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-177513">
			May 25, 2004 at 9:35 pm</a>		</div>

		<p>Thanks! I was able to compile and link.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-177533">
				<div id="div-comment-177533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TomTom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-177533">
			May 25, 2004 at 10:18 pm</a>		</div>

		<p>Hi, this is me again.</p>
<p>I followed the example by creating a Win32 project. Because Win32 applications do not look cool these days, I am wondering if this can be done from a managed code. If there is a tip to do it, can you please let me know? </p>
<p>Your help is very much appreciated. Thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-177543">
				<div id="div-comment-177543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-177543">
			May 25, 2004 at 10:55 pm</a>		</div>

		<p>&quot;not actually a .NET blog&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-178793">
				<div id="div-comment-178793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TomTom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-178793">
			May 30, 2004 at 7:55 am</a>		</div>

		<p>I managed to find a way to call the function from a C# program using pinvoke. It took me so long, but I am glad that it can be done.</p>
<p>So, here is my problem. :-). It looks like your code cannot display non-ASCII characters. Do you have a plan to make the code globalized using Unicode? If not, can you suggest me how I can do it?</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-178813">
				<div id="div-comment-178813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-178813">
			May 30, 2004 at 9:30 am</a>		</div>

		<p>Um, you need to remember to #define UNICODE and then select an appropriate font into the DC. I had hoped it wasn&#8217;t necessary to mention that. I left it out because that wasn&#8217;t the point of the article. My articles aren&#8217;t complete solutions; they are highlights of specific technology.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-181623">
				<div id="div-comment-181623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-181623">
			June 7, 2004 at 4:27 pm</a>		</div>

		<p>This program grabs the whole sentence under the cursor. Is there any way that it could just get the individual word under the cursor?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-181633">
				<div id="div-comment-181633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-181633">
			June 7, 2004 at 4:34 pm</a>		</div>

		<p>I don&#8217;t know. The point here was to get people to notice IAccessible. I leave you to explore it more on your own.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-181863">
				<div id="div-comment-181863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://s4008460@student.uq.edu.au' rel='external nofollow' class='url'>Mayu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-181863">
			June 9, 2004 at 12:30 am</a>		</div>

		<p>How about in visual basic 6.0?</p>
<p>I&#8217;m currently developing code to press a button on a particular program window.<br />
<br />If you have any advice on this, that would be great.</p>
<p>pls email: <a href="mailto:s4008460@student.uq.edu.au">s4008460@student.uq.edu.au</a></p>
<p>thnks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-181933">
				<div id="div-comment-181933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-181933">
			June 9, 2004 at 7:55 am</a>		</div>

		<p>I&#8217;m assuming my readers are smart enough to translate programs from one language to another. In fact, IAccessible itself is dispatch-based so it is even easier to use from a scripting language than from C++.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191873">
				<div id="div-comment-191873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-191873">
			July 7, 2004 at 4:37 pm</a>		</div>

		<p>Commenting on this entry has been closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-212973">
				<div id="div-comment-212973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/vsaccessibility/archive/2004/09/20/232143.aspx' rel='external nofollow' class='url'>Visual Studio Accessibility</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-212973">
			September 20, 2004 at 9:27 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-409633">
				<div id="div-comment-409633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/08/16/702526.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-409633">
			August 16, 2006 at 10:00 am</a>		</div>

		<p>You&#8217;ll probably use it too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-472773">
				<div id="div-comment-472773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/02/16/1689217.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-472773">
			February 16, 2007 at 10:00 am</a>		</div>

		<p>Because not everybody uses the same class library.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-698593">
				<div id="div-comment-698593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://nibuthomas.wordpress.com/2008/08/15/capturing-text-from-under-your-mouse-cursor/' rel='external nofollow' class='url'>Capturing text from under your mouse cursor! &laquo; bits and bytes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040423-00/?p=39663#comment-698593">
			January 7, 2009 at 3:11 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://nibuthomas.wordpress.com/2008/08/15/capturing-text-from-under-your-mouse-cursor/" rel="nofollow">http://nibuthomas.wordpress.com/2008/08/15/capturing-text-from-under-your-mouse-cursor/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>