<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (86)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-217233">
				<div id="div-comment-217233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217233">
			October 14, 2004 at 7:17 am</a>		</div>

		<p>Me mum (that&#8217;s australian grammar) sold her old computer to her school friend. I went to install it. Every time we dialed the ISP we got a message but my mum would dimiss the dialog box before anyone could read it. Her friend was a WP instructor and we were both screaming at her to let us read the dialog (as we dialed up repeatedly to see the message). But even knowing we wanted to read it she couldn&#8217;t help herself and kept closing the dialog. We had to take the mouse off her. Then dial up then without a mouse she couldn&#8217;t close it and we could read<br />
<br />&quot;Telstra has problems &#8211; try again in an hour&quot;, which we did and it worked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217263">
				<div id="div-comment-217263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217263">
			October 14, 2004 at 7:45 am</a>		</div>

		<p>Something I thought of after reading the old post you linked to&#8230; I always wondered why the &quot;configure security&quot; screen you get after installing SP2 and rebooting was so huge and took up the whole screen, instead of just being a wizard that came up after logging in. Now I realize it&#8217;s meant to indicate to users that THIS IS REALLY BLOODY IMPORTANT, READ IT!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217283">
				<div id="div-comment-217283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Summerlin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217283">
			October 14, 2004 at 9:00 am</a>		</div>

		<p>A user dismissing a dialogue box without reading it.</p>
<p>Imagine that.</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217293">
				<div id="div-comment-217293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217293">
			October 14, 2004 at 9:27 am</a>		</div>

		<p>I see an award here for the most politically correct statement of the year:</p>
<p>&quot;This message may have been dismissed accidentally or by another individual using your computer&quot;</p>
<p>Because we all know that I would never dismiss a dialog box intentionally without reading it&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217303">
				<div id="div-comment-217303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217303">
			October 14, 2004 at 9:33 am</a>		</div>

		<p>The real moral of the story?</p>
<p>Microsoft should do <em>everything</em> they can to recover from situations where a person powers off their machine during an install.  Frankly, if this happens, the service pack should be uninstalling itself, not relying on the end user to do it.</p>
<p>It&#8217;s like the old DriveSpace conversion program.  If you killed that while it was working, then after the next boot, it would continue on from where you left off.  This was the first and probably last really bulletproof install of Microsoft&#8217;s.</p>
<p>If this thing, on the next boot, uninstalled itself and THEN put up a box saying &quot;hey, the service pack was not installed due to an error, please install again&quot; then you wouldn&#8217;t have these problems.  You would have two cases, SP1 or SP2.  No frankenstein.</p>
<p>And if your test department is stupid enough to think that the users will follow every instruction given to them, then you need a new testing coordinator.</p>
<p>The customer is always right.  Period.  Partial installs have been the bane of you guys forever, and it&#8217;s a solvable problem.  Users ignore dialog boxes all of the time, and that&#8217;s a well known fact.  It&#8217;s engineering&#8217;s fault for not finding a solution around it and test&#8217;s fault for not testing an actual user experience.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217313">
				<div id="div-comment-217313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217313">
			October 14, 2004 at 9:42 am</a>		</div>

		<p>You can&#8217;t force the uninstall at boot; you have to wait for a user to log on. And the Setup program can&#8217;t just force a logon since it doesn&#8217;t know your password!</p>
<p>The Service Pack Setup team knew that this was a possible problem but didn&#8217;t have time to develop the infrastructure to implement this &quot;ultimate unattended failsafe&quot; given the time constraints for Service Pack 2. Would you rather that SP2 have been yet another half-year late? (The testers did verify that the &quot;Oh dear things are a mess right now; please do the following steps to fix it&quot; dialog appears when it ought to.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217343">
				<div id="div-comment-217343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GeraldH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217343">
			October 14, 2004 at 10:40 am</a>		</div>

		<p>The text states: &quot;If, however, it has a number that is less than 040804 after the xpsp2, such as &quot;Build 2600.xpsp2.030422-1633 : Service Pack 2&quot; then you definitely have a machine in the partially installed state.&quot;</p>
<p>However, previously the string for the system with an intact SP2 is given as &quot;Build 2600.xpsp_sp2_rtm.040803-2158&quot;. So is 040803 (which is less than 040804 according to my math book) okay or not? Is this just a typo or is my brain hemorrhaging?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217353">
				<div id="div-comment-217353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217353">
			October 14, 2004 at 10:51 am</a>		</div>

		<p>Gerald, you are correct. The document even says that 040803 is a valid SP2 version number. This was just a typo in the original message; I&#8217;ve edited the article to correct this &#8211; hopefully avoid freaking people out thinking they have a corrupted SP2 install.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217393">
				<div id="div-comment-217393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.whirlingdervishes.com' rel='external nofollow' class='url'>Henk Devos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217393">
			October 14, 2004 at 11:10 am</a>		</div>

		<p>Re: First, that users ignore all error messages. Even error messages that tell how to fix the error!</p>
<p>I really can&#8217;t understand that you know there is a problem, you know it needs to be fixed, you know it&#8217;s important to fix it, you know how to fix it, and yet, instead of fixing it, you tell the user how to fix it and offer the &quot;cancel&quot; option.<br />
<br />The excuses you are giving are really non-excuses. How hard could it be to add an entry to &quot;run&quot; as first step of the setup, do the same sanitty check there that&#8217;s already being done, and fire the uninstaller? I&#8217;m sure you can program this yourself in 1 day, hardly the half year that you are talking about.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217413">
				<div id="div-comment-217413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.reactos.org' rel='external nofollow' class='url'>Steven Edwards</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217413">
			October 14, 2004 at 11:32 am</a>		</div>

		<p>&quot;You can&#8217;t force the uninstall at boot; you have to wait for a user to log on. And the Setup program can&#8217;t just force a logon since it doesn&#8217;t know your password!&quot;</p>
<p>I dont understand why this could not be done. The Serivce Pack roll back could be done via a service with administrative access. I mean Windows expects the users to be r00t all the time anyway so why not have the service pack install a new service that checks the state of the install and rolls it back if there was a problem. I mean all the service would have to do is run a VerQuery value on the dlls and if they did not all match the manifest for SP2 then roll it back to SP1.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217423">
				<div id="div-comment-217423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John [MSFT]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217423">
			October 14, 2004 at 11:51 am</a>		</div>

		<p>You guys are right &#8211; we could have done better with the SPRecover process &#8211; given appropriate time.  During SP2 beta testing, we started seeing enough installs that failed due to system crashes, power outages and other unexplained reasons that we decided to do something about it, and invented the new SPRecover process, but had very limited time to get it done and tested.</p>
<p>In general, we think we&#8217;ve prevented/solved many cases where the machine would have been left completely unbootable.  I had a friend who&#8217;s college daughters machine was crashing randomly &#8211; turned out to be too much dust inside the machine.  SP2 install crashed numerous times on her machine and SPRecover saved the day!  This was a case that was not due to software installed or the SP install.</p>
<p>We did originally spec a full end-to-end automated uninstall but there are some major limitations. The SPRecover process is running in a special pre-boot mode, and all it can do is to copy back the saved recovery files – most of the OS services (APIs, etc.) are not yet loaded.  You can’t do anything with the registry at this point, which precludes creating a Run or Runonce entry, or creating and registering a “system service”, among other things. You also don’t even know who are the machine user accounts – you could grovel the Documents directory but what if the machine has dozens or hundreds of users?  So you can’t go dropping random files in the Start Up program files directory.  Plus, whatever you do then has to be “undone” by the full SP Uninstall.  Once the user logs in and runs the full SP2 Uninstall, it copies back the backed up registry, recopies all the saved recovery files, and un-does other things that may have been done by the SP2 installer and/or related processes. An SP Uninstall is a very complex process in it’s own right. </p>
<p>Most users do follow the instructions.  As Raymond mentions above, for the very, very few cases that hit SPRecover, and the even fewer cases that ignore the message, it may not have been worth a significant delay for SP2.  Now that we are aware of this case, we can probably do some things with Windows Update in the future to detect and not offer updates to machines in this state, and to warn the users who are still in this state.  And for future Service Packs, we&#8217;ll make SPRecover better.</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217433">
				<div id="div-comment-217433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zach</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217433">
			October 14, 2004 at 12:01 pm</a>		</div>

		<p>Hah, here&#8217;s an interesting one:</p>
<p>I have every SP2 file installed.</p>
<p>I have no symptoms of a &#8216;hybrid&#8217; service pack, nor any errors.  I do not have the message in svpack.log</p>
<p>My version number is what you say.</p>
<p>HOWEVER, it still says Service Pack 1, and still wants me to install Service Pack 2.  Even though it clearly successfully installed.  The installer itself never said that, though, because it couldn&#8217;t unregister spuninst.exe</p>
<p>bravo. &gt;_&lt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217463">
				<div id="div-comment-217463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217463">
			October 14, 2004 at 1:20 pm</a>		</div>

		<p>Re the old DriveSpace &#8211; actually the current FAT-&gt;NTFS conversion is safe as well. My XP was running of FAT32 (for historical reasons). The power in my area like to go out for a second every now and then, so I decided to convert my system part. to NTFS. Of course, halfways through the convert, the power went out&#8230; When it came back, the process continued, and finished without error.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217483">
				<div id="div-comment-217483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217483">
			October 14, 2004 at 1:55 pm</a>		</div>

		<p>Is there a forum or newsgroup (or even email address) for SP2 problems? I have one machine that the SP2 install performs flawlessly on, but on reboot Explorer fails to load, and it just sits there forever with a blank screen. The event log shows some sort of COM error (can&#8217;t remember exactly what). Uninstall works fine and then the machine is back to normal (but only with SP1 of course). Tried googling but haven&#8217;t found anything yet&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217243">
				<div id="div-comment-217243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217243">
			October 14, 2004 at 7:39 am</a>		</div>

		<p>VC 7 shows some of the worst message boxes I&#8217;ve ever seen, usually in regards to source control problems. I run in 1280&#215;1024 and I&#8217;ve gotten messages that are literally 6 lines of text, each line spanning 1000 pixels or so, with a bunch of buttons at the bottom. Ugh.<br />
<br />What&#8217;s worse is that they are worded so badly, that when I *do* read the text, I still have no idea how to fix the problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217513">
				<div id="div-comment-217513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://support.microsoft.com/windowsxpsp2' rel='external nofollow' class='url'>John [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217513">
			October 14, 2004 at 3:10 pm</a>		</div>

		<p><a target="_new" href="http://support.microsoft.com/windowsxpsp2" rel="nofollow">http://support.microsoft.com/windowsxpsp2</a><br />
<br />top right corner &#8211; get help &#8211; will direct you to the correct support resources depending on where you live.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217533">
				<div id="div-comment-217533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217533">
			October 14, 2004 at 4:05 pm</a>		</div>

		<p>I don&#8217;t know if this is the error I&#8217;m seeing or not.  I installed this update and the one for Office XP last night.  While rebooting after the install I get a BSOD and the friggin OS is trying to be so helpful that it doesn&#8217;t even allow me to see what the error was, it just reboots.  BSOD into safe mode, BSOD using last known good configuration.  You&#8217;d think that I&#8217;d be able to run system restore or roll back the patch somehow, but the recovery console was no help.  To add insult to injury the last Ghost backup image is corrupt!  Any ideas?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217543">
				<div id="div-comment-217543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217543">
			October 14, 2004 at 4:23 pm</a>		</div>

		<p>The Recovery Console isn&#8217;t actually running Windows. It&#8217;s running a minimal pseudo-operating system that knows how to copy files and not much else. That&#8217;s why you can&#8217;t use SR or anything like that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217523">
				<div id="div-comment-217523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/ie/archive/2004/10/14/242502.aspx' rel='external nofollow' class='url'>IEBlog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217523">
			October 14, 2004 at 6:11 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217573">
				<div id="div-comment-217573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217573">
			October 14, 2004 at 6:21 pm</a>		</div>

		<p>10/14/2004 4:05 PM Dan</p>
<p>&gt; While rebooting after the install I get a<br />
<br />&gt; BSOD and the friggin OS is trying to be so<br />
<br />&gt; helpful that it doesn&#8217;t even allow me to see<br />
<br />&gt; what the error was, it just reboots.</p>
<p>Too late for you this time, but in the future you can go into the properties dialog of &quot;my computer&quot; and clear a checkbox so it won&#8217;t automatically restart after a BSOD.</p>
<p>&gt; BSOD using last known good configuration.</p>
<p>I have the intuitive impression that &quot;last known good&quot; only uses an old registry that was included in the last successful login, i.e. it doesn&#8217;t restore other system files that were executing in the last successful login.</p>
<p>There used to be a purpose to having two installations of the same OS side-by-side in separate disk partitions.  Sometimes you could figure out which files to repair manually.  But now each installation&#8217;s system restore stuff writes restore points in all partitions instead of just in its own boot partition, and it&#8217;s loads of fun to look at them and try to guess which restore points were written by which installation.  Plus with activation, each installation has too many hardware changes from the other installation even though it&#8217;s the exact same hardware on the same machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217593">
				<div id="div-comment-217593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217593">
			October 14, 2004 at 7:25 pm</a>		</div>

		<p>Norman, thanks for giving me inspiration.  The f8 menu does have a &quot;Disable reboot on error&quot; option.  (You should have seen me with my digital camera before that :)  That was enough for me to see it was a PAGE_FAULT_IN_NONPAGED_AREA error and the system was pointing the finger at PQV2i.SYS (part of Ghost 9 &amp; Drive Image).  Simply disabled that service from the recovery console (I guess it is good for something) and I&#8217;m up and running again.  Now we just have to figure out why&#8230; oh why.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217603">
				<div id="div-comment-217603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/efleis/archive/0001/01/01/242633.aspx' rel='external nofollow' class='url'>Eric Fleischman's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217603">
			October 15, 2004 at 1:32 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217893">
				<div id="div-comment-217893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.evilrob.org/journal' rel='external nofollow' class='url'>Rob Meyer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217893">
			October 15, 2004 at 3:48 pm</a>		</div>

		<p>How about instead of just a single error message at boot, it creates a taskbar notification that warns you ever 5 minutes that your system is in an inconsistent state and offers to kick off the recovery procedure for you.</p>
<p>While I can see that recovering automatically is problematic, a single, cancelable error message at boot does not seem like nearly enough warning that your system is totally hosed&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217903">
				<div id="div-comment-217903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217903">
			October 15, 2004 at 3:52 pm</a>		</div>

		<p>&quot;&#8230;it creates a taskbar notification &#8230;&quot;</p>
<p>This means running a program, and John noted, at the time the problem is detected, the registry is not available, so you can&#8217;t write a program into the &quot;Run&quot; key or drop a shortcut into the Startup folder (you need to read the registry to figure out where the Startup folder is).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217913">
				<div id="div-comment-217913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.evilrob.org/journal' rel='external nofollow' class='url'>Rob Meyer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217913">
			October 15, 2004 at 5:13 pm</a>		</div>

		<p>Ah, I didn&#8217;t notice that part of his posting. You&#8217;re really painted into a corner at that point then.</p>
<p>Heh; does windows still read (has read at this point in the boot) win.ini/system.ini? How about dropping the notification program in there? :-)</p>
<p>Or, what if the very first thing the SP2 installer did was set a recovery notifier as a run program. Then it started installing. If it completely installed, it removes the program. If it fails and reboots during, then next time the system boots and a user logs in, they get the warning message.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217923">
				<div id="div-comment-217923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217923">
			October 15, 2004 at 7:38 pm</a>		</div>

		<p>Chkdsk has no problems with this scenario. It creates a text file and after boot the text file is moved to event viewer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217963">
				<div id="div-comment-217963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lorena.umeyama.org' rel='external nofollow' class='url'>Lorena</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217963">
			October 15, 2004 at 8:30 pm</a>		</div>

		<p>I&#8217;m trying to fix a friend&#8217;s computer and this is just what happened to her computer.</p>
<p>I think this post will be really useful but there&#8217;s one thing&#8230; I find many SP2 Hotfixes but I don&#8217;t find &quot;Windows XP Hotfix – KB834707&quot; what can I do in this case? Please help me, or my friend will die without her computer! :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217973">
				<div id="div-comment-217973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John [MSFT]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217973">
			October 15, 2004 at 8:47 pm</a>		</div>

		<p>Lorena: If SP2 is present in the add/remove programs, go ahead and &quot;uninstall&quot; it, then reinstall SP2.</p>
<p>Best way so far to determine if a computer is in the partial install state:<br />
<br />Add/remove programs contains the Windows XP SP2 listing, but key files (e.g. lsass) are lower than build 2600.2180 indicating SP2 is not installed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-217983">
				<div id="div-comment-217983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Charvy Alacar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217983">
			October 15, 2004 at 9:08 pm</a>		</div>

		<p>After uninstalling &quot;Windows XP Hotfix &#8211; KB834707&quot; the computer keeps restarting.  It shows the initial black screen and restarts it 3 seconds later.  Any advice would be much appreciated.  Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-217993">
				<div id="div-comment-217993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard Zorge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-217993">
			October 15, 2004 at 10:05 pm</a>		</div>

		<p>I have this weird problem.<br />
<br />I have installed one of the earlier betas of SP2.  And my computer works rather fine.  However, when the final SP2 arrived and I decided to install it, I figured that my Add/Remove program list does not contain reference to Service Pack 2.  I cannot install final SP2 without removing the beta.  But I cannot remove beta, because it is not listed.  What can I do?  Any advice is greatly appreciated.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218003">
				<div id="div-comment-218003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paradisefairy04@hotmail.com' rel='external nofollow' class='url'>dijana sirovica</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218003">
			October 15, 2004 at 11:52 pm</a>		</div>

		<p>i did the necessary items asked, and when i rebooted after re installing sp2 i got the same error message, only this time when i went back to do step one in the debugging process which is removing  hp hotfix kb834707 a error message popped up saying &quot; the system cannot find the file specified&quot; then &quot; kb834707 was not uninstalled&quot; i dont know what to do know since it wont unistall it for me to do that whole process all over again! help!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218033">
				<div id="div-comment-218033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vincent Chen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218033">
			October 16, 2004 at 7:03 am</a>		</div>

		<p>I&#8217;ve got the same problems as Sirovica described above.  Will installing the SP2 on a CD help?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218043">
				<div id="div-comment-218043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Toby Acton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218043">
			October 16, 2004 at 8:18 am</a>		</div>

		<p>Yes I have the same problem as Sirovica and Vincent Chen above</p>
<p>Any ideas PLEASE??!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218053">
				<div id="div-comment-218053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jay Kim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218053">
			October 16, 2004 at 10:54 am</a>		</div>

		<p>i followed step 11 and i can&#8217;t find SP2 entry in the list.<br />
<br />i checked windows version and it read &#8211; version5.1{build 2600.xpsp1. 020828-1920 : Service Pack 2} &#8211; first sp1, second sp2????.<br />
<br />How can i remove sp2 manually?<br />
<br />Is there anything else solve this problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218063">
				<div id="div-comment-218063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218063">
			October 16, 2004 at 11:38 am</a>		</div>

		<p>I don&#8217;t know what is going on; I was just repeating the analysis of the Service Pack team. The version number is very strange; it sounds like you still have a mix of Service Pack 1 and Service Pack 2. Perhaps there were other updates that you installed during the mixed-up state that installed SP2 some files?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218073">
				<div id="div-comment-218073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lorena.umeyama.org' rel='external nofollow' class='url'>Lorena</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218073">
			October 16, 2004 at 12:00 pm</a>		</div>

		<p>Thank you guys, specially John for your help! It worked perfectly and now I&#8217;m uninstalling the rest of the SP2.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218083">
				<div id="div-comment-218083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">damon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218083">
			October 16, 2004 at 4:55 pm</a>		</div>

		<p>Thanks guys.  A friend of mine called me and asked for help with her pc.  I can&#8217;t believe Microsoft doesn&#8217;t have this fix posted on their website.</p>
<p>Thanks again for your fix, it was greatly appreciated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218093">
				<div id="div-comment-218093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paradisefairy04@hotmail.com' rel='external nofollow' class='url'>dijana sirovica</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218093">
			October 16, 2004 at 5:03 pm</a>		</div>

		<p>ok people lets get a move on i still am gettin NO HELP :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218113">
				<div id="div-comment-218113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeremy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218113">
			October 16, 2004 at 5:57 pm</a>		</div>

		<p>Thank you.  You do amazing work.  Glad I am subscribed to the feed.  Now, if I could just get my girlfriend to read error messages before dismissing them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218123">
				<div id="div-comment-218123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://tobyacton@btinternet.com' rel='external nofollow' class='url'>Toby Acton</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218123">
			October 16, 2004 at 6:01 pm</a>		</div>

		<p>I Have been trying to get into the Recovery Console but I do not know the Administrator Password &#8211; what can I do?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218143">
				<div id="div-comment-218143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JAy Kim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218143">
			October 16, 2004 at 7:08 pm</a>		</div>

		<p>if you didnt set it up</p>
<p>just hit enter<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218163">
				<div id="div-comment-218163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vincent Chen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218163">
			October 16, 2004 at 9:59 pm</a>		</div>

		<p>Ok. I&#8217;ve also followed Sirovica&#8217;s steps and it didn&#8217;t work. And it created one more new problem&#8230; corrupted the winlogon.exe.  Even when I use back the old winlogon.exe, it didn&#8217;t work :(</p>
<p>am going to do the painful thing of reinstalling winXP :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218173">
				<div id="div-comment-218173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vincent Chen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218173">
			October 16, 2004 at 10:49 pm</a>		</div>

		<p>Ok. I&#8217;ve finally found something on MS website on how to deal with this problem.</p>
<p><a target="_new" href="http://support.microsoft.com/default.aspx?kbid=875350" rel="nofollow">http://support.microsoft.com/default.aspx?kbid=875350</a></p>
<p>But it&#8217;s too late or me. I&#8217;ve started reinstalling XP :(</p>
<p>Good luck for those are still trying to recover your system.  Sigh&#8230; Now I&#8217;ll disable auto update feature&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218183">
				<div id="div-comment-218183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paradisefairy04@hotmail.com' rel='external nofollow' class='url'>dijana sirovica</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218183">
			October 16, 2004 at 11:29 pm</a>		</div>

		<p>dont disable it&#8230;just read the damn popups before you close em, make it a habit&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218103">
				<div id="div-comment-218103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paradisefairy04@hotmail.com' rel='external nofollow' class='url'>dijana sirovica</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218103">
			October 16, 2004 at 5:20 pm</a>		</div>

		<p>1. Use the Windows XP Setup start-up disks or the Windows XP CD-ROM to start your computer.<br />
<br />2. At the &quot;Welcome to Setup&quot; screen, press R, and then press C to start the Recovery Console.<br />
<br />3. Type the number for the appropriate Windows XP installation, and then type the Administrator account password.<br />
<br />4. Type the following commands, and then press ENTER after each command:</p>
<p>cd<br />
<br />cd windowssystem32<br />
<br />ren winlogon.exe winlogon.old<br />
<br />ren msgina.dll msgina.old<br />
<br />ren shell32.dll shell32.old<br />
<br />ren shlwapi.dll shlwapi.old<br />
<br />cd..<br />
<br />cd servicepackfilesi386<br />
<br />copy MSGINA.DLL c:windowssystem32<br />
<br />copy SHELL32.DLL c:windowssystem32<br />
<br />copy WINLOGON.EXE c:windowssystem32<br />
<br />copy SHLWAPI.DLL c:windowssystem32 </p>
<p>Note If the DLL files are not in the Servicepackfiles folder, you must expand these files from the Windows XP installation CD-ROM and copy them to the System32 folder. To expand these files from the Windows XP installation CD, follow these steps: a.  Put the Windows XP installation CD in your CD-ROM or DVD drive.<br />
<br />b.  Type the following commands, and then press ENTER after each command:</p>
<p>expand CD_Drive_Letter:i386MSGINA.DL_ C:windowssystem32<br />
<br />expand CD_Drive_Letter:i386SHELL.DL_ C:windowssystem32<br />
<br />expand CD_Drive_Letter:i386WINLOGON.EX_ C:windowssystem32<br />
<br />expand CD_Drive_Letter:i386SHLWAPI.DL_ C:windowssystem32<br />
<br />cd<br />
<br />cd windowssystem32<br />
<br />ren *.dl_ *.dll<br />
<br />ren *.ex_ *.exe </p>
<p>5. Type exit, and then press ENTER.  </p>
<p>ok i even did this and it wont help, this is what the microsoft help team sent me. I still get the error message, and it still wont let me delete HPHOTFIX KB834707.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218223">
				<div id="div-comment-218223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paradisefairy04@hotmail.com' rel='external nofollow' class='url'>dijana sirovica</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218223">
			October 17, 2004 at 12:30 am</a>		</div>

		<p>MORE INFORMATION<br />
<br />Note You cannot remove Windows XP SP2 if you installed the service pack on a computer that already had Windows XP SP2 installed. The removal program will roll back to the version of Windows that existed before your installation. In this case, the program will roll back to the first installation of Windows XP SP2.</p>
<p>Use any one of the following methods to remove Microsoft Windows XP SP2 from your computer: • Use the Add or Remove Programs tool in Control Panel<br />
<br />• Use the hidden $NtServicePackUninstall$ folder<br />
<br />• Use the System Restore process<br />
<br />• Use Recovery Console<br />
<br />Important We recommend that you use the following methods in the order that they are listed.<br />
<br />Use the Add or Remove Programs tool in Control Panel<br />
<br />1. Click Start, click Run, type appwiz.cpl in the Open box, and then click OK.<br />
<br />2. Click to select the Show Updates check box.<br />
<br />3. Click Windows XP Service Pack 2, and then click Remove.</p>
<p>4. Follow the instructions on the screen to remove Windows XP SP2. </p>
<p>Use the hidden $NtServicePackUninstall$ folder<br />
<br />1. Click Start, click Run, type c:windows$NtServicePackUninstall$spuninstspuninst.exe in the Open box, and then click OK.<br />
<br />2. When the Windows XP Service Pack 2 Removal Wizard starts, click Next.<br />
<br />3. Follow the instructions on the screen to remove Windows XP SP2. </p>
<p>Use the System Restore process<br />
<br />1. Click Start, click Run, type %SystemRoot%System32restorerstrui.exe in the Open box, and then click OK.<br />
<br />2. Click Restore my computer to an earlier time, and then click Next.<br />
<br />3. Click the date that you installed Windows XP SP2, and then click Installed Window XP Service Pack 2 in the Restore Point box.<br />
<br />4. Click Next, and then follow the instructions on the screen to remove Windows XP SP2. </p>
<p>Use Recovery Console<br />
<br />Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.</p>
<p>If you cannot successfully remove Windows XP SP2 by using one of the previous methods, follow these steps: 1. Insert the Windows XP startup disk in your floppy disk drive or insert the Windows XP CD in the CD drive or in the DVD drive, and then restart your computer. </p>
<p>Note When you receive the following message, press a key to start your computer from the Windows XP CD:<br />
<br />Press any key to boot from CD</p>
<p>Note Your computer must be configured to start from the CD drive or the DVD drive. For more information about how to configure your computer to start from the CD drive or the DVD drive, see the documentation that came with your computer or contact the computer manufacturer.</p>
<p>2. When you receive the Welcome to Setup message, press R to start the Recovery Console.</p>
<p>NoteMultiple options will appear on the screen.<br />
<br />3. Select the Windows XP installation in question. </p>
<p>Note You must select a number before you press ENTER, or the computer will restart. Typically, only the 1: C:Windows selection is available.<br />
<br />4. If you are prompted to type an administrator password, do so. If you do not know the administrator password, press ENTER. (Typically, the password is blank.)</p>
<p>Note You will not be able to continue if you do not have the administrator password.</p>
<p>5. At the command prompt, type cd $ntservicepackuninstall$spuninst, and then press ENTER.</p>
<p>Note After you complete this step, you cannot stop the removal process.</p>
<p>6. At the command prompt, type batch spuninst.txt, and then press ENTER.</p>
<p>Note The Spuninstal.txt file appears. As the file scrolls down, you will see errors and files being copied. This is normal behavior.<br />
<br />7. After Windows XP SP2 is removed, type exit, and then press ENTER.<br />
<br />8. Restart your computer in Safe Mode. To do this, press F8 as the computer restarts.<br />
<br />Note After you restart, the system may lock up with a black screen. (Your mouse will work.) In this case, restart again by turning the computer off and then back on. The second restart will let you to log on.<br />
<br />9. When your computer restarts, Windows Explorer (Explorer.exe) does not run, and the Windows icons and the Start button are unavailable. To resolve this problem, follow these steps: a.  Press CTRL+ALT+DEL to start Task Manager.<br />
<br />b.  Click File, and then click New Task (Run&#8230;).</p>
<p>c.  In the Open box, type regedit, and then click OK.<br />
<br />d.  Locate and then click the following registry subkey:<br />
<br />HKEY_LOCAL_MACHINESystemCurrentControlSetServicesRpcSs<br />
<br />e.  On the right side of the viewing pane, right-click ObjectName, click Modify, type LocalSystem in the Value data box, and then click OK.</p>
<p>f.  Restart your computer </p>
<p>10. Use one of the previous methods to remove Windows XP SP2 from your computer. </p>
<p>THIS WORKED FOR ME</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218253">
				<div id="div-comment-218253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://UninstallingKB834707' rel='external nofollow' class='url'>Lynda</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218253">
			October 17, 2004 at 7:23 am</a>		</div>

		<p>Oh dear &#8211; got the problem above and followed the directions &#8211; but the &quot;Running process after uninstall&quot; has taken more than 3 hours. Can I just click finish? How long does the process last for the rest of you?</p>
<p>&quot;Click on it and click the &quot;Remove&quot; button. It will take some time to complete. Once the &quot;Finish&quot; button is visible, click on it and reboot your system. If you get messages about additional software or hotfixes installed, you can safely ignore them.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218263">
				<div id="div-comment-218263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218263">
			October 17, 2004 at 8:15 am</a>		</div>

		<p>A very similar thing happened to me. Read my account at <a target="_new" href="http://hashtown.blogspot.com/2004/10/service-pack-2-or-sucky-programming-2.html" rel="nofollow">http://hashtown.blogspot.com/2004/10/service-pack-2-or-sucky-programming-2.html</a></p>
<p>The strange thing is that Windows XP SP2 on a fresh install of XP fails for me 50% of the time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218273">
				<div id="div-comment-218273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218273">
			October 17, 2004 at 9:04 am</a>		</div>

		<p>The winlogon replacement suggestion is a total red herring. The SHCreateThreadRef problem has nothing to do with winlogon. And rolling back shlwapi will only make the problem worse, not better.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218293">
				<div id="div-comment-218293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max Beran</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218293">
			October 17, 2004 at 9:58 am</a>		</div>

		<p>I was getting partial installations as described above (and committed the dreadful sin, also referred to in many mailings here, of ignoring it). By trial and error I learned that the problem was that I had left the virus checker and the Firewall enabled. I suspect that one of these had intervened at a point when I wasn&#8217;t watching and the computer got fed up waiting so put itself to sleep. Moral &#8211; disable firewall and virus checker. Does Microsoft say so explicitly in any of its istructions? I didn&#8217;t notice it anywhere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218323">
				<div id="div-comment-218323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brent</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218323">
			October 17, 2004 at 12:11 pm</a>		</div>

		<p>I am in the midst of this situation too and have tried the suggestions and have run into problems.</p>
<p>First I do not have:  Windows XP Hotfix &#8211; KB834707.  I noticed Lorna above had that problem so she just uninstalled the whole Windows XP Service Pack 2.  I can&#8217;t accomplish that however.  I tried on the add remove and during the 4th step of the wizard I get the following error messages:</p>
<p>&quot;System can not find the file specified&quot; and then I get &quot;Service Pack 2 was not uninstalled&quot;.</p>
<p>I also tried removing using the $NtServicePackUninstall$ and ran into the exact same problem.</p>
<p>As further information here are all the SP2 files on my computer in the Add/Remove program section:</p>
<p>Windows XP service pack 2<br />
<br />Q817606<br />
<br />Q817287<br />
<br />Q815021<br />
<br />Q814995<br />
<br />Q814033<br />
<br />Q811493<br />
<br />Q810833<br />
<br />Q810577<br />
<br />Q810565<br />
<br />Q331953<br />
<br />Q329441<br />
<br />Q327979<br />
<br />Q322011<br />
<br />Q329115<br />
<br />KB810243<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218333">
				<div id="div-comment-218333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeanne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218333">
			October 17, 2004 at 12:26 pm</a>		</div>

		<p>My daugther has this problem, but when she tries to type in the appwiz.cpl, task mgr locks up and won&#8217;t accept input from the keypad or mouse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218353">
				<div id="div-comment-218353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rachel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218353">
			October 17, 2004 at 2:32 pm</a>		</div>

		<p>I have the same problem as Dijana, and I&#8217;m trying to follow the directions that includes using the recovery console.</p>
<p>I&#8217;m having problems making my computer start from the CD drive. How do I do that?</p>
<p>By the way, Dijana, which method did you use to solve your problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218373">
				<div id="div-comment-218373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John [MSFT]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218373">
			October 17, 2004 at 4:14 pm</a>		</div>

		<p>I don&#8217;t think Raymond&#8217;s blog is the best way for ongoing troubleshooting&#8230;so this will be the last post here. </p>
<p>Let&#8217;s move troubleshooting questions &amp; solutions to the Microsoft Windows XP General Newsgroups</p>
<p>If you need direct help with XP SP2, start here: <a target="_new" href="http://support.microsoft.com/windowsxpsp2" rel="nofollow">http://support.microsoft.com/windowsxpsp2</a>.  If you don&#8217;t find direct help in the links, in the top right corner is a link to contact product support &#8211; the professionals that can directly help. If you are having serious problems, they can almost always help.</p>
<p>One last tip: If you can&#8217;t run AppWiz, try typing one of these into the Task Manager File/Run box:</p>
<p>To remove the IE update:</p>
<p>   %windir%$NtUninstallKB834707$spuninstspuninst.exe </p>
<p>to remove SP2:</p>
<p>   %windir%$NtServicePackUninstall$spuninstspuninst.exe<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218403">
				<div id="div-comment-218403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edwin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218403">
			October 17, 2004 at 7:17 pm</a>		</div>

		<p>I have follow all the procedure, uninstalling and reintalling the service pack 2, and my computer is OK now.<br />
<br />Very smart tips (and also who write that tip)<br />
<br />Thanks<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218413">
				<div id="div-comment-218413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.browsersite.com/webfora.html' rel='external nofollow' class='url'>Lynda Shen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218413">
			October 17, 2004 at 8:33 pm</a>		</div>

		<p>This blog is a &quot;life-saver&quot; for me. </p>
<p>Well, the problem all began because while installing the SP2, my system crashed. But since it was able to restart &#8211; I decided to put off uninstallation of SP2 because I needed the computer badly. Hardly did I know that that was the worst decision I&#8217;ve ever made. Somehow, KB834707 came and updated itself on my computer and asked for a reboot. I had always installed many software and many Microsoft security patches without any incidents &#8211; so that gave me a false sense of security. I did not fully backup my drive. I only backed up the most important thing.</p>
<p>After reboot, I saw the message &quot;The procedure entry point SHCreateThreadRef could not be located &#8230;.&quot; and thought &#8230; can&#8217;t be that bad. Surely this thing CAN revive itself. I was so wrong &#8211; until I found this weblog. </p>
<p>I tried the steps and was able to partially get rid of KB834707 when the system crashed again. So I rebooted the computer and this time the computer looks fine &#8211; and I quickly uninstalled the SP2. It uninstalled without incident &#8230; but the whole process already took me 8 hours (because I mistaken the crash for the uninstallation)!! </p>
<p>The next morning I turned on my computer. WOW! What a fright I got! It started searching for drivers and installing them and everything on my monitor looked really primitive. I had to reconfigure the monitor and adjust the settings of my Network connections. To cut the long story short, it was both a mentally and emotionally exhausting experience. </p>
<p>Finally I was able to log on the internet and post again. But I&#8217;m not sure how my other programs are doing. It was a very terrible experience &#8230; and the SP2 update is still pestering for an installation. I shall wait until I get a thorough and full backup before toying around with this thing again. </p>
<p>My computer is now up and running fine though a bit slow even after defrag. It&#8217;s still a little unstable.</p>
<p>SP2 is definitely a big PATCH and will land you on a bad patch if you&#8217;re unlucky enough. I&#8217;m glad that the posting on this weblog is useful in helping resolve the problem. Thank you. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218423">
				<div id="div-comment-218423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hippycat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218423">
			October 17, 2004 at 9:02 pm</a>		</div>

		<p>Hi!  I Just wanted to add my little story to this here blog.  Tonight as I hurrily tried to calm down my friend on the phone (who was begging for help with this same problem &#8211; background with no desktop icons or task bar) I googled SHCreateThreadRef error.  I found an awful lot of web comments (forums, etc) regarding this issue have appeared in just the last few days.  I take this to mean that this is a very recent problem that nailed way too many people, including my friend. Unfortunately among the other sites there is little in the way of actually fixing this problem.  Most answers were of the &quot;try system restore&quot; or &quot;insert XP cd and repair&quot; variety, which really isn&#8217;t an option with this particular problem (it didn&#8217;t work for my friend anyway). </p>
<p>Then I got here.  I read verbatim your fix over the phone, and&#8230; he got it fixed on the first try!!!  100% OK now!!!  I can&#8217;t thank you enough for posting this!  For helping to get my friend&#8217;s pc back up and running, he claims that all the drinks are on him tomorrow!  I can&#8217;t help but feel that he owes you a couple too!  Again thanks!  AND CHEERS!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218453">
				<div id="div-comment-218453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Mack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218453">
			October 18, 2004 at 4:58 am</a>		</div>

		<p>Just received a call from a customer with this problem, put in the error into google, got this webpage, ran through the instructions, fixed it first time! Thanks a lot!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218463">
				<div id="div-comment-218463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Liz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218463">
			October 18, 2004 at 6:24 am</a>		</div>

		<p>I am having the same problem as Jeanne above&#8211; I get to task manager and cannot type, backspace, delete, use the mouse, etc. It will not accept any info, and just goes to blank and freezes. Help?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218493">
				<div id="div-comment-218493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J&#252;rgen Priem (Belgium)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218493">
			October 18, 2004 at 7:38 am</a>		</div>

		<p>We got two pc&#8217;s at the same time from two customers. So that was a bit weird. After a lot of searching I finally found this site. I followed the steps and they both work now.<br />
<br />Thanks a lot!!!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218593">
				<div id="div-comment-218593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218593">
			October 18, 2004 at 9:21 am</a>		</div>

		<p>I am do Step 1 to 7, sucessfully. I can logon again!<br />
<br />Now work on the remaining step.<br />
<br />Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218723">
				<div id="div-comment-218723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218723">
			October 18, 2004 at 1:22 pm</a>		</div>

		<p>I have attempted to follow the instructions listed at the beginning of this thread.  Unfortunately, everytime I try to remove KB834707 it looks as though it is successful and reboots my machine, but when I try to log back in I still get the same error.  One difference I may have versus the rest of you is that I am running the tablet pc version of XP.  If anyone knows whether the tablet pc version is complicating things or has a solution, please let me know. (btw: they don&#8217;t ship installation cd&#8217;s of tablet pc XP&#8230; I just have the autorecover cd&#8217;s that format my drive)</p>
<p>Thanks for any help!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218743">
				<div id="div-comment-218743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218743">
			October 18, 2004 at 3:00 pm</a>		</div>

		<p>Thanks a lot to whomever posted the solution of this problem. After carefully followed the suggested instructions, I had my Laptop back to the condition before I installed the SP2.</p>
<p>It had been an unproductive and frustrated moment being unable to do anything with My Laptop. Again, Thanks!</p>
<p>BJ</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218753">
				<div id="div-comment-218753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frank Brebels</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218753">
			October 18, 2004 at 3:12 pm</a>		</div>

		<p>Thanks, it worked perfectly, i&#8217;m up and running again.</p>
<p>Frank</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218763">
				<div id="div-comment-218763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218763">
			October 18, 2004 at 8:44 pm</a>		</div>

		<p>Thank you sooo much.  It worked!</p>
<p>One thing to add is after you remove xp2 the system has to restart two or three times to reimstall all the system drivers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218773">
				<div id="div-comment-218773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mehri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218773">
			October 18, 2004 at 9:36 pm</a>		</div>

		<p>when i go through the task manager and procceed the steps when i type control appwiz.ap1 i get the above message .what shall i do?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218783">
				<div id="div-comment-218783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mehri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218783">
			October 18, 2004 at 9:47 pm</a>		</div>

		<p>when i go to the procedure after step 4 ti get this message: Control exe.Entry not found . THe procedure entry point SHRegGetValueW could not be located in th dynamic link libary SHWAPI.dll what shall i do.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218803">
				<div id="div-comment-218803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BobR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218803">
			October 18, 2004 at 10:34 pm</a>		</div>

		<p>Outstanding!  This was a real issue &#8211; but with your instructions I fixed the problem.  Again, Outstanding and Thanks!!  Please keep posting this kind of material &#8211; it is so helpful when you need it&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218873">
				<div id="div-comment-218873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">p1g9y</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218873">
			October 19, 2004 at 1:27 am</a>		</div>

		<p>i followed the directions up to number 7 and i stopped receiving the error message but i cant seem to find the entry windows xp service pack 2&#8230;. has my problem really been fixed?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218923">
				<div id="div-comment-218923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218923">
			October 19, 2004 at 6:18 am</a>		</div>

		<p>When I attempt to remove KB834707 a message appears which states: The system cannot find the file specified. Therefore, I cannot uninstall KB834707. Any advise on what I can do next?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-218933">
				<div id="div-comment-218933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">eddie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218933">
			October 19, 2004 at 6:26 am</a>		</div>

		<p>Thanks!!  This solved my problem.  Wasted the entire day yesterday trying to figure this out.  I&#8217;ll be a hero today!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218973">
				<div id="div-comment-218973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcelo Negrisoli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-218973">
			October 19, 2004 at 9:20 am</a>		</div>

		<p>Great !!!!!!!!!! thanx !</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219233">
				<div id="div-comment-219233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-219233">
			October 19, 2004 at 4:53 pm</a>		</div>

		<p>This site came up in google before <a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a> did &#8211; running through the official instructions now. Thanks all for getting the information out there :-)<br />
<br />&lt;fingers crossed&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219463">
				<div id="div-comment-219463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/10/14/242241.aspx' rel='external nofollow' class='url'>TC</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-219463">
			October 20, 2004 at 8:01 am</a>		</div>

		<p>This was a TREMENDOUS time saver &#8211; Thanks for getting this out there.  I ran through this before MS posted it&#8217;s KB and it worked great! I just got a little nervous with the list of programs that may not run after SP2 uninstall contained every program on the PC twice over &amp; and when many devices weren&#8217;t recongnized after on the reboot after SP2 removal &#8212; but in the end everything was back to normal.</p>
<p>I find it very impressive to see MS basically quote this procedure verbatim in their KB &#8211; good work!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219473">
				<div id="div-comment-219473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-219473">
			October 20, 2004 at 8:05 am</a>		</div>

		<p>It&#8217;s not surprising at all.  The same people wrote these instructions and the KB article.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219693">
				<div id="div-comment-219693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-219693">
			October 20, 2004 at 5:55 pm</a>		</div>

		<p>Has anyone written a similar set of instructions for uninstalling Windows Server 2003 SP1 beta build 1218?  I couldn&#8217;t find any.  But I also couldn&#8217;t find reports of anyone else unable to install the Windows 2003 version of .NET Framework 1.1 SP1 critical update.  I wonder if the null pointer dereference, which crashes the installer of the .NET Framework 1.1 SP1, might be a result of Windows Server 2003 SP1 beta build 1218 having failed to uninstall itself properly even though it looked like it was installed.</p>
<p>Furthermore, I don&#8217;t know what IDW is, but it&#8217;s writing logs of failures to access hostnames on a local LAN which don&#8217;t exist on my local LAN, and it seems to think that build 1218 is still installed.</p>
<p>By the way, the reason I uninstalled build 1218 was because it added bugs (blacking out the entire screen) while not fixing any of the bugs that had been bothering me (e.g. Windows Explorer bugs that were also added in Windows XP but mostly fixed by Windows XP SP2).  Furthermore the instructions for build 1218 say that it will have to be uninstalled before installing the real SP1, if the real SP1 ever gets released.</p>
<p>Of course all of this isn&#8217;t really your fault, I&#8217;m just wondering if there&#8217;s a fix for this possibly failed SP uninstallation, very similar to the one that you&#8217;re posting about.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219743">
				<div id="div-comment-219743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ajay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-219743">
			October 20, 2004 at 10:23 pm</a>		</div>

		<p>its superb</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220173">
				<div id="div-comment-220173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-220173">
			October 21, 2004 at 7:21 pm</a>		</div>

		<p>Thanks man. This weblog really helped. I was working for hours on this problem. Keep up the helping. Props to you man.</p>
<p>-Paul Kim</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220223">
				<div id="div-comment-220223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brandon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-220223">
			October 21, 2004 at 10:02 pm</a>		</div>

		<p>Flawless fix, thankyou much.  Why is it all crossed out?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220493">
				<div id="div-comment-220493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rachel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-220493">
			October 23, 2004 at 9:03 am</a>		</div>

		<p>Previously posted by Kevin:<br />
<br />&quot;When I attempt to remove KB834707 a message appears which states: The system cannot find the file specified. Therefore, I cannot uninstall KB834707. Any advise on what I can do next?&quot;</p>
<p>I have the same problem as you. I do not know what to do either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220783">
				<div id="div-comment-220783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.telephoneswitching.com' rel='external nofollow' class='url'>Dale Edawrds</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-220783">
			October 25, 2004 at 11:54 am</a>		</div>

		<p>Greetings,</p>
<p>I&#8217;m a bit of a newbie at all this and hope I&#8217;m not voilating any etiquette or breaking any rules by placing my question here but I&#8217;m kind of at my wits end and really don&#8217;t know where else to go. I gusess you could say that I&#8217;m basically begging at this point.</p>
<p>We have Virtual PC for Mac (6.1). I&#8217;m hoping someone might know of a Web URL or phone number where can I get help. We need to reinstall VPC on an eMac but have lost track of the CD sleeve that had it&#8217;s Serial number on it.</p>
<p>I&#8217;ve tried calling a couple of different numbers posted on Microsoft&#8217;s web site but in one case was given what turned out to be a &quot;product key&quot; not a &quot;Serial Number&quot; and in the other case was told, besides costing $35.00, I must also provide the Serial Number (the very thing I&#8217;m needing) up front before they would talk to me.</p>
<p>I&#8217;m sure there is some way for me to hook up with the correct department I just don&#8217;t know how. If anyone can provide me with a starting point for finding some help then I&#8217;d be eternally grateful.</p>
<p>Yours truely,<br />
<br />Dale<br />
<br /><a href="mailto:webmaster@telephoneswitching.com">webmaster@telephoneswitching.com</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-221053">
				<div id="div-comment-221053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alekos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-221053">
			October 26, 2004 at 12:53 pm</a>		</div>

		<p>That is awesome!!!<br />
<br />I worked on it for 3 hr and nothing<br />
<br />and your solution fixed in 5 minutes<br />
<br />THANKS!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-221073">
				<div id="div-comment-221073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Linux/Mac user</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-221073">
			October 26, 2004 at 1:44 pm</a>		</div>

		<p>Windows is a piece of trash&#8230;I cant wait til Microsoft loses its foothold</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-221893">
				<div id="div-comment-221893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shiulude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-221893">
			October 29, 2004 at 11:41 pm</a>		</div>

		<p>Client uninstalled SP2 when confronted with &quot;OE has denied&#8230;..&quot;  Talk about not reading the help&#8230;.</p>
<p>Anyway, getting the same shcreate, and have re-expanded the 4 files, but no change.</p>
<p>I can run the task man.  But there is no SP2 or 34707 on this PC.   Hmmmmm</p>
<p>There are however, 823980, and 835732, and neither one will get out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-221913">
				<div id="div-comment-221913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ann</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-221913">
			October 30, 2004 at 8:29 am</a>		</div>

		<p>If the Windows XP Hotfix – KB834707, fails to uninstall (still shows up in your apps list) and/or the uninstall of Service Pack 2 fails, it&#8217;s because you probably attempted to install SP2 more than once (maybe it failed once and then you tried again).  Microsoft notes, &quot;You cannot remove Windows XP SP2 if you installed the service pack on a computer that already had Windows XP SP2 installed. The removal program will roll back to the version of Windows that existed before your installation. In this case, the program will roll back to the first installation of Windows XP SP2.&quot;</p>
<p>MS has the fix for this documented:  <a target="_new" href="<a target="_new" href="http://support.microsoft.com/default.aspx?kbid=875350" rel="nofollow">http://support.microsoft.com/default.aspx?kbid=875350</a>&#8220;><a target="_new" href="http://support.microsoft.com/default.aspx?kbid=875350" rel="nofollow">http://support.microsoft.com/default.aspx?kbid=875350</a>.  Only the last option to uninstall using Recovery Console from CD worked for me.</p>
<p>Important notes:<br />
<br />-the batch file took about 15 minutes to run<br />
<br />-don&#8217;t forget to eject the CD after the batch file finishes so you can reboot to safe mode<br />
<br />-you still have to complete the steps of uninstalling kb834707 and xp2 using the steps outlined in <a target="_new" href="<a target="_new" href="<a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="<a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a></p>
<p>It didn&#8217;t totally work for me.  Here&#8217;s what DID work:</p>
<p>-Use the Recovery Console to uninstall using your XP CD (<a target="_new" href="<a target="_new" href="http://support.microsoft.com/default.aspx?kbid=875350" rel="nofollow">http://support.microsoft.com/default.aspx?kbid=875350</a>&#8220;><a target="_new" href="http://support.microsoft.com/default.aspx?kbid=875350" rel="nofollow">http://support.microsoft.com/default.aspx?kbid=875350</a>)<br />
<br />-After completing ALL the steps, reboot normally and remove the Windows XP Hotfix – KB834707 (<a target="_new" href="<a target="_new" href="<a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="<a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>)<br />
<br />-After removing JUST the Hotfix, reboot into Safe Mode<br />
<br />-Use System Restore to rollback to the Restore Point right before the SP2 installation (the SP2 installation creates this Restore Point automatically)<br />
<br />-When the System Restore reboots your machine (done automatically), let it reboot normally<br />
<br />-Open the Application Uninstall program and remove SP2 (<a target="_new" href="<a target="_new" href="<a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="<a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>&#8220;><a target="_new" href="http://support.microsoft.com/kb/888162" rel="nofollow">http://support.microsoft.com/kb/888162</a>)<br />
<br />This whole process took me almost 1 1/2 hours to complete (the System restore and SP2 removal wizard takes about 30 minutes each)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-306783">
				<div id="div-comment-306783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mikepope.com/blog/DisplayBlog.aspx?permalink=1295' rel='external nofollow' class='url'>mike's web log</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041014-00/?p=37573#comment-306783">
			September 16, 2005 at 9:21 pm</a>		</div>

		<p>Scott Hanselman muses about what he terms &amp;quot;Conversational Error Messages (CEMs)&amp;quot; in Microsoft Max. I have been on the authoring end of many an error message, so I speak fluent error-message-ese. That said, my first contract job at Microsoft was on the  &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>