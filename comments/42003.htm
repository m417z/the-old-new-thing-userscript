<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-129463">
				<div id="div-comment-129463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129463">
			October 29, 2003 at 10:59 am</a>		</div>

		<p>Excellent. I don&#8217;t suppose you&#8217;d want to give a hint on iTunes style caption bars? I kinda like the centered title, and the custom control box (close, min etc) :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129473">
				<div id="div-comment-129473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129473">
			October 29, 2003 at 11:47 am</a>		</div>

		<p>Is it moral to want to draw nonstandard captions?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129483">
				<div id="div-comment-129483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129483">
			October 29, 2003 at 11:50 am</a>		</div>

		<p>I don&#8217;t know where morality comes into it but I think I understand the question.</p>
<p>Why has no-one complained about Winamp having different skins and by default having a different caption bar? Answer: No-one cares.</p>
<p>Do MS still even have a HIG?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129493">
				<div id="div-comment-129493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129493">
			October 29, 2003 at 12:47 pm</a>		</div>

		<p>Another reason: if you want to create combobox-like control, which displays popup window. To avoid your mainframe caption getting inactive appearance, you handle WM_NCACTIVATE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129503">
				<div id="div-comment-129503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jacob (.NET MVP)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129503">
			October 29, 2003 at 12:51 pm</a>		</div>

		<p>With WindowsForms in .NET, I have had situations in which I needed a UI that resembles MDI, but is different enough such that the built-in MDI doesn&#8217;t do the trick.  As an alternative, each form can be treated as a control and be hosted in a container (e.g. a panel).  The downside, though, is that the caption bars are always drawn inactive.  Of course, these embedded forms never receive WM_NCACTIVATE, so I have to create the message and send it to the DefWndProc of the window.  The moral of the story is, &quot;here is another scenario in which the built in management of inactive versus active caption bars is inadequate.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129513">
				<div id="div-comment-129513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.gotdotnet.com/raymondc/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129513">
			October 29, 2003 at 1:09 pm</a>		</div>

		<p>Actually in the combobox-like popup control, handling WM_NCACTIVATE is the wrong thing.  I&#8217;ll write an entry on doing menulike popup windows the right way someday.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129523">
				<div id="div-comment-129523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129523">
			October 29, 2003 at 1:42 pm</a>		</div>

		<p>&quot;Why has no-one complained about Winamp having different skins and by default having a different caption bar? Answer: No-one cares.&quot;</p>
<p>Think the real answer is that people use winamp in a very different way when compared to the other applications they use. Winamp is commonly kept on top of an active window playing in the background and as such should seek to conserve space. This makes it different UI acceptable. Changing the caption bar (or any gui element) without a very good reason is almost always a mistake, and expecially so if your app is used in a standard way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129533">
				<div id="div-comment-129533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dimmick.demon.co.uk/' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129533">
			October 29, 2003 at 2:04 pm</a>		</div>

		<p>Draw your own caption bar by handling WM_NCPAINT. You can handle WM_NCHITTEST if you place your custom buttons in a different location to the standard one.</p>
<p>MS Office 95 had custom caption bars &#8211; the &#8216;Microsoft&#8217; in the caption used the proper logo and it had a gradient fill. I suspect that it didn&#8217;t play well with large fonts and the user&#8217;s chosen colour scheme.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129543">
				<div id="div-comment-129543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.virtualdub.org/' rel='external nofollow' class='url'>phaeron</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129543">
			October 30, 2003 at 1:01 am</a>		</div>

		<p>WinAmp is an example of custom UI done right.  In fact, I wish more media players would follow WinAmp&#8217;s example, because most are horrible, particularly in terms of screen real estate waste.  Windows Media Player, QuickTime, RealPlayer, WinDVD, you name it &#8212; all have custom UI that is of dubious or even negative usefulness, usually wasting space for no reason with large, rounded bevels and cute but hard-to-use controls.  I still use Windows Media Player 6.4 because its UI consists of: a box, a slider, and a nice, big video pane.</p>
<p>Custom UI in itself isn&#8217;t bad, it&#8217;s just that the vast majority of it is done in a way that is less intuitive, less usable, less accessible, and less efficient than the stock Win32 UI controls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129553">
				<div id="div-comment-129553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ross</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129553">
			October 30, 2003 at 3:12 am</a>		</div>

		<p>Maybe a stupid question, but what does the NC stand for in WM_NCHITTEST and WM_NCPAINT ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129563">
				<div id="div-comment-129563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129563">
			October 30, 2003 at 4:10 am</a>		</div>

		<p>NC stands for Non-Client. It means the title bar (caption) area of the window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129573">
				<div id="div-comment-129573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KiwiBlue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129573">
			October 30, 2003 at 4:55 am</a>		</div>

		<p>Well, non-client is not only the caption. If you look at the docs form WM_NCHITTEST, you&#8217;ll see that NC includes menu, window border and scrollbars added by WS_xSCROLL style.</p>
<p>Basically, the client area is the one you paint yourself in WM_PAINT. Other things within window rect are considered non-client.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129583">
				<div id="div-comment-129583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129583">
			October 30, 2003 at 11:22 am</a>		</div>

		<p>2 phaeron</p>
<p>I totally agree with you. Nowadays skins are the most heavily abused thing in Windows. That&#8217;s why I keep Classic skin for WMP9 inmy backups. Unfortunately it&#8217;s not included in WMP9 installation anymore.</p>
<p>Die stupid skins, die!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129593">
				<div id="div-comment-129593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129593">
			October 30, 2003 at 6:46 pm</a>		</div>

		<p>Giant rounded corners almost never help with usability. Pointless eye-candy with no added GUI benifit is quite annoying. The old Windows look is really quite good. Combining the old classic style with mouse-over activiation graphics would really bring it up to date however with regards to tabs, buttons, scrollbars etc&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129603">
				<div id="div-comment-129603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shane King</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129603">
			October 30, 2003 at 7:40 pm</a>		</div>

		<p>&quot;Why has no-one complained about Winamp having different skins and by default having a different caption bar?&quot;</p>
<p>I&#8217;m a no-one now apparently. :(</p>
<p>I hate all skinned apps. Including WinAmp. If someone made a player exactly like WinAmp, but without the skins, I&#8217;d switch to it immediately.</p>
<p>As Jamie Zawinski says at <a href="http://www.jwz.org/doc/linuxvideo.html" rel="nofollow">http://www.jwz.org/doc/linuxvideo.html</a></p>
<p>&quot;Makali wrote:</p>
<pre><code>  Whenever a programmer thinks, &amp;quot;Hey, skins, what a cool idea&amp;quot;, their computer's speakers should create some sort of cock-shaped soundwave and plunge it repeatedly through their skulls. 
</code></pre>
<p>I am fully in support of this proposed audio-cock technology. &quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129613">
				<div id="div-comment-129613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timwi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129613">
			October 31, 2003 at 4:40 pm</a>		</div>

		<p>Here&#8217;s a somewhat unrelated question, Raymond, and it&#8217;d be nice if you&#8217;d write a new entry about it. I&#8217;m wondering why, in Windows 95, you chose to left-align the title bar captions. They were centered in Windows 3.1x. I remember that I quite liked it that way, and that I was disappointed when Windows 95 left-aligned them. Of course, I&#8217;m used to it by now, but I&#8217;d really like to know why this change was made.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-129623">
				<div id="div-comment-129623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129623">
			October 31, 2003 at 6:57 pm</a>		</div>

		<p>Im not sure why it was done in Windows95, but the problem with centered text is that it is inconsistent. When the text is left aligned, you always know where it is, as it is fixed. With centered text, that text can move based on the size of the window, and the start of the text line changes when the caption message changes.</p>
<p>Imagine if the task-bar was center aligned (as the poorly designed mac dock is): there would be no consistancy in the location of the windows. If the task-bar was set to auto-hide, this could become very annoying.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-129633">
				<div id="div-comment-129633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bigbeardy.co.uk' rel='external nofollow' class='url'>Mat</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-129633">
			November 3, 2003 at 8:26 am</a>		</div>

		<p>With a bit of tweaking the window captions can be put back in the middle where they belong.  :)</p>
<p>One thing that puzzles me with the XP GUI is that (if you use anything other than Win Classic as your theme) when a button gets a bit on the wide side the ends get scaled and it looks absolutely hideous.  (This mostly happens with forms in IE &#8212; it occasionally happens in apps, but it&#8217;s not consistent.  Some apps are OK, others aren&#8217;t&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195913">
				<div id="div-comment-195913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasondoucette.com/' rel='external nofollow' class='url'>Jason Doucette</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-195913">
			July 16, 2004 at 7:45 am</a>		</div>

		<p>Raymond,</p>
<p>I know that you do not want any comments a few weeks after an entry, but I thought you should be aware that the single line you provide is not sufficient.  For example, cover a portion of the program&#8217;s caption with another window, and then uncover it.  You will find that the redrawn portion will still look inactive.</p>
<p>I hope that addressing this problem was not intentionally left out due to being out of the article&#8217;s scope.  If so, I apologize.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196023">
				<div id="div-comment-196023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20031029-00/?p=42003#comment-196023">
			July 16, 2004 at 11:53 am</a>		</div>

		<p>Hmph. Bummer.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>