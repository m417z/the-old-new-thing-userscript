<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-190523">
				<div id="div-comment-190523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winwonk.com' rel='external nofollow' class='url'>Kim Gr&#228;sman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190523">
			July 5, 2004 at 7:46 am</a>		</div>

		<p>Very interesting!</p>
<p>Who called SHLoadOLE? OLE32.dll itself?</p>
<p>And wasn&#8217;t there a problem in a situation like this:</p>
<p>LPVOID* pv = NULL;<br />
<br />hr = SHGetSomeShellData(&amp;pv);<br />
<br />if(SUCCEEDED(hr))<br />
<br />{<br />
<br />  LoadLibrary(&quot;OLE32.dll&quot;);<br />
<br />  SHFree(pv); // which allocator?<br />
<br />}</p>
<p>&#8212; Kim</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190533">
				<div id="div-comment-190533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190533">
			July 5, 2004 at 7:47 am</a>		</div>

		<p>Wow, thanks for a great entry on something that I&#8217;ve always wondered about.  Of course, now we&#8217;ve seen a few &quot;Windowso&quot; releases and I suppose for compatiblity we never will see SHGetMalloc replaced by a macro, will we&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190563">
				<div id="div-comment-190563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">some1</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190563">
			July 5, 2004 at 8:44 am</a>		</div>

		<p>About &quot;Windowso&quot; thing. I was enlighted by one russin hacker that, that the last &quot;o&quot; is in fact (R) sign, just in some old charset.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190593">
				<div id="div-comment-190593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190593">
			July 5, 2004 at 10:03 am</a>		</div>

		<p>Kim: The shell tried to keep its allocator in sync with the OLE allocator, so &quot;most of the time&quot; you were fine, but there were some cases (such as having an active IMallocSpy) that ddn&#8217;t work. So the answer is, &quot;Yes, there is a problem if you do that. So don&#8217;t do that.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190653">
				<div id="div-comment-190653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190653">
			July 5, 2004 at 11:20 am</a>		</div>

		<p>&quot;In &#8216;OLE Chicken&#8217;, each program would avoid loading OLE32.DLL as long as possible, so that it would be the one blamed for the long pause as OLE32.DLL got itself off the ground and ready for action.&quot;</p>
<p>Shouldn&#8217;t that be &quot;&#8230; so that it wouldn&#8217;t be the one blamed&#8230;&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190673">
				<div id="div-comment-190673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://feldgendler.livejournal.com/' rel='external nofollow' class='url'>Alexey Feldgendler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190673">
			July 5, 2004 at 12:02 pm</a>		</div>

		<p>If you search Google for &quot;windowso&quot;, you&#8217;ll find pretty much about Windowso 95, Windowso NT and such. ;-)</p>
<p>Thanks for the &quot;schedule checken&quot; link, I enjoyed it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190733">
				<div id="div-comment-190733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.xxeo.com/' rel='external nofollow' class='url'>Dru Nelson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190733">
			July 5, 2004 at 5:46 pm</a>		</div>

		<p>So good! Great post Raymond</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190843">
				<div id="div-comment-190843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.trilithium.com/' rel='external nofollow' class='url'>Johan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190843">
			July 6, 2004 at 12:53 am</a>		</div>

		<p>Until you wrote that it was a typo, I had no trouble what so ever believing there was an &quot;OLE 2.0 programming guild&quot; out there somewhere, that you presumably had to contact for things such as task allocator definitions. :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190853">
				<div id="div-comment-190853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190853">
			July 6, 2004 at 2:20 am</a>		</div>

		<p>How can one justify such an ugly hack just to save 4k ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190803">
				<div id="div-comment-190803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alkama</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190803">
			July 5, 2004 at 11:33 pm</a>		</div>

		<p>Explained like that the API jungle starts to make some sense;) The dev world need more ppl like you, but in the help writing teams!<br />
<br />*clap clap clap*</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-190873">
				<div id="div-comment-190873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frederik Slijkerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190873">
			July 6, 2004 at 6:48 am</a>		</div>

		<p>Why didn&#8217;t the OLE team create a lite DLL with the functions that the shell team needed, stubbing out those function in OLE32.DLL to call the lite DLL? That would solve all issues in a much simpler way, or am I mistaken?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-190913">
				<div id="div-comment-190913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winwonk.com' rel='external nofollow' class='url'>Kim Gr&#228;sman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-190913">
			July 6, 2004 at 7:19 am</a>		</div>

		<p>Raymond: Thanks, that makes sense. So, who called SHLoadOLE?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-191123">
				<div id="div-comment-191123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ilm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-191123">
			July 6, 2004 at 10:47 am</a>		</div>

		<p>How does ILFree fit into the picture? Is it really the same as SHFree?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-191313">
				<div id="div-comment-191313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wilfried Wieser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-191313">
			July 6, 2004 at 3:39 pm</a>		</div>

		<p>Ah &#8211; shlobj.h &#8211; this has been my favorite Win32 SDK header for a very long time (exactly because of all those verbose comments). I even remember vaguely a version from 1993 (I think I got it at the PDC&#8217;93 but I&#8217;m not shure), so maybe the typos are even older.</p>
<p>I also seem to remember that the 1993 Version of IShellFolder was not exactly the same as the final version, I think it was derived from IOleContainer back then, that is, ParseDisplayName actually returned a moniker (instead of an ITEMIDLIST). </p>
<p>Maybe the switch from live objects (monikers) to just state (ITEMIDLISTs) was motivated by memory restrictions as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192003">
				<div id="div-comment-192003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrisg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-192003">
			July 8, 2004 at 12:49 am</a>		</div>

		<p>in the debug build ILFree() asserts that the thing is a valid pidl before calling CoTaskMemFree().</p>
<p>so ILFree() == SHFree() == CoTaskMemFree().</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-429503">
				<div id="div-comment-429503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/10/11/816924.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040705-00/?p=38573#comment-429503">
			October 11, 2006 at 10:00 am</a>		</div>

		<p>A little folksy jargon.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>