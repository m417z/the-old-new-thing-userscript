<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (33)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-674163">
				<div id="div-comment-674163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gkdada</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674163">
			October 9, 2008 at 10:50 am</a>		</div>

		<p>Hey, I remember having to add &quot;Files=20&quot; (or some such number) to config.sys to increase the number of files the apps could open. May be these guys asking that question are stuck in some kind of time warp!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674173">
				<div id="div-comment-674173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan_works</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674173">
			October 9, 2008 at 11:01 am</a>		</div>

		<p>Maybe they are using portable C/C++ functions that allows their code to run on other machines. Maybe it works right on those, but fails on winders, so you get lots of &quot;MS suckz!??!oneone&quot; complaints.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674183">
				<div id="div-comment-674183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil (SM)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674183">
			October 9, 2008 at 11:20 am</a>		</div>

		<p>One would think that would be stretching the definition of &quot;portable functions.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674233">
				<div id="div-comment-674233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674233">
			October 9, 2008 at 1:47 pm</a>		</div>

		<p>Nathan: Are &quot;winders&quot; some kind of windlass or winch?</p>
<p>A search for &quot;increase open files&quot; shows people mostly wondering about Linux and DOS, although it also shows that msvcrt has a limit of 512 files by default (which can be increated to 2048 with _setmaxstdio). I suspect that Windows users running into a limit of open files are hitting either the 512 or 2048 limit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674253">
				<div id="div-comment-674253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Craighead</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674253">
			October 9, 2008 at 2:44 pm</a>		</div>

		<p>I&#8217;ve had a lot of frustrations with this on Linux. &nbsp;I recall running into some problems where I was only allowed to have 4096 files open, and increasing that limit would have required the sysadmins to roll out an update to thousands of PCs. &nbsp;Never on Windows &#8212; after hitting the problem on Linux, I wrote a quick Windows test app to call CreateFile in a loop, and I think I got to something like 300K files before it failed.</p>
<p>The other one on Linux was, I think, 255 NFS automounts maximum. &nbsp;After you hit that limit, file operations would start failing if you happened to try to access an NFS resource that wasn&#8217;t mounted yet. &nbsp;Easy to run into that limit of 255 in a big multi-user environment with dozens of people logged into a single computer.</p>
<p>These kinds of hard-coded limitations may have made sense in the 70s and 80s when computers were small, or in embedded systems, but I just don&#8217;t get why some of them still persist to this day.</p>
<p>Windows is not blameless: how about MAX_PATH? &nbsp;You can open very long paths with that \? prefix, but then you have to implement relative paths yourself. &nbsp;Kind of a copout.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674273">
				<div id="div-comment-674273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674273">
			October 9, 2008 at 3:54 pm</a>		</div>

		<p>I think 95% of people are never going to run into problems with MAX_PATH; it&#8217;s a lot more characters than it sounds like:</p>
<p>C:Documents and SettingsJohn Jacob Jingleheimer SchmidtHis name is my name tooWhenever we go outThe people always shouldThere goes John Jacob Jingleheimer Schmidtda da da da da da daRaymond ChenThe Old New ThingIgor Levicki and Norman Diamond 4ever</p>
<p>I bet that this is really only a problem with other languages (i.e. German) where equivalent words and phrases are typically twice as long if not more.</p>
<p>It could also be a problem if you are an organizational Nazi and have folder hierarchies that are 20 levels deep.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674283">
				<div id="div-comment-674283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan_works</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674283">
			October 9, 2008 at 4:30 pm</a>		</div>

		<p>Winders are what you roll down in your car when the weather is nice.</p>
<p>I forget which way it went, probably a linux problem and not on winders, but had errors when I re-used a fstream.. Digging showed the answer to be &quot;the c++ spec isn&#8217;t clear&quot; so implementers did different things (IIRC, it was not clearing the flags when the stream was closed.. So re-opening the file with the same stream variable failed..)</p>
<p>So I was angling more for &quot;different interpretations of the standard&quot; problem in my &#8216;portable code&#8217; response.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674293">
				<div id="div-comment-674293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674293">
			October 9, 2008 at 4:33 pm</a>		</div>

		<p>Why exactly would one need to have thousands of files open at once?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674303">
				<div id="div-comment-674303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Craighead</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674303">
			October 9, 2008 at 4:54 pm</a>		</div>

		<blockquote><p>
  I think 95% of people are never going to run into problems with MAX_PATH
</p></blockquote>
<p>As a software developer, I&#8217;ve hit it (and a related problem: applications with maximum command line lengths or other statically sized internal strings). &nbsp;Deeply nested directory structures and all. &nbsp;People reporting that their build works if they sync their Perforce tree at &quot;c:p4&quot;, but not if they use &quot;c:develop&quot;. &nbsp;That kind of thing.</p>
<p>When you have to start using the &quot;subst&quot; command to map a subportion of your tree to a drive letter, you know you&#8217;re in big trouble.</p>
<p>255 characters per path level is OK. &nbsp;255 total is rather restrictive.</p>
<blockquote><p>
  Why exactly would one need to have thousands of files open at once?
</p></blockquote>
<p>I think one of the problematic cases was repeated use of: open(&quot;/dev/zero&quot;), mmap(), close(). &nbsp;mmap() holds the file descriptor open even after close(), until the last page was munmap()&#8217;d.</p>
<p>More generally: I can think of a number of cases where you&#8217;d want to have thousands of open files. &nbsp;A server, for one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674313">
				<div id="div-comment-674313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674313">
			October 9, 2008 at 4:56 pm</a>		</div>

		<p>Depends what you&#8217;re doing, and also if it&#8217;s a per-process, -user or -system limit.</p>
<p>I think the linux limit is part of the user restrictions system (ie &quot;restrict users to blah files&quot;) but I don&#8217;t remember if it&#8217;s a per-process or per-user limit.</p>
<p>My university has a per-user limit of about 5 processes on the school of computing shared linux webserver. &nbsp;1 of them is taken up by the ssh connection, and 1 of them by your shell. &nbsp;If you try to access a man page, you run into problems because the output is run through quite a complicated pipe in order to format the pages correctly for your screen</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674333">
				<div id="div-comment-674333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674333">
			October 9, 2008 at 5:24 pm</a>		</div>

		<p>Nathan: I got it. Winders are what you use to roll down the windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674363">
				<div id="div-comment-674363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Whiskey Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674363">
			October 9, 2008 at 6:25 pm</a>		</div>

		<p>You need more than 4096 files open? Sounds like you&#8217;re doing something stupid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-674373">
				<div id="div-comment-674373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674373">
			October 9, 2008 at 6:35 pm</a>		</div>

		<p>Winders is the redneck edition of Windows. (pronounced with a short &quot;i&quot;, not long &quot;i&quot;)</p>
<p>I remember hitting the open files limit on Linux with an email server. Thousands of open files is not uncommon for an email server.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674383">
				<div id="div-comment-674383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Butler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674383">
			October 9, 2008 at 6:50 pm</a>		</div>

		<p>CreateFile docs</p>
<p>&quot;In the ANSI version of this function, the name is limited to MAX_PATH characters. To extend this limit to 32,767 wide characters, call the Unicode version of the function and prepend &quot;\?&quot; to the path. For more information, see Naming a File.</p>
<p>Windows Me/98/95: &nbsp;This string must not exceed MAX_PATH characters.&quot;</p>
<p>Having pointed that out, sometimes I get errors &nbsp;similar to &#8216;path too long to delete&#8217; in Windows Explorer when trying to delete folders &#8211; it might even be when trying to empty the Recycle Bin! &nbsp;This happens where I might have copied an entire drive to a folder on another drive &#8211; and the combination of new folder name + original path probably goes over MAX_PATH. &nbsp;The way around it is to delete the deeper-level folders first.</p>
<p>I think for most users, though &#8211; with their &#8216;My &nbsp;Documents&#8217; that it would be difficult to reach a max path depth.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674393">
				<div id="div-comment-674393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asshat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674393">
			October 9, 2008 at 6:51 pm</a>		</div>

		<p>4096 files ought to be enough for anoybody!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674403">
				<div id="div-comment-674403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jcs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674403">
			October 9, 2008 at 6:55 pm</a>		</div>

		<p>Regarding MAX_PATH: This is very easy to exceed with development tools (such as J2EE application servers) that automatically create deeply nested directory trees to hold versions of code artifacts and configuration settings</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674413">
				<div id="div-comment-674413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asshat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674413">
			October 9, 2008 at 6:56 pm</a>		</div>

		<p>4096 files ought to be enough for anybody!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674423">
				<div id="div-comment-674423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Butler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674423">
			October 9, 2008 at 6:58 pm</a>		</div>

		<p>I&#8217;m curious about how many people would use something like fopen() or similar rather than CreateFile() to open a file. &nbsp;We had to use posix compatible functions in a system I worked on &quot;because we MIGHT want to recompile it for Linux in the future&quot; &#8211; the project was scrapped, I think. &nbsp;But we lost the control that comes along with CreateFile() &#8211; such as file locking. &nbsp;And I guess you loose things such as sparse files, etc. too. &nbsp;</p>
<p>How common is it that people here, say, need to avoid the use of Win32 API calls in favour of posix-only?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674433">
				<div id="div-comment-674433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674433">
			October 9, 2008 at 7:24 pm</a>		</div>

		<p>Joe, using the stdio facilities doesn&#8217;t just give you portability, it also gives you things like buffering and newline translation. If you&#8217;re already familiar with the C stdlib, why bother learning new APIs?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674453">
				<div id="div-comment-674453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674453">
			October 9, 2008 at 8:48 pm</a>		</div>

		<p>@gkdada &#8211; DUMMY! You invoked Yuhong Bao by referencing any pre-NT Microsoft O/S. If you have been here more than 5 minutes you should know better!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674473">
				<div id="div-comment-674473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674473">
			October 9, 2008 at 10:29 pm</a>		</div>

		<p>In Vista&#8217;s explorer, if you have a certain number of files selected and press enter, nothing happens. &nbsp;In XP, you got a warning (which was nice.) &nbsp;So, this might be part of the user&#8217;s question.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674483">
				<div id="div-comment-674483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674483">
			October 10, 2008 at 1:21 am</a>		</div>

		<p>The funny thing is, if Linux had the 4096-file limit and was restrictive, people running servers would&#8217;ve run into it. After all, you have Linux NFS (true &#8211; you can have it in kernel, but a userspace server exists), SMB, FTP, and webservers, and they seem just fine with the limit.</p>
<p>I suspect though, that because clone() and friends are really, really, really cheap on Unix, calling APIs like fork() etc., set off a new per-process limit, so no one reaches the limit practically. On Windows, processes are expensive &#8211; calling CreateProcess() is quite a heavy function, so limits have to be huge since running threaded on Windows is a better idea.</p>
<p>The funny thing is, there are many servers on Linux that are also threaded&#8230;</p>
<p>Now, the biggest limit I&#8217;ve hit on Linux is the command line limit. We were doing a build, and we found that if your username had 3 characters, you were fine. If your username was 4 characters, the build failed. We traced this down to a kernel build command that issued a find and passed the results to xargs. If you had a 3-letter username, it produced a command line that was about 110kB in length (yes, kilobytes). If you had a 4-letter username, the command line expanded to around 145kB. Linux has a command line length limit for 128kiB.</p>
<p>Also, for those of you playing with mmap() &#8211; the finest granularity for mmap() is the CPU&#8217;s page size (since mmap() relies on the MMU to produce a page fault for which the VM code handles by mapping in the file contents appropriately). On Linux, mmap() will only return a pointer that&#8217;s page aligned, too. While you can map smaller regions, mapping oddball regions in a page already clues you in since you get a pointer mapped to the beginning of a page, and you have to manually offset it yourself.</p>
<p>The practical limit for mmap() would be one that involves mapping the entire process&#8217; address space page-size blocks at a time, minus code/data/library areas. But you&#8217;ll be more likely to hit an internal kernel limit since you&#8217;re growing the internal kernel data structures and will hit some kernel limit or other soon enough.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674493">
				<div id="div-comment-674493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674493">
			October 10, 2008 at 2:10 am</a>		</div>

		<p>@Worf set forth &quot;We traced this down to a kernel build command that issued a find and passed the results to xargs. If you had a 3-letter username, it produced a command line that was about 110kB in length (yes, kilobytes). If you had a 4-letter username, the command line expanded to around 145kB. Linux has a command line length limit for 128kiB.&quot;</p>
<p>xargs has parameters which can limit how many items are placed on each iteration of the command line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674503">
				<div id="div-comment-674503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674503">
			October 10, 2008 at 2:58 am</a>		</div>

		<p>@John</p>
<p>&quot;I bet that this is really only a problem with other languages (i.e. German)&quot;</p>
<p>&quot;It could also be a problem if you are an organizational Nazi&quot;</p>
<p>I guess you&#8217;re really screwed if you&#8217;re a German organizational Nazi.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674513">
				<div id="div-comment-674513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674513">
			October 10, 2008 at 2:58 am</a>		</div>

		<p>&quot;@gkdada &#8211; DUMMY! You invoked Yuhong Bao by referencing any pre-NT Microsoft O/S. If you have been here more than 5 minutes you should know better!&quot;</p>
<p>I would have said the thing about DOS FILES= even without gkdada&#8217;s comment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674523">
				<div id="div-comment-674523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel Colascione</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674523">
			October 10, 2008 at 2:59 am</a>		</div>

		<p>Since 2.6.23, the command line length is no longer limited.</p>
<p>See the comprehensive list here:</p>
<p><a rel="nofollow" target="_new" href="http://www.in-ulm.de/~mascheck/various/argmax/#results" rel="nofollow">http://www.in-ulm.de/~mascheck/various/argmax/#results</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674463">
				<div id="div-comment-674463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">quotemstr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674463">
			October 9, 2008 at 9:18 pm</a>		</div>

		<p>Matt, I don&#8217;t quite know what you&#8217;re talking about with regard to open/mmap/etc.</p>
<p>Here is a testcase: <a rel="nofollow" target="_new" href="http://pastebin.ca/1224219" rel="nofollow">http://pastebin.ca/1224219</a></p>
<p>On my Linux box, I was able to reach 65524 mappings.On OpenBSD, that number increased to 262102. Also, the Linux number is *per process*.</p>
<p>Also, if you&#8217;re mmap()ing /dev/zero, I bet you&#8217;re trying to implement your own memory allocator. If you want to do that, mmap() larger regions and divide them up; or just use malloc: it already uses mmap() when appropriate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674533">
				<div id="div-comment-674533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Craighead</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674533">
			October 10, 2008 at 6:13 am</a>		</div>

		<blockquote><p>
  Matt, I don&#8217;t quite know what you&#8217;re talking about with regard to open/mmap/etc. &nbsp;Here is a testcase: <a rel="nofollow" target="_new" href="http://pastebin.ca/1224219" rel="nofollow">http://pastebin.ca/1224219</a>
</p></blockquote>
<p>Honestly, at this point&#8230; it&#8217;s been a while. &nbsp;I don&#8217;t know what kernel the systems were running, or the exact arguments that were passed to open() and mmap().</p>
<p>To make things even nuttier, the problem actually happened not running the native Linux version of the app, but running the Windows version of the app on Linux under wine (!). &nbsp;The native Linux app avoided the problematic scenario in the first place. &nbsp;wine&#8217;s emulation of VirtualAlloc was, shall we say, far from optimal.</p>
<p>Now that I&#8217;m thinking about it more, I think it&#8217;s coming back to me. &nbsp;I think rather than using /dev/zero, wine would actually create a temporary file mmap() it, and then unlink it. &nbsp;(Or am I thinking of wine&#8217;s emulation of unnamed section objects? &nbsp;Perhaps I am not remembering it straight after all.) &nbsp;It was all rather overly elaborate for what should have been a simple operation to emulate.</p>
<p>And no, it actually wasn&#8217;t for a memory allocator, it was for something else entirely&#8230; don&#8217;t ask. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674563">
				<div id="div-comment-674563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BA</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674563">
			October 10, 2008 at 10:27 am</a>		</div>

		<p>&quot;I think 95% of people are never going to run into problems with MAX_PATH; it&#8217;s a lot more characters than it sounds like:</p>
<p>C:Documents and SettingsJohn Jacob Jingleheimer SchmidtHis name is my name tooWhenever we go outThe people always shouldThere goes John Jacob Jingleheimer Schmidtda da da da da da daRaymond ChenThe Old New ThingIgor Levicki and Norman Diamond 4ever&quot;</p>
<p>At my last job, we routinely ran into MAX_PATH. The folder hierarchy was a disaster. It looked somthing like this (using OldCo as the company name):</p>
<p>D:DataOperation ManualOldCo TechnologyOldCo Technology Customer Quotes2007 QuotesQuotes for John SmithOldCo Technology Quote for John Smith on 10.12.2007.xlsx</p>
<p>Lots of repetition and lots of shortcuts to these retardedly long file names.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674683">
				<div id="div-comment-674683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">&gt;mem</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674683">
			October 10, 2008 at 6:11 pm</a>		</div>

		<p>Why limit 32-bit OS support to &lt;2^32 characters command line? It could be technically possible to support more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674693">
				<div id="div-comment-674693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674693">
			October 10, 2008 at 8:38 pm</a>		</div>

		<p>&quot;Nathan: Are &quot;winders&quot; some kind of windlass or winch?&quot;</p>
<p>&quot;Nathan: I got it. Winders are what you use to roll down the windows.&quot;</p>
<p>It is of course really a misspelling, but I laughed when I read this!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-674733">
				<div id="div-comment-674733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674733">
			October 11, 2008 at 7:05 am</a>		</div>

		<p>Linux state (2.6.23):</p>
<p>Through ulimit, a process can have up to 1048576 files open at once.</p>
<p>Beware: select(), due to a fundamental design flaw, has a much lower limit. FD_SETSIZE, the highest fd supported by select(), is 1024.</p>
<p>Actually, the kernel has no limit&#8230; Changing the limit in header files just works, but doing so breaks binary compatibility for programs exchanging fd_set structures.</p>
<p>Solution: Use poll().</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-674783">
				<div id="div-comment-674783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">cyanna</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20081009-00/?p=20613#comment-674783">
			October 11, 2008 at 12:13 pm</a>		</div>

		<p>Actually the question has been put forward on several forums in the following scenario: in windows vista, user highlights several files (with same extension)in explorer, right clicks and chooses open.</p>
<p>Result: if the number of files is 16 or less, the files open. If the number of files is more than 16 nothing happens.</p>
<p>Tested with txt files when the program associated is notepad, and pictures when the associated program is picture viewer.</p>
<p>Incidentally if any of the files has a different extension, even if the associated program is the same, the right click menu doesn&#8217;t even offer the &quot;open&quot; option (example: xlx and xlsx files with Office 2007 as associated program) This is not an Office issue as the files will open correctly if selected from within the relevant office application via File&gt;open&gt;browse. This behaviour is probably not related to the 16-files-limit, but much more &nbsp;annoying!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>