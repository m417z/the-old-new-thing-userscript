<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-783113">
				<div id="div-comment-783113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783113">
			November 4, 2009 at 7:26 am</a>		</div>

		<p>Actually it seems to me that there&#8217;s nothing wrong with &quot;What is a tallest building?&quot; in the same context in which &quot;What is a best practice?&quot; would be used. A tallest building is a building whose height is greater than any other in a particular geographical area. A best practice is the best way to do something in a particular domain. Goldman Sachs Tower is a tallest building, for example. Do you have a problem with the previous sentence? I don&#8217;t. It&#8217;s the tallest building in New Jersey.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783123">
				<div id="div-comment-783123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">acq</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783123">
			November 4, 2009 at 7:27 am</a>		</div>

		<p>Allow me to ask even if I don&#8217;t work in that area:</p>
<p>Am I right that I can actually have an application with a lot of threads and still initialize STA in main (UI) thread? Then I just have to do all COM stuff from main thread and everything&#8217;s fine?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783153">
				<div id="div-comment-783153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">keith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783153">
			November 4, 2009 at 8:15 am</a>		</div>

		<p>The best practice is to always use good practices. &nbsp;</p>
<p>I was wholly unprepared for the Gartner Group use of the term &quot;best of breed&quot; vs &quot;enterprise&quot;, which I first encountered in the course of a presentation by my employer&#8217;s founder several months after starting. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783163">
				<div id="div-comment-783163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark (The Other Mark)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783163">
			November 4, 2009 at 8:55 am</a>		</div>

		<p>You probably never heard back from him because you answered his question.</p>
<p>Lots of people latch on to &quot;Best Practices&quot; without knowing why. These people drive me nuts. If &quot;Best Practice&quot; is to use the Gumblefreem Optimizer&#8230; great, under what circumstances would you be better off with your Gumblefreem Unoptimized?</p>
<p>Instead of blindly following other peoples blind advice, he asked the question. Is there an issue? Your followup question strongly implies &quot;Nope, no issue. Sometimes it makes sense to do it the other way.&quot;, so if we was already faced with a situation where it seemed the best approach and best practice were two different items, there&#8217;s probably not a hidden trap that&#8217;s going pop up later.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783193">
				<div id="div-comment-783193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783193">
			November 4, 2009 at 9:23 am</a>		</div>

		<blockquote><p>
  &gt; Then I just have to do all COM stuff from main thread and everything&#8217;s fine?
</p></blockquote>
<p>Depends entirely on what the COM objects do, &nbsp;how you are using them, what the main thread is doing and how you share information with other threads.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783223">
				<div id="div-comment-783223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian Tkatch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783223">
			November 4, 2009 at 11:19 am</a>		</div>

		<p>We separate buildings into groups. Within each group we show summary information, except for the tallest build in each group, which gets more information.</p>
<p>When explaining this, i get asked, &quot;show me a tallest building&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783273">
				<div id="div-comment-783273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Teo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783273">
			November 4, 2009 at 12:06 pm</a>		</div>

		<p>In various Microsoft blogs, I keep reading &#8220;a customer asked us&#8221;, &#8220;we told a customer to,&#8221; etc. Seriously, how did this mythical customer contacted you in the first place? For example, right now I am programming against the failover cluster API and it is a mess &#8211; the docs in MSDN, the examples in the platform sdk and the observed behavior in the debugger do not match at all. Not to mention that half the api in Server 2008 R2 is undocumented. So whom and how to ask for help?</p>
<div class=post>[<i>The customers don&#8217;t contact the product teams directly; they go through a <a href="http://blogs.msdn.com/oldnewthing/archive/2009/02/16/9425124.aspx" rel="nofollow">customer liaison</a>. How do you get a customer liaison? Beats me. Maybe they have a support contract. Maybe they used one of the forums. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783283">
				<div id="div-comment-783283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaron G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783283">
			November 4, 2009 at 12:10 pm</a>		</div>

		<p>If the best practice is always the best practice, that would inevitably make it the only practice. &nbsp;The very fact that there are other practices means that they must sometimes be better.</p>
<p>I defy anyone to identify a practice that one can actually choose not to, er, practice, yet is still always the best choice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783303">
				<div id="div-comment-783303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783303">
			November 4, 2009 at 12:21 pm</a>		</div>

		<blockquote><p>
  &gt; Actually it seems to me that there&#8217;s nothing wrong with &quot;What is a tallest building?&quot;
</p></blockquote>
<p>To show that Z is a Xest Y, choose any values of X and Y where Z is a Y, then keep reducing the scope until true.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783313">
				<div id="div-comment-783313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian Tkatch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783313">
			November 4, 2009 at 12:25 pm</a>		</div>

		<p>@Aaron G</p>
<p>&quot;I defy anyone to identify a practice that one can actually choose not to, er, practice, yet is still always the best choice.&quot;</p>
<p>Under Windows? Reboot! :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783383">
				<div id="div-comment-783383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Teo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783383">
			November 4, 2009 at 10:50 pm</a>		</div>

		<p>Cool, thanks for the answer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783423">
				<div id="div-comment-783423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Van Houtte</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783423">
			November 5, 2009 at 12:17 am</a>		</div>

		<p>@Teo:</p>
<p>My guess is that Raymond takes any group external to Windows as a customer of the Windows group. That (also) includes people from other groups at Microsoft most of whom don&#8217;t have access to Windows source code and/or who ask for help from the Windows team.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783433">
				<div id="div-comment-783433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com' rel='external nofollow' class='url'>Dale</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783433">
			November 5, 2009 at 2:24 am</a>		</div>

		<p>@Teo: I believe depends on the type of customer you are.</p>
<p>At my last employer,we had our own Microsoft Technical Account Manager, and we were able to ask for help via the TAM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783493">
				<div id="div-comment-783493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DysgraphicProgrammer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783493">
			November 5, 2009 at 7:29 am</a>		</div>

		<p>I guessing that the customer dug out the documents with the recommendation and either could not find them or realized that the context did not apply. At that point he decided to stop wasting Raymond&#8217;s time.</p>
<p>Personally I prefer to send an email that says: Oops. Never mind, the docs said only under conditions X, Y and Z when the moon is full and Jupiter is in the second house. &nbsp;</p>
<p>Especially since the receiver can ignore every thing after &#8216;never mind&#8217; if he feels like it. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783573">
				<div id="div-comment-783573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783573">
			November 5, 2009 at 11:36 pm</a>		</div>

		<p>What actually works is the *real life* is the right way to do a thing. Not by following some lousy docs. Both the docs and the api can have bugs which you have to compensate for anyway.</p>
<p>One approach is to write a program which calls the api with all combinations of parameters. When the right (can be several) combination of calls and parameters is found, you know how to write your code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783703">
				<div id="div-comment-783703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783703">
			November 6, 2009 at 10:40 am</a>		</div>

		<blockquote><p>
  &gt; One approach is to write a program which calls the api with all combinations of parameters.
</p></blockquote>
<p>So we all need to use code-breaking supercomputers to crack the APIs rather than reading the documentation?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-783713">
				<div id="div-comment-783713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783713">
			November 6, 2009 at 10:42 am</a>		</div>

		<p>&gt;&gt; One approach is to write a program which calls the api with all combinations of parameters.</p>
<p>I forgot the best alternative, use open source then you can see what the function really does. Code inspection doesn&#8217;t have to stop at the code you write.</p>
<div class=post>[<i>And if you look at the source code and you see, &#8220;Oh, the heap manager keeps the block size at offset -8 from the pointer it returns to me,&#8221; are you going to write code that relies on this? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-783753">
				<div id="div-comment-783753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Teo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-783753">
			November 6, 2009 at 11:54 am</a>		</div>

		<p>Thanks for the answers, I&#8217;m talking about a small company &#8211; 20 people who just got our first MS partner certification.</p>
<p>porter, open source is not a real solution to the problem. Although I have full access to our company code base, when I discover the problem is not in my code, I ask the guy who created the problematic code (or the code who is on the top of the call stack). This saves days which otherwise would be spent trying to understand why the code is written in this particular way. The docs are an indispensable tool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-784693">
				<div id="div-comment-784693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-784693">
			November 10, 2009 at 8:29 am</a>		</div>

		<p>640k, porter, that is absolutely the WORST way to do it. Follow the docs. The documentation tells you what will be supported in the future. If you don&#8217;t do it that way, the way you have discovered may not work in the next version of Windows, the next service pack, the next security update. Windows is a changing target more than ever before; all you can rely on is what the developers have promised to support, which is what is in the documentation.</p>
<p>Sometimes, the documentation is wrong. In that case, the safest thing to do is not to use that API. If you can&#8217;t avoid using the API, call support. You get a small number of free incidents with any boxed developer tool and with MSDN subscriptions.</p>
<p>Open source tells you how the developer has chosen to implement it now, but that isn&#8217;t a contract. There&#8217;s absolutely no guarantee that what the owner of the function thinks is the contract matches what *you* think is the contract. They could easily break your app with the next version of their library if you don&#8217;t agree.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-785443">
				<div id="div-comment-785443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian Tkatch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091104-00/?p=16153#comment-785443">
			November 11, 2009 at 5:38 am</a>		</div>

		<p>&#8220;They could easily break your app with the next version of their library if you don&#8217;t agree.&#8221;</p>
<p>But with no contract, there&#8217;s be little benefit to using the new library anyway, so you can stay with what you know works.</p>
<div class=post>[<i>This assumes you have the liberty to choose which version of the library you want to use. Do you get to choose which version of /vmlinuz you want? What if you&#8217;re a plug-in and the host process prefers a different version of the library? What if a security fix to the library breaks your undocumented assumption? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>