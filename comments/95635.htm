<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (4)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1 parent" id="comment-1286975">
				<div id="div-comment-1286975" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170302-00/?p=95635#comment-1286975">
			March 2, 2017 at 8:19 am</a>		</div>

		<p>This seems overcomplicated to me. Why not just create another UI thread with a &#8220;invisible&#8221; 1&#215;1 window at the menu point and then show the menu and execute in this thread?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1286986">
				<div id="div-comment-1286986" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170302-00/?p=95635#comment-1286986">
			March 2, 2017 at 8:37 am</a>		</div>

		<p>Because context menu handlers might do things like query the site chain for other services (e.g., to manipulate the host window).</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks even depth-3" id="comment-1287105">
				<div id="div-comment-1287105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170302-00/?p=95635#comment-1287105">
			March 2, 2017 at 7:12 pm</a>		</div>

		<p>Does that mean that you cannot interact with the site you got from IObjectWithSite in InvokeCommand?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1287386">
				<div id="div-comment-1287386" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua A Schaeffer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170302-00/?p=95635#comment-1287386">
			March 4, 2017 at 5:27 pm</a>		</div>

		<p>What if the 1st context menu acts on shell items that needed UI intervention to unlock and deep-enumerate aka IShellFolder::EnumObjects(HWND)? You create the 2nd context menu on the 2nd thread that parses a different instance of the same namespace (which I assume because of STA), what will happen if it doesn&#8217;t see the same enumeration state and needs user input?</p>
<p>I don&#8217;t think the design is overcomplicated, I&#8217;m just not convinced it&#8217;s correct. I must be overlooking something.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>