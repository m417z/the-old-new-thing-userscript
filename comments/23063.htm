<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-611033">
				<div id="div-comment-611033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Thresher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611033">
			March 20, 2008 at 10:14 am</a>		</div>

		<p>I may be missing the obvious but doesn&#8217;t outlook use structured storage when dragging messages around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-611053">
				<div id="div-comment-611053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611053">
			March 20, 2008 at 11:34 am</a>		</div>

		<p>Mr. Chen,</p>
<p>Thank you for this series. &nbsp;It has been one of the most fun so far.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-611103">
				<div id="div-comment-611103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611103">
			March 20, 2008 at 5:20 pm</a>		</div>

		<p>Steve: Are you nitpicking? &nbsp;I don&#8217;t think those are virtual files (or real files; doesn&#8217;t outlook use one large file for all your e-mail?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-611113">
				<div id="div-comment-611113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611113">
			March 20, 2008 at 6:46 pm</a>		</div>

		<p>god dammit it&#8217;s so boring, what&#8217;s the purpose raymond?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-611123">
				<div id="div-comment-611123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.coldacid.net/' rel='external nofollow' class='url'>Chris Charabaruk</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611123">
			March 20, 2008 at 7:01 pm</a>		</div>

		<p>@gb When you need it, you&#8217;ll be able to use it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-611173">
				<div id="div-comment-611173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611173">
			March 20, 2008 at 10:49 pm</a>		</div>

		<p>@gb</p>
<p>You can&#8217;t fool me. I&#8217;ve seen lots of movies where esoteric computer knowledge saves the world. When the aliens attack, a knowledge of COM and OLE may save the world. It&#8217;s certainly more likely than them using Macs like the aliens in Independence Day. Watch the skys but make sure you read Dale Rogerson!</p>
<p>More to the point, I could hack up an explorer style application with a treeview/splitter/listview/menu bar that lets me drag and drop files from my PTP device. Or anything else for that matter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-611183">
				<div id="div-comment-611183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rivari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611183">
			March 20, 2008 at 11:14 pm</a>		</div>

		<p>@Anon</p>
<p>I am a computer science student and I wonder if it still a good idea to learn COM!</p>
<p>What do you think?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-611423">
				<div id="div-comment-611423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-611423">
			March 21, 2008 at 6:31 pm</a>		</div>

		<p>If you want to integrate with Windows, you will probably have to learn it. If you&#8217;re not aiming to do that, then learn the concepts behind it and why it developed the way it did.</p>
<p>I know the basics and how to use it in a pinch, but I probably couldn&#8217;t write a COM component easily, and I consider myself a fairly competent Windows developer. Maybe I&#8217;m not if I try to avoid COM&#8230; ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-612833">
				<div id="div-comment-612833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anthony Wieser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-612833">
			March 26, 2008 at 10:42 am</a>		</div>

		<p>Now all I need to do is figure out how to implement the other end of the drop target so that I can register file associations.</p>
<p>MSDN says this:</p>
<p>On Microsoft Windows XP systems, enhanced support is added for applications that implement drag-and-drop features and expose their IDropTarget interface. With this method, the Shell communicates with the application through the Component Object Model (COM) subsystem. This method offers a significant performance gain over both the command line method and DDE. To use this method, add a DropTarget subkey under a verb&#8217;s key. Under the DropTarget, add a registry string named Clsid, and set the value of this string to a valid CLSID Key.</p>
<p>MSDN online also adds this helpful advice:</p>
<p>Implementations of IDropTarget::Drop need to return quickly to the caller avoid causing an unresponsive state. There are two ways to accomplish this:</p>
<p>Marshall the input IDropTarget to a new thread.</p>
<p>Take a reference to the data object, set a short timer, and process the drop against that timer. If you use this method, you must ensure that you do not begin processing a second drop while the first is still being processed.</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/bb776883.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/bb776883.aspx</a></p>
<p>What it doesn&#8217;t say is: Does this work on Vista?</p>
<p>I assume all I need to do is expose on object on my exe with the specified CLSID that supports an IDropTarget interface.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-612853">
				<div id="div-comment-612853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anthony Wieser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080320-00/?p=23063#comment-612853">
			March 26, 2008 at 10:44 am</a>		</div>

		<p>I see from msdn online this works on XP and later systems. &nbsp;oops.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>