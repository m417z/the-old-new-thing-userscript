<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1250815">
				<div id="div-comment-1250815" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250815">
			May 31, 2016 at 8:33 am</a>		</div>

		<p>I&#8217;ve seen this. You may be in the following bad case: They have a subcomponent as a library that must have a registry key pointing to its workspace, but the main application can&#8217;t handle it being repointed and so always sets the value in the registry for the subcomponent.</p>
<p>If not this case, RegNotifyChangeEx is your friend.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matteo odd alt thread-odd thread-alt depth-1 parent" id="comment-1250845">
				<div id="div-comment-1250845" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250845">
			May 31, 2016 at 11:01 am</a>		</div>

		<p>Couldn&#8217;t they just mount the &#8220;bad&#8221; path over the default data folder?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-alexcohn even depth-2" id="comment-1250855">
				<div id="div-comment-1250855" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250855">
			May 31, 2016 at 11:13 am</a>		</div>

		<p>On the face of it, they were not looking for simple solutions</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1250875">
				<div id="div-comment-1250875" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dox.com.au' rel='external nofollow' class='url'>Ian Yates</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250875">
			May 31, 2016 at 1:37 pm</a>		</div>

		<p>Yeah, I&#8217;d be tempted to try a symlink.  They&#8217;re a very handy way of pushing data around for apps that insist on C:.  I used them heavily on an old laptop that had 2x HDDs and I&#8217;d put a lot of stuff on C:.  Rather than reinstall apps, etc I just made symlinks for c:\program files\blah to d:\program files\blah.  I don&#8217;t think I ever ran into any problems (that I saw at least) :)</p>
<p>I&#8217;ve done the same for a VM running a really old read-only copy of a LOB app that I occasionally need to look at.  It&#8217;s data sits on my machine and the VM has a symlink of c:\app\data pointing to \\workstation\oldLOBAppData share.  That old app is none the wiser.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1250895">
				<div id="div-comment-1250895" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://harryjohnston.wordpress.com' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250895">
			May 31, 2016 at 6:50 pm</a>		</div>

		<p>Presumably, they want the folder redirection to remain in place &#8211; you don&#8217;t generally want to redesign your network just because one application is misbehaving.  Or at least that would be a last resort.  </p>
<p>The fact that the application&#8217;s data directory needs to be local (which you might indeed solve with a symlink or junction point) doesn&#8217;t seem to be a problem for them, it&#8217;s just that they&#8217;re having trouble telling the application to ignore the folder redirection.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-even depth-1" id="comment-1250896">
				<div id="div-comment-1250896" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250896">
			May 31, 2016 at 6:59 pm</a>		</div>

		<p>Btw, will adding &#8220;deny write&#8221; access to &#8220;INTERACTIVE user&#8221; work? (Assuming their LOB application is WinForm client and not Windows Service process, because if it&#8217;s service, you&#8217;d create a domain account to run the service and just deny write access of that registry key to that account)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1250905">
				<div id="div-comment-1250905" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scarlet Manuka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250905">
			May 31, 2016 at 8:32 pm</a>		</div>

		<p>I was rather expecting through the whole article that the application that was going in and resetting the registry key was going to be the same one that the key was for. If the registry key is for that application&#8217;s data directory, surely that application is the most likely one to be mucking around with it.</p>
<p>I suppose it could also be one program acting as a kind of supervisor and making sure everyone has the correct settings, in which case it is probably, as Raymond suggested, a related program from the same vendor.</p>
<p>The security audit sounds like a good idea, at the very least to see whether the problem is indeed coming from inside the house.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-raykoopa odd alt thread-even depth-1 parent" id="comment-1250915">
				<div id="div-comment-1250915" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ray+Koopa' rel='external nofollow' class='url'>Ray Koopa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250915">
			June 1, 2016 at 3:26 am</a>		</div>

		<p>That reminds me of another case where I wanted to set a whole registry folder to read-only; the ShellIconOverlayIdentifiers one. Windows 10 just loves to put 3 or 4 subkeys in there for SkyDrive, then another 3 or 4 for OneDrive. That pushed my important TFS overlays so far back to the list, the overlays were gone almost every time Win10 did some updates.</p>
<p>I couldn&#8217;t really prevent the updates from smearing stuff in there (also not thinking that would&#8217;ve been a good idea), and eventually just made sure to keep my overlays alphabetically at the top (which was a little annoying since the SkyDrive ones began with a space character)&#8230;</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1250955">
				<div id="div-comment-1250955" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zarat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250955">
			June 1, 2016 at 8:04 am</a>		</div>

		<p>Yup, the tight limit of UI overlays together with every program supporting it trying to get top places is really annoying. When there are such strict resource limits there should be separate UI where the user can select the UI overlays he wants among installed overlays, instead of allowing random programs to mess up things.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1250985">
				<div id="div-comment-1250985" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160531-00/?p=93545#comment-1250985">
			June 2, 2016 at 8:17 am</a>		</div>

		<p>I suspect it the case of an application or service running under token which doesn&#8217;t have access to network locations, and then it resets the location to default because the configured location is not accessible. Or the location is temporarily inaccessible because of network dropout. Same mistake as Windows Desktop Cleanup task does (does Windows 8/10 still have that abomination?).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>