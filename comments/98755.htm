<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (85)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1337075">
				<div id="div-comment-1337075" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alan Hardman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337075">
			May 15, 2018 at 7:25 am</a>		</div>

		<p>I&#8217;ve never felt like the limited feature set of Compressed Folders was an issue. It already offers far better functionality than most other operating systems&#8217; file compression UIs, and if you really need additional features you&#8217;ll probably want something best implemented in a third-party application anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-koldude odd alt thread-odd thread-alt depth-1 parent" id="comment-1337085">
				<div id="div-comment-1337085" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337085">
			May 15, 2018 at 7:31 am</a>		</div>

		<p>This is one thing that if there was a Windows Uservoice I would upvote. Unfortunately this having been frozen in time means people are forced to use things like 7zip and WinRaR both of which have security issues an no patching mechanism. Having this sort of thing available as an OS API (preferably with an api compatible with gzip?) would be a huge boon. I know the code is there, IIS uses it, but as far as I know it&#8217;s not exposed anywhere documented.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-kirbyfcf2 even depth-2" id="comment-1337365">
				<div id="div-comment-1337365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Kirby+FC' rel='external nofollow' class='url'>Kirby FC</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337365">
			May 15, 2018 at 12:32 pm</a>		</div>

		<p>The .zip file format was created circa 1989 and its creator, Phil Katz, made the specs freely available so that anyone could write their own zip handlers.  That&#8217;s why free programs like 7zip are able to exist and why there are many programs out there that routinely handle zip files.  This is a weird issue, especially for a company as large and rich as Microsoft.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1337095">
				<div id="div-comment-1337095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mikko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337095">
			May 15, 2018 at 7:33 am</a>		</div>

		<p>Oh, Unicode file name support was exactly what I was going to complain about&#8230; I don&#8217;t care about all the fancy features like AES, I would just very much like if it could *create* archives with Unicode names, not just extract them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1337105">
				<div id="div-comment-1337105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://brashear.me' rel='external nofollow' class='url'>Austin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337105">
			May 15, 2018 at 7:33 am</a>		</div>

		<p>In recent Windows 10 you can create ZIPs with PowerShell using Compress-Archive/Extract-Archive: <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/compress-archive?view=powershell-6" rel="nofollow">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/compress-archive?view=powershell-6</a></p>
<p>Only downside is it can&#8217;t handle archives &gt;2gb (which I think is a limitation shared with the GUI-based archiver).</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mngoldeneagle odd alt depth-2" id="comment-1337405">
				<div id="div-comment-1337405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337405">
			May 15, 2018 at 2:05 pm</a>		</div>

		<p>I believe that was a limitation in the ZIP spec in general until ZIP64 was introduced (in 2001, though it wasn&#8217;t implemented broadly until much later).  Not sure why .NET wouldn&#8217;t implement that particular extension though&#8230; might be a limitation in the file streams it&#8217;s using.  I&#8217;ve noticed some inconsistencies in buffers and streams where some expose a LongLength and LongIndex and others do not, forcing you to only have access to 2GB of a file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even depth-2" id="comment-1337455">
				<div id="div-comment-1337455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337455">
			May 15, 2018 at 6:27 pm</a>		</div>

		<p>I believe you can use System.IO.Compression namespace in .NETv4.5+ in PowerShell for older operating systems</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1343025">
				<div id="div-comment-1343025" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert Hall</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1343025">
			May 28, 2018 at 7:27 pm</a>		</div>

		<p>2017: The most popular desktop OS gets support in its primary scripting language for the most common compression format. How can this be a -100 feature? Instead a poorly performing lz library was added, the lz algorithm is surely more patented than zip, which should have been bundled in windows since day 1. Fun isn’t something one considers when using winapi, but that nano edition removed lz32.dll recently does put a smile on my face.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1337115">
				<div id="div-comment-1337115" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mikko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337115">
			May 15, 2018 at 7:35 am</a>		</div>

		<p>But on another topic, doesn&#8217;t Windows happen to have another implementation for said &#8220;compression and decompression code&#8221; by which it implements e.g. loading of .appx or .docx files (which are zips under the hood)? Or is _that_ also licensed in strange ways?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1337395">
				<div id="div-comment-1337395" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Iverson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337395">
			May 15, 2018 at 1:21 pm</a>		</div>

		<p>I imagine that&#8217;s part of Microsoft Office code, not Windows code.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong even depth-3 parent" id="comment-1337875">
				<div id="div-comment-1337875" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337875">
			May 16, 2018 at 6:24 pm</a>		</div>

		<p>I would imagine there were a &#8220;licensing terms change&#8221; between Microsoft and PKWare, because .NET framework now provides programmatic mean to do both zip and unzip, and .NET runtime is an optional &#8220;windows feature&#8221; that comes with installation media of Windows OS.</p>
<p>Also, IMO those companies selling archiving algorithm nowadays only care about the ability to create archive but not extracting archive. RARSoft was giving away the unrar library so that utility programs such as 7-Zip can extract RAR but not create RAR file. The allows the algorithm to reinforce its &#8220;industrial standard&#8221; status. I suspect if Microsoft just ask them if Microsoft is allowed to add code to extract AES encrypted ZIP files, it would be an easy okay.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1341335">
				<div id="div-comment-1341335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Giacomo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1341335">
			May 21, 2018 at 1:19 pm</a>		</div>

		<p>Why do you think it was PKWare?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-john-schroedl even depth-2" id="comment-1342745">
				<div id="div-comment-1342745" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/schroedl' rel='external nofollow' class='url'>schroedl</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1342745">
			May 25, 2018 at 6:00 am</a>		</div>

		<p>Use the Open XML SDK to do that instead: <a href="https://msdn.microsoft.com/en-us/library/office/bb448854.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/office/bb448854.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-raceprouk odd alt thread-odd thread-alt depth-1 parent" id="comment-1337125">
				<div id="div-comment-1337125" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/RaceProUK' rel='external nofollow' class='url'>RaceProUK</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337125">
			May 15, 2018 at 7:39 am</a>		</div>

		<p>Presumably, the ZIP code in .NET is independent of the ZIP code powering Compressed Folders. If this is the case, then why not re-implement Compressed Folders using the .NET implementation (converted to native if necessary)? That way, MS would then be able to extend support to include AES encryption and ZIP64, and also allow programmatic manipulation of ZIP files.</p>
<p>And yes, I realise I&#8217;ve asked a question that has likely been asked dozens of times already :)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1337135">
				<div id="div-comment-1337135" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337135">
			May 15, 2018 at 7:50 am</a>		</div>

		<p>I&#8217;m sure you and I weren&#8217;t the only ones with that thought. It&#8217;s not clear to me if Raymond is trying to say that the &#8220;terms of the license&#8221; actually prohibits Microsoft from implementing their own Zip shell extension (hopefully only until some specific future date), or whether it&#8217;s just prohibiting Microsoft from using this licensed shell extension for those purposes.</p>
<p>Companies get upset with Microsoft when they start including features in the OS that these companies had been selling (see when MS added a web browser and when they added anti-malware, just to name a couple), and beyond legal anti-trust concerns, there&#8217;s also just the business concerns of annoying companies which provide the software that makes it worthwhile for people to buy Windows. I&#8217;m sure they sometimes feel like they can&#8217;t win, where if they continue to not include some feature inside the core OS people aren&#8217;t happy, and if they do include it then also people aren&#8217;t happy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-koldude odd alt depth-2 parent" id="comment-1337145">
				<div id="div-comment-1337145" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337145">
			May 15, 2018 at 7:50 am</a>		</div>

		<p>As far as I can tell there are at least three different compression implementations in the windows codebase: IIS, .NET, and Compressed folders. I&#8217;m pretty sure that none of them share code either.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1337335">
				<div id="div-comment-1337335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://about.me/marek.knapek' rel='external nofollow' class='url'>Marek</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337335">
			May 15, 2018 at 11:51 am</a>		</div>

		<p>It could be more than three. There is zlib in Windows HTTP library (client, not server). I discovered it by accident by placing a break-point into inflateInit2 function and the debugger matched it in my binary and, to my surprise, inside webio.dll.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-koldude odd alt depth-4 parent" id="comment-1337665">
				<div id="div-comment-1337665" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337665">
			May 16, 2018 at 6:02 am</a>		</div>

		<p>All the more argument for having a single common OS maintained zlib.dll that everybody can share. I don&#8217;t think it would help compressed folders but it would allow for the rest of us to not have to duplicate functionality the OS can ship and patch.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1337685">
				<div id="div-comment-1337685" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337685">
			May 16, 2018 at 7:22 am</a>		</div>

		<p>As was mentioned, there are other things to spend development resources on.  Even if there ARE three different compression libraries in Windows, if they all work, there&#8217;s not a big incentive to refactor stuff that is working.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jan-ringos odd alt depth-5" id="comment-1337735">
				<div id="div-comment-1337735" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Jan+Ringo%C5%A1' rel='external nofollow' class='url'>Jan Ringoš</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337735">
			May 16, 2018 at 9:59 am</a>		</div>

		<p>There&#8217;s sqlite (winsqlite3.dll) in Windows 10, so that&#8217;s a start.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1337215">
				<div id="div-comment-1337215" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337215">
			May 15, 2018 at 8:59 am</a>		</div>

		<p>It&#8217;s likely another instance of the -100 point barrier. The existing UI and code work just fine for 90-some percent of cases, whereas using ZipFile would require someone to rewrite all the Explorer hooks, mimic the existing UI, and generally do a lot of drudge work for little to no gain. And like Raymond said, developer resources are limited.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt depth-2" id="comment-1337315">
				<div id="div-comment-1337315" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337315">
			May 15, 2018 at 11:43 am</a>		</div>

		<p>That implementation had its own problems, and they eventually switched to zlib I thinl.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1337155">
				<div id="div-comment-1337155" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337155">
			May 15, 2018 at 8:19 am</a>		</div>

		<p>A third-party to implement ZIP functionality, really?</p>
<p>When zip file parsing/generation can easily be implemented from scratch in a day by someone who knows nothing about it, and, as for compression, zlib existed since 1995 and I believe its license is permissive enough.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1337465">
				<div id="div-comment-1337465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mimon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337465">
			May 15, 2018 at 6:49 pm</a>		</div>

		<p>A component that is mostly independent and implementable from scratch by someone who knows nothing about it in a reasonable timeframe is a slam dunk candidate for a component to outsource when you are short on time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1342575">
				<div id="div-comment-1342575" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">zboot</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1342575">
			May 24, 2018 at 10:43 am</a>		</div>

		<p>And yet, nobody is out there getting rich implementing this and selling it to Windows users. . .</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1337175">
				<div id="div-comment-1337175" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Doubleday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337175">
			May 15, 2018 at 8:24 am</a>		</div>

		<p>I think one obvious answer to the customer would be, &#8220;why do you want this?&#8221; Because I&#8217;m pretty sure they just read about it in an in-flight magazine.</p>
<p>Compression algorithms in the shell are really nifty in theory, although I think much less useful than they were in 2000, because floppy disks are dead and bandwidth is exponentially better and, in fact, you can do compression on-the-fly on a decent network connection.</p>
<p>But encryption is a different animal.  If, for some reason, you wanted to encrypt a file/directory at one end, and decrypt it at the other &#8212; just pipe the zipped file through your choice of encryption algorithm (and back again at the other end).  And, of course, the more useful question is &#8220;which encryption algorithm do you, the sender, and your partner, the receiver, intend to use?&#8221;  It might be AES.  It might not.</p>
<p>I don&#8217;t even know that I&#8217;d budge the -100 point needle as much as a single digit on this one, were I a manager in charge of engineering resources.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1337935">
				<div id="div-comment-1337935" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337935">
			May 17, 2018 at 6:37 am</a>		</div>

		<p>Compression isn&#8217;t the only advantage to compressed archives. Since multiple files can be compressed into a single compressed archive, they&#8217;re a popular way to transfer or distribute files. For example, if you need to send someone a month&#8217;s worth of logs, you can individually send them one at a time, or you can package the whole logs folder up into a single ZIP and just send that one file.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1342115">
				<div id="div-comment-1342115" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Doubleday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1342115">
			May 23, 2018 at 8:47 am</a>		</div>

		<p>&#8220;&#8230;or you can package the whole logs folder up into a single ZIP and just send that one file.&#8221;</p>
<p>Indeed you can.  I should have made it clear that I&#8217;m talking about compressing <i>anything</i> &#8212; an entire disk if you want &#8212; not just files.</p>
<p>It&#8217;s important not to get fixated on the tool used for compression.   Compression does one thing and one thing well &#8212; it reduces the size of the source.  Encryption, on the other hand, does the opposite &#8212; if the entropy of the input equals the entropy of the output, well, it&#8217;s really not much of an encryption algorithm, is it?</p>
<p>You get basic encryption for free over the wire, these days.  I was puzzling over my favorite news feed, which for some reason is delivered over https, and then it occurred to me: why not? The extra bandwidth is not relevant, and who knows when that newsfeed might need encryption?</p>
<p>Think of it as a pipeline.  Source data -&gt; appropriate size for transmission -&gt; appropriate encoding -&gt; appropriate decoding -&gt; appropriate decompression -&gt; back to source data.</p>
<p>Separating the two steps (compression and encoding) doesn&#8217;t lose you much, if anything, in terms of comprehension, but it gives you as much flexibility as you <b>and the other end of the conversation</b> might need.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1338085">
				<div id="div-comment-1338085" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1338085">
			May 17, 2018 at 11:14 am</a>		</div>

		<p>Compression algorithms in the shell are more than just a way to save disk space, which yes, seems quaint in an era of TB-sized volumes.  They&#8217;re a convenient and nearly universally understood file packager.  It&#8217;s a lot easier to package a series of photos, for example, into a single Zip and send it off versus sending hundreds of separate files, even though the disk space savings is nil for an already-compressed format.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1337185">
				<div id="div-comment-1337185" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul Topping</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337185">
			May 15, 2018 at 8:45 am</a>		</div>

		<p>Sounds like a bad deal was made.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1337195">
				<div id="div-comment-1337195" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe D</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337195">
			May 15, 2018 at 8:50 am</a>		</div>

		<p>I really wish there was an option to disable Zip folders in explorer.  I wind up using registry hacks to remove them, but they keep getting re-enabled on random updates.</p>
<p>My issue is that it&#8217;s treating them like a directory when they are not.  So if I have a directory with a couple of dozen zip files in them, and I happen to open that directory in Explorer, it happily proceeds to expand the folder tree into all of the zip files.</p>
<p>I want my zip files to be treated as files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1337205">
				<div id="div-comment-1337205" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AberAber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337205">
			May 15, 2018 at 8:58 am</a>		</div>

		<p>At the least&#8230;it would be good if it didn&#8217;t just say &#8220;Unspecified Error&#8221;. for AES.  It&#8217;s really confusing, especially for those without ever having encountered this before.  If it just said something like &#8220;AES Encryption in Zip not supported natively in Windows, please download a Zip tool.&#8221; (well something that directed the user what to do)&#8230;it&#8217;d be easier to stomach Microsoft&#8217;s decision here.   I think there was something similar with DVD playback, where it allow for downloading from the Windows Store or something like that (may be remembering wrong), instead of just failing with unspecified error.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1337355">
				<div id="div-comment-1337355" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337355">
			May 15, 2018 at 12:29 pm</a>		</div>

		<p>Naturally, code written before the AES feature was introduced cannot have an error message talking about a feature that didn&#8217;t exist. As far as old code is concerned, the file appears to be corrupted.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1337385">
				<div id="div-comment-1337385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AberAber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337385">
			May 15, 2018 at 1:09 pm</a>		</div>

		<p>Knowing nothing about the way the Windows or Zip code works, I wonder if Microsoft could somehow pre-process the zip header themselves in new code (before using whatever licensed zip tool you have used and are locked in to), and notify about the AES error beforehand, avoiding some confusion.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-4 parent" id="comment-1337485">
				<div id="div-comment-1337485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337485">
			May 15, 2018 at 8:11 pm</a>		</div>

		<p>Just for you, I took a look at the code. It took a while even to find the part that checks the flags that would indicate AES. (Somebody didn&#8217;t believe in giving names to constants.) And I don&#8217;t know what sort of header preprocessing leads to automatic code generation that detects and reports AES.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5 parent" id="comment-1337675">
				<div id="div-comment-1337675" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337675">
			May 16, 2018 at 7:02 am</a>		</div>

		<p>I&#8217;m pretty sure he meant use the .NET code as a reference to write a new header parser to check if a file is AES.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-5" id="comment-1337825">
				<div id="div-comment-1337825" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337825">
			May 16, 2018 at 11:25 am</a>		</div>

		<p>I&#8217;m not going to throw out the old header parser and replace it with a new one inspired by the .NET version. That parser is almost certainly tightly-coupled to the rest of the code.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3 parent" id="comment-1337415">
				<div id="div-comment-1337415" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bystander</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337415">
			May 15, 2018 at 2:19 pm</a>		</div>

		<p>I feel like you can&#8217;t blame all deficiencies on old code, especially given MS resources.<br />
Yes, pre-AES code didn&#8217;t have a crystal ball and could not have a clear error message for a future feature.<br />
Maybe, ZIP is not high enough on the priority list to warrant assigning resources to support new features.</p>
<p>But in 15 years, you could have added some error handling and a helpful error message.<br />
The user experience is bad and you&#8217;re just making up excuses.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1337565">
				<div id="div-comment-1337565" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337565">
			May 15, 2018 at 10:14 pm</a>		</div>

		<p>In 15 years, I&#8217;ve not had a single ZIP file on any Windows machine that used AES encryption. So perhaps your case is an edge case, and Raymond isn&#8217;t making excuses for not implementing something that could cause bugs for the majority of users to satisfy a minority of users (who can probably figure out what the problem is themselves anyway).</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1338115">
				<div id="div-comment-1338115" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bystander</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1338115">
			May 17, 2018 at 1:19 pm</a>		</div>

		<p>Many people won&#8217;t try to open an AES-encrypted zip, ever. Good for you that you belong to this group.<br />
Turns out some of my customers have sent me a bunch of files by e-mail in a single AES-encrypted zip archive. I would say it&#8217;s a reasonable use-case if you&#8217;re going to transmit files by e-mail.</p>
<p>As Raymond himself mentionned before, when you have 200 millions customers, even a small percentage of them is a lot of people.<br />
I&#8217;m making up numbers, but if as few as 0.5% of users have seen an encrypted zip at least once, that would still be 1 million customers affected.</p>
<p>Turn it anyway you want but “Unspecified Error” is a terrible UX. That&#8217;s a fact.<br />
It could be &#8220;AES encryption is not supported&#8221; with relatively little resources and little risk for existing users. I have a hard time believing that making this change is that much of a deal for a behemoth like Microsoft. Raymond could say &#8220;we just don&#8217;t care&#8221;, but instead he&#8217;s making up excuses about the code being older than the feature&#8230; If he _wanted_ to do something about, he _could_.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1340855">
				<div id="div-comment-1340855" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1340855">
			May 18, 2018 at 10:07 am</a>		</div>

		<p>@bystander and Drak: if AES-encrypted Zip files were to somehow become as commonplace as unencrypted Zips, and if users were to run those files through the compressed Files feature, then I supposed that would move the needle on the -100 points deficit.  The feature set is limited to just the most common Zip file cases circa 2000, which are still the most common cases today.  I would reasonably expect that a user who receives Zip files with post-2000 encryption algorithms would have a separate tool to handle those files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fjeldse odd alt depth-5" id="comment-1340985">
				<div id="div-comment-1340985" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Erik+F' rel='external nofollow' class='url'>Erik F</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1340985">
			May 18, 2018 at 7:36 pm</a>		</div>

		<p>I believe that ZIP files are much less important as a transfer mechanism today than they were even a couple of years ago. I remember when most Web sites stored their downloadables as ZIP, RAR, or GZ files on an FTP server; now FTP servers as essentially gone on many sites and have been replaced with cloud storage or torrents (or some equivalent.) One of the first things that I used to do was install 7-Zip because I often encountered oddball archives; since 2010 or so, I haven&#8217;t bothered doing so and honestly rarely missed it. As for the new features that were added to the ZIP format this century, I think that, like CD-I and HD-DVD, most came too late to gain widespread adoption and other technologies filled the need: I certainly have never handled a ZIP file using any of the features except for ZIP64.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1337225">
				<div id="div-comment-1337225" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AberAber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337225">
			May 15, 2018 at 9:00 am</a>		</div>

		<p>Also, hasn&#8217;t 7zip and Gzip even, made big advances every year in zip compression since the year 2000?  It seems like there would be a benefit with much smaller files, maybe faster times, even without updating to AES, but just updating the zipping algorithm.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-2" id="comment-1337625">
				<div id="div-comment-1337625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337625">
			May 16, 2018 at 3:09 am</a>		</div>

		<p>System.IO.Compression.DeflateStream that added in .NETv2 was switched to use zlib instead of built-in deflate algorithm as of .NETv4.5 because of the same reason.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1337235">
				<div id="div-comment-1337235" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wayne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337235">
			May 15, 2018 at 9:57 am</a>		</div>

		<p>I wish there was a good way to turn off zip folders in Windows (a files and folder setting would be awesome).  The feature is confusing on it&#8217;s face (is it a file or is it a folder?) and typically causes more problems than it solves.  It used to be a simple matter of unregistering the zipfldr.dll COM component but it&#8217;s no longer that simple.  </p>
<p>If Microsoft isn&#8217;t going to update this feature (or make it user friendly) then they should at least allow us to turn it off.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1337245">
				<div id="div-comment-1337245" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://english.rejbrand.se' rel='external nofollow' class='url'>Andreas Rejbrand</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337245">
			May 15, 2018 at 10:23 am</a>		</div>

		<p>Native Zip support was one of the new features in Windows ME I enjoyed the most. No more need for WinZip and other nagware!</p>
<p>I have never felt restricted by the limited functionality of Windows&#8217; Zip support. Still, I do find it somewhat interesting that a lack of resources hinders the development of this (moderately advanced) feature, given the fact that Microsoft is one of the world&#8217;s largest companies. I suspect that the demand for improved Zip support is pretty low &#8212; maybe most users are as satisfied with the current functionality as I am.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1337725">
				<div id="div-comment-1337725" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337725">
			May 16, 2018 at 8:49 am</a>		</div>

		<p>There are some edge cases where the built-in zip functionality falls down badly.  The main one is large zip archives with lots of subfolders and files.  Use Windows to unzip, say, the Eclipse zip file, and it could take 10-15 minutes (even with an SSD, when you&#8217;re extracting from one physical drive to a different one!), whereas WinZip can do it in just a couple.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1337885">
				<div id="div-comment-1337885" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337885">
			May 16, 2018 at 10:47 pm</a>		</div>

		<p>It may be slow, but it does work. The majority of Windows users aren&#8217;t going to be unzipping huge files anyway, and if they do, the don&#8217;t have any expectation that it&#8217;s going to be quick.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao even thread-even depth-1 parent" id="comment-1337255">
				<div id="div-comment-1337255" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337255">
			May 15, 2018 at 10:29 am</a>		</div>

		<p>It dates back to Plus! for Windows 98 I think, and was also in Windows Me.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1337285">
				<div id="div-comment-1337285" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Osexpert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337285">
			May 15, 2018 at 10:54 am</a>		</div>

		<p>It had to be a different code: june 17, 2002 press release &#8220;We are very pleased to announce that Microsoft has chosen Inner Media&#8217;s DynaZip technology to provide the compression backbone for their Windows XP Compressed Folder features,&#8221; says Inner Media President, Neil Rosenberg. &#8220;</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mngoldeneagle even depth-3 parent" id="comment-1337985">
				<div id="div-comment-1337985" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337985">
			May 17, 2018 at 8:02 am</a>		</div>

		<p>That could just be a continuing engagement kind of announcement sort of thing.  It wouldn&#8217;t surprise me if Microsoft went back to the same vendor and said, &#8220;Hey, this needs to work against NT now.&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1343035">
				<div id="div-comment-1343035" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.helpwithwindows.com/dynazip.html' rel='external nofollow' class='url'>GP.Burth</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1343035">
			May 28, 2018 at 10:49 pm</a>		</div>

		<p>&#8220;Anybody who has worked with the Compressed Folders feature currently in Windows XP will know that DynaZip will probably be an improvement, as the Compressed Folders feature isn&#8217;t exactly a top performer. &#8221; &#8211; source linked in &#8220;Website&#8221;.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1337305">
				<div id="div-comment-1337305" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337305">
			May 15, 2018 at 11:37 am</a>		</div>

		<p>Honestly, the bits I hate about ZIP in Explorer are the weird arbitrary limitations in what you can do from the UI.<br />
 eg you can&#8217;t drag&#8217;n&#8217;drop move or copy from one compressed folder into another, or even open a file with a non-default handler.</p>
<p>Plus it grinds to an absolute halt when simply directory listing inside a ZIP that contains a thousand files. No excuse for that, given how ZIP works internally.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1337345">
				<div id="div-comment-1337345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">florian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337345">
			May 15, 2018 at 12:25 pm</a>		</div>

		<p>I&#8217;m always amazed with the Cabinet (.cab) compression format. It has good command line utilities, more than competitive compression ratios, and Windows built-in support for decompression. It&#8217;s a convenient solution to attach text or configuration files as compressed resources to executable files.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1337585">
				<div id="div-comment-1337585" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337585">
			May 15, 2018 at 11:42 pm</a>		</div>

		<p>There&#8217;s more!<br />
0. .CAB is Windows native archive format!<br />
1. the &#8220;Microsoft Update&#8221; files .MSU of Vista and newer versions are .CABs.<br />
2. the &#8220;Microsoft Installer&#8221; uses external .CABs, or .CABs embedded into .MSI and .MSP, and processes them without unpacking the .CABs to disk.<br />
3. the SetupAPI introduced with &#8217;95 can install directly from .CABs (<a href="https://msdn.microsoft.com/en-us/library//aa376957.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library//aa376957.aspx</a>); it can even run .INF scripts packaged in .CABs (<a href="https://msdn.microsoft.com/en-us/library/aa768006.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/aa768006.aspx</a>).</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mngoldeneagle odd alt depth-3 parent" id="comment-1337995">
				<div id="div-comment-1337995" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337995">
			May 17, 2018 at 8:04 am</a>		</div>

		<p>If it was made into a standard, it would be interesting to perform comparisons against the other major compression algorithms to see how well it fares.  But my guess is that Microsoft is happy keeping it internal instead of effectively &#8220;productizing&#8221; it.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1338105">
				<div id="div-comment-1338105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">florian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1338105">
			May 17, 2018 at 12:57 pm</a>		</div>

		<p>For everyday use, i.e. with a reasonable speed vs. archive size tradeoff, I&#8217;m absolutely happy with CAB (my &#8220;gut-feeling&#8221; is that the resulting archives are small enough).</p>
<p>There&#8217;s a nice zip utility [0] to produce standard zip-files even smaller than what&#8217;s possible with 7-Zip, but it&#8217;s taking much longer, so I&#8217;m using it only for automated tasks.</p>
<p>[0] <a href="http://www.advsys.net/ken/utils.htm" rel="nofollow">http://www.advsys.net/ken/utils.htm</a></p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1340935">
				<div id="div-comment-1340935" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1340935">
			May 18, 2018 at 2:08 pm</a>		</div>

		<p>.CAB archives of Windows executables are typically just half the size of .ZIP archives, sometimes <b>much less</b>,</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-4" id="comment-1340925">
				<div id="div-comment-1340925" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1340925">
			May 18, 2018 at 1:58 pm</a>		</div>

		<p>Which part of &#8220;it&#8217;s Windows native archive format&#8221;, i.e. the <b>standard</b> on Windows, is not understood?<br />
JFTR: Microsoft published the format specification <a href="https://msdn.microsoft.com/en-us/library/bb267310.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/bb267310.aspx</a> in the last millennium.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1337375">
				<div id="div-comment-1337375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337375">
			May 15, 2018 at 12:59 pm</a>		</div>

		<p>&#8220;Because adding features requires engineering resources, and engineering resources are limited&#8221; &#8211; I wish Microsoft didn&#8217;t waste so much of its resources on Windows Runtime and other such things that no one really wanted.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1337435">
				<div id="div-comment-1337435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337435">
			May 15, 2018 at 2:59 pm</a>		</div>

		<p>Ah, I experienced some of the unpleasantnesses involves with trying to use the Zip Folder extension programmatically. Including the fact that when you use the SHFileOperation trick to add a file, the adding will always be done asynchronously, with no non-kludgy way to wait for it (including that it doesn&#8217;t use SHGetInstanceExplorer() as explained in May 28, 2008 article: I know, I tried. &#8212; That said, I didn&#8217;t know these functions existed until I read that article, published 5+ years after Windows XP).</p>
<p>Somehow, learning at least some of those problems were intentional makes me both more and less angry about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1337445">
				<div id="div-comment-1337445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337445">
			May 15, 2018 at 3:38 pm</a>		</div>

		<p>Exactly why are engineering resources so limited, in a multi-billion dollar multi-national corporation? This excuse is one I&#8217;ve never understood.</p>
<p>My own company has three employees, we licenced the same zip code as Microsoft did, then we bought the source code, updated it to support things like Unicode filenames, and all is dandy. Took a few weeks.</p>
<p>Exactly how can your resources be this limited?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1337475">
				<div id="div-comment-1337475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337475">
			May 15, 2018 at 8:08 pm</a>		</div>

		<p>You probably don&#8217;t have to maintain a three-million file code base.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command odd alt depth-3 parent" id="comment-1337545">
				<div id="div-comment-1337545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337545">
			May 15, 2018 at 9:04 pm</a>		</div>

		<p>I have heard this excuse once too many. Yet, during Steve Ballmer time, Microsoft purchased other companies as if they were candy, rebranded their products, failed to gain traction, sold them to some other company and moved on. The ill-fated Expression Studio brand and the ForeFront brand were such examples. And don&#8217;t let me mention a certain very reputable European hardware manufacturer! Obviously, having to maintain a three-million codebase file has never been a problem.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1337775">
				<div id="div-comment-1337775" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Doubleday</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337775">
			May 16, 2018 at 10:43 am</a>		</div>

		<p>My own experience at Microsoft (take it as you will) is that you can make local changes quite easily.  Let&#8217;s say you want to change a logit analysis to a probabilistic analysis on the server &#8212; easy!  A few test gates to production, and you&#8217;re done.</p>
<p>Now, imagine Raymond&#8217;s scenario, which he underestimates.  Three million files is nothing at Microsoft.  Add in the customer dependencies and the versions and the different operating systems and ask yourself, would you really want to build AES back into that?</p>
<p>I think not.  Even if the product wasn&#8217;t licensed from somebody else, it would still be a -100 engineering points before you could come up with a good reason for doing it, rather than doing something rather more relevant to your customers.</p>
<p>On the plus side, from your point of view &#8230; this is why the world needs responsive three person software engineering companies that are responsive to the &lt; 100 small companies they deal with.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-koldude odd alt depth-5" id="comment-1337925">
				<div id="div-comment-1337925" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kantos' rel='external nofollow' class='url'>kantos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337925">
			May 17, 2018 at 5:53 am</a>		</div>

		<p>Honestly I&#8217;d want to combine all the windows compression libs into one anyway and use that for the shell as well. I&#8217;d know at some point the Google project zero folks are going to test this code and find things I don&#8217;t want to have to fix. So personally to me the question is: What&#8217;s the cost to switch to something fairly common and standard (zlib) vs what we have now and what&#8217;s the time cost if someone finds a vuln (which they will).</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-3" id="comment-1338095">
				<div id="div-comment-1338095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1338095">
			May 17, 2018 at 12:00 pm</a>		</div>

		<p>Per dollar of revenue I guarantee we maintain more code than you do!</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command odd alt thread-even depth-1 parent" id="comment-1337495">
				<div id="div-comment-1337495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337495">
			May 15, 2018 at 8:53 pm</a>		</div>

		<p>If that&#8217;s the case, Microsoft should have moved on to something free and open-source (like <b>7-zip</b>) a long time ago. This would have cut down royalty fees too.But since PowerShell can now compress and decompress ZIP operations, I can only assume the restricting license terms have expired.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1337555">
				<div id="div-comment-1337555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337555">
			May 15, 2018 at 10:06 pm</a>		</div>

		<p>The licensing terms are still in full force. What you see in .NET is an unrelated implementation which therefore not subject to the licensing terms that apply to the Compressed Folders implementation.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command odd alt depth-3 parent" id="comment-1337605">
				<div id="div-comment-1337605" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337605">
			May 16, 2018 at 1:08 am</a>		</div>

		<p>Seems like the matter is more complex than it appears from your post. The interesting this is, you seem to have written to clarify things.</p>
<p>Oh, well. I guess you can&#8217;t; NDA, anyone?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fjeldse even depth-4 parent" id="comment-1337765">
				<div id="div-comment-1337765" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Erik+F' rel='external nofollow' class='url'>Erik F</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337765">
			May 16, 2018 at 10:21 am</a>		</div>

		<p>It seems pretty clear to me: it does the minimum required for most people (which was deemed sufficient), and while Microsoft has the source code, and it&#8217;s not a codebase that anyone internally has any real knowledge of (i.e. it&#8217;s essentially a FCIB.) Making changes to it would be a massive pain, some of the extensions are patented (e.g. <a href="https://patents.google.com/patent/US7793099B2/en" rel="nofollow">https://patents.google.com/patent/US7793099B2/en</a>), and there are many, many alternatives that you can choose from to access ZIP files; this makes it unlikely as a candidate for updating, and rewriting a component that works fine in general seems silly!</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1337975">
				<div id="div-comment-1337975" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337975">
			May 17, 2018 at 7:28 am</a>		</div>

		<p>The code is a FirstCarribbean International Bank?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1340995">
				<div id="div-comment-1340995" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Allan Beatty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1340995">
			May 18, 2018 at 7:54 pm</a>		</div>

		<p>Foreign checked-in binary: <a href="https://blogs.msdn.microsoft.com/oldnewthing/20171114-00/?p=97396" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20171114-00/?p=97396</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-4" id="comment-1337905">
				<div id="div-comment-1337905" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Crowther</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337905">
			May 17, 2018 at 1:07 am</a>		</div>

		<p>I agree, it seems pretty straight forward to me. The ZIPed folders functionality in Windows is sufficient for the majority of users&#8217; purposes; there&#8217;s no compelling reason to do extensive changes which would soak up development resources for little benefit.</p>
<p>Anyone who needs extended functionality, like AES or better compression, would be better served just installing one of the third party options, most of which integrate in to the shell window anyway (we standardised on using 7-zip at work ages ago).</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1337645">
				<div id="div-comment-1337645" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Erkin Alp Güney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337645">
			May 16, 2018 at 4:12 am</a>		</div>

		<p>Why did you not consider replacing it by an opensource library having a suitable feature set, then?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1337835">
				<div id="div-comment-1337835" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337835">
			May 16, 2018 at 11:27 am</a>		</div>

		<p>The interface to the library would be different, which means changing all the places where the existing code interacts with the library. (Oh sorry, you have different handle lifetime policies? And you encode locations in the ZIP file differently? Too bad we persisted that in the IDLIST, so now we have to add a translation layer that can take old IDLISTs and convert the locations into the new library&#8217;s format.)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1343015">
				<div id="div-comment-1343015" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert Hall</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1343015">
			May 28, 2018 at 7:08 pm</a>		</div>

		<p>When will you learn? No, you *don&#8217;t* keep such backwards compatibility, because that will make the whole OS irrelevant in the OS market when more of your development resources are spent keeping old stuff working instead of developing new stuff that more people want. A good opportunity to break backwards compat is for example each time when the hardware architecture are changing, like going to x86-64 (b/c then applications have to be recompiled anyway). You missed that opportunity, please don&#8217;t miss the next.</p>
<p>Also, as you probably know, the compression library that you licensed have had security issues because the infamous supplier stopped patching your library years ago. Please move to zlib instead, it&#8217;s free, it&#8217;s faster, supports encryption, and you&#8217;re already using it in other ms products, etc, etc. You&#8217;re really just making up excuses.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-deskrule odd alt thread-even depth-1" id="comment-1337655">
				<div id="div-comment-1337655" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/deskrule' rel='external nofollow' class='url'>deskrule</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337655">
			May 16, 2018 at 4:56 am</a>		</div>

		<p>here&#8217;s a NSE (should work for windows explorer too) that does most archive types, including zip/7z/rar. Read-only at present<br />
<a href="http://zabkat.com/blog/compressed-folder-shell-extension.htm" rel="nofollow">http://zabkat.com/blog/compressed-folder-shell-extension.htm</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aegis03 even thread-odd thread-alt depth-1 parent" id="comment-1337815">
				<div id="div-comment-1337815" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/dmex' rel='external nofollow' class='url'>dmex</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337815">
			May 16, 2018 at 11:23 am</a>		</div>

		<p>Raymond,</p>
<p>Windows 10 includes the open-source libarchive library by default (system32/archiveint.dll) and that library supports tar, pax, cpio, zip, xar, lha, ar, cab, mtree, rar, gzip, bzip2, lzip, xz, lzma etc&#8230; and even includes support for&#8230; encrypted zip archives! :)</p>
<p>The shell should deprecate support for &#8220;zip folders&#8221; and instead support &#8220;archives&#8221; considering the licence terms for &#8220;zip folders&#8221; are detrimental to the security of end-users while also preventing development of a modern shell experience with multi-archive support.</p>
<p>The libarchive library (in your words) is an &#8220;unrelated implementation which therefore not subject to the licensing terms that apply to the Compressed Folders implementation&#8221;&#8230; and it&#8217;s already included on Windows 10. Why doesn&#8217;t the shell make use of it and add multi-archive support to Explorer?</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1337895">
				<div id="div-comment-1337895" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337895">
			May 16, 2018 at 10:50 pm</a>		</div>

		<p>Because 99% of the users are not impacted by this issue, and the other 1% know how to install and use 7zip?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even depth-2" id="comment-1338135">
				<div id="div-comment-1338135" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1338135">
			May 17, 2018 at 6:51 pm</a>		</div>

		<p>&#8220;archiveint.dll&#8221; does not exists on my Win10 x64 system at home. I suspect that it comes from WSL that&#8217;s currently for Insider only.</p>
<p><a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="nofollow">https://docs.microsoft.com/en-us/windows/wsl/install-win10</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1337955">
				<div id="div-comment-1337955" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1337955">
			May 17, 2018 at 6:51 am</a>		</div>

		<p>The story of compressed files in Windows is a good example of how shortsighted management and careless corner-cutting can end up creating more work for everyone in the long run. The ZIP support in Windows Explorer has been left to stagnate because management didn&#8217;t want to spend resources on maintaining it or building their own&#8230;but in the end, full ZIP support had to be implemented at least twice more elsewhere in the Microsoft codebases, and the Explorer implementation couldn&#8217;t be reused for that due to the limited featureset and restrictive license terms. An outsourcing decision that seemed like a labor-saver at the time ended up creating more work for Microsoft as a whole than if they&#8217;d just developed their own non-encumbered library in the first place and reused the code (or at least the expertise) across products.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1341575">
				<div id="div-comment-1341575" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BobbySalsa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1341575">
			May 22, 2018 at 4:07 am</a>		</div>

		<p>Great post, as always, Raymond.</p>
<p>&#8220;Since its release in Windows XP, Zip folders has not been actively developed. The reason is the usual: Because adding features requires engineering resources, and engineering resources are limited. Furthermore, since the compression and decompression code weren&#8217;t written by anybody from Microsoft, there is no expertise in the code base, which means that debugging and making changes is a very difficult undertaking. &#8221;</p>
<p>Has there ever been a reported security vulnerability regarding Zip Folders in Windows? I presume the limited expertise in this code base would make fixing them more difficult. </p>
<p>Besides Pinball and ZIP folders, how many other parts of Windows are like this? :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1341935">
				<div id="div-comment-1341935" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marijn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1341935">
			May 22, 2018 at 11:11 pm</a>		</div>

		<p>Did the old Win7 image preview application have special knowledge about zip files? It could show the previous/next image in those, while its Win10 counterpart cannot.</p>
<p>However seemingly from <a href="https://answers.microsoft.com/en-us/windows/forum/windows_10-files-winpc/windows-photo-viewer-cant-navigate-to-prevnext/b82ab5ac-a310-4a44-9d13-3db9dc95dc0e" rel="nofollow">https://answers.microsoft.com/en-us/windows/forum/windows_10-files-winpc/windows-photo-viewer-cant-navigate-to-prevnext/b82ab5ac-a310-4a44-9d13-3db9dc95dc0e</a> this functionality doesn&#8217;t always work on Win7 either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1342765">
				<div id="div-comment-1342765" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Seva Alekseyev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180515-00/?p=98755#comment-1342765">
			May 25, 2018 at 9:23 am</a>		</div>

		<p>For the record, ZIP shell folders *are* programmable. Scriptable, even. Create a COM object &#8220;Shell.Application&#8221;, then call Namespace(), passing the ZIP name.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>