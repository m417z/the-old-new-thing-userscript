<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (8)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-724293">
				<div id="div-comment-724293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724293">
			April 6, 2009 at 10:42 am</a>		</div>

		<p>I don&#8217;t follow. &nbsp;First you say that the treeview works as expected, implying that there is no bug. &nbsp;Then you start talking about a bug in the treeview. &nbsp;I think you are trying to say that the bug is only present in older versions of the library, but that point wasn&#8217;t made 100% clear. &nbsp;In that case, the issue is that the older version of the library is getting loaded in his application; then he could use the manifest or CCM_SETVERSION approach to get the fixed behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-724323">
				<div id="div-comment-724323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pinky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724323">
			April 6, 2009 at 11:49 am</a>		</div>

		<blockquote><p>
  Update: I slipped a subtlety into this article which &nbsp;&gt; it appears people didn&#8217;t pick up on, so I&#8217;ll make it &gt; explicit.
</p></blockquote>
<p>Sorry for not writing a comment, it&#8217;s spring time on my Gregorian calendar, that large plasmatoid sphere is radiating an overdoses of UV waves so in short it&#8217;s epic hot. I, for one, rather relocate back to an ancient natural environment in order to absorb the scent of a phenomenon strange to many programmers called &quot;flowers&quot; (which don&#8217;t have anything to do with engineering either).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-724353">
				<div id="div-comment-724353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriveA</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724353">
			April 6, 2009 at 1:20 pm</a>		</div>

		<p>But if you poll for the TVIS_BOLD value, you&#8217;ll get the right behavior 50% of the time. &nbsp;And the other 50% of the time the backward compatibilty of chopping off the text will come into play. &nbsp;So half the time you&#8217;ll make a quarter of the people happy, and the other half of the time you&#8217;ll make the other quarter of the people happy.</p>
<p>In the end, everyone is happy except the half who don&#8217;t have properly implemented treeview drivers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-724393">
				<div id="div-comment-724393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pepkaro@hotmail.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724393">
			April 6, 2009 at 2:16 pm</a>		</div>

		<p>Interesting side note: This behavior exists even in windows forms. &nbsp;Changing from regular text to bold cuts off the text. &nbsp;Guess even Microsoft&#8217;s own developers fall to this one. &nbsp;:)</p>
<p>(FYI: a fix for the forms TreeView is to have every node start bold, and then REMOVE the bold for ones that shouldn&#8217;t have it.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-724483">
				<div id="div-comment-724483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jeff-yeary.info' rel='external nofollow' class='url'>Jeffery Yeary</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724483">
			April 7, 2009 at 12:03 am</a>		</div>

		<p>Does Microsoft document which programs were the drivers behind which compatibility decisions? Is there some master database that says for the treeview these programs rely on the previous behavior on how a width of the treeview item is calculated?</p>
<div class=post>[<i>No such master database devoted solely to compatibility decisions. They&#8217;re mixed in with all the other decisions. And a lot of these decisions are made without a specific target in mind. Because if there&#8217;s an undocumented behavior that could be relied upon, odds are pretty good that somebody <u>does</u> rely on it. I mean, look at all the people who rely on Explorer&#8217;s private listview data! -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-724523">
				<div id="div-comment-724523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeffrey L. Whitledge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724523">
			April 7, 2009 at 8:32 am</a>		</div>

		<p>&quot;I elided error checking for expository purposes.&quot;</p>
<p>That&#8217;s the exact text that appears in all my method headers!</p>
<p>(j/k of course.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-724703">
				<div id="div-comment-724703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724703">
			April 8, 2009 at 2:24 am</a>		</div>

		<p>Hey Pepkaro&#8230; Mea culpa.</p>
<p>Yep, I wrote the first version of the code that lets you change the styles of treeview items in the Winforms framework.</p>
<p>And yep, it was busted. At the time, shipping a custom version of Comctl for .NET wasn&#8217;t an option. (IIRC, .NET 2.0 fixed that &#8211; but I&#8217;d moved on by then). If it had been an option, you can bet that I&#8217;d have gone in there and fixed vertical tabs too. (The code which calculated the space on the tab for the text was wrong in some combinations of vertical alignment and left/right side&#8230; and it was a rats nest in there). Which is why (IIRC), Vertical tabs aren&#8217;t allowed in .NET 1.0.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-724723">
				<div id="div-comment-724723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">peterchen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090406-00/?p=18623#comment-724723">
			April 8, 2009 at 5:42 am</a>		</div>

		<p>Explorer has private listview data? *MUST* *NOT* *INVESTIGATE* </p>
<p>;)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>