<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (4)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-233413">
				<div id="div-comment-233413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.loadngo.biz/content.aspx' rel='external nofollow' class='url'>Jay Lauffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041208-00/?p=37093#comment-233413">
			December 8, 2004 at 8:27 am</a>		</div>

		<p>Ahh now this is a gem.</p>
<p>However after doing some additional reading I find myself confused by MSDN documentation (and no this isn&#8217;t the first time).</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_programming/transferring/clipboard.asp?frame=true" rel="nofollow">http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_programming/transferring/clipboard.asp?frame=true</a></p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;</p>
<p>The CFSTR_PERFORMEDDROPEFFECT format identifier was intended to allow the target to indicate to the data object what operation actually took place. However, the Shell uses optimized moves for file system objects whenever possible. In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted. Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place. While most sources do not need this information, there are some exceptions. For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied. </p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<p>Of course that claims to be for Version 5..</p>
<p>a little below we then get some more documentation which fails to clarify anything</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<p>CFSTR_PERFORMEDDROPEFFECT</p>
<p>This format identifier is used by the target to inform the data object through its IDataObject::SetData method of the outcome of a data transfer. The data is an STGMEDIUM structure that contains a global memory object. The structure&#8217;s hGlobal member points to a DWORD set to the appropriate DROPEFFECT value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY. </p>
<p>This format is normally used when the outcome of an operation can be either move or copy, such as in anoptimized move or delete-on-paste operation. It provides a reliable way for the target to tell the data object what actually happened. It was introduced because the value of pdwEffect returned by DoDragDrop did not reliably indicate which operation had taken place. The CFSTR_PERFORMEDDROPEFFECT format is the reliable way to indicate that an unoptimized move has taken place. </p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<p>So should I use CFSTR_LOGICALPERFORMEDDROPEFFECT or CFSTR_PERFORMEDDROPEFFECT ?  After all I think it&#8217;s pretty safe to assume that people all have IE 5?  Or maybe not (maybe assumptions are never safe, like assuming people will have enough sense to recognize bad coding practices as simple conveniences for demonstrative purposes)?  Perhaps I should be doing DllGetVersion on the Shell dll?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-233433">
				<div id="div-comment-233433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jemnery</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041208-00/?p=37093#comment-233433">
			December 8, 2004 at 8:49 am</a>		</div>

		<p>I can&#8217;t believe you hard-coded the strings in the MessageBox() call. This example needs a full local-language independant implementation.</p>
<p>;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-233443">
				<div id="div-comment-233443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nikos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041208-00/?p=37093#comment-233443">
			December 8, 2004 at 8:57 am</a>		</div>

		<p>i hope there&#8217;s a series #4 in drag-drop lectures that explains what happens when IAsyncOperation gets into the picture<br />
<br />thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-233563">
				<div id="div-comment-233563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J&#246;rgen Sigvardsson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041208-00/?p=37093#comment-233563">
			December 8, 2004 at 3:43 pm</a>		</div>

		<blockquote><p>
  I can&#8217;t believe you hard-coded the strings in the MessageBox() call. This example needs a full local-language independant implementation.</p>
<p>At least the grumpiest of them all won&#8217;t be able to complain about unicode correctness. ;)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>