<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (35)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-219863">
				<div id="div-comment-219863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Black Hat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219863">
			October 21, 2004 at 8:04 am</a>		</div>

		<p>Windows Scripting is great &#8211; you can send an email containing  a script, and have it send itself out to everyone in the recipients&#8217;s address book. Plus it has everyhing you need for install a &quot;remote admin&quot; kit at the recipient &#8211; e.g. Filesystem and Registry access. And if you want to just nuke the machine, you can find out enough to do that without getting caught. Can you get access for to the sockets for DDos attacks? That&#8217;s the only feature missing IMO.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219873">
				<div id="div-comment-219873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219873">
			October 21, 2004 at 8:14 am</a>		</div>

		<p>Just like binary exe&#8217;s then!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219883">
				<div id="div-comment-219883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Charlie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219883">
			October 21, 2004 at 8:20 am</a>		</div>

		<p>The fact that I can use a screwdriver to severely injure anyone I can get within arm&#8217;s reach of does not lessen its usefulness as a scewdriver.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219903">
				<div id="div-comment-219903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219903">
			October 21, 2004 at 8:56 am</a>		</div>

		<p>I think the real issue is: where is Raymond vacationing this time?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219913">
				<div id="div-comment-219913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219913">
			October 21, 2004 at 9:01 am</a>		</div>

		<p>Please don&#8217;t feed the troll.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219933">
				<div id="div-comment-219933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Cash</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219933">
			October 21, 2004 at 9:09 am</a>		</div>

		<p>Tim Golden wrote a module to wrap this. It also needs Mark Hammond&#8217;s Win32 extension module.</p>
<p><a target="_new" href="http://tgolden.sc.sabren.com/python/wmi.html" rel="nofollow">http://tgolden.sc.sabren.com/python/wmi.html</a></p>
<p>There&#8217;s a nifty list of examples at:<br />
<br /><a target="_new" href="http://tgolden.sc.sabren.com/python/wmi_cookbook.html" rel="nofollow">http://tgolden.sc.sabren.com/python/wmi_cookbook.html</a></p>
<p>I stumbled on this when I was trying to enumerate the TCP/IP interfaces for a Windows Box.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219943">
				<div id="div-comment-219943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ramblings.aaronballman.com' rel='external nofollow' class='url'>Aaron Ballman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219943">
			October 21, 2004 at 9:14 am</a>		</div>

		<p>If you wish to enumerate the network interfaces, you can just use GetNetworkParams, GetAdaptersInfo and GetNumverOfInterfaces  from iphlpapi.dll.  It&#8217;s pretty straight forward to use and works like a charm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219953">
				<div id="div-comment-219953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219953">
			October 21, 2004 at 9:24 am</a>		</div>

		<p>Brian &#8211; I think our troll is just jealous because his favorite OS has nothing like it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219963">
				<div id="div-comment-219963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219963">
			October 21, 2004 at 9:37 am</a>		</div>

		<p>I would venture that the troll&#8217;s favorite OS does have the ability to query all that stuff, but it&#8217;s just not packaged the same way. Not running a script embedded in an email by default could be argued to be a deliberate design system.</p>
<p>Oh, and to troll a bit on my own, I went looking on msdn, but I couldn&#8217;t for the life of me find out how to run a service in a chroot jail.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-219973">
				<div id="div-comment-219973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weatherley.net' rel='external nofollow' class='url'>JamesW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219973">
			October 21, 2004 at 10:17 am</a>		</div>

		<p>My favourite OS can query that stuff and with rather less typing:</p>
<p>Welcome to Darwin!<br />
<br />james$ sysctl hw<br />
<br />hw.ncpu: 2<br />
<br />hw.byteorder: 4321<br />
<br />hw.memsize: 1073741824<br />
<br />hw.activecpu: 2<br />
<br />hw.cputype: 18<br />
<br />hw.cpusubtype: 11<br />
<br />hw.pagesize: 4096<br />
<br />hw.busfrequency: 166635063<br />
<br />hw.busfrequency_min: 166635063<br />
<br />hw.busfrequency_max: 166635063<br />
<br />hw.cpufrequency: 999999996<br />
<br />hw.cpufrequency_min: 999999996<br />
<br />hw.cpufrequency_max: 999999996<br />
<br />hw.cachelinesize: 32<br />
<br />hw.l1icachesize: 32768<br />
<br />hw.l1dcachesize: 32768<br />
<br />hw.l2cachesize: 262144<br />
<br />hw.l3cachesize: 1048576<br />
<br />hw.tbfrequency: 41656341<br />
<br />hw.optional.floatingpoint: 1<br />
<br />hw.optional.altivec: 1<br />
<br />hw.optional.graphicsops: 1<br />
<br />hw.optional.stfiwx: 1<br />
<br />hw.optional.dcba: 0<br />
<br />hw.optional.datastreams: 1<br />
<br />james$ </p>
<p>Not trolling but it just seems like more work than it needs to be. The SQL style query is cute though!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-219993">
				<div id="div-comment-219993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://disphelper.sourceforge.net/' rel='external nofollow' class='url'>xtmouse</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-219993">
			October 21, 2004 at 10:35 am</a>		</div>

		<blockquote><p>
  &gt;  My favourite OS can query that stuff and with rather less typing: &lt;&lt;</p>
<p>The console program to retrieve system information on Windows XP is &quot;systeminfo&quot;.</p>
<p>[plug]</p>
<p>If one wants a relatively easy way of using WMI in C/C++ you check out DispHelper:<br />
  <br /><a target="_new" href="http://disphelper.sourceforge.net/" rel="nofollow">http://disphelper.sourceforge.net/</a></p>
<p>Several WMI samples are included:<br />
  <br />C++: <a target="_new" href="http://cvs.sourceforge.net/viewcvs.py/disphelper/disphelper/samples_cpp/wmi.cpp?view=markup" rel="nofollow">http://cvs.sourceforge.net/viewcvs.py/disphelper/disphelper/samples_cpp/wmi.cpp?view=markup</a><br />
  <br />C: <a target="_new" href="http://cvs.sourceforge.net/viewcvs.py/disphelper/disphelper/samples_c/wmi.c?view=markup" rel="nofollow">http://cvs.sourceforge.net/viewcvs.py/disphelper/disphelper/samples_c/wmi.c?view=markup</a></p>
<p>[/plug]<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220023">
				<div id="div-comment-220023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220023">
			October 21, 2004 at 11:30 am</a>		</div>

		<p>WMI is a great way of getting data that has been available for 5 to 10 years via SMBIOS or Win32 APIs like GlobalMemoryStatus(Ex). And it can be called from scripts which is a good thing. But it still can&#8217;t tell me the temperature of my CPU, or how fast the fans are running, or the power supply voltages, or a lot of other configuration data. I really wish Microsoft would lock the hardware guys in a room at WinHEC and not let them out until they&#8217;d agreed to expose that information in a standard way.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220033">
				<div id="div-comment-220033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220033">
			October 21, 2004 at 12:00 pm</a>		</div>

		<p>Hey, I&#8217;ve got an idea &#8211; we could make a fake filesystem, where all the info is structured as a bunch of files. You could query the info by typing the file and set parameters by echoing data to the right files. We could give it a friendly name, too. Let&#8217;s call it the proc: drive ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220073">
				<div id="div-comment-220073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://disphelper.sourceforge.net' rel='external nofollow' class='url'>xtmouse</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220073">
			October 21, 2004 at 12:42 pm</a>		</div>

		<blockquote><p>
  &gt; I really wish Microsoft would lock the hardware guys in a room at WinHEC and not let them out until they&#8217;d agreed to expose that information in a standard way. &lt;&lt;</p>
<p>You mean, like Win32_TemperatureProbe, Win32_Fan, CIM_Tachometer or Win32_VoltageProbe?</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/computer_system_hardware_classes.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/computer_system_hardware_classes.asp</a><br />
  <br /><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/cimclas.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/cimclas.asp</a></p>
<p>Don&#8217;t get too excited. At least on my machine, most of these seem not to be implemented. Try it on your machine.</p>
<p>[VBScript]<br />
  <br />Set wmi = GetObject(&quot;winmgmts:{impersonationLevel=impersonate}!&#46;rootcimv2&quot;)<br />
  <br />Set colProbes = wmi.ExecQuery(&quot;Select * From Win32_TemperatureProbe&quot;)</p>
<p>MsgBox colProbes.Count &#8216; Zero on my machine</p>
<p>For Each probe in colProbes<br />
  <br />    MsgBox probe.Caption &amp; probe.CurrentReading<br />
  <br />Next<br />
  <br />[/VBScript]<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220093">
				<div id="div-comment-220093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220093">
			October 21, 2004 at 1:00 pm</a>		</div>

		<p>&quot;I really wish Microsoft would lock the hardware guys in a room at WinHEC and not let them out until they&#8217;d agreed to expose that information in a standard way.&quot;</p>
<p>Maybe the Linux folks could take the lead here and do this at the next Linux hardware conference?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220113">
				<div id="div-comment-220113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gene Cash</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220113">
			October 21, 2004 at 1:52 pm</a>		</div>

		<blockquote><p>
  Maybe the Linux folks could take the lead here and do this at the next Linux hardware conference? </p>
<p>Yeah, but we don&#8217;t have as big a baseball bat&#8230; besides MSFT is supposed to be the big bully anyway!! &lt;grin&gt;</p>
<p>Seriously though, the newer (&lt;1 yr old) hardware is doing a much better job of this, especially laptops.</p>
<p>Heck, on my old Compaq laptop, even Windows can&#8217;t figure out the battery/APM info unless you&#8217;re running the &quot;speeshial&quot; version of Windows for that laptop, and in that case you&#8217;re stuck with Windows 95.</p>
<p>The hardware guys that REALLY need a beatin&#8217; are ATI &amp; nVidia&#8230; don&#8217;t even get me started about video drivers.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220123">
				<div id="div-comment-220123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Maas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220123">
			October 21, 2004 at 3:33 pm</a>		</div>

		<p>Video drivers are so complicated these days I prefer to treat them as black boxes that either &quot;work&quot; or &quot;don&#8217;t work.&quot;</p>
<p>Don&#8217;t complain about Linux. We can&#8217;t threaten a hardware manufacturer that their products won&#8217;t be supported by Linux, they don&#8217;t care. Whereas MS carries more weight. (check out the recent video by Alan Cox discussing debugging techniques; they traced a very rare crash to a problem in a certain ATA disk; the disk manufacturer didn&#8217;t listen until MS approached them much later about the exact same problem)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220143">
				<div id="div-comment-220143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.developer-x.com' rel='external nofollow' class='url'>tim scarfe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220143">
			October 21, 2004 at 4:26 pm</a>		</div>

		<p>I read the tweakomatic documentation some months ago. it really is hillarious you should all check it out:</p>
<p><a target="_new" href="http://www.microsoft.com/technet/scriptcenter/tools/twkmatic.mspx" rel="nofollow">http://www.microsoft.com/technet/scriptcenter/tools/twkmatic.mspx</a></p>
<p>Quotes follow:</p>
<p>&quot;Ok, fine, we admit it. Tweakomatic does not do everything TweakUI does. Is that because the Scripting Guys are a bunch of lazy good-for-nothings who couldn’t take their eyes off the TV long enough to add a couple more features to Tweakomatic? In the words of Homer Simpson, Oh, no, no, no, no, no. Well, yes.&quot;</p>
<p>[&#8230;]</p>
<p>Tweakomatic is Fully Guaranteed and Supported, Right?</p>
<p>Hey, let’s be serious. This thing is called Tweakomatic. Can you imagine this scenario:</p>
<p>“Microsoft Product Support. How may I help you?”</p>
<p>“Uh, yes, I seem to be having some problems with my Tweakomatic.”</p>
<p>[&#8230;]</p>
<p>&quot;You want to know the sordid truth about the TweakUI team? Well, actually, we don’t know anything at all about the TweakUI team (although we sure hope they have a sense of humor). So in order to make our point, we’ll make something up instead.</p>
<p>The truth is, the TweakUI team has the cushiest job on the planet. These guys spend all their time at the baccarat tables in Monte Carlo. Every couple years or so, Microsoft releases a new version of Windows, and these guys drain the last of their martinis, stumble out of the casino, hammer out a new version of TweakUI, and then head back to the gaming tables.&quot;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220153">
				<div id="div-comment-220153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220153">
			October 21, 2004 at 5:39 pm</a>		</div>

		<p>Win32_Processor is not available on Windows 95, Windows 98 and Windows ME &#8211; which is what about half of our customers still run :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220163">
				<div id="div-comment-220163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://andyandy.sprayblogg.no' rel='external nofollow' class='url'>Andreas H&#228;ber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220163">
			October 21, 2004 at 6:00 pm</a>		</div>

		<p>Cooney: About that fake filesystem, check out Monad over at <a target="_new" href="http://channel9.msdn.com/ShowPost.aspx?PostID=25531" rel="nofollow">http://channel9.msdn.com/ShowPost.aspx?PostID=25531</a>. Now, look very carefully at the providers (like filesystems, registry etc.) ;)</p>
<p>&quot;I really wish Microsoft would lock the hardware guys in a room at WinHEC and not let them out until they&#8217;d agreed to expose that information in a standard way.&quot;<br />
<br />Seems like they already did that, but your computer needs to support that standard. Check out <a target="_new" href="http://www.dmtf.org/standards/wbem/" rel="nofollow">http://www.dmtf.org/standards/wbem/</a>, which is what WMI implements. I know Dell ships an addon for exposing such information, maybe you can find something like that for your computer as well?</p>
<p>Btw. Haven&#8217;t tested this yet, but seems like there is an implementation of WBEM for Linux and other operating systems too. See <a target="_new" href="http://www.openwbem.org/" rel="nofollow">http://www.openwbem.org/</a>. Anyone here who knows more about it?</p>
<p>Finally, a nice quote from the WBEM FAQ of their goal with it: &quot;The ultimate objective is to provide customers with the ability to manage all systems, regardless of their instrumentation type, using a common standard.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220183">
				<div id="div-comment-220183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220183">
			October 21, 2004 at 8:38 pm</a>		</div>

		<p>Andreas: I&#8217;ll check that clip out.</p>
<p>Raymond, why are you posting? I thought you were off on vacation. Can&#8217;t you designate a deputy?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220193">
				<div id="div-comment-220193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220193">
			October 21, 2004 at 8:41 pm</a>		</div>

		<p>James, the SQL queries IS the feature of WMI. For example to get an info about a running process you just run &quot;SELECT * FROM Win32_Process WHERE Name='&lt;process name&gt;&#8217;&quot;, instead of looking up the PID and then looking up all the information scattered around the system API (which is what you have to do in Win9x and other, non-win systems).</p>
<p>Strangely, I wasn&#8217;t able to use other properties in the WHERE clause, only Name worked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220203">
				<div id="div-comment-220203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://andyandy.sprayblogg.no' rel='external nofollow' class='url'>Andreas Haeber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220203">
			October 21, 2004 at 9:42 pm</a>		</div>

		<p>Another nice thing to know about is wmic.exe (on Windows XP, maybe other versions of Windows as well?), which let&#8217;s you execute queries without having to write a script or something similar.</p>
<p>See some info about wmic.exe at Don Box&#8217;s old blog <a target="_new" href="http://www.gotdotnet.com/team/dbox/default.aspx?key=2004-09-27T12:15:40Z" rel="nofollow">http://www.gotdotnet.com/team/dbox/default.aspx?key=2004-09-27T12:15:40Z</a>.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220243">
				<div id="div-comment-220243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">oic</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220243">
			October 21, 2004 at 11:22 pm</a>		</div>

		<p>&quot;The fact that I can use a screwdriver to severely injure anyone I can get within arm&#8217;s reach of does not lessen its usefulness as a scewdriver.&quot;</p>
<p>Of course, but the fact that you can use other people&#8217;s screwdrivers to cause harm to other people is a bit of a problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220253">
				<div id="div-comment-220253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://arundotphilipatpatnidotcom' rel='external nofollow' class='url'>Arun Philip</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220253">
			October 21, 2004 at 11:39 pm</a>		</div>

		<p>I agree that the information at <a target="_new" href="http://www.microsoft.com/technet/scriptcenter/tools/twkmatic.mspx" rel="nofollow">http://www.microsoft.com/technet/scriptcenter/tools/twkmatic.mspx</a> is very well presented.  I used to consider WMI as one of the &quot;don&#8217;t touch&quot; items in Windows, now I&#8217;m thinking of using it to automate some monitoring related activities.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220273">
				<div id="div-comment-220273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220273">
			October 22, 2004 at 2:32 am</a>		</div>

		<p>Jerry &#8211; the SQL stuff does look a nice way of doing things. Having a single port of call for extracting all sorts of information rather than a whole bunch of API calls sounds good to me. (As does Linux&#8217;s procfs and BSD&#8217;s sysctl namespace ;) ) </p>
<p>I had a look to see how far back WMI is supported and was pleasantly surprised to see that MSDN says that WMI is available as a download for 9x so it looks like they can play along too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220303">
				<div id="div-comment-220303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220303">
			October 22, 2004 at 6:25 am</a>		</div>

		<p>&quot;Don&#8217;t get too excited. At least on my machine, most of these seem not to be implemented. Try it on your machine. &quot;</p>
<p>Believe me, I&#8217;ve tried it on dozens of systems. Those WMI classes are defined, yes, but they don&#8217;t give meaningful data.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220433">
				<div id="div-comment-220433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim Martin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220433">
			October 22, 2004 at 1:28 pm</a>		</div>

		<p>Incidentally, almost all of the information in msinfo32 can be found in the WMI schema. So things you see there can be retrieved using a script and WMI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220363">
				<div id="div-comment-220363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Farley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220363">
			October 22, 2004 at 8:46 am</a>		</div>

		<p>&gt;&gt; If you wish to enumerate the network interfaces&#8230;</p>
<p>Those network interface APIs mentioned above are a good example of one reason I try to avoid using WMI when possible.  WMI is implemented as a Service, and that service can be turned off. </p>
<p>The Win32 APIs in question cannot be turned off.  So if you absolutely require some piece of configuration information for your program to operate properly, I recommend trying to find a straight Win32 API to get it before going to WMI.</p>
<p>That having been said, WMI is a great resource.  There are also some things you can do with it that you *can&#8217;t* easily do with Win32 APIs, like retrieve Event Log messages from a remote machine *asynchronously* as they occur.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-220793">
				<div id="div-comment-220793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Schatz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220793">
			October 25, 2004 at 1:13 pm</a>		</div>

		<p>watch out for WMI though, it sometimes doesn&#8217;t tell the truth even when the method claims to be implemented on a particular system. Try comparing the values stored in Win32_CPU with the values in HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor\0&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-220943">
				<div id="div-comment-220943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.gwyncole.com' rel='external nofollow' class='url'>Gwyn Cole</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-220943">
			October 26, 2004 at 7:10 am</a>		</div>

		<p>One sure way of determining where a WMI provider gets its information from is through the MappingStrings qualifier.</p>
<p>I&#8217;ve just checked through a number of properties on the Win32_Processor management class against what&#8217;s in the registry. Many of the properties don&#8217;t seem to have documented where the provider gets its values from which is unfortunate. It worth noting that many of the Microsoft management classes have made good use of the MappingStrings qualifier! Just not this class by the looks of it&#8230;</p>
<p>If you&#8217;re unfamiliar about the MappingStrings qualifier, then check this link (<a target="_new" href="http://www.wbem.co.uk/articles/MappingStrings.pdf" rel="nofollow">http://www.wbem.co.uk/articles/MappingStrings.pdf</a>) which is a couple of pages I wrote a while ago&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-221393">
				<div id="div-comment-221393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Bremner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-221393">
			October 28, 2004 at 2:40 am</a>		</div>

		<p>WMI looks neat, but AFAICS the information can&#8217;t be accessed from other platforms. So we&#8217;re using NRPE for NT. It would be nice if there was a version that ran over HTTP, as specified in the standard.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-221743">
				<div id="div-comment-221743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-221743">
			October 29, 2004 at 9:26 am</a>		</div>

		<p>Cooney: &quot;Hey, I&#8217;ve got an idea &#8211; we could make a fake filesystem, where all the info is structured as a bunch of files. You could query the info by typing the file and set parameters by echoing data to the right files. We could give it a friendly name, too. Let&#8217;s call it the proc: drive ;)&quot;</p>
<p>Isn&#8217;t that the way *nix works? ;) Everything is a file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224183">
				<div id="div-comment-224183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ToddM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-224183">
			November 10, 2004 at 11:38 am</a>		</div>

		<p>Any chance this is broken?</p>
<p>I have a bunch of C# code that calls System.Management classes, and I noticed today that none of it is working; I get various exceptions.</p>
<p>So, in hunting down the problem, I found this blog entry.  Sure enough, I cannot get this piece of WSH code to run, either.</p>
<p>My main suspects are XP SP2 and .NET Framework 1.1 SP1.  Is anyone else having a similar problem?  Or have I simply &#8216;broken&#8217; WMI on my machine somehow?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-226393">
				<div id="div-comment-226393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Application information</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041021-00/?p=37513#comment-226393">
			November 16, 2004 at 9:37 am</a>		</div>

		<p>I was once told that very detailed information is in WMI including numbers of words typed and total applicaiton run time for apps like office but I can not find it.  Is there a way that you can dump tons of info from WMI.  I looked through the MOF file but could find nothing</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>