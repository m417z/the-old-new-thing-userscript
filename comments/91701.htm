<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (6)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1" id="comment-1206621">
				<div id="div-comment-1206621" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150831-00/?p=91701#comment-1206621">
			August 31, 2015 at 7:47 am</a>		</div>

		<p>The super-weenies method is ugly (IMHO), requires inventing/naming a type and might waste a couple of bytes but I still appreciate you adding it to your post.</p>
<p>I&#39;m not a fan of callbacks that lack a caller defined void* parameter but I guess it does not matter when using fancy pants c++11. I&#39;m sure the Windows team already knows this because the few enum functions in Win95 that lacked the parameter got a Ex version later on&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1206601">
				<div id="div-comment-1206601" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pmbAustin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150831-00/?p=91701#comment-1206601">
			August 31, 2015 at 8:27 am</a>		</div>

		<p>So, I have a related question on this topic that has always irked me. &nbsp;I had a &quot;remembered network drive mapping&quot; to a share on a USB drive. &nbsp;The USB drive died suddenly. &nbsp;I could find no way through the Windows UI anywhere to make it &quot;forget&quot; that mapping&#8230; it insisted that it couldn&#39;t forget it unless it could access it first. &nbsp;Chicken-and-egg problem. &nbsp;I don&#39;t even remember how I managed to get it to finally forget it (I think I managed to get the drive limping along just long enough to plug it in and forget the mapping before it crapped out again). &nbsp;Very frustrating. &nbsp;Surely I&#39;m missing something?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1206591">
				<div id="div-comment-1206591" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150831-00/?p=91701#comment-1206591">
			August 31, 2015 at 9:05 am</a>		</div>

		<p>There is a memory leak in the sample; the unique_ptr to the buffer should be templated on an array of NETRESOURCE structs:</p>
<p>std::unique_ptr&lt;NETRESOURCE&gt; buffer(new NETRESOURCE[elements]);</p>
<p>should be:</p>
<p>std::unique_ptr&lt;NETRESOURCE[]&gt; buffer(new NETRESOURCE[elements]);</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1206551">
				<div id="div-comment-1206551" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150831-00/?p=91701#comment-1206551">
			August 31, 2015 at 10:36 pm</a>		</div>

		<p>@pmbAustin: have a look at fsmgmt.msc!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1206471">
				<div id="div-comment-1206471" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150831-00/?p=91701#comment-1206471">
			September 1, 2015 at 12:13 pm</a>		</div>

		<p>I just reported this via Windows Feedback, but disconnected drives in Windows 10 have a bug. &nbsp;If a disconnected network connection is associated with a drive letter, and you mount an .iso file, the .iso file might be assigned the same drive letter. &nbsp;This confuses Explorer &#8211; it shows Disconnect instead of Eject on the context menu, and Disconnect does nothing. &nbsp;Unless you know Windows well enough to use alternate means, you can&#39;t unmount the .iso.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1206441">
				<div id="div-comment-1206441" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150831-00/?p=91701#comment-1206441">
			September 1, 2015 at 7:37 pm</a>		</div>

		<p>Woo hoo! &#8211; famous for a day. &nbsp;Well an hour. &nbsp;Ten minutes at least. :-)</p>
<p>Plus the code will be useful. &nbsp;Thanks. &nbsp;(Though I&#39;m embarrassed to realize that if I&#39;d just thought to look up the documentation for the function you were using in the linked post, I&#39;d have figured it out myself!)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>