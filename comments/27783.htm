<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (30)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-478773">
				<div id="div-comment-478773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joel Python</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478773">
			March 2, 2007 at 10:22 am</a>		</div>

		<p>Only on Windows would you be able to set desktop wallpaper for a system account!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478783">
				<div id="div-comment-478783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Crowell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478783">
			March 2, 2007 at 10:28 am</a>		</div>

		<p>@Joel</p>
<p>What&#8217;s the problem with that? &nbsp;You will need admin rights to do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478793">
				<div id="div-comment-478793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joel Python</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478793">
			March 2, 2007 at 10:43 am</a>		</div>

		<p>The point is &#8211; why would a system account need desktop wallpaper? It&#8217;s not like the system has eyes that it can use to look at it!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478803">
				<div id="div-comment-478803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478803">
			March 2, 2007 at 10:51 am</a>		</div>

		<p>So, Joel, you are advocating special-casing the system to make sure that unnecessary settings don&#8217;t get used by one particular user?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478813">
				<div id="div-comment-478813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478813">
			March 2, 2007 at 10:54 am</a>		</div>

		<p>Setting the wallpaper for the system account is useful because that&#8217;s what is displayed when nobody is logged on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478833">
				<div id="div-comment-478833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.gdwnet.com' rel='external nofollow' class='url'>Gary Williams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478833">
			March 2, 2007 at 10:55 am</a>		</div>

		<p>I think the process for Vista involves some hackery with Windows PE but I&#8217;m still working out the exact steps myself.</p>
<p>Is having a .DEFAULT profile something of a security risk? could something be loaded into .DEFAULT that runs whenever an application runs as local system?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478843">
				<div id="div-comment-478843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478843">
			March 2, 2007 at 11:03 am</a>		</div>

		<p>&quot;Is having a .DEFAULT profile something of a security risk? could something be loaded into .DEFAULT that runs whenever an application runs as local system?&quot;</p>
<p>Don&#8217;t you need admin rights to change HKEY_USERS? &nbsp;If that&#8217;s the case, you can probably do something a little more malicious than changing a registry setting in .DEFAULT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478863">
				<div id="div-comment-478863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joel Python</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478863">
			March 2, 2007 at 11:48 am</a>		</div>

		<p>James, were your remarks directed at me?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478883">
				<div id="div-comment-478883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.brick-labs.com/' rel='external nofollow' class='url'>Eric D. Burdo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478883">
			March 2, 2007 at 11:58 am</a>		</div>

		<p>Slightly off topic&#8230; but why is it called a &quot;hive&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478903">
				<div id="div-comment-478903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joel Python</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478903">
			March 2, 2007 at 12:04 pm</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478913">
				<div id="div-comment-478913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478913">
			March 2, 2007 at 12:04 pm</a>		</div>

		<p>Eric D Burdo: See <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-478923">
				<div id="div-comment-478923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478923">
			March 2, 2007 at 12:04 pm</a>		</div>

		<p>Eric Burdo: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478933">
				<div id="div-comment-478933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478933">
			March 2, 2007 at 12:10 pm</a>		</div>

		<p>Eric: First hit on a google search for &quot;why is it called a hive&quot;:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/08/08/54618.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478963">
				<div id="div-comment-478963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Watkins</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478963">
			March 2, 2007 at 1:01 pm</a>		</div>

		<p>[url=<a rel="nofollow" target="_new" href="http://www.pandora-security.com/forum/viewtopic.php?t=2093" rel="nofollow">http://www.pandora-security.com/forum/viewtopic.php?t=2093</a>]Used to be possible[/url], but I think it has since been locked down by a hotfix last time I tried it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479033">
				<div id="div-comment-479033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479033">
			March 2, 2007 at 3:50 pm</a>		</div>

		<p>[The resealing process propagates the current user&#8217;s settings to the template user (or, more specifically, the ones that can safely be propagated to the template user—you don&#8217;t want to propagate things like encryption keys) before &#8220;resealing&#8221; the system for deployment.]</p>
<p>I&#8217;m curious about this now. Normally to customize the default user when I&#8217;m creating an image for one of our labs, I follow the steps found here: <a href="http://support.microsoft.com/kb/319974" target=_new rel=nofollow rel="nofollow">http://support.microsoft.com/kb/319974</a></p>
<p>Does that take care of safe propagation as well? I always thought it just copied all the profile files into the specified directory. In fact, I used to know somebody who just did that manually, saying I wasted my time using the Copy To dialog.</p>
<div class=post>[<i>I was not aware that &#8220;Copy Profile&#8221; cleans the profile a la reseal. Maybe it does, maybe it doesn&#8217;t. I do know that people who do raw profile copying run into problems like &#8220;Why does Bob&#8217;s documents show up as &#8216;Carol&#8217;s Documents&#8217;?&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479053">
				<div id="div-comment-479053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479053">
			March 2, 2007 at 4:30 pm</a>		</div>

		<p>[I do know that people who do raw profile copying run into problems like &quot;Why does Bob&#8217;s documents show up as &#8216;Carol&#8217;s Documents&#8217;?&quot;]</p>
<p>Ah, that has bitten me once or twice. &nbsp;I now make sure and check for the Desktop.ini file that changes the folder name from &quot;My Music&quot; to &quot;Administrator&#8217;s Music&quot;. &nbsp;That section is supposed to be deleted when the file is copied, but it doesn&#8217;t happen with the Copy To dialog. (<a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/321281" rel="nofollow">http://support.microsoft.com/kb/321281</a>)</p>
<p>Getting off-topic, but I assume the [DeleteOnCopy] section of the ini file is removed by the shell when the file is copied, but if you use something like CopyFile(), the section is not removed? That sounds like it may be the cause behind KB321281.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478853">
				<div id="div-comment-478853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478853">
			March 2, 2007 at 11:28 am</a>		</div>

		<p>The .Default account&#8217;s wallpaper (and screensaver) is used behind the login screen if nobody has logged in to the computer. Most companies use this, as they can set it to their corporate logo (and an appropriate screensaver) for computers that are just idling for whatever reason. It looks really slick in a computer lab of 30 computers all waiting for users to log in to have a wallpaper for your school instead of the default XP wallpaper.</p>
<p>I&#8217;m sure Linux has the same feature, it&#8217;s just about 20,000 times more complicated than going into TweakUI, clicking Logon, then Settings.</p>
<p>Next time try actually *using* Windows before criticizing it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-478873">
				<div id="div-comment-478873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478873">
			March 2, 2007 at 11:50 am</a>		</div>

		<p>&gt; which is kept in the file %ALLUSERSPROFILE%ntuser.dat. </p>
<p>*braces for nitpicking accusation*</p>
<p>That should say &quot;Default Userntuser.dat&quot;. There is no %ALLUSERSPROFILE%ntuser.dat file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478943">
				<div id="div-comment-478943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Starfish</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-478943">
			March 2, 2007 at 12:10 pm</a>		</div>

		<p>&gt; I&#8217;m sure Linux has the same feature, it&#8217;s just about 20,000 times more complicated than going into TweakUI, clicking Logon, then Settings.</p>
<p>&gt; </p>
<p>&gt; Next time try actually *using* Windows before criticizing it.</p>
<p>Pot&#8230;kettle&#8230;anyone? (Ironic since you need to *install* TweakUI on Windows &#8211; KDE and Gnome come with options to do it already!)</p>
<p>Random thought: wouldn&#8217;t it be odd if Local System was like any other user and could be logged in as? Or maybe it is possible, useless as it is&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479013">
				<div id="div-comment-479013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479013">
			March 2, 2007 at 3:22 pm</a>		</div>

		<p>&quot;(Ironic since you need to *install* TweakUI on Windows &#8211; KDE and Gnome come with options to do it already!)&quot;</p>
<p>IIRC TweakUI is a Powertoy and unsupported anyways. Reread the article where the supported way of dealing with this is described. Probably sucks only for companies changing logos all the time :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479133">
				<div id="div-comment-479133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479133">
			March 3, 2007 at 2:37 pm</a>		</div>

		<p>&#8212;-&quot;than going into TweakUI, clicking Logon, then Settings.&quot;&#8212;-</p>
<p>In my version of Tweak UI there is no settings button on the logon tab. Presumably you need to check you have the correct version of Tweak installed first. Gets more complicated by the minute!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479163">
				<div id="div-comment-479163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.lesliebowman.net/' rel='external nofollow' class='url'>Les Bowman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479163">
			March 4, 2007 at 4:31 pm</a>		</div>

		<p>I just make my own custom registry modifications for the Default User template. I&#8217;ll set the power settings, kill the welcome screen, check &quot;Empty Internet Explorer Temp Files on close&quot; and all sorts of other stuff. Export those keys to a .reg file, edit the .reg file and change the path in the registry key to something like HKUDefUser save the .reg and then load the hive of the default user using the name I specified in the modified registry file, import the reg file and then unload the hive. You pretty much have to do this for images, other wise people will complain that the NumLock key isn&#8217;t on or worse I can&#8217;t delete old profiles remotely because the TempInet folders have path&amp;file names too long to delete.</p>
<p>&lt;a href=&quot;<a rel="nofollow" target="_new" href="http://www.computerpowersaver.com/PM_Win2k_Whitepaper.pdf&quot;&gt;This" rel="nofollow">http://www.computerpowersaver.com/PM_Win2k_Whitepaper.pdf&quot;&gt;This</a> link&lt;/a&gt; has a good overview of the process and is a good place to start. From there you&#8217;ve just got to find the registry keys for you edit. Keep in mind some things like the XP Tour/Firewall have to be turned off in the local group policy and with Win2K you have to load/unload hives in RegEdt32.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479193">
				<div id="div-comment-479193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479193">
			March 4, 2007 at 10:06 pm</a>		</div>

		<p>Friday, March 02, 2007 11:03 AM by J</p>
<p>[Gary Williams:]</p>
<blockquote><p>
  &gt; Is having a .DEFAULT profile something of a</p>
<p>  &gt; security risk? could something be loaded</p>
<p>  &gt; into .DEFAULT that runs whenever an</p>
<p>  &gt; application runs as local system?&quot;
</p></blockquote>
<p>></p>
<blockquote><p>
  Don&#8217;t you need admin rights to change</p>
<p>  HKEY_USERS? &nbsp;If that&#8217;s the case, you can</p>
<p>  probably do something a little more malicious</p>
<p>  than changing a registry setting in .DEFAULT.
</p></blockquote>
<p>All true, but there are reasons why writers of some kinds of malware prefer to do things like loading their app in the local system account. &nbsp;If they install something like a spam server, they want it to be camouflaged so it will continue operating for a long time before being discovered.</p>
<p>Meanwhile, how many apps would break if the local system account&#8217;s name were changed from .Default to .LocalSystem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479203">
				<div id="div-comment-479203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Melvin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479203">
			March 4, 2007 at 11:14 pm</a>		</div>

		<blockquote><p>
  The .Default account&#8217;s wallpaper (and &gt;screensaver) is used behind the login screen if &gt;nobody has logged in to the computer. Most &gt;companies use this, as they can set it to their &gt;corporate logo (and an appropriate screensaver) &gt;for computers that are just idling for whatever &gt;reason.
</p></blockquote>
<p>And more helpfully when you&#8217;ve got a 16 port hot key KVM you can tell which server it&#8217;s set to before initiating the logon process by incorporating the server name into the default wallpaper.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-479743">
				<div id="div-comment-479743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">1</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-479743">
			March 6, 2007 at 5:31 am</a>		</div>

		<p>windows = single user os.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-480573">
				<div id="div-comment-480573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-480573">
			March 9, 2007 at 8:30 am</a>		</div>

		<p>This is the way I use to customize user account during Windows install:</p>
<p>in $OEM$ folder make a file CMDLINES.TXT with the following:</p>
<p>&#8212;snip&#8212;</p>
<p>[COMMANDS]</p>
<p>&quot;REGEDIT /S TWEAKUSR.REG&quot;</p>
<p>&quot;USERACCT.CMD&quot;</p>
<p>&#8212;snip&#8212;</p>
<p>Obviously TWEAKUSR.REG should contain all user customizations.</p>
<p>USERACCT.CMD should also be in $OEM$ and contain the following:</p>
<p>&#8212;snip&#8212;</p>
<p>NET USER &lt;your_username&gt; &lt;your_password&gt; /ADD</p>
<p>NET LOCALGROUP Administrators &lt;your_username&gt; /ADD</p>
<p>&#8212;snip&#8212;</p>
<p>While you are at it, why not enable auto logon if you are doing it for the home computer? Create a file AUTOLOG.REG in $OEM$ folder with the following content:</p>
<p>&#8212;snip&#8212;</p>
<p>Windows Registry Editor Version 5.00</p>
<p>[HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindows NTCurrentVersionWinlogon]</p>
<p>&quot;DefaultUserName&quot;=&quot;&lt;your_username&gt;&quot;</p>
<p>&quot;DefaultPassword&quot;=&quot;&lt;your_password&gt;&quot;</p>
<p>&quot;AutoAdminLogon&quot;=&quot;1&quot;</p>
<p>&#8212;snip&#8212;</p>
<p>Then just add &quot;REGEDIT /S AUTOLOG.REG&quot; to CMDLINES.TXT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kjkhyperion even thread-even depth-1" id="comment-480663">
				<div id="div-comment-480663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-480663">
			March 9, 2007 at 11:37 am</a>		</div>

		<p>.Default is named like that because it&#8217;s the fallback key advapi32.dll uses for HKEY_CURRENT_USER when it cannot open the HKEY_USERS&lt;user&#8217;s SID&gt; key</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-482213">
				<div id="div-comment-482213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gripper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-482213">
			March 14, 2007 at 4:08 pm</a>		</div>

		<p>Actually,</p>
<p>Sysprep has its limits updating the Default user template.</p>
<p>Working with a huge OEM customer, I ran bug-a-boo issue where sysprep doesn&#8217;t migrate all the owner settings to the default user template after reseal. Actually it was such a huge issue, my X-mas vacation was cut short and I flew out to Austin to investigate first hand.</p>
<p>This specifically effected a few Registry keyed Windows Installer components &#8211; the behavior was noted that after reseal and after OOBE, the MSI keyed registry components didn&#8217;t exist, and an MSI repair was triggered.</p>
<p>This was fixed by creating an install action that directly updated the Default User template NTUSERS.DAT file.</p>
<p>So even sysprep seems to have its limits&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-546913">
				<div id="div-comment-546913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/mshneer/archive/2007/09/04/deploying-your-vsto-add-in-to-all-users-part-i.aspx' rel='external nofollow' class='url'>Misha Shneerson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-546913">
			September 4, 2007 at 9:08 pm</a>		</div>

		<p>VSTO Add-Ins aka Managed Office Add-Ins have a major deficiency on the deployment side. Putting it simple,</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-711913">
				<div id="div-comment-711913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://www.mcseboard.de/windows-forum-allgemein-28/registry-profis-148269.html#post912954' rel='external nofollow' class='url'>XP - An die Registry Profis - MCSEboard.de MCSE Forum</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070302-00/?p=27783#comment-711913">
			February 26, 2009 at 2:46 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="https://www.mcseboard.de/windows-forum-allgemein-28/registry-profis-148269.html#post912954" rel="nofollow">https://www.mcseboard.de/windows-forum-allgemein-28/registry-profis-148269.html#post912954</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>