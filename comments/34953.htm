<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (5)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-290323">
				<div id="div-comment-290323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Seth McCarus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050713-12/?p=34953#comment-290323">
			July 13, 2005 at 10:58 am</a>		</div>

		<p>Since this will probably rise to the top of Google&#8217;s results concerning list-view custom draw, let me add that on a dialog, you can&#8217;t just return CDRF_NOTIFYITEMDRAW, due to the way dialog procs work (as Raymond has discussed elsewhere).</p>
<p>Instead, set the return value in the dialog using SetWindowLongPtr and DWL_MSGRESULT, as in the following snippet:</p>
<p>switch (lvcd-&gt;nmcd.dwDrawStage)<br />
<br />{<br />
<br />  case CDDS_PREPAINT:<br />
<br />    SetWindowLongPtr(hwnd, DWL_MSGRESULT, CDRF_NOTIFYITEMDRAW);<br />
<br />    return TRUE;</p>
<p>  //&#8230;<br />
<br />}<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-290333">
				<div id="div-comment-290333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">binaryc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050713-12/?p=34953#comment-290333">
			July 13, 2005 at 11:18 am</a>		</div>

		<p>Why use CONTAINING_RECORD rather than a cast?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-290343">
				<div id="div-comment-290343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050713-12/?p=34953#comment-290343">
			July 13, 2005 at 1:07 pm</a>		</div>

		<p>The NMHDR structure&#8217;s base address is the same as the containing NMLVCUSTOMDRAW structure&#8217;s base address (NMHDR is the first member of the first member of the NMLVCUSTOMDRAW), so you can cast it directly, in this case.</p>
<p>But only in this case, and not if Microsoft changes one of the structures in the future (though that would break every existing program that uses them, so it likely won&#8217;t happen).  Still, IMO it&#8217;s a bit cleaner.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-290353">
				<div id="div-comment-290353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Dunn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050713-12/?p=34953#comment-290353">
			July 13, 2005 at 3:16 pm</a>		</div>

		<p>NMHDR and the related NMxxx structs were designed to be castable, no? Sort of like a simple version of inheritance that&#8217;s usable from C?</p>
<p>Shameless plug for my own list view custom draw article: <a rel="nofollow" target="_new" href="http://www.codeproject.com/listctrl/lvcustomdraw.asp" rel="nofollow">http://www.codeproject.com/listctrl/lvcustomdraw.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-306653">
				<div id="div-comment-306653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/09/16/468800.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050713-12/?p=34953#comment-306653">
			September 16, 2005 at 10:00 am</a>		</div>

		<p>Changing the font on a column-by-column basis.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>