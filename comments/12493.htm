<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-868283">
				<div id="div-comment-868283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WndSucks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868283">
			October 20, 2010 at 8:47 am</a>		</div>

		<p>&quot;The width of an icon always equals its height&quot; ( <a target="_new" href="http://msdn.microsoft.com/en-us/library/bb761850%28v=VS.85%29.aspx#IExtractIcon::Extract" rel="nofollow">msdn.microsoft.com/&#8230;/bb761850%28v=VS.85%29.aspx</a> ) so why check both? Or does that only apply to the shell? (I understand that the icon format will allow you to create icons with w!=h but I assume such a thing would break shell display or something)</p>
<div class="post">[<i>Good job reading text <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/06/07/10020654.aspx" rel="nofollow">out of context</a>. The width of an icon <span style="text-decoration:underline;">generated by the IExtractIcon::Extract method</span> always equals its height. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868303">
				<div id="div-comment-868303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868303">
			October 20, 2010 at 8:59 am</a>		</div>

		<p>@WndSucks</p>
<p>I think that&#39;s just a restriction of that specific function. &nbsp;Some other functions might also make the same assumption, but there are icons out there with non-square dimensions, and at least in some situations they work. I distinctly remember that CGA mode on Windows 3.0 used 32&#215;16 icons (CGA full colour mode resolution is something like 320&#215;120, so pixels are a long way from square). &nbsp;But I installed a shell replacement that didn&#39;t understand the idea of non-square icons, and just displayed half of each, so the problem has been around at least that long.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-868313">
				<div id="div-comment-868313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gab</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868313">
			October 20, 2010 at 9:24 am</a>		</div>

		<p>Jules: CGA modes were 320&#215;200 (4 colors) and 640&#215;200 (2 colors).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868333">
				<div id="div-comment-868333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868333">
			October 20, 2010 at 10:13 am</a>		</div>

		<p>I know that this week mostly concerns icons (and the PNG icons haven&#39;t been covered yet), but the layout of the .ani format might be intersting is as well. (My guess would be that it might just be an icon with multiple icons in the same file, a hostsport / hotspot per frame and possibly some animation parameters such as delay between frames)</p>
<p>(If it is a multiple icon icon file, it would also be interesting to see what happens if someone messes it up &#8211; by adding icons of different size and color depths and formats&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-868343">
				<div id="div-comment-868343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868343">
			October 20, 2010 at 10:19 am</a>		</div>

		<p>Speaking of IExtractIcon and icon sizes &#8211; IExtractIcon::Extract lets you specify the size, however it most often returns S_FALSE, which means &quot;don&#39;t bother me, call ExtractIcon&quot;. But ExtractIcon (and ExtractIconEx) doesn&#39;t have a size parameter! How do I get an icon of arbitrary size from IExtractIcon?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868373">
				<div id="div-comment-868373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868373">
			October 20, 2010 at 12:38 pm</a>		</div>

		<p>It&#39;s great you made deleting the bitmap objects explicit, as that&#39;s often overlooked with this function. &nbsp;Thanks for the info.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-868393">
				<div id="div-comment-868393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JonPotter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868393">
			October 20, 2010 at 2:15 pm</a>		</div>

		<p>It&#39;s always seemed ridiculously inefficient to me to have to call a function that creates two bitmaps, just to get the dimensions that would already be known internally anyway. Couldn&#39;t a GetIconSize() function have been added at some point?</p>
<div class="post">[<i>Yes, that strikes me as odd too. Where&#39;s my time machine? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868403">
				<div id="div-comment-868403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JonPotter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868403">
			October 20, 2010 at 2:38 pm</a>		</div>

		<p>Windows 8 is still in the future &#8211; how &#39;bout it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-868293">
				<div id="div-comment-868293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868293">
			October 20, 2010 at 8:59 am</a>		</div>

		<p>It *is* possible to create icons where width != height. I remember an old version of the ImagEdit allowed to create 32&#215;16 monochrome icons.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868433">
				<div id="div-comment-868433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868433">
			October 21, 2010 at 12:22 am</a>		</div>

		<p>You&#39;ll have to wait for windows 9 until GetIconSize is implemented.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcohn even thread-even depth-1" id="comment-868443">
				<div id="div-comment-868443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868443">
			October 21, 2010 at 1:33 am</a>		</div>

		<p>I found icons with width!=height extremely useful, because using icon was the only way to embed 32-bit (that is, with 8-bit alpha channel) image resource. Paint.NET has a wonderful plugin that allows to save an .ico file with arbitrary collection of images.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868453">
				<div id="div-comment-868453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868453">
			October 21, 2010 at 5:16 am</a>		</div>

		<p>CGALOGO.RLE will give you an idea of the aspect ratio of the CGA monochrome mode. If you can still find software capable of reading it, of course&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-868483">
				<div id="div-comment-868483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868483">
			October 21, 2010 at 8:33 am</a>		</div>

		<p>@alexcohn &#8211; I am using 32-bit bitmap resources just fine. Are you sure they don&#39;t work for you? I am using Visual Studio 2008 and my code runs on Vista+, so maybe on older compiler or OS there are problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-868583">
				<div id="div-comment-868583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101020-00/?p=12493#comment-868583">
			October 21, 2010 at 12:06 pm</a>		</div>

		<p>I know this is WAY off topic (and a bit late), but anyway:</p>
<p>The &quot;Header Annotations&quot; documentation you link to above says the following:</p>
<p>__nullnullterminated : The buffer may be accessed up to and including the first sequence of two null characters or pointers.</p>
<p>But as you have blogged about a single   is a valid (empty) double-null-terminated strings. Does this mean that:</p>
<p>a) That annotation must not be used for double-null-terminated strings or</p>
<p>b) it is valid for double-null-terminated strings but the documentation is not quite correct in this regard?</p>
<div class="post">[<i>Take what you learned from that earlier blog entry and apply it to this situation. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>