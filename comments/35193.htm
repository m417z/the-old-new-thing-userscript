<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (22)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-287113">
				<div id="div-comment-287113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287113">
			June 27, 2005 at 2:53 pm</a>		</div>

		<p>Here&#8217;s a weird piece of behaviour that I encountered again today. If you&#8217;re running a debugging session between Visual Studio .NET 2003, and a Pocket PC device, which has a partnership with your computer (i.e. not connected as Guest), Explorer&#8217;s DDE stops working. Any DDE conversations that Explorer starts &#8211; for example, to open a document using DDE &#8211; hang, including hanging the Explorer window, until you stop debugging.</p>
<p>In this particular case the application &#8211; TextPad from <a href="http://www.textpad.com" rel="nofollow">http://www.textpad.com</a> &#8211; wasn&#8217;t running, but I&#8217;m pretty sure it&#8217;s been an issue before when the app was already running.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287123">
				<div id="div-comment-287123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287123">
			June 27, 2005 at 2:56 pm</a>		</div>

		<p>Is there a better way than broadcasts to push system settings changes? I remember you pushing for their use in the &quot;don&#8217;t hack the registry&quot; articles, but I&#8217;m not sure if you&#8217;re saying there&#8217;s something else better now or just another &quot;it&#8217;s this way because of some ancient design&quot;. Hrm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-287143">
				<div id="div-comment-287143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KaiArnold</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287143">
			June 27, 2005 at 4:50 pm</a>		</div>

		<blockquote><p>
  &gt;Is there a better way than broadcasts to push system settings changes?</p>
<p>Anything you need to alert all programs to will ultimately be a broadcast of some sort.  I suppose if it&#8217;s just an asynchronous notification, i.e. return value not required immediately or at all, broadcasts could be done with PostMessage instead of SendMessage, and the issue would go away.  In fact, isn&#8217;t DDE all asynchronous anyway?  Why is Send used instead of PostMessage?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287153">
				<div id="div-comment-287153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">msemack</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287153">
			June 27, 2005 at 5:06 pm</a>		</div>

		<p>&quot;In this particular case the application &#8211; TextPad from <a href="http://www.textpad.com" rel="nofollow">http://www.textpad.com</a> &#8211; wasn&#8217;t running, but I&#8217;m pretty sure it&#8217;s been an issue before when the app was already running. &quot;</p>
<p>Ah-ha!  That&#8217;s what it is!</p>
<p>I&#8217;d been having problems with launching TextPad via associated files at home.  I wouldn&#8217;t have a problem if I launched TextPad and then opened the file.  I made the problem &quot;go away&quot; by turning off DDE in the file associations.</p>
<p>I was stumped as to why I was having problems on my home machine, but not at work.  It makes sense now.  At home, I have an iPaq.</p>
<p>Thanks for troubleshooting my problem Mike :-)</p>
<p>I&#8217;d been meaning to post to TextPad&#8217;s forums about this, but I lost interest in the problem once I had found a workaround.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-287173">
				<div id="div-comment-287173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287173">
			June 27, 2005 at 7:16 pm</a>		</div>

		<p>A question:<br />
<br />As NT was (basically) emulating Win16, couldn&#8217;t it also have kept this behaviour in the Win16 code and do something more reasonable (more sane) for Win32/preemptive?</p>
<p>I know of many things I immediately spotted as &quot;impossible&quot; to do in Win95 due to how 3.11 was cooperative &#8211; and I was right on every one of them (the very useful Recorder was the most obvious one).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287193">
				<div id="div-comment-287193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">William</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287193">
			June 27, 2005 at 10:23 pm</a>		</div>

		<p>Is there any way to determine whether my system is suffering from this broadcast halt? Because I encounter randomly &#8216;hanging&#8217; for a few seconds EVERYDAY, even the mouse cursor doesn&#8217;t move during that period :{</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-287213">
				<div id="div-comment-287213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287213">
			June 28, 2005 at 5:40 am</a>		</div>

		<p>@William</p>
<p>I have had such symptoms when my hard drivesâ€™ connections were insecure. An HDD powers down, Windows tries to communicate with it for several seconds (especially when some file on it is opened), fails and logs an event. Then everything works until the next access to the (now disconnected) drive. Drives me nuts :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287223">
				<div id="div-comment-287223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287223">
			June 28, 2005 at 8:28 am</a>		</div>

		<p>Huh? Couldn&#8217;t the broadcasts not have been restricted to those programs running within WoW, and another way have been found of achieving the same end for newer applications?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-287233">
				<div id="div-comment-287233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287233">
			June 28, 2005 at 10:08 am</a>		</div>

		<p>There are already ways of achieving the same end for newer applications without resorting to broadcasts. (COM servers and OLE, for example.) Too bad people didn&#8217;t use them.</p>
<p>That&#8217;s because when you&#8217;re trying to convince an industry to do something (port their code from Win16 to Win32), you want to make it as easy as possible &#8211; best case is to make it happen for free.  Otherwise nobody will do it.</p>
<p>It&#8217;s the problem of surviving to v2 all over again.</p>
<p>(As a counter-example: To be a good power management citizen, you have to change your application in certain ways. This takes work. Therefore nobody does it.)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287433">
				<div id="div-comment-287433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287433">
			June 28, 2005 at 8:11 pm</a>		</div>

		<p>Raymond, are these &quot;good power management citizen&quot; things documented anywhere?  I don&#8217;t think I&#8217;ve run across them before.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-287463">
				<div id="div-comment-287463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287463">
			June 28, 2005 at 9:33 pm</a>		</div>

		<p>Tuesday, June 28, 2005 5:40 AM by Centaur<br />
<br />&gt; @William<br />
<br />&gt; I have had such symptoms when my hard<br />
<br />&gt; drivesâ€™ connections were insecure.</p>
<p>I&#8217;ve had them with CDs that are going bad and the drive + OS are making multiple retries.  That&#8217;s the lucky situation.  Next the unlucky situation:</p>
<p>&gt; An HDD powers down, Windows tries to<br />
<br />&gt; communicate with it for several seconds<br />
<br />&gt; (especially when some file on it is opened),<br />
<br />&gt; fails and logs an event. Then everything<br />
<br />&gt; works until the next access to the (now<br />
<br />&gt; disconnected) drive.</p>
<p>Or in a noisy environment (electrical noise) where the HDD or CD drive are powered properly but not responding properly.  Windows NT4 would give up and continue with its other stuff.  Windows 2000 tries to log an event exactly as you say.  In order to try to log an event, it writes to the hard drive that is located on the exact same cable that is suffering from noise, so 2000 hangs.  It doesn&#8217;t give up, it doesn&#8217;t work until the next access, it needs to be powered off and on again.  I haven&#8217;t had XP or 2003 in an equally noisy environment so don&#8217;t know if they&#8217;ve improved or not.</p>
<p>Tuesday, June 28, 2005 8:11 PM by GregM<br />
<br />&gt; Raymond, are these &quot;good power management<br />
<br />&gt; citizen&quot; things documented anywhere?</p>
<p>DDK.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287603">
				<div id="div-comment-287603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287603">
			June 29, 2005 at 11:04 am</a>		</div>

		<p>Norm, does this mean that these &quot;good power management citizen&quot; things are only for device drivers?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-287623">
				<div id="div-comment-287623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287623">
			June 29, 2005 at 12:05 pm</a>		</div>

		<p>There is plenty for applications to do too. SetThreadExecutionState, closing network resources when going on suspend, turning off power-wasting animations when running on battery&#8230; I believe there will be a PDC talk on this subject.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287773">
				<div id="div-comment-287773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Johan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287773">
			June 29, 2005 at 10:04 pm</a>		</div>

		<p>So does this mean that you think that TaskbarCreated shouldn&#8217;t be broadcasted and that it should instead do something involving COM servers and OLE?</p>
<p>For the record, I think the responses to the question about documentation of how to be a good power management citizen is a better explanation on why so few are than that you need to change your applications. It&#8217;s tough to handle those unknown unknows &#8211; just ask Donald Rumsfeld.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-287793">
				<div id="div-comment-287793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287793">
			June 29, 2005 at 10:24 pm</a>		</div>

		<p>Wednesday, June 29, 2005 11:04 AM by GregM<br />
<br />&gt; Norm, does this mean that these &quot;good power<br />
<br />&gt; management citizen&quot; things are only for<br />
<br />&gt; device drivers?</p>
<p>Ouch.  I gave that answer because I&#8217;m most aware of it in the case of device drivers.  Further examples in a moment.  But Mr. Chen gave some correct answers, and indeed he had already stated it correctly and I misread it:</p>
<p>Tuesday, June 28, 2005 10:08 AM by oldnewthing<br />
<br />&gt; (As a counter-example: To be a good power<br />
<br />&gt; management citizen, you have to change your<br />
<br />&gt; application in certain ways. This takes<br />
<br />&gt; work. Therefore nobody does it.)</p>
<p>APPLICATION.  Right.  Sorry for misreading that as driver.</p>
<p>But now this leads to a question.  When Windows 2000 refused to enter hibernation on a machine that was capable, there was some way of finding which driver vetoed the hibernation request.  I&#8217;m positive I once read a Knowledge Base article saying where to find a log file, I read the log, and found what to fix.</p>
<p>When Windows XP refuses to enter hibernation on a machine that&#8217;s capable, how can the user find the reason?  For example on a machine with a single Windows XP (preinstalled by OEM), 20 times in a row it will hibernate and wake up, then one time it will refuse.  From that point until the next reboot, Control Panel will not even be aware of a theoretical possibility of hibernation.  After rebooting it will be possible to hibernate another 50 times until the problem resurfaces.  There is no change to any driver during this time.  In fact I have a sneaking suspicion that an application is doing it, and the application is a famous integral part of Windows.  Is there a log file anywhere so the user can find where the veto came from?</p>
<p>When hibernation is unavailable standby still works, but then the result is the same as a crash if the battery fully drains.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-287813">
				<div id="div-comment-287813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-287813">
			June 29, 2005 at 11:06 pm</a>		</div>

		<p>Raymond, since I&#8217;m not going to PDC, if you could point out a summary of the presentation, or some other resources, that would be helpful.</p>
<p>Norm, I have 2 GB memory in my current notebook.  I had 1 GB in my previous notebook.  This notebook will refuse to hibernate on a regular basis.  I was able to reproduce this quite readily by having Visual C++ break 1GB commit charge during the link phase of building my application.  This was done working with MS support, and disabling all non-windows stuff from startup.  Unfortunately, since then, I haven&#8217;t had time to get back to this issue to pursue it any further.</p>
<p>This sounds very much like an XPSP1 issue for which there was a hotfix, and that fix was included in SP2.  The problem is that this machine shipped with SP2.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-288103">
				<div id="div-comment-288103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-288103">
			June 30, 2005 at 9:43 pm</a>		</div>

		<p>Wednesday, June 29, 2005 11:06 PM by GregM<br />
<br />&gt; Norm, I have 2 GB memory in my current notebook.</p>
<p>Me too, but I don&#8217;t run Visual Studio on it directly, I occasionally run Visual Studio in guest machines under Virtual PC, or more frequently run Visual Studio on real machines but not on my current notebook.</p>
<p>&gt; I was able to reproduce this quite readily<br />
<br />&gt; by having Visual C++ break 1GB commit charge</p>
<p>After you exited from Visual Studio your commit charge went down, right?  But did hibernation remain impossible after that?</p>
<p>During days of XPSP1 I learned to close all Virtual PC guests and close the main Virtual PC application itself before trying to hibernate.  But this was not the only cause of refusals to hibernate.  For example if I last ran Virtual PC on Sunday and closed it down, then hibernated once after that on Sunday, twice on Monday, twice on Tuesday, once on Wednesday, then suddenly the next time on Wednesday it refuses to hibernate and forgets that the word hibernation ever existed, then I think that Virtual PC is not the reason.</p>
<p>I applied XPSP2 nearly a year ago, and VPC2004SP1 shortly after that.  They have had no visible effect on this issue.  I suppose I could experiment trying to hibernate while VPC is running and see if there&#8217;s been any improvement in that part of it, but I haven&#8217;t tried it.</p>
<p>&gt; This sounds very much like an XPSP1 issue<br />
<br />&gt; for which there was a hotfix, and that fix<br />
<br />&gt; was included in SP2.</p>
<p>I&#8217;m not sure if I was aware of the hotfix for SP1.  Some time ago I made a list of hotfixes I wanted and phoned Microsoft, but they wouldn&#8217;t even let me tell them the Knowledge Base numbers of the hotfixes that I wanted unless I opened a paid support incident.  As for whether the fix was included in SP2, it might be included and it might help for some causes that are different from whatever&#8217;s hitting me, or it might not be.  There are some fixes that get into English language versions without getting into others.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-387413">
				<div id="div-comment-387413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/06/02/614235.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-387413">
			June 2, 2006 at 10:00 am</a>		</div>

		<p>It reserves a DC for the entire class.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-424293">
				<div id="div-comment-424293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/09/26/772222.aspx' rel='external nofollow' class='url'>The Old New Thing : Isn't DDE all asynchronous anyway?</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-424293">
			September 26, 2006 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/09/26/772222.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/09/26/772222.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443303">
				<div id="div-comment-443303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/11/17/1094116.aspx' rel='external nofollow' class='url'>The Old New Thing : The window manager moves the mouse; applications choose the cursor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-443303">
			November 17, 2006 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/11/17/1094116.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/11/17/1094116.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-476233">
				<div id="div-comment-476233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/02/26/1763683.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-476233">
			February 26, 2007 at 10:50 am</a>		</div>

		<p>It&#8217;s a legacy interface.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-738243">
				<div id="div-comment-738243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/stephen_griffin/archive/2009/05/22/the-fifth-mapi-multithreading-rule.aspx' rel='external nofollow' class='url'>SGriffin's MAPI Internals</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050627-00/?p=35193#comment-738243">
			May 22, 2009 at 10:37 am</a>		</div>

		<p>We had an issue recently where DDE broadcasts were being blocked on a system. The customer noticed that</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>