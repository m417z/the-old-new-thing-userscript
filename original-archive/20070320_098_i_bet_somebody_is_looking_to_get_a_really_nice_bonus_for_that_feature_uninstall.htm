<html>
<head>
<title>I bet somebody is looking to get a really nice bonus for that feature: Uninstall</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>I bet somebody is looking to get a really nice bonus for that feature: Uninstall</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 20, 2007 / year-entry #99</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>59</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer asked the following question (paraphrased): Does the Windows XP Add/Remove Programs control panel expose a scriptable object model? We want our program to open the Add/Remove Programs control panel and uninstall the programs of our competitors. No, there is no object model for the Add and Remove Programs control panel, and it frightens me...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p> A customer asked the following question (paraphrased): </p>
<blockquote class="q"><p> Does the Windows&nbsp;XP Add/Remove Programs control panel expose a scriptable object model? We want our program to open the Add/Remove Programs control panel and uninstall the programs of our competitors. </p>
</blockquote>
<p> No, there is no object model for the Add and Remove Programs control panel, and it frightens me that you're even contemplating what you're suggesting. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (59)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-483623">
				<div id="div-comment-483623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483623">
			March 20, 2007 at 10:06 am</a>		</div>

		<p>Idiots! &nbsp;I hope they&#8217;re looking to unistall their competitors viruses or rootkits, because if they unistalled another piece of software for me I&#8217;d show up at their offices and uninstall their developers with a chainsaw.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483643">
				<div id="div-comment-483643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">benjamin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483643">
			March 20, 2007 at 10:14 am</a>		</div>

		<p>Maybe they can uninstall their own program while they&#8217;re at it.</p>
<p>Gods. It&#8217;s posts like these that let me appreciate MS&#8217; work all the more. For all the faults people ascribe them, I can&#8217;t imagine having to deal with a request like this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483653">
				<div id="div-comment-483653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TKW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483653">
			March 20, 2007 at 10:15 am</a>		</div>

		<p>Neal: Yes that&#8217;s exactly what the developers of Windows originally expected you would do.</p>
<p>If the users punished any company whose software misbehaved (normally by voting with their feet, rather than using chainsaws&#8230;) then we could all trust developers to behave.</p>
<p>Microsoft have begun to realize that we can&#8217;t.</p>
<p>Besides, there&#8217;s always the chance that the software mentioned in Raymond&#8217;s article wasn&#8217;t being installed with &quot;full consent&quot; anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483663">
				<div id="div-comment-483663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483663">
			March 20, 2007 at 10:20 am</a>		</div>

		<p>I&#8217;m a bit confused. Are you frightened that they are contemplating uninstalling a competitors software, or that they would try to do it via the Add/Remove Programs cpl? As a person that packages and repackages software in an enterprise, I&#8217;m more appalled by the latter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483673">
				<div id="div-comment-483673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.joshmcfarlane.com' rel='external nofollow' class='url'>Josh McFarlane</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483673">
			March 20, 2007 at 10:27 am</a>		</div>

		<p>Mick,</p>
<p>Personally I&#8217;d be frightened if any software attempted to uninstall any other piece of software that did not directly belong to the company.</p>
<p>Got a software conflict with something else I have installed? Tell the user and let them uninstall it.</p>
<p>Just hate the other vendor so much you want them to suffer as much as possible? Tell the user to remove their program.</p>
<p>If you remove a competitor&#8217;s program from my machine, you may as well as have deleted all of my mp3s. You&#8217;ve abused my machine and I will not use the program at all.</p>
<p>It&#8217;s like when Windows Update decided that IE should be my default browser without telling me. Don&#8217;t make decisions for the user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483683">
				<div id="div-comment-483683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483683">
			March 20, 2007 at 10:37 am</a>		</div>

		<p>Object model ? I mean, it&#8217;s all there, for the most part, for many programs. If you know where to look it&#8217;ll tell you how to invoke. So you can fairly easily do it.</p>
<p>One version of a product I worked on didn&#8217;t cleanly uninstall on an upgrade (due to install shield bugs and bad design) so we had to manually do it.. So knowing the right places to look makes it easy to do.. Not that I&#8217;d advocate such a thing.. (Granted, I haven&#8217;t seen if the same method works on Vista, but 2000 and up works)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483693">
				<div id="div-comment-483693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483693">
			March 20, 2007 at 10:38 am</a>		</div>

		<p>It&#8217;s more like this scenario:</p>
<p>A user goes out to CompUSA and buys <font color="red">AntiVirus Program&nbsp;X</font>. For a couple of weeks, <font color="red">AntiVirus Program&nbsp;Y</font> has been whining that they need to update their subscription, but <font color="red">Company&nbsp;Y</font> is charging $50 for a year and they can get <font color="red">Program&nbsp;X</font> for free after competitive upgrade rebate.</p>
<p>They drop the <font color="red">Program&nbsp;X</font> CD in the drive, and it autostarts. The installer sees that <font color="red">Program&nbsp;Y</font> is running, and says to the user: &#8220;You currently are running <font color="red">AntiVirus Program&nbsp;Y</font>. Only one antivirus solution should be running. Do you want to uninstall <font color="red">Program&nbsp;Y</font> and install <font color="red">Program&nbsp;X</font>, or do you want to cancel installation?&#8221;</p>
<p>Well, do ya?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483703">
				<div id="div-comment-483703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fredrik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483703">
			March 20, 2007 at 10:41 am</a>		</div>

		<p>I would love to who asked that question so that I could carefully avoid installing/using/endorsing/coming anywhere close to any piece of code they ever created.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483713">
				<div id="div-comment-483713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ultrafractal.com/' rel='external nofollow' class='url'>Frederik Slijkerman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483713">
			March 20, 2007 at 11:07 am</a>		</div>

		<p>One more reason to avoid anti-virus software like the plague&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483723">
				<div id="div-comment-483723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483723">
			March 20, 2007 at 11:11 am</a>		</div>

		<p>On the surface, I&#8217;d boycott (and actively advocate against) said company for life so much as the suspicion of such behavior, but Dave raises an interesting point&#8230; with proper user notification and consent, it&#8217;s not necessarily evil.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483733">
				<div id="div-comment-483733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483733">
			March 20, 2007 at 11:13 am</a>		</div>

		<p>Josh</p>
<p>-snip-</p>
<p>Don&#8217;t make decisions for the user.</p>
<p>Microsoft &#8211; Because choices are confusing.</p>
<p>(credit goes to bbspot)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483743">
				<div id="div-comment-483743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483743">
			March 20, 2007 at 11:20 am</a>		</div>

		<p>I agree uninstalling a competitor&#8217;s software without the user initiating the action is bad, but Microsoft seems to think it&#8217;s OK if they do it.</p>
<p>&#8220;Any potentially unwanted software rated &#8216;high&#8217; or &#8216;severe,&#8217; will automatically be removed after scanning unless you change the default setting. &nbsp;Removing or disabling potentially unwanted software may result in other software on your computer ceasing to work, or your breaching a license to use other software on your computer. &nbsp;By using this software, it is possible that you will also remove or disable software that is not potentially unwanted software.&#8221;</p>
<p>I&#8217;ve also noticed that <font color="red">Program&nbsp;Q</font> will, with user consent, turn off the Vista Sidebar. &nbsp;Granted, that&#8217;s a step short of installing it, but how many Vista customers would know how to turn it back on?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483753">
				<div id="div-comment-483753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://buzz.reality-tape.com/story.php?id=702' rel='external nofollow' class='url'>buzz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483753">
			March 20, 2007 at 11:24 am</a>		</div>

		<p>Does the Windows XP Add/Remove Programs control panel expose a scriptable object model? We want our program to open the Add/Remove Programs control panel and uninstall the programs of our competitors.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483763">
				<div id="div-comment-483763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://qstuff.blogspot.com/' rel='external nofollow' class='url'>Justin Olbrantz (Quantam)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483763">
			March 20, 2007 at 11:35 am</a>		</div>

		<p>&quot;I would love to who asked that question so that I could carefully avoid installing/using/endorsing/coming anywhere close to any piece of code they ever created.&quot;</p>
<p>I would love to know who asked that question so I could burn their house down.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483773">
				<div id="div-comment-483773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">C Gomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483773">
			March 20, 2007 at 12:00 pm</a>		</div>

		<p>Since most developers have a hard enough time installing their own software, I would never want them to touch anything else out there.</p>
<p>So, is there a tool that can tell me what an install is going to do before I let it do it? &nbsp;I don&#8217;t have Vista, but I have read all over the blogs that setup programs are forces to run as an adminstrator. &nbsp;Some setup programs may not need full rights (maybe just the Program Files folder), so knowing there are developers out there who want to destroy my machine, I think it&#8217;d be handy to know what they are going to do before I let them do it.</p>
<p>(This is very power user&#8230; not expecting Grandma to be able to do it or MSFT to implement such a power task. &nbsp;Just wondering if there&#8217;s a third party doing it)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483783">
				<div id="div-comment-483783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://Thecorrelaryofcourseis...' rel='external nofollow' class='url'>Joe Dietz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483783">
			March 20, 2007 at 12:11 pm</a>		</div>

		<p>That lacking a supportable object model they are going to uninstall their competitors products anyways and will probably have to do so in a fragile manner. &nbsp;This is one of those things that you can place a value judgment on about if it should be done in the first place, but that is really irrelevant to the technical question because its going to happen anyways.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483793">
				<div id="div-comment-483793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://inertwall.spaces.live.com' rel='external nofollow' class='url'>Massif</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483793">
			March 20, 2007 at 12:12 pm</a>		</div>

		<p>Does add/remove programs allow us to hide our installation?</p>
<p>Our competitors want to automatically uninstall our software, and we&#8217;d like to avoid that.</p>
<p>Actually, forget it, we&#8217;ll just not install the software properly at all, and create registry settings directly, that way we&#8217;ll be safe. Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483803">
				<div id="div-comment-483803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">marlinj</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483803">
			March 20, 2007 at 12:16 pm</a>		</div>

		<p>Seems to be a dumb question in more than one way, because if you know your competitor&#8217;s software well enough to find it in Add and Remove Programs, wouldn&#8217;t you be able to just dig the uninstall command out of the registry and run that?</p>
<p>I have to think that the only reason you&#8217;d invoke Add and Remove Programs is to allow the user an opportunity to &nbsp;say no. &nbsp;If you make softwareX and it&#8217;s incompatible with softwareY, it might seem better from a user experience point of view to automate the removal rather than effectively tell the user &quot;softwareX can&#8217;t install until softwareY is gone. &nbsp;Go remove softwareY and then try installing softwareX again.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483813">
				<div id="div-comment-483813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">patrick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483813">
			March 20, 2007 at 12:23 pm</a>		</div>

		<p>I don&#180;t know where all those commenters are working, but Mick&#180;s point is very important.</p>
<p>Sure, end user software on personal desktops should not be uninstalled without user interaction. But i&#180;m working for one of the biggest companys of the world, and do you know what? The User are not allowed to install or uninstall softeware, and most of them don&#180;t even know what this piece of software does when you alert them about uninstalls because of incompatiblity or replacements.</p>
<p>Maybe it&#180;s not about competitors, but some other software that does not work probably(like a ipsec stack replacement, or firewall).</p>
<p>We have been often asked to include such uninstalls in our setup to help the package guys&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483823">
				<div id="div-comment-483823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483823">
			March 20, 2007 at 12:34 pm</a>		</div>

		<p>C Gomez: For MSI setups try to use the &quot;Orca&quot; tool from the MSI SDK, which is part of the Windows SDK (formerly known as Platform SDK). There you can see what is gonna happen. Alternatively you can use the &quot;dark&quot; tool from WiX to &quot;decompile&quot; the MSI into the XML format of WiX.</p>
<p>Also see msiexec /? to read about how you can log what&#8217;s going on. Regmon+Filemon are also helpful tools ;) E.g., install on a VM first&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483833">
				<div id="div-comment-483833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tsrblke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483833">
			March 20, 2007 at 12:40 pm</a>		</div>

		<p>@Dave:</p>
<p>Right, but why can&#8217;t the program just say &#8220;Please Unistall Program X before continuing?&#8221; &nbsp;Maybe I know conflicts are possible. &nbsp;Maybe it&#8217;s a risk I&#8217;m willing to take.</p>
<p>You want to use <font color="red">Program&nbsp;Y</font> as an example fine: <font color="red">Program&nbsp;Y</font> tell you you have to unistall <font color="red">Program&nbsp;Z</font> befoe installing Virus Scan. Not <font color="red">Program&nbsp;Z2</font> mind you, just generic run on demand <font color="red">Program&nbsp;Z</font>. It won&#8217;t let you continue until you do. When I weighed my options I realized sending my sister off to college sans either program was bad. So I unstalled <font color="red">Program&nbsp;Z</font>, installed <font color="red">Program&nbsp;Y</font> and put <font color="red">Program&nbsp;Z</font> back on. You know what problems I&#8217;ve having? NONE. &nbsp;<font color="red">Program&nbsp;Y</font> just wanted to sell their spyware blocker. If you allow this, they won&#8217;t ask the question. &nbsp;They&#8217;ll just nix the program. &nbsp;Then when your spyware becomes an issues, guess what! &nbsp;They&#8217;ll have a solution, for a price.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483863">
				<div id="div-comment-483863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Erzengel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483863">
			March 20, 2007 at 12:56 pm</a>		</div>

		<p>@&quot;buzz&quot;: Great, anyone read Greek? Does it happen to say which company is trying to remove their competitors?</p>
<p>@Neal: if only you weren&#8217;t joking, there&#8217;s a list of malware, spyware, and just plain dumb-@$$-developer-ware that the developers need such&#8230; &quot;services&quot;. It would be of great benefit to the world if those developer&#8217;s genetics were removed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483883">
				<div id="div-comment-483883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SomeCoder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483883">
			March 20, 2007 at 1:05 pm</a>		</div>

		<p>One thing I remember being surprised by is how easy it is for an application or script to modify the firewall. &nbsp;Microsoft publishes an API which makes it possible to script or programmatically control any aspect of the Windows firewall. &nbsp;If they are willing to do it for the firewall I&#8217;m actually surprised that they didn&#8217;t do it for the Add/Remove programs.</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/aa366415.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/aa366415.aspx</a></p>
<p>Also I&#8217;m sure the person requesting this feature has by now stumbled across msi.lib which may allow them to do what they want.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483893">
				<div id="div-comment-483893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Dietz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483893">
			March 20, 2007 at 1:12 pm</a>		</div>

		<p>@tzrbike: <font color="red">Company&nbsp;Y</font> might do a better job of communicating why it believes that <font color="red">Program&nbsp;Z</font> should be uninstalled, but I think you will find that it contains a real-time scanning option which typically means a set of kernel drivers that hook file system and registry operations and scan them. &nbsp;Exactly the same sort of operations that a general AV product does as well. &nbsp;As such it generally just doesn&#8217;t work to have product A scanning while product B is as well. &nbsp;When you buy AV/spyware/etc/ protection that includes real-time checking you are pretty much signing up to buy all of your &#8216;scanning&#8217; protection from the same vendor, even if you don&#8217;t realize it.</p>
<p>This is <em>exactly</em> why competitive uninstall is a enterprise feature that all AV products have. &nbsp; &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483903">
				<div id="div-comment-483903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ryan Fox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483903">
			March 20, 2007 at 1:15 pm</a>		</div>

		<p>Neal: You blame the developers, but it&#8217;s likely a management decision. The developers either do as their told, or make friends with the streets.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483923">
				<div id="div-comment-483923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Trey Van Riper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483923">
			March 20, 2007 at 1:23 pm</a>		</div>

		<p>SomeCoder:</p>
<p>You can programatically uninstall an application easily enough if it was installed via MSI.</p>
<p>Even if it wasn&#8217;t, you can probably still uninstall the application easily by examining the ARP registry items and making use of the information available there.</p>
<p>But the original person&#8217;s reasoning for doing this seems quite unsavory.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483933">
				<div id="div-comment-483933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stuartd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483933">
			March 20, 2007 at 1:25 pm</a>		</div>

		<p>If I am correct in understanding that Add/Remove programs on Win2k/XP is an HTA (res://appwiz.cpl/default.hta) which simply provides access to the underlying WMI Installer provider which is fully scriptable the answer is surely &quot;Yes.. but please don&#8217;t.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483943">
				<div id="div-comment-483943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Coderjoe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483943">
			March 20, 2007 at 1:33 pm</a>		</div>

		<p>@Erzengel: buzz&#8217;s post is a pingback, saying they were posting it on their blog. The comment on the blog is, as far as I can tell, asking the same thing many here are: &quot;Who asked for this?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483953">
				<div id="div-comment-483953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Doug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483953">
			March 20, 2007 at 1:49 pm</a>		</div>

		<p>@Dave:</p>
<p>Right, but why can&#8217;t the program just say &quot;Please Unistall Program X before continuing?&quot; &nbsp;</p>
<p>Becuase there are many Antivirus companies that don&#8217;t play nice with Add/Remove programs and make it intentionally difficult to uninstall them. &nbsp;If the app plays nice with Add/Remove programs and you need it uninstalled, direct the user to uninstall it, otherwise, a competitive uninstall app is quite welcome.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483973">
				<div id="div-comment-483973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">microbe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483973">
			March 20, 2007 at 2:11 pm</a>		</div>

		<p>Warning: it&#8217;s a joke.</p>
<p>The correct Windows way of doing it is to bundle their software with the OS. Uninstalling competitor&#8217;s software is too evil.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483983">
				<div id="div-comment-483983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bernd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483983">
			March 20, 2007 at 2:12 pm</a>		</div>

		<p>I bet it wasn&#8217;t the idea of some developer but of some program manager. They come up with such stuff ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483993">
				<div id="div-comment-483993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew Rich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483993">
			March 20, 2007 at 2:50 pm</a>		</div>

		<p>On a related note, I would love to be able to tell ARP to stop waiting for my app to close after I&#8217;ve launched it from my installer in &quot;repair&quot; mode. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484053">
				<div id="div-comment-484053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484053">
			March 20, 2007 at 4:37 pm</a>		</div>

		<p>Regarding the Windows Firewall having an API somehow being a bad thing, surely you need administrator access to change any of the firewall settings via the API, so what&#8217;s the problem? Also, when a process accesses the API a dialog automatically asks the user for permission, even if they are an administrator. It&#8217;s not bullet-proof but what do you want? Security through obscurity, or security through permissions and an API which can be used for good?</p>
<p>I&#8217;m glad the API existed since it allowed me to write something to add port ranges to XP&#8217;s firewall, something that was extremely difficult to do via the official UI. I&#8217;d also much rather programs which need ports opened up set them up themselves, after I give them permission to. I can always go in and inspect the changes they&#8217;ve made or, if I don&#8217;t trust them, deny them permission and set things up by hand. I don&#8217;t think the firewall API has any real downsides, especially keeping in mind that to use it code has to have administrator access to the machine in which case it can do a hell of a lot of damage, whatever the operating system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484063">
				<div id="div-comment-484063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484063">
			March 20, 2007 at 4:56 pm</a>		</div>

		<p>Aside from performance issues, why can&#8217;t two antivirus programs coexist? &nbsp;They can each scan an EXE or any other file on access, one after the other, if they install their hooks correctly. &nbsp;</p>
<p>I don&#8217;t see the technical problem here.</p>
<p>And I had <font color="red">Program&nbsp;Y</font> AntiVirus, I think, tell me that I should uninstall <font color="red">Program&nbsp;Z</font> (which is only on-demand, as far as I know, and does not leave anything resident). &nbsp;But it didn&#8217;t insist that I uninstall it. &nbsp;</p>
<p>I actually called <font color="red">Program&nbsp;Y</font> and they said it should work if I left <font color="red">Program&nbsp;Z</font> installed.</p>
<p>Running more than one anti-virus at the same time might be a good idea for mission-critical or file hosting systems!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484073">
				<div id="div-comment-484073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484073">
			March 20, 2007 at 5:32 pm</a>		</div>

		<p>&quot;They can each scan an EXE or any other file on access, one after the other, if they install their hooks correctly.&quot;</p>
<p>Key word: IF. A big freaking IF.</p>
<p>Hint: they don&#8217;t. Or maybe they can&#8217;t, given the hacks they do to wedge themselves into the OS. Do they use the FS filter architecture?</p>
<p>I find it amusing that those antivirus programs tend to crash randomly&#8230; like a cop who falls asleep on the job.</p>
<p>Like Ryan Fox, I tend to think it&#8217;s some marketing type who suggests these kinds of things. Just like the spyware guys who think, &quot;let&#8217;s do our best to BLOCK uninstall!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484093">
				<div id="div-comment-484093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484093">
			March 20, 2007 at 6:36 pm</a>		</div>

		<p>My sources reveal that it was the <font color=red>deleted</font> team, looking to uninstall <font color=red>deleted</font>&#8230;</p>
<div class=post>[<i>Don&#8217;t make me link to the ground rules in every message. The nitpicker&#8217;s corner already pisses me off. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-483853">
				<div id="div-comment-483853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gomez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-483853">
			March 20, 2007 at 12:53 pm</a>		</div>

		<p>Well, Add/Remove Programs *IS* an interface to MSI (I hope) and it&#8217;s only a Small Matter Of Programming &#8482; to call MsiConfigureProduct(,, INSTALLSTATE_ABSENT). Pulling that uninstall stunt without the user&#8217;s consent would count as unauthorized access and make the programmer liable for some jail time (at least in the UK).</p>
<p>Incidentally, I work for an anti-virus company, and the ability to uninstall competitors&#8217; products (with the user&#8217;s consent!) is a requirement in the corporate sphere. We wouldn&#8217;t be able to get through the door without it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484103">
				<div id="div-comment-484103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jamie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484103">
			March 20, 2007 at 8:20 pm</a>		</div>

		<p>As marlinj already mentioned, all of the uninstall information is kept in the registry. It&#8217;s not difficult to go through it and kick off the various uninstallers.</p>
<p>That being said, whether you CAN do this and whether you SHOULD are 2 completely separate questions. While it may be possible to find and remove all of your competitors&#8217; software, it&#8217;s certainly not a good idea to do so.</p>
<p>We can only hope that the person who contacted Raymond will sit down for a second and think of the consequences of what they&#8217;re doing. Most notably, what will the customer reaction be?</p>
<p>For example, imagine that Company X is writing a media player, to compete with Windows Media Player, iTunes, etc. In order to make sure customers use only their software, they write the installer so that WMP, iTunes and any other competing software is removed.</p>
<p>The customer then plugs in their iPod and goes to load iTunes&#8230; only to find it&#8217;s no longer there. It won&#8217;t take long for them to figure out what happened. Company X loses not only 1 customer, but potentially many many customers.</p>
<p>It almost makes you want to help Company X figure this stuff out, in order to seal their miserable fate&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484003">
				<div id="div-comment-484003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484003">
			March 20, 2007 at 3:37 pm</a>		</div>

		<p>&quot;One thing I remember being surprised by is how easy it is for an application or script to modify the firewall. &nbsp;Microsoft publishes an API which makes it possible to script or programmatically control any aspect of the Windows firewall.&quot;</p>
<p>Heh, you can do the similar in OpenBSD: pfctl</p>
<p>, and in Linux you&#8217;ve got ipchains/iptables/whatever scriptkiddies can run.</p>
<p>In addition, you also got the UPnP IGD specification which gives you some control (e.g., add/remove port bindings).</p>
<p>Firewall control is a different scenario then the Add/Remove functionality. Also, I believe that MS is *required* to publish API docs for the Firewall functionality so they can use it in their own applications (not sure which, though).</p>
<p>So&#8230; did anybody have a problem with this in Linux? E.g. KDE doing &quot;apt-get remove gnome-desktop-environment&quot;? :) Not trying to make a Linux vs Windows bashfest here, rather I think it is something about greedy, ugly, evil people which only want to get money from their customers, not give them a good experience. It doesn&#8217;t matter how nice Vista looks like if the vendors try to screw the user everytime they want to use their computer. I&#8217;ve always found it good that developers can develop some nice software and sell it to users. However, what really is happening here is just that a developer throws together some crap, learned over a 24h crash course, which doesn&#8217;t work but still tries to force it onto poor customers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484043">
				<div id="div-comment-484043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484043">
			March 20, 2007 at 4:31 pm</a>		</div>

		<p>A certain &quot;security&quot; program that causes more problems than it solves, let&#8217;s call it Area Alert, causes so much grief with an application I help support, as well as many other applications, that I&#8217;ve jokingly suggested this sort of thing in the past.</p>
<p>In reality, I&#8217;d never advocate anything more than a warning message box during install or first run which said something along the lines of &quot;We couldn&#8217;t help but notice this piece of **** installed on your computer. If things don&#8217;t work when trying our program, try uninstalling their program to see if it helps.&quot;</p>
<p>(Yeah, uninstalling, since this wonderful product still manages to break lots of things even when &quot;disabled&quot;.)</p>
<p>Even that kind of message isn&#8217;t really helpful, though. If someone is using said piece of **** then, however misguided I might think they are, they probably like and trust it, or like and trust the person who helps look after their PC and installed it for them, so a new program coming along and saying that their trusted &quot;security&quot; program might cause problems could be viewed as suspicious.</p>
<p>It&#8217;s damn tempting, though. I mean, this thing will kill your task, often without even telling the user, if it does something suspicious like connect to the internet (for an update check) or run another program (it&#8217;s a file manager, it&#8217;s going to be doing that a lot!), unless that exact version of the executable has been sent to the people who make the &quot;security&quot; product so they can add its checksum to their database. Talk about shoot first, ask questions later&#8230; Besides which, if you do have something genuinely suspicious on your machine, isn&#8217;t it (a) probably too late and (b) something you&#8217;d want to be TOLD about, rather than have applications mysteriously exit or fail? Sigh.</p>
<p>As a user, I would welcome warnings of incompatibilities but if something uninstalled another program without my permission, however well meaning it was, then I would stay away from that product for good. Ditto any &quot;security&quot; product that randomly kills other tasks without good reason.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484123">
				<div id="div-comment-484123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Duh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484123">
			March 20, 2007 at 11:44 pm</a>		</div>

		<p>S is wrong. It was definitely deleted with their stupid deleted program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484153">
				<div id="div-comment-484153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Amon Houndsbreath</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484153">
			March 21, 2007 at 1:51 am</a>		</div>

		<p>Actually, forget it, we&#8217;ll just not install the software properly at all, and create registry settings directly, that way we&#8217;ll be safe. Thanks!</p>
<p>Don&#8217;t forget to add a root kit, in case your competitors try to find the registry settings directly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484173">
				<div id="div-comment-484173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484173">
			March 21, 2007 at 5:01 am</a>		</div>

		<p>In reply to Anonymous Coward:</p>
<p>&#8220;I&#8217;ve also noticed that the <font color="red">Program&nbsp;Q</font> will, with user consent, turn off the Vista Sidebar. &nbsp;Granted, that&#8217;s a step short of installing it, but how many Vista customers would know how to turn it back on?&#8221;</p>
<p>Well, actually with Vista typing any question for any part of windows you turned off will generally give instructions on how to turn it back on, which is really good. (Although I am a &#8220;power&#8221; user, the changed location of things in Vista and the new things have seen me use this). </p>
<p>So a help query like &#8216;turn sidebar back on&#8217; would most probably tell you how to do it (not on my Vista machine right now, so I cannot test it)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484183">
				<div id="div-comment-484183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484183">
			March 21, 2007 at 5:19 am</a>		</div>

		<p>I remember a few years ago, a certain media player silently removed anti-spyware applications when it was installed. They&#8217;re still suffering from the backlash.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484193">
				<div id="div-comment-484193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Erzengel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484193">
			March 21, 2007 at 5:28 am</a>		</div>

		<p>@Coderjoe: I know it was a link to something, but being unable to read greek (it&#8217;s all greek to me), I didn&#8217;t know it was really a blog post. I thought it was someone&#8217;s forum post. All I saw was a direct quote that Raymond quoted.</p>
<p>@Miral: Psh, like that actually stops even a casual pirater. All it serves to do is piss off us legitimate owners when it can&#8217;t detect my CD drive and their site says it&#8217;s a &quot;known issue&quot; but doesn&#8217;t provide a fix. What&#8217;re we supposed to do, pirate the game?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484213">
				<div id="div-comment-484213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484213">
			March 21, 2007 at 5:52 am</a>		</div>

		<p>Actually I have seen a computer with <font color="red">Program&nbsp;W</font>, <font color="red">Program&nbsp;X</font>, and <font color="red">Program&nbsp;Y</font> installed.</p>
<p>It worked&#8230;.just very very slowly. There&#8217;s a performance hit every time a file is read; this is at least 3 times worse with 3 virus checkers (more because they&#8217;ll be checking each others&#8217; files as well)</p>
<p>In some circumstances even one antivirus can cripple your machine. &nbsp;At university, <font color="red">Program&nbsp;E</font> (a java application) is not part of the base install for the computers, but is an application we can run. &nbsp;So the first time you run it after a machine&#8217;s been reimaged, it has to be deployed to the local machine. &nbsp;A java application is full of .jar files, .jar files are archives with program files in them, antivirus goes nuts. &nbsp;Even with the excrutiating network speed, the deployment bottleneck was CPU.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484133">
				<div id="div-comment-484133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484133">
			March 20, 2007 at 11:45 pm</a>		</div>

		<p>Actually you&#8217;d be surprised. &nbsp;There are a number of programs that provide virtual CD/DVD drives (for quite legitimate uses) and also a lot of game &quot;copy protection&quot; programs that refuse to permit the game to run if one of these programs is detected, *even if* the game is not being run through one of the virtual drives. &nbsp;And yet these games continue to sell. &nbsp;(Of course, part of that is because games don&#8217;t advertise which protection software they&#8217;re using.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484203">
				<div id="div-comment-484203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">T</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484203">
			March 21, 2007 at 5:36 am</a>		</div>

		<p>&#8220;There are a number of programs that provide virtual CD/DVD drives (for quite legitimate uses) and also a lot of game &#8220;copy protection&#8221; programs that refuse to permit the game to run if one of these programs is detected, *even if* the game is not being run through one of the virtual drives. &nbsp;And yet these games continue to sell. &nbsp;(Of course, part of that is because games don&#8217;t advertise which protection software they&#8217;re using.)&#8221;</p>
<p>Plus <font color="red">Program&nbsp;S</font> is just plain evil, even if you don&#8217;t mind uninstalling the virtual CD software. These days I buy the game, store the unopened box in my cellar and play the torrent. As far as I can tell, it&#8217;s legal, means the people that made the game get their dollars, and I don&#8217;t need to have a bunch of rootkits installed on my home machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484223">
				<div id="div-comment-484223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484223">
			March 21, 2007 at 6:22 am</a>		</div>

		<p>&quot;My sources reveal that it was the deleted team, looking to uninstall deleted&#8230;&quot;</p>
<p>Somehow, Raymond&#8217;s redacted version makes a lot of sense: if &#8216;deleted&#8217; actually did this, they would succeed in getting &#8216;deleted&#8217; (i.e. themselves) uninstalled, probably with a chainsaw!</p>
<p>Yes, *in theory* antivirus apps should cohabit gracefully &#8211; there are a lot of potential pitfalls along the way. For example, AV1 needs to load its signatures from AV1.DAT &#8211; which is a file access, so of course, AV2 springs into life and tries to load its own signatures from AV2.DAT &#8211; which is a file access, so AV1 needs to load its&#8230; SPLAT. In practice, you&#8217;ll probably be OK in most cases, but you&#8217;re in uncharted territory there!</p>
<p>I remember a few years ago, spending a LONG time trying to debug a crash which turned out to be the fault of my AV tool of the time: whenever you closed a file handle which had been opened by file number (rather than by name), it crashed the kernel. Friendly, that; trying to understand quite how my innocent call to NtClose (from userspace, not kernel mode!) was crashing took a while.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484453">
				<div id="div-comment-484453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">schwiet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484453">
			March 21, 2007 at 3:59 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>We&#8217;re sorry not to have been able to find a scriptable object model to achieve our design goals. &nbsp;You&#8217;ll be glad to hear our engineers have devised some clever workarounds, making programmatic calls to emulate the behavior of regedit.exe through the Win32 SDK. &nbsp;We still appreciate your help and will credit you lavishly in all our documentation.</p>
<p>Fictionally Yours,</p>
<p>crazy customer</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484553">
				<div id="div-comment-484553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484553">
			March 22, 2007 at 3:28 am</a>		</div>

		<p>Ron White had it right: You can&#8217;t fix stupid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484573">
				<div id="div-comment-484573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Courtney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484573">
			March 22, 2007 at 4:58 am</a>		</div>

		<p>Yikes! &nbsp;I really do feel sorry for MS when they get crazy questions like this&#8230;</p>
<p>Why are some programmers so dumb? &nbsp;Have they no shame?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484733">
				<div id="div-comment-484733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BadGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484733">
			March 22, 2007 at 11:45 am</a>		</div>

		<p>If they asked the question in a different way they probably could have figured something out to uninstall things. It&#8217;s just registry and for example Crap Cleaner uses this stuff as well.</p>
<p>Simple case of badly phrased question imho</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-484793">
				<div id="div-comment-484793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://beconfused.com' rel='external nofollow' class='url'>Mr. Dew</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484793">
			March 22, 2007 at 2:16 pm</a>		</div>

		<p>That&#8217;s the most ridiculous thing I heard all day!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-484843">
				<div id="div-comment-484843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-484843">
			March 22, 2007 at 9:16 pm</a>		</div>

		<p>What do you need a programmatic interface to Add/Remove Programs for? &nbsp;Just delete your competitors&#8217; entire directory trees as part of your install program&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-485843">
				<div id="div-comment-485843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-485843">
			March 26, 2007 at 7:11 pm</a>		</div>

		<p>You&#8217;re all assuming this company would uninstall the other product without consent.</p>
<p>It&#8217;s more likely something like the Anti Virus case, or some other component that should really be alone driving some hardware.</p>
<p>It&#8217;s likely that the setup of that application would have a dialog that says : &quot;You also have X installed, would you like to remove it now?&quot;</p>
<p>It&#8217;s a heck of a lot better than to provide some written documentation about how to do that on your own, for users who are non-technical.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-485913">
				<div id="div-comment-485913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-485913">
			March 26, 2007 at 9:58 pm</a>		</div>

		<p>This is most likely some spyware/malware vendor looking to uninstall all protection you might have against their err.. &quot;product&quot;.</p>
<p>There is no legitimate use for this. I have both hands thank you, and I know where I should click to uninstall certain software. If you really need it done, just tell me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-488133">
				<div id="div-comment-488133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-488133">
			April 1, 2007 at 5:48 pm</a>		</div>

		<blockquote><p>
  Actually I have seen a computer with <font color="red">Program&nbsp;W</font>, <font color="red">Program&nbsp;X</font>, and <font color="red">Program&nbsp;Y</font> installed.
</p></blockquote>
<p>I wonder which order you have to install them in to avoid them uninstalling each other first&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-705243">
				<div id="div-comment-705243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.depon.net/index.php?/archives/579-Der-Krieg-um-den-Windows-Desktop.html' rel='external nofollow' class='url'>TheUndeadable entwickelt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070320-00/?p=27563#comment-705243">
			February 2, 2009 at 1:09 pm</a>		</div>

		<p>Nett zu lesen mit welchen Anfragen Microsoft zu tun hat: Does the Windows XP Add/Remove Programs control panel expose a scriptable object model? We want our program to open the Add/Remove Programs control panel and uninstall the programs of our compe</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

