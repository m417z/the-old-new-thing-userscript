<html>
<head>
<title>What is the default version of a header file?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>What is the default version of a header file?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>April 10, 2007 / year-entry #124</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>34</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">The general rule with Windows header files is that if you don't specify which version of the header file you want, you get the latest version. For example, if you have the Windows XP Platform SDK header files and you #include <windows.h>, you're going to get the Windows XP function prototypes, the Windows XP structures, the the Windows XP...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
The general rule with Windows header files is that if you don't
specify which version of the header file you want,
you get the latest version.
For example, if you have the Windows&nbsp;XP Platform SDK header files
and you <code>#include &lt;windows.h&gt;</code>,
you're going to get the Windows&nbsp;XP function prototypes,
the Windows&nbsp;XP structures, the
the Windows&nbsp;XP flags, all that stuff.
And unless you're careful,
the program you get as a result will most likely run only
on Windows&nbsp;XP.
</p>
<p>
If you call a function that is new for Windows&nbsp;XP,
then your program won't run on earlier versions of Windows
<a HREF="http://blogs.msdn.com/oldnewthing/archive/2003/09/16/54938.aspx">
because the import can't be resolved</a>.&dagger;
</p>
<p>
If you use a structure that changed for Windows&nbsp;XP,
then your program won't run on earlier versions of Windows
<a HREF="http://blogs.msdn.com/oldnewthing/archive/2003/12/12/56061.aspx">
because the structure size will be wrong</a>.
</p>
<p>
Even if the structure size didn't change, using a flag
that was introduced in Windows&nbsp;XP
will create difficulties for your program when run
on earlier versions of Windows
because those earlier versions don't support the flag you're passing.
Depending on how the function in question was written,
it may ignore the "flag from the future" or it may reject it as invalid.
</p>
<p>
If you want your program to run on older versions of Windows,
you have a few options.
First, you can explicitly "downgrade" your header file by
defining an appropriate symbol or symbols before including
the <code>windows.h</code> header file.
</p>
<pre>
#define WINVER         0x0400
#define _WIN32_WINNT   0x0400
#define _WIN32_WINDOWS 0x0400
#define _WIN32_IE      0x0400

#include &lt;windows.h&gt;
#include &lt;commctrl.h&gt;
#include &lt;shlobj.h&gt;
...
</pre>
<p>
Oh yuck, now we have the messy world of
"So what's the difference between
<code>_WIN32_WINNT</code>,
<code>_WIN32_WINDOWS</code>,
<code>_WIN32_IE</code>, and
<code>WINVER</code>?"
We'll pick up this topic next time,
but you're not going to like the answer.
</p>
<p>
<b>Nitpicker's corner</b>
</p>
<p>
&dagger;That statement is from the operating system's&Dagger; point of view.
You can of course use techniques like
Visual Studio linker's delay-load feature to avoid creating an import
dependency, but that's outside the operating system.&Dagger;
</p>
<p>
&Dagger;s/operating system/Windows operating system/</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (34)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-491513">
				<div id="div-comment-491513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491513">
			April 10, 2007 at 10:08 am</a>		</div>

		<p>Ooh! &nbsp;Finally, some technical dirt on those macros! &nbsp;Wait a minute&#8230;wasn&#8217;t dirt yesterday&#8217;s post :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491553">
				<div id="div-comment-491553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491553">
			April 10, 2007 at 11:29 am</a>		</div>

		<p>Shouldn&#8217;t that be:</p>
<p>s/operating system/Windows operating system/g</p>
<p>Thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491573">
				<div id="div-comment-491573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asmguru62</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491573">
			April 10, 2007 at 12:16 pm</a>		</div>

		<p>Good (read &#8216;smart&#8217;) Win32 code should run on any 32-bit Windows.</p>
<p>That means, using different headers will not work. The code should</p>
<p>be morphed at run-time to take advantage of services provided by API,</p>
<p>like LFH and other goodies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491583">
				<div id="div-comment-491583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joseph Bruno</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491583">
			April 10, 2007 at 12:58 pm</a>		</div>

		<p>Especially as Windows XP only has a 10% market share. 90% of PC users use Windows, not Windows XP, Windows Vista, Windows 2000 or Windows 98.</p>
<p>If you tell them to go away and check which version of Windows they have before buying, they&#8217;ll obey the first half of your request.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491643">
				<div id="div-comment-491643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491643">
			April 10, 2007 at 2:51 pm</a>		</div>

		<p>According to this <a rel="nofollow" target="_new" href="http://news.softpedia.com/news/XP-Reigns-Supreme-in-2006-43442.shtml" rel="nofollow">http://news.softpedia.com/news/XP-Reigns-Supreme-in-2006-43442.shtml</a> the vast majority of (85%) PCs run Windows XP. That&#8217;s 85% of all PCs, too, not just Windows PCs.</p>
<p>Factor in the assumption that people still using 95/98 aren&#8217;t going to be interested in many types of software (if they were they wouldn&#8217;t be running 95/98 anymore) and the pain of writing, maintaining and testing code which has to contain wrappers or workarounds for so many missing APIs, not to mention separate Unicode and ANSI builds, and I seriously question the assertion that &quot;good&quot; code should work on all Win32 versions, any more than &quot;good&quot; code should work on every OS including Linux and OS X as well as Windows. You have to decide who you are writing code for before the quality of what you produce is even a factor, and often you will produce better code if you narrow your scope.</p>
<p>It seems easy enough to write code that works on Win2k and up since, unless you&#8217;re doing certain things, there are only a few APIs to wrap up. 95/98/ME are a real pain, though and given how few people use them, and that those people probably only do email and use an ancient copy of Works, it doesn&#8217;t seem worth supporting them.</p>
<p>For header files, I set my defines to pull in the headers for the minimum version of Windows I want to support. I then use runtime linking (i.e. LoadLibrary/GetProcAddress) to get to newer APIs, and if there&#8217;s a particular structure that I need (which is quite rare in my experience) I&#8217;d rather copy it to my project than define my project to use newer headers.</p>
<p>The problem with using newer headers when you want your code to run on older versions is it&#8217;s very difficult (unless there&#8217;s a tool I don&#8217;t know of) to tell if you&#8217;re accidentally using an API, structure or flag that isn&#8217;t going to work on all versions. Copying things over and writing wrappers instead of using delay-loading is messy and wrong, but it seems the lesser of two evils.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491663">
				<div id="div-comment-491663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://denisbider.blogspot.com' rel='external nofollow' class='url'>denis bider</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491663">
			April 10, 2007 at 3:43 pm</a>		</div>

		<p>Raymond doesn&#8217;t appear to bless this strategy, but what I do is, I define the highest Windows version macro for the APIs and structures I need, and then I consciously avoid directly using any API functions that aren&#8217;t available on all the Windows versions I&#8217;m supporting. Instead, I access such APIs dynamically via LoadLibrary()/GetProcAddress(), which is conditional on an OS version check.</p>
<p>This appears to have worked fine for the past several years. This way, if one branch of your OS conditional code needs type definitions that only exist for newer Windows versions, it can use the type definitions from the Windows header files without redeclaring them.</p>
<p>The converse, which Raymond appears to be recommending, is to use version macros for the lowest common denominator OS, which in my case means dumbing down to Windows NT 4 with no service packs. Then, if you want to make conditional use of any new features, you have to duplicate the definitions of any requisite types. That sounds rather tedious and error prone to me, and it is not something I would like to see Microsoft officially require.</p>
<p>I think, instead, Microsoft should keep the type definitions in header files backwards compatible at least to the extent that you can use type definitions from newer header files and it will still work with older Windows versions if you abstain from using any of the features not present in those older OSs.</p>
<div class=post>[<i>The purpose of this article was not to endorse any particular strategy; I apologize if it appeared that any such endorsement was made. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491693">
				<div id="div-comment-491693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491693">
			April 10, 2007 at 4:29 pm</a>		</div>

		<p>I haven&#8217;t investigated this thoroughly, but it would appear that the macros are used thusly:</p>
<p>_WIN32_WINNT = Windows NT-specific definitions (i.e. functions in NT not in 9x)</p>
<p>_WIN32_WINDOWS = Windows 9x-specific definitions (i.e. functions in 9x not in NT)</p>
<p>_WIN32_IE = Internet Explorer-specific definitions (i.e. functions that live in files distributed with IE, such as the Shell Lightweight Utility Functions)</p>
<p>WINVER = definitions common between 9x and NT</p>
<p>Of course that would make too much sense and I&#8217;m sure backwards compatibility throws a wrench in there somewhere.</p>
<p>I&#8217;m afraid I have to nitpick your nitpicks, though. &nbsp;Ignoring the potential legalities of it, you can run Windows applications on WINE under Unix derivatives. &nbsp;WINE provides its own implementations of the Windows libraries, so I don&#8217;t think it would be correct to say that WINE&#8217;s implemenation of import function resolution is part of the Windows operating system (particularly when Windows is not even running). &nbsp;Technically it should probably be something like &#8220;s/Windows operating system/Windows executable loader/&#8221;. &nbsp;That way you can account for executable loaders that process Windows executables on other operating systems. &nbsp;Sorry in advance; please don&#8217;t yell at me.</p>
<div class=post>[<i>&#8220;X applies to Y&#8221; does not contradict &#8220;X applies to Y and Z&#8221;. I only talk about Y. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491713">
				<div id="div-comment-491713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491713">
			April 10, 2007 at 5:01 pm</a>		</div>

		<p>I like the method of setting the version defines to indicate the lowest version of Windows that the program will run on, but it seems like the SDK designers don&#8217;t like that approach.</p>
<p>While it&#8217;s no problem to dynamically load API functions, many of the headers don&#8217;t allow the program to know about types and data structures that pertain to those APIs.</p>
<p>For example, If I want my program to run on Windows NT4 &amp; Windows 95, but also support multiple monitors on newer versions of Windows, it&#8217;s no problem to dynamically load functions like GetMonitorInfo(), but I also have to redefine structures like MONITORINFO and types like HMONITOR because the headers balk at my version defines of 0x0400.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491723">
				<div id="div-comment-491723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491723">
			April 10, 2007 at 5:28 pm</a>		</div>

		<p>I recently &quot;discovered&quot; the NTDDI_VERSION macros. &nbsp;Will you be explaining what DDI stands for and why these are the &quot;preferred&quot; macros to replace the &quot;legacy&quot; macros you listed in your example?</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/aa383745.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/aa383745.aspx</a></p>
<p>And are the NO&lt;api&gt; macros (e.g., NOCOMM) still supported? &nbsp;I&#8217;ve searched the headers for several of them and find they don&#8217;t seem to be used anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491743">
				<div id="div-comment-491743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491743">
			April 10, 2007 at 6:40 pm</a>		</div>

		<p>&quot;Raymond doesn&#8217;t appear to bless this strategy, but what I do is, I define the highest Windows version macro for the APIs and structures I need, and then I consciously avoid directly using any API functions that aren&#8217;t available on all the Windows versions I&#8217;m supporting.&quot;</p>
<p>Beware, you can still run into problems this way. Sometimes structure sizes increase with a new release and when you do the standard</p>
<p>&nbsp;ZeroMemory(&amp;xyz, sizeof(xyz));</p>
<p>&nbsp;xyz.dwSize = sizeof(xyz);</p>
<p>in your code, the API running on an earlier Windows release will check dwSize and refuse to work because it doesn&#8217;t match any sizes it knows. Been there, done that&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491783">
				<div id="div-comment-491783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Name required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491783">
			April 10, 2007 at 8:26 pm</a>		</div>

		<p>What&#8217;s with the U+2020 (DAGGER) and U+2021 (DOUBLE DAGGER)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491793">
				<div id="div-comment-491793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491793">
			April 10, 2007 at 9:49 pm</a>		</div>

		<blockquote><p>
  The general rule with Windows header files is</p>
<p>  that if you don&#8217;t specify which version of</p>
<p>  the header file you want, you get the latest</p>
<p>  version.
</p></blockquote>
<p>Which development tools obey the general rule? &nbsp;In Visual Studio if I forget to declare some macros like _WIN32_WINNT then I get compilation errors instead of the latest version.</p>
<p>Tuesday, April 10, 2007 2:51 PM by Leo Davidson</p>
<blockquote><p>
  Factor in the assumption that people still</p>
<p>  using 95/98 aren&#8217;t going to be interested in</p>
<p>  many types of software (if they were they</p>
<p>  wouldn&#8217;t be running 95/98 anymore)
</p></blockquote>
<p>Factor in the assumption that there are a lot of countries where middle class people can afford to buy used PCs that are powerful enough to run 98 but aren&#8217;t powerful enough to run pirated copies of XP. &nbsp;I even saw one where the vendor had copied XP&#8217;s default wallpaper onto the machine so the customer thought they were running XP. &nbsp;Anyway, I installed AVG Free onto several computers running 98, and I&#8217;m very glad that this was still possible.</p>
<p>On the other hand, try to get Windows Update working on a fresh installation of 98. &nbsp;Try to get Internet Explorer 6 downloaded onto a fresh installation of 98. &nbsp;Just try it. &nbsp;Try either or try both, they catch-22 each other and they catch-22 themselves. &nbsp;Sure there are no new security patches for 98, but it sure would be nice to get the old ones on. &nbsp;I don&#8217;t think Linux will ever be teachable to the general public, but this experience made me want to try.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-491823">
				<div id="div-comment-491823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491823">
			April 11, 2007 at 12:53 am</a>		</div>

		<blockquote><p>
  In Visual Studio if I forget to declare some macros like</p>
<p>  _WIN32_WINNT then I get compilation errors
</p></blockquote>
<p>What version of Visual Studio is that? I&#8217;ve never seen compilation just because I forgot to include a _WIN32_WINNT macro&#8230; In fact,</p>
<p>#include &lt;windows.h&gt;</p>
<p>on its own is a perfectly valid .cpp file and will compile fine for me.</p>
<p>@Name required: Dagger and Double Dagger are footnote markers. They&#8217;re not used in printing as much nowadays, since a simple numbering scheme is more convenient, but if you only have a couple of footnotes, its fine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-491833">
				<div id="div-comment-491833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491833">
			April 11, 2007 at 1:25 am</a>		</div>

		<p>&gt; Factor in the assumption that there are a lot of countries where</p>
<p>&gt; middle class people can afford to buy used PCs that are powerful</p>
<p>&gt; enough to run 98 but aren&#8217;t powerful enough to run pirated copies of XP</p>
<p>Factor in your own willingness to try to sell software to people who cannot afford newer computers and only run pirated copies of Windows anyway. Are people who can only afford low-end, second-hand PCs and pirate copies of Windows going to PAY for your software anyway? Seems like they&#8217;d be more like to pirate your software as well, so why would you be wanting to pander to that particular market at all?</p>
<p>Just because that market is LARGE does not automatically mean it is a market you want to sell to.</p>
<div class="post">[<i>Hey guys, could we like talk about version numbers in Windows header files? Just saying. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491843">
				<div id="div-comment-491843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491843">
			April 11, 2007 at 2:20 am</a>		</div>

		<p>WINVER came from Windows 3.1.</p>
<p>Win32 introduced _WIN32_WINNT for specifing the target Windows NT version.</p>
<p>With Windows 95, Microsoft introduced _WIN32_WINDOWS to specifing the version of non-NT versions of Windows. As well it also used WINVER to do so.</p>
<p>NT 4.0 added compatiblity with Windows 95, but introduced new features not supported in 95. The answer is to use _WIN32_WINNT to specify NT 4.0. Meanwhile the common control library was taken over by the IE team as part of IE 3 and so they need a way to specify a version of IE, so _WIN32_IE was introduced. IE 4 take over the shlwapi library and also the shell32 library, but the new shell32 library was part of the Windows Desktop Update, which was optional on 95 and NT 4, and this (along with the update themselves) created a mess which I am not going into here, other than the fact causing the Windows team to take back these libraries. Regardless of that, _WIN32_IE still exists for compatiblity.</p>
<p>Later on however WINVER got overloaded to describe both lines of Windows (NT and non-NT), which also created a mess. Thankfully both 95, NT 4 and IE 4 is obsolete, and the two lines were merged with XP, which makes the whole mess obsolete.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491853">
				<div id="div-comment-491853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491853">
			April 11, 2007 at 2:38 am</a>		</div>

		<p>And yes, the shell themselves also was taken over by the IE team for IE 4 together with the shlwapi and shell32 libraries and the new version of the shell developed by the IE team was included in the Windows Desktop Update, which is an optional part of IE 4 and included Active Desktop, and was part of Windows 98. But the Windows 2000 team as part of the development of Windows 2000 realized the mess this caused so the shell was taken back by that team and as a result, the shell is no longer updated as part of IE, though shlwapi still is updated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491863">
				<div id="div-comment-491863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Name still required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491863">
			April 11, 2007 at 2:54 am</a>		</div>

		<p>Thanks Dean for the explanation.</p>
<p>I found an article about it:</p>
<p><a href="http://en.wikipedia.org/wiki/Dagger_" target="_new" rel="nofollow">http://en.wikipedia.org/wiki/Dagger_</a>(typography)</p>
<p>Quote:</p>
<p>&#8220;However, the dagger is only used as a second footnote when an asterisk is already used. Third footnote employs the double daggers.&#8221;</p>
<p>Raymond, did you have a first footnote (*) in mind to compliment the second (â ) and third (â¡)?</p>
<div class="post">[<i>I understand there are a lot of violations of formal writing style over on LiveJournal, too; you might want to let them know. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-491893">
				<div id="div-comment-491893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491893">
			April 11, 2007 at 3:55 am</a>		</div>

		<p>Wednesday, April 11, 2007 12:53 AM by Dean Harding </p>
<p>&gt;&gt; In Visual Studio if I forget to declare</p>
<p>&gt;&gt; some macros like _WIN32_WINNT then I get</p>
<p>&gt;&gt; compilation errors</p>
<p>&gt;</p>
<p>&gt; What version of Visual Studio is that?</p>
<p>I think it was Visual Studio 2005 SP1. &nbsp;I don&#8217;t remember if I had to make similar adjustments to projects that I started compiling under Visual Studio 2005 RTM.</p>
<p>&gt; I&#8217;ve never seen compilation just because I</p>
<p>&gt; forgot to include a _WIN32_WINNT macro&#8230; </p>
<p>Well of course, Visual Studio isn&#8217;t psychic, you have to click &#8220;ãã«ã&#8221; &#8211; &#8220;ã½ãªã¥ã¼ã·ã§ã³ã®ãã«ã&#8221;.</p>
<p>Meanwhile the NTDDI_VERSION macros look a bit useless to me. &nbsp;Suppose you can run on W2000 SP3 and later, and WXP SP1 and later, but not WXP RTM. &nbsp;The MSDN page recommends tests that look pretty useless.</p>
<div class=post>[<i>The old macros were just as useless. What&#8217;s your point? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-491953">
				<div id="div-comment-491953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bugvanquisher.spaces.live.com' rel='external nofollow' class='url'>Tanveer Badar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-491953">
			April 11, 2007 at 9:11 am</a>		</div>

		<p>I thought doing only</p>
<p>#define WINVER &nbsp; &nbsp; &nbsp; &nbsp; 0x0400</p>
<p>automatically defined the rest of them to be compatible versions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-492003">
				<div id="div-comment-492003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492003">
			April 11, 2007 at 11:43 am</a>		</div>

		<p>Norman and Dean, at least at warning level 4, VS 2003 will throw a warning if you don&#8217;t define _WIN32_WINNT to something. &nbsp;If you then have warnings as errors, it becomes an error.</p>
<p>Since we use both of these (/W4 /WX), not setting _WIN32_WINNT in the project settings for one of our projects is an error.</p>
<p>I seem to recall Norman saying that he did the same.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492063">
				<div id="div-comment-492063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kbiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492063">
			April 11, 2007 at 1:03 pm</a>		</div>

		<p>Name still required: &nbsp;Wow, you didn&#8217;t know what a dagger was but now you&#8217;re going to slap Raymond for not using it according to Wikipedia&#8217;s uncited rules? &nbsp;You&#8217;re probably one of those people who believe that it&#8217;s also incorrect to use split infinitives or end a sentence in a preposition also. &nbsp;No wonder Raymond has begun to nitpick his own nitpicks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-492073">
				<div id="div-comment-492073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dmurillo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492073">
			April 11, 2007 at 1:26 pm</a>		</div>

		<p>Hi Raymond,</p>
<p>I&#8217;m on the side of the silent majority.</p>
<p>I love your posts and always learn something even if the subject is already known to me.</p>
<p>I hope that the nitpickers will go nitpick elsewhere in the near future. &nbsp;They waste your precious time.</p>
<p>Again, thank you Mr. Chen!</p>
<p>DM</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492093">
				<div id="div-comment-492093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/04/11/2079137.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492093">
			April 11, 2007 at 1:43 pm</a>		</div>

		<p>It&#8217;s a confusing story.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-492113">
				<div id="div-comment-492113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/04/11/2079137.aspx' rel='external nofollow' class='url'>The Old New Thing : What's the difference between WINVER, _WIN32_WINNT, _WIN32_WINDOWS, and _WIN32_IE?</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492113">
			April 11, 2007 at 1:43 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2007/04/11/2079137.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2007/04/11/2079137.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492213">
				<div id="div-comment-492213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492213">
			April 11, 2007 at 3:39 pm</a>		</div>

		<p>Joseph Bruno: &nbsp;</p>
<p>&quot;Especially as Windows XP only has a 10% market share.&quot;</p>
<p>I don&#8217;t believe it. &nbsp;Where did you get this number?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-492243">
				<div id="div-comment-492243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492243">
			April 11, 2007 at 4:17 pm</a>		</div>

		<p>David, you have to read the other half of that sentence:</p>
<p>90% of PC users use Windows, not Windows XP, Windows Vista, Windows 2000 or Windows 98.</p>
<p>or phrased a little differently:</p>
<p>Especially as only 10% of PC users know that they&#8217;re running Windows XP. &nbsp;The other 90% of PC users don&#8217;t know or care what version of Windows they are running.</p>
<p>(I&#8217;m not saying that this number is correct, just explaining what was meant.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492293">
				<div id="div-comment-492293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492293">
			April 11, 2007 at 11:54 pm</a>		</div>

		<blockquote><p>
  The old macros were just as useless. What&#8217;s</p>
<p>  your point? -Raymond
</p></blockquote>
<p>(1) &nbsp;I have to SET not use the old macros. &nbsp;I do set the old macros. &nbsp;The result is not useless. &nbsp;But that wasn&#8217;t my point then, that&#8217;s my point now in response to one of your statements here.</p>
<p>(2) &nbsp;On Tuesday, April 10, 2007 5:28 PM, Adrian commented about the new macros. &nbsp;I read about the new macros. &nbsp;I kind of wonder what their purpose was supposed to be, but that was my &quot;obvious&quot; point then. &nbsp;I can&#8217;t see any use for them, which was my stated point then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-492303">
				<div id="div-comment-492303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.daan.us/2007/04/11/versioning/' rel='external nofollow' class='url'>versioning &middot; disordered thought processes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492303">
			April 11, 2007 at 11:57 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.daan.us/2007/04/11/versioning/" rel="nofollow">http://blog.daan.us/2007/04/11/versioning/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492343">
				<div id="div-comment-492343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492343">
			April 12, 2007 at 5:05 am</a>		</div>

		<p>Re: re: re:</p>
<p>&gt; The old macros were just as useless. What&#8217;s</p>
<p>&gt; your point? -Raymond</p>
<p>Just now I figured out two things that you might have meant. &nbsp;(1) SETTING the macros could be included in the meaning of USING the macros. &nbsp;(2) It&#8217;s equally impossible to set the old macros with the necessary precision as it is to set the new macros with the necessary precision.</p>
<p>The only settings that I had to make were in order to specify either Windows 2000 RTM or newer, or Windows Vista RTM or newer. &nbsp;So I hadn&#8217;t noticed until now that they are indeed insufficiently precise.</p>
<p>I still can&#8217;t help wondering, since some people surely already knew what the problems were with the old macros, what was the purpose in inventing another way to provide the exact same problems. &nbsp;Probably no one knows the answer though. &nbsp;(And even if anyone knows, the answer will be useless because even knowing the answer will still leave the problems unchanged.)</p>
<div class="post">[<i>&#8220;In an attempt to make some sense out of this disaster&#8221;. Instead of having to set four macros (and make sure you set them consistently), you just set one, and it sets the other four. I don&#8217;t know why I&#8217;m writing this; I&#8217;m just repeating the paragraph in this comment. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-492543">
				<div id="div-comment-492543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492543">
			April 12, 2007 at 10:46 pm</a>		</div>

		<p>&gt; Instead of having to set four macros (and</p>
<p>&gt; make sure you set them consistently), you</p>
<p>&gt; just set one, and it sets the other four.</p>
<p>Um, if it did exactly that, then your answer would probably be more obvious. &nbsp;Two reasons why that wasn&#8217;t obvious are: &nbsp;(1) the cited MSDN page makes it look like programs should use the NTDDI macros instead of setting them, and (2) the NTDDI macros cloud things up by pretending to be able to set minimum versions (e.g. Windows 2000 SP3 or later, and Windows XP SP1 or later, which only in our dreams would we be able to specify syntactically), whereas the old macros didn&#8217;t cloud things up that way because they didn&#8217;t even try.</p>
<p>&gt; I&#8217;m just repeating the paragraph in this comment.</p>
<p>Well yeah in this comment you repeated a paragraph from a later blog entry.</p>
<p>Anyway I was trying to answer your &#8220;What&#8217;s your point?&#8221; question.</p>
<p>[, Nitpicker&#8217;s corner: &nbsp;a comma doesn&#8217;t override operator priorities the way parentheses do, but if I properly parenthesized English expressions using the or and and operators then it would be harder to read than the commandeered syntax.]</p>
<div class="post">[<i>Documentation does not relieve you of the responsibility to use your brain. Why would a program test the NTDDI macros? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492603">
				<div id="div-comment-492603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-492603">
			April 13, 2007 at 5:15 am</a>		</div>

		<p>&gt; Why would a program test the NTDDI macros?</p>
<p>Why would a program test __STDC__? &nbsp;Nonetheless that&#8217;s the direction the language design went.</p>
<p>Why do programs have to do tons of other nutty stuff? &nbsp;Because<br />
the API makes them do it. &nbsp;Sometimes MSDN says why, sometimes not.</p>
<div class="post">[<i>I still can&#8217;t tell if you&#8217;re playing the naif<br />
just to taunt me or if you&#8217;re genuinely confused. I&#8217;m going to assume<br />
you&#8217;re just taunting me. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493263">
				<div id="div-comment-493263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-493263">
			April 15, 2007 at 11:40 pm</a>		</div>

		<blockquote><p>
  I&#8217;m going to assume you&#8217;re just taunting me.
</p></blockquote>
<p>Um, when I posted this:</p>
<blockquote><p>
  &gt; Why would a program test <strong>STDC</strong>?</p>
<p>  &gt; Nonetheless that&#8217;s the direction the</p>
<p>  &gt; language design went.
</p></blockquote>
<p>I didn&#8217;t think it was a taunt. &nbsp;If you don&#8217;t see that this is exactly the same as how the MSDN page on the NTDDI macros looked when I read that page, then I think maybe I owe you a taunt. &nbsp;Congratulations on your self-fulfilling buttumption.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-493303">
				<div id="div-comment-493303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stdcall</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-493303">
			April 16, 2007 at 9:34 am</a>		</div>

		<p>What a fuzz about some stupid macros. Just read the header files, judge from there what to do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-520743">
				<div id="div-comment-520743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/06/29/3594231.aspx' rel='external nofollow' class='url'>The Old New Thing : Don't forget to pass the current directory along with the command line to your single-instance program</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070410-00/?p=27313#comment-520743">
			June 29, 2007 at 4:20 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2007/06/29/3594231.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2007/06/29/3594231.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

