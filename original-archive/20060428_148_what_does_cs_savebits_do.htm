<html>
<head>
<title>What does CS_SAVEBITS do?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>What does CS_SAVEBITS do?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>April 28, 2006 / year-entry #149</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>35</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If you specify the CS_SAVEBITS class style, then the window manager will try to save the bits covered by the window. But the real question is why, because that is your guide to using this power only for good, not for evil. When a window whose class specifies the CS_SAVEBITS class style is displayed, the...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If you specify the <code>CS_SAVEBITS</code> class style, then the window manager will try to save the bits covered by the window. But the real question is why, because that is your guide to using this power only for good, not for evil.</p>
<p> When a window whose class specifies the <code>CS_SAVEBITS</code> class style is displayed, the window manager takes a snapshot of the pixels on the screen where the window will be displayed. First, it asks the video card to store the pixels in available off-screen video memory (fast). If no video memory is available, then the pixels will be stored in system memory (slower). If the saved pixels have not been discarded in the meantime (see below), then when the window is hidden, the saved pixels are copied back to the screen and validated; in other words, the pixels are marked as "good" and no <code>WM_PAINT</code> message is generated. </p>
<p> What invalidates the saved pixels? Anything that would cause those pixels to be out of sync with what should be on the screen once the popup window is removed. Here are some examples: </p>
<ul>
<li> If the popup window moves, then the saved pixels are discarded, since putting those pixels back on the screen would put them in the wrong place. </li>
<li> If an underlying window invalidates itself (most commonly via <code>InvalidateRect</code>), then the saved pixels are also discarded, because the underlying window has indicated that it wants to change its pixels. </li>
<li> If any windows beneath the popup change size or position or z-order, then the saved pixels are of no use. </li>
<li> If any windows are created or destroyed beneath the popup. </li>
<li> If somebody calls <code>GetDC</code> for a window beneath the popup and starts drawing. </li>
</ul>
<p> You get the idea. If copying the saved pixels back to the screen would result in an inconsistent display, then the saved pixels are discarded. </p>
<p> So how do you use this power for good and not for evil? </p>
<p> One consideration is that the region should cover a relatively small portion of the screen, because the larger the saved bitmap, the less likely it will fit into available off-screen video memory, which means the more likely it will have to travel across the bus in a video-to-system-memory blit, the dreaded "vid-sys blt" that game developers are well familiar with. In the grand scheme of vid/sys blts, "vid-vid" is the fastest (since the video card is very good at shuffling memory around within itself), "sys-sys" is next best (since the motherboard can shuffle memory around within itself, though it'll cost you CPU cache space), "sys-vid" is in third place, and "vid-sys" is the worst: Programs write to video memory much more often than they read from it. As a result, the bandwidth between the video card and system memory is optimized for writing to video, not reading from it. </p>
<p> But the primary concern for deciding when to use the <code>CS_SAVEBITS</code> window class style is not making the window manager go to all the trouble of saving the pixels, only to have to throw them away. A window that is a good candidate for the <code>CS_SAVEBITS</code> style is therefore one that does not move, covers a relatively small portion of the screen, and is visible for only a short time. That the window shouldn't move is obvious: If the window moves, then the saved pixels are useless. The other two rules of thumb try to minimize the opportunity for another window to do something that invalidates the saved pixels. By keeping the window small in area and putting it on the screen for only a short time, you keep the "target" small both spatially and temporally. </p>
<p> Consequently, the best candidates for <code>CS_SAVEBITS</code> are menus, tooltips, and small dialogs, since they aren't too big, they don't typically move around, and they go away pretty quickly. </p>
<p> (Some people appear to be under the mistaken impression that <code>CS_SAVEBITS</code> saves the bits of the window itself. I don't know where people get this impression from since even a modicum of experimentation easily demonstrates it to be false. The Windows drawing model follows the principle of <a href="http://blogs.msdn.com/oldnewthing/archive/2004/12/20/327369.aspx"> Don't save anything you can recalculate</a>.) </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (35)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-374653">
				<div id="div-comment-374653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374653">
			April 28, 2006 at 11:18 am</a>		</div>

		<blockquote><p>
  The Windows drawing model follows the principle of Don&#8217;t save anything you can recalculate.</p>
<p>Well, except for the pixels behind a window that specified CS_SAVEBITS, that is. &nbsp;;-)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-374693">
				<div id="div-comment-374693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374693">
			April 28, 2006 at 12:09 pm</a>		</div>

		<p>In the world of Vista, where the window manager is saving all the bits of top-level windows anyway for things like glass effects and WM_PAINT-less window dragging, is this flag actually relevant anymore?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-374733">
				<div id="div-comment-374733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374733">
			April 28, 2006 at 12:39 pm</a>		</div>

		<p>Not all Vista machines will be running glass. For example, when running over TS, glass is disabled I believe. If you have questions about how glass changes the rules, you can ask Nick Kramer or Greg Schechter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-374743">
				<div id="div-comment-374743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374743">
			April 28, 2006 at 12:58 pm</a>		</div>

		<p>Raymond:<br />
<br />&quot;I don&#8217;t know where people get this impression from since even a modicum of experimentation easily demonstrates it to be false&quot;</p>
<p>I made this mistake too!<br />
<br />The cause seems to be the misleading name combined with the too short documentation (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/aboutwindow.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/aboutwindow.asp</a>)<br />
<br />Granted, there is another article stating what it does but not in the &quot;reference&quot; part of MSDN<br />
<br />There are also sometimes &#8216;translation&#8217; problem when someone reads a vague or complicated text in a documentation that is not is his native language</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-374823">
				<div id="div-comment-374823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374823">
			April 28, 2006 at 3:13 pm</a>		</div>

		<p>@BrianK:<br />
<br />Ok, my mistake here! But see how firefox displays the page to me:<br />
<br /><a rel="nofollow" target="_new" href="http://nawak.free.fr/oldnewthing/msdn_class_styles.jpg" rel="nofollow">http://nawak.free.fr/oldnewthing/msdn_class_styles.jpg</a><br />
<br />(In IE, it is unambiguously displayed though)</p>
<p>Associating only the second part with CS_SAVEBITS, you can see why I qualified the description as vague!</p>
<p>The non ambiguous page I was refering to was:<br />
<br /><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwui/html/msdn_classy32.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwui/html/msdn_classy32.asp</a><br />
<br />(which shows up fine in Firefox)</p>
<p>Reading the MSDN now, I cannot see how I made the mistake at the time, but I will have to check my old MSDN CDs to see if the style description has not been enhanced with time.<br />
<br />The style&#8217;s description is quite long compared to other&#8217;s, leading me to think that it has been clarified and detailed after many people like me were caught! If not&#8230; then I was certainly a stupid programmer just judging flags by their names, and not reading docs!</p>
<p>The documentation is fine now, so I join up with Raymond and wonder how people can make such misinterpretations! ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-374943">
				<div id="div-comment-374943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374943">
			April 28, 2006 at 5:37 pm</a>		</div>

		<p>For examples 1 and 2, why are all pixels discarded? Surely the pixels could&#8217;ve been mapped to the screen coordinates instead of merely associated with the window? So if for instance the window moves, you don&#8217;t have to invalidate the saved pixels?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-374963">
				<div id="div-comment-374963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374963">
			April 28, 2006 at 5:46 pm</a>		</div>

		<p>8: It&#8217;s possible that only some of the bits are discarded. I&#8217;m not the expert here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-374803">
				<div id="div-comment-374803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374803">
			April 28, 2006 at 2:40 pm</a>		</div>

		<p>Nawak, the article you linked to says this:</p>
<p>&gt; CS_SAVEBITS<br />
<br />&gt;<br />
<br />&gt; Saves, as a bitmap, the portion of the screen image obscured by a window of this class. &nbsp;&lt;&#8230;&gt;</p>
<p>To me, it seems obvious from that that the WM is saving the pixels *behind* the window, not the window&#8217;s pixels (that&#8217;s what &quot;obscured by&quot; implies, anyway).</p>
<p>But OTOH, I&#8217;m a native English speaker; it&#8217;s maybe not as obvious for someone who isn&#8217;t. &nbsp;That seems to be your point too, I think. &nbsp;(Though I don&#8217;t think that article is vague or complicated. &nbsp;However, I&#8217;m also used to reading manpages, so for whatever that&#8217;s worth&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-374973">
				<div id="div-comment-374973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Steward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-374973">
			April 28, 2006 at 5:53 pm</a>		</div>

		<p>I misunderstood it for a short while, because it could be read as</p>
<p>&gt; Saves, as a bitmap, the portion of the screen image &#8211; obscured by a window &#8211; of this class.</p>
<p>i.e. saves an image of a window of this class, when it&#8217;s obscured by *another* window. &nbsp;So if you&#8217;re looking for, say, WS_EX_LAYERED, and find this, you&#8217;re likely to try it, guessing it&#8217;s just an example of badly written documentation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375013">
				<div id="div-comment-375013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric TF Bat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375013">
			April 28, 2006 at 8:08 pm</a>		</div>

		<p>I remember years ago, in the eighties perhaps, hearing that IBM had taken out a patent on the concept of &quot;backing store&quot;, ie saving the portion of the background that&#8217;s about to be obscured by an opening window, and restoring it when the window closes. &nbsp;I don&#8217;t know if the patent was approved, but I think that was the point &#8212; years before the noble and respected journalists of Slashdot got on the bandwagon &#8212; that I realised that patenting *ideas* rather than *processes* was insane.</p>
<p>Any idea if the patent is referenced by the CS_SAVEBITS issue?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375103">
				<div id="div-comment-375103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">WikiServer Guy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375103">
			April 29, 2006 at 4:38 am</a>		</div>

		<p>Hmmm, interesting. I was hacking around with java recently and found it actually disables the CS_SAVEBITS style on the native Win32 file dialog. </p>
<p>So, I guess you need to be careful about this flag even when you are using native dialogs (especially with race issues as well, I guess) :).</p>
<p><a rel="nofollow" target="_new" href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508670" rel="nofollow">http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508670</a><br />
<br /><a rel="nofollow" target="_new" href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4189244" rel="nofollow">http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4189244</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375143">
				<div id="div-comment-375143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375143">
			April 29, 2006 at 9:50 am</a>		</div>

		<p>&quot;I don&#8217;t know where people get this impression from since even a modicum of experimentation easily demonstrates it to be false.&quot;</p>
<p>Programmpers should not need to experiment to find out what operating system API&#8217;s do. It should all be clearly documented, which in the case of windows it usually isn&#8217;t. MSDN is terrible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-375153">
				<div id="div-comment-375153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375153">
			April 29, 2006 at 11:26 am</a>		</div>

		<p>Bob: My point was that even if you&#8217;re the sort of person who ignores documentation and prefers experimentation, you still should have figured it out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375223">
				<div id="div-comment-375223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Sartain</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375223">
			April 29, 2006 at 6:40 pm</a>		</div>

		<blockquote>
<ol>
<li>it asks the video card to store the pixels in available off-<br />
  <br />&gt; screen video memory (fast).<br />
  <br />&gt; 2. If no video memory is available, then the pixels will be stored<br />
  <br />&gt; in system memory (slower).<br />
  <br />&gt; 3. &#8230; the saved pixels are copied back to the screen and validated;<br />
  <br />&gt;<br />
  <br />&gt; One consideration is that the region should cover a relatively small<br />
  <br />&gt; portion of the screen, because the larger the saved bitmap, the less<br />
  <br />&gt; likely it will fit into available off-screen video memory, which<br />
  <br />&gt; means the more likely it will have to travel across the bus in a<br />
  <br />&gt; video-to-system-memory blit&#8230;</p>
<p>I don&#8217;t full understand why you would be copying from video to system memory. If it&#8217;s too large a bitmap to fit in video memory, wouldn&#8217;t it then be in system memory and require a system to video blit? And from my experience in the gaming world, video to system blits are not only very very slow, they can be quite unreliable as well.</li>
</ol>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375293">
				<div id="div-comment-375293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375293">
			April 30, 2006 at 2:56 am</a>		</div>

		<p>I&#8217;m not sure, but it looks like Sun&#8217;s problem was that they were repainting the window from another thread without invalidating the rectangle. Probably the repainted parts got clipped, and the saved bits were put back the way they were because they are discarded by an invalidation (but not just painting in the saved area).</p>
<p>The proper thing to do would be to have the thread invalidate the area of the dismissed menu rather than just repainting it. If they&#8217;re still using this technique, it may cause problems with the new window manager, too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375353">
				<div id="div-comment-375353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375353">
			April 30, 2006 at 3:09 pm</a>		</div>

		<p>What happens if there&#8217;s some overlay in the way? Like the WMP windows or the double buffered windows which don&#8217;t show up in screenshots? If the bits are discarded for GDI, but not for DirectDraw, could there be a visual artifact?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375363">
				<div id="div-comment-375363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Sartain</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375363">
			April 30, 2006 at 3:21 pm</a>		</div>

		<p>Ok, I gotcha. I apologize for being stupid there. I&#8217;m still rather surprised that involving a vid-&gt;sys blit would ever be involved in a performance optimization. In the 3D world companies like nVidia have been telling us game developers to avoid it like the plague.</p>
<p>For example, search for &quot;dramatically hurting performance&quot; here:<br />
<br /><a rel="nofollow" target="_new" href="http://developer.nvidia.com/object/General_FAQ.html" rel="nofollow">http://developer.nvidia.com/object/General_FAQ.html</a></p>
<p>Part of the problems with games and video readback is due to long pipelines and flushing though which Windows, at least right now, doesn&#8217;t have to deal with.</p>
<p>Thanks Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-375393">
				<div id="div-comment-375393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375393">
			April 30, 2006 at 4:20 pm</a>		</div>

		<p>8: The window manager can&#8217;t &quot;see&quot; overlays (handled by DirectX) or layered windows (handled by GDI). So whatever happens to those bits is DirectX/GDI&#8217;s problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-375343">
				<div id="div-comment-375343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375343">
			April 30, 2006 at 1:38 pm</a>		</div>

		<p>Michael Sartain: As I already wrote, &quot;the window manager takes a snapshot of the pixels on the screen&quot; The pixels are on the screen &#8211; they are in video memory already. The question is where you put the *copy* of those pixels. If the copy has to go into system memory, then you have a vid-sys blt.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375433">
				<div id="div-comment-375433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375433">
			April 30, 2006 at 6:48 pm</a>		</div>

		<p>Ok so I reinstalled Visual Studio 97 (My IDE at the time) only to find out that &quot;infoviewer&quot; (the integrated msdn help system of VC97) refuses to work on my computer&#8230; (Is Internet Explorer too recent? I don&#8217;t know, but it couldn&#8217;t display anything!)</p>
<p>Still I managed to extract the MSDN documentation from its closed IVT format with a tool named ivt2html, and after a little bugfix in it, I finally found the doc I had at the time and&#8230; it was the same&#8230; :)<br />
<br />I don&#8217;t know how I could have misinterpreted it but I did! Maybe I read it the way noted by &quot;Mark Steward&quot;, maybe my english was much worse at the time and I made the sense of the description only with the title &#8216;SAVEBITS&#8217;, maybe I couldn&#8217;t accept the idea of a flag causing the bits from *another* window to be saved&#8230;<br />
<br />That makes me think: wouldn&#8217;t it have been better to name the flag CS_TMPWND or something like that? And leaving the gory details of the window manager&#8217;s behaviour out of the way of the application programmer?<br />
<br />Anyway, thanks Raymond for clearing that up! I won&#8217;t make the mistake again if I ever come back to Win32 programming!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-375543">
				<div id="div-comment-375543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375543">
			May 1, 2006 at 11:26 am</a>		</div>

		<p>At the bottom of every MSDN page is a &quot;Contact Us&quot; link. And remember, a polite tone is much more effective than a confrontational one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375683">
				<div id="div-comment-375683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375683">
			May 1, 2006 at 3:39 pm</a>		</div>

		<p>OK, I figured that was a general &quot;contact Microsoft&quot; link; apparently not. &nbsp;I&#8217;ll try it, thanks.</p>
<p>(Regarding the confrontational tone; you&#8217;re right, of course. &nbsp;I&#8217;m not sure what happened; I&#8217;m going to guess that I started getting defensive about what I perceived as a &quot;Firefox is crappy because it doesn&#8217;t support this colored background thingy, so we&#8217;ll hand it this &quot;other&quot; stylesheet&quot; (even though it does support it) web design. &nbsp;Not that that&#8217;s an excuse, though.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-375693">
				<div id="div-comment-375693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375693">
			May 1, 2006 at 3:48 pm</a>		</div>

		<p>The &quot;Contact Us&quot; page sends you to different forms depending on what you are commenting about. (And I wasn&#8217;t directing the &quot;confrontational tone&quot; thing at you, just a more general piece of advice for anybody else who wanted to send feedback.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375513">
				<div id="div-comment-375513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375513">
			May 1, 2006 at 10:54 am</a>		</div>

		<p>Nawak &#8212; regarding your reply to me, I use Firefox as well. &nbsp;But I forgot about the mental workaround I had put in place when I first started using it to view MSDN and I saw the first table.</p>
<p>I realized at that point that the stylesheet provided to FF must have been different from that provided to IE. &nbsp;FF gets an &quot;ns6.css&quot; stylesheet, while IE gets one named &quot;ie4.css&quot;. &nbsp;Some information is in both, but not most.</p>
<p>When I figured out that I was seeing a table, and basically that the contents of each row were centered vertically, I started mentally figuring out where the break between table rows was supposed to be, and taking that into account whenever I read an MSDN page with a table.</p>
<p>So, if you change your FF user-agent string to whatever it is that IE6 on win2k provides (I have the User Agent Switcher extension installed), you will get the gray background CSS. &nbsp;(And note that this CSS works *JUST FINE* with FF; MSDN really has no excuse whatsoever to be preventing FF from getting it.) &nbsp;Also, if you add:</p>
<p>table.clsStd {<br />
<br />	border: outset 1px black !important;<br />
<br />}<br />
<br />table.clsStd tr td, table.clsStd tr th {<br />
<br />	border: inset 1px black !important;<br />
<br />}</p>
<p>to the userContent.css file in the &quot;chrome&quot; subdirectory of your FF profile directory, then you&#8217;ll get a &quot;normal&quot; table border around the tables and cells; that would probably help as well. &nbsp;If you know CSS, you can probably modify this to provide the gray backgrounds.</p>
<p>Raymond, is there some way to file a bug against MSDN that it should be serving the same stylesheet to FF (and NS6, for that matter) as it sends to IE &gt;=4? &nbsp;Because otherwise, the docs are confusing to people that use FF but don&#8217;t know what&#8217;s going on with the HTML.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-375523">
				<div id="div-comment-375523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375523">
			May 1, 2006 at 11:02 am</a>		</div>

		<p>Oops, correction. &nbsp;The IE CSS does not work perfectly with FF &#8212; FF doesn&#8217;t get a gradient background in the non-documentation frames in that frameset (top and bottom) when its user-agent is set to IE. &nbsp;Not that I think that&#8217;s a huge deal, but the people that wrote the MSDN page probably do.</p>
<p>Still, MSDN needs to at *minimum* add the background-color rule to the NS6 stylesheet. &nbsp;If it was a page I controlled, I&#8217;d also factor out all the stuff that works in all (graphical) browsers, so that if it gets updated it won&#8217;t be missed in one of the stylesheets. &nbsp;And obviously background-color on a td/th is supported by any graphical browser, so it&#8217;d go in there, not in the IE4 stylesheet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-375723">
				<div id="div-comment-375723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-375723">
			May 1, 2006 at 4:16 pm</a>		</div>

		<p>(Well, upon re-reading my own comment, I thought it did sound confrontational. &nbsp;So I did get *a* hint, even if one wasn&#8217;t intended. &nbsp;;-) &nbsp;Anyway, whatever; thanks again.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-376173">
				<div id="div-comment-376173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-376173">
			May 2, 2006 at 2:59 pm</a>		</div>

		<p>BrianK:<br />
<br />Thanks! Your tip did work!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-376433">
				<div id="div-comment-376433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-376433">
			May 3, 2006 at 9:02 am</a>		</div>

		<p>Ah, user stylesheets. &nbsp;Aren&#8217;t they great? &nbsp;;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-377673">
				<div id="div-comment-377673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-377673">
			May 5, 2006 at 10:33 pm</a>		</div>

		<blockquote><p>
  And remember, a polite tone is much more<br />
  <br />&gt; effective than a confrontational one.</p>
<p>Only sometimes. &nbsp;I think you&#8217;re still not quite aware of how Microsoft as a corporation treats its general customers. &nbsp;A polite tone still gets us nowhere, and after half a dozen repetitions of garbage it&#8217;s pretty hard to keep trying to be polite.</p>
<p>Your blog and blogs of a few of your colleagues have taught me that Microsoft isn&#8217;t as monolithic internally as it is in crushing the marketplace. &nbsp;It took me a long time to learn that, and I apologize to you (Mr. Chen) personally for the length of time it took me to learn that.</p>
<p>During the past week I had a series of around 6 e-mails with some of your colleagues who are every bit as dense and dishonest as your company ever was. &nbsp;A polite tone got me nowhere. &nbsp;I hardly know how to write my next e-mail to them in anything other than the confrontational tone that they have well earned. &nbsp;Would you like to help?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-377683">
				<div id="div-comment-377683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-377683">
			May 5, 2006 at 10:52 pm</a>		</div>

		<p>I am not Microsoft as a corporation. I am me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-377913">
				<div id="div-comment-377913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nobody</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-377913">
			May 7, 2006 at 6:56 pm</a>		</div>

		<p>In case anyone is still interested, what Raymond said is true: moving the CS_SAVEBITS window will trash all the bytes, it doesn&#8217;t do clever stuff to try and reuse anything.</p>
<p>It&#8217;s strange CS_SAVEBITS is used so often. The &quot;About&quot; dialogs in standard Windows apps use it too. Now that I think about it, it makes some sense to use it on modal windows&#8230;</p>
<p>There are certain performance analysis tools for graphics cards which show the amount of available memory, and these things show easily. I would dare to say that memory is seldom an issue, as it&#8217;s rather difficult for Windows to use &gt; 32 megs on its own (at 1600&#215;1200), and I&#8217;d assume most modern cards have that at least. I already had to do pretty weird stuff to get it to reach 16 megs, which brings us back to circa 2000.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-377943">
				<div id="div-comment-377943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-377943">
			May 7, 2006 at 9:15 pm</a>		</div>

		<p>Friday, May 05, 2006 10:52 PM by oldnewthing<br />
<br />&gt; I am not Microsoft as a corporation. I am me.</p>
<p>Right, OK, I repeat my apology for the length of time it took me to learn that.</p>
<p>Meanwhile your company continues to demonstrate that your company is still your company. &nbsp;Being polite got me nowhere. &nbsp;I&#8217;m still trying to figure out a way to write one more polite e-mail on the issue.</p>
<p>Then there were a couple of bug reports on the MSDN feedback site which your company resolved not to fix:<br />
<br />one which your company admitted is a bug (reason: &nbsp;the same admitted bug has been shipping for multiple generations); and<br />
<br />one for which I sent a screenshot, your company asked questions but ignored my answers, and your company closed the bug report. &nbsp;Wonder why anyone observes that Microsoft is still Microsoft?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-377973">
				<div id="div-comment-377973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-377973">
			May 8, 2006 at 12:56 am</a>		</div>

		<p>Complaining to me about the behavior of other people may make you feel better, but it won&#8217;t accomplish much else. I&#8217;ll assume that you&#8217;re just venting and just let slide all your nasty comments.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-378313">
				<div id="div-comment-378313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-378313">
			May 8, 2006 at 9:02 pm</a>		</div>

		<blockquote><p>
  and just let slide all your nasty comments.</p>
<p>Well sure. &nbsp;When your company stated that the reason for not fixing an admitted bug is that the same bug has been shipping for multiple generations, your company did word it politely. &nbsp;When your company appended a false statement to that one, your company worded the false statement politely too.</p>
<p>Politeness gets me nowhere, frustration gets me nowhere, and nastiness gets me nowhere. &nbsp;Nonetheless may I suggest that it is human nature to get frustrated by a lot of that garbage, it is human nature for frustration to turn into nastiness, and some of us aren&#8217;t quite sure whether nastiness is really more offensive than lies. &nbsp;Though it must be admitted that lies will get you somewhere while nastiness won&#8217;t.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-473573">
				<div id="div-comment-473573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/02/19/1716211.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060428-00/?p=31373#comment-473573">
			February 19, 2007 at 10:00 am</a>		</div>

		<p>The background behind a poorly-understood function.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

