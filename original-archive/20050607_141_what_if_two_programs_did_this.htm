<html>
<head>
<title>What if two programs did this?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>What if two programs did this?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 7, 2005 / year-entry #142</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>54</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">The thought experiment "Imagine if this were possible" is helpful in thinking through whether Windows lets you do something or other. (A special case of this is "When people ask for security holes as features.") If the possibility leads to an obvious contradiction or the violation of generally-accepted rules of metaphysics, then you can be...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>The thought experiment "Imagine if this were possible" is helpful in thinking through whether Windows lets you do something or other. (A special case of this is "<a href="http://blogs.msdn.com/oldnewthing/archive/2004/11/22/267890.aspx">When people ask for security holes as features</a>.") If the possibility leads to an obvious contradiction or the violation of generally-accepted rules of metaphysics, then you can be pretty sure that Windows doesn't support it. (Of course, the absence of such a contradiction doesn't prove that Windows <strong>does</strong> support it. But you can use it to rule out obvious bad ideas.)</p>
<p> The question "What if two programs did this?" is also helpful in evaluating a feature or a design request. Combining this with "Imagine if this were possible" leads to an impressive one-two punch. Here are a few examples: </p>
<dl>
<dt>"How do I create a window that is never covered by any other windows,     not even other topmost windows?" </dt>
<dd>Imagine if this were possible and imagine if two programs did this.     Program&nbsp;A creates a window that is "super-topmost" and so does     Program&nbsp;B.  Now the user drags the two windows so that they overlap.     What happens?  You've created yourself a logical impossibility.     One of those two windows must be above the other, contradicting     the imaginary "super-topmost" feature. </p>
</dd>
<dt>"How do I mark my process so that it always the first/last to     receive the system shutdown notification?  I want to do something     before/after all other programs have shut down." </dt>
<dd>
<p>Imagine if this were possible and imagine if two programs did this.     You now have two programs both of which want to be first/last.     But you can't have two first or two last things.     One of them must lose.     (This of course generalizes to other things people might want to be     first or last.) </p>
</dd>
<dt>"How do I make sure that my program is always the one that runs when     the user double-clicks an .XYZ file?" </dt>
<dd>
<p>Imagine if this were possible and imagine if two programs did this.     Now the user double-clicks an .XYZ file.  Which program runs?     </p>
<p>In this case, the solution is to leave the user in charge of their     file associations; if they decide that they want your competitor's     program to be used for .XYZ files, then that's their decision and you     should respect it.     </p>
<p><a href="http://blogs.msdn.com/FreeAssociations/">My colleague Zeke</a>     [link fixed 11am],     who is responsible, among other things, for the way file associations     work in Explorer, provides a few alternatives:     </p>
<ul>
<li>     <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_arbitrary_file_types.asp">     Put your program in the "Open With" list</a> and set .XYZ as one of     your supported types.  Users can right-click     an .XYZ file and select "Open With...", then select your program     from the list.     </li>
<li>     <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_verbs.asp">     Register a supplemental verb that says "Open with Your Program"</a>.     Users can then right-click an .XYZ file and select "Open with Your Program".     </li>
</ul>
<p>Here is     <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/fileassociations/fa_intro.asp">     the entry point in MSDN to the documentation on file associations     in Explorer</a>.     </p>
</dd>
</dl>
<p> For many of these "I want to be the X-est"-type questions, you can often come up with some sort of hack, where you run a timer that periodically checks whether you are still&nbsp;X, and if not, pushes you back into the X-position. And then you stop and think, "What if two programs did this?" and realize that it's a bad idea.  At least I hope you do. </p>
<p> Even with this explanation, some people still don't get it. I'll ask them to consider, "What if two programs did this? They'll be fighting back and forth," and the answer I get back is, "Then I can have the second program check if the first program is already running."  They don't understand that they didn't write the second program. </p>
<p> When two programs "duke it out" like this, you can't predict which one will win, but you can predict with 100% certainty who will lose: The user. </p>
<p> I remember well when one of my colleagues called me into his office to show me two very popular commercial programs that both wanted to guarantee that they were the program that ran when the user double-clicked an .XYZ document. Since there is no such guarantee, they faked it with the timer hack. </p>
<p> You installed the first program, it set itself as the .XYZ file handler, and everything seemed normal. You then installed the second program, it set itself as the new .XYZ file handler, and the first program noticed and said, "Uh-uh, <strong>I'm</strong> the program that runs .XYZ files", and changed things back. Then the second program said, "No way, <strong>I'm</strong> the program that runs .XYZ files" and set itself back. </p>
<p> This childish game of "Nuh-uh/Yuh-huh!" went on while the user sat there dumbfounded and helpless, watching the icon for their .XYZ files flicker back and forth between the two programs, both of whom egotistically believed they were doing the user a "favor" by insisting on being the program that runs .XYZ files. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (54)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-280433">
				<div id="div-comment-280433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Green</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280433">
			June 7, 2005 at 11:40 am</a>		</div>

		<p>I&#8217;d love to know which programs exhibited this behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280443">
				<div id="div-comment-280443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thespoke.net/MyBlog/travisowens/MyBlog.aspx' rel='external nofollow' class='url'>Travis Owens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280443">
			June 7, 2005 at 11:48 am</a>		</div>

		<p>In regards to the last part of your post, I think Real invented tho concept of file extension hijacking with their hideous memory resident tidbit back in the Win98 days (or was they Win95?).</p>
<p>And about the original post, while I don&#8217;t have any insight about how explorer handles windows (I&#8217;m too lazy to road your links) here&#8217;s an imaginery scenario to think about.</p>
<p>Let&#8217;s assume all windows float on a layer, windows change layers mostly from the user clicking on them.  So let&#8217;s say 0 is the topmost layer and is reserved by MS Windows for various reasons, so the topmost setting any window can request is layer 1.  When an application takes position 1, every other program gets incrimented by 1, so what had 1 now becomes 2, 2 becomes 3, etc.  Well if a program did a realtime check and if it&#8217;s layer was not 1 then set to one, and another program does the same thing, you would have a convulsion cycle of these two apps fighting, just like your extension example.</p>
<p>This is a good example of where a sanity check is needed and any app that requests X layer changes during Y secs get&#8217;s flagged abusive and all non user attempts to change the layer is ignored for Z secs.  And since layer 0 is reserved for native Windows apps the OS could always launch a window above all others.</p>
<p>Maybe I&#8217;m just a ranting amateur on the subject but I wanted to interject this concept.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280453">
				<div id="div-comment-280453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Ibbotson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280453">
			June 7, 2005 at 11:50 am</a>		</div>

		<p>Why is that anything that wants to manipulate a jpeg or an mpeg files seems to try to grab these extensions rather than leaving well alone.<br />
<br />I get particularly annoyed by things like cameras and scanners which seem to insist that you install their crappy image editing stuff and then proceed to install themselves as the primary editor.<br />
<br />Thankfully I&#8217;ve now gotten rid of most of these by the simple expedient of buying a memory card reader. Still doesn&#8217;t help with the HP all in one printer stuff though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280463">
				<div id="div-comment-280463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reuben Harris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280463">
			June 7, 2005 at 12:04 pm</a>		</div>

		<p>Re two &quot;super-topmost&quot; windows, you could have special code in the window server to XOR the intersection! :-)</p>
<p>Re &quot;Zeke&quot;, that link 404s and I can&#8217;t find any hits at all via the MSDN blogs search widget&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-280473">
				<div id="div-comment-280473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280473">
			June 7, 2005 at 12:57 pm</a>		</div>

		<p>Matt: I&#8217;ll give you a hint:  I saw a demo of this behavior a couple of years ago.</p>
<p>It&#8217;s not much of a hint but if you know where I work it should be enough.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-280483">
				<div id="div-comment-280483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280483">
			June 7, 2005 at 1:26 pm</a>		</div>

		<p>The solution is to do something a little radical for file extensions.  The old Java recommendation was to name your package starting with the reverse of your domain name:</p>
<p>so if your software company is ide-deluxe.example.com, your packages would look like</p>
<p>com.example.ide-deluxe.SomePackage<br />
<br />com.example.ide-deluxe.SomeOtherPackage<br />
<br />etc.</p>
<p>So it seems logical to extend this idea (mmm&#8230; puns) to file extensions.  Underscores are valid in filenames but not host names.</p>
<p>So your files would look like:</p>
<p>user-prefs.com_example_ide-deluxe_database<br />
<br />registration.com_example_ide-deluxe_key</p>
<p>etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280493">
				<div id="div-comment-280493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280493">
			June 7, 2005 at 1:37 pm</a>		</div>

		<p>This extension &quot;fighting&quot; sounds a lot like what happens between IE and other browsers.  Yes Microsoft added the &quot;Set Program Access and Defaults&quot; item (after losing a court case), but I find this dialog just doesn&#8217;t work correctly.  Yesterday I installed Win2K, I turned off IE and Outlook and installed Firefox.  I applied a SP and some patches, both IE and Outlook were reenabled.  In all I think I had to disable these 3 times before it took.</p>
<p>It&#8217;s almost comical to watch Windows continously reenable these despite the user specifically disabling them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280503">
				<div id="div-comment-280503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280503">
			June 7, 2005 at 2:02 pm</a>		</div>

		<p>Sometimes a user wants a program to be top-top most, or does want to specify that a computer program should be the definite absolute last thing to run.</p>
<p>If you give administrators the right to specify these things, rather than giving programs the right to specify these things, you eliminate the &quot;what if 2&#8230;&quot; problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280513">
				<div id="div-comment-280513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ferrier</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280513">
			June 7, 2005 at 2:48 pm</a>		</div>

		<p>I can&#8217;t remove Internet Explorer (at least not easily). I can&#8217;t remove Media Player (well, not easily). They both regularly associate themselves (or pester users who won&#8217;t know better) until their file associations are restored, at every little update.</p>
<p>You should really stop throwing stones from within your glass house you know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-280533">
				<div id="div-comment-280533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280533">
			June 7, 2005 at 3:16 pm</a>		</div>

		<p>ferrier: Um, last I checked I don&#8217;t work in Internet Explorer&#8217;s house or Windows Media Player&#8217;s house.</p>
<p>Does everything I write have to be construed as coming from a particular house? Can&#8217;t I write about programming in general?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280543">
				<div id="div-comment-280543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Dimov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280543">
			June 7, 2005 at 3:46 pm</a>		</div>

		<p>The .XYZ problem has a trivial solution from the Windows side; don&#8217;t have a per-extension registry of applications, have a per-application registry of extensions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-280553">
				<div id="div-comment-280553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280553">
			June 7, 2005 at 3:59 pm</a>		</div>

		<p>There are well-established file types listed in the IANA&#8217;s MIME-type registry.  It is to the advantage of the user to have files of these types clearly marked as such (for example, .csv should mean text/csv)</p>
<p>How to handle two different text editors that want .txt?</p>
<p>In addition to the various domain-based extensions<br />
<br />.com_example_vendor1_&#8230;<br />
<br />.com_example_vendor2_&#8230;<br />
<br />have MIME-based extensions:</p>
<p>.mime_text_plain (short version: .txt)<br />
<br />.mime_text_csv (.csv)<br />
<br />.mime_video_mpeg<br />
<br />.mime_audio_mp3</p>
<p>Have some usability rules:<br />
<br />Applications produced by a vendor can grab their own vendor extensions once every five minutes<br />
<br />Applications produced by a vendor can grab MIME extensions when they are installed only<br />
<br />Applications produced by a vendor can not grab extensions for another vendor except by explicit instructions by the user</p>
<p>For example, when installing OpenOffice, the user should need to press a button to say &quot;grab .com_microsoft_word_document&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280593">
				<div id="div-comment-280593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280593">
			June 7, 2005 at 4:19 pm</a>		</div>

		<p>Let me guess these programs added themselves to the list of things to do at login so their pretty little icon is in the notification area of the taskbar so they can file associations every X msecs?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280613">
				<div id="div-comment-280613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280613">
			June 7, 2005 at 4:35 pm</a>		</div>

		<p>All the bickering here is missing the point.</p>
<p>The requests for &quot;how do I do this&quot; that Raymond alludes to happen ALL THE TIME on Microsoft email threads.  Thankfully, on most of these threads there&#8217;s a raymondc to shoot down the idea.</p>
<p>I&#8217;m afraid there aren&#8217;t enough raymondc&#8217;s in the software companies in the world, and as a result we get a lot of software that behaves really, really badly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-themuujgmail-com even thread-even depth-1" id="comment-280623">
				<div id="div-comment-280623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matthew+W.+Jackson' rel='external nofollow' class='url'>Matthew W. Jackson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280623">
			June 7, 2005 at 4:38 pm</a>		</div>

		<p>I&#8217;m not a Unix/Linux user, but I do agree that MIME-types are better than extensions.  I turn on the option to show all extensions, but only because it&#8217;s more of a pain to leave it off (try creating a new text file and renaming it to &quot;.HTML&quot;&#8211;its a hassle), and hard to tell what the exact filename is sometimes (&quot;JPG&quot; vs &quot;JPEG&quot;).  An optional column in Explorer showing the actual extension and a &quot;Change File Type&quot; command (with appropriate warnings) would help.</p>
<p>Actually, I think MIME-types are only a partial solution, since there&#8217;s a potential for overlap in vendor-specific file-types.  Perhaps files should have URIs attached (it would have to be stored as filesystem metadata, I suppose).  Text files would be &quot;mime:text/plain&quot;, and Word documents could be &quot;<a rel="nofollow" target="_new" href="http://www.microsoft.com/filetypes/word/&quot;" rel="nofollow"></a><a href="http://www.microsoft.com/filetypes/word/&#038;quot" rel="nofollow">http://www.microsoft.com/filetypes/word/&#038;quot</a>;.</p>
<p>Any good solution is going to be hard to make backwards compatable.  I was kind of hoping that WinFS would provide a good solution, though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280633">
				<div id="div-comment-280633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280633">
			June 7, 2005 at 5:19 pm</a>		</div>

		<p>File association insanity with media files isn&#8217;t near as bad as it used to be. WinAmp, QuickTime, RealPlayer, and WMP all allow you to turn off whatever it is keeping them from re-associating themselves. The next dilemma is getting all super-duper programs out of the system tray.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280643">
				<div id="div-comment-280643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280643">
			June 7, 2005 at 5:27 pm</a>		</div>

		<p>Usability rules:</p>
<p>1. Applications produced by a vendor can grab their own vendor extensions once every five minutes<br />
<br />2. Applications produced by a vendor can grab MIME extensions when they are installed only<br />
<br />3. Applications produced by a vendor can not grab extensions for another vendor except by explicit instructions by the user </p>
<p>Rules 1 and 3 don&#8217;t seem to help anything.  Let&#8217;s say a vendor has an extension .foo (substitute appropriate vendor-specific extension).  This vendor distributes a program that you use, and this program registers itself with its own extensions every 5 minutes.  However, most of the time you use a 3rd party application, and you prefer to associate the .foo extension with that application.</p>
<p>Every 5 minutes you&#8217;re going to lose the extension to the original vendor&#8217;s application.  So while you&#8217;re in the middle of working, all the sudden when you double click a .foo file, the other program opens.  Or every 5 minutes, the program you prefer to use prompts you whether to re-associate the file extension.</p>
<p>You can, of course, substitute .DOC for .FOO and imagine MS Word re-associating .DOC from OpenOffice every 5 minutes if you want a practical example.</p>
<p>Maybe I&#8217;m just not getting these proposed rules completely, however.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280653">
				<div id="div-comment-280653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikey mikey mike-mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280653">
			June 7, 2005 at 5:28 pm</a>		</div>

		<p>What if two programs were allowed to get exclusive locks on files? They could both lock the same file and the universe would surely cease to exist.</p>
<p>Wait a moment, what are these flags I&#8217;m passing to _open()&#8230;oh sweet lord, RUN FOR YOUR LIVES!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280673">
				<div id="div-comment-280673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280673">
			June 7, 2005 at 6:06 pm</a>		</div>

		<p>John Siracusa covered Apples new UTI file association system in his review of Tiger.<br />
<br /><a rel="nofollow" target="_new" href="http://arstechnica.com/reviews/os/macosx-10.4.ars/11" rel="nofollow">http://arstechnica.com/reviews/os/macosx-10.4.ars/11</a><br />
<br />It uses a combination of the Java classpath scheme and an adapted MIME typing scheme to solve both the file type classification, extension duplication and third party extensibility problems in one go.</p>
<p>Microsoft could do well to adopt a similar system. Its probably too late for Longhorn, but it would be a big step forward if it could be incorporated into WinFS and used by the shell in later releases.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280683">
				<div id="div-comment-280683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280683">
			June 7, 2005 at 7:22 pm</a>		</div>

		<p>&lt;quote&gt;<br />
<br />&quot;How do I mark my process so that it always the first/last to receive the system shutdown notification? I want to do something before/after all other programs have shut down.&quot;<br />
<br />&lt;/quote&gt;</p>
<p>I know you can change the shutdown priority &#8211; although admittedly you can&#8217;t be guaranteed first or last to shutdown.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-280723">
				<div id="div-comment-280723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280723">
			June 7, 2005 at 8:00 pm</a>		</div>

		<p>&quot;Looks like Microsoft to me.&quot;</p>
<p>Perhaps I should move my blog then.</p>
<p>&quot;&#8230; Windows&#8217; house&quot;.<br />
<br />I live in the shell house. IE lives in the IE house. WMP lives in the WMP house. And even the shell house has many sub-houses I do not belong to.</p>
<p>And why can&#8217;t I ridicule mistakes coming from my own house? Wouldn&#8217;t that just drive the point home even better?</p>
<p>How do I write about programming in general without people assuming that I&#8217;m writing from a particular house? You said it can be done &#8211; please explain how.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280733">
				<div id="div-comment-280733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamesatuncw.com/blog' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280733">
			June 7, 2005 at 8:52 pm</a>		</div>

		<p>Norman,</p>
<p>There are those of us who truly do like Raymond&#8217;s blog and really learn a great deal from it.</p>
<p>Please stop trying to piss him off.</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280743">
				<div id="div-comment-280743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamesatuncw.com/blog/archive/2005/06/07/1963.aspx' rel='external nofollow' class='url'>James Summerlin's Blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280743">
			June 7, 2005 at 8:59 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280523">
				<div id="div-comment-280523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray Trent</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280523">
			June 7, 2005 at 3:10 pm</a>		</div>

		<p>I&#8217;d like to point out that &quot;what if two programs did this&quot; isn&#8217;t really best thought of a way to shoot down an idea. It&#8217;s a way to help define what it is that you really want to do and understand the implicit limitations of the system.</p>
<p>For example, let&#8217;s look at the &quot;topmost&quot; request and the supposed reductio ad absurdum. That&#8217;s not a logical contradiction, it&#8217;s only a contradiction if you add the extra constraints &quot;and I get to say where my window appears and how large it will be&quot;. &quot;True topmostness&quot; becomes possible iff the window manager makes sure that any topmost windows can&#8217;t overlap. </p>
<p>Now, sure, that will probably cause other questions to pop up, like &quot;how to I make sure that I&#8217;m topmost and centered and large enough to read?&quot; at which point perhaps there&#8217;s another solution.</p>
<p>People usually want something for a reason. While we can&#8217;t give them everything, it&#8217;s worthwhile understanding the reasons and trying to figure out what we *can* give them.</p>
<p>In this case, one thing that came out of this kind of effort is notification bubbles as a replacement for notification dialogs. Mind you, I&#8217;m not trying to claim that this was necessarily the best solution to that problem, just that it&#8217;s a form of lateral thinking that&#8217;s superior to shooting down ideas.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280753">
				<div id="div-comment-280753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas Haeber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280753">
			June 7, 2005 at 10:11 pm</a>		</div>

		<p>James S.: +1 for that :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-280663">
				<div id="div-comment-280663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280663">
			June 7, 2005 at 5:56 pm</a>		</div>

		<p>Let&#8217;s use Word / OpenOffice as the example.</p>
<p>New Word document extensions:<br />
<br />DOC: .com_microsoft_word_document (.doc)<br />
<br />RTF: .mime_text_rtf (.rtf)</p>
<p>When you install Word:<br />
<br />Word grabs DOC and RTF.</p>
<p>When you install OpenOffice:<br />
<br />OpenOffice grabs RTF<br />
<br />OpenOffice ASKS if it is OK to grab DOC.</p>
<p>If you only install OpenOffice and not Word, then DOC will always open with OpenOffice.</p>
<p>If you have both OpenOffice and Word installed, RTF will open in whichever application was installed most recently.  Word can, if it chooses, either:<br />
<br />* Unilaterally enforce its ownership of DOC (always check)<br />
<br />* Allow the user to uncheck a &quot;Keep DOC&quot; box (let user decide)<br />
<br />* Let DOC go where it will (never check)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-junfeng even thread-even depth-1" id="comment-280783">
				<div id="div-comment-280783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Junfeng+Zhang' rel='external nofollow' class='url'>Junfeng Zhang</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280783">
			June 8, 2005 at 2:31 am</a>		</div>

		<p>Thomas,</p>
<p>But where do you store the default? </p>
<p>I can just hijack where you store the default, and change it to me. </p>
<p>We are back to the beginning.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-280703">
				<div id="div-comment-280703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280703">
			June 7, 2005 at 7:35 pm</a>		</div>

		<p>&gt; What if two programs were allowed to get exclusive locks on files? They could both lock the same file and the universe would surely cease to exist.</p>
<p>This is like how it is now with top-most windows.  You can specify your window is &quot;topmost&quot; (i.e. WS_EX_TOPMOST) and it will be, until another asks to be &quot;topmost&quot;.</p>
<p>What people are asking is they want their program to be &quot;always&quot; topmost, which is like asking &quot;I want to be the *only one* who can get an exclusive lock on this file&quot;.  *That&#8217;s* not possible because then what if two programs want to be the only one to ever be able to get an exclusive lock on a file?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280713">
				<div id="div-comment-280713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280713">
			June 7, 2005 at 7:52 pm</a>		</div>

		<p>&gt; <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/comments/426294.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/comments/426294.aspx</a></p>
<p>Looks like Microsoft to me.</p>
<p>&gt; If the possibility leads to an obvious<br />
<br />&gt; contradiction or the violation of generally-<br />
<br />&gt; accepted rules of metaphysics, then you can<br />
<br />&gt; be pretty sure that Windows doesn&#8217;t support<br />
<br />&gt; it.</p>
<p>Both the visible text and the obvious smiley are obviously written as a defence of Windows.</p>
<p>&gt; Um, last I checked I don&#8217;t work in Internet<br />
<br />&gt; Explorer&#8217;s house or Windows Media Player&#8217;s<br />
<br />&gt; house.</p>
<p>Yes you do.  Your house proved in court that Internet Explorer&#8217;s house is an integral part of Windows&#8217;s house.  The first release of Windows 95 was missing an integral part of Windows 95.</p>
<p>&gt; Does everything I write have to be construed<br />
<br />&gt; as coming from a particular house? Can&#8217;t I<br />
<br />&gt; write about programming in general?</p>
<p>The answers are yes and yes.<br />
<br />(To clarify possible ambiguity:  The second yes means yes you can.)</p>
<p>Meanwhile, notice what boxmonkey and Ray Trent wrote:  Sometimes the USER knows what the user wants.  Not always, but sometimes.  Even the Windows task bar provides the user with an option to not always make it topmost.  If the user wants to set some other window to always be topmost, the user doesn&#8217;t need your ridicule.  Of the user wants to set two other windows to always be topmost and then positions them to overlap, THEN the user needs your ridicule.  But if the repositioning came from a finger bouncing on a mouse button when the user didn&#8217;t intend it[*], then the user only needs a warning message without ridicule.</p>
<p>[* Like yesterday when Windows Explorer obediently moved a folder into another folder, as designed.  Fortunately the Undo command worked as designed.]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-themuujgmail-com odd alt thread-odd thread-alt depth-1" id="comment-280793">
				<div id="div-comment-280793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matthew+W.+Jackson' rel='external nofollow' class='url'>Matthew W. Jackson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280793">
			June 8, 2005 at 3:12 am</a>		</div>

		<p>Store it wherever the list of most-recently used programs is stored in XP.  Or has this been hijacked as well?</p>
<p>The OS really needs a way for individual programs/libraries to have their own storage that only they can read/write to.  Perhaps the values read/write are encrypted using the identity of the calling library (maybe full path for classic DLLs, a registered GUID for COM DLLs, and a Strong Name for .NET DLLs).</p>
<p>I&#8217;m not certain that .NET Isolated Storage cannot be hijacked, so I can&#8217;t say that it would be a good model.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280803">
				<div id="div-comment-280803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wound</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280803">
			June 8, 2005 at 3:19 am</a>		</div>

		<p>I&#8217;m gonna guess that one of the fighting apps was winamp or realplayer. It might even have been the two of them. Those guys were always trying to take over certain file types, and further more had agent apps to retain those associations</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280813">
				<div id="div-comment-280813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280813">
			June 8, 2005 at 3:24 am</a>		</div>

		<p>There was a supposed Longhorn screenshot floating around about a year ago that showed a similar user controlled scheme.<br />
<br />The window title was something like &quot;A new application has been installed that can handle this type of file&quot; with a list for you to select the default.<br />
<br />I guess it just monitors the registry for applications trying to modify the associations and lets you choose between the old app and the new one.<br />
<br />I can&#8217;t the screenshot again at the moment, but it looks just like what would be required. I hope it hasn&#8217;t been cut.<br />
<br />I expect applications would start to try to automate the dialog to select theirs as the default, but at least its a start.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280833">
				<div id="div-comment-280833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.georg-rottensteiner.de' rel='external nofollow' class='url'>Georg Rottensteiner</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280833">
			June 8, 2005 at 4:59 am</a>		</div>

		<p>After reading for quite some time i get to post a comment:</p>
<p>I wrote a small app for my own, sort of a quicklaunch bar, but free floating in the top right corner (used regions to make it two lines). Now i obviously want it to be topmost.<br />
<br />I confess i hacked a if-i&#8217;m-not-topmost-anymore-i-set-myself-topmost-again function inside. I understand that&#8217;s not good, but what alternative is there for smaller things like this?<br />
<br />Also, as a notice: That doesn&#8217;t even work too well, the window still gets obscured from time to time. So it&#8217;s not wrong to do, it also doesn&#8217;t work right!</p>
<p>Is asking for an alternative not basically asking for a hole in the system? :)</p>
<p>Raymond, keep going. The blog is a very interesting read, and has some neat details.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-280843">
				<div id="div-comment-280843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin Roth</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280843">
			June 8, 2005 at 7:13 am</a>		</div>

		<p>Regarding a &quot;super-topmost&quot; window&#8230; I frequently find myself typing something into a window (word doc, excel sheet, or whatever) when along comes some other program&#8217;s dialog box asking me some question or another. First off, I hate that a few keystrokes get lost when that dialog box takes focus. But much worse, I hate if I hit a key that causes an OK or cancel button on that dialog to receive a click event (e.g. the enter key, the escape key, or the &quot;O&quot; key in the case of &quot;Ok&quot;), thinking that I was still typing into my original window, and end up dismissing the dialog box before I get a chance to read it.</p>
<p>Is there anything I can do (any little hackish program) or wait for (perhaps a new setting in Longhorn) that would force a window I&#8217;m actively interacting with (from the keyboard) to retain focus no matter what?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280773">
				<div id="div-comment-280773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thomas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280773">
			June 8, 2005 at 1:37 am</a>		</div>

		<p>&lt;sarcasm&gt;<br />
<br />Ah but Raymond you forget: You have a blog, so you&#8217;re obviously always speaking on behalf of microsoft &#8211; ESPECIALLY as its on blogs.msdn.com.<br />
<br />&lt;/sarcasm&gt;</p>
<p>Raymond &#8211;</p>
<p>Wouldn&#8217;t you agree it would be better if the extension default handler were user controlled *only*?</p>
<p>I very much dislike some app I install grabbing my set extensions.</p>
<p>My propsal: Apps can associate themselves with an extension, this puts it in the open with list, as well as the default if theres not already a handler for said extension.<br />
<br />If theres already a default handler, upon next opening of .foo, make it pop up saying &quot;A new application has registered itself as supporting .foo, please select default application&quot; with the current handler selected by default.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-281053">
				<div id="div-comment-281053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281053">
			June 8, 2005 at 11:05 am</a>		</div>

		<p>I&#8217;m going to chime in and support the old Macintosh Classic way of solving this problem.</p>
<p>Each program had a creator code, and then a list of filetype codes it supported.  If Word saved a file, it had Word&#8217;s creator code, meaning if the user double-clicks it, it&#8217;ll open in Word all the time.  Now, you could open that with OpenOffice by dragging&amp;dropping or using the Open&#8230; menu item (because it was on OO&#8217;s list of supported filetypes, the OS allows this.)  Now when you save the document in OpenOffice, now it has the OpenOffice creator code, and double-clicking will open the document in OpenOffice.  (MacOS also kept a copy of default handlers for files downloaded from the Internet for when it only had a file extension to work with.)</p>
<p>Of course, Apple ditched this system in OS X.  And now they seem to have added another system which seems to do the same thing but is 10 times more complex for both programmers and users.  Oh well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-280823">
				<div id="div-comment-280823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig Ringer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-280823">
			June 8, 2005 at 4:38 am</a>		</div>

		<p>Regarding the discussion of houses, I&#8217;d like to add that I think it&#8217;s already quite clear you&#8217;re speaking about programming under win32 in a general context, unless you say otherwise.</p>
<p>Some folks will want to read more into  what you say, and there&#8217;s not much you can do about it. That doesn&#8217;t mean they&#8217;re right though, or that everybody thinks that way. There are folks who see everything coming from microsoft as bad or some kind of rivalry, too&#8230; same deal.</p>
<p>By the way, thanks for writing here. As an exclusively UNIX/Linux developer I&#8217;m learning a lot about how win32 works and &quot;thinks.&quot; A lot of what you write &#8211; or the ideas behind it &#8211; applies equally well to cross platform and non-Windows apps, and is often very interesting. It&#8217;s also fascinating to learn about the different approach win32 has to so many things, and see the various advantages and disadvantages therin.</p>
<p>Since it looks like I&#8217;m about to be helping port an app to win32, I expect to appreciate what I&#8217;ve learned here even more soon. The app is based on Qt from Trolltech &#8211; <a rel="nofollow" target="_new" href="http://www.trolltech.com/" rel="nofollow">http://www.trolltech.com/</a> so the toolkit solves the hard 90% of the porting work, I just need to handle a few things like printing and file/save dialogs. (Arrrrggh, printing!).</p>
<p>A &quot;Windows printing for UNIX/Linux developers&quot; article on MSDN would rock, by the way. A lot. Something that helped introduce poor, confused *nix developers into the way the win32 print system works and fits together would help *so* much. Doubly so if it discussed things like how to discover if a printer speaks PostScript (<br />
<br /><a rel="nofollow" target="_new" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;264036" rel="nofollow">http://support.microsoft.com/default.aspx?scid=kb;en-us;264036</a>), how to send PostScript direct to a printer if it supports it, how to send a raster bitmap via a GDI driver quickly and painlessly, pointed out the wonder that is GhostScript (<a rel="nofollow" target="_new" href="http://www.ghostscript.com" rel="nofollow">http://www.ghostscript.com</a>) for apps that generate their own PostScript, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-281103">
				<div id="div-comment-281103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tempus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281103">
			June 8, 2005 at 11:41 am</a>		</div>

		<p>I have to agree with Kevin,</p>
<p>I&#8217;ve had this business of a dialog appearing as I&#8217;m typing happen, and it has to be one of the &#8216;super-topmost&#8217; items on my peves list.  Worst of all is of course that often spacebar just selects the default action, and we tend to hit it about every 3-6 characters on average, so a fast typest is almost always doomed to pick the default action when such a dialog pops up.  (and needless to say you are totally borked if you are transcribing something and your eyes are on the hardcopy, and not what you are typing)</p>
<p>In an ideal world the dialog would have some way to &#8216;know&#8217; the user was typing as it popped up, and either buffer or refuse to act on that input until there was a brief pause..  if buffered it would be nice if the input could be somehow fired into either clipboard, or back at the app which had focus prior to the pop-up dialog asserting it&#8217;s dominance over the user&#8217;s focus</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-281133">
				<div id="div-comment-281133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281133">
			June 8, 2005 at 12:11 pm</a>		</div>

		<p>I did some programming on Classic Macs &#8211; and a dirty little secret was that creator codes were just four-character extensions that couldn&#8217;t be made visible.</p>
<p>As such they run into the same collision issues that extensions do.</p>
<p>And worse&#8230; because the creator code is stored in the resource fork of the file, it&#8217;s an all-to-frequent occurence on a cross-platform LAN that a file will be saved in AFP but accessed via SMB, and the creator code will be lost.</p>
<p>Ditching Classic helps solve this issue for newly created files&#8230; but if you have an archive of old files with creator codes embedded in them, be aware of this issue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-281143">
				<div id="div-comment-281143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281143">
			June 8, 2005 at 12:13 pm</a>		</div>

		<p>An application that does a good job is Trillian &#8211; if I&#8217;m typing in Word, and Trillian pops up an IM window, the IM window is on top (I can read it) but Word still has the focus (whatever I type continues to go into Word)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-281313">
				<div id="div-comment-281313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">aran</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281313">
			June 8, 2005 at 5:47 pm</a>		</div>

		<p>This is just an instance of a great rule for life, not just computer software. &quot;What if everyone did this?&quot; It&#8217;s an easy way of checking morality and sustainability.<br />
<br />e.g. What if everyone drove for an hour a day?<br />
<br />What if everyone stole software?<br />
<br />What if everyone trolled on Raymond&#8217;s blog?<br />
<br />What if everyone donated 10% to hungry people?<br />
<br />etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-281323">
				<div id="div-comment-281323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281323">
			June 8, 2005 at 6:36 pm</a>		</div>

		<p>&quot;If Word saved a file, it had Word&#8217;s creator code, meaning if the user double-clicks it, it&#8217;ll open in Word all the time.&quot;</p>
<p>The trouble was that it was very easy to get files onto the Mac that when you try to open them say &quot;This file was created with Bloo, you must install Bloo to open it&quot; when in fact you have 3 or 4 apps that could open it. Now, while I&#8217;m happy that Macs are really easy to use, I never could work out how to open files in another app without a lot of faffing around. Someone always had to show me, or else I&#8217;d have to use finder to find the application, open it, then use its file-open to find the file. And all of those things are explicity not made easy by Mac, presumably because they defeat the paradigm of &quot;the user is too stupid to know what they want&quot; that Macs are based on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-281353">
				<div id="div-comment-281353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281353">
			June 8, 2005 at 9:01 pm</a>		</div>

		<p>Tuesday, June 07, 2005 8:00 PM by oldnewthing<br />
<br />&gt;[Norman Diamond]<br />
<br />&gt;&gt;&quot;Looks like Microsoft to me.&quot;<br />
<br />&gt;<br />
<br />&gt;Perhaps I should move my blog then.</p>
<p>I don&#8217;t know.  But there&#8217;s an easier method, which we&#8217;ll get to in a moment.</p>
<p>&gt;&gt;&quot;&#8230; Windows&#8217; house&quot;.<br />
<br />&gt;I live in the shell house. IE lives in the IE<br />
<br />&gt;house. WMP lives in the WMP house. And even<br />
<br />&gt;the shell house has many sub-houses I do not<br />
<br />&gt;belong to.</p>
<p>Are you sure they&#8217;re houses and not apartments ^_^  Sorry for drifting off-thread.  Anyway, Microsoft is a pretty famous house with lots of victims.  Prior to blogs by yourself and your colleagues, about the only kinds of communications we got from that house blamed its bugs on victims.  Readers see you posting from it and sometimes defending it, and that is why it still sometimes looks like you&#8217;re part of it.  Next, how to fix that appearance: </p>
<p>&gt; And why can&#8217;t I ridicule mistakes coming<br />
<br />&gt; from my own house? Wouldn&#8217;t that just drive<br />
<br />&gt; the point home even better? </p>
<p>Yes, that is perfect.  When you do so, please say something like this:</p>
<p>&gt; And then you stop and think, &quot;What if two<br />
<br />&gt; programs did this?&quot; and realize that it&#8217;s a<br />
<br />&gt; bad idea. At least I hope you do.<br />
<br />+ Including if you&#8217;re one of my colleagues.</p>
<p>And something like this:</p>
<p>&gt; to show me two very popular commercial<br />
<br />&gt; programs that both wanted to guarantee that<br />
<br />&gt; they<br />
<br />+ could be as arrogant as some Microsoft programs&#8230;</p>
<p>I think a lot of people would understand it better then, and would agree immediately.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-281333">
				<div id="div-comment-281333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281333">
			June 8, 2005 at 6:44 pm</a>		</div>

		<p>Two comments about creator codes:</p>
<p>1) Creator codes were *supposed* to be registered with Apple to guarantee uniqueness.  An application using an unregistered creator code could potentially cause problems, yes, but there&#8217;s no way to engineer-away bad developers who don&#8217;t do their job.</p>
<p>2) The &quot;PC Exchange&quot; control panel fixed the problem of not having the application with the correct creator code installed in System&#8230; 7.5?  I don&#8217;t remember.  I admit it was a problem early on, though.</p>
<p>(Additionally, you could just drag&amp;drop the file icon to the application, even in System 6, so I&#8217;m not sure why you had so much difficulty getting those files open.)</p>
<p>In any case, I&#8217;m not saying it&#8217;s perfect, but it&#8217;s a lot better than file extentions (which requires the filename be changed) and MIME types (which don&#8217;t allow users to have text files owned by multiple applications), and a lot less complicated than the system Apple&#8217;s added to the new OS X now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-281453">
				<div id="div-comment-281453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281453">
			June 9, 2005 at 9:37 am</a>		</div>

		<p>Whether the application trying to be &quot;the only one&quot; or whether two programs involved in the file association fight were written by Microsoft or not is irrelevant to my point. Mentioning Microsoft &#8211; in my opinion &#8211; would only be a distraction.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-281803">
				<div id="div-comment-281803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://libertango.livejournal.com' rel='external nofollow' class='url'>Hal O'Brien</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-281803">
			June 10, 2005 at 4:50 am</a>		</div>

		<p>Norman:</p>
<p>It very much reads like you&#8217;re saying you believe that all 60,000+ people at Microsoft should conform to some cartoonish hive-mind, and that Raymond is somehow not holding up his side of *your* bargain by behaving as a thoughtful, reasonable, intelligent individual.</p>
<p>Well, guess what? Raymond isn&#8217;t responsible for the preconceptions you bring to the table. Just because things are distorted in your own mind doesn&#8217;t mean he has to emulate those distortions.</p>
<p>Try sitting back and observing the universe as it is, rather than trying to shoehorn it into what you believe it to be.</p>
<p>(And, just as Raymond is talking about general programming principles regardless of company, I&#8217;d say the above is true is in general, both pro and con. All human institutions have their foibles, as do all human beings.  Funny that &#8212; you&#8217;d almost think *people* are involved, in all their squirmy individuality.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-282323">
				<div id="div-comment-282323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-282323">
			June 12, 2005 at 8:41 pm</a>		</div>

		<p>Friday, June 10, 2005 4:50 AM by Hal O&#8217;Brien</p>
<p>&gt; Norman:<br />
<br />&gt; It very much reads like you&#8217;re saying you<br />
<br />&gt; believe that all 60,000+ people at Microsoft<br />
<br />&gt; should conform to some cartoonish hive-mind,</p>
<p>No, I&#8217;m saying that all 60,000+ people at Microsoft are at Microsoft, and Mr./Ms. ferrier was right when referring to Microsoft as a glass house.  Microsoft is also pretty famous for blaming victims for bugs which are Microsoft&#8217;s bugs, indeed for throwing stones from their glass house.  It is a relief to learn that Mr. Chen&#8217;s intention is not to be that way, but the intention is not always visible.  I sure do not think Mr. Chen (or 59,999+ others) &quot;should&quot; conform, I only observe that often they still *appear* to conform, and there are ways to *not appear* to conform.  Also I sure wonder how you managed to avoid observing that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-283393">
				<div id="div-comment-283393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Good Point</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-283393">
			June 17, 2005 at 9:35 am</a>		</div>

		<p>So, did &quot;let&#8217;s allow installers overwrite poitions of the OS&quot; (i.e. system DLLs) pass the &quot;Imagine if this were possible&quot; test?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-283423">
				<div id="div-comment-283423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-283423">
			June 17, 2005 at 10:17 am</a>		</div>

		<p>Clearly it was undesirable but how would you stop them? Remember, Windows 1.0 used floppy disks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-297923">
				<div id="div-comment-297923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/08/18/453054.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-297923">
			August 18, 2005 at 10:00 am</a>		</div>

		<p>It&#8217;s a complicated mix.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-342223">
				<div id="div-comment-342223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ryanfarley.com/blog/archive/2006/01/31/15841.aspx' rel='external nofollow' class='url'>{ public virtual blog; }</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-342223">
			January 31, 2006 at 6:07 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-365463">
				<div id="div-comment-365463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotnet.org.za/codingsanity/archive/2006/01/07/49013.aspx' rel='external nofollow' class='url'>Coding Sanity</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-365463">
			April 3, 2006 at 1:57 pm</a>		</div>

		<p>There&#8217;s a lovely article on the new Configuration Management&amp;amp;nbsp;system in .NET 2.0 on Paulo Rechiert&#8217;s&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-385243">
				<div id="div-comment-385243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/05/26/608007.aspx' rel='external nofollow' class='url'>The Old New Thing : Assaulting users with dialog box after dialog box</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-385243">
			May 26, 2006 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/05/26/608007.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/05/26/608007.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-410633">
				<div id="div-comment-410633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx' rel='external nofollow' class='url'>The Old New Thing : Applications and DLLs don't have privileges; users do</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050607-00/?p=35413#comment-410633">
			August 18, 2006 at 10:00 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/08/18/705957.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

