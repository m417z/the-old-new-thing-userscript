<html>
<head>
<title>Why does Windows ask me to pick a program with which to open a file, even when I already specified which program I want to use to open the file?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why does Windows ask me to pick a program with which to open a file, even when I already specified which program I want to use to open the file?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>October 16, 2018 / year-entry #234</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>23</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">It's just double-checking after the situation has changed.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
So you're working at your computer,
everything is humming along just fine,
and then when you double-click a file,
instead of launching the associated application,
Windows asks you what program you want to use to launch the document.
Why doesn't it just follow the instructions you gave it already?
</p>
<p>
A customer installed a new program that supports XYZ files,
but was careful not to let that program take over as
the XYZ file handler.
But when they double-click a XYZ file,
they still get the "How do you want to open this file?"
dialog.
</p>
<div STYLE="width: 25pc;border: solid 1px #e0e0e0;color: black;background-color: white;font-size: 11pt;font-family: Segoe UI, sans-serif">
<div STYLE="font-size: 15pt;margin: 1ex">
    How do you want to open this file?
</div>
<div STYLE="font-size: 13pt;margin: 1ex">
    Keep using this app
</div>
<div STYLE="background-color: #0c84db;padding: .5ex 1ex">
<table BORDER="0" STYLE="color: white">
<tr>
<td STYLE="height: 40px;width: 40px;text-align: center;background-color: #4aa02c" VALIGN="top">
      <span STYLE="font-size: 20pt">&#x22d0;</span>
    </td>
<td STYLE="padding-left: 1em;font-size: 11pt">
      Contoso Deluxe<br><span STYLE="font-size: 9pt">The industry leader in XYZ visualization</span>
    </td>
</tr>
</table>
</div>
<div STYLE="font-size: 12pt;margin: 1ex">
<div STYLE="padding-bottom: 1ex;border-bottom: solid 1px #e0e0e0">
        Other options
    </div>
</div>
<div STYLE="padding: .5ex 1ex">
<table BORDER="0">
<tr>
<td STYLE="height: 40px;width: 40px;text-align: center;background-color: #add8e6" VALIGN="top">
      <span STYLE="font-size: 20pt">&#x2112;</span>
    </td>
<td STYLE="padding-left: 1em;font-size: 11pt">
      LitWare Light<br><span STYLE="font-size: 9pt;color: #808080">New</span>
    </td>
</tr>
</table>
</div>
<div STYLE="padding: .5ex 1ex">
<table BORDER="0">
<tr>
<td STYLE="height: 3em;width: 3em">
    </td>
<td STYLE="padding-left: 1em;font-size: 11pt">
      Look for an app in the Store
    </td>
</tr>
</table>
</div>
<div STYLE="padding: .5ex 1ex;color: #0c84db">
    More apps &#x2186;
</div>
<div STYLE="padding: 1ex">
    &#x2610; Always use this app to open .xyz files
</div>
<div STYLE="padding: 2ex">
<div STYLE="background-color: #cccccc;padding-top: 1ex;text-align: center;width: 10pc;height: 2em">OK</div>
</div>
</div>
<p>
"Could you please confirm whether this is expected behavior?
If so, what is it that changes when a new app is installed
that triggers this prompt?"
</p>
<p>
Yes, this is expected.
</p>
<p>
If an app is installed that registers support for a file type,
then the next time you launch a file of that type,
Windows will confirm that you want to stay with the app
you have, rather than switch to the new one.
</p>
<p>
You should be prompted only once per file type,
at least until you install another app that registers
for that file type.
</p>
<p>
Why does Windows prompt you one more time after installing
a program that supports the file type?
</p>
<p>
Well, you may have installed that program
with the intention of making it the default handler.
Or conversely, a recently-installed program may have forced itself
as the default handler (possibly by nefarious means),
and this gives you a chance to switch it back.
</p>
<p>
In both cases, the dialog saves you a trip to the
<i>Choose default apps by file type</i> settings page,
which is important because most users don't even realize
that such a page even exists.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (23)	</div>

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/oldnewthing/20181016-00/?p=99985#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://blogs.msdn.microsoft.com/oldnewthing/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><textarea id="comment" name="comment" cols="45" rows="4" aria-required="true"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /><label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit btn btn-default" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='99985' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="6251a8ee44" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="245"/></p>			</form>
			</div><!-- #respond -->
	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1367775">
				<div id="div-comment-1367775" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://cmdrkeene.com' rel='external nofollow' class='url'>Shawn Keene</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367775">
			October 16, 2018 at 7:22 am</a>		</div>

		<p>I really appreciate this new behavior.  It&#8217;s very similar to the behavior on my phone&#8217;s OS.   Although I seem to remember Windows 8 had done it a little different.  Instead of asking you to pick or re-affirm your default choice, it would show a notification informing you that &#8220;you have new apps capable of opening the thing you just opened&#8221;, and you had to click that to change the default.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367775#respond' onclick='return addComment.moveForm( "div-comment-1367775", "1367775", "respond", "99985" )' aria-label='Reply to Shawn Keene'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1367785">
				<div id="div-comment-1367785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367785">
			October 16, 2018 at 8:05 am</a>		</div>

		<p>Until nefarious applications figure out how to set the flag indication that windows has already asked the user. Then you need to create another flag.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367785#respond' onclick='return addComment.moveForm( "div-comment-1367785", "1367785", "respond", "99985" )' aria-label='Reply to Karl'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-2 parent" id="comment-1367965">
				<div id="div-comment-1367965" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367965">
			October 17, 2018 at 4:44 am</a>		</div>

		<p>There is no such flag.</p>
<p>And this behavior has been around for 6 years now.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367965#respond' onclick='return addComment.moveForm( "div-comment-1367965", "1367965", "respond", "99985" )' aria-label='Reply to Fleet Command'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1367985">
				<div id="div-comment-1367985" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367985">
			October 17, 2018 at 7:00 am</a>		</div>

		<p>There is such flag. You can tell because the dialog doesn&#8217;t come up every time you open a file of that type.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367985#respond' onclick='return addComment.moveForm( "div-comment-1367985", "1367985", "respond", "99985" )' aria-label='Reply to Joshua'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-3" id="comment-1368055">
				<div id="div-comment-1368055" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dennis2018</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368055">
			October 17, 2018 at 2:05 pm</a>		</div>

		<p>Oh yes, there is! It&#8217;s all in the registry. It&#8217;s just not documented for you and me. And it is only until someone reverse engineers it. Which usually happens to be done by malware or some malicious actor.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368055#respond' onclick='return addComment.moveForm( "div-comment-1368055", "1368055", "respond", "99985" )' aria-label='Reply to dennis2018'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1368005">
				<div id="div-comment-1368005" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TwelveBaud</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368005">
			October 17, 2018 at 8:01 am</a>		</div>

		<p>The &#8220;flag&#8221; is the output of a hash function, whose algorithm is kept secret and is not one of the ones readily available. Nefarious applications know where this is, but have yet to succeed at reverse-engineering the algorithm, and know that messing with it will lead to the file type having no associations at all.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368005#respond' onclick='return addComment.moveForm( "div-comment-1368005", "1368005", "respond", "99985" )' aria-label='Reply to TwelveBaud'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com even thread-even depth-1 parent" id="comment-1367805">
				<div id="div-comment-1367805" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367805">
			October 16, 2018 at 8:33 am</a>		</div>

		<p>What a crazy coincidence. I&#8217;ve known about this dialog for a while, and respect it, but I&#8217;m running into another issue with something similar as of today. When your default browser is set to IE (I know, I know, it&#8217;s for plugin reasons that are being worked on), you get a print action in a html file&#8217;s right-click menu. If you click this print action in the context menu, you get a pop like that asking if you want to use IE or switch to Edge or another app. There&#8217;s no &#8220;always use this app&#8221; option in this case. So you get this &#8220;are you sure?&#8221; dialog every time the print action is clicked on.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367805#respond' onclick='return addComment.moveForm( "div-comment-1367805", "1367805", "respond", "99985" )' aria-label='Reply to Entegy'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1368045">
				<div id="div-comment-1368045" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dennis2018</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368045">
			October 17, 2018 at 2:02 pm</a>		</div>

		<p>Migrate from IE as soon as possible, or embed its active X control in your app&#8217;s own dialog/window. But even that is risky. In my case when I use IE in my app, it automatically pops up another tab (covering up what my app was supposed to show) with the MS upsell to switch to Edge. This will continue &#8230;. until the next time when Microsoft abandons their current version of IE (i.e. Edge) in favor of their next latest-and-greatest piece of &amp;^%$$&#8230;.. (sorry, too many ie&#8217;s in one sentence.)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368045#respond' onclick='return addComment.moveForm( "div-comment-1368045", "1368045", "respond", "99985" )' aria-label='Reply to dennis2018'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-geelaw even thread-odd thread-alt depth-1 parent" id="comment-1367815">
				<div id="div-comment-1367815" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Gee+Law' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367815">
			October 16, 2018 at 8:41 am</a>		</div>

		<p>Since the blog is running auto-pilot, I&#8217;ll post comments using my MSA. There are two unsaid parts of the story. First, an installer cannot take default program for any file type (with usual way) unless the file type was unknown. Second, the customer can avoid this dialog again by checking &#8220;Always use this app to open .xyz files&#8221; (but if the installer tries to change the user-level association choice, the association is reset, in which case you will see this dialog).</p>
<p>That checkbox is quite confusing because it has two usages. If you invoke the &#8220;Open with&#8230;&#8221; context menu handler on a &#8220;decided&#8221; file type, the checkbox decides whether to change the association. If the dialog is for an &#8220;undecided&#8221; file type (e.g., when a new program is registered for that type), this checkbox decides whether Windows restores the file type to &#8220;undecided&#8221; next time a new program is registered for it.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367815#respond' onclick='return addComment.moveForm( "div-comment-1367815", "1367815", "respond", "99985" )' aria-label='Reply to Gee Law'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-geelaw odd alt depth-2" id="comment-1367895">
				<div id="div-comment-1367895" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Gee+Law' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367895">
			October 16, 2018 at 5:10 pm</a>		</div>

		<p>Correction: Even if you check &#8220;Always&#8230;&#8221;, Windows will ask again when a new app registers for it. This is somewhat different from what I expected&#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367895#respond' onclick='return addComment.moveForm( "div-comment-1367895", "1367895", "respond", "99985" )' aria-label='Reply to Gee Law'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1367835">
				<div id="div-comment-1367835" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367835">
			October 16, 2018 at 11:16 am</a>		</div>

		<p>Hey, Raymond&#8217;s famous HTML Dialog Boxes are back.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367835#respond' onclick='return addComment.moveForm( "div-comment-1367835", "1367835", "respond", "99985" )' aria-label='Reply to Joshua'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1367865">
				<div id="div-comment-1367865" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367865">
			October 16, 2018 at 11:36 am</a>		</div>

		<p>A LOT of programs can open TXT files.  Including Microsoft Word and Excel, Wordpad, Notepad, and many third-party text file editors.  After you install Office, and you double-click a TXT file, does this prompt come up?  I don&#8217;t think it does.</p>
<p>(I can&#8217;t re-test this myself.)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367865#respond' onclick='return addComment.moveForm( "div-comment-1367865", "1367865", "respond", "99985" )' aria-label='Reply to DWalker07'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1367875">
				<div id="div-comment-1367875" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367875">
			October 16, 2018 at 1:45 pm</a>		</div>

		<p>I don&#8217;t think Office registers TXT as a supported extension, even if Word happily opens one if you choose it in the Open dialog.</p>
<p>There&#8217;s no link between common dialog box filters and file type associations.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367875#respond' onclick='return addComment.moveForm( "div-comment-1367875", "1367875", "respond", "99985" )' aria-label='Reply to Ben Voigt'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1368335">
				<div id="div-comment-1368335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DWalker07</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368335">
			October 19, 2018 at 11:11 am</a>		</div>

		<p>Ah, right, that makes sense.  Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368335#respond' onclick='return addComment.moveForm( "div-comment-1368335", "1368335", "respond", "99985" )' aria-label='Reply to DWalker07'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-geelaw even depth-2" id="comment-1367905">
				<div id="div-comment-1367905" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Gee+Law' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367905">
			October 16, 2018 at 5:10 pm</a>		</div>

		<p>Excel and Word can open <code>.txt</code> files, but they don&#8217;t register for that. The procedure of <code>ShellExecut</code>-ing a file with default options roughly goes like this:</p>
<p>1. Collect all possible ProgIDs.<br />
2. Check if there is a valid <code>UserChoice</code> (hash consistency check + valid ProgID), if there is one, use it.<br />
3. Check if there is a new ProgID associated with this file type (using <code>ApplicationAssociationToasts</code>), if there is one, invoke &#8220;Open with&#8230;&#8221; dialog.<br />
4. Check if there is a valid user-level default ProgID (classic resolving procedure), if there is one, use it.<br />
5. Check if there is a valid machine-level default ProgID (classic resolving procedure), if there is one, use it.<br />
6. Otherwise, invoke &#8220;Open with&#8230;&#8221; dialog.</p>
<p>There is a problem with this procedure: If a new app is installed for <code>.txt</code> and the user chooses the new app in the new-app-installed-do-you-want-to-switch-dialog without checking &#8220;Always&#8230;&#8221;, the next time the user opens <code>.txt</code>, the default program will be Notepad instead of the selected app.</p>
<p>I would expect Windows to store a &#8220;weak choice&#8221; for that case. I.e., keep using the new choice (e.g. Visual Studio Code) until a new ProgID is found, when Windows should display the dialog again. I think I read somewhere this should be the expected behavior, but it seems not to be the case.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367905#respond' onclick='return addComment.moveForm( "div-comment-1367905", "1367905", "respond", "99985" )' aria-label='Reply to Gee Law'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1367925">
				<div id="div-comment-1367925" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SomeGuyOnTheInternet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367925">
			October 16, 2018 at 9:48 pm</a>		</div>

		<p>Isn&#8217;t the settings page now called &#8220;Associate a file type or protocol with a specific program&#8221; a.k.a. &#8220;Control Panel\All Control Panel Items\Default Programs\Set Associations&#8221;?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367925#respond' onclick='return addComment.moveForm( "div-comment-1367925", "1367925", "respond", "99985" )' aria-label='Reply to SomeGuyOnTheInternet'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-umeca74 even thread-odd thread-alt depth-1" id="comment-1367945">
				<div id="div-comment-1367945" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/nikos+z' rel='external nofollow' class='url'>nikos z</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367945">
			October 17, 2018 at 2:49 am</a>		</div>

		<p>there&#8217;s a bug in windows 10 at this point that causes this dialog to be shown ALL the time. For example I have outlook 2010 (64 bit) on 64 bit windows, and when I click on a hyperlink http:// in an email, I always get the question whether to open it with internet explorer (my choice browser) or something else. No amount of swearing or confirming stops this annoyance. Thankfully it is the only program that does that.</p>
<p>Also, there is always a problem with tools that happen to work with FOLDERS instead of files. The latest windows 10 update made things impossible for shell extensions that browse into archives as folders, to choose file types to associate with the NSE (a DLL basically). Perhaps you can forward this to the relevant bug report department in Microsoft? Thanks<br />
Details on this defaults bug here: <a href="https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/387505b4-16ca-42c0-82b7-d435397b9856/program-doesnt-appear-in-set-defaults-by-app?forum=windowsgeneraldevelopmentissues" rel="nofollow">https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/387505b4-16ca-42c0-82b7-d435397b9856/program-doesnt-appear-in-set-defaults-by-app?forum=windowsgeneraldevelopmentissues</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367945#respond' onclick='return addComment.moveForm( "div-comment-1367945", "1367945", "respond", "99985" )' aria-label='Reply to nikos z'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command odd alt thread-even depth-1 parent" id="comment-1367955">
				<div id="div-comment-1367955" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367955">
			October 17, 2018 at 4:39 am</a>		</div>

		<p>&gt; &#8230; most users don&#8217;t even realize that such a page even exists.</p>
<p>And Microsoft doesn&#8217;t seem to realize this page is an unmitigated failure in Windows 10. It is painful to navigate and difficult to operate.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367955#respond' onclick='return addComment.moveForm( "div-comment-1367955", "1367955", "respond", "99985" )' aria-label='Reply to Fleet Command'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1367975">
				<div id="div-comment-1367975" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1367975">
			October 17, 2018 at 5:10 am</a>		</div>

		<p>It&#8217;s way, way better than the old 9X/XP page, which we had for way too long.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1367975#respond' onclick='return addComment.moveForm( "div-comment-1367975", "1367975", "respond", "99985" )' aria-label='Reply to xcomcmdr'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-geelaw odd alt depth-2" id="comment-1368015">
				<div id="div-comment-1368015" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Gee+Law' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368015">
			October 17, 2018 at 9:16 am</a>		</div>

		<p>An annoying problem I&#8217;m experiencing is that the process stays around if I light-dismiss the dialog (instead of pressing Esc).</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368015#respond' onclick='return addComment.moveForm( "div-comment-1368015", "1368015", "respond", "99985" )' aria-label='Reply to Gee Law'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1368035">
				<div id="div-comment-1368035" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dennis2018</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368035">
			October 17, 2018 at 1:52 pm</a>		</div>

		<p>Oh, thanks for explaining this. Now I know what to blame for my broken keyboard.</p>
<p>PS. I was recently installing software on my new PC and that pop up was driving me nut.<br />
(It probably helped ten iPhone dummie&#8230; sorry &#8220;users&#8221; that switched to Windows, and infuriated 10 million previous Windows 7 users.)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368035#respond' onclick='return addComment.moveForm( "div-comment-1368035", "1368035", "respond", "99985" )' aria-label='Reply to dennis2018'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1368065">
				<div id="div-comment-1368065" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jimbo1qaz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368065">
			October 17, 2018 at 3:34 pm</a>		</div>

		<p>Does the Windows team realize they broke the dialog so I can no longer type the first few characters of the app I want? And the Browse button is hidden so I can neither press Alt+B nor click it, but must instead scroll all the way to the bottom to add a new program (which I do several times a month)?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368065#respond' onclick='return addComment.moveForm( "div-comment-1368065", "1368065", "respond", "99985" )' aria-label='Reply to jimbo1qaz'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alayacwpunj-edu even thread-odd thread-alt depth-1" id="comment-1368095">
				<div id="div-comment-1368095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Cristopher_WPU' rel='external nofollow' class='url'>Cristopher_WPU</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985#comment-1368095">
			October 18, 2018 at 4:34 am</a>		</div>

		<p>In an enterprise environment where app defaults are pre-configured by a sys admin, prompts like this can be a nuisance and generate unnecessary calls to your help desk.  Here is a discussion about suppressing what I like to refer to as advertisements for Edge.<br />
<a href="https://social.technet.microsoft.com/Forums/en-US/0f58fe0d-50aa-4a83-b14e-40398e61fe30/windows-10-osd-file-association?forum=ConfigMgrCBOSD" rel="nofollow">https://social.technet.microsoft.com/Forums/en-US/0f58fe0d-50aa-4a83-b14e-40398e61fe30/windows-10-osd-file-association?forum=ConfigMgrCBOSD</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://blogs.msdn.microsoft.com/oldnewthing/20181016-00/?p=99985&#038;replytocom=1368095#respond' onclick='return addComment.moveForm( "div-comment-1368095", "1368095", "respond", "99985" )' aria-label='Reply to Cristopher_WPU'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

