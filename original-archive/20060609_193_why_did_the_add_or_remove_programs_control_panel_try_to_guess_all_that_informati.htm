<html>
<head>
<title>Why did the Add or Remove Programs control panel try to guess all that information?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why did the Add or Remove Programs control panel try to guess all that information?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 9, 2006 / year-entry #194</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>38</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">As we saw earlier, the "Add or Remove Programs" control panel used several heuristics to attempt to determine things like program size and frequency of user. Why did it bother doing this at all? At the time the feature was added, disk space was not cheap like it is today. One of the problems users...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p><a href="http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx"> As we saw earlier</a>, the "Add or Remove Programs" control panel used several heuristics to attempt to determine things like program size and frequency of user. Why did it bother doing this at all?</p>
<p> At the time the feature was added, disk space was not cheap like it is today. One of the problems users were having was running out of disk space and not knowing what they could safely delete. Thus was born the Disk Cleanup utility, which attempted to guide the user through various things that could be deleted in order to make disk space available. </p>
<p> In addition to cleaning up temporary files, you could also remove programs that weren't being used. But how do you know which programs you weren't using? (Maybe you were using a program without realizing it because it ran automatically.) And how do you know how much disk space would be recovered if you removed a program? That's where the program size and frequency of use heuristics came in. By providing this information (or at least trying to), the "Add or Remove Programs" control panel could help users decide which programs to remove. </p>
<p> Of course, nowadays, with hard drives in the hundreds-of-gigabytes range, disk space has become so cheap as to be nearly free. The need to remove programs to make more disk space available is largely gone, but the feature remains as a vestigial organ. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (38)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-389443">
				<div id="div-comment-389443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">theCoach</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389443">
			June 9, 2006 at 10:22 am</a>		</div>

		<p>The circle turns with regard to space. Shooting RAW images with a Nikon D200 is filling up a lot of diskspace. And, when I get the 1080P video camera, coupled with Media Center, storage is getting expensive again &#8211; not nearly free.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389463">
				<div id="div-comment-389463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">keeron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389463">
			June 9, 2006 at 10:29 am</a>		</div>

		<p>theCoach,</p>
<p>you then just need another one of those &quot;cheap&quot; 200gb/300gb harddrives :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389473">
				<div id="div-comment-389473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mikenbondi.blogspot.com' rel='external nofollow' class='url'>Mike</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389473">
			June 9, 2006 at 10:29 am</a>		</div>

		<p>It&#8217;s not so much diskspace that I would care about as registry crud. If I&#8217;m not using a lot of programs then I&#8217;d like to get rid of as many possible file-handlers and other object-lichen that make a noticeable effect on day-to-day performance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389493">
				<div id="div-comment-389493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BobDobbs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389493">
			June 9, 2006 at 10:38 am</a>		</div>

		<p>Still, this is useful.. what would be good is if it didn&#8217;t take so long to populate on slower computers (some celerons at work)&#8230; <br />Surely some information could be loaded after the list was initially populated (like last used)</p>
<div class=post>[<i>It&#8217;s only computed once and then cached. <a href="http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx#180227" rel=nofollow rel="nofollow">Please read the linked article</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-389503">
				<div id="div-comment-389503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389503">
			June 9, 2006 at 10:39 am</a>		</div>

		<p>You have clearly not seen the 2nd hard drive on my dev machine. &nbsp;With 4 Vista enlistments, it&#8217;s a constant battle to keep it under 20G free.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389513">
				<div id="div-comment-389513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389513">
			June 9, 2006 at 10:43 am</a>		</div>

		<p>The only problem with these huristics is that &nbsp;they are calculated syncronusly, meaning it practically locks up the system while you wait (High disc usages has a much higher impact on other proccesses than high CPU usuage) and they are frequently wrong.</p>
<p>Anyone using Vista know if it is any better?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389533">
				<div id="div-comment-389533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389533">
			June 9, 2006 at 10:56 am</a>		</div>

		<p>Hopefully as Windows Installer moves towards a more declarative approach to .msi packages, it will get to the point where .msi compilers will know <em>exactly</em> how big applications (and application components, for if you choose to install only part of an app) are, and be able to output the code to write the registry details without app writers needing to worry about this in the slightest.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389563">
				<div id="div-comment-389563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389563">
			June 9, 2006 at 11:10 am</a>		</div>

		<p>I quick check in my Add/Remove programs shows how wrong the information is. It seems that the usage information depends entirely on the start menu icon. Therefore, both VLC (which I used less than an hour ago to watch a DVD) and MSN Messenger, which runs on every startup and is running now, are shown as having not been used since their date of installation.</p>
<p>This means that even Raymond&#8217;s example of a program you were using without realising because it runs automatically would have incorrect information (unless, I suspect, it uses to Startup group on the start menu).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389593">
				<div id="div-comment-389593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com/' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389593">
			June 9, 2006 at 11:31 am</a>		</div>

		<p>My recollection is that this feature was added for Windows 2000 and that the Disk Cleanup utility first appeared in Windows 98. I don&#8217;t remember disk space being that expensive in 1999. It was more expensive than it is now, but not I-got-to-delete-me-some-programs expensive. Or perhaps my memory&#8217;s all skewed!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389623">
				<div id="div-comment-389623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389623">
			June 9, 2006 at 11:37 am</a>		</div>

		<p>It would be extremely valuable to know whether a user is using all the junk installed on their system. Disk space or registry junk is not a big issue, but other system resources and system stability are affected as well. It&#8217;s not that unusual to see a system where startup includes Adobe Gamma Loader, Quicktime, Office Startup, Realplayer, and several program registration reminders. They can add several seconds to startup time but NONE of them are needed by anyone. And if you have some crummy driver loaded that is looking for hardware that has been removed (USB perhaps) it can be even worse.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389653">
				<div id="div-comment-389653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://interwebsurfin.blogspot.com' rel='external nofollow' class='url'>Hob Gadling</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389653">
			June 9, 2006 at 12:09 pm</a>		</div>

		<p>I wish the Add Remove Programs control panel had a way of sorting programs by install date. That would be really helpful sometimes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389673">
				<div id="div-comment-389673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">foxyshadis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389673">
			June 9, 2006 at 12:14 pm</a>		</div>

		<p>John, Win2k was designed for 2-3 year old machines being upgraded as well, in &#8217;97 8 GB was good. Although by the time XP rolled around it had already outlived its usefulness, I still manage to find some random game or enormous video processing program when I take a look every few months.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389743">
				<div id="div-comment-389743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://aundh.blogspot.com/' rel='external nofollow' class='url'>JamesW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389743">
			June 9, 2006 at 1:12 pm</a>		</div>

		<p>I don&#8217;t think it matters how much drive space you have. There is some rule that means content will be found to fill it. I&#8217;ve got 0.5TB of storage in my tower and still find myself managing diskspace. Having such goodies as every colour episode of Doctor Who (and a few B&amp;W ones) might have something to do with it! It&#8217;ll soon be time to fill the final drive bay&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389803">
				<div id="div-comment-389803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389803">
			June 9, 2006 at 1:46 pm</a>		</div>

		<p>Add/Remove Programs is so painfully slow to load up on my machine I&#8217;ve turned to a simple open source program, Safarp (Small And Fast Add/Remove Programs) to use instead:</p>
<p><a rel="nofollow" target="_new" href="http://wistinga.online.fr/safarp/" rel="nofollow">http://wistinga.online.fr/safarp/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389813">
				<div id="div-comment-389813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389813">
			June 9, 2006 at 1:49 pm</a>		</div>

		<p>I assume this is part of why the Add/Remove dialog can take so long to show the list of installed programs, especially on systems with a ton of stuff installed.</p>
<p>Is it possible to disable this feature so the panel opens faster?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389833">
				<div id="div-comment-389833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miles Archer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389833">
			June 9, 2006 at 2:46 pm</a>		</div>

		<p>There&#8217;s another reason for this mess. At the time, most programs were not &quot;installed&quot; per se. They were copied to a directory and you would run the executable. Even in Windows 3.1, this was what people mostly did.</p>
<p>With Windows 95, you couldn&#8217;t just delete the programs directory any more because there might be files in the System directory, or some other place.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389843">
				<div id="div-comment-389843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.amotif.com/' rel='external nofollow' class='url'>Curt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389843">
			June 9, 2006 at 2:50 pm</a>		</div>

		<p>&quot;Of course, nowadays, with hard drives in the hundreds-of-gigabytes range, disk space has become so cheap as to be nearly free.&quot;</p>
<p>Heh. I&#8217;ve noticed that WMP11 tells me the size of every track in my library. Do I care that Getz and Byrd&#8217;s Desafinado takes 8MB (0.0126%) of my small boot drive? :-) Maybe if it listed spaced used per album it might make more sense to me, but even that won&#8217;t when I buy my next machine.</p>
<p>(I know, I know, those of you with puny 128MB MP3 players care. :) )</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-john-c-kirk odd alt thread-odd thread-alt depth-1" id="comment-389853">
				<div id="div-comment-389853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/John+C.+Kirk' rel='external nofollow' class='url'>John C. Kirk</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389853">
			June 9, 2006 at 3:06 pm</a>		</div>

		<p>Actually, I think this is a feature that&#8217;s still useful nowadays, mainly due to partitions. I often come across situations where someone has done a 4Gb partition for the C drive and put everything else onto the D drive, and then I don&#8217;t have enough space to upgrade to a new version of Windows. In a case like that, one solution is to uninstall things from the C drive and re-install them to the D drive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389903">
				<div id="div-comment-389903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reinder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389903">
			June 9, 2006 at 4:09 pm</a>		</div>

		<p>&quot;Maybe you were using a program without realizing it because it ran automatically.&quot;</p>
<p>Wasn&#8217;t this, specifically, one of the cases where the control panel wouldn&#8217;t notice that the application run, at all? (yep, looking back, I read &quot;Add/Remove Programs needs to know the name of the EXE so it can ask the Start menu &quot;Hey, how often did the user run this program, and when was the last time it happened?&quot;&quot;; the comments seem to indicate that that, literally, is what the code does)</p>
<p>I think this shows a nice anti-pattern that Microsoft is (or possibly: was. I haven&#8217;t looked closely at Vista yet, and do have high hopes for the new Office 2007 UI paradigm) guilty of more than &quot;that other commercial desktop OS vendor&quot;:</p>
<p>1) Notice a problem with the current UI (it is impossible for mortal users to determine what programs they run, or what they are called)<br />
<br />2) With all the best intentions, try to improve the situation by adding complexity to the design of the system<br />
<br />3) Someone discovers that this does not &#8216;quite&#8217; work (in this case, it works hardly at all), quite possibly before the product ships<br />
<br />4) The product is shipped, anyways (I guess because one does not want to &#8216;lose&#8217; the money invested, or because having a new feature is priority #1, rather than improving the product)</p>
<p>The net result is that one can nicely demo an improvement in usability (&quot;look, we now show how much disk space you will gain by removing each component&quot;) that, in practice, does not help users much, if at all.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389423">
				<div id="div-comment-389423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389423">
			June 9, 2006 at 10:15 am</a>		</div>

		<p>OK, out of curiosity, how does it work? </p>
<div CLASS=post>[<i>Please read the linked article. -Raymond</i>]</div>
<p>For instance, I have Microsoft Visual SourceSafe 6.0 showing up in my add/remove list. &nbsp;It was installed as part of VS6, then the next service pack version (still 6.0, but 6.0d or 6.0e or something like that) was installed as part of VS.net 2003. &nbsp;SourceSafe also doesn&#8217;t really have its own Program Files directory. </p>
<p>But the space used is showing up as 928MB. &nbsp;I know that there&#8217;s no *way* it&#8217;s using that much space (its database isn&#8217;t on this machine). &nbsp;I also see VS.net 2003 listed just below it, at 924MB. &nbsp;The 4MB difference looks strange &#8212; is there a case where one package &#8220;depends&#8221; on another, and for some reason the size of the second package is included in the size of the first?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389893">
				<div id="div-comment-389893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389893">
			June 9, 2006 at 3:19 pm</a>		</div>

		<p>&gt; Please read the linked article.</p>
<p>Uh&#8230; oops. &nbsp;*embarrassed look*</p>
<p>Thank you for the cluebat; that pretty much exactly explains what I was asking.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-389923">
				<div id="div-comment-389923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389923">
			June 9, 2006 at 5:17 pm</a>		</div>

		<p>Actually MSI *does* know how big the installed app is because the MSI file table contains the size of each file. If the MSI author thinks it&#8217;s wrong, they can correct it with the ReserveCost table. So MSI installations could be more accurate, assuming the author cares about getting the size right. Having said all that, there doesn&#8217;t seem to an MSI API that returns the size of a product anyway! Apparently it&#8217;s more for use in installation dialogs, not ARP. </p>
<p>It&#8217;s possible that some product usage counting is tracked through MSI shortcuts (not &nbsp;the same as ordinary shortcuts) &#8211; activation of an MSI shortcut could call MsiUseFeature. Again, I have no evidence that it actually does however, and I haven&#8217;t tested anything.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389983">
				<div id="div-comment-389983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vince P</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-389983">
			June 9, 2006 at 8:23 pm</a>		</div>

		<p>When it comes to knowing what to delete, I wish there was some (obvious) guidance on what to do about the C:Windows directory.</p>
<p>Following is a list of the 20 largest subfolders .. </p>
<p>I&#8217;d like to know (this is a rhetorical question) what I could delete should I ever get to the place where I&#8217;m out of other options. I put * before the obvious &quot;don&#8217;t touch&quot; folders.</p>
<p>*C:WINDOWSsystem32drivers	35,095,242<br />
<br />*C:WINDOWSMicrosoft.NETFrameworkv1.1.4322	35,689,304<br />
<br />*C:WINDOWSMicrosoft.NETFrameworkv1.0.3705	35,969,533<br />
<br />*C:WINDOWSWinFXv3.0WPF	39,181,638<br />
<br />C:WINDOWS	42,693,789<br />
<br />C:WINDOWSHelp	43,078,752<br />
<br />C:WINDOWSInstaller$PatchCache$Managed69F14A0E13278EA46A45EE3BF43945269.0.1399	52,154,966<br />
<br />*C:WINDOWSinf	58,338,154<br />
<br />C:WINDOWSsystem32dllcache	64,381,344<br />
<br />*C:WINDOWSFonts	77,389,800<br />
<br />C:WINDOWSSymbolsdll	86,847,488<br />
<br />C:WINDOWSDriver Cachei386	91,314,691<br />
<br />*C:WINDOWSsystem32config	97,702,024<br />
<br />*C:WINDOWSMicrosoft.NETFrameworkv2.0.50727	117,867,218<br />
<br />C:WINDOWSehome	153,965,599<br />
<br />C:WINDOWSInstaller$PatchCache$ManagedB29A3732C1C117E44B49C59AF769AA919.0.1399	164,519,124<br />
<br />C:WINDOWSInstaller$PatchCache$Managed DD23009EEBA4244CAE10B67DB4D3E059.0.1399	247,449,468<br />
<br />*C:WINDOWSsystem32	561,230,350<br />
<br />C:WINDOWSInstaller	724,433,269<br />
<br />C:WINDOWSTemp	1,661,046,615</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390103">
				<div id="div-comment-390103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://paulcoddington.info' rel='external nofollow' class='url'>Paul Coddington</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390103">
			June 10, 2006 at 12:01 pm</a>		</div>

		<p>&quot;I don&#8217;t have enough space to upgrade to a new version of Windows. In a case like that, one solution is to uninstall things from the C drive and re-install them to the D drive.&quot;</p>
<p>Quicker and easier to simply resize the partitions. &nbsp;</p>
<p>Reinstalling some programs to the D drive defeats the whole purpose of having 2 partitions in the first place, surely?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390073">
				<div id="div-comment-390073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390073">
			June 10, 2006 at 8:01 am</a>		</div>

		<p>Open your c:windowstemp directory in explorer, sort by date, delete anything with a last modified date more than 1 week old. That folder *should* also probably be cleared out on reboot.</p>
<p>The clue is in the name.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-390143">
				<div id="div-comment-390143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390143">
			June 11, 2006 at 7:30 pm</a>		</div>

		<p>&quot;Quicker and easier to simply resize the partitions.&quot;</p>
<p>But not cheaper. &nbsp;I think it&#8217;s silly that programs like PartitionMagic are sold for like $60 for someone who just wants to resize one partition one time.</p>
<p>Partition resizing should definitely be part of the operating system. &nbsp;Vista supposedly has a few more partition management features in it, but I think that&#8217;s what Symantec is suing them about&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390193">
				<div id="div-comment-390193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.michael-puff.de' rel='external nofollow' class='url'>Michael Puff</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390193">
			June 12, 2006 at 8:19 am</a>		</div>

		<p>An information I can&#8217;t trust is nearly useless for me.</p>
<p>I&#8217;m using Ad-Aware SE Personal. I run ist mostly under another user account. If I look it up it reads Used: seldom / frequently. (I&#8217;m using a German Windows XP, don&#8217;t know the original caption.) But what das seldom / frequently mean in this case? How often is seldom / frequently? I&#8217;m using it to see if everything is still OK with my system. I think it would be a bad idea removing it, even so Windows seems to advise me to do so.</p>
<p>That&#8217;s why I think this Information is useless. Even worse: The entry reads: Last used: 2005-12-25. And that&#8217;s absolutely wrong. I ran it just yesterday under the administrator account. If I would follow Windows&#8217; advice I could remove it because I haven&#8217;t used it for neary half a year.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-heaths odd alt thread-odd thread-alt depth-1" id="comment-390303">
				<div id="div-comment-390303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Heath+Stewart+%28MSFT%29' rel='external nofollow' class='url'>Heath Stewart (MSFT)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390303">
			June 12, 2006 at 12:27 pm</a>		</div>

		<p>The calculations regarding Windows Installer are way too low, though. Because of all the caching Windows Installer does &#8211; including the addition of the MSPs in their entirety which ARP won&#8217;t take into account because it calculates once and caches &#8211; the amount of drive spaced used for an application is practically useless, especially as more and more applications switch to Windows Installer (and very many already are).</p>
<p>See <a rel="nofollow" target="_new" href="http://blogs.msdn.com/heaths/archive/2006/04/20/580237.aspx" rel="nofollow">http://blogs.msdn.com/heaths/archive/2006/04/20/580237.aspx</a> for details.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390313">
				<div id="div-comment-390313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NBC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390313">
			June 12, 2006 at 1:19 pm</a>		</div>

		<p>and why does C:WINDOWSInstaller msi file contains the install program ? that kind of similar to have 2 time the same program</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390323">
				<div id="div-comment-390323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390323">
			June 12, 2006 at 1:25 pm</a>		</div>

		<p>Another expensive feature that doesn&#8217;t even work half the time (and this passed triage?). Hopefully Vista doesn&#8217;t have too many more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390423">
				<div id="div-comment-390423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Really J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390423">
			June 12, 2006 at 7:01 pm</a>		</div>

		<p>&quot;But not cheaper. &nbsp;I think it&#8217;s silly that programs like PartitionMagic are sold for like $60 for someone who just wants to resize one partition one time.&quot;</p>
<p>If you just need to resize one partition one time, you can try a free utility. &nbsp;GParted is a good one (<a rel="nofollow" target="_new" href="http://gparted.sourceforge.net/" rel="nofollow">http://gparted.sourceforge.net/</a>) that does ntfs.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390473">
				<div id="div-comment-390473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-390473">
			June 12, 2006 at 8:38 pm</a>		</div>

		<p>Many applications take at least twice the space reported by Add/Remove Pgms, even if Add/Remove was correct.</p>
<p>Their installer copies the entire MSI into %windir%Installer. Presumably this allows the user to repair the app without the original CD.</p>
<p>The user isn&#8217;t told the truth. Apps that say &quot;require 100MB disk space&quot; use may need 300MB for install temp files and take 200MB because of the duplicate MSI.</p>
<p>Oh, and if there&#8217;s 100MB on C:, you cannot even install the app into D: because the MSI has to be copied into C:WINDOWSInstaller</p>
<p>As far as I&#8217;m concerned, disk space estimates are utterly useless. I doubt the developers even know the real numbers &#8211; they blindly rely on InstallShield and MSI.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391743">
				<div id="div-comment-391743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://boardgamemadness.blogspot.com' rel='external nofollow' class='url'>Todd Derscheid</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-391743">
			June 14, 2006 at 6:00 pm</a>		</div>

		<p>Raymond, thanks for revisiting this topic.</p>
<p>Here&#8217;s my findings, courtesy of my company running a mixture of old and new hard drives, with varying partitions and overall sizes:</p>
<p>As long as you&#8217;ve backed up your data, you can use a Knoppix Linux boot CD or DVD to boot a PC running Windows XP into Linux, then use the &quot;QTPartED&quot; utility to resize the partitions on the fly, avoiding shelling out $69 for Partition Magic. &nbsp;I have done this several times successfully, and it averages about 45 minutes start to finish, less on faster machines.</p>
<p>Note that Windows may detect that the swap file has changed, turn it off the first time you reboot, and then you&#8217;ll have to turn it on again. &nbsp;A disk check is automatically scheduled as well. &nbsp;It looks scarier than it really is.</p>
<p>I also recommend using the fine SysInternals tools to defragment your pagefile if you haven&#8217;t already. &nbsp;It&#8217;s by the hero of the Sony rootkit saga, Mark Russinovich, and defrags XP registry sections that don&#8217;t get hit by the normal XP defrag (which is pretty weak).</p>
<p>You may also like getting Diskkeeper or O&amp;O Defrag for awesome defragging results. &nbsp;There is also a free defragger located around whitneyfamily.org that is fairly opaque but seems to do a better job when combined with the regular XP defrag than just the XP defrag by itself (which is pretty weak).</p>
<p>Juggling partition sizes HALVED the time it took Word, Excel, and other programs to boot on my older laptop, for instance. &nbsp;Several people in my office were chagrined to discover that it wasn&#8217;t Microsoft&#8217;s fault, it was their boneheaded partitioning scheme that made programs seem slow.</p>
<p>I seem to recall hearing that Microsoft is also working on a on-the-fly partition manager, logical since you can do that with some newer Macs. &nbsp;This would be awesome for testing Vista, for instance, since you could partition on the fly, install it in 5 partitions, then as you eliminated the worst-performing installations, you could redistribute the space to the Vista partitions you liked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392093">
				<div id="div-comment-392093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.crazy-pug.co.uk/software.htm' rel='external nofollow' class='url'>Will Alber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-392093">
			June 15, 2006 at 3:33 pm</a>		</div>

		<p>I got so sick of the time it took Windows to populate the Add/Remove dialog that I wrote my own very-light-weight version &#8211; QuikUninstall (<a rel="nofollow" target="_new" href="http://www.crazy-pug.co.uk/QUSetup.zip" rel="nofollow">http://www.crazy-pug.co.uk/QUSetup.zip</a>). &nbsp;OK, so it&#8217;s not pretty nor is it polished, but it works nicely. &nbsp;There&#8217;s a little bit of a hit the first time your start it (it uses the .net Framework V1.1), but on subsequent loads (I&#8217;m a programmer an leave my computer on a lot) it&#8217;ll load in less than a second. &nbsp;Best thing &#8211; it&#8217;s free (so no, I&#8217;m not trying to sell anything!) &nbsp;:).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393703">
				<div id="div-comment-393703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-393703">
			June 21, 2006 at 4:48 am</a>		</div>

		<p>Depressingly, it looks as if Windows actually ignores the EstimatedSize<br />
value in the Registry; from the installer forums I looked at, it seems<br />
you need to write your own value into SlowInfoCache instead. (Possibly<br />
wrong, in which case any documentation would be greatly appreciated!)</p>
<p>Probably guaranteed to make Raymond&#8217;s lunch come back, given his<br />
&#8220;love&#8221; of ugly hacks like this &#8211; but at least it works, and DriverDude<br />
will be happy to know the filesize is exactly correct (calculated as<br />
the files are copied, taking into account compression if the target<br />
directory is compressed).</p>
<div CLASS=post>[<i>EstimatedSize is used for MSI apps. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393793">
				<div id="div-comment-393793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/sw/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-393793">
			June 21, 2006 at 2:28 pm</a>		</div>

		<p>[EstimatedSize being ignored for non-MSI apps]</p>
<p>That was the suspicion I got, yes; I&#8217;d just been hoping for a &quot;cleaner&quot; way to specify application size than entering values into SlowInfoCache directly. :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543563">
				<div id="div-comment-543563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.dirteam.com/blogs/sanderberkouwer/archive/2007/08/27/add-or-remove-programs-in-server-core.aspx' rel='external nofollow' class='url'>The things that are better left unspoken</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-543563">
			August 28, 2007 at 8:11 am</a>		</div>

		<p>After playing around with Server Core for a while I&#8217;m beginning to wonder how to perform certain administrative</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-586633">
				<div id="div-comment-586633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.techquestonline.com/2008/01/07/myuninstaller-alternative-to-addremove-programs/' rel='external nofollow' class='url'>MyUninstaller &#8212; Alternative to Add/Remove Programs : TechQuestOnline</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060609-07/?p=30923#comment-586633">
			January 7, 2008 at 11:14 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.techquestonline.com/2008/01/07/myuninstaller-alternative-to-addremove-programs/" rel="nofollow">http://www.techquestonline.com/2008/01/07/myuninstaller-alternative-to-addremove-programs/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

