<html>
<head>
<title>What idiot would hard-code the path to Notepad?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>What idiot would hard-code the path to Notepad?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>January 28, 2010 / year-entry #30</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>46</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">There seemed to be a great deal of disbelief that anybody would hard-code the path to Notepad. Here's one example and here's another. There's a large class of problems that go like this: I'm running Program X, and when I tell it to view the error log, I get this error message: CreateProcess of "C:\Windows\Notepad.exe errorlog.txt"...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>There seemed to be a great deal of disbelief that <a href="http://blogs.msdn.com/oldnewthing/archive/2006/03/28/563008.aspx#563177"> anybody would hard-code the path to Notepad</a>.</p>
<p> <a href="http://web.archive.org/web/20071112140003/http://support.installshield.com/kb/view.asp?articleid=Q108710"> Here's one example</a> and <a href="http://www.code-magazine.com/article.aspx?quickid=0001061&amp;page=3"> here's another</a>. </p>
<p> There's a large class of problems that go like this: </p>
<blockquote class="q"><p> I'm running Program&nbsp;X, and when I tell it to view the error log, I get this error message: <code>CreateProcess of "C:\Windows\Notepad.exe errorlog.txt" failed: <a href="http://blogs.msdn.com/oldnewthing/archive/2010/01/27/9953807.aspx"> error&nbsp;2</a>: The system cannot find the file specified.</code> What is wrong and how do I fix it? </p>
</blockquote>
<p> Obviously, the file <code>C:\Windows\Notepad.exe</code> is missing. But how can that be? Well, Windows Server&nbsp;2008 bit the bullet and removed one of the copies of Notepad. Once you learn this, troubleshooting the above problem becomes a simple exercise in psychic debugging. </p>
<blockquote class="m"><p> My psychic powers tell me that you're running Windows Server&nbsp;2008. The Notepad program no longer exists in the Windows directory; it's now in the system directory. Find the setting for your program that lets you change the program used for viewing error logs and tell it to use <code>C:\Windows\System32\Notepad.exe</code>. </p>
</blockquote>
<p> Of course, this tip works only if the program permits you to change the program used for viewing error logs. If they hard-code the path, then you'll have to find some other workaround. (For example, you might try using the <a href="http://blogs.msdn.com/cjacks/archive/2007/10/15/using-the-correctfilepaths-shim-to-redirect-files-on-windows-vista.aspx"> CorrectFilePaths shim</a>.) </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (46)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-806373">
				<div id="div-comment-806373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bahbar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806373">
			January 28, 2010 at 7:30 am</a>		</div>

		<p>That&#8217;s the problem with hardcoding URLs. when the internet changes, they don&#8217;t point to the right location anymore.</p>
<p>Now, the equivalent to a PATH would be a search engine, but as it happens, I could not find a trace of that article. archive.org will have to do :(</p>
<p><a href="http://web.archive.org/web/20071112140003/http://support.installshield.com/kb/view.asp?articleid=Q108710" target=_new rel=nofollow rel="nofollow">http://web.archive.org/web/20071112140003/http://support.installshield.com/kb/view.asp?articleid=Q108710</a></p>
<div class=post>[<i>Fixed. Thanks. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-806393">
				<div id="div-comment-806393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806393">
			January 28, 2010 at 8:20 am</a>		</div>

		<p>Alternative solution:</p>
<p>copy /y %windir%system32notepad.exe %windir%notepad.exe</p>
<p>What went wrong first? &nbsp;That is to say, what was in the error log?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806403">
				<div id="div-comment-806403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806403">
			January 28, 2010 at 8:20 am</a>		</div>

		<p>Do they really mean &quot;c:windowsnotepad.exe&quot; or &quot;%SystemRoot%notepad.exe&quot;? If the former then not just 2008 would break.</p>
<p>One of the more bizzare twists is why 64bit programs end up in windowssystem32</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806423">
				<div id="div-comment-806423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806423">
			January 28, 2010 at 8:44 am</a>		</div>

		<p>I&#8217;ve always assumed that 64bit programs ended up in windowssystem32 precisely because so many people were hardcoding %windir%system32XXX paths.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806433">
				<div id="div-comment-806433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806433">
			January 28, 2010 at 8:59 am</a>		</div>

		<p>Just wondering: How are you supposed to know where Notepad is except by hard coding it? Granted that you could, perhaps, be wrong by referencing the %WINDIR%Notepad one though I don&#8217;t know of any definitive reference as to which one was &quot;correct&quot; aside from your blog in &#8217;06.</p>
<p>Or is this a scenario where you want to ShellExecute instead of CreateProcess? That poses a not-so-fun challenge for Windows Installer :-</p>
<p>Likely there&#8217;s something obvious I&#8217;ve missed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806443">
				<div id="div-comment-806443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">604k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806443">
			January 28, 2010 at 9:02 am</a>		</div>

		<p>Programs which have bugs like this are probably written after nt3/nt4/w2k was released. Those OS have the windows path to C:WINNT. How can any expect those progams to work? What if I hardcoded the path to c:windows2020notepad.exe today, and expected it to work when windows 2020 is released. Don&#8217;t compensate for this kind of bugs.</p>
<p>notepad.exe is in the PATH, how hard could it be to start it from anywhere? A well written program can then start it from whereever, like &quot;\serversharewin owsno pad.exe&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806463">
				<div id="div-comment-806463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806463">
			January 28, 2010 at 9:18 am</a>		</div>

		<p>I think the point is that you shouldn&#8217;t be relying on notepad in the first place. &nbsp;You can either use ShellExecute on the text file to have the default text editor open it, or you can have a configuration option where the user can specify which editor to use. &nbsp;Notepad is probably the default editor in 95% of cases. &nbsp;The only issue with the ShellExecute method is if you&#8217;re using a file extension that is not registered or registered with something else (i.e. Excel or something).</p>
<div class=post>[<i>The problem with ShellExecute is that in the general case, you don&#8217;t know when the user closes your document. (For example, because you want let the user make changes and save the file, and your program wants to read the changes back out.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806493">
				<div id="div-comment-806493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806493">
			January 28, 2010 at 11:11 am</a>		</div>

		<p>I suppose you could iterate the path and run what you find. If only there was a library function I could call&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806503">
				<div id="div-comment-806503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://authenticbattledamage.blogspot.com/' rel='external nofollow' class='url'>Tone</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806503">
			January 28, 2010 at 11:23 am</a>		</div>

		<p>To answer the question. What idiot would hard-code the path to Notepad?</p>
<p>An idiot with requirements.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806523">
				<div id="div-comment-806523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806523">
			January 28, 2010 at 11:29 am</a>		</div>

		<blockquote><p>
  I think the point is that you shouldn&#8217;t be relying on notepad in the first place.
</p></blockquote>
<p>Why not? It&#8217;s a reasonable choice for a text viewer (as opposed to writing your own) and windows doesn&#8217;t have an EDITOR variable that you can use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806533">
				<div id="div-comment-806533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806533">
			January 28, 2010 at 11:32 am</a>		</div>

		<p>You could say the same of CreateProcess; closing a document != quitting an application.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806543">
				<div id="div-comment-806543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806543">
			January 28, 2010 at 11:34 am</a>		</div>

		<blockquote><p>
  Why not?
</p></blockquote>
<p>Because then you have to keep multiple copies of notepad.exe on the system to maintain backward compatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806553">
				<div id="div-comment-806553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806553">
			January 28, 2010 at 11:38 am</a>		</div>

		<p>@John:</p>
<p>DemoShield is an installation delivery technology: <a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Packaging_%26_Deployment" rel="nofollow">http://en.wikipedia.org/wiki/Packaging_%26_Deployment</a></p>
<p>Prompting a user for the location of their favorite text editor is miserable. There are times you don&#8217;t want to move on with the install until the user closes the document. There are workarounds to some of these situations, but if you take the DemoShield situation and modernize it:</p>
<p>Windows Installer has no built-in functionality to launch a text file. The only way to do this is with an EXE Custom Action, which is basically a fancy wrapper around CreateProcess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806573">
				<div id="div-comment-806573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806573">
			January 28, 2010 at 11:52 am</a>		</div>

		<p>Since Notepad is in the path, you can just call CreateProcess with &quot;notepad.exe&quot; and not have to worry about where it&#8217;s located.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806583">
				<div id="div-comment-806583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806583">
			January 28, 2010 at 11:54 am</a>		</div>

		<p>@Bryan:</p>
<p>Obviously an installer would use ShellExecute instead of prompting. &nbsp;I can&#8217;t believe I had to write that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806593">
				<div id="div-comment-806593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806593">
			January 28, 2010 at 11:58 am</a>		</div>

		<p>@Bryan</p>
<p>The directory containing notepad.exe is in the %PATH% variable by default. &nbsp;It seems to me more sensible to just execute it without specifying an absolute path (or if you for some strange reason need an absolute path, start looking for it in %PATH% yourself), and if the user has manually removed the Windows directory or system32 from their PATH, they kind of deserve the consequences.</p>
<p>PS: my captcha was 386, nice nerd significance there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806603">
				<div id="div-comment-806603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806603">
			January 28, 2010 at 12:30 pm</a>		</div>

		<p>How about using the &quot;EDITOR&quot; environment variable like UNIX? :) ( eg crontab, cvs, svn,&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806613">
				<div id="div-comment-806613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806613">
			January 28, 2010 at 12:30 pm</a>		</div>

		<p>@John:</p>
<p>Windows Installer doesn&#8217;t ShellExecute, so I don&#8217;t know why you would think you didn&#8217;t have to write that.</p>
<p>@Anonymous and others:</p>
<p>I also over-simplified and should have been more specific, but MSI calls for the full path &amp; file name for Type 34 Custom Actions. You might be able to just not include the Directory and have it work by luck, but most of the time that&#8217;s unacceptable risk in my experience.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806623">
				<div id="div-comment-806623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">link</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806623">
			January 28, 2010 at 12:48 pm</a>		</div>

		<blockquote><p>
  The Notepad program no longer exists in the Windows directory; it&#8217;s now in the system directory
</p></blockquote>
<p>Why not create a symbolic/hard link from c:windowsnotepad.exe to c:windowssystem32notepad.exe instead of removing it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806633">
				<div id="div-comment-806633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806633">
			January 28, 2010 at 12:49 pm</a>		</div>

		<p>NSIS 4ever!!!</p>
<p>:P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806643">
				<div id="div-comment-806643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806643">
			January 28, 2010 at 1:08 pm</a>		</div>

		<p>@Bryan:</p>
<p>I meant you could invoke ShellExecute from a custom action.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806653">
				<div id="div-comment-806653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806653">
			January 28, 2010 at 1:16 pm</a>		</div>

		<p>Just call ShellExecute with the text file and let the OS figure out the rest.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806663">
				<div id="div-comment-806663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.fluidscape.co.nz/' rel='external nofollow' class='url'>Duncan Bayne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806663">
			January 28, 2010 at 1:28 pm</a>		</div>

		<blockquote><p>
  Of course, this tip works only if the program</p>
<p>  permits you to change the program used for viewing</p>
<p>  error logs
</p></blockquote>
<p>This sort of problem is actually one of the strongest arguments for Free Software, or for buying a source code licence for proprietary software.</p>
<p>If you have access to the source code, you can fix problems like this ten years down the track, or pay someone else to fix it.</p>
<p>Whenever I&#8217;m evaluating commercial third-party software, libraries and tools (which is often as a consultant &amp; contractor) my advice is almost always: buy the source code. &nbsp;</p>
<p>It may be more expensive up front, but it&#8217;ll save your ass further down the track.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806683">
				<div id="div-comment-806683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.parkscomputing.com/' rel='external nofollow' class='url'>Paul M. Parks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806683">
			January 28, 2010 at 1:35 pm</a>		</div>

		<p>@link: Raymond covered this previously.</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2009/03/12/9471146.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2009/03/12/9471146.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806693">
				<div id="div-comment-806693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mircea</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806693">
			January 28, 2010 at 1:35 pm</a>		</div>

		<p>You might not be able to CALL ShellExecute in the first place. One example is installers &#8211; specifically Windows installer. You may also not have access to the Windows API, because your application is written in a scripting language for example.</p>
<p>Hard-coding paths isn&#8217;t stupid, it may be a requirement in some cases. And since all widely-used Windows versions except Server 2008 store Notepad in both %WINDIR% and %SYSTEMROOT% you can&#8217;t know which one to use, so you&#8217;ll just pick one.</p>
<p>It&#8217;s not that programmers are stupid, it&#8217;s that in some cases they don&#8217;t have a choice besides hard-coding. And how many installations of Windows have you seen in places other than C:Windows today? Exclude old NT that used WINNT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806703">
				<div id="div-comment-806703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mircea</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806703">
			January 28, 2010 at 1:37 pm</a>		</div>

		<p>@Duncan Bayne:</p>
<p>There are cases where the source code is not available. And for sure you can&#8217;t do much to already-installed programs. Users expect their programs to work NOW after a Windows update, not later after a patch.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806733">
				<div id="div-comment-806733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806733">
			January 28, 2010 at 2:05 pm</a>		</div>

		<p>@Paul M. Parks:</p>
<p>IIRC, Windows 6 and after won&#8217;t install on FAT drives. (That, and only an idiot would install a Windows Server on FAT.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806743">
				<div id="div-comment-806743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick M.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806743">
			January 28, 2010 at 2:08 pm</a>		</div>

		<p>Somewhat @link and @paul_m._parks</p>
<p>Well if windows 2008 uses winSXS and if winSXS is the <em>real</em> location of windows files, why is there any issue at all to have links to notepad.exe available in two folders?</p>
<p>I think the &#8216;extra&#8217; notepad was removed at a time past when it was necessary to do so. I guess they did the hard work to save the 68K after all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806753">
				<div id="div-comment-806753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806753">
			January 28, 2010 at 2:12 pm</a>		</div>

		<p>@Mircea:</p>
<p>Windows Installer has custom actions. &nbsp;JScript and VBScript have Shell.Application. &nbsp;NSIS has ExecShell. &nbsp;Perl and Python also have wrappers around it. &nbsp;I&#8217;m not saying it is always available, but it seems like those would cover a high percentage of use cases.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806763">
				<div id="div-comment-806763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806763">
			January 28, 2010 at 3:38 pm</a>		</div>

		<blockquote><p>
  &gt; And how many installations of Windows have you seen in places other than C:Windows today?
</p></blockquote>
<p>You mean like &quot;D:Windows&quot; or &quot;E:Windows&quot; on a system with multiple partitions?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806773">
				<div id="div-comment-806773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806773">
			January 28, 2010 at 3:40 pm</a>		</div>

		<blockquote><p>
  &gt; I guess they did the hard work to save the 68K after all.
</p></blockquote>
<p>I didn&#8217;t know Windows ran on the Motorola 68K!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806783">
				<div id="div-comment-806783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806783">
			January 28, 2010 at 4:31 pm</a>		</div>

		<p>For installations not in C:Windows, I worked at a company once where it was Z:Windows. &nbsp;It&#8217;s amazing how much malware / viruses don&#8217;t work when you&#8217;re OS isn&#8217;t installed on the C: drive.</p>
<p>-Josh-</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-msdnarchive even thread-even depth-1" id="comment-806793">
				<div id="div-comment-806793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MSDN Archive</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806793">
			January 28, 2010 at 7:49 pm</a>		</div>

		<p>Raymond, your physic powers are legendary, but what tipped you off that WS2008 was in use and not just a Windows installation to a different drive letter? &nbsp;Or maybe an old Windows NT 4 installation in C:WINNT.</p>
<p>Windows doesn&#8217;t need an EDITOR variable as there is always a file association for text files. That can easily be used ShellExecuteEx.</p>
<p>Plus, EDITOR in Unix is about the users preferred editor (say vi or Emacs), that isn&#8217;t necessarily the preferred viewer for text or log files.</p>
<div class=post>[<i>Psychic powers are like that. You have to pick one or the other, and my psychic powers led me to the right one. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806833">
				<div id="div-comment-806833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yves</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806833">
			January 29, 2010 at 12:14 am</a>		</div>

		<p>Notepad is not a system program and should not be in the system folder, it should be in the program folder. &nbsp;C: is being referenced as an environment variable. &nbsp;C:Windows is being referenced as well, no need to hard code.</p>
<p>And yes, when will you windows guys learn anything from real programmers. &nbsp;There exists symbolic links that would allow to install one version of notepad and link to it from different folders. &nbsp;System32 for 64 bit is a screw-up, just because you redmonders didn&#8217;t manage to fully understand superiority of symbolic links. &nbsp;Come on guys, cut the crap and stop using notepad for anything from within a program. &nbsp;If you really need to, do a system call with &quot;start notepad filename&quot; and let windows handle tracing down notepad, for everything else, embed a text-field viewer in your code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806843">
				<div id="div-comment-806843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">104</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806843">
			January 29, 2010 at 2:10 am</a>		</div>

		<p>playing devil&#8217;s advocate here, &quot;%systemroot%notepad.exe&quot; has a hardcoded component as well. it&#8217;s impossible to always know the good-bear way of doing things. what if Windows changes &quot;notepad.exe&quot; to &quot;notes.exe&quot; in later versions? What if the directory separator changes? What if the environment variable name changes? Then will we call &quot;%systemroot%notepad.exe&quot; idiotic too? Unless there&#8217;s some reasonable-to-find document that explains the proper way to launch notepad, and that confirms that you can wait on the process handle for the document to be closed, then you just can&#8217;t be safe enough.</p>
<p>that being said, i agree it&#8217;s idiotic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806863">
				<div id="div-comment-806863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gechurch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806863">
			January 29, 2010 at 2:49 am</a>		</div>

		<p>@Yves</p>
<p>I always find it funny how people who give things the least thought seem to be the most confident that they are right.</p>
<p>Do you really think Microsoft programmers didn&#8217;t consider using a symbolic link? Do you really think you considered all the possibilites more thoroughly in the thirty seconds of thought you gave the issue before commenting than the microsoft programmers did before deciding to copy the file to both locations? Raymond has even written an article covering exactly this topic, and it has been linked to in the comments above yours. Also already discussed in the comments is why &quot;start notepad filename&quot; will not always give required results.</p>
<p>@104</p>
<p>Certain things are part of the contract that Microsoft will not change, where are other things are implementation details that shouldn&#8217;t be relied on. You won&#8217;t see Microsoft articles talking about the latter.</p>
<p>Even if you can&#8217;t readily find documentation, I think common sense would dictate that Microsoft aren&#8217;t about to change the file delimiter or name of the notepad executable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806803">
				<div id="div-comment-806803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lawrence</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806803">
			January 28, 2010 at 8:12 pm</a>		</div>

		<p>@Mircea: &quot;And how many installations of Windows have you seen in places other than C:Windows today? Exclude old NT that used WINNT.&quot;</p>
<p>A random sample of the PCs currently in the room with me. 3 out of four are NOT &quot;C:Windows&quot;.</p>
<p>There are two &quot;D:Windows&quot;&#8217;es and an &quot;H:Windows&quot;</p>
<p>Please please *please* never make this assumption.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806813">
				<div id="div-comment-806813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806813">
			January 28, 2010 at 8:33 pm</a>		</div>

		<p>&gt;&gt; That can easily be used ShellExecuteEx.</p>
<p>IFF you want an OLE dependency.</p>
<p>&gt;&gt; Please please *please* never make this assumption.</p>
<p>Unless you are a virus/trojan writer, then please carry on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806873">
				<div id="div-comment-806873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Red</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806873">
			January 29, 2010 at 5:48 am</a>		</div>

		<p>This might sound a bit impertinence, but I&#8217;m looking for information about the winstub.exe file &#8211; in particular &#8211; what is it ? why is it needed and where can I find it&#8217;s source &nbsp;? (as for some awkward reason it no longer exists in win7 :/ )</p>
<p>I&#8217;d appreciate if you could refer me to the right sources.</p>
<p>Thanks in advance,</p>
<p>REd.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806883">
				<div id="div-comment-806883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexander Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806883">
			January 29, 2010 at 7:18 am</a>		</div>

		<p>@Porter, Lawrence,</p>
<p>Windows 6+ makes the system disc always C:, no matter what partition/disc it is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806893">
				<div id="div-comment-806893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexander Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806893">
			January 29, 2010 at 7:21 am</a>		</div>

		<p>&quot;It&#8217;s amazing how much malware / viruses don&#8217;t work when you&#8217;re OS isn&#8217;t installed on the C: drive.&quot;</p>
<p>Such petty tricks are not necessary if you configured your user account right (that is, you&#8217;re running non-administrator).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806913">
				<div id="div-comment-806913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">link</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806913">
			January 29, 2010 at 7:56 am</a>		</div>

		<blockquote><p>
  &gt; Why not create a symbolic/hard link from c:windowsnotepad.exe to c:windowssystem32notepad.exe instead of removing it?</p>
<p>  @link: Raymond covered this previously.</p>
<p>  <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2009/03/12/9471146.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2009/03/12/9471146.aspx</a>
</p></blockquote>
<p>He doesn&#8217;t explain why they removed it without replacing it with a link (symbolic/hard/lnk/whatever). Support for FAT file system is not a reason in Windows 2008 becauase that OS cannot be installed to a FAT FS. And the &quot;disk space&quot; reason is plain silly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-806923">
				<div id="div-comment-806923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ole!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806923">
			January 29, 2010 at 7:59 am</a>		</div>

		<blockquote><p>
  &gt;&gt; That can easily be used ShellExecuteEx.</p>
<p>  &gt; IFF you want an OLE dependency.
</p></blockquote>
<p>All OS which doesn&#8217;t have c:windowsnotepad.exe do have the ShellExecuteEx() function.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-806933">
				<div id="div-comment-806933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-806933">
			January 29, 2010 at 8:04 am</a>		</div>

		<blockquote><p>
  &gt; All OS which doesn&#8217;t have c:windowsnotepad.exe do have the ShellExecuteEx() function.
</p></blockquote>
<p>All OS which have ShellExecuteEx have ShellExecuteEx as an OLE dependency. All OS which have ShellExecuteEx have CreateProcess which will happily search for notepad.exe on the path.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-807143">
				<div id="div-comment-807143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-807143">
			January 30, 2010 at 12:55 am</a>		</div>

		<blockquote><p>
  You might not be able to CALL ShellExecute in the first place. One example is installers &#8211; specifically
</p></blockquote>
<p>But, I guess you can call start.exe, which, in turn, calls ShellExecute.</p>
<p>e.g. to open readme.txt, just CreateProcess &quot;start path/to/readme.exe&quot;</p>
<blockquote><p>
  Hard-coding paths isn&#8217;t stupid, it may be a requirement in some cases.
</p></blockquote>
<p>Launching notepad may be a requirement&#8230; But hard-coding its path&#8230; Why?</p>
<blockquote><p>
  And since all widely-used Windows versions except Server 2008 store Notepad in both %WINDIR% and %SYSTEMROOT% you can&#8217;t know which one to use, so you&#8217;ll just pick one.
</p></blockquote>
<p>Hard coding is using &quot;c:windowssystem32notepad.exe&quot;, and won&#8217;t work with alternative windows setups (e.g. d:windows or c:windows_new_install)</p>
<p>Using %SYSTEMROOT% or %WINDIR%, is, indeed, much better.</p>
<p>Ideally, just run &quot;notepad readme.txt&quot;, because notepad is in the PATH.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-807163">
				<div id="div-comment-807163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100128-00/?p=15153#comment-807163">
			January 30, 2010 at 7:34 am</a>		</div>

		<p>@Alexander Grigoriev</p>
<p>&quot;Windows 6+ makes the system disc always C:, no matter what partition/disc it is.&quot;</p>
<p>Not if you&#8217;ve upgraded from Windows 5.1</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

