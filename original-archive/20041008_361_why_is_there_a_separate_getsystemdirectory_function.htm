<html>
<head>
<title>Why is there a separate GetSystemDirectory function?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why is there a separate GetSystemDirectory function?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>October 8, 2004 / year-entry #362</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>18</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If the system directory is always %windir%\SYSTEM32, why is there a special function to get it? Because it wasn't always that. For 16-bit programs on Windows NT, the system directory is %windir%\SYSTEM. That's also the name of the system directory for Windows 95-based systems and all the 16-bit versions of Windows. But even in the 16-bit world,...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If the system directory is always <code>%windir%\SYSTEM32</code>, why is there a special function to get it?</p>
<p> Because it wasn't always that. </p>
<p> For 16-bit programs on Windows&nbsp;NT, the system directory is <code>%windir%\SYSTEM</code>.  That's also the name of the system directory for Windows&nbsp;95-based systems and all the 16-bit versions of Windows. </p>
<p> But even in the 16-bit world, if it was always <code>%windir%\SYSTEM</code>, why have a function for it? </p>
<p> Because even in the 16-bit world, it wasn't always <code>%windir%\SYSTEM</code>. </p>
<p> Back in the old days, you could run Windows directly over the network.  All the system files were kept on the network server, and only the user's files were kept on the local machine. What's more, every single computer on the network used the same system directory on the server. There was only one copy of USER.EXE, for example, which everybody shared. </p>
<p> Under this network-based Windows configuration, the system directory was a directory on a server somewhere (\\server\share\somewhere) and the Windows directory was a directory on the local machine (C:\WINDOWS).  Clients did not have write permission into the shared system directory, but they did have permission to write into the Windows directory. </p>
<p> That's why <code>GetSystemDirectory</code> is a separate function. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (18)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-215443">
				<div id="div-comment-215443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mschaef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215443">
			October 8, 2004 at 8:04 am</a>		</div>

		<p>&quot;Back in the old days, you could run Windows directly over the network. &quot;</p>
<p>Was this true for Windows for Workgroups too? I thought the filesharing itself depended on Windows to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215453">
				<div id="div-comment-215453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215453">
			October 8, 2004 at 8:11 am</a>		</div>

		<p>mschaef,<br />
<br />It was possible to &quot;mount&quot; SMB filesystems to DOS drive letters from the DOS command prompt before Windows was loaded. I often made use of this feature since back in those days I wasn&#8217;t really much of a Windows fan and preferred to do things in DOS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215463">
				<div id="div-comment-215463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215463">
			October 8, 2004 at 8:13 am</a>		</div>

		<p>Nope. Netware and the other raft of lans ran under DOS, so windows basically depended on that for its networking.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215473">
				<div id="div-comment-215473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marco</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215473">
			October 8, 2004 at 8:25 am</a>		</div>

		<p>another reason could be mono. on a linux system this will look completely differnet!</p>
<p>bye marco</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215513">
				<div id="div-comment-215513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lowercase josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215513">
			October 8, 2004 at 10:16 am</a>		</div>

		<p>Too bad there&#8217;s no environment variable for it though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215523">
				<div id="div-comment-215523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">null</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215523">
			October 8, 2004 at 10:27 am</a>		</div>

		<p>I did that. We had the whole building running the same system files. Seems backward to many today.</p>
<p>system on network<br />
<br />files on local</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215543">
				<div id="div-comment-215543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miles Archer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215543">
			October 8, 2004 at 10:36 am</a>		</div>

		<p>So would it be unwise to assume for the future that the System32 is the directory? Is it still System32 for 64bit Windows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215553">
				<div id="div-comment-215553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215553">
			October 8, 2004 at 11:02 am</a>		</div>

		<p>Probably. Would you rather hardcode your apps now and have them break later?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215563">
				<div id="div-comment-215563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215563">
			October 8, 2004 at 11:21 am</a>		</div>

		<p>I&#8217;m pretty sure Raymond mentioned a while back that in Win64 it&#8217;s still called &quot;system32&quot; to ensure (wait for it&#8230;) backward compatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215623">
				<div id="div-comment-215623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215623">
			October 8, 2004 at 1:31 pm</a>		</div>

		<p>So we know why the function exists.  Should we use it rather than the variable?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215633">
				<div id="div-comment-215633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215633">
			October 8, 2004 at 3:28 pm</a>		</div>

		<p>Keep using the function.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215643">
				<div id="div-comment-215643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215643">
			October 8, 2004 at 3:43 pm</a>		</div>

		<p>Is there any valid reason to use SHGetFolderPath(&#8230;, CSIDL_SYSTEM, &#8230;) in place of GetSystemDirectory?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215653">
				<div id="div-comment-215653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215653">
			October 8, 2004 at 3:51 pm</a>		</div>

		<p>CSIDL_SYSTEM just calls GetSystemDirectory. It&#8217;s there more for completeness than to provide new functionality. (For example, since you can use CSIDL values in INF files, this lets you use the system directory from an INF file.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215693">
				<div id="div-comment-215693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215693">
			October 8, 2004 at 8:08 pm</a>		</div>

		<p>Raymond,</p>
<p>How complete is the Application Compatibility Toolkit for stuff like this?  (I used to be guilty of using the registry for getting &quot;My Documents&quot; until your post on the subject since you actually explained why things were the way they were :-)</p>
<p>For those who don&#8217;t know, the ACT is supposed to check your app by running it and seeing what you do wrong.  It is at <a target="_new" href="http://www.microsoft.com/windows/appcompatibility/toolkit.mspx" rel="nofollow">http://www.microsoft.com/windows/appcompatibility/toolkit.mspx</a></p>
<p>For some bizarre reason the download page now tries to make you verify that your copy of Windows is genuine, but you can bypass that.  (My copy was bought at the MS employee store so it had better be genuine :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215713">
				<div id="div-comment-215713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/larryosterman' rel='external nofollow' class='url'>Larry Osterman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215713">
			October 9, 2004 at 6:33 am</a>		</div>

		<p>Actually it doesn&#8217;t force you to validate &#8211; it just offers validation as an option.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-215813">
				<div id="div-comment-215813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215813">
			October 11, 2004 at 1:28 pm</a>		</div>

		<p>I miss those days. Why cannot one run NT from a server?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-215853">
				<div id="div-comment-215853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-215853">
			October 11, 2004 at 8:06 pm</a>		</div>

		<p>You can run NT from a server.  The product you want is Windows XP Embedded, where you can choose exactly what OS components you want, and can run off flash or over the network, as well as a good old fashioned hard disk.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-218233">
				<div id="div-comment-218233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041008-00/?p=37623#comment-218233">
			October 17, 2004 at 12:32 am</a>		</div>

		<p>Any comments on the &#8216;immutability&#8217; of the system directory?</p>
<p>Once got a complaint about a Win3.1 program which wrote data to the system directory, we had to change it to the Windows directory (it was appropriate there, though I forget the data).</p>
<p>So now it&#8217;s always irksome to find that there is a &#8216;system32logfiles&#8217; directory. How can you have a writable directory inside what is potentially a read-only and/or remote network shared directory? (I&#8217;m sure it&#8217;s because the requirements have changed, but when?)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

