<html>
<head>
<title>Why doesn't searching my Start menu with Cortana find Internet shortcuts in my All Programs list?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why doesn&#8217;t searching my Start menu with Cortana find Internet shortcuts in my All Programs list?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 22, 2017 / year-entry #120</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>53</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Because our A/B testing showed that showing them was worse.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer had a program that installed a number of shortcuts
to the Start menu.
Among them were some Internet shortcut files,
like
"View Contoso User Guide"
and
"Get Online Support from Contoso".
In Windows 7 and 8,
if the user searched the Start menu for
"Contoso",
these shortcuts would appear in the search results.
But in Windows 10, they do not. 
Why not, and what can they do to get them to show up?
</p>
<p>
The Cortana team explained
that they intentionally filter out URLs from search results.
They ran an A/B test, and the results showed that
leaving URLs in the search results was worse for users.
</p>
<p>
To get the shortcuts to appear in the Cortana search results,
you can create a shortcut to a regular program.
For example, you can create a shortcut that points directly
to the Web browser executable, with the URL on the command line.
Or you can create a shortcut that runs a helper program
bundled with your application,
and the helper program calls <code>Shell&shy;Execute</code>
to open the URL in the user's preferred Web browser.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (53)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1 parent" id="comment-1297045">
				<div id="div-comment-1297045" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297045">
			May 22, 2017 at 7:09 am</a>		</div>

		<p>But not allowing users to disable internet results in the start menu is not bad for the user? Cortana even ignores the group policy for it on purpose.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1297095">
				<div id="div-comment-1297095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297095">
			May 22, 2017 at 8:11 am</a>		</div>

		<p>I&#8217;m running the latest consumer Windows 10 (not any preview build) and I don&#8217;t see internet results in the start menu.  I didn&#8217;t do anything unusual.  I just turned off all the relevant looking settings.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1297055">
				<div id="div-comment-1297055" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297055">
			May 22, 2017 at 7:23 am</a>		</div>

		<p>How exactly was it &#8220;worse&#8221; for the users to leave the URLs out of the search results?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mzzt odd alt depth-2 parent" id="comment-1297075">
				<div id="div-comment-1297075" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/The+MAZZTer' rel='external nofollow' class='url'>The MAZZTer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297075">
			May 22, 2017 at 7:37 am</a>		</div>

		<p>I&#8217;m guessing because there really is no need for urls in the Start Menu to begin with; it&#8217;s just filler some app is putting there because they want to. Most users probably don&#8217;t care or want to see them.</p>
<p>IIRC the Microsoft UX guidelines state the only thing an app should be putting in the Start Menu are shortcuts to actual apps. No documentation (the app itself should open any documentation), no uninstallers (the uninstaller should be made accessible in the Programs and Features dialog). URLs may make sense depending on their usage I suppose (for example, accessing an online service that the app utilizes). But most URLs I&#8217;ve seen are shortcuts to the developer&#8217;s website which is just clutter that could go in the app itself.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1297105">
				<div id="div-comment-1297105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297105">
			May 22, 2017 at 8:13 am</a>		</div>

		<p>Sounds like a pointless game of whack-a-mole.</p>
<p>The guidelines already say not to do that, so the devs (or &#8220;brand marketers&#8221;, or whatever &#8220;B&#8221;-ark asshats are in charge of such decisions) have already decided they don&#8217;t care about making life pleasant for the user, but just want to get in their face as much as possible.</p>
<p>If URLs stop showing up as much as possible, Contoso will just make them calls to the web browser in the next version (or, more likely, the next patch) and the user is in as worse a state as they were in before Cortana stopped showing URLs. So the next version of Cortana will have to make links to the web browser not show up in search results, at which point Contoso will just implement the &#8220;helper program&#8221; workaround instead.</p>
<p>At which the user is back where they started *again*, no better off than before, but now there are these weird special cases where URLs and links to the web browser don&#8217;t show up in search results, for reasons that the user will never understand.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1297115">
				<div id="div-comment-1297115" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297115">
			May 22, 2017 at 8:44 am</a>		</div>

		<p>The Cortana team didn&#8217;t tell me, but my guess is that when they included URLs in the search results, the URLs received negligible click-through, which strongly indicated that people weren&#8217;t searching for URLs and they were just cluttering the results.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1297196">
				<div id="div-comment-1297196" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Cohn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297196">
			May 22, 2017 at 2:02 pm</a>		</div>

		<p>Or they found that people started search for something like &#8220;com&#8221; and were overwhelmed with all the URLs that showed up</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1297425">
				<div id="div-comment-1297425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297425">
			May 23, 2017 at 3:05 pm</a>		</div>

		<p>Thank you.  That was unclear to me after reading the post.  Thanks for clearing it up.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chd1 even thread-even depth-1" id="comment-1297065">
				<div id="div-comment-1297065" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/ChDF+T' rel='external nofollow' class='url'>ChDF T</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297065">
			May 22, 2017 at 7:33 am</a>		</div>

		<p>&#8220;Or you can create a shortcut that runs a helper program[&#8230;]&#8221;<br />
Doesn&#8217;t that kind of defeat the purpose of filtering out URLs? Sure that is a neat workaround for users and sys-admins, but I don&#8217;t understand how forcing your shortcut into the search results is different from force-pinning your application to the Start menu &#8211; it is just something an application should not do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1297085">
				<div id="div-comment-1297085" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297085">
			May 22, 2017 at 7:38 am</a>		</div>

		<p>0. on standard installations of Windows only one web browser is present: &#8220;%ProgramFiles%\Internet Explorer\iexplore.exe&#8221;<br />
1. since you don&#8217;t know the user&#8217;s preferred web browser (just in case that more than one of them are installed) you should not call YOUR preferred web browser.<br />
2. nobody needs to write a helper application, Windows fortunately provides one for you already: just call &#8220;%SystemRoot%\System32\rundll32.exe&#8221; &#8220;%SystemRoot%\System32\url.dll,,FileProtocolHandler </p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1297106">
				<div id="div-comment-1297106" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297106">
			May 22, 2017 at 8:43 am</a>		</div>

		<p>Yay, let&#8217;s take a dependency on an undocumented interface!</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1297155">
				<div id="div-comment-1297155" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297155">
			May 22, 2017 at 12:26 pm</a>		</div>

		<p>I&#8217;d rather ask why M$FT still does not comply to court orders and their own commitment to document ALL the interfaces they use in Windows, for example the ones shown by &#8220;CMD.exe /K FType&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-4" id="comment-1297195">
				<div id="div-comment-1297195" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297195">
			May 22, 2017 at 1:26 pm</a>		</div>

		<p>I think you&#8217;re misinterpreting what the order says. But this is not a legal blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt depth-4 parent" id="comment-1297215">
				<div id="div-comment-1297215" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297215">
			May 22, 2017 at 3:17 pm</a>		</div>

		<p>It was never ALL interfaces. See <a href="http://www.geoffchappell.com/studies/windows/shell/missing.htm" rel="nofollow">http://www.geoffchappell.com/studies/windows/shell/missing.htm</a> for details.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1297355">
				<div id="div-comment-1297355" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297355">
			May 23, 2017 at 7:55 am</a>		</div>

		<p>Please read the part AFTER the &#8220;and&#8221; too, then tell me (for example) where URL.dll&#8217;s TelnetProtocolHandler or SHDOCVW.dll&#8217;s OpenURL are documented.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1297365">
				<div id="div-comment-1297365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pavel Kostromitinov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297365">
			May 23, 2017 at 8:26 am</a>		</div>

		<p>Indeed, &#8220;cmd.exe /c start <a href="http://contoso.com/" rel="nofollow">http://contoso.com/</a>&#8221; would do it just as well</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-3 parent" id="comment-1297415">
				<div id="div-comment-1297415" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297415">
			May 23, 2017 at 1:58 pm</a>		</div>

		<p>Unless this helper application is installed in a secure location, or its developer used an UNDOCUMENTED interface, calling ShellExecute() is unsafe: see DLL hijacking, see MSRC case 32250<br />
RunDll32.exe .dll does not show this vulnerability.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4 parent" id="comment-1297435">
				<div id="div-comment-1297435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297435">
			May 23, 2017 at 5:56 pm</a>		</div>

		<p>Why in heaven&#8217;s name would you install the helper application in an insecure location?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1297436">
				<div id="div-comment-1297436" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297436">
			May 23, 2017 at 6:15 pm</a>		</div>

		<p>I won&#8217;t; I also won&#8217;t write one in the first place.<br />
There exist but quite some applications out there which 1. call ShellExecute(), 2. are not coded in a safe and secure way, 3. are not installed in safe locations, or 4. are run from unsafe locations.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1297445">
				<div id="div-comment-1297445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297445">
			May 23, 2017 at 9:04 pm</a>		</div>

		<p>So?  There are applications out there that do all sorts of stupid things.  (Like taking an unnecessary dependency on an undocumented interface, for example.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5 parent" id="comment-1297485">
				<div id="div-comment-1297485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297485">
			May 24, 2017 at 1:11 am</a>		</div>

		<p>OK, that was unnecessarily snarky of me.  Apologies.  Still, in Raymond&#8217;s original scenario, the helper program was bundled with an application, and would naturally be located in the same directory tree as the main application, which had better blimmin&#8217; well be secure.  So I really don&#8217;t think this is an issue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1297495">
				<div id="div-comment-1297495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297495">
			May 24, 2017 at 5:48 am</a>		</div>

		<p>The problem lies with &#8220;which had better blimmin’ well be secure&#8221;<br />
Just 2 (of MANY) counter examples:<br />
1. fetch Windows10Upgrade.exe and run it: it creates a directory %SystemDrive%\Windows10Upgrade\ where it unpacks the real application to, then creates a shortcut to this real application in the start menu. All but the latest version of Windows10Upgrade.exe allow unprivileged users to write into %SystemDrive%\Windows10Upgrade\<br />
2. Mozilla&#8217;s uninstallhelper is installed into a secure location, but extracts some DLLs to a subdirectory of %TEMP% and executes them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1297536">
				<div id="div-comment-1297536" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297536">
			May 24, 2017 at 6:20 pm</a>		</div>

		<p>Well &#8230; OK, the Windows10Upgrade thing might well introduce a genuine EoP vulnerability, but it doesn&#8217;t have much to do with helper applications and the Start Menu.  Putting DLLs in %TEMP% isn&#8217;t a major problem, though, as far as I can see.  Loading a DLL doesn&#8217;t add the directory to the search path for dependencies, and any way of getting a malicious file into %TEMP% would constitute a vulnerability in itself.  </p>
<p>(Nonetheless, it is probably sensible to avoid using the root of %TEMP% directly as a defense-in-depth measure.)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1297125">
				<div id="div-comment-1297125" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.bio/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297125">
			May 22, 2017 at 8:55 am</a>		</div>

		<p>You could have used cmd to start a URL. Why use rundll32 corruptedly?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2 parent" id="comment-1297135">
				<div id="div-comment-1297135" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297135">
			May 22, 2017 at 10:29 am</a>		</div>

		<p>He said &#8220;ShellExecute&#8221;, which allows you to pass just a filename/URL and have the shell open it using the user&#8217;s default program, without needing to specify what that program is.</p>
<p>If you don&#8217;t want to include a helper program, you can have the shortcut pass the URL/filename as a command-line argument to explorer.exe, which appears to do the same thing as ShellExecute on that URL/filename.  (Though I don&#8217;t know for certain if that&#8217;s a Microsoft documented interface)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-3 parent" id="comment-1297137">
				<div id="div-comment-1297137" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297137">
			May 22, 2017 at 10:53 am</a>		</div>

		<p>No, please don&#8217;t pass files to explorer.exe. Explorer is for opening folders, not files.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4" id="comment-1297146">
				<div id="div-comment-1297146" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297146">
			May 22, 2017 at 11:20 am</a>		</div>

		<p>Gotcha.  Good to know, thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3 parent" id="comment-1297176">
				<div id="div-comment-1297176" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297176">
			May 22, 2017 at 12:36 pm</a>		</div>

		<p>No, Raymond wrote &#8220;helper program [which] calls ShellExecute&#8221;.<br />
This helper program already exists.<br />
If you don&#8217;t like RunDLL32.exe URL.dll,FileProtocolHandler: see ASSOC .URL and FTYPE InternetShortcut</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1297206">
				<div id="div-comment-1297206" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297206">
			May 22, 2017 at 3:00 pm</a>		</div>

		<p>@Stefan: Why use undocumented interfaces when start.exe does exactly what you&#8217;re wanting? (It&#8217;s even less typing!)</p>
<p>Regarding rundll32.exe, Raymond has talked about it several times: <a href="https://blogs.msdn.microsoft.com/oldnewthing/20130104-00/?p=5643/" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20130104-00/?p=5643/</a> and <a href="https://blogs.msdn.microsoft.com/oldnewthing/20040115-00/?p=41043" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20040115-00/?p=41043</a> (amongst others). That what you&#8217;re doing happens to work is pure luck; it probably will continue to do so because everyone seems to rely on it, but that doesn&#8217;t negate that fact that you&#8217;re relying on non-contractual behaviour that Microsoft is within its rights to change (say, by tightening up on what rundll32 accepts, or by getting rid of rundll32 altogether.)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-wndsks odd alt depth-5" id="comment-1297216">
				<div id="div-comment-1297216" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297216">
			May 22, 2017 at 4:58 pm</a>		</div>

		<p>I believe this is one of the functions actually designed for use by rundll32. It is also recommended as a ShellExecute workaround @ <a href="https://web.archive.org/web/20080204185822/http://msdn.microsoft.com/msdnmag/issues/05/03/CATWork/default.aspx" rel="nofollow">https://web.archive.org/web/20080204185822/http://msdn.microsoft.com/msdnmag/issues/05/03/CATWork/default.aspx</a> but it can still change/go away at any point.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1297225">
				<div id="div-comment-1297225" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297225">
			May 22, 2017 at 5:10 pm</a>		</div>

		<p>I recommend to do your homework first!<br />
1. there is NO start.exe!<br />
2. the functions FileProtocolHandler, FileProtocolHandlerA, MailToProtocolHandler, MailToProtocolHandlerA, NewsProtocolHandler, NewsProtocolHandlerA, TelnetProtocolHandler, TelnetProtocolHandlerA, OpenURL and OpenURLA exported by URL.dll as well as OpenURL exported by SHDOCVW.dll are designed for calls by RunDll32.exe</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5 parent" id="comment-1297275">
				<div id="div-comment-1297275" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297275">
			May 23, 2017 at 12:09 am</a>		</div>

		<p>@Stefan: Mea culpa. Indeed start is not an executable, but you can still call it thusly: &#8220;cmd.exe /c start &#8220;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1297346">
				<div id="div-comment-1297346" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297346">
			May 23, 2017 at 7:46 am</a>		</div>

		<p>This gives your users a nice flashing console window.<br />
JFTR: the difference between CMD.exe and RunDLL32.exe is: the latter is a Windows GUI program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1297465">
				<div id="div-comment-1297465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297465">
			May 23, 2017 at 9:58 pm</a>		</div>

		<p>I&#8217;m trying to figure out what use case you&#8217;re needing this for: programs can call ShellExecute() directly, shortcuts are handled by the shell, and scripts can use start/Invoke-Item/etc. Perhaps that will help to determine what supported methods would work best.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1297165">
				<div id="div-comment-1297165" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297165">
			May 22, 2017 at 12:30 pm</a>		</div>

		<p>Nice idea for Classic Shell&#8217;s search!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1297166">
				<div id="div-comment-1297166" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xpclient</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297166">
			May 22, 2017 at 12:32 pm</a>		</div>

		<p>What if the user is searching for URLs from his Bookmarks/Favorites?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2" id="comment-1297185">
				<div id="div-comment-1297185" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297185">
			May 22, 2017 at 1:25 pm</a>		</div>

		<p>As noted, the A/B test shows that people didn&#8217;t do that.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1297235">
				<div id="div-comment-1297235" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297235">
			May 22, 2017 at 5:36 pm</a>		</div>

		<p>The shortcut to the the web browser executable with the URL in the arguments won&#8217;t work, or won&#8217;t work for more than one URL, because the Windows 10 Start Menu only ever displays one shortcut to a particular executable, even if the arguments are different.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1297245">
				<div id="div-comment-1297245" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kermi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297245">
			May 22, 2017 at 8:55 pm</a>		</div>

		<p>I wish the search would show my executable files which are in indexed locations, but do not have start menu item. Say like my sysinternals tool folder, or putty and other portable programs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1297255">
				<div id="div-comment-1297255" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karlis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297255">
			May 22, 2017 at 10:39 pm</a>		</div>

		<p>The problem with A/B testing is that only the most popular features might be kept.<br />
Which has resulted in Start menu search becoming unusable in Windows 10.<br />
In Windows 7, I could find everything in the indexer&#8217;s database using Start menu search. In Windows 10, I cannot see any logic as to what I will and what I will not find.  For example, on my desktop, I have a pdf file that includes the words &#8220;german economy contracts&#8221;. In Windows 7, I would type &#8220;german contracts&#8221; in the start menu and it would be the first result. In Windows 10, I have to open explorer, open my user folder (for how do I otherwise force Windows to search all of the indexer database?), and then search.<br />
3 steps where in Windows 7 there was one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-odd thread-alt depth-1" id="comment-1297265">
				<div id="div-comment-1297265" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297265">
			May 22, 2017 at 11:32 pm</a>		</div>

		<p>The next question would be: &#8220;Is there any verb that I can use to tell Cortana to get them show up?&#8221; ( <a href="https://blogs.msdn.microsoft.com/oldnewthing/20080321-00/?p=23043" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20080321-00/?p=23043</a> )</p>
<p>:giggle:</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jeremytais odd alt thread-even depth-1" id="comment-1297287">
				<div id="div-comment-1297287" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/SimonRev' rel='external nofollow' class='url'>SimonRev</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297287">
			May 23, 2017 at 1:22 am</a>		</div>

		<p>I&#8217;d settle for Cortanna to actually work.  For some reason I have to kill Cortanna in the task manager before I can get any searches in the start menu or Win+Q to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1297295">
				<div id="div-comment-1297295" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DaveL</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297295">
			May 23, 2017 at 1:52 am</a>		</div>

		<p>I&#8217;m glad this decision has apparently been changed in the newer updates to Windows 10.<br />
My shell extensions installers included links to their documentation in the start menu. As there&#8217;s no &#8220;app&#8221; to run from the start menu, being able to search the start menu to discover my extension&#8217;s documentation was (and now is again) quite useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1297395">
				<div id="div-comment-1297395" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297395">
			May 23, 2017 at 10:11 am</a>		</div>

		<p>Does &#8220;cortana&#8221; here include &#8220;search windows&#8221; that you get when AllowCortana is 0?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-entegygmail-com even depth-2" id="comment-1297645">
				<div id="div-comment-1297645" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297645">
			May 25, 2017 at 1:41 pm</a>		</div>

		<p>Yes.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1297487">
				<div id="div-comment-1297487" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">outadoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297487">
			May 24, 2017 at 4:05 am</a>		</div>

		<p>So THAT&#8217;s why Windows 10 is usually at starting programs for me, I almost forgot all about the useless web links that get put in the start menu by installers. I&#8217;m glad it works this way, and I hope the workaround won&#8217;t be abused in the future. I don&#8217;t care about your website, program. Never clicked on it, never will.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1297555">
				<div id="div-comment-1297555" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297555">
			May 24, 2017 at 8:15 pm</a>		</div>

		<p>1. what&#8217;s the difference between a helper application with its shortcut in the start menu, and the main application with its shortcut in the start menu? NONE, they both enable the same attack vector!<br />
2. a subdirectory, even with random name doesn&#8217;t help at all: the name can be determined by a trivial batch script.<br />
See for example my PoCs for several installers based on NSIS, the Intel Installation Framework, DISM.exe, RAR and 7-zip.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1297686">
				<div id="div-comment-1297686" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297686">
			May 25, 2017 at 7:40 pm</a>		</div>

		<p>1. I have no idea what you&#8217;re talking about here, and don&#8217;t see how it can possibly be relevant.</p>
<p>2. OK, with the help of a Google search I&#8217;ve figured out that this one is a UAC bypass vulnerability.  I for one don&#8217;t care, since I always use a separate admin account, which has its own %TEMP% directory.  If you do care, you just need to create a sub-directory with explicit permissions, but given that in the default configuration UAC is trivial to bypass anyway, seems like a big yawner to me.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1297755">
				<div id="div-comment-1297755" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297755">
			May 26, 2017 at 9:03 am</a>		</div>

		<p>1. You wrote &#8220;the helper program was bundled with an application, and would naturally be located in the same directory tree as the main application, which had better blimmin’ well be secure. So I really don’t think this is an issue.&#8221;<br />
I showed you a counter example. Is this still not an issue?</p>
<p>2. the UAC bypass is not the point here, but the INSECURE helper application.</p>
<p>RUNDLL32.exe URL.dll,OpenURL doesn&#8217;t show these vulnerabilities!<br />
THAT&#8217;S THE POINT.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4 parent" id="comment-1297825">
				<div id="div-comment-1297825" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297825">
			May 26, 2017 at 5:55 pm</a>		</div>

		<p>1. But you <b>haven&#8217;t</b> shown me a counter-example.  All you&#8217;ve done is to assert that one exists, and that it has something to do with Start Menu shortcuts, but you didn&#8217;t say what.  It also confuses me that you say the main application&#8217;s shortcut is vulnerable too; if that&#8217;s true, then what difference does the presence or absence of the helper application&#8217;s shortcut make?  One vulnerable shortcut or two, the risk is no different.</p>
<p>2. But in the scenario we were discussing (an installer or uninstalling unpacking itself to a subdirectory of %TEMP%)  the helper application <b>isn&#8217;t</b> insecure, except insofar as there is a possible UAC bypass.  So I don&#8217;t think you can say that the UAC bypass isn&#8217;t the point.  Those examples have nothing in common with the scenario Raymond suggests anyway!  In particular, the helper program in Raymond&#8217;s scenario wouldn&#8217;t be put in %TEMP% and wouldn&#8217;t run elevated, so no UAC bypass is possible, or at least I can&#8217;t imagine how one would arise.</p>
<p>To summarize, as best I can tell at this point, you seem to be asserting that the observation that some sorts of helper applications sometimes have minor security flaws means that you should never use helper applications, even of unrelated sorts and even if the alternative is using an undocumented dependency.  If that is indeed what you&#8217;re saying, I don&#8217;t think it is reasonable, but I suspect that I&#8217;ve misunderstood you somewhere.</p>
<p>(Not that I particularly care; as mentioned above, I don&#8217;t think Raymond&#8217;s solution will work well anyway.  I&#8217;m just baffled as to why you think this is such a big deal, and curious as to the technical details of the vulnerabilities you alluded to.)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1297895">
				<div id="div-comment-1297895" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297895">
			May 27, 2017 at 10:33 am</a>		</div>

		<p>Is &#8220;MSRC case 32550&#8221; so hard to find?<br />
See <a href="http://seclists.org/fulldisclosure/2016/Mar/64" rel="nofollow">http://seclists.org/fulldisclosure/2016/Mar/64</a></p>
<p>The proposed helper application calls ShellExecute() and thus loads some DLLs from its application directory, as shown by the minimum implementation of the POC; real world implementations (like Microsoft&#8217;s &#8220;Windows 10 Upgrade Assistent&#8221; or Mozilla&#8217;s uninstallhelper.exe) use the MSVCRT, call more Win32 functions or even their own crap they write to %TEMP% and show therefore MORE vulnerabilities.<br />
Are you sure that your self-implemented helper application behaves better and doesn&#8217;t show these vulnerabilities?</p>
<p>Now compare this to RUNDLL32.exe:<br />
&#8211; the application directory of RUNDLL32.exe is %SystemRoot%\System32\, so RUNDLL32.exe doesn&#8217;t show the vulnerability of the POC;<br />
&#8211; RUNDLL32.exe doesn&#8217;t extract some crap to %TEMP% and runs it there, so it doesn&#8217;t show the vulnerability of NSIS and other REAL WORLD implementations of helper applications.<br />
Is this SOOOO hard to understand?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1297926">
				<div id="div-comment-1297926" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297926">
			May 27, 2017 at 3:36 pm</a>		</div>

		<p>Did you seriously expect me to find the one particular vulnerability report you were thinking of, out of hundreds of thousands, having given me no relevant information?  As for &#8220;MSRC case 32550&#8221;, Google returns no results, and the number doesn&#8217;t appear in your link, so I <b>still</b> don&#8217;t know what you&#8217;re talking about.  (I considered the possibility that it was a typo for 32250, but that one isn&#8217;t relevant.)</p>
<p>Nor is there <b>any</b> mention in your link of &#8220;start menu&#8221;, &#8220;shortcut&#8221;, or any reference to the temporary directory or to a helper application, so none of it has any relevance to either the thread of conversation so far or to the original post.  I&#8217;m giving up; I no longer believe you&#8217;re arguing in good faith.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1297935">
				<div id="div-comment-1297935" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170522-00/?p=96205#comment-1297935">
			May 27, 2017 at 3:44 pm</a>		</div>

		<p>Oh, I see you did mean 32250; you referenced it upthread, as evidence that calling ShellExecute is unsafe if your application has been run from an untrusted directory.  Everybody already knows that.  It isn&#8217;t relevant to this scenario.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

