<html>
<head>
<title>How does Add/Remove Programs get the size and other information?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How does Add/Remove Programs get the size and other information?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>July 9, 2004 / year-entry #274</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>120</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If the program doesn't provide this information itself, Add/Remove Programs is forced to guess. The problem is that there is no "obvious" way to map an entry in the Add/Remove Programs list to an actual program. Each entry in the list, for those who care about such things, comes from the HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall registry key. The...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If the program doesn't provide this information itself, Add/Remove Programs is forced to guess.</p>
<p>The problem is that there is no "obvious" way to map an entry in the Add/Remove Programs list to an actual program. Each entry in the list, for those who care about such things, <a href="http://msdn.microsoft.com/library/en-us/dnw2ksrv/html/w2kserve_chapter2.asp">comes from the HKEY_LOCAL_MACHINE\<wbr>Software\<wbr>Microsoft\<wbr>Windows\<wbr>CurrentVersion\<wbr>Uninstall registry key</a>. The only mandatory properties for an uninstallable program are the DisplayName and the UninstallPath. Everything else is optional. </p>
<p>Let's suppose Add/Remove Programs is given a program registration like this: </p>
<pre>HKEY_LOCAL_MACHINE\
 Software\
  Microsoft\
   Windows\
    CurrentVersion\
     Uninstall\
      SomeProgram
       DisplayName=REG_SZ:"Awesome Program for Windows"
       UninstallPath=REG_SZ:"C:\WINDOWS\uninstall.exe -SomeParameters"
</pre>
<p>In order to get the "Last Used" and "Frequency" values, Add/Remove Programs needs to know the name of the EXE so it can ask the Start menu "Hey, how often did the user run this program, and when was the last time it happened?" </p>
<p>Notice that there are no clues in the registration above as to the identity of this EXE file. </p>
<p>So Add/Remove Programs starts guessing. It goes through all the programs on your Start menu and compares their names with the display name of the uninstallable item. It looks for Start menu items which share at least two words with the words in the DisplayName. </p>
<p>For example, if there were a Start menu item called "Pretty Decent Windows Program", this would count as a two-word match ("Windows" and "Program"). </p>
<p>It then takes the one with the most matches and decides, "Okay, I guess this is it." Suppose for the sake of illustration that the best match is indeed "Pretty Decent Windows Program.lnk", which is a shortcut to "C:\Program Files\LitWare\Decent Program\Decent.exe". Add/Remove Programs would decide that "Awesome Program for Windows" should get the icon for "Pretty Decent Windows Program.lnk", that the frequency of use and most-recently-used information for "C:\Program Files\LitWare\Decent Program\Decent.exe" will be displayed for "Awesome Program for Windows". </p>
<p>But wait, there's more. There's also the program size. Add/Remove Programs looks in your "Program Files" directory for directories whose names share at least two words in common with the DisplayName. The best match is assumed to be the directory that the program files are installed into. The sizes are added together and reported as the size of "Awesome Program for Windows". </p>
<p><strong>A program can add some properties to its registration to avoid a lot of this guessing.</strong> It can set an EstimatedSize property to avoid making Add/Remove Programs guess how big the program is. It can also set a DisplayIcon property to specify which icon to show for the program in the list. </p>
<p>But if a program omits all of these hints, the guess that Add/Remove Programs ends up making can often be ridiculously wide of the mark due to coincidental word matches. In my experience, Spanish suffers particularly badly from this algorithm, due to that language's heavy use of prepositions and articles (which result in a lot of false matches). </p>
<p>Yes, this is all lame, but when you are forced to operate with inadequate information, lame is the best you can do. </p>
<p>[July 15 2004: Emphasizing that this is done only if the program fails to provide the information itself. For some reason, a lot of people who link to this page fail to notice that little detail.]</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (120)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-192803">
				<div id="div-comment-192803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://idunno.org' rel='external nofollow' class='url'>Barry Dorrans</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192803">
			July 9, 2004 at 7:11 am</a>		</div>

		<p>I guess this would explain why I never get the plain old &quot;Command Prompt&quot; in my most used items, but instead it adds the Visual Studio Command prompt instead.</p>
<p>How annoying.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192823">
				<div id="div-comment-192823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.joelonsoftware.com' rel='external nofollow' class='url'>Joel Spolsky</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192823">
			July 9, 2004 at 7:30 am</a>		</div>

		<p>What? FORCED to operate with inadequate information?</p>
<p>&lt;dripping with=&quot;sarcasm&quot;&gt;<br />
<br />Who exactly defined the format of that registry key? Apple?</p>
<p>Just start requiring a few more keys. As soon as you tell people &quot;only&quot; two keys are required that&#8217;s all they&#8217;re going to supply.  Also, nobody&#8217;s forcing you to guess. You could just put (Unknown) in those two columns, instead of telilng me that Adobe Acrobat is 266 MB and I rarely use it (unless by rarely you mean &quot;every few minutes&quot;)</p>
<p>This is a great example of a case where by being really liberal in what you accept, you never taught programmers to do the right thing in their installers. I&#8217;ll bet the Adobe setup programmers don&#8217;t even know that their program shows up wrong in Add/Remove Programs, let alone how to fix it.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192833">
				<div id="div-comment-192833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192833">
			July 9, 2004 at 7:39 am</a>		</div>

		<p>Wow, it only uses the start menu to see if a program was used?  That explains why the data is junk &#8212; I usually use Quick Launch toolbar or desktop to shortcuts to start programs.</p>
<p>It&#8217;s too bad Windows never had a proper file registration system for installed packages, something like debian&#8217;s apt format.  So that each program that&#8217;s installed has an explicit list of files, and all uninstall can be done at the OS level.   You get a proper accounting of disk space usage as a free bonus.</p>
<p>Speaking of which, I don&#8217;t know if this was fixed in XP, but why isn&#8217;t there some way to delete items from the Add/Remove Programs dialog?  I think you can do it with tweakui, but wouldn&#8217;t it be make sense to automatically remove a program&#8217;s entry if executing it&#8217;s uninstall failed because the file was missing?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192843">
				<div id="div-comment-192843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aarrgghh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192843">
			July 9, 2004 at 7:44 am</a>		</div>

		<p>&lt;/dripping&gt;</p>
<p>No sense spoiling the rest of the discussion with an unmatched sarcasm tag.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192853">
				<div id="div-comment-192853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192853">
			July 9, 2004 at 7:58 am</a>		</div>

		<p>The display name and uninstall executable are probably the only required entries for backwards compatiblity.  Remember, the size and how often the application is used were added in the later releases of Windows (I believe Windows 2000 was the first release to support them).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192873">
				<div id="div-comment-192873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.kbcafe.com' rel='external nofollow' class='url'>Randy Charles Morin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192873">
			July 9, 2004 at 8:07 am</a>		</div>

		<p>Good old HACK!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192883">
				<div id="div-comment-192883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">4nd3r$</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192883">
			July 9, 2004 at 8:12 am</a>		</div>

		<p>When i change the displayname of tweakUI to &quot;PowerToy: TweakUI&quot; (i like to sort my stuff, eg: Games,Development and so on) it doesnt change&#8230;why?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192893">
				<div id="div-comment-192893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kannan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192893">
			July 9, 2004 at 8:13 am</a>		</div>

		<p>Oops, that explains why most times it shows crap in Add/Remove programs, thanks for sharing this Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192903">
				<div id="div-comment-192903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hoppsan.org/jamesb/blogger/' rel='external nofollow' class='url'>Barnaby James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192903">
			July 9, 2004 at 8:22 am</a>		</div>

		<p>Thanks for writing this. I don&#8217;t think anyone would ever have guessed this is how it works (or rather doesn&#8217;t work). I always wondered why the how frequently used info was always wrong &#8211; I never use the start menu. It seems like if there isn&#8217;t reliable information you should &#8230; not try and pass that information on to the user as a fact.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192913">
				<div id="div-comment-192913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.adersoftware.com' rel='external nofollow' class='url'>Andrew Deren</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192913">
			July 9, 2004 at 8:26 am</a>		</div>

		<p>Now I know why it takes forever to open &quot;Add/Remove&quot; dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192923">
				<div id="div-comment-192923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JohnnyO</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192923">
			July 9, 2004 at 8:42 am</a>		</div>

		<p>I think a much more intelligent solution would have been a question mark icon and fields labeled unknown.</p>
<p>This sounds like a classic case of over-engineering.  Someone was probably tasked with this, and finished the basic functionality in a few days, but had more time to kill, so he added the extra &quot;features&quot;</p>
<p>PS Is the start menu still the preferred method of accessing programs?  Most people I know have desktop links for their common programs and only go to the start menu for something that is needed only rarely.  (i.e.  Not worth the desktop space)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192933">
				<div id="div-comment-192933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BrianM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192933">
			July 9, 2004 at 8:50 am</a>		</div>

		<p>Displaying &quot;Unknown&quot; for fields that can&#8217;t be populated from the registry would be a terrible idea.  Can you imagine a user&#8217;s reaction when the installer claimed it didn&#8217;t know how big a program was, where it lived on disk, or what its icon was?  That&#8217;s not the sort of program a user wants to rummage around on their computer deleting things. </p>
<p>In this case, a hack that pretends to know what it&#8217;s talking about (for display purposes only, remember &#8212; none of this hack stuff gets used for the <em>actual</em> uninstallation) is a much better idea for the user&#8217;s peace of mind.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192943">
				<div id="div-comment-192943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasondoucette.com/' rel='external nofollow' class='url'>Jason Doucette</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192943">
			July 9, 2004 at 9:00 am</a>		</div>

		<p>While I think it is great that Microsoft has placed a quite an effort to &#8216;make things proper&#8217;, I am going to have to agree with Joel, here.  When you try and help out people too much, they will continue to show a complete lack of effort.  And look at the mess this creates&#8230;</p>
<p>I have always wondered why the ‘Add/Remove Programs’ dialog takes two hours to appear &#8211; even though I thought all it had to do was read and display pre-stored information.  But, now I know the answer.</p>
<p>Great article, btw, Raymond.  I love hearing about the internals of such things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192963">
				<div id="div-comment-192963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192963">
			July 9, 2004 at 9:14 am</a>		</div>

		<p>&quot;wouldn&#8217;t it be make sense to automatically remove a program&#8217;s entry if executing it&#8217;s uninstall failed because the file was missing?&quot; </p>
<p>Yup, Add/Remove Programs does this. If the uninstaller is missing, it offers to delete the entry. </p>
<p>As for making the other fields mandatory: That would have required being clairevoyant, knowing in 1995 when the Uninstall key was originally designed that Add/Remove Programs in Windows 2000 would need more information.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-192983">
				<div id="div-comment-192983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Sheppard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192983">
			July 9, 2004 at 9:21 am</a>		</div>

		<p>I have to say the size /usage info are  brilliant examples of lame features that should have been cut, why are they still there? There must be a reason this wasn&#8217;t just simply dropped once we realized (soemone did notice, right?) it doesn&#8217;t really work as expected.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192993">
				<div id="div-comment-192993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.excastle.com/blog/' rel='external nofollow' class='url'>Joe White</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192993">
			July 9, 2004 at 9:22 am</a>		</div>

		<p>Obviously nobody knew in 1995 that this info would be required later. But MS keeps coming out with new guidelines and new versions of Windows Installer&#8230; why not just say &quot;installation of this new registry key is required as of Windows Installer 2.1, and we won&#8217;t even let you build an installer that doesn&#8217;t include it&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193003">
				<div id="div-comment-193003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193003">
			July 9, 2004 at 9:31 am</a>		</div>

		<p>That sounds like a great sugestion for the Windows Installer team.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193023">
				<div id="div-comment-193023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vassili</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193023">
			July 9, 2004 at 9:49 am</a>		</div>

		<p>Ok, so Add/Remove takes forever to open. But may be there is a way to uninstall program from the command prompt and not open Add/Remove dialog at all?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193033">
				<div id="div-comment-193033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dcc.ufrj.br/~cesarb/' rel='external nofollow' class='url'>Cesar Eduardo Barros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193033">
			July 9, 2004 at 9:52 am</a>		</div>

		<p>BrianM: what would reduce a user&#8217;s confidence more: saying &quot;honestly, I don&#8217;t know&quot; or showing an obviously absurd guesstimate (which is bound to happen eventually)?</p>
<p>Raymond: Why not asking installers to put in the registry the name of a file with the full list of files installed by it? Then you could easily do something like Debian&#8217;s &quot;popularity-contest&quot; and get a reliable indication of when the program was last used.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192813">
				<div id="div-comment-192813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotnetjunkies.com/WebLog/sriram/archive/2004/07/08/18702.aspx' rel='external nofollow' class='url'>Sriram Krishnan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192813">
			July 9, 2004 at 10:12 am</a>		</div>

		<p>How the Add/Remove programs estimates size</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193063">
				<div id="div-comment-193063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193063">
			July 9, 2004 at 10:19 am</a>		</div>

		<p>Cesar: If you have a file that is used by multiple programs, then you won&#8217;t be sure any more. Plus of course it won&#8217;t work for Windows Installer packages that are advertised but not installed. (You ran the program yesterday, then you needed some disk space so you returned it to the &quot;install-on-demand&quot; state. If all the system did was check file timestamps, it would think the program had never been run!) </p>
<p>Vassili: The answer is right in front of you. Read my article again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193073">
				<div id="div-comment-193073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vassili</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193073">
			July 9, 2004 at 10:26 am</a>		</div>

		<p>Raymond: do you suggest to use whatever is in the &quot;UninstallPath&quot;? But I would not know what is there until I open RegEdit and find out. Add/Remove is faster than that, at least now on my machine. BTW, on XP it is &quot;UninstallString&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193093">
				<div id="div-comment-193093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193093">
			July 9, 2004 at 11:05 am</a>		</div>

		<p>Now I&#8217;m confused. Your program opens the Uninstall key and sucks out the UninstallString and then executes it. Who needs to open RegEdit?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193103">
				<div id="div-comment-193103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vassili</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193103">
			July 9, 2004 at 11:34 am</a>		</div>

		<p>Raymond (sorry so spent your time&#8230;): my program? Of course, I can write program which will find &quot;UninstallString&quot; and execute it, just wondered if something is already done. On the other hand, even if I write such program, I would need to know or guess name of the key under Uninstall (SomeProgram in your example). This brings us to recreating &quot;Add/Remove&quot; without size/last used functionality.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193113">
				<div id="div-comment-193113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.JCABs-Rumblings.com' rel='external nofollow' class='url'>JCAB</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193113">
			July 9, 2004 at 11:50 am</a>		</div>

		<p>Interesting&#8230;</p>
<p>The thing I have always been wanting to know is not <em>how big</em> the program is, but <em>where</em> it is that big (i.e. the paths used to get the size).</p>
<p>After all, if I need to make some space in C:, how do I know to leave alone any program that I have which is installed in D:?</p>
<p>Of course, now I understand that if the Add/Remove thingy had given those paths to me, I would have realized much sooner how imprecise a job it was doing&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193153">
				<div id="div-comment-193153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mariano Kamp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193153">
			July 9, 2004 at 12:39 pm</a>		</div>

		<p>Wow. That is worse than I imagined.<br />
<br />The use of heuristics seems to be the worst possible approach. But if you&#8217;re already heading down this path, why don&#8217;t you use at least stop words, like: program windows and some spanish words of zero value?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193163">
				<div id="div-comment-193163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193163">
			July 9, 2004 at 12:47 pm</a>		</div>

		<p>I&#8217;m not proud of this heuristic. I&#8217;m just explaining how it works, not why it is good. (Because it isn&#8217;t.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193203">
				<div id="div-comment-193203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caligari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193203">
			July 9, 2004 at 1:11 pm</a>		</div>

		<p>What I don&#8217;t understand is why Add/Remove Programs does not use lazy evaluation to determine the &quot;Last Used&quot; and &quot;Frequency&quot; values.  These two values only appear when a user selects a program in the listing.  Surely the overwhelming majority of people open the Add/Remove Programs dialog with the intent of removing a particular program.  When someone opens the applet to uninstall RealPlayer, why is any effort spent determining the program usage metrics of every single program in the listing?</p>
<p>If Microsoft plans on keeping the &quot;Last Used&quot; and &quot;Frequency&quot; values, the least they could do is rewrite the backend to make good use of lazy evaluation.  Only calculate these values when a user selects a program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193213">
				<div id="div-comment-193213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193213">
			July 9, 2004 at 1:12 pm</a>		</div>

		<p>Raymond: I was always curious as to what sort of voodoo the thing did under the hood.  Is this in any way similar to the tray icon automatic hiding stuff in XP?  Remembering captions, icons, and owning processes and just trying to match the icons up?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193223">
				<div id="div-comment-193223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193223">
			July 9, 2004 at 1:14 pm</a>		</div>

		<p>Caligari: You can sort by them.  So you need them around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193233">
				<div id="div-comment-193233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zachary Turner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193233">
			July 9, 2004 at 1:34 pm</a>		</div>

		<p>Wouldn&#8217;t it make more sense to look for an executable in the same folder as the uninstall file rather than searching the start menu?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193263">
				<div id="div-comment-193263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jordan Russell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193263">
			July 9, 2004 at 1:54 pm</a>		</div>

		<p>Raymond: You forgot to mention InstallLocation. If you set that value, ARP won&#8217;t have to guess where your program is installed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193293">
				<div id="div-comment-193293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caligari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193293">
			July 9, 2004 at 2:01 pm</a>		</div>

		<p>Jack: Lazy evaluation would also apply when sorting by usage.  Calculate usage metrics when needed, and no sooner.  When the user sorts the listing&#8211;that&#8217;s when time intensive operations should run.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193303">
				<div id="div-comment-193303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caligari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193303">
			July 9, 2004 at 2:03 pm</a>		</div>

		<p>Zachary: Look at Raymond&#8217;s example.  The uninstall file is in &quot;C:WINDOWSuninstall.exe.&quot;  It is unlikely an application&#8217;s main executable would be there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193313">
				<div id="div-comment-193313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193313">
			July 9, 2004 at 2:07 pm</a>		</div>

		<p>Caligari:</p>
<p>Well it&#8217;s probably evaluating it by looking at the start menu item shortcut&#8217;s usage stats, which is already has open anyway for getting the application icon.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193323">
				<div id="div-comment-193323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob...</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193323">
			July 9, 2004 at 2:31 pm</a>		</div>

		<p>The biggest question is why does Add/Remove programs supply this information anyway? As the data&#8217;s questionable, it&#8217;s not like it&#8217;s useable for anything meaningful.</p>
<p>What would have been far more useful would have been to implement a &quot;type the first letters of the word to jump to it&quot; search facility like every other list widget in Windows has!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193353">
				<div id="div-comment-193353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thales</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193353">
			July 9, 2004 at 3:14 pm</a>		</div>

		<p>I guess this also explains why I can&#8217;t sort the list by the date the program was installed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193373">
				<div id="div-comment-193373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thenexusnet.com' rel='external nofollow' class='url'>nexus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193373">
			July 9, 2004 at 3:23 pm</a>		</div>

		<p>I&#8217;m impressed you even posted this. If it were me I would be too embarrassed to ever tell anyone how it actually works.</p>
<p>If it is obvious to everyone that this approach is convoluted, error-prone, and unnecessary, why the heck wasn&#8217;t it fixed. Instead you just needlessly complicated things. Doeasn&#8217;t anyone at MS say &quot;hold on, this is idiotic, we need to change how this works&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193383">
				<div id="div-comment-193383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thierry Tremblay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193383">
			July 9, 2004 at 3:38 pm</a>		</div>

		<p>Now I am really pissed. I&#8217;ve spent literally days trying to figure out what was going on with my multi-compiler installation (VC6, EVC3, EVC4 and VC7). The Add/Remove list always listed non-sense values for the size occupied.</p>
<p>Thank you for making me waste my time trying to fix something that wasn&#8217;t there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-192973">
				<div id="div-comment-192973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-192973">
			July 9, 2004 at 9:14 am</a>		</div>

		<p>It&#8217;s not entirely clear that this was all thought out before-hand. Raymond doesn&#8217;t go into the history or timeline, but I would imagine it goes something like this:<br />
<br />Windows 95 &#8211; Add/Remove Programs invented and registry key defined<br />
<br />Sometime between Windows 95 and Windows XP (or earlier) &#8211; Someone whines &quot;How do I know if I want to uninstall something?  I wish I knew how big or often it is!&quot;<br />
<br />Windows XP (or earlier) &#8211; Extend registry key and build creative hack to get information<br />
<br />Now &#8211; Joel Spolsky says, &quot;MICROSOFT SUCKS!&quot;*</p>
<p>* Actually, he probably didn&#8217;t say that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193273">
				<div id="div-comment-193273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sphear.demon.nl/weblogs/rene/archive/2004/07/09/1167.aspx' rel='external nofollow' class='url'>Ren</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193273">
			July 9, 2004 at 4:54 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193413">
				<div id="div-comment-193413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.rotd.org/' rel='external nofollow' class='url'>Andreas Magnusson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193413">
			July 9, 2004 at 5:20 pm</a>		</div>

		<p>Rob is the man! I would also like to see the &quot;type first letter&quot;-thingy in the Add/Remove Programs, I&#8217;ve been missing that since Win95!</p>
<p>Thierry, it seems you haven&#8217;t played enough with Add/Remove Programs&#8230;it was not that hard to realise that there&#8217;s always been something fishy with the size and frequency and thus not something to trust (and now we know what smells).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193453">
				<div id="div-comment-193453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193453">
			July 9, 2004 at 9:40 pm</a>		</div>

		<p>Scott/Raymond,</p>
<p>If Add/Remove can find the uninstall program it thinks it&#8217;s successful. A/R only removes if the installer can&#8217;t be found. If the installers data is deleted /lost then A/R thinks it was sucessful cos the error is in the installer not A/R.</p>
<p>I still reccommend the tweakui version (98&#8217;s?) that edits A/R to people. Maybe A/R should check the exit code as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193463">
				<div id="div-comment-193463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193463">
			July 9, 2004 at 9:45 pm</a>		</div>

		<p>Why does having a negitive number for the icon (resource ID?) leave a gigantic amount (20 &#8211; 30 pages)of white space under that entry. (Autocad is one)</p>
<p>And their testing team missed it!!!!!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193333">
				<div id="div-comment-193333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Florian W.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193333">
			July 9, 2004 at 2:47 pm</a>		</div>

		<p>Why can&#8217;t Microsoft use a system that is similar to apple?. I always wonder, when I see an installation of MS-Word just by copying the folder. No Starmenu stuff, Uninstall by deleting the application icon&#8230; *cool*<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193473">
				<div id="div-comment-193473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dmitriy Kostovetskiy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193473">
			July 9, 2004 at 10:00 pm</a>		</div>

		<p>It would be better if &quot;Add Remove Programs&quot; first displayed all programs without icon and size estimate and then did all these guesswork in a background thread. Then it wouldn’t take so long to open &quot;Add/Remove&quot; dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193483">
				<div id="div-comment-193483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193483">
			July 9, 2004 at 10:25 pm</a>		</div>

		<p>&quot;Maybe A/R should check the exit code as well.&quot;</p>
<p>The problem is that the meaning of the exit code is not standardized.  Does an exit code of 1 mean &quot;uninstall failed&quot;? Or does it mean &quot;uninstall cancelled&quot;?  In the second case, you don&#8217;t want to remove the uninstall entry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193493">
				<div id="div-comment-193493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193493">
			July 9, 2004 at 10:25 pm</a>		</div>

		<p>Raymond said:<br />
<br />&quot;Yup, Add/Remove Programs does this. If the uninstaller is missing, it offers to delete the entry.&quot;</p>
<p>I got back to my desktop and realized that the problem entry was actually calling InstallShield (in windows dir I presume) with a config file that was in the application directory.  Manually deleting the app directory just made InstallShield error out with a file not found.  Guess Windows can&#8217;t be held responsible for that&#8230; sorry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193503">
				<div id="div-comment-193503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A Regular Viewer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193503">
			July 9, 2004 at 11:42 pm</a>		</div>

		<p>Given the availability of hard-disk space, given the library path search sequence, why should there be the ARP applet at all? Either a directory delete, or for any de-regsitration functions &#8211; a script in the applications&#8217; directory, should suffice. Of course this question is more for the developers of the Software than the Windows team.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193513">
				<div id="div-comment-193513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193513">
			July 9, 2004 at 11:46 pm</a>		</div>

		<p>Are you kidding? Program Files contains files that your computer needs to keep working properly. It&#8217;s highly dangerous to go messing about in there!</p>
<p>:)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193523">
				<div id="div-comment-193523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A Regular Viewer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193523">
			July 10, 2004 at 12:41 am</a>		</div>

		<p>Not the whole PF directory! Just the Application&#8217;s. Which may or may not be installed in PF.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193533">
				<div id="div-comment-193533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193533">
			July 10, 2004 at 1:20 am</a>		</div>

		<p>Norton&#8217;s has an exit code of 42 or something for sucess that freaks people out who read their task scheduler logs.</p>
<p>But still there is really only Acme, .msi, inf, Installer Shield, and Wise. That would cover 99% of cases. If one comes across my custom installer (could never make heads or tales of installshield and inf didn&#8217;t give one file distribution) it can just do what it does now.</p>
<p>This does affect all tweakui as well (inf and hta). Just trying to make you feel guilty.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193583">
				<div id="div-comment-193583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193583">
			July 10, 2004 at 8:35 am</a>		</div>

		<p>Actually, if I recall correctly, the numbers from the application compatibility team was that ACME+.msi+inf+InstallShield+Wise is only 65%, not 99%.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193553">
				<div id="div-comment-193553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.flex-mx.com/archives/000951.html' rel='external nofollow' class='url'>flex-mx</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193553">
			July 10, 2004 at 9:21 am</a>		</div>

		<p>Raymond Chen goes into detail how this feature in Windows works. Interesting&#8230; but what&#8217;s the bottom line? &quot;It&#8217;s all just guesswork.&quot;&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193593">
				<div id="div-comment-193593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Niels W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193593">
			July 10, 2004 at 9:23 am</a>		</div>

		<p>Raymond, great to know what goes on with that add/remove programms box. Think a lot of people have been wondering about that, one time or another.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193613">
				<div id="div-comment-193613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zero-one-zero.com/vs' rel='external nofollow' class='url'>Jonathan Payne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193613">
			July 10, 2004 at 11:46 am</a>		</div>

		<p>Most installer people I have talked to have wasted at least one day trying to get Add/Remove Programs to work correctly with their application (usually trying to work out why the icon selection is so weird or trying to understand the size entry).</p>
<p>Perhaps the best solution would have been for Microsoft to put items that register themselves under the current key in a legacy section and define a new section that would have a much clearer, well-defined design for new items.  It might upset a few people and I guess it might have tricky interactions with old versions of Windows but building more and more on top of dodgy foundations seems like a bad idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193623">
				<div id="div-comment-193623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Derek Park</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193623">
			July 10, 2004 at 11:50 am</a>		</div>

		<p>If you removed the guesswork, and displayed a standard &quot;unknown&quot; message and icon, I bet most software distributors would add the desired registry keys fairly quickly.  It looks unprofessional to have missing icons on your uninstaller, especially since it&#8217;s not complex to do it the right way, and I bet pretty soon teams would be getting demands that they make their uninstallers &quot;work like Microsoft&#8217;s&quot;.  Assuming, of course, that Microsoft is (or will be) doing things the right way.</p>
<p>As it is now, I bet most developers don&#8217;t know about this, because there&#8217;s no incentive to find out.  I certainly didn&#8217;t know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193633">
				<div id="div-comment-193633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193633">
			July 10, 2004 at 12:50 pm</a>		</div>

		<p>alhough it&#8217;s all hindsight now, what should have been done is that</p>
<p>&#8211; leave out entirely the the est size and freq use for those apps that don&#8217;t have that info<br />
<br />&#8211; use a generic windows icon or whatever for those that don&#8217;t have the icon info<br />
<br />&#8211; give a pretty color or uninstall certification logo on each one that does fully comply and display it in a small but attractive 16&#215;16 on each line. </p>
<p>the second and third in particular would have given the right kick</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193643">
				<div id="div-comment-193643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://vomber.europe.webmatrixhosting.net/archive/2004/07/10/185.aspx' rel='external nofollow' class='url'>Mikael S</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193643">
			July 10, 2004 at 3:55 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193673">
				<div id="div-comment-193673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193673">
			July 10, 2004 at 7:21 pm</a>		</div>

		<p>you don&#8217;t show as &quot;unknown&quot;, you leave out the info for those.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193683">
				<div id="div-comment-193683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193683">
			July 10, 2004 at 7:25 pm</a>		</div>

		<p>Okay, so now every program shows up as blank for those items. Still not useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193693">
				<div id="div-comment-193693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Derek Park</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193693">
			July 10, 2004 at 7:44 pm</a>		</div>

		<p>Incorrect information is not particularly more useful than no information at all.</p>
<p>I think this is one of those cases where Microsoft&#8217;s apparent &quot;make everything ridiculously easy, even if it&#8217;s not 100 percent right&quot; policy is a step in the wrong direction.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193653">
				<div id="div-comment-193653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193653">
			July 10, 2004 at 1:39 pm</a>		</div>

		<p>When this feature was added in Windows 2000, if a program that didn&#8217;t provide this information showed up with &quot;unknown&quot;, then *every* program would have shown up as &quot;unknown&quot;. That wouldn&#8217;t have been very useful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193703">
				<div id="div-comment-193703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.debreuil.com' rel='external nofollow' class='url'>Robin Debreuil</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193703">
			July 10, 2004 at 10:00 pm</a>		</div>

		<p>Before totally writing off this workaround, we should ask what percent of the time it is correct, and within say 20MB of the correct size. Even with  the exact info this isn&#8217;t an exact science &#8211; what about shared dlls, local settings dirs (which can bloat), user files, web updates&#8230;</p>
<p> The most exact system would be to require the uninstall program to send it&#8217;s own size estimate of what it will remove, but maybe it just isn&#8217;t that important.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193723">
				<div id="div-comment-193723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.phm.lu' rel='external nofollow' class='url'>Philippe Majerus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193723">
			July 10, 2004 at 11:28 pm</a>		</div>

		<p>I think the fact that the information is plain unreliable for applications not providing the information is clearly an issue.</p>
<p>But even more important, it makes valid information from applications that <em>do</em> provide the information also useless, as there is no way to differentiate that valid information from the random information generated!</p>
<p>My vote definitely go to the white or &quot;unknown&quot; size label and generic .exe icon for applications that do not provide the information explicitely, developpers will quickly get their installers fixed.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193733">
				<div id="div-comment-193733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193733">
			July 10, 2004 at 11:48 pm</a>		</div>

		<p>Okay, so suppose that the next version of Windows does as you suggest and just shows blanks and generic icons for programs that don&#8217;t provide this information.  And some users will perceive it as a regression.</p>
<p>Those users upgrade and say, &quot;Hey, Add/Remove Programs used to show all this information and now it doesn&#8217;t! You broke it!&quot;</p>
<p>You could try to explain, &quot;No, really, it&#8217;s the uninstaller that is broken. Previous versions of Windows were compensating for badly-written uninstallers but it doesn&#8217;t do that any more.&quot;</p>
<p>And those users will say, &quot;Well, put it back. I thought the whole point of Windows was to make our (the users&#8217;) lives better. If that means doing extra compensatory work when an uninstaller is badly-written, well, that&#8217;s your job.  I mean, c&#8217;mon YOU ALREADY WROTE IT.&quot;</p>
<p>Now, you could tell those users to go stick their heads in buckets of sand, but if they happen also to be collectively responsible for $100 million dollars of revenue [and sometimes they are], you have a fiduciary responsibility to your shareholders to do what you can to keep them happy.</p>
<p>(Personally I would be thrilled to rip out this guesswork code.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193743">
				<div id="div-comment-193743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Derek Park</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193743">
			July 11, 2004 at 12:19 am</a>		</div>

		<p>I&#8217;ve always considered the &quot;it&#8217;s tradition&quot; a poor reason for doing anything, and that&#8217;s really what that argument comes down to.</p>
<p>You could remind users how much faster add/remove programs became after the change.</p>
<p>You could add a &quot;give you nearly made-up numbers?&quot; choice the first time the add/remove dialog is run.  Be friendly and call it &quot;XP compatability&quot; mode (with an explaination of what it entails) if you prefer.  Stick the option somewhere easily accessible after the first run and stick in article in the help documentation somewhere explaining the change.  The few users who both notice and care will then be able to easily find out exactly how and why the behavior changed and then change it back if they prefer.</p>
<p>You could add some new feature(s) and explain away the change as necessary for the new, nifty feature(s).  Unfortunately I can&#8217;t think of any new feature right now.  Talk to R and D for that one, I guess.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193753">
				<div id="div-comment-193753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193753">
			July 11, 2004 at 12:37 am</a>		</div>

		<p>Sure, display a confusing dialog box the first time somebody runs Add/Remove Programs. That&#8217;ll solve the problem.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193783">
				<div id="div-comment-193783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193783">
			July 11, 2004 at 2:17 am</a>		</div>

		<p>I&#8217;ve been examining my listing. Some are blank. One that was was one of 3/3 tweakui entries except this one (1/3) had appended to the name Common Database (I clicked Remove to get some info on what it was and it did remove so I can&#8217;t tell you the details of that one &#8211; but it&#8217;s still installed both 2.1 and 1.33 &#8211; computers that obey &#8211; how dare it). It was probably Ver 2 as it isn&#8217;t in the registry. The two remaining Tweakui have Display and Uninstal and 2.1 has shortcut path as well yet they are blank details in A/R.</p>
<p>The only other entry I have with Common Database appened is IE4ShWiz (Ramesh made me install it)which is installed under a GUID string with a .sdb appended to the GUID string<br />
<br />EG<br />
<br />HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionUninstall{f491b748-37ff-4d34-bd05-60f4ccbf46fa}.sdb</p>
<p>Also what is the definition of Rarely/frequently.</p>
<p>I believe that the Start Panel counts all executions of an exe while Classic Start records only those executed from Start. Does this affect A/R.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193793">
				<div id="div-comment-193793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Derek Park</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193793">
			July 11, 2004 at 3:44 am</a>		</div>

		<p>Confusing?  How would that be any more confusing than telling me (or anyone else) that the J2SDK occupies only 1.89 megs, the JRE uses 1.66 megs, and that GTA III uses a grand total of 3.30 megs?  How is it more confusing than telling me that I rarely use Firefox, and that I haven&#8217;t used it since early March?</p>
<p>Apparently it does throw in a standard generic icon sometimes, though, because GTA III (among others) shows up with the standard installer-style icon, rather than the icon in the exe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193813">
				<div id="div-comment-193813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Antonelli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193813">
			July 11, 2004 at 8:44 am</a>		</div>

		<p>this is completely ridiculous, it guesses?</p>
<p>what if you have two seperate programs with VERY similar names and it confuses the links for the two??<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193823">
				<div id="div-comment-193823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193823">
			July 11, 2004 at 8:58 am</a>		</div>

		<p>Then you&#8217;d better hope that the authors of the two programs set the EstimatedSize and DefaultIcon properties.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193833">
				<div id="div-comment-193833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dcc.ufrj.br/~cesarb/' rel='external nofollow' class='url'>Cesar Eduardo Barros</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193833">
			July 11, 2004 at 9:41 am</a>		</div>

		<p>Raymond, why not add a (guessed) next to the guessed values? Then users will know the values are bogus (and most important, which ones aren&#8217;t), but you still keep the oh-so-important broken guessing algorithm.</p>
<p>(And you could change the guessed icons to a generic one.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193843">
				<div id="div-comment-193843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193843">
			July 11, 2004 at 10:11 am</a>		</div>

		<p>In my list, the only entries without a size are the Windows 2000 hotfixes.  I find that a little amusing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193853">
				<div id="div-comment-193853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193853">
			July 11, 2004 at 10:44 am</a>		</div>

		<p>Raymond:<br />
<br />&gt; And those users will say, &quot;Well, put it back. I thought the whole point of Windows was to make our (the users&#8217;) lives better. If that means doing extra compensatory work when an uninstaller is badly-written, well, that&#8217;s your job. I mean, c&#8217;mon YOU ALREADY WROTE IT.&quot; </p>
<p>To which you can respond &quot;We wrote it, it didn&#8217;t behave well enough to keep it, so it&#8217;s gone. Bad information is worse than no information, so we have decided to tell you what is actually going on&quot;. outside of a real OS-managed file registry, the only way for this to work is to rely on what the app reports. If it doesn&#8217;t report, we don&#8217;t know.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193863">
				<div id="div-comment-193863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193863">
			July 11, 2004 at 11:43 am</a>		</div>

		<p>You obviously have people at MS that say &quot;That&#8217;s a stupid idea, go away&quot;. I remember a thread about a file copy dialog where you were saying [IF] yoo took it to a feature committee [a file copy dialog with all of Xcopy&#8217;s features] they&#8217;d say go away. And that you weren&#8217;t going to (after the xcopy death threat I suppose you went off copying files). So how did this get past such a committee. And why did someone champion it. Was it because oof these &quot;corporations&quot;? If not what was the percieved need for it. What did the committee think about the algorithm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193873">
				<div id="div-comment-193873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193873">
			July 11, 2004 at 11:44 am</a>		</div>

		<p>The Windows 95 Add/Remove dialog was more functional. At least it supported basic list navigation key such as PgUp/PgDn, Home/End and first letter search. And if we wanted an estimate of which program was the most space hog, we could always inspect %ProgramFiles% with a third-party file manager (or Explorer, but it doesn’t have a key to calculate and show all selected directories’ individual sizes).</p>
<p>Now, though, everything is not lost. Someone just needs to get tired enough and write an “Add/Remove Classic” control panel applet :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193903">
				<div id="div-comment-193903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193903">
			July 11, 2004 at 1:53 pm</a>		</div>

		<p>Raymond your 7/10/04 10:48PM comment is simply paranoid. Bbelieve me, I write software that quite a few folks (not MS level of course) use.</p>
<p>You are in fact defending (even if you say you aren&#8217;t) a silly design decision, one that gives useful info MAYBE 50-60% of the time, by saying there was no better way to do it.</p>
<p>It&#8217;s water under the bridge and probably NOT worth changing at this point. So all I&#8217;m saying is &#8211; given a TARDIS &#8211; the info should have not been provided except for those apps with the keys.</p>
<p>Yes they woulda be blank. so what? as pointed out by others, so are MS hot fixes, and no one freaks out.</p>
<p>All you do is add that (along with other stuff) to a &quot;Enhanced Uninstaller Certification&quot; and provide a logo. Companies will eagerly add it to their products so they can have another bulletpoint (note my cynicism here).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193803">
				<div id="div-comment-193803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193803">
			July 11, 2004 at 7:55 am</a>		</div>

		<p>You certainly won&#8217;t believe me, but I know for a fact that there exist corporations that *want* this information, as completely bogus as it is.  (How do I know? Because they ask me how they can get it!  That&#8217;s why I wrote this entry in the first place &#8211; because I get asked it a lot.)</p>
<p>(And yes, you get blanks if the above lame algorithm fails to find a single match.) </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193933">
				<div id="div-comment-193933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rory</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193933">
			July 11, 2004 at 4:23 pm</a>		</div>

		<p>This is unbelievably bad development.  Didn&#8217;t anyone at the time think: &quot;what&#8217;s the point of this algorithm, it&#8217;s likely to lead to inaccurate info at least as often as it provides useful info?&quot;</p>
<p>Given that the algorithm produces dodgy info at best then there are a few ways to improve the performance.  Lazy evaluation mentioned above is the preferred method.  However, does application size change that much over time?  Could this have been calculated once and the value stored in the Registry for subsequent reads?  I could go on but you get the idea.</p>
<p>Also, when are MS going to lose the abomination that is the Registry ?</p>
<p>ps &#8211; Raymond, I really enjoy your articles and insights !</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193943">
				<div id="div-comment-193943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193943">
			July 11, 2004 at 4:43 pm</a>		</div>

		<p>The information does get cached for future use. </p>
<p>HKEY_LOCAL_MACHINE SOFTWARE Microsoft Windows CurrentVersion App Management ARPCache </p>
<p>Before you can ditch the registry you have to (1) come up with a replacement, (2) come up with a backwards compatibility story for all the code that uses the registry, and (3) come up with a plan for how the replacement can avoid the problems that the registry currently suffers from.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193923">
				<div id="div-comment-193923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bert.huijben.net/archives/9_AddRemove_Programs.html' rel='external nofollow' class='url'>Bert's blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193923">
			July 11, 2004 at 5:58 pm</a>		</div>

		<p>Zoals eerder geschreven ben ik de laatste tijd regelmatig bezig met installatieprogramma&#8217;s (voor mijn werk).</p>
<p>Raymond Chen vertelt hier hoe windows gegevens voor het Add/Rem</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193963">
				<div id="div-comment-193963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.phm.lu' rel='external nofollow' class='url'>Philippe Majerus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193963">
			July 11, 2004 at 7:47 pm</a>		</div>

		<p>Apps showing wrong icon and likely wrong size information on my PC:</p>
<p>Advanced Networking Pack for Windows XP (Microsoft)<br />
<br />Alt-Tab Task Switcher Powertoy for Windows XP (Microsoft)<br />
<br />CmdHere Powertoy For Windows XP (Microsoft)<br />
<br />Developer Resources for Windows Mobile 2003 Second Edition (Microsoft)<br />
<br />Image Resizer Powertoy for Windows XP (Microsoft)<br />
<br />Magnifier Powertoy for Windows XP (Microsoft)<br />
<br />Microsoft Data Access Components KB870669 (Microsoft)<br />
<br />Microsoft eMbedded Visual Tools (Microsoft)<br />
<br />Microsoft Money for the Pocket PC (Microsoft)<br />
<br />Microsoft Pocket PC 2003 SDK (Microsoft)<br />
<br />Microsoft Reader Text-to-Speech pour le fran&#231;ais (Microsoft)<br />
<br />Microsoft Windows CE Platform Manager 4.0 (Microsoft)<br />
<br />Microsoft Platform SDK for Handheld PC 2000 (Microsoft)<br />
<br />MUI Package for Windows Journal Viewer (Microsoft)<br />
<br />Slideshow Generator Powertoy for Windows XP (Microsoft)<br />
<br />Socket SDIO WLAN for Windows Mobile (Socket Com.)<br />
<br />Standard SDK for Windows CE .NET (Microsoft)<br />
<br />Standard SDK for Windows CE .NET 4.2 (Microsoft)<br />
<br />Virtual Desktop Manager Powertoy for Windows XP (Microsoft)<br />
<br />Windows Mobile 2003 Second Edition Emulator Images for Smartphone &#8211; WWE (Microsoft)<br />
<br />_ALL_ Windows XP Hotfix (Microsoft x23)</p>
<p>Err, except from Socket Com. (gonna notify them this week about this problem), it seems the company that has the most installers to fix is ..(drumrolls).. Microsoft!</p>
<p>I still say wrong information is worse than no information, today people cannot trust any of these values, and they know it&#8230;<br />
<br />Are you sure there will be more people asking why you removed that guesswork than there is today asking why some sharewares which took around 10MB when downloaded are reported as taking up almost a whole gigabyte in Add/Remove applet?!<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-193913">
				<div id="div-comment-193913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193913">
			July 11, 2004 at 1:59 pm</a>		</div>

		<p>&quot;You certainly won&#8217;t believe me, but I know for a fact that there exist corporations that *want* this information, as completely bogus as it is. (How do I know? Because they ask me how they can get it! That&#8217;s why I wrote this entry in the first place &#8211; because I get asked it a lot.) &quot;</p>
<p>I believe you, but I think they asked because they thought the info they&#8217;d get was ACCURATE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-193983">
				<div id="div-comment-193983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mvps.org/serenitymacros' rel='external nofollow' class='url'>David Candy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-193983">
			July 11, 2004 at 9:26 pm</a>		</div>

		<p>The registry would be easier to examine if it allowed two window, one on clsid and one whereever. Say finding what BHOs are installed, it&#8217;s very difficult for a human with regedit to assertain that (I can&#8217;t memorise a GUID and recognise it even 5 secs later let alone 10 of them).</p>
<p>And these GUIDs are like rabbits. They keep breeding. They are now in A/R Programs as well, just to make it harder for humans to read and navigate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194003">
				<div id="div-comment-194003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bigbeardy.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194003">
			July 12, 2004 at 3:45 am</a>		</div>

		<p>Raymond, defend it all you want, but the A/R dialog is STUPID, BROKEN, and WRONG.  Even the most computer-ignorant user can see that something&#8217;s not quite right when programs they use all the time show up as &quot;used rarely&quot;, but not knowing that actually most of the information in there is completely fictional they&#8217;re going to assume something far worse, and possibly start panicking about viruses or whatever.</p>
<p>In the absence of making it work properly, all that needs to be added are options to view in one of three modes:<br />
<br />&#8211; As it is now.<br />
<br />&#8211; Without any guesses &#8212; if you don&#8217;t KNOW, leave it blank.<br />
<br />&#8211; With guesses marked as such.</p>
<p>That way all these people you claim are desperate to be given false and misleading information can have it, and the rest of us normal people can do away with it.</p>
<p>(Oh, and of course, jump-to-letter, page up/page down, etc. to make navigating the list easier.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194013">
				<div id="div-comment-194013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DomF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194013">
			July 12, 2004 at 3:50 am</a>		</div>

		<p>I find the info pretty useful most of the time. I already knew it was half assed guesses most of the time (from looking at the results!) but as a first stab at clearing some space it is better than nothing and has speeded up my occasional uninstall blitz no end.</p>
<p>I agree with changing Windows Installer though :) Ask InstallShield nicely too and all the other installers will join up eventually.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194023">
				<div id="div-comment-194023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scott Robins</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194023">
			July 12, 2004 at 7:15 am</a>		</div>

		<p>Instead of leaving it blank or &quot;unknown&quot;, make the message be &quot;The application has failed to provide the information&quot;.</p>
<p>That way, MS doesn&#8217;t get blamed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194163">
				<div id="div-comment-194163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">4nd3r$</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194163">
			July 12, 2004 at 11:58 am</a>		</div>

		<p>What is this key: HKEY_LOCAL_MACHINE SOFTWARE Microsoft Windows CurrentVersion App Management Icon Hints and can it be used to get the right icon?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194173">
				<div id="div-comment-194173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194173">
			July 12, 2004 at 12:22 pm</a>		</div>

		<p>I think adding (estimated) next to the size &amp; date (as appropriate) would be ok. It&#8217;s not confusing, doesn&#8217;t require that the user do any extra work, and at least gives them a heads up that the value may be incorrect.</p>
<p>I&#8217;ve always thought that Windows should have an &#8216;expert mode&#8217;, where extra dialogs and things that could potentially confuse novices are included, for the benefit of those that can understand them &#8211; I suppose that&#8217;s completely impractical though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194183">
				<div id="div-comment-194183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194183">
			July 12, 2004 at 12:30 pm</a>		</div>

		<p>Saying &quot;estimated&quot; suggests that the items that aren&#8217;t marked &quot;estimated&quot; aren&#8217;t estimates, but actually they are estimated too. The property name in the registry is EstimatedSize, and some programs don&#8217;t update it when you reconfigure them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194203">
				<div id="div-comment-194203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.phm.lu' rel='external nofollow' class='url'>Philippe Majerus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194203">
			July 12, 2004 at 1:34 pm</a>		</div>

		<p>And you didn&#8217;t think about making EstimatedSize mandatory in Windows Installer 3.0 and required for Windows XP Logo certification (for previous MSI versions) ?</p>
<p>Better no feature than a feature that looks like a bug, this Add/Remove feature is one of the components that makes Windows looks inaccurate overall to some users (or former users).<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194223">
				<div id="div-comment-194223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael K. Antonelli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194223">
			July 12, 2004 at 2:07 pm</a>		</div>

		<p>I have several programs in one bundle, and it appears that only the first one has the estimated size and all the others count as zero.</p>
<p>its wierd&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194233">
				<div id="div-comment-194233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mr. Cynic</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194233">
			July 12, 2004 at 2:38 pm</a>		</div>

		<p>Philippe: MSI always writes the EstimatedSize value automatically and has done so for quite a while now. It also adjusts the EstimatedSize value as you install and remove various subcomponents of the application.</p>
<p>For more info on how MSI apps can set various ARP properties, see: <a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/uninstall_registry_key.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/uninstall_registry_key.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-194303">
				<div id="div-comment-194303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.phm.lu' rel='external nofollow' class='url'>Philippe Majerus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194303">
			July 12, 2004 at 10:49 pm</a>		</div>

		<blockquote><p>
  MSI always writes the EstimatedSize value automatically (&#8230;)</p>
<p>That&#8217;s good news, so I guess there is a very simple solution to get more valid results in Add/Remove Programs:<br />
  <br />Work with the 5 top software companies building installers (InstallShield and all) to get their software to take care of that value automatically also, so ISVs that do not even know about the guesswork still get their installers fixed!
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-194553">
				<div id="div-comment-194553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.systemex.net/Kiliman' rel='external nofollow' class='url'>Kiliman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-194553">
			July 13, 2004 at 1:30 pm</a>		</div>

		<p>&quot;That way all these people you claim are desperate to be given false and misleading information can have it, and the rest of us normal people can do away with it.&quot;</p>
<p>I guess those are all the people going to see Michael Moore&#8217;s film.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195133">
				<div id="div-comment-195133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">4nd3r$</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-195133">
			July 14, 2004 at 6:31 pm</a>		</div>

		<p>The answer to my own question: HKEY_CLASSES_ROOTInstallerProducts</p>
<p>can you give us some info about this key Raymond? &#8230;AdvertiseFlags sounds dodgy</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195183">
				<div id="div-comment-195183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-195183">
			July 14, 2004 at 11:49 pm</a>		</div>

		<p>The Installer key is MSI. You&#8217;ll have to ask them what their keys mean. &quot;Advertisement&quot; is an MSI term.  <a target="_new" href="http://msdn.microsoft.com/library/en-us/msi/setup/advertisement.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/msi/setup/advertisement.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-195633">
				<div id="div-comment-195633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.MichaelTeper.com' rel='external nofollow' class='url'>Michael Teper</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-195633">
			July 15, 2004 at 1:51 pm</a>		</div>

		<p>God, this is bad! Raymond, thank you for explaining the behavior. Now that its out in the open though, it seems everyone is agreeing its worse that not showing this info in the first place. Are there any plans to address this in Longhorn timeframe? It would be great if you could blog a follow-up!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-195653">
				<div id="div-comment-195653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-195653">
			July 15, 2004 at 2:09 pm</a>		</div>

		<p>My focus is on history not the future.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196153">
				<div id="div-comment-196153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://chuacw.hn.org/chewy/archive/2004/07/17/748.aspx' rel='external nofollow' class='url'>This side of paradise</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-196153">
			July 17, 2004 at 6:23 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-196203">
				<div id="div-comment-196203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://codehq.net/blog' rel='external nofollow' class='url'>John Bates</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-196203">
			July 18, 2004 at 6:52 pm</a>		</div>

		<p>A feature that would avoid a lot of the time wasted waiting for A/R to open would be an &#8216;expert&#8217; key in the registry that just skips all this nonsense and sets the estimated size to zero, etc. if not supplied. I know when I used something &#8211; when I want to remove it it no longer matters&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-196683">
				<div id="div-comment-196683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-196683">
			July 20, 2004 at 5:23 pm</a>		</div>

		<p>Somewhere I saw someone&#8217;s opinion that the reason why A/R&#8217;s display of size and other garbage should be illegal is because it lies.</p>
<p>Let&#8217;s see if I can find the statement of that opinion&#8230;  Yup:<br />
<br /><a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2004/07/15/184077.aspx#184135" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2004/07/15/184077.aspx#184135</a><br />
<br />It should be illegal because it lies.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-197983">
				<div id="div-comment-197983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nikos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-197983">
			July 24, 2004 at 10:20 am</a>		</div>

		<p>what i don&#8217;t understand is how the &quot;frequency&quot; field is calculated. Is it stored somewhere within the shortcut? I don&#8217;t see any book-keeping file in the start menu (at least for win2000)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-198003">
				<div id="div-comment-198003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tna</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-198003">
			July 25, 2004 at 11:57 am</a>		</div>

		<p>Like I believe someone stated above, the &quot;frequency&quot; does seem kind of useless, one doesn&#8217;t really look in add/remove programs&#8230;I&#8217;m sure it looked good as &quot;wow cool&quot; thing though, even though I don&#8217;t think many people even notice it.  And if it does increase startup time as much as others have said it does, why is it still in?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-198043">
				<div id="div-comment-198043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-198043">
			July 26, 2004 at 7:01 am</a>		</div>

		<p>I think the way to solve this is a threefold solution:</p>
<p>1. Make it mandatory for MSI installations to provide this information and as much meta-data as can conceiveably be useful in future.</p>
<p>2. Split the Add/Remove dialog so that non-MSI installers get added in a separate &quot;This application is rubbish and Windows recommends you get rid of it and replace it with something decent&quot; or &quot;legacy&quot; section. Make dissuading developers from using non-MSI  based installations a #1 priority.</p>
<p>3. Use lazy evaluation/background threading of the heuristics for legacy apps where possible to make the Add/Remove dialog open a lot faster.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-199763">
				<div id="div-comment-199763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-199763">
			July 29, 2004 at 10:46 am</a>		</div>

		<p>Commenting closes after two weeks.</p>
<p><a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-201943">
				<div id="div-comment-201943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://vomber.europe.webmatrixhosting.net/archive/0001/01/01/185.aspx' rel='external nofollow' class='url'>Mikael S</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-201943">
			August 9, 2004 at 3:11 pm</a>		</div>

		<p>L</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-267683">
				<div id="div-comment-267683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://bloggingabout.net/rene/archive/0001/01/01/1167.aspx' rel='external nofollow' class='url'>Rene Schrieken</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-267683">
			March 28, 2005 at 3:36 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-277813">
				<div id="div-comment-277813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/05/26/422076.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-277813">
			May 26, 2005 at 9:02 am</a>		</div>

		<p>A program has registered a bad uninstall icon.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-344013">
				<div id="div-comment-344013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/astebner/archive/2006/02/07/527261.aspx' rel='external nofollow' class='url'>Aaron Stebner's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-344013">
			February 7, 2006 at 10:59 pm</a>		</div>

		<p>I stumbled across an interesting item posted a while back by Raymond Chen about the Add/Remove Programs&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-369933">
				<div id="div-comment-369933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://farhanahmed.net/blog/?p=238' rel='external nofollow' class='url'>Code Thread &raquo; New Internal blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-369933">
			April 14, 2006 at 11:01 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://farhanahmed.net/blog/?p=238" rel="nofollow">http://farhanahmed.net/blog/?p=238</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-389413">
				<div id="div-comment-389413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/06/09/623793.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-389413">
			June 9, 2006 at 10:00 am</a>		</div>

		<p>It thought it was trying to help.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428543">
				<div id="div-comment-428543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.blueneedle.com/wordpress/2006/09/21/links-for-2006-09-22/' rel='external nofollow' class='url'>Life, it is a Travesty&#8230; &raquo; links for 2006-09-22</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-428543">
			October 6, 2006 at 5:56 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.blueneedle.com/wordpress/2006/09/21/links-for-2006-09-22/" rel="nofollow">http://www.blueneedle.com/wordpress/2006/09/21/links-for-2006-09-22/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-438963">
				<div id="div-comment-438963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://farhanahmed.com/blog/?p=222' rel='external nofollow' class='url'>Code Thread :: New Internal blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-438963">
			November 2, 2006 at 4:41 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://farhanahmed.com/blog/?p=222" rel="nofollow">http://farhanahmed.com/blog/?p=222</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-538303">
				<div id="div-comment-538303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mnathani.com/blog/links/?p=' rel='external nofollow' class='url'>Del.icio.us Links</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-538303">
			August 17, 2007 at 9:49 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://mnathani.com/blog/links/?p=" rel="nofollow">http://mnathani.com/blog/links/?p=</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-635283">
				<div id="div-comment-635283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://channel9.msdn.com/forums/Coffeehouse/14032-Most-annoying-bug-in-Windows-ever/#CommentID=14058' rel='external nofollow' class='url'>Channel 9</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-635283">
			June 2, 2008 at 7:41 pm</a>		</div>

		<p>Raymond Chen posted an explaination of this recently.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-681993">
				<div id="div-comment-681993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ipr.hu/wordpress/?p=25' rel='external nofollow' class='url'>IPR-Insights :: Szoftvergazd??lkod??s, szoftvernyilv??ntart??s, tan??csad??s</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-681993">
			November 10, 2008 at 8:43 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://ipr.hu/wordpress/?p=25" rel="nofollow">http://ipr.hu/wordpress/?p=25</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-710243">
				<div id="div-comment-710243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ipr.hu/blog/2009/02/20/szoftver-hasznalatanak-gyakorisaga' rel='external nofollow' class='url'>IPR-Insights :: Szoftvergazd??lkod??s, szoftvernyilv??ntart??s, tan??csad??s</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-710243">
			February 20, 2009 at 9:41 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://ipr.hu/blog/2009/02/20/szoftver-hasznalatanak-gyakorisaga" rel="nofollow">http://ipr.hu/blog/2009/02/20/szoftver-hasznalatanak-gyakorisaga</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729743">
				<div id="div-comment-729743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://richardberg.net/blog/?p=71' rel='external nofollow' class='url'>BUGBUG: poor title &raquo; Blog Archive &raquo; How to uninstall Powershell v1.0 from Windows Server 2003 R2</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040709-00/?p=38493#comment-729743">
			April 27, 2009 at 11:54 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://richardberg.net/blog/?p=71" rel="nofollow">http://richardberg.net/blog/?p=71</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

