<html>
<head>
<title>Why do you have to wait for Windows Error Reporting to check for solutions before it restarts the application?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why do you have to wait for Windows Error Reporting to check for solutions before it restarts the application?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 11, 2012 / year-entry #134</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>47</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Leo Davidson wonders why you have to wait for Windows Error Reporting to check for solutions before it restarts the application. Why not do the two in parallel? Well, for one thing, when the application restarts, it might freak out if it sees a dead copy of itself. I know for sure that I would...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Leo Davidson wonders <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/20/10040074.aspx#10040856"> why you have to wait for Windows Error Reporting to check for solutions before it restarts the application</a>. Why not do the two in parallel?</p>
<p> Well, for one thing, when the application restarts, it might freak out if it sees a dead copy of itself. I know for sure that I would freak out if I woke up one morning and saw my own dead body lying next to me. </p>
<p> While Windows Error Reporting is checking for a solution, it still has access to the carcass of the crashed application, because it may need to refer to it in order to answer follow-up questions from the server. ("Hey, was version 3.14 of PI.DLL loaded into the process when it crashed? If so, then I may have an idea what went wrong.") And so that, if you ask it to submit the crash to Microsoft, it can grab the information it needs in order to generate the crash report. </p>
<p> Now suppose you start up a new copy of the application right away. If the application is a single-instance program, it will look around for another copy of itself, and hey look, it'll find its own lifeless body in the middle of the computer version of an autopsy. It will then try to send messages to the dead program, saying, "Hey, the user wants to open document&nbsp;X; could you do that for me?" And it won't get a response because, well, the program is dead. It's never going to respond. </p>
<p> Some programs don't even try to pass information along. They just find the existing copy of the program, and call <code>Set&shy;Foreground&shy;Window</code> on its main window, thereby switching to it. Of course, what they tried to do was switched to a crashed program. </p>
<p> Even worse, what if the second copy of the program tries to <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/06/15/156022.aspx"> extract information from the existing copy of itself</a>? If the existing copy crashed, it's highly likely that the crash was caused by corruption in the program's internal data structures. When the second copy tries to extract the corrupted data, it may itself crash. Immediately launching the replacement program creates a very quickly-growing pile of dead programs, and your screen basically gets spammed with Windows Error Reporting dialogs faster than you can click OK. </p>
<p> The crashed program has effectively launched <a href="http://blogs.msdn.com/b/oldnewthing/archive/2006/06/20/639479.aspx"> a denial of service attack against itself</a>. </p>
<p> Before trying to start the program again, Windows makes sure that the previous copy has received a proper burial. Because few programs are prepared to see their own cadaver. </p>
<p> <b>Bonus chatter</b>: Another common scenario is that the program crashes at startup. Automatically restarting the program would just launch another copy that immediately crashes. Again, you get into the situation where you get a dozen copies of the program launched per second, all of which immediately crash. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (47)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-990543">
				<div id="div-comment-990543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990543">
			June 11, 2012 at 7:15 am</a>		</div>

		<p>I&#39;m sure there are more &quot;features&quot; that could be added here. Windows could somehow try to &quot;hide&quot; processes that Error Reporting is working on extracting data from. There could be a &quot;Restart now&quot; button in the dialog for the user to click. Error Reporting could be smarter about how many copies of itself should run at once.</p>
<p>But I can&#39;t imagine how any of those could possibly be worth the effort, considering by the time you have a crash things have already broken horribly. Making crash recovery any more complicated than it already is would just be another chance for things to go wrong.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-990573">
				<div id="div-comment-990573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990573">
			June 11, 2012 at 7:51 am</a>		</div>

		<p>I&#39;m under impression MS doesn&#39;t care about its own crash information. Windows 7 explorer crash (on deleting a folder in the tree pane) still left unfixed even in SP1.</p>
<div class="post">[<i>The crash information is studied very carefully. In Windows XP, 29% of all crashes were fixed in SP1. (I can&#39;t find statistics on Windows 7.) Sorry your crash was not in that 29%. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-deiruch even thread-even depth-1" id="comment-990593">
				<div id="div-comment-990593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/deiruch' rel='external nofollow' class='url'>deiruch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990593">
			June 11, 2012 at 8:05 am</a>		</div>

		<p>Raymond, sadly you only told us why a stupid implementation of the proposal wouldn&#39;t work. It&#39;d be great if you could explain why it&#39;s not done in a way that would work (either quickly copy all info to another location or hide the process). I guess the answer is less interesting: Too much work for too little benefit?</p>
<div class="post">[<i>&quot;Quickly copy all info&quot;: &quot;All info&quot; is basically the entire state of the computer. You have the process address space (2GB or even more on 64-bit machines), the window manager state, the file system state, etc. How do you quickly copy 2GB of data, most of which is probably needs to get paged in first? It reminds me of the Monty Python sketch &quot;How To Do It.&quot; And imagine how happy malware authors would be if it were possible to hide a process. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990603">
				<div id="div-comment-990603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Crowell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990603">
			June 11, 2012 at 8:08 am</a>		</div>

		<p>alegr1,</p>
<p>I assume that&#39;s not an explorer bug, but a shell extension. &nbsp;I can&#39;t reproduce it on my machine. &nbsp;I&#39;m sure the Microsoft Support folks could determine the issue if you provide a stack trace. &nbsp;:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990613">
				<div id="div-comment-990613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990613">
			June 11, 2012 at 8:14 am</a>		</div>

		<p>@deirch</p>
<p>To go alone with the too little benefit I think you have to consider a program crashing to be a lets say &quot;traumatic event&quot; for the user. They have already been inconvienced and possibly lost data, If windows error reporting take an extra 20 seconds to complete before restarting the app that should be the least of there worries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com odd alt thread-odd thread-alt depth-1" id="comment-990653">
				<div id="div-comment-990653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990653">
			June 11, 2012 at 8:38 am</a>		</div>

		<p>Can you not set it already to ask you each time before reporting so you can quickly click &quot;Restart&quot; without reporting and &quot;Check for solutions&quot; later from Action Center.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-deiruch even thread-even depth-1" id="comment-990663">
				<div id="div-comment-990663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/deiruch' rel='external nofollow' class='url'>deiruch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990663">
			June 11, 2012 at 8:41 am</a>		</div>

		<p>@Raymond: Mapping the same address space just requires the duplication of some PTEs &#8211; that&#39;s done in a few microseconds. Window state should be copiable very quickly too (most likely not paged out anyway). The file system is a good argument, didn&#39;t think of that.</p>
<p>Also you don&#39;t have to hide the process from everyone &#8211; changing it&#39;s identity would be good enough. The big problem with that would be that you&#39;d have to change it in all the various name spaces&#8230; As the kernel already has a concept of all the things a process owns it could do a proper job there.</p>
<p>It&#39;s certainly doable. But probably not worth the effort?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990673">
				<div id="div-comment-990673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/analisnudesette_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>analisnudesette@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990673">
			June 11, 2012 at 9:05 am</a>		</div>

		<p>Thanks for answering that!</p>
<p>I didn&#39;t realise WER was a two-way conversation, or that it might require info that takes a long time to generate/store, and only require it sometimes such that it doesn&#39;t make sense to generate/store all of it in advance, then kill the process and do the query in the background.</p>
<p>I assumed the OS would collect any required info (DLL versions, crash minidump perhaps; things which generally take under a second to save to disk and which definitely take much less time than the query itself takes) and bundle that off in the request.</p>
<p>Thanks again for the explanation of what&#39;s going on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990683">
				<div id="div-comment-990683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990683">
			June 11, 2012 at 9:19 am</a>		</div>

		<p>I don&#39;t know about you guys, but I have never had this system actually find a solution for me, as a result I have disabled it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990693">
				<div id="div-comment-990693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin Chase</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990693">
			June 11, 2012 at 9:31 am</a>		</div>

		<p>I find both of these steps incredibly annoying. I wish it would neither try to find a solution (since it never does, it always fails) or restart since just restarting is almost never what I actually want. For example VS crashes all the time and when I open it I may have opened it from a command prompt that has some special environment variables set which affects how projects open and get built. If VS is just automatically restarted by the OS then it doesn&#39;t have those parameters and I end up having to wait for it to load to remember that fact and close it down and reopen it manually anyway. Just let me open crashed apps up again the way I know they aught to be opened please.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990703">
				<div id="div-comment-990703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990703">
			June 11, 2012 at 9:35 am</a>		</div>

		<p>@Damien and Justin Chase, I have had it find solutions a few times. &nbsp;Usually there&#39;s a newer version of a driver that fixes whatever caused the crash.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990713">
				<div id="div-comment-990713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990713">
			June 11, 2012 at 9:38 am</a>		</div>

		<p>@Justin Case: Join the party. I&#39;ve taken to patching out bugs in Visual Studio by injection. Obviously this does not work if Visual Studio restarts itself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990723">
				<div id="div-comment-990723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">User #{598DE456-3B99-42D2-9FAF-99E9BAFCBB60}</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990723">
			June 11, 2012 at 10:14 am</a>		</div>

		<p>I would be very lucky if any of my bugs were fixed by Microsoft,</p>
<p>but currently I&#39;m on my own.</p>
<p>No, honest why do actively developed programs trigger WER?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990753">
				<div id="div-comment-990753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/brad.westness_4000_gmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>brad.westness@gmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990753">
			June 11, 2012 at 11:21 am</a>		</div>

		<p>@alegr1 I just performed the steps exactly as you described and the folder was deleted without a problem, Explorer just moved up a directory. I&#39;m running Windows 7 x64 SP1.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990763">
				<div id="div-comment-990763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990763">
			June 11, 2012 at 11:22 am</a>		</div>

		<p>@David Crowell: I&#39;m not competent enough to understand the stack trace alegr1 posted, but I can confirm that Explorer in a fresh Win7 x64 setup with no 3rd party shell extensions displays a &quot;Location is not available&quot; error and then crashes on cue. So there. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990773">
				<div id="div-comment-990773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990773">
			June 11, 2012 at 11:40 am</a>		</div>

		<p>@Brad: I&#39;m surprised you couldn&#39;t reproduce the issue. I&#39;m using SP1 as well. I find it interesting though that there need to be some files (at least one) in the folder or else the crash does not seem to occur. Since the crash also does not occur in other random locations, could it be due to the indexing service trying to index the files in the Documents folder and crashing Explorer when it&#39;s rudely interrupted (complete guess on my part of course).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990783">
				<div id="div-comment-990783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/brad.westness_4000_gmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>brad.westness@gmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990783">
			June 11, 2012 at 11:44 am</a>		</div>

		<p>@James: I just tried it again and the crash occurred. It seems to happen only when I do it via the &quot;Libraries&quot; branch of the tree view, doesn&#39;t happen via the Computer-&gt;Partition-&gt;Users-&gt;User-&gt;Documents branch.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990793">
				<div id="div-comment-990793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">EricE</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990793">
			June 11, 2012 at 11:50 am</a>		</div>

		<p>@alegr1, I can confirm the crash as well. &nbsp;Windows 7 Pro 64-bit, SP1. &nbsp;Start | Documents, create new folder, renamed it to zdiddly to get it to the bottom of the list. &nbsp;Copied 5 Excel files and one image into the directory. &nbsp;Selected the directory in the left pane and then shift-deleted it. &nbsp;Explorer pops up a message box saying that the location is no longer available. &nbsp;When the box was dismissed, Explorer crashed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-990803">
				<div id="div-comment-990803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990803">
			June 11, 2012 at 12:05 pm</a>		</div>

		<p>This particular crash exposes a usability problem and also reminds me of another usability problem.</p>
<p>Explorer is watching for the folder changes, using, as I think, ReadDirectoryChanges function. This function doesn&#39;t always work, mostly because of some fine security issues or race conditions. For example, I&#39;ve seen it not working if the folder owner/creator was different from the current user.</p>
<p>If the Explorer is asked to navigate to a folder which is not there anymore, it might do much better than showing a dreaded modal dialog. Another example of bad modal dialogs is when the system returns from hibernation and the network folder connections are broken. Or when you reconnect an RDP session, all open folders in \tsclient become invalid. The error message in this case is even more cryptic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990813">
				<div id="div-comment-990813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/tete333_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>tete333@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990813">
			June 11, 2012 at 1:12 pm</a>		</div>

		<p>I&#39;ve reproduced this explorer crash in Win8 RP doing the same steps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990523">
				<div id="div-comment-990523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990523">
			June 11, 2012 at 7:05 am</a>		</div>

		<p>It wound seem *reasonable* to have a limit of *2* (wow, for once the right answer wasn&#39;t zero, one or inifinity) for open WER windows per binary &#8211; if you&#39;re the first WER window, attempt to launch a fresh copy and do the error reporting in parallel. If you&#39;re the second WER window, then act as the current one does. That removes the self_DOS and startup crash issues you raise, whilst making things more responsive if the application *doesn&#39;t* look for other copies of itself</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990633">
				<div id="div-comment-990633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990633">
			June 11, 2012 at 8:20 am</a>		</div>

		<p>My experience with a certain program is that often when it sometimes crashes after doing a certain thing, after it gets restarted by WER, it&#39;ll crash again if I do the same thing again. &nbsp;But if I close it, re-launch it normally, and repeat that same thing, it *doesn&#39;t* crash. &nbsp;Does WER do anything special when re-launching a crashed program? &nbsp;Or could that program be doing something to try to reload some of its previous state (despite not having a cadaver to inspect) that would cause it to behave differently than if it were re-launched manually?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kwadwomi even thread-even depth-1" id="comment-990833">
				<div id="div-comment-990833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Master+Programmer' rel='external nofollow' class='url'>Master Programmer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990833">
			June 11, 2012 at 4:59 pm</a>		</div>

		<p>@deiruch</p>
<p>What your basically describing is process forking. The new process inherits all the handles and address space of the old process. I believe Windows 7 adds a similar feature called reflected processes which is the same thing. By reflecting the process into a dummy process you can take a minidump of the process without actually freezing it for the entire duration.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-990733">
				<div id="div-comment-990733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990733">
			June 11, 2012 at 10:31 am</a>		</div>

		<p>@David Crowell:</p>
<p>As you wish:</p>
<p>1. Create a folder in Documents, put a few files in it.</p>
<p>2. Select the folder in the tree pane.</p>
<p>3. Hit Shift+Del, click Yes.</p>
<p>4. The folder will be deleted, Explorer now complains that the selected folder disappeared.</p>
<p>5. As you dismiss the complain message box, Explorer crashes:</p>
<p>0:022&gt; !analyze -v</p>
<p>*******************************************************************************</p>
<p>* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</p>
<p>* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Exception Analysis &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</p>
<p>* &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *</p>
<p>*******************************************************************************</p>
<p>Debugger CompCtrlDb Connection::Open failed 80004005</p>
<p>Cannot access CompCentralDB. You may need to request access: <a href="http://windows/access" rel="nofollow">http://windows/access</a></p>
<p>Debugger Dbgportaldb Connection::Open failed 80004005</p>
<p>Database Dbgportaldb not connected</p>
<p>FAULTING_IP: </p>
<p>DUI70!DirectUI::BTreeLookup&lt;HINSTANCE__ *,DirectUI::IClassInfo *&gt;::GetItem+f</p>
<p>74b0852e 394104 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmp &nbsp; &nbsp; dword ptr [ecx+4],eax</p>
<p>EXCEPTION_RECORD: &nbsp;ffffffff &#8212; (.exr 0xffffffffffffffff)</p>
<p>ExceptionAddress: 74b0852e (DUI70!DirectUI::BTreeLookup&lt;HINSTANCE__ *,DirectUI::IClassInfo *&gt;::GetItem+0x0000000f)</p>
<p> &nbsp; ExceptionCode: c0000005 (Access violation)</p>
<p> &nbsp;ExceptionFlags: 00000000</p>
<p>NumberParameters: 2</p>
<p> &nbsp; Parameter[0]: 00000000</p>
<p> &nbsp; Parameter[1]: 3215b819</p>
<p>Attempt to read from address 3215b819</p>
<p>FAULTING_THREAD: &nbsp;0000137c</p>
<p>DEFAULT_BUCKET_ID: &nbsp;INVALID_POINTER_READ</p>
<p>PROCESS_NAME: &nbsp;Explorer.EXE</p>
<p>ERROR_CODE: (NTSTATUS) 0xc0000005 &#8211; The instruction at 0x%08lx referenced memory at 0x%08lx. The memory could not be %s.</p>
<p>EXCEPTION_CODE: (NTSTATUS) 0xc0000005 &#8211; The instruction at 0x%08lx referenced memory at 0x%08lx. The memory could not be %s.</p>
<p>EXCEPTION_PARAMETER1: &nbsp;00000000</p>
<p>EXCEPTION_PARAMETER2: &nbsp;3215b819</p>
<p>READ_ADDRESS: &nbsp;3215b819 </p>
<p>FOLLOWUP_IP: </p>
<p>DUI70!DirectUI::BTreeLookup&lt;HINSTANCE__ *,DirectUI::IClassInfo *&gt;::GetItem+f</p>
<p>74b0852e 394104 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cmp &nbsp; &nbsp; dword ptr [ecx+4],eax</p>
<p>NTGLOBALFLAG: &nbsp;0</p>
<p>APPLICATION_VERIFIER_FLAGS: &nbsp;0</p>
<p>PRIMARY_PROBLEM_CLASS: &nbsp;INVALID_POINTER_READ</p>
<p>BUGCHECK_STR: &nbsp;APPLICATION_FAULT_INVALID_POINTER_READ</p>
<p>LAST_CONTROL_TRANSFER: &nbsp;from 74b08692 to 74b0852e</p>
<p>STACK_TEXT: &nbsp;</p>
<p>06c5f53c 74b08692 671abac8 00000000 00380030 DUI70!DirectUI::BTreeLookup&lt;HINSTANCE__ *,DirectUI::IClassInfo *&gt;::GetItem+0xf</p>
<p>06c5f550 74b08f48 671abac8 74b085e8 00380030 DUI70!DirectUI::Element::_GetLocalValueFromVM+0x13</p>
<p>06c5f568 74b08f1a 671abac8 00000000 13789890 DUI70!DirectUI::Element::_GetSpecifiedValueIgnoreCache+0x13</p>
<p>06c5f580 74b08676 671abac8 00000000 06c5f5c0 DUI70!DirectUI::Element::_GetSpecifiedValue+0x292</p>
<p>06c5f590 671f5079 671abac8 00000002 00000000 DUI70!DirectUI::Element::GetValue+0x40</p>
<p>06c5f5a8 671bc27c 00000000 00000001 00000000 EXPLORERFRAME!ItemLayout::GetItemCount+0x14</p>
<p>06c5f5c0 671bc1d1 06c5f5f4 00000000 00000000 EXPLORERFRAME!UICollection::TryToRealizeIndex+0x24</p>
<p>06c5f624 671e1ead 07e350b8 671e1e95 06c5f6fc EXPLORERFRAME!UIItemsView::LocateFocusedItem+0xd3</p>
<p>06c5f62c 671e1e95 06c5f6fc 000004cc 00000000 EXPLORERFRAME!UIItemsView::_ProcessUpdateFocus+0xe</p>
<p>06c5f680 765686ef 0069094e 000004cc 00000000 EXPLORERFRAME!UIItemsView::WndProc+0x48a</p>
<p>06c5f6ac 76568876 74b0bbaa 0069094e 000004cc USER32!InternalCallWinProc+0x23</p>
<p>06c5f724 765643cf 00758334 74b0bbaa 0069094e USER32!UserCallWinProcCheckWow+0x14b</p>
<p>06c5f754 765643f5 ffff0111 0069094e 000004cc USER32!CallWindowProcAorW+0x99</p>
<p>06c5f774 74aa2ab7 ffff0111 0069094e 000004cc USER32!CallWindowProcW+0x1b</p>
<p>06c5f798 765686ef 00000000 000004cc 00000000 DUser!ExtraInfoWndProc+0x76</p>
<p>06c5f7c4 76568876 74aa2a52 0069094e 000004cc USER32!InternalCallWinProc+0x23</p>
<p>06c5f83c 765643cf 00758334 74aa2a52 0069094e USER32!UserCallWinProcCheckWow+0x14b</p>
<p>06c5f86c 765643f5 74aa2a52 0069094e 000004cc USER32!CallWindowProcAorW+0x99</p>
<p>06c5f88c 74d9450e 74aa2a52 0069094e 000004cc USER32!CallWindowProcW+0x1b</p>
<p>06c5f8a8 74d9463d 0069094e 000004cc 00000000 comctl32!CallOriginalWndProc+0x1a</p>
<p>06c5f90c 74d945f1 13c1c978 0069094e 000004cc comctl32!CallNextSubclassProc+0x3d</p>
<p>06c5f930 671f3020 0069094e 000004cc 00000000 comctl32!DefSubclassProc+0x46</p>
<p>06c5f9a4 671f2fad 0069094e 000004cc 00000000 EXPLORERFRAME!UIItemsView::_UIItemsViewSubclassProc+0x2a6</p>
<p>06c5f9c0 74d9463d 0069094e 000004cc 00000000 EXPLORERFRAME!UIItemsView::s_UIItemsViewSubclassProc+0x1c</p>
<p>06c5fa24 74d945f1 13c1c978 0069094e 000004cc comctl32!CallNextSubclassProc+0x3d</p>
<p>06c5fa48 671f33cd 0069094e 000004cc 00000000 comctl32!DefSubclassProc+0x46</p>
<p>06c5fa68 671f3375 0069094e 000004cc 00000000 EXPLORERFRAME!CToolTipManager::_PropertyToolTipSubclassProc+0x12b</p>
<p>06c5fa84 74d9463d 0069094e 000004cc 00000000 EXPLORERFRAME!CToolTipManager::s_PropertyToolTipSubclassProc+0x1c</p>
<p>06c5fae8 74d945f1 13c1c978 0069094e 000004cc comctl32!CallNextSubclassProc+0x3d</p>
<p>06c5fb0c 74d8fa37 0069094e 000004cc 00000000 comctl32!DefSubclassProc+0x46</p>
<p>06c5fb28 74d9463d 0069094e 000004cc 00000000 comctl32!TTSubclassProc+0x59</p>
<p>06c5fb8c 74d946e1 13c1c978 0069094e 000004cc comctl32!CallNextSubclassProc+0x3d</p>
<p>06c5fbec 765686ef 0069094e 000004cc 00000000 comctl32!MasterSubclassProc+0x54</p>
<p>06c5fc18 76568876 74d9469d 0069094e 000004cc USER32!InternalCallWinProc+0x23</p>
<p>06c5fc90 765689b5 00758334 74d9469d 0069094e USER32!UserCallWinProcCheckWow+0x14b</p>
<p>06c5fcf0 76568e9c 74d9469d 00000000 06c5fd44 USER32!DispatchMessageWorker+0x35e</p>
<p>06c5fd00 671b3500 06c5fd18 00000002 00000000 USER32!DispatchMessageW+0xf</p>
<p>06c5fd44 67212081 00000000 00000000 06c5fd6c EXPLORERFRAME!CExplorerFrame::FrameMessagePump+0x495</p>
<p>06c5fd54 672125c5 03a02208 7655817d 03907a60 EXPLORERFRAME!BrowserThreadProc+0x49</p>
<p>06c5fd6c 67212572 03a07bc8 03907a60 06c5fd9c EXPLORERFRAME!BrowserNewThreadProc+0x43</p>
<p>06c5fd7c 671b041e 03907a60 01000000 80000000 EXPLORERFRAME!CExplorerTask::InternalResumeRT+0x11</p>
<p>06c5fd9c 772c618e 03907a74 7fffffff 039e82e8 EXPLORERFRAME!CRunnableTask::Run+0xce</p>
<p>06c5fdb8 772c60f9 06c5fdf4 00000000 00000000 SHELL32!CShellTask::TT_Run+0x167</p>
<p>06c5fe00 772baa98 06c5fe90 771d46bc 039e82e8 SHELL32!CShellTaskThread::ThreadProc+0xa3</p>
<p>06c5fe08 771d46bc 039e82e8 00000000 00000000 SHELL32!CShellTaskThread::s_ThreadProc+0x1b</p>
<p>06c5fe90 76c71194 0016f1b4 06c5fedc 77f1b299 SHLWAPI!WrapperThreadProc+0x1b5</p>
<p>06c5fe9c 77f1b299 0016f1b4 7138b9ec 00000000 kernel32!BaseThreadInitThunk+0xe</p>
<p>06c5fedc 77f1b26c 771d45e9 0016f1b4 00000000 ntdll!__RtlUserThreadStart+0x70</p>
<p>06c5fef4 00000000 771d45e9 0016f1b4 00000000 ntdll!_RtlUserThreadStart+0x1b</p>
<p>SYMBOL_STACK_INDEX: &nbsp;0</p>
<p>SYMBOL_NAME: &nbsp;DUI70!DirectUI::BTreeLookup&lt;HINSTANCE__ *,DirectUI::IClassInfo *&gt;::GetItem+f</p>
<p>FOLLOWUP_NAME: &nbsp;wintriag</p>
<p>MODULE_NAME: DUI70</p>
<p>IMAGE_NAME: &nbsp;DUI70.dll</p>
<p>DEBUG_FLR_IMAGE_TIMESTAMP: &nbsp;4a5bda05</p>
<p>STACK_COMMAND: &nbsp;dt ntdll!LdrpLastDllInitializer BaseDllName ; dt ntdll!LdrpFailureData ; ~22s ; kb</p>
<p>FAILURE_BUCKET_ID: &nbsp;INVALID_POINTER_READ_c0000005_DUI70.dll!DirectUI::BTreeLookup_HINSTANCE___*,DirectUI::IClassInfo_*_::GetItem</p>
<p>BUCKET_ID: &nbsp;APPLICATION_FAULT_INVALID_POINTER_READ_DUI70!DirectUI::BTreeLookup_HINSTANCE___*,DirectUI::IClassInfo_*_::GetItem+f</p>
<p>WATSON_STAGEONE_URL: &nbsp;<a rel="nofollow" target="_new" href="http://watson.microsoft.com/StageOne/Explorer_EXE/6_1_7600_16450/4aeba271/DUI70_dll/6_1_7600_16385/4a5bda05/c0000005/0003852e.htm?Retriage=1" rel="nofollow">watson.microsoft.com/&#8230;/0003852e.htm</a></p>
<p>Followup: wintriag</p>
<p>&#8212;&#8212;&#8212;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990843">
				<div id="div-comment-990843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990843">
			June 11, 2012 at 10:43 pm</a>		</div>

		<p>german Win7 x32 SP1, confirmed</p>
<p>btw: when is SP2 due?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990853">
				<div id="div-comment-990853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Amit</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990853">
			June 12, 2012 at 12:23 am</a>		</div>

		<p>Has anyone actually seen WER dialog find a solution? For me it always says Windows did not find a solution to your problem&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-deiruch even thread-even depth-1" id="comment-990873">
				<div id="div-comment-990873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/deiruch' rel='external nofollow' class='url'>deiruch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990873">
			June 12, 2012 at 2:09 am</a>		</div>

		<p>By the way: Explorer still crashes in Win8 RP when deleting a folder from the Documents library in the treeview.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tspeot-is odd alt thread-odd thread-alt depth-1" id="comment-990883">
				<div id="div-comment-990883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/ta.speot.is' rel='external nofollow' class='url'>ta.speot.is</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990883">
			June 12, 2012 at 3:44 am</a>		</div>

		<p>This just made it onto the front page of Reddit as &quot;One of the biggest lies of Microsoft&quot;: <a rel="nofollow" target="_new" href="http://i.imgur.com/WHdZf.jpg" rel="nofollow">http://i.imgur.com/WHdZf.jpg</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990893">
				<div id="div-comment-990893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990893">
			June 12, 2012 at 7:21 am</a>		</div>

		<p>@Amit: &nbsp;If you read the comments, others have already answered your question. &nbsp;Yes, people have had WER find solutions to their problems. &nbsp;I have too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990903">
				<div id="div-comment-990903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990903">
			June 12, 2012 at 7:23 am</a>		</div>

		<p>I can reproduce the Explorer crash also, IF you start by opening Documents from Libraries as someone else mentioned. &nbsp;Interesting. &nbsp;</p>
<p>Windows 7 x64, SP1.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-990923">
				<div id="div-comment-990923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990923">
			June 12, 2012 at 8:08 am</a>		</div>

		<p>I&#39;ve had the Win7 explorer crash when deleting a directory that is currently open, just like everyone else here is complaining about. &nbsp;Running Win7 x64 SP1 here &#8211; everything up-to-date on Windows Update. &nbsp;I&#39;ve tried to train myself not to delete anything that is open in explorer. &nbsp;If I forget, it seems like 50/50 chance explorer will blow up.</p>
<p>Personally I&#39;m surprised it hasn&#39;t been fixed yet; you&#39;d think there would be a boatload of people at Microsoft who would try to delete a directory that is open and want to see the problem fixed. &nbsp;It&#39;s not like this is a rare crash.</p>
<p>&quot;I&#39;ve reproduced this explorer crash in Win8 RP doing the same steps.&quot;</p>
<p>That&#39;s discouraging. &nbsp;Sheesh&#8230;. maybe&#8230;. cross your fingers&#8230; if we&#39;re lucky, they will fix it in Windows 9!!! &nbsp;Too late to fix it in Win8, and heaven forbid you actually want to see it fixed in Win7. &nbsp;Of course, when it&#39;s fixed, we&#39;ll be dealing with all the new bugs introduced in Win8 for years to come&#8230;</p>
<p>That&#39;s the thing about Windows &#8211; it&#39;s 99% stable these days, but it has 1% of bugs that they never fix yet always affect me somehow, which stand out like really annoying thorns in the backside.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-990963">
				<div id="div-comment-990963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-990963">
			June 12, 2012 at 8:31 am</a>		</div>

		<p>&quot;That&#39;s the thing about Windows &#8211; it&#39;s 99% stable these days, but it has 1% of bugs that they never fix yet always affect me somehow, which stand out like really annoying thorns in the backside.&quot;</p>
<p>So true. Good example: Intellimouse software, which one can install from Windows Update, if you got MS mouse. After its installation, wheel scrolling in IE becomes EXTREMELY fast. This problem was known and existed for a few years since major version 8 of intellimouse (judging by users&#39; complaints on MS forums). The problem is still there in major version 10.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-991073">
				<div id="div-comment-991073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991073">
			June 12, 2012 at 7:59 pm</a>		</div>

		<p>@alegr1 : Confirmed Explorer in Win7 x64 with lastest patch and no custom shell extensions will crash when following these instructions.</p>
<p>From the stack trace it seems like UI bug where the BTree view doesn&#39;t handle the folder delete case well&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-991093">
				<div id="div-comment-991093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anthony Wieser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991093">
			June 12, 2012 at 9:57 pm</a>		</div>

		<p>WER (now sysdev.microsoft.com) is brilliant, but you need to sign up.</p>
<p>Once you do, you upload xml summaries of images of your shipped files, and when the system checks for errors, it will upload a stack trace of the crash for you, that you can download later.</p>
<p>If you figure out a solution or workaround to the problem, you the developer can upload a response file, which is shown to the user as a &quot;solution&quot;. &nbsp;So the reason @Amit and @User{GUID} don&#39;t see any responses is because the developer hasn&#39;t joined up.</p>
<p>You should join. &nbsp;Really you should. &nbsp;You just need to get a Verisign certificate and a notary to certify your business papers, and then you in business.</p>
<p>Disclosure:</p>
<p>I don&#39;t work for Microsoft, and never have, but have found a lot of bugs this way. &nbsp;Our software is configured to email us crash dumps, but most users don&#39;t bother to send them in.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-991113">
				<div id="div-comment-991113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991113">
			June 13, 2012 at 1:08 am</a>		</div>

		<p>Why does Microsoft limit many of their services to Verisign only? There are several other certificate providers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-991163">
				<div id="div-comment-991163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991163">
			June 13, 2012 at 8:04 am</a>		</div>

		<p>@Anthony Wieser: I&#39;ve intercepted the crash readouts for direct injection only to find my debugger can&#39;t use the minidump files to produce usable backtraces. For me, there&#39;s no point in joining so I just don&#39;t care anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-991233">
				<div id="div-comment-991233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991233">
			June 13, 2012 at 9:54 am</a>		</div>

		<p>so reguarding the explorer bug posts. has anyone called MS Support to report this as a bug. It still may not get fixed at least you will get a lot closer to getting it fixed the posting on Raymonds personal blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-991243">
				<div id="div-comment-991243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991243">
			June 13, 2012 at 10:07 am</a>		</div>

		<p>&quot;has anyone called MS Support to report this as a bug.&quot;</p>
<p>I haven&#39;t:</p>
<ol>
<li>&nbsp;They will charge me money before I can even talk to somebody about reporting it. &nbsp;Since my computer came with Windows 7 preinstalled, I am not sure if that is even an option since I didn&#39;t buy the retail version. &nbsp;And I don&#39;t see how I&#39;d even begin to get anywhere with my OEM&#39;s technical support on this &#8211; it&#39;s a Windows problem, not a problem with my computer hardware.</li>
<li>
<p>&nbsp;I will probably have to argue with some clueless outsourced person overseas who is reading a script. &nbsp;It will probably take hours, and the call would have to be elevated to people higher up who have a clue &#8211; if I can convince them to do that.</p>
</li>
<li>
<p>&nbsp;I&#39;ve heard they will refund your money if it turns out to be a bug in the product. &nbsp;But since they start out by charging my credit card, the onus is on me to try to prove that it&#39;s a bug. &nbsp;That could be difficult (see #2) &#8211; plus if they don&#39;t acknowledge it&#39;s a bug, then they get to keep my money.</p>
</li>
</ol>
<p>The system is stacked against me as an individual user; I&#39;m not worth enough money to Microsoft to bother with. &nbsp;Maybe if I was a large company buying thousands of licenses I would have some clout, but I&#39;m not. &nbsp;If I had a more direct line to people at Microsoft who have a clue, I&#39;d be more willing to bother &#8211; but I don&#39;t really know anyone there.</p>
<p>Maybe it won&#39;t be as bad as I think it would be. &nbsp;But it&#39;s often said that a new software feature starts with &quot;-100 points&quot; &#8211; there needs to be enough benefits to justify the cost. &nbsp;Same thing with this issue. &nbsp;It&#39;s annoying, but not annoying enough to make me want to go through all that hassle.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-991273">
				<div id="div-comment-991273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991273">
			June 13, 2012 at 10:57 am</a>		</div>

		<p>I&#39;m pretty Raymond&#39;s article wasn&#39;t titled &quot;Why WER is great and has fixed all crashes in Explorer&quot;. He explained one aspect of it, and if another aspect of it isn&#39;t working that&#39;s not really relevant. Anyway unfixed Explorer bugs reported with it aren&#39;t even WER&#39;s responsibility, it&#39;s up to the Explorer team to look at the data and use it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-991293">
				<div id="div-comment-991293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991293">
			June 13, 2012 at 12:09 pm</a>		</div>

		<p>@JamesJonston:</p>
<p>I&#39;ve been through that (though I used &quot;free&quot; MSDN support cases), and the whole thing is incredibly ineffective and frustrating. Every next support person cannot be bothered to read the case history. And then (in one case) when you talk to yet another guy, they finally find that it&#39;s a known problem (was \tsclient losing connection from a virtual machine when the VM window size is changed).</p>
<p>Another time I was hoping MS would contact the BD-drive vendor and file the bug against them (media state change not detected when BDR-205 is connected to an AHCI controller). As it turns, MS doesn&#39;t have any clout with IHVs. Or don&#39;t care to be an advocates for user that have to convince the IHV that there is a problem. I even had an IO trace (BUSTRACE) for them proving the bug. A reply from the IHV support was &quot;if you&#39;re not satisfied, you may return the product&quot;. Thanks, but no thanks.</p>
<p>And also, how many support cases from users is required before MS will consider fixing a bug? 10? 100?</p>
<p>Is it a surprise I don&#39;t bother anymore?</p>
<div class="post">[<em>Depending on the component, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/08/04/10045651.aspx" rel="nofollow">100 crashes may not be enough</a>. You may have to get it into the hundreds of thousands. Remember, you&#39;re in competition with every other crash in that component. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-991303">
				<div id="div-comment-991303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991303">
			June 13, 2012 at 1:59 pm</a>		</div>

		<p>&quot;The crash information is studied very carefully. In Windows XP, 29% of all crashes were fixed in SP1. (I can&#39;t find statistics on Windows 7.) Sorry your crash was not in that 29%. -Raymond]&quot;&lt;/quote&gt;</p>
<p>Well Ray? Nothing to say? After alegr1 exposed how you can easy do it and all people experienced you went silent for the rest of the comments! Done with thermonuclear comments after you check it on your PC as well?</p>
<div class="post">[<i>Just because it&#39;s easy to do doesn&#39;t mean it&#39;s in the top 29% of all crashes. (A lot of times, I go silent because I queued up an article to discuss the matter further.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-991313">
				<div id="div-comment-991313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991313">
			June 13, 2012 at 2:27 pm</a>		</div>

		<p>[Just because it&#39;s easy to do doesn&#39;t mean it&#39;s in the top 29% of all crashes.]</p>
<p>Each component has its own crashes. This particular problem has been 100% of Explorer crashes I personally experienced. Or is it like &quot;we only fix the buggiest parts&quot;?</p>
<div class="post">[<i>Bug-fixing resources are finite. It sounds like you would focus them on the parts of Explorer that aren&#39;t very buggy. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-991343">
				<div id="div-comment-991343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991343">
			June 13, 2012 at 7:14 pm</a>		</div>

		<p>@alegr1 : Agreed. My MSDN support call experience didn&#39;t go very satisfactory too. That was a UI bug of Excel that&#39;s been floating around for some time. A few workaround has been posted on the web but all of them requires your Office document not be protected by password. So I decided to use my MSDN support incident to see if anything can be done on it. On the case description I clearly stated the workarounds I&#39;ve found and why they won&#39;t work for me, and I just demend that they forward a bug report for me to responsible division in MS (everything in English).</p>
<p>The support person handling this case is speaking Mandarin, but my mother tongue is Cantonese. Okay, my Mandarin is not good but I can live with that&#8230; but he keeps sending me &quot;solutions&quot; that I already stated in the case description that won&#39;t work in attempt to close the case&#8230; In the end I have to tell him to stop&#8230; it&#39;s just a known feature defect and just help me submit the case to the bug database.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-991383">
				<div id="div-comment-991383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991383">
			June 14, 2012 at 3:30 am</a>		</div>

		<p>I don&#39;t always run my development software under a debugger, so when it crashes, I have to wait for WerFault.exe to &quot;process&quot; the crash before I can click Debug, even though I have asked Windows not to report errors from my application&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-991773">
				<div id="div-comment-991773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-991773">
			June 14, 2012 at 4:26 pm</a>		</div>

		<p>WER is not worth the time, it&#39;s a pain to use as a developer. Your resources are better spent fixing bugs randomly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-992263">
				<div id="div-comment-992263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-992263">
			June 15, 2012 at 4:22 pm</a>		</div>

		<p>[It sounds like you would focus them on the parts of Explorer that aren&#39;t very buggy. -Raymond]</p>
<p>In general, that&#39;s often a better idea than it sounds. Getting rid of the last few crash bugs in a much less buggy section may or may not increase the general perception disproportionally becusue tolerance for certain kinds of bugs is lower in components that don&#39;t have many left. Also, very buggy components get replaced with less friction so you are more likely to lose them anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-992423">
				<div id="div-comment-992423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120611-00/?p=7413#comment-992423">
			June 17, 2012 at 9:17 am</a>		</div>

		<p>Anthony: Getting crash dumps can be handy; the last desktop (GUI) app I shipped, I included a last-resort exception handler which would POST the backtrace via HTTP. Not totally reliable of course &#8211; no use with authenticating forced proxies, or of course offline users &#8211; but good enough to gather useful information and fix problems when they arose.</p>
<p>The Verisign-only restriction is a pain (and odd, with no reason ever given that I&#39;ve seen), particularly since until recently it also meant that only certain types of businesses could register at all (no &quot;sole trader&quot; businesses or individuals) but they have finally fixed that, so once I explained to their support rep that Scotland is not actually a part of England, I managed to obtain the certificate in question. (The UK verification agent couldn&#39;t find my lawyer on the list of English lawyers, for a reason some basic geography makes obvious.)</p>
<p>This MS Research paper made interesting reading, with a smattering of statistics too: <a rel="nofollow" target="_new" href="http://research.microsoft.com/pubs/81176/sosp153-glerum-web.pdf" rel="nofollow">research.microsoft.com/&#8230;/sosp153-glerum-web.pdf</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

