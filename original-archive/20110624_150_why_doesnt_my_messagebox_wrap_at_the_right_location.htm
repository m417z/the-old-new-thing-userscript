<html>
<head>
<title>Why doesn't my MessageBox wrap at the right location?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why doesn&#8217;t my MessageBox wrap at the right location?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 24, 2011 / year-entry #151</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>44</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer reported that the MessageBox function was wrapping text "at the wrong location." Our program displays a message with the MessageBox function, and we use the '\n' character to force line breaks at positions we choose. But we've found that starting in Windows Vista, the line breaks we placed are not working. The MessageBox function...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer reported that the <code>MessageBox</code> function was wrapping text "at the wrong location."</p>
<blockquote class="q"><p> Our program displays a message with the <code>MessageBox</code> function, and we use the '\n' character to force line breaks at positions we choose. But we've found that starting in Windows&nbsp;Vista, the line breaks we placed are not working. The <code>MessageBox</code> function is inserting its own line breaks, which interferes with our custom text layout. It used to be that the width of the message box would expand to fit the longest line in the message. </p>
</blockquote>
<p> The <code>MessageBox</code> function is one of those "leave the driving to us" type of functions. You give it a string to display, select which buttons you want, and sit back and relax while the <code>MessageBox</code> function does the work. The trade-off for the simplicity is that you also lose control over the experience. The <code>MessageBox</code> function decides where to place the dialog and how big to make it, which in turn determines where the line breaks go. </p>
<p> The algorithm used by <code>MessageBox</code> to determine the size of the message box has changed many times over the lifetime of Windows. In Windows&nbsp;3.1, it was the width of the longest line, or 5/8 of the width of the screen, whichever was smaller. Windows&nbsp;95 chose the smallest of the following which resulted in a dialog box that fit inside the working area: </p>
<ul>
<li>the width of the longest line, </li>
<li>5/8 of the width of the working area, </li>
<li>3/4 of the width of the working area, </li>
<li>7/8 of the width of the working area, </li>
</ul>
<p> Notice that even in Windows&nbsp;XP, the dialog box was not guaranteed to be the width of the longest line. If the longest line was more than 5/8 of the width of the working area, the <code>MessageBox</code> is probably going to insert its own line breaks beyond ones you inserted explicitly. </p>
<p> Windows&nbsp;Vista changed the algorithm again, in recognition of two things. First, monitors are now much larger than they were in 1995. And second, the consequence of these larger monitors is that the 7/8 rule resulted in message boxes that were unreadable because they were 10 inches wide and half an inch tall. The old algorithm did not age well, but then again, it was written back in the days when the really cool kids had 1024&times;768 screens. Nowadays, even the kids from the wrong side of the tracks have screens that are regularly 1400 or even 1600 pixels wide. </p>
<p> The new algorithm merely adds another option to the table of choices: </p>
<ul>
<li>the width of the longest line, </li>
<li>278 DLU, </li>
<li>5/8 of the width of the working area, </li>
<li>3/4 of the width of the working area, </li>
<li>7/8 of the width of the working area, </li>
</ul>
<p> Note that the details of the <code>MessageBox</code> line breaking algorithm are provided for historical purposes only. Do not write code which relies on them, because who knows, they may change again in the next version of Windows. </p>
<p> The algorithm was changed at the request of the visual design team; after all, it's the job of the visual design team to make these sorts of visual design decisions. If you don't want some black-turtleneck-wearing designer in Redmond to decide where your line breaks go, then don't use <code>MessageBox</code>. And you don't have to go and convert every single message box to its own dialog template; just write a function called <code>MessageBoxWithLineBreaksExactlyWhereIPutThem</code> function that takes the same parameters as <code>MessageBox</code> but lays out the text exactly the way you want it. (The <code>DT_CALCRECT</code> flag will be useful here.) </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (44)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-921213">
				<div id="div-comment-921213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wyatt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921213">
			June 24, 2011 at 7:04 am</a>		</div>

		<p>Wouldn&#39;t &quot;5/8 of the width of the working area&quot; always be smaller than &quot;3/4 of the width of the working area&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921223">
				<div id="div-comment-921223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921223">
			June 24, 2011 at 7:12 am</a>		</div>

		<p>Not if the working area is negative :)</p>
<p>Actually I am equally confused. &nbsp;The only thing I can think of is a different definition of &quot;smallest,&quot; for example the smallest area [width x height] instead of smallest width.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921233">
				<div id="div-comment-921233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921233">
			June 24, 2011 at 7:17 am</a>		</div>

		<p>Raymond says &quot;fit inside the working area&quot;, so I would surmise that this means that the lesser widths might result in messageboxes whose height might overflow the working area. If that happens, try one step wider&#8230; I dread to think what kind of monstrous message people can come up with that would overflow the working area on my 1920&#215;1080 monitors even at 7/8 width. It&#39;ll probably happen next Thursday.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921243">
				<div id="div-comment-921243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul M. Parks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921243">
			June 24, 2011 at 7:17 am</a>		</div>

		<p>And please, please implement the CTRL-C feature correctly if you write your own message box.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921253">
				<div id="div-comment-921253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921253">
			June 24, 2011 at 7:18 am</a>		</div>

		<p>@Wyatt: &quot;which resulted in a dialog box that fit inside the working area:&quot;. If you make it 5/8th the width of the working area, and that forces the height larger than the working area, it doesn&#39;t fit inside the working area.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-joshuaganes odd alt thread-odd thread-alt depth-1" id="comment-921263">
				<div id="div-comment-921263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Joshua+Ganes' rel='external nofollow' class='url'>Joshua Ganes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921263">
			June 24, 2011 at 7:50 am</a>		</div>

		<p>@Damien: Thanks for the clarification on Wyatt&#39;s question. I was wondering the same thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921273">
				<div id="div-comment-921273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skyborne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921273">
			June 24, 2011 at 8:23 am</a>		</div>

		<p>DLU = Dialog Units, which are based on the size of the font, and thus resolution-independent. &nbsp;Theoretically, anyway; a web search about DLU mostly finds lots of people trying to convert them to &quot;pixels,&quot; and that way lies madness or heartbreak.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921283">
				<div id="div-comment-921283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921283">
			June 24, 2011 at 8:32 am</a>		</div>

		<p>@Steven, Damien</p>
<p>But doesn&#39;t that logic fly in the face of his statement: &quot;And second, the consequence of these larger monitors is that the 7/8 rule resulted in message boxes that were unreadable because they were 10 inches wide and half an inch tall.&quot;, unless he is referring to some sort of bizarre monitor that is only 1&quot; tall and 11+&quot; wide.</p>
<div class="post">[<i>Fine, you caught me out on the math. 5/8 is smaller than 7/8. I shouldn&#39;t have been so specific and just have written &quot;the old rule&quot;. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921293">
				<div id="div-comment-921293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921293">
			June 24, 2011 at 8:47 am</a>		</div>

		<p>I&#39;ve found this new behavior in Vista to be rather annoying when displaying stack trace message boxes. &nbsp;Our stack trace lines look like &quot;0x12345678 FunctionName+0x124 [C:pathtosourcefile.cpp:1234+0x12]&quot;, which almost always produces lines longer than 278 DLU, resulting in really ugly line wrapping. &nbsp;Yes, we _could* implement MessageBoxWithLineBreaksExactlyWhereIPutThem, but doing so is non-trivial, and it takes comparatively less effort to copy the message box text into a text editor such as Notepad to view the stack trace sensibly. &nbsp;Developers have the -100 points rule, too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921303">
				<div id="div-comment-921303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Vesper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921303">
			June 24, 2011 at 8:55 am</a>		</div>

		<p>&#39;black-turtleneck-wearing designer in Redmond&quot; &#8211; I love it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921323">
				<div id="div-comment-921323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921323">
			June 24, 2011 at 9:28 am</a>		</div>

		<p>MessageBox always has a default font (size), how many pixels is 278 DLU in Vista/7 then? Usually about 2x if I remember correct.</p>
<p>@Adam Rosenfield: The problem is sadly common. MessageBox doesn&#39;t even display at all if you try to display &quot;too much&quot; text. And .net&#39;s default exception dialog is actually worse, cannot read it&#39;s text without copying to notepad.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921333">
				<div id="div-comment-921333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921333">
			June 24, 2011 at 9:34 am</a>		</div>

		<p>So, if I understand correctly, a line break is suppressed if keeping it would overflow the height. If so, are only some breaks removed while others are retained or are all line breaks ignored and everything is reformatted? If it&#39;s the former, it&#39;s confusing to the developers and should be consistent. If it&#39;s the latter, &quot;the longest line&quot; loses its meaning, so I suspect that&#39;s not it.</p>
<div class="post">[<i>This is all implementation detail, so you shouldn&#39;t be taking a dependency on it anyway. (If you&#39;re just curious, then you&#39;re thinking about it wrong. Take a closer look at the algorithm. Line breaks are not considered on a case-by-case basis.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921343">
				<div id="div-comment-921343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Ching</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921343">
			June 24, 2011 at 10:40 am</a>		</div>

		<p>@Adam Rosenfield &#8211; I agree, there are many behaviors of MessageBox (for example, selecting which buttons we want at the bottom, the MB_SETFOREGROUND flag, etc.) that would require significant effort to emulate.</p>
<p>@Raymond &#8211; If the turtleneck dudes and dudettes are going to cause such an issue by changing the algorithm, then the solution is NOT to say, &quot;Just don&#39;t use it.&quot; &nbsp;The solution is to offer a MessageBoxEx which offers more control of the dialog size, the line break points, whether or not a vertical scrollbar is included, etc.</p>
<div class="post">[<i>It is <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/03/21/1922203.aspx" rel="nofollow">outside the charter of MessageBox</a> to be a &quot;fully customizable text dialog display engine.&quot; <a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/04/17/9553626.aspx" rel="nofollow">Feature creep turns a simple function into a complex one whose original purpose was to be simple</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921363">
				<div id="div-comment-921363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Ching</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921363">
			June 24, 2011 at 11:31 am</a>		</div>

		<p>@Raymond &#8211; I accept what you say is the original charter of MessageBox. That has nothing to do with the charter of a new function, MessageBoxEx. Which is required due to the actions of the turtlenecks. It is in the interest of the Windows team to offer it so that Windows apps do not display crappy looking message boxes. This elevates the elegance of the entire Windows ecosystem. &nbsp;The same way that Task Dialogs do.</p>
<div class="post">[<i>Um, when you called MessageBox, you were already handing control over to the turtlenecks. You shouldn&#39;t complain that the turtlenecks decided to do something you said they could do. And remember, minus 100 points. And as you noted, there&#39;s already an &quot;updated, more flexible MessageBox&quot; &#8211; TaskDialog. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921373">
				<div id="div-comment-921373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921373">
			June 24, 2011 at 12:31 pm</a>		</div>

		<blockquote><p>
  Why doesn&#39;t my MessageBox wrap at the right location?
</p></blockquote>
<p>Because you are using the wrong OS. Use XP, all will be fine.</p>
<p>It turns out Vista (again) broke compatibility with totally fine functionality, and Raymond says don&#39;t use the function (or &#39;Windows&#39; for that matter) if you don&#39;t like it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921383">
				<div id="div-comment-921383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921383">
			June 24, 2011 at 12:47 pm</a>		</div>

		<p>Burak, I still think XP is better than Vista or 7, but you have to admit that in XP message boxes with a lot of text do look terrible on widescreen monitors. How would you have fixed the problem?</p>
<p>And on a separate issue, I think that in most cases the advice to code your own message box is bad. It will probably be worse than the system supplied one and will probably look out of place on the next version of Windows. Better advice would be: live with it, or do something about your idiotically long lines.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921393">
				<div id="div-comment-921393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ERock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921393">
			June 24, 2011 at 12:49 pm</a>		</div>

		<p>@David Ching: we know what happens when you trust developers to do the right thing. It makes sense from a UX standpoint that for simple message boxes, you use the programmed behavior that everyone else is going to use. Unless your message box layout is so brilliant that it has to be spaced in just such a perfect way, it&#39;s just going to annoy the user who isn&#39;t going to read it anyway but will notice it&#39;s odd.</p>
<p>Besides, if you wanna give it a go anyway, you can make your window look like anything you want, just gotta code it. You can ignore those convenience functions all you want if they stop being convenient for you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-921403">
				<div id="div-comment-921403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921403">
			June 24, 2011 at 1:47 pm</a>		</div>

		<p>I was actually curious myself of how MessageBox was changing over the years as I upgraded from one version of Windows to the next.</p>
<p>However, I was one of those who didn&#39;t care as long as it looked reasonable and remained simple. &nbsp;I&#39;m in the minority, it seems.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921413">
				<div id="div-comment-921413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">coldacid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921413">
			June 24, 2011 at 3:44 pm</a>		</div>

		<p>@JamesNT: More likely you (and I) are in the majority, but because we&#39;re not annoyed by it, we don&#39;t make any noise about it. Squeaky wheel gets the grease and all that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921443">
				<div id="div-comment-921443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JustSomeGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921443">
			June 24, 2011 at 6:09 pm</a>		</div>

		<p>I&#39;m all for readable function names but even I think that &quot;MessageBoxWithLineBreaksExactlyWhereIPutThem&quot; might be a tad on the verbose side :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921453">
				<div id="div-comment-921453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gideon7</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921453">
			June 24, 2011 at 7:18 pm</a>		</div>

		<p>TaskDialog has a similar problem. &nbsp;What&#39;s worse is that instead of wrapping a long string such as a file path, it outright truncates it.</p>
<p>The workaround is to use the undocumented flag TDIF_SIZE_TO_CONTENT. &nbsp;See <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/bb787473.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/bb787473.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921423">
				<div id="div-comment-921423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921423">
			June 24, 2011 at 3:55 pm</a>		</div>

		<p>So in the end, does this new MessageBox behavior *remove* any pre-set linebreaks? I would have said &quot;of course no&quot;, but Raymond did not renounce the &quot;line breaks we placed are not working&quot; part specifically&#8230; although his explanations kinda suggest only additional splitting takes place.</p>
<p>(If this comment is a duplicate please just kill it)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921463">
				<div id="div-comment-921463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zilla</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921463">
			June 25, 2011 at 2:13 am</a>		</div>

		<p>Uhh Gideon,</p>
<p>It&#39;s right there in MSDN on the link you provided. Looks pretty well documented being on MSDN and all. (shrug)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921473">
				<div id="div-comment-921473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921473">
			June 25, 2011 at 3:16 am</a>		</div>

		<p>I thought you did &quot;rn&quot; to force MessageBox to linebreak, not n (which just uglified things, if it did anything &#8211; last time I tried it didn&#39;t&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921483">
				<div id="div-comment-921483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921483">
			June 25, 2011 at 6:35 am</a>		</div>

		<p>@Gideon7: I&#39;ve rarely seen someone link to msdn as proof for undocumented behavior and you&#39;re even right which makes it much more funny at that.</p>
<p>@Zilla: To quote msdn: &quot;Note: This flag may not be supported in future versions of Comctl32.dll. Also, this flag is not defined in commctrl.h&quot;</p>
<p>But then as proud readers of this blog, I think we can all agree that the chances of removal of that flag are slim to none ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921493">
				<div id="div-comment-921493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921493">
			June 25, 2011 at 8:17 am</a>		</div>

		<p>The reason for calling MessageBox is often to display emergency messages (with backtrace!) when the managed windowing system has blown up.</p>
<p>Do you <em>really</em> think it&#39;s a good idea to have every managed application developer write his own native dialog box to solve that problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921503">
				<div id="div-comment-921503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zilla</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921503">
			June 25, 2011 at 8:48 am</a>		</div>

		<p>@voo</p>
<p>I disagree, it&#39;s clearly documented. Not being in a header doesn&#39;t equate to it not being documented. It&#39;s in msdn, telling you what it does and why you probably don&#39;t want to use it. So it&#39;s clearly documented. The terms of the contract are there in black and white.</p>
<p>That said, this whole discussion begs the question. What the heck are some of these developers trying to display with messagebox? It&#39;s designed for messages, not narratives and dialogs. If my text was being truncated, or wrapped oddly. The first thing that would come to my mind is that maybe I am trying to show more data than this paradigm is meant to represent.</p>
<p>If the shell team can manage most of it&#39;s message based user interaction in a way that uses these paradigms, then I would say it works as designed. If it doesn&#39;t work for you, maybe you should rethink what it is you&#39;re trying to convey to the user. If you can&#39;t get the point across in short sentence or two, these functions are not what you should be using. DialogBox would probably be a better fit.</p>
<p>Maybe that&#39;s why it appears not too many devs are upset about this, they apparently &quot;got&quot; the implicit paradigm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921513">
				<div id="div-comment-921513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Ching</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921513">
			June 25, 2011 at 10:13 am</a>		</div>

		<p>@Zilla: When you think about it, the text in all these blog comments is like what is shown in a message box. &nbsp;If you notice, most of the comments are separated into paragraphs, with a blank line between paragraphs. &nbsp;That&#39;s how I format my message boxes. &nbsp;And that&#39;s why I&#39;m irate if Windows doesn&#39;t preserve my paragraphs. &nbsp;Same as you would probably be irate if your comment got formatted all in one gigantic paragraph.</p>
<p>The reason most devs don&#39;t get visibly upset about this is not that they aren&#39;t irate. &nbsp;It&#39;s because it is a breakage of backwards compatibility that gets tossed into the &quot;cosmetic&quot; bin, and those bugs are infinitely deferred. &nbsp;We&#39;re too busy fighting compatibility issues with UAC, x64, and the latest ATL Security Update hotfix to even remember these, so kudos to Raymond for at least bringing the topic up.</p>
<p>@Raymond: &nbsp;TaskDialog is not a replacement for better laid out message boxes, it was an example of how MS chooses to invest to imrpove the UI of Windows apps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921523">
				<div id="div-comment-921523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921523">
			June 25, 2011 at 10:32 am</a>		</div>

		<p>@Zilla Yeah ok, I interpreted documented in this situation as &quot;supported&quot;, because that&#39;s pretty much what it needs to be to make a feature really useful for a long term project. Sure it&#39;ll work now, but without any guarantees that it won&#39;t stop working with the next SP that&#39;s not especially helpful &#8211; at least I don&#39;t see many situations where it&#39;d be.</p>
<p>Actually I&#39;m not sure what the hell this note has to do in the official documentation &#8211; after all it pretty much encourages Raymond&#39;s recurring nightmare scenario (people using unsupported features). Did someone just want to be extra dev friendly and this is an rare exception or is this behavior sanctioned from above; never seen such a note before in the documentation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921533">
				<div id="div-comment-921533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zilla</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921533">
			June 25, 2011 at 1:47 pm</a>		</div>

		<p>@voo</p>
<p>I think whoever documented that particular API was probably of the following mindset.</p>
<p>If we don&#39;t document it, someone will figure it out and cry that once again MS is not fully exposing their API&#39;s.</p>
<p>Or</p>
<p>They don&#39;t document it, people figure it out, use it. MS pulls it next service pack and people cry WTF!</p>
<p>Or lastly</p>
<p>Document it, so when and if they do remove that flag MS can simply say that they warned you not to use it anyway.</p>
<p>Just my two cents, it&#39;s a damned if you do, damned if you don&#39;t scenario.</p>
<p>@David</p>
<p>Messagebox isn&#39;t meant to display large amounts of formatted data. So while I get your point, I just don&#39;t think messagebox should be used for that. It&#39;s a UI nightmare, large amount of really important data in a messagebox. User accidentally presses OK, then what? No way to go back and see your really important formatted message.</p>
<p>We&#39;ll have to agree to disagree on this one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921543">
				<div id="div-comment-921543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Silly Billy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921543">
			June 25, 2011 at 8:28 pm</a>		</div>

		<p>Is it possible to modify the window / template used by MessageBox before it goes modal?</p>
<p>Sometimes I want a message box with a label+combobox in the top left corner. And pink text.</p>
<p>Maybe with a thread and a hook?</p>
<p>hehe.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-921553">
				<div id="div-comment-921553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921553">
			June 26, 2011 at 12:43 pm</a>		</div>

		<p>@Chris Charabaruk: &nbsp;Agreed. &nbsp;It&#39;s amazing how much noise 10% of the population can make.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921563">
				<div id="div-comment-921563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921563">
			June 26, 2011 at 2:40 pm</a>		</div>

		<p>@Silly Billy: You can do something similar, and it&#39;s been supported for almost 25 years now. It&#39;s called &quot;DialogBox()&quot; (or DialogBoxIndirect() if you are constructing it dynamically.) It&#39;s wonderful! You can even put buttons and text anywhere you like! No needles and thread required. ;-)</p>
<p>Really, if you are needing to show so much text that you are running up against the formatting restrictions of MessageBox, may I suggest using a dialog box with an edit control instead (or rich text control, if you like)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921583">
				<div id="div-comment-921583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gomer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921583">
			June 27, 2011 at 1:23 am</a>		</div>

		<p>I searched for MessageBoxWithLineBreaksExactlyWhereIPutThem() in MSDN but cannot find it. &nbsp;Google gives me only this page or copies of it. &nbsp;If I try to use it I get compiler error.</p>
<p>How to use this function?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921593">
				<div id="div-comment-921593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921593">
			June 27, 2011 at 4:39 am</a>		</div>

		<p>I must confess to making my own reimplementation of MessageBox over fifteen years ago. Back then I just hardcoded the DrawText default width to 420 pixels, which was then converted to dialog units, and 17 added, to give the final dialog width, unless the dialog had a long caption, or the buttons were wider than the text, in which case it was widened appropriately.</p>
<p>My best guess as to why I did this was that I wanted to create the message box with a custom dialog class that drew a 3-D border (in a similar manner to CTL3D.DLL).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921623">
				<div id="div-comment-921623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bulletmagnet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921623">
			June 27, 2011 at 8:11 am</a>		</div>

		<p>&quot;black-turtleneck-wearing designer in Redmond&quot; &#8211; I thought they all worked at Cupertino</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921643">
				<div id="div-comment-921643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921643">
			June 27, 2011 at 9:45 am</a>		</div>

		<p>It looks like my comment from Friday was eaten, so I&#39;ll try again. Long story short, <a href="http://msdn.microsoft.com/en-us/library/ms645505%28v=vs.85%29.aspx" target="_new" rel="nofollow">msdn.microsoft.com/&#8230;/ms645505%28v=vs.85%29.aspx</a> says &quot;If the string consists of more than one line, you can separate the lines using a carriage return and/or linefeed character between each line.&quot; So my question above is, &quot;is this false? Is it only sometimes true? If so, when?&quot;</p>
<div class="post">[<i>Both statements are true. There is no contradiction here. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921663">
				<div id="div-comment-921663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921663">
			June 27, 2011 at 10:16 am</a>		</div>

		<p>@Raymond,</p>
<p>I am not sure what you are referring to when you say &quot;both statements&quot;, but if you mean that your post does not contradict the MSDN article then I don&#39;t get it. In your post you imply that line breaks are (sometimes?) ignored when inserted into the text passed to the MessageBox function. Or do you mean that explicit line breaks are still honored and it is only the implicit line breaks that have changed? If so, I, of course, have no problem with this.</p>
<div class="post">[<i>I don&#39;t believe I wrote that MessageBox ever deleted explicitly-inserted line breaks. &quot;The MessageBox function is inserting its own line breaks.&quot; Nobody ever complained &quot;The MessageBox function is deleting line breaks.&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921683">
				<div id="div-comment-921683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil (SM)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921683">
			June 27, 2011 at 11:54 am</a>		</div>

		<p>&quot;The line breaks we placed are not working&quot; seems to imply that the MessageBox function is ignoring line-breaks. Hence the confusion.</p>
<div class="post">[<i>The next sentence explains what they meant by &quot;not working&quot;. You have to read sentences in context. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921693">
				<div id="div-comment-921693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921693">
			June 27, 2011 at 11:39 pm</a>		</div>

		<p>@Bulletmagnet: &quot;black-turtleneck-wearing designer in Redmond&quot; &#8211; I thought they all worked at Cupertino</p>
<p>Yet another thing m$ has copied.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921783">
				<div id="div-comment-921783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921783">
			June 28, 2011 at 7:36 am</a>		</div>

		<p>@Zilla: &nbsp;&quot;Begs the question&quot; doesn&#39;t mean what you think it means. &nbsp;We programmers deal in particulars and nit-picky things; otherwise I wouldn&#39;t have pointed that out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921823">
				<div id="div-comment-921823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zilla</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-921823">
			June 28, 2011 at 9:42 am</a>		</div>

		<p>@David</p>
<p>Indeed you&#39;re right</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-922003">
				<div id="div-comment-922003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-922003">
			June 29, 2011 at 8:01 am</a>		</div>

		<p>Some people don&#39;t have the option to use anything but a MessageBox. If you&#39;re popping up an alert in JavaScript in IE, you&#39;re pretty much beholden to the vagaries of the MessageBox.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcohn odd alt thread-odd thread-alt depth-1" id="comment-922063">
				<div id="div-comment-922063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110624-00/?p=10343#comment-922063">
			June 29, 2011 at 11:32 am</a>		</div>

		<p>@Adam Rosenfeld: you may simply use <a rel="nofollow" target="_new" href="http://www.codeproject.com/KB/dialog/xmessagebox.aspx" rel="nofollow">http://www.codeproject.com/&#8230;/xmessagebox.aspx</a>, or some similar project</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

