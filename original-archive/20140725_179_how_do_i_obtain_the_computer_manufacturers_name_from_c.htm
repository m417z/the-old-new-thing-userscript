<html>
<head>
<title>How do I obtain the computer manufacturer's name from C++?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I obtain the computer manufacturer&#8217;s name from C++?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>July 25, 2014 / year-entry #180</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>14</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Some time ago, I gave a scripting solution to the problem of obtaining the computer manufacturer and model. But what if you want to do this from C++? I could translate the script into C++, or I could just point you to Creating a WMI Application Using C++ in MSDN. In particular, one of the...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p> Some time ago, I gave <a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/12/18/9233149.aspx"> a scripting solution to the problem of obtaining the computer manufacturer and model</a>. But what if you want to do this from C++? </p>
<p> I could translate the script into C++, or I could just point you to <a href="http://msdn.microsoft.com/library/windows/desktop/aa389762"> Creating a WMI Application Using C++</a> in MSDN. In particular, one of the <a href="http://msdn.microsoft.com/library/windows/desktop/aa394558"> WMI C++ Sample Applications</a> does exactly what you want: <a href="http://msdn.microsoft.com/library/windows/desktop/aa390418"> Example: Creating a WMI Application</a>. The only things you need to do are </p>
<ul>
<li>change <code>SELECT * FROM Win32_Process</code> to            <code>SELECT * FROM Win32_ComputerSystem</code>, and </li>
<li>change <code>Name</code> to <code>Manufacturer</code>,     and then again to <code>Model</code>. </li>
</ul>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1141183">
				<div id="div-comment-1141183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">*</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141183">
			July 25, 2014 at 7:28 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://michaeljswart.com/wp-content/uploads/2014/03/protestor.png">michaeljswart.com/&#8230;/protestor.png</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141193">
				<div id="div-comment-1141193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141193">
			July 25, 2014 at 8:43 am</a>		</div>

		<p>One of these days you&#39;re going to get a followup question that goes &quot;&#8230; when WMI services is not running&quot;. Not that this particular question is of all that much value so that it would be reasonable to have to worry about it, but I&#39;ve seen some where it would make sense.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141203">
				<div id="div-comment-1141203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141203">
			July 25, 2014 at 9:09 am</a>		</div>

		<p>Why is this stuff not queryable with a regular API?</p>
<div class="post">[<em>Not sure what make WMI not a &quot;regular API&quot;. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mngoldeneagle odd alt thread-odd thread-alt depth-1" id="comment-1141213">
				<div id="div-comment-1141213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141213">
			July 25, 2014 at 9:40 am</a>		</div>

		<p>@Koro: Define regular API? &nbsp;If you mean regular SQL using SQL connections, that would be because this isn&#39;t meant to be a standard SQL database. &nbsp;It uses similar querying syntax, but that&#39;s just an implementation detail. &nbsp;If you mean using API functions similar to most of the rest of Win32, it&#39;s because this was developed to satisfy the CIM open standard and is similar in design to the CIM Query Language.</p>
<p>If your question is why not both? &nbsp;Then the answer probably is, &quot;why both?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hikari even thread-even depth-1" id="comment-1141243">
				<div id="div-comment-1141243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Crowther' rel='external nofollow' class='url'>Chris Crowther</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141243">
			July 25, 2014 at 10:42 pm</a>		</div>

		<p>@MNGoldenEagle I suspect because, as Joshua noted, you can stop the WMI service. &nbsp;There is data in the registry, of course, in the HKEY_LOCAL_MACHINEHARDWAREDESCRIPTIONSystemBIOSSystem* keys. &nbsp;I wouldn&#39;t be at all surprised if that&#39;s where WMI got the data from in the first place. &nbsp;Mind you I wouldn&#39;t be surprised if it wasn&#39;t either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141283">
				<div id="div-comment-1141283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141283">
			July 26, 2014 at 2:13 pm</a>		</div>

		<p>@Koro:</p>
<p>By &quot;Regular API&quot; do you mean</p>
<p> &nbsp;<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724379(v=vs.85).aspx">msdn.microsoft.com/&#8230;/ms724379(v=vs.85).aspx</a></p>
<p> and</p>
<p> &nbsp;<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724259(v=vs.85).aspx">msdn.microsoft.com/&#8230;/ms724259(v=vs.85).aspx</a></p>
<p>Microsoft also has a White Paper on how Windows provides a solution to this post&#39;s problem:</p>
<p><a rel="nofollow" target="_new" href="http://download.microsoft.com/download/5/D/6/5D6EAF2B-7DDF-476B-93DC-7CF0072878E6/SMBIOS.doc">download.microsoft.com/&#8230;/SMBIOS.doc</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1141253">
				<div id="div-comment-1141253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141253">
			July 26, 2014 at 8:32 am</a>		</div>

		<p>@Koro:</p>
<p>Because WMI *API* allows you to implement your own providers and classes (such as CPU temperatures, etc) to query, without having to add new functions and interfaces to API. WMI also allows you to query this information from a remote machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141293">
				<div id="div-comment-1141293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141293">
			July 27, 2014 at 1:17 am</a>		</div>

		<p>I imagine that a regular API is one that doesn&#39;t require you to pass in ascii, although a completely SQL based operating system (GetMessage, TranslateMessage etc) would be interesting.</p>
<div class="post">[<em>Not sure what you&#39;re after. The WMI interface is all-Unicode. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141373">
				<div id="div-comment-1141373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141373">
			July 28, 2014 at 2:46 pm</a>		</div>

		<p>[Not sure what you&#39;re after. The WMI interface is all-Unicode. -Raymond]</p>
<p>Are you being deliberately obtuse?</p>
<div class="post">[<em>No. But apparently I am inadvertently obtuse. I was responding to the speculation that a &quot;regular API is one that doesn&#39;t require you to pass in ascii&quot;, and the WMI interface satisfies that criterion. Perhaps your definition of &quot;regular API&quot; is something else? (E.g. &quot;Something easier to use than WMI, where I just call &#39;GetManufacturerName&#39; and out comes the manufacturer name for the local computer.&quot;) -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141383">
				<div id="div-comment-1141383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141383">
			July 28, 2014 at 5:08 pm</a>		</div>

		<p>While I have a complaint about WMI it&#39;s not about the API and not for discussion today.</p>
<p>smf doesn&#39;t like passing in pseudo-SQL.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141393">
				<div id="div-comment-1141393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141393">
			July 28, 2014 at 5:08 pm</a>		</div>

		<p>While I have a complaint about WMI it&#39;s not about the API and not for discussion today.</p>
<p>smf doesn&#39;t like passing in pseudo-SQL.</p>
<div class="post">[<em>Okay, that&#39;s totally not the read I got at all. smf seemed intrigued by pseudo-SQL (&quot;would be interesting&quot;). -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141413">
				<div id="div-comment-1141413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">T. West</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141413">
			July 28, 2014 at 6:21 pm</a>		</div>

		<p>Have to say that my read of the question was identical to Raymond&#39;s. &nbsp;&quot;Pass in pseudo-SQL commands&quot; would have given me the idea. &nbsp;&quot;Pass in ASCII&quot; means ASCII vs. Unicode to my mind.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141423">
				<div id="div-comment-1141423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141423">
			July 28, 2014 at 9:38 pm</a>		</div>

		<p>Remember, smf is just speculating about what a &quot;regular API&quot; is. And I&#39;m speculating that smf is speculating that it means an API that doesn&#39;t involve composing strings.</p>
<p>Most other APIs use flags or enumerated types to define what data is being queried. Presumably something like FindFirstFile or getaddrinfo are &quot;regular&quot; APIs. Clearly those are a very different style of API than IWbemServices::ExecQuery.</p>
<div class="post">[<em>Okay, now I see. s/ASCII/strings/. WMI is extensible, which means you need some way to add support for something after the API was written. This rules out flags and enumerations, since there will be no definition for your new thing. You would have to use GUIDs or strings, and strings are much more readable (and scriptable). -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141573">
				<div id="div-comment-1141573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ErikF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140725-00/?p=403#comment-1141573">
			July 29, 2014 at 9:21 pm</a>		</div>

		<p>I recall that MCI used a string-based command language in addition to a binary API (it certainly made testing easy!) So the fact that an API uses human-readable commands is not new, and makes sense in the context of an extensible system that might be scripted. My guess is that the main objection is performance-based, but I have to wonder what program would even notice the performance difference? You&#39;d have to call WMI functions thousands of times a second before it would become an issue!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

