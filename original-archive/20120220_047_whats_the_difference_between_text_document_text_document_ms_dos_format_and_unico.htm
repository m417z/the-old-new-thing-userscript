<html>
<head>
<title>What's the difference between Text Document, Text Document - MS-DOS Format, and Unicode Text Document?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>What&#8217;s the difference between Text Document, Text Document &#8211; MS-DOS Format, and Unicode Text Document?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>February 20, 2012 / year-entry #48</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>16</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Alasdair King asks why Wordpad has three formats, Text Document, Text Document - MS-DOS Format, and Unicode Text Document. "Isn't at least one redundant?" Recall that in Windows, three code pages have special status. Unicode (more specifically, UTF-16LE) CP_ACP, commonly known as the ANSI code page, although that is a misnomer CP_OEM, commonly known as the...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Alasdair King asks why Wordpad has three formats, <i>Text Document</i>, <i>Text Document&nbsp;- MS-DOS Format</i>, and <i>Unicode Text Document</i>. "<a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/20/10040074.aspx#10042552">Isn't at least one redundant?</a>"</p>
<p> Recall that in Windows, three code pages have special status. </p>
<ol>
<li>Unicode (more specifically, UTF-16LE) </li>
<li>     <code>CP_ACP</code>,     commonly known as the ANSI code page,     although     <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/05/31/144893.aspx">     that is a misnomer</a> </li>
<li><code>CP_OEM</code>,     commonly known as the OEM code page,     although     <a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/08/29/457483.aspx">     that too is a misnomer</a>. </li>
</ol>
<p> Three text file formats. Three encodings. Hm... I wonder... </p>
<p> As you might have guessed by now, the three text file formats correspond to the three special code pages. Now it's just a matter of deciding which one matches with which. The easiest one is the Unicode one; it seems clear that <i>Unicode Text Document</i> matches with Unicode. Okay, we now have to figure out how <i>Text Document</i> and <i>Text Document&nbsp;- MS-DOS Format</i> map to <code>CP_ACP</code> and <code>CP_OEM</code>. But another piece of the puzzle is pretty clear, because <a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/08/29/457483.aspx"> MS-DOS used the so-called OEM code page</a>. Therefore, by process of elimination, <i>Text Document</i> corresponds to <code>CP_ACP</code>. </p>
<p> Now that we have puzzled out what the three text formats correspond to, we can address the question "Isn't at least one redundant?" </p>
<p> <a href="http://blogs.msdn.com/b/michkap/"> Michael Kaplan</a> explained that <a href="http://blogs.msdn.com/b/michkap/archive/2005/02/08/369197.aspx"> ACP and OEM are (usually) different</a>. And neither is the same as Unicode. So in fact all three are (usually) different. </p>
<p> In the United States, the so-called ANSI code page is <a href="http://msdn.microsoft.com/goglobal/cc305145.aspx"> code page 1252</a>, the so-called OEM code page is <a href="http://msdn.microsoft.com/goglobal/cc305156.aspx"> code page 437</a>, and Unicode is code page 1200. Here's the string <tt>r&eacute;sum&eacute;</tt> expressed in each of the three encodings. </p>
<table border="1" bordercolor="black" style="border-collapse: collapse" cellpadding="3">
<tr>
<th valign="baseline">Description</th>
<th valign="baseline">Encoding</th>
<th valign="baseline">Code page<br>(en-us)</th>
<th valign="baseline">Bytes</th>
</tr>
<tr>
<td valign="baseline">Text Document</td>
<td valign="baseline">CP_ACP</td>
<td valign="baseline" align="right">1252</td>
<td valign="baseline"><tt>72 E9 73 75 6D E9</tt></td>
</tr>
<tr>
<td valign="baseline">Text Document&nbsp;- MS-DOS Format</td>
<td valign="baseline">CP_OEM</td>
<td valign="baseline" align="right">437</td>
<td valign="baseline"><tt>72 82 73 75 6D 82</tt></td>
</tr>
<tr>
<td valign="baseline">Unicode Text Document</td>
<td valign="baseline">UTF-16LE</td>
<td valign="baseline" align="right">1200</td>
<td valign="baseline"><tt>FF FE 72 00 E9 00 73 00<br>                             75 00 6D 00 E9 00</tt></td>
</tr>
</table>
<p> Three encodings, three different files. No redundancy. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (16)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-967573">
				<div id="div-comment-967573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967573">
			February 20, 2012 at 7:13 am</a>		</div>

		<p>72 C3 A9 73 75 6D C3 A9. :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967593">
				<div id="div-comment-967593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kyle S.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967593">
			February 20, 2012 at 8:22 am</a>		</div>

		<p>If &quot;Unicode&quot; means &quot;UTF16-LE&quot;, why does it include a BOM?</p>
<div class="post">[<i>To avoid <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/03/24/95235.aspx" rel="nofollow">this problem</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967613">
				<div id="div-comment-967613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rodrigo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967613">
			February 20, 2012 at 8:41 am</a>		</div>

		<p>Very clarifying.</p>
<p>Many thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967623">
				<div id="div-comment-967623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chentiangemalc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967623">
			February 20, 2012 at 11:42 am</a>		</div>

		<p>Excel also has &quot;.csv&quot; format and &quot;.csv (MS-DOS) format</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967633">
				<div id="div-comment-967633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon Buchan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967633">
			February 20, 2012 at 12:55 pm</a>		</div>

		<p>I&#39;m surprised you didn&#39;t take the opportunity to call &quot;Unicode&quot; a misnomer too, then you would have been 3 for 3!</p>
<p>I&#39;m surprised Wordpad doesn&#39;t support UTF-8, when Notepad does: especially since nothing on Windows will correctly detect your example OEM text file.</p>
<div class="post">[<i>It&#39;s less surprising if you recall that Wordpad was written before Notepad had UTF-8 support. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967643">
				<div id="div-comment-967643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967643">
			February 20, 2012 at 2:24 pm</a>		</div>

		<p>@chentiangemalc: Yeah, and both are broken. MAR01 is not necessarily a date but when you save it back you get 03/01.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967653">
				<div id="div-comment-967653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Will</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967653">
			February 20, 2012 at 2:28 pm</a>		</div>

		<p>chentiangemalc, That is because you have a csv format that puts double quotes around strings and treats commas in the double quotes as part of the string not a separator.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967683">
				<div id="div-comment-967683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967683">
			February 21, 2012 at 1:27 am</a>		</div>

		<p>The CSV family are bad neighbours. You&#39;ve got grampa Quoteless, mommy Semicolon, junior Commachallenged and cousin Singleline, and they all misbehave in various ways. I blame daddy Standard for never being around.</p>
<p>I&#39;d rather have encoding issues. Sure, those are annoying too, but at least the damage is usually fixable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967693">
				<div id="div-comment-967693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/bombsoft_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>bombsoft@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967693">
			February 21, 2012 at 6:29 am</a>		</div>

		<p>And the creepy uncle pipe, who noone likes to talk about.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967703">
				<div id="div-comment-967703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967703">
			February 21, 2012 at 7:01 am</a>		</div>

		<p>And there is no way my grandmother would have a clue what the difference between any of these options is. &nbsp;And think of the number of people who use Windows 7 and don&#39;t even know what &quot;MS-DOS&quot; or &quot;Unicode&quot; is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967793">
				<div id="div-comment-967793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kme</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967793">
			February 21, 2012 at 6:14 pm</a>		</div>

		<p>It seems like it would have been better to just explicitly name the options after the codepages, since the people who care end up decoding the euphemisms back into the codepages, and the people who don&#39;t care don&#39;t understand the euphemisms either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-967883">
				<div id="div-comment-967883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wilczek</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967883">
			February 22, 2012 at 6:42 am</a>		</div>

		<p>Hi,</p>
<p>Since Notepad was also mentioned I&#39;d like to ask if you could quickly summarize why there was a file size limit while opening a textfile in Notepad on Win9x series? If I remember correctly Notepad could not open text files larger than 32KB (or 64KB?) on 9x, but there was no such a limit on NT4 (on Win2000 for sure not).</p>
<p>Thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-967993">
				<div id="div-comment-967993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lmgtfy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-967993">
			February 22, 2012 at 3:30 pm</a>		</div>

		<p>Googled for &quot;windows 95 notepad limits&quot; and the first result, Wikipedia, says 64k for Windows before NT, which matches my memory.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968033">
				<div id="div-comment-968033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-968033">
			February 23, 2012 at 2:50 am</a>		</div>

		<p>@Wilczek: most likely because the text control is limited to 64kB (and Notepad is pretty much just a wrapper around it).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-968043">
				<div id="div-comment-968043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-968043">
			February 23, 2012 at 2:50 am</a>		</div>

		<p>Don&#39;t get me started on CSV files; SQL Server Express 2005 doesn&#39;t really know what they are, so I had to trawl my dataset looking for the one ASCII character that wasn&#39;t present in my data so I could use it as the delimiter. (Non-ASCII characters might have worked or they might have introduced their own headaches.)</p>
<p>@Wilczek I&#39;m sure Raymond himself covered this by pointing out that Notepad is simply a glorified Edit control.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-968073">
				<div id="div-comment-968073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Horst Kiehl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120220-00/?p=8273#comment-968073">
			February 23, 2012 at 12:03 pm</a>		</div>

		<p>@kme: That might be true now, but at the time when those distinctions were introduced, it was possibly much more common for a user to know &quot;my file came from a MS-DOS program&quot; rather than &quot;my file is in codepage 437&quot;.</p>
<p>Also, a description like &quot;Text Document &#8211; MS-DOS Format (Codepage 437 Text Document)&quot; would get rather long, and then, to be able to generate these strings, Notepad also would have to determine what codepages are the current ones for the CP_ACP and CP_OEM encodings, and then it would have to put them together by the rules for the current display language. Even if this could be done with a reasonable amount of work, suddenly the number of test cases for this part of Notepad is of O(nÂ²) instead of O(1).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

