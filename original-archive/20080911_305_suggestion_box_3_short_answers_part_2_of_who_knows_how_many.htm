<html>
<head>
<title>Suggestion Box 3, short answers (part 2 of who knows how many)</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Suggestion Box 3, short answers (part 2 of who knows how many)</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>September 11, 2008 / year-entry #306</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>45</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Another round of short answers to questions in the suggestion box. How does Windows choose the monitor a window maximizes to? The window maximizes to the monitor selected by MonitorFromWindow. The algorithm the MonitorFromWindow uses to select the monitor is documented in MSDN. How do you make your Win32 application safe from keyloggers? You can't....</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p> Another round of short answers to questions in the suggestion box. </p>
<dl>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#444980">How does Windows choose the monitor a window maximizes to?</a> </dt>
<dd>
<p>     The window maximizes to the monitor selected by     <code>MonitorFromWindow</code>.     The algorithm the <code>MonitorFromWindow</code> uses to select     the monitor is documented in MSDN. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#448559">How do you make your Win32 application safe from keyloggers?</a> </dt>
<dd>
<p>     You can't.     In the battle between kernel mode and user mode,     user mode loses.     That's why we have a distinction between kernel mode and user mode     in the first place. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#449229">Why should you ever call MessageBox from inside a message handler     that is re-entrant?</a>     "I'm having a hard time explaining to people that it isn't a blocking     call." </dt>
<dd>
<p>     I don't even understand the question.     And it <i>is</i> a blocking call.     The function doesn't return until the user responds to the message box. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#451920">What happens when you pass NULL to ShellExecute, like you did     in one of your articles?</a>     "Is UI suppressed if I pass NULL?" </dt>
<dd>
<p>     The window handle is used as the parent for any dialogs or messages     that the <code>ShellExecute</code> function may need to display.     If you pass <code>NULL</code>, then you get the same effect as if     you had passed <code>NULL</code> to, say, <code>MessageBox</code>.     In the article, the thread has no UI active, so any error messages     displayed by the <code>ShellExecute</code> function will appear     as top-level unowned windows.     <a href="http://blogs.msdn.com/oldnewthing/archive/2005/02/24/379635.aspx">     I discussed this issue in detail a few years ago</a>.     If you want to suppress UI, then pass the <code>SEE_MASK_FLAG_NO_UI</code>     flag to <code>ShellExecuteEx</code>. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#452436">Is there some way to use Explorer's filename sort function?</a> </dt>
<dd>
<p>     It's called <code>StrCmpLogical</code>.     <a href="http://blogs.msdn.com/michkap/">     Michael Kaplan</a> discussed this function     <a href="http://blogs.msdn.com/michkap/archive/2005/01/05/346933.aspx">     two years ago</a>     with     <a href="http://blogs.msdn.com/michkap/archive/2006/10/02/783066.aspx">     a follow-up last year</a>.     Of course, if you want to mimic Explorer exactly,     you also need to respect the     <code>REST_NOSTRCMPLOGICAL</code> policy. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#453133">Is there a way to sleep for less than one millisecond?</a> </dt>
<dd>
<p>     I don't know either. I've never needed to do that.     (I try to get eight hours each night.) </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#454063">Why are notification icons limited to 16 colors in Windows 95 and 2000?</a> </dt>
<dd>
<p>     They were limited to 16 colors on Windows&nbsp;95 to conserve memory.     Windows&nbsp;2000 inherited that code and by default,     each version of Windows works the same as the previous one.     There are millions of lines of code in the shell.     It's not like somebody goes through every single one of them     and says, "Gosh, should we change this line in the next version     of Windows?" </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#458121">Does Raymond use _alloca?</a> </dt>
<dd>
<p>     Nope. It wasn't in K&amp;R C, so it's not part of my world view.     And incautious use of <code>_alloca</code> can result in     security vulnerabilities. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#458331">Windows can only handle 64 threads</a>. </dt>
<dd>
<p>     This statement is patently false.     We've seen that even without taking any special precautions,     we were able to     <a href="http://blogs.msdn.com/oldnewthing/archive/2005/07/29/444912.aspx">     pack about 2000 threads into a process before     running out of address space</a>.     What the person probably meant to write is that 32-bit Windows     supports a maximum of 32 <i>processors</i>.     The reason is that the functions that manage sets of processors     (such as <code>SetThreadAffinity</code>)     use a 32-bit value to represent processor masks.     Note that for 64-bit Windows, these masks were expanded to 64-bit     integers, so 64-bit Windows supports up to 64 processors in principle. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#479950">How does that Temporary Internet Files thing work?</a> </dt>
<dd>
<p>     It's a shell namespace extension junction point. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#484017">Why are some count parameters declared as signed integers?</a> </dt>
<dd>
<p>     I don't think there's a profound reason for it.     Each API designer is empowered to decide how     their functions will work.     After all, the original <code>strlen</code> function returned     a signed integer, too.     You might want to ask Brian Kernighan; he was doing it before Windows.     (Signed integers do have the slight advantage of being resilient     to integer underflow.     If <code>a</code> and <code>b</code> are both non-negative     integers, then <code>a - b</code> will never underflow.) </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#496950">Why does the desktop lose track of icons, so it has to refresh them?</a> </dt>
<dd>
<p>     I'm not sure what you mean by "lose track of icons".     Maybe you're asking about lost change notifications     (in which case redirected folders can cause problems with     lost network notifications).     Or maybe you're talking about icon repositioning     (maybe the previous icon locations weren't saved). </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#515657">Questions about DLL imports, exports, and cross-module memory</a> </dt>
<dd>
<p>     I inadvertently answered this question in     <a href="http://blogs.msdn.com/oldnewthing/archive/2006/07/27/680250.aspx">     a rather long series of articles</a> on DLL imports and exports,     and     <a href="http://blogs.msdn.com/oldnewthing/archive/2006/09/15/755966.aspx">     a discussion of cross-module memory allocation</a>. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#688640">     I want to see your blog stats</a>. </dt>
<dd>
<p>     I thought that too, until I saw them.     When you get over a million hits a month,     a list of all the referrals is just a giant pile of noise.     I haven't bothered analyzing the referrals because I have     other things to do in my spare time that are more interesting. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#705378">     I'd love to see a series of things that are obvious to you     but not obvious to everyone</a>. </dt>
<dd>
<p>     How do I know what is obvious to me and not obvious to everyone? </p>
</dd>
</dl>
<p> The next category is, of course, the people who ask questions on things that I listed as topics I am not inclined to cover. </p>
<dl>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#443420">     I have a problem (describes problem)</a>. </dt>
<dd>
<p>     I don't think your problem really is of general interest.     But it's clear that     <a href="http://blogs.msdn.com/oldnewthing/archive/2005/02/28/381591.aspx">     you're not respecting the modality of the window</a>. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#471747">I'm trying to improve the performance of my specific scenario</a>. </dt>
<dd>
<p>     This doesn't strike me as a topic of general interest. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#489215">What are your thoughts on this research project?</a>     <a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#530728">What are your thoughts on this Microsoft product?</a> </dt>
<dd>
<p>     I think you confused me with Robert Scoble. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#490974">I have a problem (describes problem)</a>. </dt>
<dd>
<p>     This doesn't strike me as a topic of general interest. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#501636">Why does Internet Explorer do X?</a> </dt>
<dd>
<p>     Internet Explorer is explicitly on the list of things I am unlikely     to cover. </p>
</dd>
</dl>
<p> Or the people who ask questions I've already answered or questions I've chosen to answer elsewhere. </p>
<dl>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#503431">Help me modify files that I didn't write</a>. </dt>
<dd>
<p>     <a href="http://blogs.msdn.com/oldnewthing/archive/2003/08/05/54603.aspx">Doing this breaks servicing</a>.     </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#508754">What is the long pause after listing a directory the first time?</a> </dt>
<dd>Answered in     <a href="http://www.microsoft.com/technet/technetmag/issues/2006/07/WindowsConfidential/">     A brief and incomplete history of FAT32</a>. </dd>
</dl>
<p> And then there are the questions I can't or choose not to answer. </p>
<dl>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#456664">Why does the window manager force windows fully on-screen     when the workstation is unlocked?</a> </dt>
<dd>
<p>     I don't know either.     It makes sense to force windows on-screen after a change in     resolution, but if the resolution didn't change between the lock     and the unlock, there's really no need to go around "fixing up"     window positions. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#478576">What did Apple copy from Microsoft and vice versa?</a> </dt>
<dd>
<p>     I'm not going to touch this one.     I don't see any upside to my answering it, only downside,     and I don't welcome the flamewar that will doubtless ensue. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#480923">Do you know anything about this?</a> </dt>
<dd>
<p>     No. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#491759">Something about defragmenting</a>. </dt>
<dd>
<p>     I have no special knowledge about defragmentation.     Try     <a href="http://blogs.technet.com/filecab/">     The Filing Cabinet</a>.     They answered a few questions     <a href="http://blogs.technet.com/filecab/archive/2007/01/26/don-t-judge-a-book-by-its-cover-why-windows-vista-defrag-is-cool.aspx">     in one blog entry</a>     and even have a     <a href="http://blogs.technet.com/filecab/articles/440717.aspx">     Defrag FAQ</a>.     Personally, I've been happy with     <a href="http://www.flexomizer.com/PermaLink,guid,ce99367e-158c-487a-879d-b32145cc1957.aspx">     Dave Whitney's defragmenter</a> to defragment specifically-targeted     files.     (I don't defragment my entire drive because it seems like a waste of time.) </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#493250">A question about Aero glass</a> </dt>
<dd>
<p>     I have no special knowledge about Aero glass. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#497703">How about an under-the-hood look at the Windows Vista Start menu?</a> </dt>
<dd>
<p>     I didn't work on the Windows Vista Start menu,     so I don't know how it works. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#498519">Do you have any insights into the evolution of WinHelp?</a> </dt>
<dd>
<p>     Sorry, I'm an outsider just like you when it comes to help technologies. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#505849">Long rambling question about <code>ACCESS_DENIED</code></a> </dt>
<dd>
<p>     I quickly lost interest. </p>
</dd>
<dt><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#510557">Please explain the subtleties of the ScrollWindowEx function     when scrolling child windows</a>. </dt>
<dd>
<p>     I don't know the answer and I don't feel like doing the     research necessary to find out.     Sorry.     The fact that I left it unanswered from the previous suggestion box     should have been a clue. </p>
</dd>
</dl>
<p> That's all for this year. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (45)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-666503">
				<div id="div-comment-666503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666503">
			September 11, 2008 at 10:55 am</a>		</div>

		<p>&quot;A question about Aero glass&quot;</p>
<p>A quick search for &quot;aero glass client area&quot; would&#8217;ve found the answer. &nbsp;(This comment was aimed at the original questioner, not at Raymond.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666523">
				<div id="div-comment-666523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666523">
			September 11, 2008 at 11:15 am</a>		</div>

		<p>Regarding: &nbsp;&quot;Why should you ever call MessageBox from inside a message handler that is re-entrant? &nbsp;&#8216;I&#8217;m having a hard time explaining to people that it isn&#8217;t a blocking call.&#8217;&quot;</p>
<p>I suspect the confusion stems from the fact that message boxes (and other modal dialog boxes) pump messages. &nbsp;If messages can be generated for other windows, then the dialog&#8217;s modal loop will dispatch them, possibly leading to recursion.</p>
<p>Generally this isn&#8217;t a problem, because the parent window of the dialog is disabled. &nbsp;However, if you get the parenting wrong, or if you have other &quot;aunt or uncle&quot; windows that you&#8217;re not disabling, unexpected messages could be dispatched. &nbsp;If you don&#8217;t completely understand what&#8217;s happening, it&#8217;s easy to mistakenly conclude that MessageBox isn&#8217;t a blocking call.</p>
<p>I recall learning about this the first time when an assertion dialog didn&#8217;t seem to stop the program execution in time to see what had happened.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666533">
				<div id="div-comment-666533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666533">
			September 11, 2008 at 11:39 am</a>		</div>

		<p>Just yesterday somebody asked me how to sleep less than a millisecond.</p>
<p>If you sleep at all, then you&#8217;re thread forfeits the rest of its quantum. &nbsp;If there are any other threads that are ready to run, it&#8217;ll be at least another quantum before your thread runs again. &nbsp;I&#8217;m not an expert in this area, and I know it varies by machine and OS version, but I believe a quantum can be on the order of 10 ms.</p>
<p>This is one of those cases where you have to ask, &quot;Why do you want to sleep for less than a millisecond?&quot;</p>
<p>In my colleague&#8217;s case, he has code that&#8217;s creating a set of files in rapid succession. &nbsp;He&#8217;d like each of them to have a unique timestamp. &nbsp;His current process creates them so fast, that clusters of them have identical timestamps because of the limited resolution of the file system&#8217;s timestamps.</p>
<p>I suggested a simple while loop before creating each file that simply waits for the current time to increment enough that it would make a distinct timestamp. &nbsp;Something like:</p>
<p>while (now / resolution == last_timestamp / resolution) { }</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666543">
				<div id="div-comment-666543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xix</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666543">
			September 11, 2008 at 11:58 am</a>		</div>

		<p>Regarding &quot;Why does the desktop lose track of icons, so it has to refresh them?&quot;, I think the writer might have been talking about the phenomenon of your icons (for me, usually the desktop) getting all messed up. &nbsp;Not usually corrupted, but with a PDF file having the icon of IE, or an PSD mini-preview icon suddenly being outlook. &nbsp;If you click on it and hit F5, it will correct itself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666553">
				<div id="div-comment-666553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666553">
			September 11, 2008 at 12:14 pm</a>		</div>

		<p>@Adrian &#8211; Why even go that far? On any file system that&#8217;s not write-once, timestamps can be set programmatically (on Windows, see SetFileTime: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/ms724933" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms724933</a>(VS.85).aspx ). &nbsp;Create all the files you need, go back and give them sequential timestamps, and don&#8217;t misuse sleeps or loops to make your program run artificially slowly.</p>
<p>Similar mechanisms exist under other OSes (touch on *NIX machines obviously needs such an API), so Windows isn&#8217;t special there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666563">
				<div id="div-comment-666563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666563">
			September 11, 2008 at 12:18 pm</a>		</div>

		<p>Addendum: Of course, if he really needs the files to be uniquely identifiable or have a unique ordering he should probably find a better mechanism than timestamps. &nbsp;I don&#8217;t know the parameters, so this may not be an option. &nbsp;For all I know he&#8217;s trying to apply a custom sort to video files in Windows Media Center and using &quot;order by modification date&quot; for that purpose, then he doesn&#8217;t have a lot of options.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666643">
				<div id="div-comment-666643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vijay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666643">
			September 11, 2008 at 2:22 pm</a>		</div>

		<p>I think you could sleep for 0 ms. I think that means the thread gives up the remaining part of the time slice for the scheduler to schedule another thread (it might well be the same thread that get scheduled right away though)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666653">
				<div id="div-comment-666653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil (SM)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666653">
			September 11, 2008 at 2:29 pm</a>		</div>

		<p>Hmmm, I thought the icon question simply had to do with the desktop icons occasionally refresh after closing a program &nbsp;&#8212; oftentimes you&#8217;ll see the blank white placeholder icons appear in their place while the actual icons are loading. &nbsp;Perhaps the questioner was assuming that the desktop was somehow &quot;losing track&quot; of the icons and needed to reload them whenever this happened?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666683">
				<div id="div-comment-666683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666683">
			September 11, 2008 at 2:46 pm</a>		</div>

		<p>My assumption on the icons question was that he was wondering why the icons would blink out and have to be redrawn occasionally. &nbsp; &nbsp;And I don&#8217;t know for sure because I&#8217;ve never tested it, but wouldn&#8217;t a call to InvalidateRect( NULL,&#8230; ) do it? &nbsp;I always figured that, or something like it, was what was going on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tonyschr odd alt thread-odd thread-alt depth-1" id="comment-666703">
				<div id="div-comment-666703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Tony+Schreiner+%5BMSFT%5D' rel='external nofollow' class='url'>Tony Schreiner [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666703">
			September 11, 2008 at 3:28 pm</a>		</div>

		<p>Skip, regarding icons blinking, LockWindowUpdate() can cause this even if you&#8217;re only attempting to lock a child window in your application.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666713">
				<div id="div-comment-666713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ron Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666713">
			September 11, 2008 at 3:33 pm</a>		</div>

		<p>Ignoring the obvious problem with preemption and hardware clock resolution and all that, which of course make the question meaningless and the answer moot, SetWaitableTimer does let you specify the time in 100ns intervals. &nbsp;</p>
<p>If you really need an accurate sub-millisecond delay, I expect your only option is to time the processor you&#8217;re running on somehow and busy-wait the time away. &nbsp;(And you can still be preempted while you busy-wait, and some processors adjust their speed dynamically based on various environmental and other factors, etc.)</p>
<p>But, of course, the question itself reeks of being the question you think you want the answer to, rather than the question you actually want the answer to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666723">
				<div id="div-comment-666723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Trevel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666723">
			September 11, 2008 at 3:34 pm</a>		</div>

		<p>Darnit, it sounds like my new 128 processor computer isn&#8217;t going to be useful for some time, then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666733">
				<div id="div-comment-666733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666733">
			September 11, 2008 at 4:09 pm</a>		</div>

		<p>The most noticeable problem with the colour depth of notification icons in Windows 2000 is that Automatic Updates was designed for Windows XP, so unless you&#8217;re in a 256-colour video mode (e.g. Terminal Services), it tries to load a full-colour icon, which then gets dithered down to 16 colours. Ugly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666493">
				<div id="div-comment-666493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Name required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666493">
			September 11, 2008 at 10:13 am</a>		</div>

		<p>&gt; Is there a way to sleep for less than one millisecond?</p>
<p>&gt;</p>
<p>&gt; &nbsp; &nbsp;I don&#8217;t know either. I&#8217;ve never needed to do that. (I try to get eight hours each night.)</p>
<p>*Snorts with laughter*</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666763">
				<div id="div-comment-666763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Old Salt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666763">
			September 11, 2008 at 5:46 pm</a>		</div>

		<p>[It wasn&#8217;t in K&amp;R C, so it&#8217;s not part of my world view]</p>
<p>It must be pretty painful coding for L&quot;Unicode&quot; without wide characters.</p>
<p>(It&#8217;s a joke &#8211; not a nitpick)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666783">
				<div id="div-comment-666783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666783">
			September 11, 2008 at 6:00 pm</a>		</div>

		<blockquote><p>
  &gt; Do you know anything about this? (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#480923" rel="nofollow">http://blogs.msdn.com/oldnewthing/pages/407234.aspx#480923</a>)
</p></blockquote>
<p>&nbsp; &nbsp;No.</p>
<p>&lt;&lt;</p>
<p>But you didn&#8217;t address David Candy&#8217;s immediate follow-up question:</p>
<p>&quot;What do the stars mean?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666513">
				<div id="div-comment-666513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">peterchen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666513">
			September 11, 2008 at 11:04 am</a>		</div>

		<p>&gt;&gt; Why should you ever call MessageBox from inside[&#8230;]</p>
<p>I assume that&#8217;s supposed to say *never*, because then it makes sense.</p>
<p>The call to the message box is blocking. However, messages are still processed, so the message handler is reentrant.</p>
<p>Sample:</p>
<p>&#8230;</p>
<p>SetTimer(wnd, ID_Delay, 1000); // process this later!</p>
<p>&#8230;</p>
<p>WM_TIMER:</p>
<p>if (id == ID_Delay)</p>
<p>{ </p>
<p> &nbsp; ProcessPendingThing();</p>
<p> &nbsp; KillTimer(ID_Delay); // avoid firing twice</p>
<p>}</p>
<p>all nice, right?</p>
<p>Now, if ProcessPendingThings contains:</p>
<p>if (!DoProcess(thing))</p>
<p> &nbsp;MessageBox(wnd, GetThingError()); // oops?</p>
<p>}</p>
<p>timer events will be processed while the message box is still shown, you get a new message box &nbsp;each second.</p>
<p>This is especially fun with a 10 ms interval.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-666793">
				<div id="div-comment-666793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666793">
			September 11, 2008 at 7:22 pm</a>		</div>

		<p>&quot;What do the stars mean?&quot;</p>
<p>The stars are pinpricks in the blanket that god puts over the world at night time to indicate that it&#8217;s time for little boys and little girls to go to bed.</p>
<p>On another topic, the question about the &quot;under-the-hood look at the Windows Vista Start menu&quot; seemed to be rather leading&#8230; of course the answer was going to be &quot;it&#8217;s still shortcut file/folder based&quot; at which point Randolpho would be able to say &quot;ah ha! Windows is crappy!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666803">
				<div id="div-comment-666803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://coldacid.net/' rel='external nofollow' class='url'>Chris Charabaruk</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666803">
			September 11, 2008 at 7:55 pm</a>		</div>

		<p>Some days, Raymond, I wonder if you&#8217;re as grumpy as me. Today is one of those days. :D</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666813">
				<div id="div-comment-666813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.coldacid.net/blog/2008/09/11/raymond-chen-has-issue-i-can-only-dream-havinghellip' rel='external nofollow' class='url'>coldacid dot net</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666813">
			September 11, 2008 at 8:18 pm</a>		</div>

		<p>Lately seen on The Old New Thing: I want to see your blog stats.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666833">
				<div id="div-comment-666833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666833">
			September 11, 2008 at 9:23 pm</a>		</div>

		<p>Damnit :) I guess the only way to figure out the scrolling child windows thing is going to be to crack out the disassembler. Boy am I rusty though&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666843">
				<div id="div-comment-666843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://kateel.blogspot.com' rel='external nofollow' class='url'>Matt Lee</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666843">
			September 11, 2008 at 11:48 pm</a>		</div>

		<p>&quot;I&#8217;d love to see a series of things that are obvious to you but not obvious to everyone.</p>
<p>How do I know what is obvious to me and not obvious to everyone?&quot;</p>
<p>I guess you&#8217;ll have to add that to the list of things that are obvious to everyone but not obvious to you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666853">
				<div id="div-comment-666853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666853">
			September 12, 2008 at 1:37 am</a>		</div>

		<p>Sub-millisecond sleeps are possible. ZYou just need to find an API that&#8217;ll let you do it. A common one on Unix(-like) platforms is select(), which takes in a timeout value. Alas, we know Windows is not Unix, so&#8230;</p>
<p>(Hint: Look up WinSock)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-666883">
				<div id="div-comment-666883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666883">
			September 12, 2008 at 2:41 am</a>		</div>

		<p>Worf: select(), even on Unix, will timeout with a granularity of a jiffy (I believe 10ms on Linux? It&#8217;s been a while&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-666913">
				<div id="div-comment-666913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666913">
			September 12, 2008 at 5:55 am</a>		</div>

		<p>From Vijay:</p>
<p>&quot;I think you could sleep for 0 ms. I think that means the thread gives up the remaining part of the time slice for the scheduler to schedule another thread (it might well be the same thread that get scheduled right away though)&quot;</p>
<p>If there&#8217;re lower-priority threads, they will never get CPU time.</p>
<p>If your thread has the same priority than other threads, then, another thread will take its time slice, and so, will probably not return before 10 or 20 milliseconds.</p>
<p>To get better accuracy (up to 1 millisecond), timeBeginTime is a solution.</p>
<p>But, I don&#8217;t think Windows NT/2000/XP provide any kind mechanism to wait for less than 1 millisecond (e.g. 100 microsecond).</p>
<p>I guess Windows NT can reach a 100 microsecond task switch latency on old computers (e.g. Pentium 75 Mhz)!</p>
<p>So, you&#8217;ve to use a busy loop for those very short delays.</p>
<p>Warning: Windows NT/2000/XP aren&#8217;t real-time operating systems.</p>
<p>From Dean Harding:</p>
<p>&quot;(I believe 10ms on Linux? It&#8217;s been a while&#8230;)&quot;</p>
<p>The time granularity depends on a compile-time kernel setting.</p>
<p>With menuconfig, you can set it to 1/100th, 1/250th, 1/300th or 1/1000th of second.</p>
<p>IIRC, by default it&#8217;s 1/250th of second (4 milliseconds), but I set it to 1 millisecond.</p>
<p>For more info &quot;man 7 time&quot;.</p>
<p>Using the RTC, since it can generate periodic IRQ, it might be possible to wait for 1/8192 second if your task is the only active one (i.e. there&#8217;re no CPU-intensive background task), but I didn&#8217;t try.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-666923">
				<div id="div-comment-666923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sebastian Redl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666923">
			September 12, 2008 at 6:04 am</a>		</div>

		<blockquote><p>
  Why does the desktop lose track of icons, so it has to refresh them?
</p></blockquote>
<p>I think the question is about the case where, after a long-running, memory-hungry full-screen window closes (especially games), the desktop needs to reload all icons. You see the default file icon for everything and then one after the other reverts to their intended look.</p>
<p>My guess (and that&#8217;s a pure guess) is that the desktop simply chooses to forget the icons when any window goes to full-screen because the icons are obviously not needed and thus a waste of memory.</p>
<p>The reason that it takes so long (up to two seconds) to reload them is that each icon is in its own executable file, all of which have to be looked up and loaded, since they&#8217;re most definitely not in any cache anymore (memory-hungry app was running).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick even thread-even depth-1" id="comment-666933">
				<div id="div-comment-666933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-666933">
			September 12, 2008 at 6:15 am</a>		</div>

		<p>On SetWaitableTimer and select():</p>
<p>Just because you can specify your timeout with a tiny precision (1 microsecond in the case of select, 100ns for SetWaitableTimer) doesn&#8217;t mean that the system can do that with the same accuracy. In practice the accuracy is the system clock interrupt period, typically around 15ms, but varies with the version of the OS and the HAL used, and whether anyone&#8217;s used a multimedia timer (which can change the clock interrupt period). Sleep() rounds up your request to the next system clock interrupt.</p>
<p>That is, Windows notes how long you wanted to sleep for in terms of ticks, and on each clock interrupt checks to see if the thread should no longer be sleeping and marks it ready if so &#8211; but you still might not actually be scheduled, depending on whether something with higher priority is still executing. The same scheme is used for wait timeouts (e.g. WaitForSingleObject).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667063">
				<div id="div-comment-667063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RUF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667063">
			September 12, 2008 at 11:03 am</a>		</div>

		<blockquote><p>
  Is there a way to sleep for less than one millisecond?</p>
<p>  &nbsp; &nbsp;I don&#8217;t know either. I&#8217;ve never needed to do that. (I try to get eight hours each night.)
</p></blockquote>
<p>This one is the best.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667133">
				<div id="div-comment-667133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alegr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667133">
			September 12, 2008 at 1:11 pm</a>		</div>

		<p>&quot;Nope. It wasn&#8217;t in K&amp;R C, so it&#8217;s not part of my world view. And incautious use of _alloca can result in security vulnerabilities.&quot;</p>
<p>In fact, incautious use of pretty much everything in C can result in security vulnerabilities. But _alloca is a big kludge.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667283">
				<div id="div-comment-667283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">edgar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667283">
			September 12, 2008 at 6:07 pm</a>		</div>

		<blockquote><p>
  &gt;&quot;Nope. It wasn&#8217;t in K&amp;R C, so it&#8217;s not part of &gt;&gt;my world view. And incautious use of _alloca &gt;&gt;can &gt;result in security vulnerabilities.&quot;</p>
<p>  In fact, incautious use of pretty much &gt;everything in C can result in security &gt;vulnerabilities. But _alloca is a big kludge.
</p></blockquote>
<p>Yes, let us reduce the thread stack size to zero to have no security vulnerabilities. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667303">
				<div id="div-comment-667303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alegr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667303">
			September 12, 2008 at 7:07 pm</a>		</div>

		<p>&quot;I suggested a simple while loop before creating each file that simply waits for the current time to increment enough that it would make a distinct timestamp. &nbsp;Something like:</p>
<p>while (now / resolution == last_timestamp / resolution) { }&quot;</p>
<p>Never mind that filesystem timestamp resolution can be worse that system time resolution&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667323">
				<div id="div-comment-667323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Bowman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667323">
			September 12, 2008 at 8:31 pm</a>		</div>

		<p>&quot;What do the stars mean?&quot;</p>
<p>I don&#8217;t know, but the thing&#8217;s hollow&#8230; it goes on forever&#8230; and&#8230; oh my God! &#8211; It&#8217;s full of stars!</p>
<p>I shall sleep now, whether for a millisecond or a millennium, I do not know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667363">
				<div id="div-comment-667363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667363">
			September 13, 2008 at 3:10 pm</a>		</div>

		<p>&gt; How do you make your Win32 application safe from keyloggers?</p>
<p>&gt; &nbsp; &nbsp;You can&#8217;t. In the battle between kernel mode and user mode, user mode loses. That&#8217;s why we have a distinction between kernel mode and user mode in the first place. </p>
<p>Sure you can- bring up an image of a keyboard and have the users type with the mouse. &nbsp;Or randomly remaps the keys (okay, so the keylogger would still capture the keys, but they wouldn&#8217;t make any sense)</p>
<div class=post>[<i>And the keylogger intercepts the mouse clicks, correlates them with the pixels on the screen, uses OCR to recognize the character on the keycap, and steals your password anyway. If you randomly remap the key, the keylogger can just read the decoded keys out of your program&#8217;s memory space. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667373">
				<div id="div-comment-667373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667373">
			September 13, 2008 at 5:43 pm</a>		</div>

		<blockquote><p>
  Sure you can- bring up an image of a keyboard and have the users type with the mouse. &nbsp;Or randomly remaps the keys (okay, so the keylogger would still capture the keys, but they wouldn&#8217;t make any sense)
</p></blockquote>
<p>1.Yes, you can make things to make your application safe from specific keyloggers.</p>
<p>2.But NO, you cannot make your user-mode-application safe from kernel-mode-keyloggers:</p>
<p>They can make screenshots and record mouseclicks.</p>
<p>The person who asked the original question probably had 1. in mind, not knowing that you always have to approach these problems like in 2.</p>
<p>(As if deleting your cookies and disabling form/autocomplete from the webmaster would make it magically safe to use online banking in an internet cafe&#8230;.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667403">
				<div id="div-comment-667403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christopher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667403">
			September 14, 2008 at 5:40 am</a>		</div>

		<blockquote><p>
  &gt; The reason that it takes so long (up to two seconds) to reload them is that each icon is in its own executable file, all of which have to be looked up and loaded, since they&#8217;re most definitely not in any cache anymore (memory-hungry app was running).
</p></blockquote>
<p>And antivirus suites with realtime protection will also rescan each EXE file for viruses before allowing the shell to reload their icons.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667413">
				<div id="div-comment-667413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667413">
			September 14, 2008 at 7:55 am</a>		</div>

		<p>I&#8217;d like to see your blog stats too &#8211; preferably piped through awstats first, of course.</p>
<p>As for defragmentation, I agree. That&#8217;s probably why Vista defrags everything in the background continually, and worst of all, without a nice calming GUI to show blocks being moved! (I mean, what&#8217;s the point of a defragger if you can&#8217;t see it working)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667523">
				<div id="div-comment-667523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexander Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667523">
			September 14, 2008 at 10:46 pm</a>		</div>

		<p>AndyB:</p>
<p>&quot;That&#8217;s probably why Vista defrags everything in the background continually, and worst of all, without a nice calming GUI to show blocks being moved! (I mean, what&#8217;s the point of a defragger if you can&#8217;t see it working)&quot;</p>
<p>There is actually no point in running the defrag, at all. I&#8217;m not sure Vista does it, either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667583">
				<div id="div-comment-667583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">scattergather</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667583">
			September 15, 2008 at 12:08 pm</a>		</div>

		<p>NTFS partitions can&#8217;t be fragmented as fat32 could. No need for a defrag program at all. It&#8217;s a clear placebo effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667603">
				<div id="div-comment-667603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alegr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667603">
			September 15, 2008 at 12:28 pm</a>		</div>

		<p>[scattergather] &quot;NTFS partitions can&#8217;t be fragmented as fat32 could&quot;.</p>
<p>NTFS partitions can be as fragmented as FAT32. The only difference could be made by allocation strategies, which depends on the filesystem driver, not on the filesystem type by itself. That said, NTFS doesn&#8217;t suffer from directory fragmentation, because it keeps file records in MFT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-someone odd alt thread-odd thread-alt depth-1" id="comment-667693">
				<div id="div-comment-667693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/anony.muos' rel='external nofollow' class='url'>anony.muos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667693">
			September 15, 2008 at 3:53 pm</a>		</div>

		<p>Why does Windows Me require half of amount of disk space to hibernate? If it has 256 MB of RAM, why does it require only 128 MB? Why not the NT family? Why was hibernation only kept in Windows Me OEM versions?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667783">
				<div id="div-comment-667783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667783">
			September 15, 2008 at 6:31 pm</a>		</div>

		<p>As for keyloggers:</p>
<ol>
<li>Open notepad</li>
<li>
<p>Open word</p>
</li>
<li>
<p>click in password field enter one character</p>
</li>
<li>
<p>click on notepad and type a random number of random characters</p>
</li>
<li>
<p>click in password field enter one character</p>
</li>
<li>
<p>click on word and type a random number of random characters</p>
</li>
<li>
<p>goto 3 until pass entered</p>
</li>
</ol>
<p>That will still confuse most keyloggers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667803">
				<div id="div-comment-667803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xenon155</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667803">
			September 15, 2008 at 8:05 pm</a>		</div>

		<p>@Igor</p>
<p>There is an easier way:</p>
<p>If your password is 1234</p>
<p>type 1abc2qwe3uyt4cxz into the password box</p>
<p>then go back and delete the chars using cut instead of delete.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-667833">
				<div id="div-comment-667833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667833">
			September 15, 2008 at 11:21 pm</a>		</div>

		<p>xenon155: Except your method requires you to remember the number of &quot;dummy&quot; characters you entered, because they&#8217;ll all be displayed as &quot;*&quot;.</p>
<p>Igor&#8217;s method also works for Unix-style password prompts which don&#8217;t echo back &quot;*&quot;s.</p>
<p>Of course, anybody that paranoid about keyloggers probably shouldn&#8217;t be typing *anything* in&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-667883">
				<div id="div-comment-667883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667883">
			September 16, 2008 at 10:07 am</a>		</div>

		<p>Since Raymond is skipping the ACCESS_DENIED question, let me answer it. My crystal ball tells me the users problem is that he doesn&#8217;t know which ACL was tested for which right. This information can generally be found in the Audit log.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-667993">
				<div id="div-comment-667993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080911-00/?p=20913#comment-667993">
			September 16, 2008 at 6:12 pm</a>		</div>

		<p>&quot;NTFS partitions can&#8217;t be fragmented as fat32 could. No need for a defrag program at all. It&#8217;s a clear placebo effect.&quot;</p>
<p>Actually, the Windows XP NTFS driver fragments files a lot. Writing two big files at once, create lots of small extents (e.g. downloading several files at once).</p>
<p>The disk of my brother&#8217;s computer currently has 81% file fragmentation.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

