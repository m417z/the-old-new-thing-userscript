<html>
<head>
<title>If you don't trust your administrators, you've already lost</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>If you don&#8217;t trust your administrators, you&#8217;ve already lost</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>September 21, 2006 / year-entry #322</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>34</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Occasionally, a customer will ask for a way they can restrict what the administrator can do. The short answer to this is, "Um, no, that's why they're called 'Administrator'." You can try to set up roadblocks, say, ACL files to revoke access to a file you don't want the administrator to read, but the Administrator...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Occasionally, a customer will ask for a way they can restrict what the administrator can do. The short answer to this is, "Um, no, that's why they're called 'Administrator'." You can try to set up roadblocks, say, ACL files to revoke access to a file you don't want the administrator to read, but the Administrator can always take ownership of the file and read the contents that way. At the end of the day, the Administrator owns the local machine.</p>
<p> Often, people ask this question because they want to grant certain employees selected subsets of the full set of capabilities available to the Administrator. The way to do this is not to make the user an administrator and then try to rope off the parts you don't want them to use. Rather, you take the things that you do want them to be able to do and delegate that permission and only that permission to them (discretionary access control). </p>
<p> For more information, check out <a href="http://www.microsoft.com/technet/community/columns/secmgmt/sm0705.mspx"> this column on trustworthy administrators</a> (based, I am told, on a TechEd presentation) by <a href="http://blogs.technet.com/steriley/"> Steve Riley</a> (and his uncredited co-presenter <a href="http://blogs.technet.com/jesper_johansson/"> Jesper Johansson</a>). </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (34)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-422553">
				<div id="div-comment-422553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamessummerlin.blogspot.com' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422553">
			September 21, 2006 at 11:33 am</a>		</div>

		<p>I am always surprised at the high number of people who completely fail to understand basic security principles such as this. &nbsp;Already I have a client asking me for a way to limit a user while maintaining that user&#8217;s sovereignty over the machine (i.e. admin rights). &nbsp;And that makes about the 9th time this year I have been given such a request.</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422583">
				<div id="div-comment-422583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422583">
			September 21, 2006 at 1:16 pm</a>		</div>

		<p>Ok then, how do you make a user capable of installing software, while not being able to read other users&#8217; files? </p>
<p>You can&#8217;t. Almost all installers won&#8217;t work unless you are a member of the Administrators group.</p>
<div CLASS=post>[<i>You&#8217;re asking for a contradiction. If I can install software, then I can install spyware, and therefore I can read other users&#8217; files. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422593">
				<div id="div-comment-422593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422593">
			September 21, 2006 at 1:27 pm</a>		</div>

		<p>Stu: &nbsp;Try sudo, and configure /etc/sudoers to allow trusted users to run (with either no password or their password) whatever install command is required, but not allow them to run anything else.</p>
<p>Oh, wait&#8230; &nbsp;;-)</p>
<p>(Actually, I wonder if anyone has ported sudo to Windows, or written something that works just like it but that runs on Windows. &nbsp;Hmm.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422603">
				<div id="div-comment-422603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422603">
			September 21, 2006 at 1:33 pm</a>		</div>

		<p>BryanK,</p>
<p>There&#8217;s &quot;Run as&quot; which you get by right-clicking on an executable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422613">
				<div id="div-comment-422613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mjb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422613">
			September 21, 2006 at 1:34 pm</a>		</div>

		<p>sudo has existed for windows for a long time. you can log in as&#8230; (user) for any app desire. That&#8217;s what the secondary login service is for</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422633">
				<div id="div-comment-422633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neal C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422633">
			September 21, 2006 at 1:45 pm</a>		</div>

		<p>&quot;Run as&quot; isn&#8217;t nearly the same as sudo, because you need a second account&#8217;s full credentials to &quot;run as&quot; something. &nbsp;Once you give a user that password, they have full access to the machine anyway, because they can just log in as that user, or run anything they want with &quot;run as&quot;. &nbsp;And if you don&#8217;t give them that password, then you haven&#8217;t actually given the user access to anything, have you?</p>
<p>sudo, on the other hand, doesn&#8217;t need another account&#8217;s password. &nbsp;Instead, you get to define a list of commands that users can run with administrative rights, under their own credentials. &nbsp;This means access can be given, changed, and revoked without having to change anyone&#8217;s password, and without having to maintain more than a 1:1 ratio of accounts:users.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422653">
				<div id="div-comment-422653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hexatron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422653">
			September 21, 2006 at 2:24 pm</a>		</div>

		<p>Run As fails for at least some &#8216;complex&#8217; installations (installer calls installer) anyway. &nbsp;<br />
<br /> Or perhaps this is a kind of security.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422663">
				<div id="div-comment-422663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lame Programmer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422663">
			September 21, 2006 at 2:41 pm</a>		</div>

		<p>The weakness of sudo is the &quot;approved&quot; programs must also be security concious and robust.</p>
<p>How many idiots assume that if you can look at the Security event log, you must be an Administrator?</p>
<p>That assumption is wrong if log viewing was done with sudo.</p>
<p>How many non-suid programs have exploitable bugs that are harmless if run by root &#8211; because you ARE root &#8211; but could be exploited by a regular using using sudo, thereby gaining root privs?</p>
<p>I like sudo. I just don&#8217;t trust software.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422673">
				<div id="div-comment-422673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422673">
			September 21, 2006 at 2:45 pm</a>		</div>

		<p>The problem with sudo is that it requires specific commands. How do I know in advance what command is going to be used to install the software that somebody&#8217;s going to need? And what&#8217;s to say that they don&#8217;t have the &quot;evil&quot; version of that command that installs spyware instead of what they&#8217;re supposed to have?</p>
<p>The only way to keep admins from accessing data they&#8217;re not allowed to see is to encrypt it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422683">
				<div id="div-comment-422683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rhomboid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422683">
			September 21, 2006 at 3:02 pm</a>		</div>

		<p>I read somewhere (might have been Jesper&#8217;s blog, might have been here, I can&#8217;t recall) the slogan &quot;Power Users are just users that have not made themselves Administrators yet.&quot; &nbsp;Or in other words, don&#8217;t try to make untrusted users Power Users to let them do certain tasks, instead do what Raymond said above.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422713">
				<div id="div-comment-422713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422713">
			September 21, 2006 at 3:46 pm</a>		</div>

		<p>If they can access the machines&#8217; network port, the even apt-get can be subverted.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422733">
				<div id="div-comment-422733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422733">
			September 21, 2006 at 4:26 pm</a>		</div>

		<blockquote><p>
  If they can access the machines&#8217; <br />&gt; network port, the even apt-get can be &gt; subverted. </p>
<p>True, if they have physical access to the machine, then you&#8217;ve already lost.</p>
<div CLASS=post>[<i>Physical access to the target machine itself is not necessary. You just need access to the network cable anywhere between the target machine and the Debian server. That&#8217;s what makes it a little more scary. I hope the apt packages are digitally signed or checksummed or otherwise resistant to tampering. -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422743">
				<div id="div-comment-422743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422743">
			September 21, 2006 at 6:17 pm</a>		</div>

		<blockquote><p>
  I hope the apt packages are digitally signed or<br />
  <br />&gt;checksummed or otherwise resistant to tampering.</p>
<p>The official repositories yes, but signitures must be installed manually, meaning that sysadmins might not bother for any third-party repos that they add.<br />
  <br />Also, some version/configurations of apt-get only issue a warning when their is a signiture problem, which an inexperianced or not-paying-full-attention sysadmin might ignore.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422753">
				<div id="div-comment-422753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422753">
			September 21, 2006 at 6:29 pm</a>		</div>

		<p>Asking for restrictions on admin power isn&#8217;t new &#8211; that&#8217;s the whole point of DRM, intellectual property protection, anti-cheat, and so on.</p>
<p>There are plenty of examples, Microsoft and everywhere alkie, that implement &quot;how do I prevent the owner of a computer from using a debugger&quot; or whatever.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422763">
				<div id="div-comment-422763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lame programmer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422763">
			September 21, 2006 at 6:52 pm</a>		</div>

		<p>apt-get accepts &quot;-c&quot; which tells it which config file to use. The config file can specify the HTTP proxy. Point the proxy at localhost, run server to serve up a package that overwrites arbitary files on the system.</p>
<p>Toast. And you didn&#8217;t even need to cut the Ethernet.</p>
<p>sudo keeps honest people honest and prevents stupid mistakes. sudoers are just power users who haven&#8217;t made themselves root yet. :=)</p>
<p>PS Raymond, I routinely try to install software as a limited user. The software &#8211; er, spyware &#8211; will work for me but if perms are correct and there aren&#8217;t any cracks in Windows, then the spyware will only be able to read MY files. Not anyone elses on the computer.</p>
<p>Most software houses just don&#8217;t understand the per-user concept.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-422773">
				<div id="div-comment-422773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422773">
			September 21, 2006 at 7:35 pm</a>		</div>

		<blockquote><p>
  PS Raymond, I routinely try to install software as a limited user.</p>
<p>It&#8217;s &quot;supposed&quot; to work &#8211; there&#8217;s nothing inherently &quot;admin-y&quot; about installing software PER-SE. As long as you install it into your own profile folder, and don&#8217;t try to install it for all users.</p>
<p>The problem is that many installers simply refuse to run if you&#8217;re not an administrator, or they try to write to HKLM or C:Program Files, and you&#8217;ve got way to stop them.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422643">
				<div id="div-comment-422643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422643">
			September 21, 2006 at 2:18 pm</a>		</div>

		<p>Exactly as Neal C just said &#8212; sudo doesn&#8217;t have to ask you for the administrator&#8217;s password (but runas does). &nbsp;Sudo can be configured to either ask you for your own password, or no password at all. &nbsp;Or different settings depending on what command you&#8217;re running.</p>
<p>(And &quot;sudo setup best practices&quot; obviously include only setting this up for a small number of specific commands, excluding anything that will give the user a (root) shell.)</p>
<p>However, reading Raymond&#8217;s response to Stu, I&#8217;d have to agree. &nbsp;If you&#8217;re allowed to install anything, you can (very likely) install a kernel-mode driver, such as a screen-scraper or a keylogger. &nbsp;It may be possible to make changes that would limit this capability (and maybe not), but AFAIK nothing exists today in Windows to do that. &nbsp;So Raymond&#8217;s right: even a sudo equivalent wouldn&#8217;t help with that.</p>
<p>(In fact, even on a system that has sudo, it *may* be possible to install a spyware-type program. &nbsp;Using Debian as an example (just because I know it fairly well), say you allow &quot;sudo apt-get install&quot;, and only that, for a certain user. &nbsp;If that user can find a package in one of the package repositories that are listed in apt-get&#8217;s sources.list file, they would be able to install that package. &nbsp;Of course hopefully Debian wouldn&#8217;t include a spyware package in their official package repos, but I wouldn&#8217;t want to bet on that being the *only* line of defense, either.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422703">
				<div id="div-comment-422703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422703">
			September 21, 2006 at 3:24 pm</a>		</div>

		<p>&gt; The problem with sudo is that it requires specific commands.</p>
<p>Actually, it doesn&#8217;t. &nbsp;You can allow a user access to anything if you want, but then you&#8217;ve basically given them root. &nbsp;(That&#8217;s why the &quot;best practices&quot; are to limit by command. &nbsp;But it&#8217;s not a requirement of using the program.)</p>
<p>Even so, see below.</p>
<p>&gt; How do I know in advance what command is going to be used to install the software that somebody&#8217;s going to need?</p>
<p>It&#8217;ll be &quot;apt-get install &lt;some-package-name&gt;&quot; on Debian, preferably with no other arguments. &nbsp;(Or possibly &quot;dpkg -i &lt;blah&gt;.deb&quot;, but that bypasses the sources.list check, and &#8212; IMO anyway &#8212; should require root, not just sudo privileges. &nbsp;Same with &quot;make install&quot;. &nbsp;For that matter, same with anything else that bypasses the dpkg database. &nbsp;Actually, there&#8217;s not that much that *isn&#8217;t* available in one official Debian repository or another, so this shouldn&#8217;t come up all that often either.)</p>
<p>Sudo can filter on more than just which program they&#8217;re running; it can filter on all the arguments they give to it.</p>
<p>&gt; And what&#8217;s to say that they don&#8217;t have the &quot;evil&quot; version of that command that installs spyware instead of what they&#8217;re supposed to have? </p>
<p>They don&#8217;t have write permission to /bin or /usr/bin, so they can&#8217;t have replaced the apt-get executable. &nbsp;(Or whichever executable your distro uses to install packages.) &nbsp;Now, they might be able to install a different apt package that overwrites the binary, then use that to install something else. &nbsp;Hmm. &nbsp;But again, this would require that either someone put the evil package&#8217;s repository into sources.list, or the evil package got into Debian&#8217;s official sources.list.</p>
<p>Still probably unlikely, but it&#8217;s still a single line of defense. &nbsp;Sudo&#8217;s not a panacea, I guess I&#8217;m saying, but it is helpful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422803">
				<div id="div-comment-422803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422803">
			September 21, 2006 at 10:49 pm</a>		</div>

		<p>Err, what happens if you don&#8217;t trust your Administration? For instance, shouldn&#8217;t an OS come with checks and balances, so that there are two kinds of Administrators, one (called the Executive) who can do all the usual Admin things, EXCEPT for administering auditing. The other administrator can audit what the Executive has done. That way, if the Executive stores 14 illegal files in his Gitmo folder, the auditor is able to catch him out.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422823">
				<div id="div-comment-422823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422823">
			September 21, 2006 at 11:51 pm</a>		</div>

		<blockquote><p>
  but the Administrator can always take<br />
  <br />&gt; ownership of the file and read the contents<br />
  <br />&gt; that way</p>
<p>That&#8217;s only if the Administrator can access the file. &nbsp;There are still famous occurences where Administrator can&#8217;t delete a file because some process (in these cases not usually the System process) has the file locked. &nbsp;There are still famous occurences where Administrator can&#8217;t kill a process (where Task Manager goes through the motions over and over but with no effect). &nbsp;Just figure out how to cause these situations deliberately and combine the two.</p>
<p>If Administrator has physical access and can boot the machine to safe mode (or boot a Knoppix DVD) then you&#8217;ve still lost. &nbsp;You need to encrypt your secrets in such a case.</p>
<p>However, for practical purposes, it might still be meaningful to set roadblocks that slow down the Administrator. &nbsp;For comparison, untrusted government agents can break into your house at any time, so it&#8217;s useless to lock your house, yet you often lock your house anyway. &nbsp;Even some of my in-laws, once they could afford to build a kind of house which could have doors that could be locked, they started locking their house.</p>
<p>Thursday, September 21, 2006 3:02 PM by Rhomboid<br />
  <br />&gt; I read [&#8230;] &#8220;Power Users are just users that<br />
  <br />&gt; have not made themselves Administrators yet.&#8221;</p>
<p>True, just like someone who&#8217;s a member of the wheel group and who knows root&#8217;s password but who hasn&#8217;t typed an su command during this session is an administrator who hasn&#8217;t made herself an administrator yet. &nbsp;Anyone who ever noticed that they had to correct one of their own mistakes will want to help themselves out by having the power to become administrator when necessary but not have that power enabled most of the time.</p>
<div CLASS=post>[<i>I thought we went through this already. <a href="http://blogs.msdn.com/oldnewthing/archive/2004/07/23/192531.aspx" rel="nofollow">The process really is dead, but some buggy kernel component is not cleaning up</a>. It&#8217;s a bug, not a feature. -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422853">
				<div id="div-comment-422853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">required</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422853">
			September 22, 2006 at 3:58 am</a>		</div>

		<p>Raymond&gt; You just need access to the network cable anywhere between the target machine and the Debian server</p>
<p>How does Windows Update get around this problem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422863">
				<div id="div-comment-422863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://codeka.com/blogs' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422863">
			September 22, 2006 at 4:46 am</a>		</div>

		<blockquote><p>
  How does Windows Update get around this problem?</p>
<p>Updates are digitally signed.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-422873">
				<div id="div-comment-422873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sandman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422873">
			September 22, 2006 at 4:49 am</a>		</div>

		<blockquote><p>
  but the Administrator can always take<br />
  <br />&gt; ownership of the file and read the contents<br />
  <br />&gt; that way .</p>
<p>Doesn&#8217;t this what NTFS encryption provide a way to limit the usefulness of this , is for as your key recovery agents/users can be an different set of people from your administrators.</p>
<p>But in general I agree with Raymond, trying to limit the admin access is foolish, any likely to only lead to trouble. Consider the case of a possibly corrupted file in &nbsp;a less techno savvy user profile, which is the administrator si restrited from access but is prevent the user logon in some way.<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422923">
				<div id="div-comment-422923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422923">
			September 22, 2006 at 10:02 am</a>		</div>

		<p>[You&#8217;re asking for a contradiction. If I can install software, then I can install spyware, and therefore I can read other users&#8217; files. -Raymond]</p>
<p>I&#8217;d be surprised. If a user can install software, he can install spyware that reads his files. Not other users&#8217; files, or the administrators files.</p>
<p>If you can bypass Read ACLs in spyware, you can almost certainly also bypass Write ACLs, overwrite Notepad.exe with a Trojan and gain admin rights that way. Write permissions are not magically stronger than read permissions. ACLs either work or they don&#8217;t. They&#8217;re not advisory like the read-only attribute.</p>
<p>The problem indicated is real. Too many installers require admin access. </p>
<div CLASS=post>[<i>Now you&#8217;re taking the problem out of context. If the program installed per-user then this whole topic wouldn&#8217;t exist since there would be no need for these imaginary &#8220;Administrators with limited powers&#8221;. Clearly the context is &#8220;Programs that require administrative privileges to install&#8221;. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-423193">
				<div id="div-comment-423193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Amon Houndsbreath</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-423193">
			September 22, 2006 at 1:55 pm</a>		</div>

		<p>&quot;For comparison, untrusted government agents can break into your house at any time, so it&#8217;s useless to lock your house, yet you often lock your house anyway.&quot;</p>
<p>I guess the government is a sort of administrator of the country, i.e. it must be considered to be trusted. E.g. there are lots of things that you might thing the government should be prevented from doing, since if extremists took over the government they may abuse those powers. The problem is that if extremists take over the government they could change the laws to allow whatever they wanted. </p>
<p>So sometimes you&#8217;re better off allowing a government, particularly one you trust, to do things that seem illiberal but help to minimise the chances that extremists can take over.</p>
<p>Certainly, if you look at the UK in WWII, the coalition government did highly illiberal things like suspending elections, detaining pro German politicians for the duration of the war to &nbsp;being replaced by an overtly totalitarian Nazi puppet regime. Once the war was over, the coalition split and the Prime Minister&#8217;s party lost the election. In many ways, it was a dictatorship in the Roman sense.</p>
<p>Of course, you have to be careful of the situatuon where extremists win an election and use this argument to set up one kind of totalitarian regime whilst claiming to be defending the status quo against another. On the other hand the US constitution should theoretically protect against this sort of possibility.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422893">
				<div id="div-comment-422893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-422893">
			September 22, 2006 at 8:27 am</a>		</div>

		<p>&gt; apt-get accepts &quot;-c&quot;</p>
<p>But sudoers doesn&#8217;t have to allow &quot;apt-get -c anything&quot; to execute. &nbsp;Again, it can check *more* than just the command that&#8217;s being run; when using sudo, you give sudo the entire command you want it to run, and it will check all arguments.</p>
<p>As for apt&#8217;s repository: &nbsp;The packages are all hashed (with either MD5 or SHA-1, can&#8217;t remember which). &nbsp;Then the list of hashes is signed by the official GnuPG-key-of-the-year. &nbsp;So assuming your gpg binary is OK, and assuming you&#8217;ve installed the key-of-the-year (this is a problem, as Stu points out; IMO it should be more automatic than it is, but others may not agree), you can verify that the packages have not been tampered with between the server and you.</p>
<p>I believe that current Debian installs will add the current year&#8217;s signing key automatically (or at least, the box we have here did that), but that&#8217;s still only good until the end of the current year.</p>
<p>(Of course, if someone *wants* to install spyware, then they could just hit &quot;Y&quot; to the &quot;this package is failing verification&quot; message, too. &nbsp;If that&#8217;s still an option, anyway.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-423163">
				<div id="div-comment-423163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-423163">
			September 22, 2006 at 1:22 pm</a>		</div>

		<p>Thinking about this some more, encryption isn&#8217;t the answer to preventing administrators from seeing your files&#8217; contents either. &nbsp;At least not NTFS encryption (aka EFS), and not CryptProtectData() either.</p>
<p>EFS and CryptProtectData() are based on your user password (basically; I&#8217;m omitting a bunch of details here). &nbsp;If you&#8217;re logged on as you, you get access to your EFS files, and you can CryptUnprotectData() anything that you&#8217;ve CryptProtectData()ed in the past.</p>
<p>However, your admin can do all kinds of things to figure out your password &#8212; my favorite is installing a password-change hook DLL on the local DC that writes the new password out somewhere. &nbsp;(We actually do that here, both because people keep forgetting their passwords, and because we sometimes need to log on as them &#8212; or unlock their screen without forcibly terminating all their programs &#8212; when they&#8217;re not here. &nbsp;The target directory has *very* restrictive ACLs on it, of course, and of course it&#8217;s a local directory, so the information isn&#8217;t floating out over the network.) &nbsp;And if your admin has your password, they can log on as you and see your encrypted files (or CryptUnprotectData() your data).</p>
<p>The only way to stop this is to use an encryption program (or function) that isn&#8217;t based on your user credentials, because the admin has those. &nbsp;Also, you&#8217;ll have to make it require you to type in some passphrase value before it&#8217;ll decrypt anything. &nbsp;Then don&#8217;t use a passphrase that&#8217;s the same as your password, and don&#8217;t write it down anywhere.</p>
<p>Certainly possible, but not as simple as some are claiming either.</p>
<p>(And herein, I am assuming that &quot;administrator&quot; means &quot;domain admin, with admin access to the DC&quot;. &nbsp;This is valid for any machine on a domain. &nbsp;It&#8217;s not valid for any machine in a home environment, but in a non-domain setup, the administrator can just install their password-change filter DLL on the local machine instead of the DC. &nbsp;The only setup that EFS *might* help with is against a local admin who is *not* a domain admin. &nbsp;Maybe.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-423433">
				<div id="div-comment-423433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulirc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-423433">
			September 23, 2006 at 3:29 pm</a>		</div>

		<p>yikes, did someone just use a blog entry about computer security management to make a political statement? &nbsp;I think I&#8217;ll go take a shower.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-423653">
				<div id="div-comment-423653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dilemma</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-423653">
			September 25, 2006 at 5:00 am</a>		</div>

		<p>Many windows program require the user to be &quot;administrator&quot;. How do I solve this without allowing them to do harmful things?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-423733">
				<div id="div-comment-423733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-423733">
			September 25, 2006 at 8:13 am</a>		</div>

		<p>dilemma &#8212; You can&#8217;t.</p>
<p>You can try complaining to the author of the software, but that rarely does any good.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427083">
				<div id="div-comment-427083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mary</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-427083">
			October 3, 2006 at 11:19 pm</a>		</div>

		<p>Good design!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427093">
				<div id="div-comment-427093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-427093">
			October 3, 2006 at 11:19 pm</a>		</div>

		<p>Well done!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-427103">
				<div id="div-comment-427103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Patrick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-427103">
			October 3, 2006 at 11:20 pm</a>		</div>

		<p>Nice site!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427163">
				<div id="div-comment-427163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris_R</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060921-02/?p=29643#comment-427163">
			October 4, 2006 at 7:49 am</a>		</div>

		<p>So why does Vista have UAC then?</p>
<div class=post>[<i>Type &lt;site:microsoft.com Vista UAC&gt; into your favorite search engine. One of the hits is <a href="http://www.microsoft.com/technet/windowsvista/security/uac.mspx" mce_href="http://www.microsoft.com/technet/windowsvista/security/uac.mspx" rel="nofollow">this page</a>. I have no idea what your question has to do with one administrator trying to stop another administrator. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

