<html>
<head>
<title>Taking advantage of the asymmetry of offline compression</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Taking advantage of the asymmetry of offline compression</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 26, 2018 / year-entry #146</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>15</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">You can spend a lot of time compressing, but decompression still needs to be fast.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
Online compression is a difficult balancing act.
Time you spend trying to get good compression is time the
user could have been using to do something useful.
For the same reason, the decompression algorithm needs to
be relatively fast as well.
And since files support random access,
you need to be able to compress and decompress an arbitrary
location in the file,
which typically means that the file is broken down into chunks
which are compressed and decompressed independently.
</p>
<p>
Windows comes in a large compressed image,
and
starting in Windows 8.1,
<a HREF="http://web.archive.org/web/20160305185419/https://blogs.windows.com/itpro/2014/04/10/what-is-windows-image-boot-wimboot/">
systems can be configured so that the "files" on disk are really
pointers into the compressed image</a>
which Windows can decompress on the fly as if they were real files.
Windows 10
<a HREF="https://blogs.windows.com/windowsexperience/2015/03/16/how-windows-10-achieves-its-compact-footprint/">
expands this technique to all systems</a>
if an assessment determines that the system would benefit from it.
</p>
<p>
Offline compression with online decompression means that you
can spend a lot of time in the compression step,
since users never have to sit around waiting for the compression
to take place.
The compression can take place in a lab on a machine with
a large amount of memory and CPU resources available,
in order to eke out as much compression goodness as possible;
only the compressed results need to be delivered to the user.
On the other hand, decompression is still done in real-time,
so the compression algorithm needs to be one that can still
decompress relatively quickly.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1 parent" id="comment-1348965">
				<div id="div-comment-1348965" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1348965">
			June 26, 2018 at 7:17 am</a>		</div>

		<p>That&#8217;s fancy. Wish the boot from installation media (the progress bar phase) used it.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1348975">
				<div id="div-comment-1348975" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1348975">
			June 26, 2018 at 7:28 am</a>		</div>

		<p>You gotta try installing from USB instead of optical media sometime.  That phase is much faster.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-archangelpip even depth-3" id="comment-1349005">
				<div id="div-comment-1349005" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Darran+Rowe' rel='external nofollow' class='url'>Darran Rowe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349005">
			June 26, 2018 at 8:06 am</a>		</div>

		<p>Yeah, I install Windows using a USB flash drive all the time, it makes the driver installation and the OOBE the slowest part of setup by far.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt depth-3" id="comment-1349625">
				<div id="div-comment-1349625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349625">
			July 1, 2018 at 10:39 am</a>		</div>

		<p>Most of the time, I&#8217;m installing from an ISO image over iDRAC or its equivalent (Raritan). Inside, iDRAC controller is connected through USB 1.1.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-iboyd even thread-odd thread-alt depth-1 parent" id="comment-1349055">
				<div id="div-comment-1349055" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349055">
			June 26, 2018 at 11:36 am</a>		</div>

		<p>With the size of the Windows installation, there may be some areas where you can have a large, Windows-specific, dictionary; looking across 10&#8217;s of gigabytes across thousands of files.</p>
<p>The copyright and build string common to 750 dlls can populate the master decompression dictionary.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-kadu_cortez odd alt depth-2 parent" id="comment-1349075">
				<div id="div-comment-1349075" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kc0rtez' rel='external nofollow' class='url'>kc0rtez</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349075">
			June 26, 2018 at 2:52 pm</a>		</div>

		<p>Lol, we should gather information on how much space copyright stuff takes in microsoft products just for the sake of curiosity and to make salty remarks on it like <b> &#8220;Oh, Microsoft takes 1% of my hard disk just to make sure it can sue me&#8221; </b>.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-3" id="comment-1349095">
				<div id="div-comment-1349095" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349095">
			June 26, 2018 at 9:01 pm</a>		</div>

		<p>On an ordinary 1 TiB hard disk, 1% is like 10 GiB. That&#8217;s 2/3rd of Windows&#8217;s size. I count 26,420 .exe and .dll files on my system belonging to Windows. So, those stuff should take around 1,321,000 bytes or 1.26 MiB.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command odd alt thread-even depth-1 parent" id="comment-1349105">
				<div id="div-comment-1349105" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349105">
			June 26, 2018 at 9:08 pm</a>		</div>

		<p>Wow! This blog&#8217;s comment is refusing to display my whole comment above! Why? Because it has math calculations in it? </p>
<p>Tell you what, this blog win the award for the funniest acting comment section on the web.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1349125">
				<div id="div-comment-1349125" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349125">
			June 27, 2018 at 6:40 am</a>		</div>

		<p>Less than and greater than signs most likely.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command odd alt depth-3 parent" id="comment-1349175">
				<div id="div-comment-1349175" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349175">
			June 27, 2018 at 12:24 pm</a>		</div>

		<p>Very astute! But no. And anyway, unless I use them at the very beginning and the very end, it shouldn&#8217;t cause the whole comment to go. Add the fact that I&#8217;ve been having problem with the comment system of this certain blog for a long time now. I can&#8217;t write multi-paragraph comments while others can. (It joins the paragraphs together.)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1349205">
				<div id="div-comment-1349205" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scarlet Manuka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349205">
			June 28, 2018 at 2:11 am</a>		</div>

		<p>In a recent comment, Raymond noted that the blog hosting software seems to mistrust any commenter without (I think it was) an MSDN login, and he has to manually approve about 90% of comments. So nobody (except the privileged few) should expect to see their comments straight away.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-5" id="comment-1349215">
				<div id="div-comment-1349215" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349215">
			June 28, 2018 at 6:57 am</a>		</div>

		<p>Yup, I have to remember to check in every few hours to approve comments. And when I&#8217;m on vacation, it may be days before I get around to it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even depth-5" id="comment-1349405">
				<div id="div-comment-1349405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349405">
			June 28, 2018 at 3:51 pm</a>		</div>

		<p>Well, that&#8217;s not my problem either. I do have an &#8220;MSDN login&#8221; as you call it. And I do see my comment immediately; albeit, without the body text and without the delete button.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-5" id="comment-1349485">
				<div id="div-comment-1349485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349485">
			June 28, 2018 at 6:11 pm</a>		</div>

		<p>My guess is that comment disappeared because the server saw the &lt; and interpreted it as the start of an HTML tag. When it never saw a matching &gt; it decided to &#8220;fix&#8221; the problem by throwing the corrupted &#8220;tag&#8221; away.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1349375">
				<div id="div-comment-1349375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://www.alpinesoft.co.uk' rel='external nofollow' class='url'>Paul Sanders</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180626-00/?p=99095#comment-1349375">
			June 28, 2018 at 1:52 pm</a>		</div>

		<p>And I bet whoever designed the preprocessor is spinning in his grave.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

