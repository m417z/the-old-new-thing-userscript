<html>
<head>
<title>How can I move an HTREEITEM to a new parent?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How can I move an HTREEITEM to a new parent?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>April 3, 2013 / year-entry #92</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>10</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Suppose you have a TreeView control, and you created an item in it, and you want to move the HTREEITEM to a new parent. How do you do that? You can't, at least not all in one motion. You will have to delete the HTREEITEM and then re-create it in its new location. If you...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Suppose you have a TreeView control, and you created an item in it, and you want to move the <code>HTREEITEM</code> to a new parent. How do you do that?</p>
<p> You can't, at least not all in one motion. </p>
<p> You will have to delete the <code>HTREEITEM</code> and then re-create it in its new location. </p>
<p> If you want to move an <code>HTREEITEM</code> within the same parent (say, to reorder it among its siblings), then you can use <a href="http://msdn.microsoft.com/library/bb773785.aspx"> <code>Tree&shy;View_<wbr>Sort&shy;Children&shy;CB</wbr></code></a> and pass a custom sort function that rearranges the children into the order you want. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-bboorman even thread-even depth-1" id="comment-1048633">
				<div id="div-comment-1048633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048633">
			April 3, 2013 at 7:04 am</a>		</div>

		<p>Seems rather 1950&#39;s-ish to not recognize that TreeView_PerformAdoptionProc() should exist. Poor child items don&#39;t even get to go to TreeView_Orphanage().</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1048693">
				<div id="div-comment-1048693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ajgelado_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>ajgelado@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048693">
			April 3, 2013 at 10:31 am</a>		</div>

		<p>Raymond, you forgot to say that features start with -100 points and aren&#39;t implemented by default, and then cite the story of the TreeView control as something the Explorer team made for themselves for a very precise use and then decided to share with the rest of the world :-) .</p>
<p>Back in they days of the Apple II, you could not move a file to a different directory (let alone another drive) in a single call. You had to create the new file, copy the file contents and the metadata, and then delete the old file. You had the building bricks and was supposed to know how to use them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1048703">
				<div id="div-comment-1048703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048703">
			April 3, 2013 at 12:46 pm</a>		</div>

		<blockquote><p>
  Back in they days of the Apple II, you could not move a file to a different directory (let alone another drive) in a single call. You had to create the new file, copy the file contents and the metadata, and then delete the old file. You had the building bricks and was supposed to know how to use them.
</p></blockquote>
<p>That must suck. Atomic rename is one of the few guaranteed atomics on the filesystem on portable code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1048713">
				<div id="div-comment-1048713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CATALOG</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048713">
			April 3, 2013 at 2:26 pm</a>		</div>

		<p>I don&#39;t remember there being directories on an Apple II&#8230; though I was a little kid and only used Apple DOS 3.3 on a //e</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1048733">
				<div id="div-comment-1048733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ajgelado_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>ajgelado@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048733">
			April 3, 2013 at 4:11 pm</a>		</div>

		<p>@CATALOG: In the old Apple DOS 3.x there wasn&#39;t directories. But ProDOS, which used a device-independent filesystem (inherited from Apple III&#39;s SOS), did allow them. And had a decent software interface, with a single entry point, well-defined functions, and a coherent parameter passing convention, all of which Apple DOS lacked (but hey, its kernel and command line interpreter used just 10 KB of RAM &#8211; those were the times!).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1048743">
				<div id="div-comment-1048743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ajgelado_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>ajgelado@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048743">
			April 3, 2013 at 4:20 pm</a>		</div>

		<p>@Joshua: those were the days when if you wanted to port a program, you had to rewrite most of it. With between 30 and 60 KB of available memory (even less if you used graphics modes, which in many machines used the system RAM), most programs were written in assembler, and plugging a runtime library of 10 KB was an overkill.</p>
<p>Developing for 8 bit machines was a completely different game, not because you didn&#39;t have commodities (C compiler, graphics libraries, etc.), but because you couldn&#39;t afford them if you didn&#39;t want your customers to buy a memory expansion just to run your application.</p>
<p>And to stay in topic, it still amazes me how much Windows 95 managed to achieve with just 4 MB of RAM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1048753">
				<div id="div-comment-1048753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Smouch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048753">
			April 3, 2013 at 10:31 pm</a>		</div>

		<p>So, when the HTREEITEM has children, who also have children, I&#39;m forced to iterate through all that mess, adding, and deleting any number of items rather than simply re-parenting a single item. &nbsp;That&#39;s why I hate working with most GUI toolkits, unlike perl, they make the trivial things a pain, and the only slightly complicated things downright impossible.</p>
<p>Just goes to show how a properly designed toolkit makes all the difference.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jan-ringos odd alt thread-odd thread-alt depth-1" id="comment-1048773">
				<div id="div-comment-1048773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Jan+Ringo%C5%A1' rel='external nofollow' class='url'>Jan Ringoš</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048773">
			April 3, 2013 at 11:45 pm</a>		</div>

		<p>@Smouch: Why do all this? If you know the target Tree-View layout you can easily synthesize comparison function for TreeView_SortChildrenCB.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jan-ringos even thread-even depth-1" id="comment-1048783">
				<div id="div-comment-1048783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Jan+Ringo%C5%A1' rel='external nofollow' class='url'>Jan Ringoš</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048783">
			April 3, 2013 at 11:48 pm</a>		</div>

		<p>Ah, sorry, read your comment again. Please disregard my previous think-o.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-1048893">
				<div id="div-comment-1048893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130403-00/?p=4763#comment-1048893">
			April 5, 2013 at 7:04 am</a>		</div>

		<p>@Antonio &#39;Grijan&#39;: Possibly the fact that Windows 95 had to run in 4MB of RAM, and be sufficiently responsive on a 40MHz 386DX, is why TreeView doesn&#39;t support re-parenting an item. If items can be reparented, it introduces another layer of indirection, which is likely to have both time and space costs.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

