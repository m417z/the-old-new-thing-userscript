<html>
<head>
<title>When programs assume that the system will never change, episode 3</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>When programs assume that the system will never change, episode 3</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>January 9, 2006 / year-entry #14</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>37</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">One of the stranger application compatibility puzzles was solved by a colleague of mine who was trying to figure out why a particular program couldn't open the Printers Control Panel. Upon closer investigation, the reason became clear. The program launched the Control Panel, used FindWindow to locate the window, then accessed that window's "File" menu...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
One of the stranger application compatibility puzzles
was solved by a colleague of mine who was trying to figure
out why a particular program couldn't open the Printers
Control Panel.
Upon closer investigation, the reason became clear.
The program launched the Control Panel,
used <code>FindWindow</code> to locate the window,
then accessed that window's "File" menu and extracted the strings from
that menu looking for an item that contained the word "Printer".
It then posted a <code>WM_COMMAND</code> message to the Control Panel
window with the menu identifier it found, thereby simulating the
user clicking on the "Printers" menu option.
</p>
<p>
With Windows&nbsp;95's Control Panel, this method fell apart
pretty badly.
There is no "Printers" option on the Control Panel's File menu.
It never occurred to the authors of the program that this was
a possibility.
(Mind you, it was a possibility even in Windows&nbsp;3.1:
If you were running a non-English version of Windows, the
name of the Printers option will be something like
"Skrivare" or "Drucker".
Not that it mattered, because the "File" menu will be called
something like "Arkiv" or "Datei"!
The developers of this program
simply assumed that everyone in the world speaks English.)
</p>
<p>
The code never checked for errors; it plowed ahead on the
assumption that everything was going according to plan.
The code eventually completed its rounds and sent a
garbage <code>WM_COMMAND</code> message to the Control Panel window,
which was of course ignored since it didn't match any of the
valid commands on that window's menu.
</p>
<p>
The punch line is that
the mechanism for opening the Printers Control Panel
was rather clearly spelled out
on the very first page of the "Control Panel" chapter of
the Windows&nbsp;3.1 SDK:
</p>
<blockquote CLASS=q>
<p>
The following example shows how an application can start Control Panel
and the Printers application from the command line by using the WinExec
function: 
</p>
<pre>
    WinExec("control.exe printers", SW_SHOWNORMAL);
</pre>
</blockquote>
<p>
In other words, they didn't even read past the first page.
</p>
<p>
The solution:
Create a "decoy" Control Panel window with the same class name
as Windows&nbsp;3.1, so that this program would find it.
The purpose of these "decoys" is to draw the attention of the
offending program,
taking the brunt of the mistreatment and doing what they can to
mimic the original behavior enough to keep that program happy.
In this case, it waited patiently for the garbage
<code>WM_COMMAND</code> message to arrive and dutifully launched
the Printers Control Panel.
</p>
<p>
Nowadays, this sort of problem would probably have been solved with the
use of a shim.
But this was back in Windows&nbsp;95, where application compatibility
technology was still comparatively immature.
All that was available at the time were application compatibility flags
and hot-patching of binaries,
wherein the values are modified as they are loaded into memory.
Using hot-patching technology was reserved for only the most extreme
compatibility cases, because getting permission from the vendor
to patch their program was a comparatively lengthy legal process.
Patching was considered a "last resort" compatibility mechanism
not only for the legal machinery necessary to permit it,
but also because patching a program fixes only the versions of
the program the patch was developed to address.
If the vendor shipped ten versions of a program,
ten different patches would have to be developed.
And if the vendor shipped another version after Windows&nbsp;95
was delivered to duplication, that version would be broken when
Windows&nbsp;95 hit the shelves.
</p>
<p>
It is important to understand the distinction between what is
a documented and supported feature and what is an implementation detail.
Documented and supported features are contracts between Windows and
your program.
Windows will uphold its end of the contract for as long as that feature
exists.
Implementation details, on the other hand, are ephemeral;
they can change at any time,
be it at the next major operating system release,
at the next service pack,
even with the next security hotfix.
If your program relies on implementation details,
you're contributing to the compatibility cruft
that Windows carries around from release to release.
</p>
<p>
Over the next few days, I'll talk about other decoys
that have been used in Windows.
</p>
<p>
[Somebody caught my misspelling of "Drucker" while I was fixing it! - 7:45am]</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (37)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-335393">
				<div id="div-comment-335393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.gnegg.ch' rel='external nofollow' class='url'>Philip Hofstetter</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335393">
			January 9, 2006 at 10:13 am</a>		</div>

		<p>Hi,</p>
<p>not to be picky, but the german word for &#8216;printer&#8217; is &#8216;Drucker&#8217;. Not &#8216;Dr&#252;cker&#8217;.</p>
<p>Dr&#252;cker is something like a hard pull, but not really used except in the proverb &#8216;auf den letzten Dr&#252;cker&#8217; which means something like &#8216;in the last moment&#8217;</p>
<p>Philip</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335403">
				<div id="div-comment-335403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Diego</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335403">
			January 9, 2006 at 10:48 am</a>		</div>

		<p>I&#8217;m happy that we have internet today and companies can update their programs online, it makes possible to break such programms and bug the companies instead of microsoft</p>
<p>(actually, one of features I miss in windows is a sort of system-integrated automatic updater which updates software looking at a URL provided by the software installer which points out to a XML file which tells the system if there&#8217;s a new version, i hope longhorn has it :/)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335413">
				<div id="div-comment-335413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nate</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335413">
			January 9, 2006 at 10:55 am</a>		</div>

		<p>I&#8217;ve seen &quot;When programs assume that the system will never change, episode 1&quot;, and now we are at episode 3.  What happened to &quot;episode 2&quot;?  Google can&#8217;t find it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335433">
				<div id="div-comment-335433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/frankpr' rel='external nofollow' class='url'>FrankPr</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335433">
			January 9, 2006 at 11:02 am</a>		</div>

		<p>Diego: No, Longhorn &#8230; err, Windows Vista as the OS cannot provide this feature (except for OS components, which means Microsoft Update), but .NET 2.0, e.g., has something like that, and it&#8217;s called ClickOnce.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008195987d even thread-even depth-1" id="comment-335453">
				<div id="div-comment-335453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Spire' rel='external nofollow' class='url'>Spire</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335453">
			January 9, 2006 at 11:18 am</a>		</div>

		<p>Nate: That&#8217;s what you get when you assume that the system of numerals will never change. Now poor Raymond will have to create a decoy &quot;episode 2&quot; article to make you happy.</p>
<p>(&quot;It was just a dream, Bender. There&#8217;s no such thing as &#8216;2&#8217;.&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335463">
				<div id="div-comment-335463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arnold</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335463">
			January 9, 2006 at 11:19 am</a>		</div>

		<p>Diego<br />
<br />&gt; I&#8217;m happy that we have internet today and companies can update their programs online, it makes possible to break such programms and bug the companies instead of microsoft </p>
<p>Ah, but how do you tell when it&#8217;s the program and when it&#8217;s Windows? I think a lot of people would (incorrectly) assume it&#8217;s &quot;just another windows brokenness&quot;</p>
<p>I wish Raymond could say who it was, so we could avoid their broken crap. If they can&#8217;t do something this basic correctly, I&#8217;m not trusting anything their program does.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335473">
				<div id="div-comment-335473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arnold</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335473">
			January 9, 2006 at 11:28 am</a>		</div>

		<blockquote><p>
  I wish Raymond could say who it was</p>
<p>Maybe MS could put up a page of &quot;errata/coding mistakes we&#8217;ve noticed&quot; and name these morons&#8230;</p>
<p>This would create a &quot;you better do it right, you don&#8217;t want to end up on the errata pages&quot; clue bat.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-universalis odd alt thread-odd thread-alt depth-1" id="comment-335483">
				<div id="div-comment-335483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Universalis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335483">
			January 9, 2006 at 11:30 am</a>		</div>

		<p>Diego, you mean something like the registry key HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionUninstallappnameURLUpdateInfo ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335493">
				<div id="div-comment-335493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fred</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335493">
			January 9, 2006 at 11:31 am</a>		</div>

		<p>&quot;Nowadays, this sort of problem would probably have been solved with the use of a shim.&quot;</p>
<p>Can you explain how this would have been solved today? I don&#8217;t understand what a &quot;shim&quot; would do for you here or why it would be different.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335513">
				<div id="div-comment-335513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335513">
			January 9, 2006 at 2:14 pm</a>		</div>

		<blockquote><p>
  Ah, but how do you tell when it&#8217;s<br />
  <br />&gt; the program and when it&#8217;s Windows?<br />
  <br />&gt; I think a lot of people would<br />
  <br />&gt; (incorrectly) assume it&#8217;s &quot;just<br />
  <br />&gt; another windows brokenness&quot; </p>
<p>With a dialog box?  Do it the same way DEP tells you that the application wasn&#8217;t written to be forward compatible and is at fault for doing something it isn&#8217;t supposed to be doing and to contact the application vendor for an update.</p>
<p>It seems like many of these compatibility hacks could be phased out (or are they already?): add the compatibility hack but initially warn that the application is doing something wrong.  As time progresses, the warnings could become more annoying and the hack eventually could be removed.</p>
<p>But then, I suppose some users still would say, &quot;I upgraded my OS and now application X stopped working,&quot; or, &quot;If Windows knows application X is doing something wrong but goes ahead and makes it work anyway, so why does it need to bother me about it?&quot;
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-335523">
				<div id="div-comment-335523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335523">
			January 9, 2006 at 2:52 pm</a>		</div>

		<p>DEP is special in that the boundary between &#8216;right&#8217; and &#8216;wrong&#8217; is quite clear. Most compatibility problems are not that easy to detect progammatically. If an app calls lstrcmpi and passes &quot;Printers&quot;, is that right or wrong?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335533">
				<div id="div-comment-335533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pete</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335533">
			January 9, 2006 at 4:06 pm</a>		</div>

		<p>Fred &#8211; A shim is per-app, whereas in Win95 the fix had to be in the main .dll (or .exe in this case). The major difference is cleaner code since the main dlls are not cluttered up with thousands of fixes for broken applications.</p>
<p>In both cases the fix whould have been the same, the only difference is how it gets loaded.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-335563">
				<div id="div-comment-335563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335563">
			January 9, 2006 at 5:02 pm</a>		</div>

		<p>&quot;How did you detect this particular one?&quot;</p>
<p>The old fashioned way: A bug report was filed against the application, one of my colleagues spent several hours debugging it.</p>
<p>Sure, code could be added to the core operating system to detect &quot;somebody posting this particular bad WM_COMMAND value to that particular window&quot;, but (1) that clutters the core OS with application hacks that are active even for programs not known to be buggy, and (2) you still have to spend the several hours determine which bad WM_COMMAND values and which windows should be flagged. It&#8217;s still not automatic. Somebody had to spend the hours debugging the program to figure out what the bad operation is.</p>
<p>And what if someday there is a change to the Control Panel where that WM_COMMAND value becomes legal again? Are you saying that every change to Explorer must be synchronized with a change to user32?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335573">
				<div id="div-comment-335573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Maas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335573">
			January 9, 2006 at 5:58 pm</a>		</div>

		<p>&quot;process &lt;whatever&gt; is broken! It&#8217;ll work for now, but maybe not if you upgrade Windows&quot;</p>
<p>Argh, I loathe stuff like this. I already have enough work to do at my job. I should not have to worry about whether my applications will break if I upgrade my OS. MS or the vendor can fix it, I don&#8217;t care, just don&#8217;t give me more work to do.</p>
<p>(a related pet peeve: pop-ups like &quot;Adobe Updater needs your attention!&quot; &quot;A flash player update is available!&quot;&#8230; Yes, I&#8217;m sure the developers are proud of the update system they wrote. But I should not have to deal with this crap popping up when I&#8217;m one hour from a client deadline&#8230; I&#8217;ve already got enough to worry about.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335583">
				<div id="div-comment-335583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335583">
			January 9, 2006 at 6:14 pm</a>		</div>

		<p>It was just a dream, Bender. There&#8217;s no such thing as &#8216;2&#8217;.</p>
<p>So true :) But then this would have to be episode 11.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335603">
				<div id="div-comment-335603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrDoom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335603">
			January 9, 2006 at 10:11 pm</a>		</div>

		<p>I have been writing code (scripting) for a couple of years now. I am a network administrator and not a programmer; I like to automate mundane tasks that take up most of time.</p>
<p>What I have found is that there are so many articles on how to performer specific tasks, most of them are cut and paste jobs from Microsoft website. Articles like this one: on what not to do are few. In most cases hhen such articles exist they are designed for general amusement rather then education. A good example of one such site is <a rel="nofollow" target="_new" href="http://www.thedailywtf.com/" rel="nofollow">http://www.thedailywtf.com/</a></p>
<p>Most people who post there to criticise someone (rather then provide constrictive feedback) provide solution that are inaccurate at best. Their suggestions are quite funny but the situation is quite tragic as it reminds me of number work situations that I have seen in large software development teams.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335623">
				<div id="div-comment-335623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335623">
			January 9, 2006 at 11:20 pm</a>		</div>

		<p>Seems Nintendo&#8217;s Wifi Adaptor installer doe sa lot of stuff like this.</p>
<p>I watched it install, and I&#8217;m pretty sure I programatically watch it dismiss the Unsigned Driver window, and programatically do the user interaction to set up internet bridging and sharing.</p>
<p>This seems like it will be very brittle.  I understand why Nintendo does it (as little user intervention as possible), but this is specific pretty much down to the service pack.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335553">
				<div id="div-comment-335553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335553">
			January 9, 2006 at 4:53 pm</a>		</div>

		<p>&gt; Most compatibility problems are not that easy<br />
<br />&gt; to detect progammatically.</p>
<p>So, er, how did you detect this particular one?  I think James is saying that whenever that code triggers, it&#8217;d be a good idea to also throw up a message saying &quot;process &lt;whatever&gt; is broken!  It&#8217;ll work for now, but maybe not if you upgrade Windows&quot;.  Perhaps when you get the old WM_COMMAND message &#8212; or in fact any back-compat specific message on the old window class, for this case &#8212; would be a good time.  I wouldn&#8217;t make it modal, though.</p>
<p>And seeing how the recent WMF vulnerability was created by back-compat code (targeting 3.1 even!), IMO it&#8217;s even more important to put pressure on people to stop relying on back-compat.  Having one or two generations of Windows that only show the message would also give users a way to gauge how many programs might break if they upgrade, *before* they spend the money on the upgrade.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb even thread-even depth-1" id="comment-335643">
				<div id="div-comment-335643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335643">
			January 10, 2006 at 4:15 am</a>		</div>

		<p>To go along with what Max said: Unfortunately, Microsoft is guilty of this very practice (simulating user interaction).  Windows Desktop Search includes a deskbar for searching from the taskbar.  As Raymond has pointed out earlier, to prevent apps from abusing things that should be under user control, Windows doesn&#8217;t include programmatic access to which deskbars are displayed.  So, Windows Desktop Search&#8217;s Options dialog has a button, &quot;Show Deskbar&quot;, that when you click it, simulates the user right-clicking the taskbar, going to the selecting the Toolbars submenu, and selecting Windows Desktop Search.  The dialog box even warns you &quot;Your screen may flicker briefly as this happens.&quot;</p>
<p>It&#8217;s no wonder people use these types of hacks, especially if Microsoft does it too.  Granted, I think Desktop Search probably prevents itself from installing on future versions (because it&#8217;ll be moot with Vista), but still, it&#8217;s a terrible hack.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-335653">
				<div id="div-comment-335653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335653">
			January 10, 2006 at 4:19 am</a>		</div>

		<p>One more thing, an extension to Max&#8217;s posting.  Wouldn&#8217;t it be great if Nintendo, instead of putting money into developing these hacks, would put money into developing a quality driver and getting it signed?</p>
<p>And if I&#8217;m not mistaken, Vista is going to block all unsigned drivers, and not even give users a chance to override it.  (This will be a good move for security &amp; reliablility.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335663">
				<div id="div-comment-335663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dashslot.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335663">
			January 10, 2006 at 5:23 am</a>		</div>

		<p>&quot;And if I&#8217;m not mistaken, Vista is going to block all unsigned drivers, and not even give users a chance to override it. (This will be a good move for security &amp; reliablility.)&quot;</p>
<p>What?  That would suck.  And how would driver developers ever be able to test anything?  (Not to mention the fact that signing a driver is still no guarantee of reliability, as anyone who&#8217;s owned any soundcards made by a particular manufacturer (who I won&#8217;t name) could testify to.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335673">
				<div id="div-comment-335673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Not today, Josephine</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335673">
			January 10, 2006 at 5:45 am</a>		</div>

		<blockquote><p>
  then this would have to be episode 11.</p>
<p>It is. As the old joke goes, the world is divided into 10 groups. Those who grok binary and those who don&#8217;t.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335683">
				<div id="div-comment-335683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335683">
			January 10, 2006 at 7:28 am</a>		</div>

		<p>The problem with a universal software update system (i.e. windows update but user programs can register for it too) is how to be sure that:<br />
<br />A.A virus hasnt overridden the update data for &lt;insert program here&gt; (e.g. a virus checker)<br />
<br />or B.A virus hasnt inserted its own update into the list with an innocuous sounding name.</p>
<p>Although if a virus did this, I am sure that virus checkers and malware programs would start removing or fixing the bad entries as soon as they are found :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-335693">
				<div id="div-comment-335693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335693">
			January 10, 2006 at 8:16 am</a>		</div>

		<p>&quot;And how would driver developers ever be able to test anything?&quot;</p>
<p>Using the test mode (as discussed on a previous entry so not worth repeating here).</p>
<p>I wonder how many implementation details the core teams discovered that the app teams were using? I believe one of the exports still present in the 16-bit GDI.EXE is FixUpBogusPublisherMetafile &#8211; I&#8217;m hoping that it&#8217;s referring to an old Microsoft Publisher version here&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335823">
				<div id="div-comment-335823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Steward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335823">
			January 10, 2006 at 1:40 pm</a>		</div>

		<p>I can&#8217;t think of a good solution for automatic updates.  It obviously requires a certificate infrastructure to avoid the problems Jonathan describes.  Most binaries aren&#8217;t signed, so hijacking updates is already possible, but a central update system will increase the appeal and impact of hacking it.</p>
<p>It seems clear that Microsoft couldn&#8217;t verify the authenticity of every update themselves, but I think there would have to be a website or service, run by Microsoft, to stop companies like we&#8217;ve seen building hacks around the system, and to cover the single target/point of failure.</p>
<p>But there&#8217;s still the issue of programmers losing or selling their certificates, turning security into false security (worse than none at all).  Catching these would be a lot of work for Microsoft for relatively little return, although perhaps it could become part of their anti-phishing scheme&#8230;</p>
<p>Anyone got an alternative?</p>
<p>Mark</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-335833">
				<div id="div-comment-335833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335833">
			January 10, 2006 at 1:47 pm</a>		</div>

		<p>Ok, maybe I should&#8217;ve researched a bit more before posting that thing about unsigned drivers.  I recall having read something that they were blocked outright, but it turns out that&#8217;s not the case.  To quote from <a rel="nofollow" target="_new" href="http://www.microsoft.com/whdc/winlogo/VistaLogofaq.mspx" rel="nofollow">http://www.microsoft.com/whdc/winlogo/VistaLogofaq.mspx</a>:</p>
<p>&quot;Q. Will Windows Vista allow unsigned drivers to be loaded?<br />
<br />A. Yes, Windows Vista will load unsigned drivers if you sign in with an account that has administrator permissions on the machine or use administrator credentials.&quot;</p>
<p>Funny, because I didn&#8217;t know that non-admins could load drivers in the first place&#8230;  Or maybe that&#8217;s just kernel-mode drivers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-335703">
				<div id="div-comment-335703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-335703">
			January 10, 2006 at 8:59 am</a>		</div>

		<p>Raymond: Basically, I was saying that you already have code in place to detect that a program is using that particular method of bringing up the printers UI.  (You have to, otherwise the back-compat hack wouldn&#8217;t work.)  So why not also display something to the user at the same time?</p>
<p>Yes, it would &quot;clutter&quot; the OS code a bit &#8212; but most of that clutter is already there (the part that detects when the back-compat WM_COMMAND has to be available).  All the time you speak of that&#8217;s needed to debug the problem has already been spent; all I&#8217;m saying is it might be a good idea to notify the user that you&#8217;re doing a back-compat hack, and that they should try to get an update from the vendor before upgrading Windows.</p>
<p>If that WM_COMMAND value becomes legal again, then you&#8217;ll have a compatibility nightmare anyway.  How will you know that a program wants the new behavior instead of the old?  Unless, of course, the old behavior has been removed from the OS already, and everyone&#8217;s running a version that has it removed.  Not just worked around, but completely removed.</p>
<p>Dan Maas: Yes, it would be annoying.  But that&#8217;s sort of the point, too; if you get an annoying message every time you run a program, which is telling you to upgrade that program, maybe you should (1) look for an update, if you&#8217;re a home user, or (2) tell someone else who can look for an update, if you&#8217;re a corporate user.  If there is no update (e.g. if the original publisher is out of business), then it might be worth having a way to suppress the messages for a certain program.  But the program could still break in the future, if the compatibility workarounds ever get cleaned out.</p>
<p>Maybe you don&#8217;t care who fixes the issue between Microsoft and the vendor, but you probably don&#8217;t want back-compat code to be here forever, either, possibly turning into security holes along the way.  Microsoft can&#8217;t even &quot;fix&quot; it anyway &#8212; all they can do is keep their OS backwards compatible by inserting hacks in various places.  The vendor has no incentive to fix it either, as long as the back-compat code exists and they don&#8217;t get complaints from users.</p>
<p>PatriotB/Neil: Requiring driver signing will completely break drivers like WinPcap.  WinPcap has *zero* budget, so there&#8217;s no way to get their driver signed.  But oh, that&#8217;s right, we&#8217;re all supposed to be using netmon anyway, not ethereal or tcpdump.  Even though netmon only works on servers, and has an absolutely crappy UI and filtering capability (at least on 2K, I don&#8217;t know whether it runs on XP, or if its UI or filters are better).  Sigh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-336553">
				<div id="div-comment-336553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://feldgendler.livejournal.com' rel='external nofollow' class='url'>Alexey Feldgendler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-336553">
			January 12, 2006 at 9:07 am</a>		</div>

		<p>This practice of fixing broken programs on the OS side encourages writing broken programs.</p>
<p>What should really happen: a public beta of OS is released, software vendors test their software on the beta (they all want their software to work under the new OS, don&#8217;t they?), find the reasons why it doesn&#8217;t work, and either fix bugs in their software or report bugs to the OS vendor.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337003">
				<div id="div-comment-337003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu Mansell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-337003">
			January 13, 2006 at 2:23 am</a>		</div>

		<p>Nate: Check out December 30: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/12/30/508691.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/12/30/508691.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-337603">
				<div id="div-comment-337603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hypersw.net' rel='external nofollow' class='url'>Serge Baltic</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-337603">
			January 14, 2006 at 2:09 pm</a>		</div>

		<p>What surprises me much is the fact these problems are solved on the OS vendor side and not the application vendor&#8217;s. Not evident why it should bother. A vendor has its app stop working, users are kicking it in head, it releases an update —&#160;that&#8217;s how it naturally happens … no?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337663">
				<div id="div-comment-337663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-337663">
			January 14, 2006 at 5:37 pm</a>		</div>

		<p>And of course, the sort of people who do <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/12/28/508689.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/12/28/508689.aspx</a> also ask silly questions like &quot;How do I get my program to open the control panel?&quot; when they mean &quot;How do I get my program to change setting X?&quot; and end up with the sort of solution above.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-337763">
				<div id="div-comment-337763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-337763">
			January 15, 2006 at 5:08 pm</a>		</div>

		<p>Serge: Raymond&#8217;s explained this before, but this is the gist.  Say it is 1995, and your company is on Windows 3.1 using WordPerfect.  Windows 95 comes out and you upgrade to it.  WordPerfect no longer works.  Who gets blamed? Windows.</p>
<p>When OS upgrades cause your existing software to no longer work, that is going to deter people from upgrading.  No matter if it is really the application vendor&#8217;s fault.</p>
<p>WordPerfect is just an example I picked here.  Who knows what application this blog posting was about, but chances are it is an app that was just about as widely used as WordPerfect.</p>
<p>In a perfect world, the application vendor would do things right and would have an update ready for those users who upgrade.  But remember this posting is talking about 1995&#8211;it&#8217;s not like users could hop on over to WordPerfect&#8217;s web site and check for updates.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-337883">
				<div id="div-comment-337883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://feldgendler.livejournal.com' rel='external nofollow' class='url'>Alexey Feldgendler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-337883">
			January 16, 2006 at 9:25 am</a>		</div>

		<p>Replying to PatriotB:</p>
<p>&gt; Windows 95 comes out and you upgrade to it.</p>
<p>Where do I get it from? How do I know about it? From the website? If so, then I&#8217;d know that a WordPerfect upgrade is ready, too. It&#8217;s WordPerfect&#8217;s duty to prepare this upgrade and make it ready during the beta testing period of Windows 95. It&#8217;s them who should say: sorry, we had a bug, and now we&#8217;ve fixed it. Please download and install this patch for free.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-382603">
				<div id="div-comment-382603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/michkap/archive/2006/05/20/602745.aspx' rel='external nofollow' class='url'>Sorting It All Out</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-382603">
			May 20, 2006 at 1:21 pm</a>		</div>

		<p>I have talked about the Microsoft Knowledge Base article that describes how to run Regional and Language&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-437653">
				<div id="div-comment-437653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/11/01/922449.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-437653">
			November 1, 2006 at 10:00 am</a>		</div>

		<p>Bad ideas that nevertheless came to fruition.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-579413">
				<div id="div-comment-579413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.eriknovales.com/blog/index.php/2007/12/20/even-when-you-wrote-the-operating-system-you-still-have-to-work-around-other-peoples-bugs/' rel='external nofollow' class='url'>Even When You Wrote the Operating System, You Still Have to Work Around Other Peoples&#8217; Bugs</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-579413">
			December 20, 2007 at 2:01 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.eriknovales.com/blog/index.php/2007/12/20/even-when-you-wrote-the-operating-system-you-still-have-to-work-around-other-peoples-bugs/" rel="nofollow">http://www.eriknovales.com/blog/index.php/2007/12/20/even-when-you-wrote-the-operating-system-you-still-have-to-work-around-other-peoples-bugs/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-642893">
				<div id="div-comment-642893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csokavar.hu/?p=110' rel='external nofollow' class='url'>Cs&#243;kav&#225;r &raquo; Z&#225;rv&#225;nyok</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060109-27/?p=32723#comment-642893">
			June 30, 2008 at 12:58 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.csokavar.hu/?p=110" rel="nofollow">http://www.csokavar.hu/?p=110</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

