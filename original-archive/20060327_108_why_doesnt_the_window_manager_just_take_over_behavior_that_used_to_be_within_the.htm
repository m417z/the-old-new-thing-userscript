<html>
<head>
<title>Why doesn't the window manager just take over behavior that used to be within the application's purview?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why doesn&#8217;t the window manager just take over behavior that used to be within the application&#8217;s purview?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 27, 2006 / year-entry #109</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>59</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A commenter named "Al" wondered why the window manager couldn't just take over behavior that used to be within the application's purview, such as painting the non-client area, in order to avoid problems with applications not responding to messages promptly enough. If the window manager were being rewritten, then perhaps it could. But to do...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A commenter named "Al" wondered why <a href="http://blogs.msdn.com/oldnewthing/archive/2004/09/09/227339.aspx#227696"> the window manager couldn't just take over behavior that used to be within the application's purview, such as painting the non-client area, in order to avoid problems with applications not responding to messages promptly enough</a>. If the window manager were being rewritten, then perhaps it could. But to do it now would introduce many compatibility issues.</p>
<p> First, there are many applications that have subtle dependencies on message ordering or receiving certain types of messages at certain times, even though there is no actual guarantee in the specification that such messages be delivered. There are a large number of applications that rely on <code>WM_PAINT</code> messages being delivered even if there is nothing to paint, because they defer some critical computations until the first <code>WM_PAINT</code> message, and if something that requires the result of that computation happens before a <code>WM_PAINT</code>, they crash. For example, if you launch a program minimized, then right-click on the taskbar button for the program's main window, these programs would crash because the code that handles the system menu uses a pointer variable that the <code>WM_PAINT</code> handler initializes or divides by a global variable whose default value is zero but whose value is calculated during <code>WM_PAINT</code> handling. To accomodate these programs, the window manager is forced to send "dummy" <code>WM_PAINT</code> messages with an empty <code>rcPaint</code>. These such messages appear to accomplish nothing, but the hidden agenda is that the program gets its cherished <code>WM_PAINT</code> message and can perform whatever operations it is that keeps it from crashing later on. </p>
<p> Second, removing customizability of message behavior from the window manager would prevent programs from customizing their appearance in nonstandard ways. Media players are perhaps the most popular example of programs that want to override normal non-client painting in order to present a totally customized window to the user. Would you be happy if a change to Windows meant that you could no longer "skin" your favorite media player application? </p>
<p> That said, there have been changes to the window manager over the years to maintain this "air of customizability" while simultaneously intervening on behalf of the user to keep things from going completely to the dogs. For example, if a window stops painting for an extended period of time, Windows would take it upon itself to paint the window with a standard caption bar (even if the application wanted to customize the caption bar), just so that the user would be able to see <em>something</em>. </p>
<p> Another example of this "message virtualization" is the appending of the phrase "(Not responding)" to the caption of a window that has stopped responding, and capturing the window contents as they were last visible, drawing those captured window contents in the meantime until the application woke up from its slumber, and even allowing you to move, resize, minimize, and close those unresponsive windows. The infrastructure necessary to support this behavior is quite extensive, because the window manager needs to maintain two sets of bookkeeping. The first is, "What the application thinks the window state is"; if the application asks for the size of its hung window, it needs to be told, "Oh, you're still that size you were before, don't you worry your pretty little head", even though the actual window size on the screen has changed significantly. Once the hung window starts responding to messages again, all the activity that happened "while it was away" needs to be replayed to get the window "back up to speed" with the state of the world. Interesting things happen if the program wanted to customize one of the actions that happened to the "virtual window". For example, it might want to reject certain window sizes or display a special message before minimizing. Resolving these conflicts in a manner that doesn't cause applications to crash outright is another of the difficulties of trying to get the virtual and real window states back into sync. </p>
<p> In a sense, therefore, the window manager does take over selected behaviors that used to be within the application's purview, but it has to do it in a delicate enough manner that neither the application nor the end user will even realize that it's happening. And that's what makes it hard. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (59)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-359393">
				<div id="div-comment-359393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">teh win</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359393">
			March 27, 2006 at 10:32 am</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;</p>
<p>Frankly, yes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359403">
				<div id="div-comment-359403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359403">
			March 27, 2006 at 10:35 am</a>		</div>

		<blockquote><p>
  Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?</p>
<p>Window managers in X11 draw the titlebar and borders, but there are still apps that use a &quot;skinned&quot; appearance, XMMS for instance.</p>
<p>These types of features could easily be added to Windows, as long as programs have to ask for the feature to be activated. Then new programs would be able to take advantage of them without affecting old ones.</p>
<p>In fact, this could be done for many features where the reason for their non-existance in &quot;back compatibility&quot;.<br />
  <br />It seems silly to me to try and apply new features, especially in the GUI area, to old programs.<br />
  <br />Take XP&#8217;s themes, for instance, some older apps will work with them, some won&#8217;t, some that do end up with some controls themed and some not (some Windows dialogs also have this problem). It would have been a much better and more elegant solution to only apply themes to apps that ask for them.<br />
  <br />A similar situation happened with the new look in Win95.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359433">
				<div id="div-comment-359433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359433">
			March 27, 2006 at 10:41 am</a>		</div>

		<p>&quot;If the window manager were being rewritten, then perhaps it could&quot;</p>
<p>Isn&#8217;t that exactly what is happening in Vista with the new DWM? Wouldn&#8217;t that cause exactly the issues you mention with WM_PAINT messages?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-359463">
				<div id="div-comment-359463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359463">
			March 27, 2006 at 11:01 am</a>		</div>

		<p>&quot;&#8230; as long as programs have to ask for the feature to be activated.&quot;</p>
<p>And in fact that&#8217;s what they do today. The window manager says, &quot;Time to draw your non-client area&quot; and the app decides, &quot;I want a default look (and calls DefWindowProc)&quot; or &quot;I want a custom look (and draws it manually)&quot;. The catch is that the mechanism is procedural rather than declarative.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359473">
				<div id="div-comment-359473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Hall</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359473">
			March 27, 2006 at 11:05 am</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;</p>
<p>I would be deliriously happy. I can&#8217;t stand skinned applications.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359493">
				<div id="div-comment-359493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Ellis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359493">
			March 27, 2006 at 11:11 am</a>		</div>

		<p>Raymond &#8211; where is the window manager implemented? If the application is hung and not pumping messages, which process (or thread) is actually responsible for the drawing of the &quot;ghost&quot; window?</p>
<p>Cheers<br />
<br />Matt<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359533">
				<div id="div-comment-359533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359533">
			March 27, 2006 at 11:32 am</a>		</div>

		<p>&quot;Skins&quot; should be systemwide only. I&#8217;d be very happy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359543">
				<div id="div-comment-359543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359543">
			March 27, 2006 at 11:43 am</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;</p>
<p>YES!</p>
<p>Office 2007 is the latest example of skinning gone too far. &nbsp;Is there NOTHING that can convince them to use standard title bars?!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359553">
				<div id="div-comment-359553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359553">
			March 27, 2006 at 11:49 am</a>		</div>

		<p>Why not add a window flag to say &quot;the window manager owns my non-client area&quot;? That way at least new applications could avoid the various problems that result from an application drawing its own frame.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359613">
				<div id="div-comment-359613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://musingmarc.blogspot.com' rel='external nofollow' class='url'>Marc Brooks</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359613">
			March 27, 2006 at 12:41 pm</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;</p>
<p>Actually, the word I would use is &quot;overjoyed&quot;. &nbsp;I can&#8217;t tell you how many times I&#8217;ve accidentally closed the program underneath Windows Media Player because it thinks cute displaying is better than functional behavior.</p>
<p>I am SICK of skinning, and Vista is just making it worse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359623">
				<div id="div-comment-359623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359623">
			March 27, 2006 at 12:48 pm</a>		</div>

		<p>I have two basic types of media I play with Media Players: &nbsp;Audio and movies. &nbsp;Audio is played normally with the window minimized, and movies are played full screen. &nbsp;Who cares what the Media Player looks like?</p>
<p>I did read the rest of the article, I&#8217;m just not 100% sure I fully understand it yet. &nbsp;However, I now understand why you get that &quot;Not responding&quot; on some applications and not others when you have something appears to lock up.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359633">
				<div id="div-comment-359633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359633">
			March 27, 2006 at 12:56 pm</a>		</div>

		<p>I wonder if people who read The Old New Thing &nbsp;tend to like plain rectangular windows. &nbsp; Think outside the box folks! &nbsp; (sorry couldn&#8217;t help it) &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359643">
				<div id="div-comment-359643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Moorhouse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359643">
			March 27, 2006 at 1:01 pm</a>		</div>

		<p>I think you might be asking the wrong bunch of people about skinning.</p>
<p>The fact that huge segments of your apps&#8217; target audience enjoy &quot;skinning&quot; to the point of ignoring actual functionality might be kind of lost on those people who actually expect their computers to work properly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359653">
				<div id="div-comment-359653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Sowul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359653">
			March 27, 2006 at 1:08 pm</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot; </p>
<p>Hell yes, I hate skinned apps because they never fit with the rest of the system.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008195987d even thread-even depth-1" id="comment-359663">
				<div id="div-comment-359663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Spire' rel='external nofollow' class='url'>Spire</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359663">
			March 27, 2006 at 1:30 pm</a>		</div>

		<p>Matt: Interesting hypothesis. I also hate application skinning (but don&#8217;t mind systemwide skinning, as long as it can be controlled by the user).</p>
<p>PatriotB: Microsoft Office has a very long history of gratuitous deviation from standard OS-provided behavior and apparance for windows and controls. In fact, some Windows UI elements, such as caption gradients and some features of common dialogs, originated in Office. Office 2007 just takes it to new extremes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359703">
				<div id="div-comment-359703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359703">
			March 27, 2006 at 1:56 pm</a>		</div>

		<p>Thanks to the Windows team going out of their way not to break poorly written applications developers once again have no incentive to clean up their act and actually write working applications. If an application requires a dummy WM_PAINT not to crash it should be made to crash as soon as possible so the developers go in and fix it before releasing their &quot;code&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359773">
				<div id="div-comment-359773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359773">
			March 27, 2006 at 4:09 pm</a>		</div>

		<p>I want every program to fit with my windows. I no longer use (really can&#8217;t use) office. WinAmp et al have no chance of being installed. I use Mplayer2 far more than WMPlayer.</p>
<p>You forced GUIs down our throats.</p>
<p>However I always felt jealous of Mac&#8217;s dialog type apps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359793">
				<div id="div-comment-359793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rikard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359793">
			March 27, 2006 at 4:27 pm</a>		</div>

		<p>To those answering YES to &quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;&#8230;</p>
<p>If that&#8217;s the case, why is your favourite madia player one of those &quot;skinny&quot; things? There are alternatives, you know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359813">
				<div id="div-comment-359813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359813">
			March 27, 2006 at 4:47 pm</a>		</div>

		<p>Another vote for unskinned apps.</p>
<p>As for XP new controls, they are opt-in &#8211; by default, apps get non-Luna comctl32.dll (v5.80). If you want Luna (v6.0), you need to have a manifest saying so.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359823">
				<div id="div-comment-359823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stewart Gaskell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359823">
			March 27, 2006 at 4:50 pm</a>		</div>

		<p>Rikard: I&#8217;m tired of downloading third party apps that sacrifice usability, for &quot;looks good if every window is skinned to within an inch of it&#8217;s life&quot;.<br />
<br />I want functionality, and the app to respond to keyboard short cuts. Those are my two primary requirements. I really don&#8217;t care if the main window is a rectangle, circle, etc. I just wabt it to work.<br />
<br />Seems that some developers priorities are not focused on usability&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359843">
				<div id="div-comment-359843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stewart Gaskell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359843">
			March 27, 2006 at 5:11 pm</a>		</div>

		<p>&quot;Exterminate!&quot;<br />
<br />No, really I&#8217;m not against skinning.<br />
<br />It&#8217;s just that a few third party media players I have tried, just don&#8217;t conform to the Windows standard. One media player that I evaluated had no obvious &quot;Close&quot; or &quot;Minimize&quot; icons.<br />
<br />In fact the main window was such a bizarre shape that I had no visual feedback as to whether the app could be minimized, or re-sized.<br />
<br />I have no problem with customising window&#8217;s apps as long as they are still easily useable.</p>
<p>Stewart</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359873">
				<div id="div-comment-359873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotgeek.blogspot.com/' rel='external nofollow' class='url'>Duncan Bayne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359873">
			March 27, 2006 at 5:37 pm</a>		</div>

		<blockquote><p>
  I have no problem with customising window&#8217;s<br />
  <br />&gt; apps as long as they are still easily<br />
  <br />&gt; useable. </p>
<p>But the second the API lets developers do that, you&#8217;ll get apps that aren&#8217;t. &nbsp;</p>
<p>In fact, &quot;easily useable&quot; precludes skinning, because skinnning makes apps appear and often behave in ways not at one with the rest of the apps on your system.</p>
<p>And if you think the current crop of skinnable apps are bad, you just wait for Avalon &#8230; take the current crop of crappy skinned apps, then add 3D effects, transitions, animations, light sources &#8230; the mind boggles.</p>
<p>
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359343">
				<div id="div-comment-359343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arlie Davis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359343">
			March 27, 2006 at 10:07 am</a>		</div>

		<p>I was very happy to notice these changes occur in the window manager. &nbsp;I can&#8217;t stand applications that are so poorly written or so buggy that they stop pumping UI messages, and become completely unresponsive.</p>
<p>As recently as NT 4, if an app stopped pumping messages, you couldn&#8217;t even *minimize* the app window, much less move it, or see its caption. &nbsp;Incredibly frustrating.</p>
<p>I hope Avalon has a solid, rational way to deal with applications that are too busy to pay attention to their reason for existing &#8212; the user.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359893">
				<div id="div-comment-359893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotgeek.blogspot.com/' rel='external nofollow' class='url'>Duncan Bayne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359893">
			March 27, 2006 at 7:10 pm</a>		</div>

		<blockquote><p>
  Or is your response to these people, &quot;No,<br />
  <br />&gt; you&#8217;re all wrong. You should not be allowed to<br />
  <br />&gt; customize how your program looks. Resistance is<br />
  <br />&gt; futile.&quot;</p>
<p>Customise how the program looks? &nbsp;Sure. &nbsp;</p>
<p>Customise how system-wide widgets like title bars, close / maximise / minimise buttons, keyboard accelerators etc. work? &nbsp;Hell no.</p>
<p>I mean, if you really, really want to owner-draw just about every part of your app to make it as much of a tarts handbag as QuickTime, then sure, go for it. &nbsp;More power to you.</p>
<p>But that shouldn&#8217;t extend to things that are properly the domain of the window manager. &nbsp;</p>
<p>If your app changes the title bar, uses some non-standard menu system, or disables standard accelerator keys, then you&#8217;re not skinning, you&#8217;re breaking the UI paradigm that should in theory be shared with all apps on your system.<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359933">
				<div id="div-comment-359933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kenn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359933">
			March 27, 2006 at 10:45 pm</a>		</div>

		<p>I&#8217;d like to second Matt Ellis&#8217; question:<br />
<br /> &nbsp; <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/03/27/561924.aspx#561999" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/03/27/561924.aspx#561999</a></p>
<p>Which process takes over non-responsive windows?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359943">
				<div id="div-comment-359943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359943">
			March 27, 2006 at 10:48 pm</a>		</div>

		<p>Even though window managers and themes aren&#8217;t identical technically, their effects are a lot alike. &nbsp;Let themes decide whether applications can be skinned. &nbsp;If a user selects Windows Classic theme, then make the menu bar visible in Windows Media Player. &nbsp;If the user selects Windows XP Unprofessional theme, then continue on with the practices of Windows Media Player, Office 2007, and Vista&#8217;s version of Windows Explorer.</p>
<p>Regarding this:<br />
<br />&gt; Another example of this &quot;message<br />
<br />&gt; virtualization&quot; is the appending of the<br />
<br />&gt; phrase &quot;(Not responding)&quot; to the caption of</p>
<p>That seems to work in many cases, but I have doubts. &nbsp;Sometimes Internet Explorer gets itself in a condition where it isn&#8217;t responding but the window manager doesn&#8217;t detect that, and the bugs mushroom from there. &nbsp;I think sometimes this is related to successfully blocking unwanted popups, but there are still bugs in popup blocking so this might be part of the cause. &nbsp;I think it&#8217;s not always the cause though.</p>
<p>&gt; The infrastructure necessary to support this<br />
<br />&gt; behavior is quite extensive, because the<br />
<br />&gt; window manager needs to maintain two sets of<br />
<br />&gt; bookkeeping.</p>
<p>And there seem to be bugs in it. &nbsp;Again with the example of Internet Explorer, if the user happens to close the correct (i.e. incorrect) IE Window then suddenly all the other windows wake up, their messages get replayed, and the system is responsive again. &nbsp;But if the problem didn&#8217;t originate in Internet Explorer, or maybe if it did originate in IE but originated differently from the other cases, then there is no recovery. &nbsp;Kill every window in the system, get 30 instances of dumprep.exe visible in Task Manager, but eventually all the dumprep.exe and drwatson.exe processes just exit and the system still isn&#8217;t doing anything. &nbsp;It seems the window manager is in such bad shape that windows cannot even be opened to offer to send bug reports to Microsoft. &nbsp;The Task Manager is still responsive and its Shutdown command can be invoked, but it doesn&#8217;t work. &nbsp;Usually the power button is the only solution. &nbsp;One time I noticed around 100 bug reports in a temp directory that had been created but not sent because of these bugs prevented reporting themselves.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359963">
				<div id="div-comment-359963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359963">
			March 27, 2006 at 11:17 pm</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;</p>
<p>Yes. OH GOD, yes. I use Winamp for its features and the vast set of available plugins, but the skins drive me nuts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359733">
				<div id="div-comment-359733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dotgeek.blogspot.com/' rel='external nofollow' class='url'>Duncan Bayne</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359733">
			March 27, 2006 at 3:55 pm</a>		</div>

		<p>I know I&#8217;m going to come over as a curmudgeon for saying this, but apps *should not* be able to &#8216;skin&#8217; themselves by painting their own title bars, etc. etc.</p>
<p>Whatever happened to UI consistency?</p>
<p>Apps like Trillian, Winamp, QuickTime, Media Player, IP Office etc. etc. are visually horrible; they disobey all the UI theme &amp; style choices made by the user, impose their own often awkward &amp; poorly researched widgets &amp; UI paradigms, and don&#8217;t gel visually with the rest of the apps on the system.</p>
<p>Application skinning is roughly equivalent to children with crayons scrawling on walls. &nbsp;Sure, you&#8217;re customising your environment, but is it worth it? :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-359833">
				<div id="div-comment-359833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359833">
			March 27, 2006 at 4:56 pm</a>		</div>

		<p>Apparently there is some nontrivial number of people who *like* skinning their music player because the web is crawling with them. Or is your response to these people, &quot;No, you&#8217;re all wrong. You should not be allowed to customize how your program looks. Resistance is futile.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359983">
				<div id="div-comment-359983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Archangel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359983">
			March 28, 2006 at 1:24 am</a>		</div>

		<p>I&#8217;ve found it an interesting difference between Windows and X, that in Windows the window decorations seem to be part of the window, so if it goes nonresponsive you frequently aren&#8217;t able to move the window at all. Whereas in X you don&#8217;t get the busy cursor over the titlebar, only inside it, so you can still move them about even if they&#8217;re not repainting.</p>
<p>This would be quite nice when I decide I want to move Enterprise Manager during one of it&#8217;s little sulks when I want to get a database list from a remote server.</p>
<p>PS. I second Arlie&#8217;s comment: Why did Microsoft create an engine to skin the entire system, but restrict anyone else from writing skins for it?<br />
<br />The fix is a (presumably) trivial change to uxtheme.dll, but why force users to go through that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359863">
				<div id="div-comment-359863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arlie Davis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359863">
			March 27, 2006 at 5:36 pm</a>		</div>

		<p>Consider this another vote AGAINST skinning. &nbsp;And I&#8217;m also voting for a lot of friends and family who also find highly &quot;skinned&quot; apps to be extremely hard to use. &nbsp;These apps are totally inconsistent with the rest of the GUI and other &quot;normal&quot; applications, and in general just look horrible, and are difficult and confusing to use.</p>
<p>The worst offenders seem to be media players, especially DVD players. &nbsp;They are very difficult to use, especially with a keyboard. &nbsp;In fact, most of them have *horrible* support for navigating with a keyboard.</p>
<p>Why does Microsoft make it difficult or impossible to provide *system-wide* skins? &nbsp;There are a lot of useful, usable XP themes / skins out there, that actually improve the usability of the OS and all apps, in a clear, consistent way. &nbsp;Most of them are crap, of course, but some of them are really good. &nbsp;Why did MS spend all of the time to develop a fairly good themes architecture, and then seal it away from users?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359993">
				<div id="div-comment-359993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverGuy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359993">
			March 28, 2006 at 1:49 am</a>		</div>

		<p>Um, why don&#8217;t we all ask the authors of WinAMP and Office, to provide skins that look just like Windows Classic? I would use them in a heartbeat!</p>
<p>The problem with skins is just like the Web: everybody does it differently. Works great if you like the Flashy stuff, or if you use &quot;standard out of box&quot; configuration, but woe to anyone who&#8217;s customized their desktop so it&#8217;s more palatable to their older eyes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360003">
				<div id="div-comment-360003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Cooke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360003">
			March 28, 2006 at 2:01 am</a>		</div>

		<p>Adam G,<br />
<br />Winamp&#8217;s plugin API is so simple that it has been implemented in various other media players. I seem to remember there being one that used native GUI widgets but supported Winamp plugins. All it takes is responding to a few non-standard window messages and, in the case of the DSP/viz plugins, pumping data into a callback function.</p>
<p>The only stuff that doesn&#8217;t work is the stuff where the plugin makes use of the fact that it&#8217;s running in Winamp&#8217;s process by screwing with Winamp&#8217;s own windows, which is of course frowned apon anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360053">
				<div id="div-comment-360053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GAThrawn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360053">
			March 28, 2006 at 4:58 am</a>		</div>

		<blockquote><p>
  Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?</p>
<p>I&#8217;ll add my vote to the &quot;Happy? I&#8217;d be delirious!&quot; camp.</p>
<p>This is why I&#8217;m still running Media Player 6.4 on my main home desktop. If I&#8217;d ever seen a skin forone of the newer versions of Media Player that makes it even half as useful and usable as 6.4 in Minimal view, then I&#8217;d be all over it like a rash!</p>
<p>All I want is something that will play movies in the corner of my screen leaving a decent area in the other 2/3rds of the screen that I can put a web browser/text editor/debug tools in. Every skin I&#8217;ve seen either messes up video aspect ratios (who&#8217;s ever actually wanted that?), or puts thick, brightly coloured borders aroud the window, or shoves useless UI rubbish and &quot;white&quot; space all round the video.</p>
<p>So its a (minimized) Winamp 2.x and a &quot;minimal view&quot; media player 6.4 for me!
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360073">
				<div id="div-comment-360073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360073">
			March 28, 2006 at 5:12 am</a>		</div>

		<p>me: &quot;Either this says something about Microsoft, the theme authors, or both.&quot;</p>
<p>Oops, being incorrectly overly correct there&#8230; but you get the idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360123">
				<div id="div-comment-360123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.robertmoir.com' rel='external nofollow' class='url'>Robert Moir</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360123">
			March 28, 2006 at 6:46 am</a>		</div>

		<p>So people usually flame MS on Raymond&#8217;s blog for removing their choices. Now, with allowing apps to be skinned, people are flaming MS because those people themselves made a choice to download a skinned app but not pick a skin they want (&quot;Good&quot; skinnable apps ship with a &quot;classic $OS&quot; skin, ideally as the default skin).</p>
<p>So what is it? Do you want choice or not?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-359953">
				<div id="div-comment-359953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Moorhouse</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-359953">
			March 27, 2006 at 11:15 pm</a>		</div>

		<p>&quot;Apparently there is some nontrivial number of people who *like* skinning their music player because the web is crawling with them.&quot;</p>
<p>Now, ain&#8217;t that the truth? People do indeed demand the flashy surface stuff, and give little thought to what it costs them underneath; this doesn&#8217;t prevent them, however, from complaining bitterly about the cost after the fact. Think of all the people that install 20-30 &quot;system tray utilities&quot;, and then complain about their system startup time.</p>
<p>Raymond, here&#8217;s a question: if every problem with Windows ever could magically be fixed by actively preventing all skinning, do you suppose that Microsoft would give up the market share represented by that &quot;nontrivial number&quot;? This is not directed at you personally, of course.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360133">
				<div id="div-comment-360133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nekto2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360133">
			March 28, 2006 at 8:32 am</a>		</div>

		<p>2 oldnewthing:<br />
<br />Is there any recomendations where one must put any delayd computations?<br />
<br />If it is not WM_PAINT? Should it be ON_ACTIVATE or just a timer set for a second etc.</p>
<p>How about the case when window is not destroyed but need to be re-shown with different content every time?</p>
<p>ps. Thanks for this article! It was helpful.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360153">
				<div id="div-comment-360153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frederik Slijkerman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360153">
			March 28, 2006 at 8:56 am</a>		</div>

		<blockquote><p>
  recomendations where one must put any delayd computations</p>
<p>Simply post a WM_USER message to your own window from WM_CREATE and perform your calculations when you receive that.</p>
<p>Frederik
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360163">
				<div id="div-comment-360163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360163">
			March 28, 2006 at 9:55 am</a>		</div>

		<p>Everybody looking for a good non-skinned media player, check out &quot;Media Player Classic&quot;. It looks like the old MP6.4, but is 100 times more advanced: <a rel="nofollow" target="_new" href="http://sourceforge.net/projects/guliverkli/" rel="nofollow">http://sourceforge.net/projects/guliverkli/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360023">
				<div id="div-comment-360023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360023">
			March 28, 2006 at 3:23 am</a>		</div>

		<p>&quot;Would you be happy if a change to Windows meant that you could no longer &quot;skin&quot; your favorite media player application?&quot;</p>
<p>Oh yes. yes yes yes! This would make me soo bloody happy I&#8217;d cry.</p>
<p>Ive never understood why media player applications *need* to be skinned. If I am going to skin apps at all, I want them applied to all apps on my desktop.</p>
<p>Wasn&#8217;t XP meant to do skins anyway? </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360033">
				<div id="div-comment-360033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360033">
			March 28, 2006 at 4:04 am</a>		</div>

		<p>&gt; Would you be happy if a change to Windows meant<br />
<br />&gt; that you could no longer &quot;skin&quot; your favorite media<br />
<br />&gt; player application?</p>
<p>Oh, I would be so deliriously happy! In fact, my favorite media player application is not skinnable. It emphasizes functionality and usability over fluff.</p>
<p>Yesterday, I had to change the message display plugin in my favorite instant messenger. The straw that broke the camel’s neck was that in the new version of the plugin I used before *the windows started to drop shadows*. Now, if I want shadows, I want them *everywhere*, not in specific windows of a specific application.</p>
<p>The first thing I do after reinstalling Windows XP is turn off the theming. Because it makes console windows inconsistent with the rest of the system. Because it imposes on me the colors I find annoying and the shapes I dislike. Because *I am not in control* — and being in control of my own computer is one thing I value very much.</p>
<p>I guess I won’t be upgrading to Office 2007…</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360393">
				<div id="div-comment-360393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360393">
			March 28, 2006 at 12:47 pm</a>		</div>

		<p>Jorge Coelho &quot;&#8230;you actually WANT your stuff to look and behave differently from the standard. If you don&#8217;t, then you have no business using a skinnable application.&quot;</p>
<p>Could that statement possibly be more arrogant? If I use an application, it&#8217;s because it is the best way available for me to accomplish my goals. If it happens to be skinnable, but chooses to annoy me by preventing me from making it look and behave the SAME as the rest of my system, then I have /every/ business continuing to use that application, and I also have /every/ business giving the developers grief to allow me to turn off skinning.</p>
<p>Personally, I use VLC as a media player, because it&#8217;s more capable and usable than any other I&#8217;ve tried. I&#8217;m just fortunate that by default, it uses the standard windows look-n-feel. Skinning is available, but not pushed at you. It&#8217;s like mplayer2 but even more visually basic :)</p>
<p>And I&#8217;ll third the question: what process deals with the window management of hug windows? I&#8217;m guessing explorer.exe?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360063">
				<div id="div-comment-360063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360063">
			March 28, 2006 at 5:09 am</a>		</div>

		<p>&quot;As for XP new controls, they are opt-in &#8211; by default, apps get non-Luna comctl32.dll (v5.80). If you want Luna (v6.0), you need to have a manifest saying so.&quot;</p>
<p>afaik, there are more tricks then that: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/functions/setwindowtheme.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/functions/setwindowtheme.asp</a></p>
<p>&quot;PS. I second Arlie&#8217;s comment: Why did Microsoft create an engine to skin the entire system, but restrict anyone else from writing skins for it?<br />
<br />The fix is a (presumably) trivial change to uxtheme.dll, but why force users to go through that?&quot;</p>
<p>I bet that&#8217;s because it&#8217;s more ok for apps to break their own UI, then for one app or theme to break every other apps UI. I&#8217;ve tried many themes on the web, and most of them break one or more of the following:</p>
<p>-Terminal Services<br />
<br />-Fast User Switching<br />
<br />-Proper window decoration for every type of frame<br />
<br />-Undetermined progress bars<br />
<br />-The taskbar (some weird bugs on really broken themes)</p>
<p>1 and 2 depend on the video driver (vesa vs ATi or nVidia), so the authors never even realised.<br />
<br />Either this says something about Microsoft, the theme authors, or both.</p>
<p>Microsoft ofcourse needs to keep skinning support enabled, because there are ISV&#8217;s that have &quot;company branded&quot; their apps with skins, the Norton apps for instance are always yellow. I don&#8217;t like any of those skins, but getting rid of them is harder then keeping them. Though Microsoft perhaps make things worse by setting the example. I bet it&#8217;s the marketing layer on top that you see. just like the Nortons. So now MSIE (7), WMP, MSN * (explorer, messenger), Office, the control panel, system restore, the security center and others that i can&#8217;t think of atm, are all skinned. Ugliest thing ever is the Microsoft Calculator Plus. And it *does* break standard UI, just try right clicking the titlebar. What titlebar? There is none!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360103">
				<div id="div-comment-360103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360103">
			March 28, 2006 at 5:45 am</a>		</div>

		<p>Wow. So there are a lot of &#8216;old timers&#8217; here, judging my the general anti-skinning reaction. :-) I&#8217;m an old timer myself, but I&#8217;m also the developer of skinnable applications, so be warned! ;-)</p>
<p>This said, I agree 100% with that MAJOR problem with skinned applications is that all the usability *you were used to* goes to hell. Put someone used to Windows suddenly working on a skinnable alternate shell and he will be totally lost at what to do next.</p>
<p>HOWEVER, this is also the the whole point of skinning: Windows customization. And since customization is a *personal* thing, this means you actually WANT your stuff to look and behave differently from the standard. If you don&#8217;t, then you have no business using a skinnable application.</p>
<p>Now, skinnable applications are divided into two categories: those which go for eye candy alone and those that also add functionality to a system.</p>
<p>The problem is when you want the extra functionality without the customization part (e.g.; the case with Media Players). This is where I think that it is the responsability of the skinnable application authors to provide a skin that is as completely compatible with the OS as possile. After all the application is skinnable, so it should be able to emulate the native OS as well.</p>
<p>Now, lets get back to our Windows user facing, for the first time, a skinned shell. Imagine this skin is emulating the Mac OS. Our Windows user won&#8217;t know what to do, but a Mac user, on the other hand, will immediately feel right at home! So, if I want *my* version of Windows to look and behave like a Mac, or like NeXT, or like BeOS, and I have the tools necessary to make this happen, why shouldn&#8217;t I?!</p>
<p>And lets not forget that eye-candy sells! Everybody likes a beautiful thing: that is why the Plus pack was so successful, why everybody &#8211; including a lot of Microsoft own developers &#8211; is talking about Aqua, and, I even dare say, why Windows never really took off until version 3.0. I remember seeing Windows 3.0, with its 3D look and thinking &#8216;wow, I have to get this&#8217; while the previous Windows version left me completely cold. </p>
<p>With skinning &#8211; which was originaly a power users thing &#8211; going mainstream due mainly to WinAmp and the marketing genius of Brad Wardel, Stardock&#8217;s CEO, even Microsoft was finally convinced of this. That is why XP got his half-completed &#8216;Themes&#8217; ability, and why Vista is betting so heavilly on a cool looking GUI, with the Windows Sidebar, Widgets, and all those per pixel alpha transparency effects. </p>
<p>As a side note, in case somebody is curious why native XP theming never really took off, the reason is because Microsoft wasn&#8217;t able to solve in time the problem of a badly constructed theme being able to crash the OS. And, as we all know and Raymond pointed out many times, the user would not blame the skin, but the OS itself for crashing. So Microsoft decided to keep the Themes format closed.</p>
<p>Getting back on track, so far I only mentioned eye-candy, but some of the skinnable applications go the extra mile and actually provide a LOT of usability enhancements. </p>
<p>For reasons Raymond Chen also already explained, so I won&#8217;t get into them, Microsoft cannot provide the user with a GUI to all the possible tweaks that the OS supports internally. But skinnable applications, being originally oriented for power users, have no such restrictions! Plus they can also add to it. And this is what the applications I make for a living do: they add a lot of functionality AND they are also skinnable.</p>
<p>Of course, letting the user customize so much stuff also means that the Preferences panel of these applications looks like the cockpit of a 747, but oh well&#8230; When skinning was a power user thing this was ok, but now I have to comme up with a way to simplify the GUI, perhaps by buring the least used features one or two levels deep and leaving on the surface only the more used features.</p>
<p>And, before you say anything, I&#8217;m also guilty of implementing custom controls in Preferences that do not accept keyboard shortcuts. I hang my head in shame, but with the promise that those are all going away on the next versions to be replaced with Windows custom controls. What can I say, I loved the NeXT OS. So please don&#8217;t burn me at the stake for it. :-P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360113">
				<div id="div-comment-360113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360113">
			March 28, 2006 at 6:08 am</a>		</div>

		<p>&quot;Apparently there is some nontrivial number of people who *like* skinning their music player because the web is crawling with them.&quot;</p>
<p>There is a non-trivial number of people who support GWB too, but that doesn&#8217;t mean he&#8217;s a good leader for the United States.</p>
<p>Yes, they&#8217;re all wrong. &nbsp;Customers aren&#8217;t always right, and they don&#8217;t necessarily know what&#8217;s good for them in the long run.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360593">
				<div id="div-comment-360593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360593">
			March 28, 2006 at 4:10 pm</a>		</div>

		<p>Explorer is just another gui process, and can get hung.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360613">
				<div id="div-comment-360613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360613">
			March 28, 2006 at 4:45 pm</a>		</div>

		<p>Dewi&#8230; &quot;Could that statement possibly be more arrogant?&quot;</p>
<p>You didn&#8217;t pay attention to what I said further down: &quot;The problem is when you want the extra functionality without the customization part. &quot; :-)</p>
<p>Personally I also think that skinning should be just a &#8216;plus&#8217; to functionality. These days there are lots of skinnable applications out there, but, in fact, most of them are more concerned with adding eye candy than functionality. Both are important, but focusing mainly on the former is a mistake, IMHO.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360623">
				<div id="div-comment-360623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Steward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360623">
			March 28, 2006 at 4:54 pm</a>		</div>

		<p>I think Al&#8217;s point was why it doesn&#8217;t take over *once* the program&#8217;s stopped responding. &nbsp;If you&#8217;re already creating a title bar and allowing minimizing, why not allow other stuff like restoring from Minimize All? &nbsp;Just show the &quot;ghost&quot; window, and leave the queue alone.</p>
<p>It&#8217;s either an APC sent to the window thread, or a new thread created by CSRSS, as it doesn&#8217;t work when the process is paused in a debugger.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360893">
				<div id="div-comment-360893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GAThrawn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360893">
			March 29, 2006 at 6:13 am</a>		</div>

		<p>Jorge: &quot;This is where I think that it is the responsability of the skinnable application authors to provide a skin that is as completely compatible with the OS as possile. After all the application is skinnable, so it should be able to emulate the native OS as well.&quot;</p>
<p>And this is where the developers end up chasing a moving target, with nowhere near the resources or dedication available to produce something that works as well as the actual, real native interface.</p>
<p>You talked about how your skinned app provided custom controls with no keyboard shortcuts, that&#8217;s just one service the OS supplies for free when you&#8217;re using native controls that you have to remember to implement properly for yourself. There are a lot of other points from the user&#8217;s perspective that &quot;just work&quot; with native controls, but developers rarely bother to implement properly in skinnable systems. Raymond listed a few of these in Taxes entry a little while back, but there are many other little things that just tend to jar you and bring you out of your normal flow when they don&#8217;t &quot;just work&quot; the way you expect them to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-360903">
				<div id="div-comment-360903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-360903">
			March 29, 2006 at 6:23 am</a>		</div>

		<p>It seems to me that the only paint requests that double-buffering would eliminate are those that the application might never receive in its lifetime, in which case, double-buffering has decreased the performance of those applications&#8230;</p>
<p>I&#8217;ve always wondered whether a suitable video adaptor could accelerate a window manager by rendering all windows into separate bitmaps and compositing them in real time (this is particularly effective with partially opaque windows of course).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-361083">
				<div id="div-comment-361083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-361083">
			March 29, 2006 at 10:53 am</a>		</div>

		<p>The biggest benefit of an automatic double buffered window manager would not (imho) be related to performance so must as the fact that the window manager could then have v-synch synchronised desktop painting.</p>
<p>And a lack of vsync is really the only thing left that makes full-screen-exclusive necessary for games.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-361293">
				<div id="div-comment-361293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-361293">
			March 29, 2006 at 2:39 pm</a>		</div>

		<p>Well, one advantage of a double-buffered WM is that you can take a screenshot of a window that&#8217;s currently covered by another window, without having to raise the target window and handle the resulting WM_PAINT messages first. &nbsp;Because the WM will have a buffer of all of that window&#8217;s pixels already.</p>
<p>(Or at least, that would be an option. &nbsp;I&#8217;m not sure if it&#8217;d be possible given the way Vista&#8217;s WM will work, because I don&#8217;t know how it&#8217;ll work.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-361553">
				<div id="div-comment-361553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-361553">
			March 30, 2006 at 12:02 am</a>		</div>

		<p>BryanK &#8212; Vista keeps each top-level window&#8217;s most recent visual contents in memory. &nbsp;This is how it does taskbar and alt-tab thumbnails.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-361713">
				<div id="div-comment-361713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-361713">
			March 30, 2006 at 9:19 am</a>		</div>

		<p>Actually, Patriot, it&#8217;s probably using &nbsp;PrintWindow, which forces a window to repaint into a memory bitmap instead of the screen. This can be done in XP too, again with the use of PrintWindow. Look at the bottom right:</p>
<p><a rel="nofollow" target="_new" href="http://www.winstep.net/temp/aerotasklist.jpg" rel="nofollow">http://www.winstep.net/temp/aerotasklist.jpg</a></p>
<p>That&#8217;s not Vista running, btw, it&#8217;s XP.</p>
<p>Under XP, PrintWindow still has some serious drawbacks however: doesn&#8217;t work with layered windows (you have to get the window DC and Bitblt instead, but even that doesn&#8217;t work with per pixel alpha layered windows), it can interfere with normal windows repainting, and it fails to get a proper snapshot sometimes. Hopefuly all issues that have been/will be tackled in Vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-363303">
				<div id="div-comment-363303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-363303">
			March 30, 2006 at 9:28 pm</a>		</div>

		<p>In Vista I believe the thumbnails are live. &nbsp;That is, if the window&#8217;s contents are changing while the taskbar tooltip is being displayed (e.g. playing a video), the tooltip will show the live contents of the window. &nbsp;This would be impossible with PrintWindow unless you do it several times a second, but is seamless under Vista since both the window itself and the tooltip are just showing the contents of the 3D surface.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-363533">
				<div id="div-comment-363533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">8</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-363533">
			March 31, 2006 at 2:49 am</a>		</div>

		<p>2D surface in a 3D environment you mean, right? Or are &nbsp;windows under Vista actually 3d (so you could look at a folder in explorer from all sides, instead of just front or back)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-363633">
				<div id="div-comment-363633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nekto2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-363633">
			March 31, 2006 at 7:31 am</a>		</div>

		<p>Frederik Slijkerman: thanks</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-364713">
				<div id="div-comment-364713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wild Hacker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060327-16/?p=31773#comment-364713">
			April 1, 2006 at 12:07 pm</a>		</div>

		<blockquote><p>
  And that&#8217;s what makes it hard.</p>
<p>You complain a lot about things being &quot;hard&quot;.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

