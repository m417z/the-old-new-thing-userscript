<html>
<head>
<title>Windows Server 2003 can take you back in time</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Windows Server 2003 can take you back in time</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>September 6, 2005 / year-entry #252</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>34</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If you are running Windows Server 2003, you owe it to yourself to enable the Volume Shadow Copy service. What this service does is periodically (according to a schedule you set) capture a snapshot of the files you specify so they can be recovered later. The copies are lazy: If a file doesn't change between...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If you are running Windows Server 2003, you owe it to yourself to <a href="http://www.wown.com/articles_tutorials/Windows-Server-2003-Volume-Shadow-Copy-Service.html"> enable the Volume Shadow Copy service</a>. What this service does is periodically (according to a schedule you set) capture a snapshot of the files you specify so they can be recovered later. The copies are lazy: If a file doesn't change between snapshots, a new copy isn't made. Up to 64 versions of a file can be recorded in the snapshot database. Bear this in mind when setting your snapshot schedule. If you take a snapshot twice a day, you're good for a month, but if you take a snapshot every minute, you get only an hour's worth of snapshots. You are trading off snapshot quality against quantity.</p>
<p> Although I can count on my hand the number of times the Volume Shadow Copy service has saved my bacon, each time I needed it, it saved me at least a day's work. Typically, it's because I wasn't paying attention and deleted the wrong file. Once it was because I make some changes to a file and ended up making a bigger mess of things and would have been better off just returning to the version I had the previous day. </p>
<p> I just click on "View previous versions of this folder" in the Tasks Pane, pick the snapshot from yesterday, and drag yesterday's version of the file to my desktop. Then I can take that file and compare it to the version I have now and reconcile the changes. In the case of a deleted file, I just click the "Restore" button and back to life it comes. (Be careful about using "Restore" for a file that still exists, however, because that will <strong>overwrite</strong> the current version with the snapshot version.) </p>
<p> One tricky bit about viewing snapshots is that it works only on network drives. If you want to restore a file from a local hard drive, you'll need to either connect to the drive from another computer or (what I do) create a loopback connection and restore it via the loopback. </p>
<p> Note that the Volume Shadow Copy service is not a replacement for backups. The shadow copies are kept on the drive itself, so if you lose the drive, you lose the shadow copies too. </p>
<p> Given the ability of the Volume Shadow Copy service to go back in time and recover previous versions of a file, you're probably not surprised that the code name for the feature was "Timewarp". </p>
<p> John, a colleague in security, points out that shadow copies provide a curious backdoor to the quota system. Although you have access to shadow copies of your file, they do not count against your quota. Counting them against your quota would be unfair since it is the system that created these files, not you. (Of course, this isn't a very useful way to circumvent quota, because the system will also delete shadow copies whenever it feels the urge.) </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (34)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-303593">
				<div id="div-comment-303593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.feedmechocolate.com/' rel='external nofollow' class='url'>Chris Mear</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303593">
			September 6, 2005 at 10:50 am</a>		</div>

		<p>Does this do anything that normal version control doesn&#8217;t? For instance, I put all my project files in &lt;a href=&quot;<a rel="nofollow" target="_new" href="http://subversion.tigris.org/&quot;&gt;Subversion&lt;/a&gt;" rel="nofollow"></a><a href="http://subversion.tigris.org/&quot;&gt;Subversion&lt;/a&#038;gt" rel="nofollow">http://subversion.tigris.org/&quot;&gt;Subversion&lt;/a&#038;gt</a>;, and commit whenever I&#8217;ve made a set of changes. If I make a mistake, I can roll back to any previous version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303603">
				<div id="div-comment-303603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.feedmechocolate.com/' rel='external nofollow' class='url'>Chris Mear</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303603">
			September 6, 2005 at 10:52 am</a>		</div>

		<p>Sorry for the munged-up link. That should have been:</p>
<p><a rel="nofollow" target="_new" href="http://subversion.tigris.org/" rel="nofollow">http://subversion.tigris.org/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303623">
				<div id="div-comment-303623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Carlos</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303623">
			September 6, 2005 at 10:57 am</a>		</div>

		<p>Windows XP also has a Volume Shadow Copy service, but I can&#8217;t find any UI to configure it.  Does anyone know how to configure it, or if it supports the file recovery functionality Raymond is talking about?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303633">
				<div id="div-comment-303633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303633">
			September 6, 2005 at 10:59 am</a>		</div>

		<p>Shadow Copies are transparent to the end user.  They are more like mounting a Subversion repository via WebDAV.</p>
<p>With a version control system, you have check out and commit files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303643">
				<div id="div-comment-303643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonas Grumby</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303643">
			September 6, 2005 at 11:02 am</a>		</div>

		<p>What&#8217;s the motivation for supporting only network drives?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303653">
				<div id="div-comment-303653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Manip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303653">
			September 6, 2005 at 11:02 am</a>		</div>

		<p>I always found *NIX solutions to versioning to be extremely over complex and lack good GUI intergration&#8230; It is almost like trying to use FTP with an extension to do your versioning. </p>
<p>Shadow copies (in this form) seems a lot more natural and human friendly, nobody needs to worry about hitting commit, thier files are just backed up for them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303663">
				<div id="div-comment-303663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://spacebunny.xepher.net/' rel='external nofollow' class='url'>KJK::Hyperion</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303663">
			September 6, 2005 at 11:16 am</a>		</div>

		<p>Jonas Grumby: actually it works wonderfully on local drives too, except the GUI doesn&#8217;t support it</p>
<p>But if you 1) know the exact device name for the snapshot (each snapshot acts like its own read-only volume; device names are in the form &quot;DeviceHarddiskVolumeShadowCopyX&quot;, X being a progressive number), 2) have a tool to create arbitrary device names (shadow copies aren&#8217;t registered with the mount manager, so you can&#8217;t use mountvol) and (optionally, only required to create globally-visible drive letters) 3) have write access to the GLOBAL?? directory in the object namespace, you can assign each of them a drive letter</p>
<p>Play with it with the vssadmin command line tool, have fun. Works great for backups too, since it lets you back up files opened in exclusive read mode (e.g. registry hives), and indeed ntbackup does support it (altough it&#8217;s been kind of broken in SP1)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-303673">
				<div id="div-comment-303673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303673">
			September 6, 2005 at 11:27 am</a>		</div>

		<p>It&#8217;s not the same as source control. Suppose you are working on something that will take two days to complete. After day 1, do you commit all your changes? No, because it doesn&#8217;t work yet. If you committed it, then everybody else on your project would have your half-finished job and the project would be broken.</p>
<p>And I suspect you don&#8217;t put every single file on your computer under version control. Imagine having to create a new project for every grocery list you write and every podcast you download&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303683">
				<div id="div-comment-303683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303683">
			September 6, 2005 at 11:29 am</a>		</div>

		<p>I really liked how VMS handled file versioning.  No UI was required since it was built into the file system.</p>
<p>bob.txt;1<br />
<br />bob.txt;2<br />
<br />bob.txt;3</p>
<p>etc.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303703">
				<div id="div-comment-303703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.trikaliotis.net/' rel='external nofollow' class='url'>strik</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303703">
			September 6, 2005 at 11:32 am</a>		</div>

		<p>With version control, I commit everything after 1 day, yes. That&#8217;s what branches are for.</p>
<p>This way, I can go back without negatively affecting other users. It&#8217;s simple.</p>
<p>Regarding the quota issue: I hope the system makes sure that cannot be used to perform a DoS attack by using more memory than my quota allows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303723">
				<div id="div-comment-303723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303723">
			September 6, 2005 at 11:48 am</a>		</div>

		<p>Carlos: I think the VSC on XP is just the &quot;client&quot; half of the Server 2003 feature, usually refered to as Previous Versions.</p>
<p>Jonus: I think the motivation behind only having a GUI for network shares is that the target audience were people storing profiles/document folders on a WS2003 server.</p>
<p>strik: You can&#8217;t DoS a server with VSC, because the server admin designates what percentage of drive space can be used for shadow copies. I believe Windows will also happily trash previous file versions if space becomes a premium.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303733">
				<div id="div-comment-303733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zeuscat.com/andrew/' rel='external nofollow' class='url'>Andrew Ho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303733">
			September 6, 2005 at 12:05 pm</a>		</div>

		<p>Timewarp sounds a lot like the &quot;Snapshot&quot; functionality provided by NetApp filers (<a rel="nofollow" target="_new" href="http://www.netapp.com/products/snapshot.html" rel="nofollow">http://www.netapp.com/products/snapshot.html</a>).</p>
<p>At Tellme we put home directories and CVS repositories on a NetApp filer and from any directory you can access a .snapshot &quot;directory&quot; (it&#8217;s not a real directory, so it won&#8217;t show up if you do something like &quot;ls&quot; or &quot;readdir()&quot; but you can get to it regardless). In there are hourly and nightly copies, up to a week back, of the files in the current directory.</p>
<p>As Raymond says I don&#8217;t think typically people use this functionality a lot, but each time you do, it saves you a LOT of time. It&#8217;s fantastic.</p>
<p>I use source control fairly religiously (I just use a personal repository in my home directory when I want only versioning, and not sharing), but I still find Snapshots indispensible for recovering from screwups.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303743">
				<div id="div-comment-303743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Manip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303743">
			September 6, 2005 at 12:07 pm</a>		</div>

		<p>Does anyone know if we will see this in Vista? I would love to be able to shadow a folder (instead of a drive), it would also be great if you could specify what location the shadow gets placed in.. That way you could have it shadowing your Documents folder constantly, so if you make any stupid changes or it corrupts on you it will be easy to go back to a previous version. </p>
<p>Note: Yes I am a lazy guy who would use it to backup documents ^Shrug^</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-303753">
				<div id="div-comment-303753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303753">
			September 6, 2005 at 12:15 pm</a>		</div>

		<p>strik: Well you have much better discipline than most people. Try convincing the Marketing department that they need to &quot;branch&quot; a file before they can edit it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303763">
				<div id="div-comment-303763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chad Beeder (msft)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303763">
			September 6, 2005 at 12:21 pm</a>		</div>

		<p>Carlos:</p>
<p>The version of Volume Shadow Copy Service in XP doesn&#8217;t support &quot;persistent&quot; shadow copies which survive across reboots. As a result, it doesn&#8217;t support the &quot;view previous versions&quot; or &quot;timewarp&quot; feature that Raymond is describing.</p>
<p>What it is used for (and Server 2003 does this as well) is for backups. When you start a backup using a backup app which supports VSS, a temporary shadow copy is created, and the backup is read from that instead of the live volume.</p>
<p>This serves two purposes: Allowing backup of files which would otherwise be difficult to back up because they were exclusively open or being written to during the backup process; and synchronizing the files so that all the files in a given backup are consistent with each other, because they all reflect their state at a precise point in time.</p>
<p>You can see VSS in action on XP by starting a backup using Ntbackup. The first thing you will see before the backup starts is a message telling you that it&#8217;s creating a shadow copy of the volume.</p>
<p>Incidentally, the offical abbreviation for Volume Shadow Copy Service is VSS (not VSC or VSCS). This may seem odd, but it has to do with a name change made during the development cycle.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303793">
				<div id="div-comment-303793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://threaddump.blogspot.com/' rel='external nofollow' class='url'>Andy Babiec</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303793">
			September 6, 2005 at 12:48 pm</a>		</div>

		<p>strik, chris mear:</p>
<p>Version control and Volume Shadow Copy serve completely different usage scenarios &#8211; which explains why SourceSafe 2005 is still coming out.</p>
<p>Volume Shadow Copy is simplified source/version control &quot;without thinking about or knowing about it&quot; but at the same time, you lose the functionality (branching, merging, etc.) provided by subversion/cvs/vss.</p>
<p>The fact that it requires no client software, is automated, etc. makes it more useful for document shares on the network.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303803">
				<div id="div-comment-303803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303803">
			September 6, 2005 at 12:53 pm</a>		</div>

		<p>Wow.  This removes yet another reason for using Novell Netware around here, knowing that Windows 2003 has the &quot;Salvage&quot; feature also&#8230; just by a different name.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-reuvenlax odd alt thread-odd thread-alt depth-1" id="comment-303813">
				<div id="div-comment-303813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ReuvenLax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303813">
			September 6, 2005 at 12:54 pm</a>		</div>

		<p>A couple of comments:</p>
<p>The lazy copying is actually done at a block level.  This distinction is transparent to a user, but it means that if one block of a file changes no other blocks need to be copied.</p>
<p>The 64 shadow copy limit is per volume.  Each volume in your systems can have a maxiumum of 64 shadow copies.</p>
<p>Storage for shadow copies is on the same volume by default, but the system can be configured to store the shadow copies on a different volume.  This doesn&#8217;t help you with reliability (if you lose either volume, you&#8217;ve lost your shadow copies), but it does improve performance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-reuvenlax even thread-even depth-1" id="comment-303823">
				<div id="div-comment-303823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ReuvenLax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303823">
			September 6, 2005 at 1:00 pm</a>		</div>

		<p>In response to KJK::Hyperion</p>
<p>The internal device name of the shadow copy of the form DeviceHarddiskShadowCopyN is subject to change every time you reboot, making your mechanism very fragile.  The correct way to expose a shadow copy is through the ExposeSnapshot API, which will expose the shadow copy in a more reliable way.  Unfortunately, this API is currently blocked for this type of shadow copy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303833">
				<div id="div-comment-303833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303833">
			September 6, 2005 at 1:01 pm</a>		</div>

		<p>With Volumen Shadow Copy you also lose the ability to commit files more frequently than what the administrator setup, to see the diffs between file versions or even to see who&#8217;s copy it is you&#8217;re looking at (if I see a file version 14 days old I have no idea if it&#8217;s different from the version 13 days old or even who saved that file). As Andy said, they serve completely different purposes.</p>
<p>On an off-topic note, why do people branch files just to work on them in source control, only to merge them back into the main tree? It looks to me like most developers (at least most I know) are still not used to work in teams, where changes happen at the same time, they all seem to want to play in their little sandbox, so they &quot;don&#8217;t break anybody else&#8217;s changes&quot;. As far as I&#8217;ve seen trying to merge all these branches (I&#8217;ve seen teams of 10 or developers where everyone had their own branch) just creates many more problems than simply working in the main branch, which works quite well for thousands of open source projects and probably three or four closed source ones (but who can really tell).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303883">
				<div id="div-comment-303883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.thespoke.net/MyBlog/travisowens/MyBlog.aspx' rel='external nofollow' class='url'>Travis Owens</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303883">
			September 6, 2005 at 1:59 pm</a>		</div>

		<p>Of course I could be an arse and point out Novell has had the equivilant of Shadow Copy since before 1995 (give or take).</p>
<p>It&#8217;s nice to see it, but jesh, it took almost 10 yrs.</p>
<p>Shadow Copy is great and I hope it&#8217;s available and enabled by default on Vista Home edition.</p>
<p>Or better yet, the home user is asked to optimize Vista for &quot;speed&quot; or &quot;reliablitiy&quot; and it will enable many settings, such as Shadowing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-303913">
				<div id="div-comment-303913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig Ringer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303913">
			September 6, 2005 at 4:09 pm</a>		</div>

		<p>This sounds much like the snapshots offered by Veritas, Linux&#8217;s LVM2, and other storage management systems. Nice to see it natively available in Windows, as it&#8217;s something I&#8217;ve often missed when working on Windows servers.</p>
<p>Copy-on-write snapshots are just wonderful when you&#8217;re backing up databases, mail servers, etc. Ask the service to finish its disk tasks and work from RAM, snapshot, tell the service it can continue writing. Nobody even notices the interruption.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303933">
				<div id="div-comment-303933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GAThrawn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303933">
			September 6, 2005 at 7:02 pm</a>		</div>

		<p>So you have to specify the files to be shadow copied in advance?</p>
<p>Surely that&#8217;s one level of activity alone will mean most users will never use it until its too late (and I&#8217;m talking about Marketing et al here).</p>
<p>When I used to be a Netware admin back in the mid-90s it did this kind of thing, but automatically with all the files on the server (until it ran out of disk space, then it just discarded the oldest files first).</p>
<p>It was a life-saver for when we were on a nightly backup routine and users messed up files in the middle of the afternoon. It was command line originally, but easy enough that the biggest trouble makers picked up how to do it themselves pretty quickly, and once we started using the Win 95 clients it was only a right-click away.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-303943">
				<div id="div-comment-303943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303943">
			September 6, 2005 at 7:30 pm</a>		</div>

		<p>You have to turn it on manually because on servers, everything defaults off for security reasons. (System Restore does something similar and everybody is furious that it&#8217;s on by default. Clearly this needs to be off by default too!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-303953">
				<div id="div-comment-303953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-303953">
			September 6, 2005 at 8:10 pm</a>		</div>

		<p>I&#8217;ve used Executive Softwares Undelete for the same type of thing. It doesn&#8217;t do scheduled copies but instead catches each file modification and saves a copy to a different hidden folder.  I set mine to keep the last 2Gb of changes, which is enough to undo most slipups.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-304013">
				<div id="div-comment-304013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">spork</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-304013">
			September 7, 2005 at 10:16 am</a>		</div>

		<p>As someone earlier pointed out, it sounds like VSC is closest to VMS&#8217;s file backups.  Comparisons to cvs/sub are somewhat humorous.  The quota question is interesting.  Maybe VMS changed later, but when I was in school circa 1990, file versions definitely counted against my quota on the student VAX cluster.  If my FORTRAN compile ran out of space I had to delete some backups (or some uuencoded usenet pr0n) to make room.  I think our student accounts had 5000 block quotas.  What are the pros and cons of putting VSC backup management into a grey zone?  It seems that if they are accounted against your quota, you would have better control&#8211;the space is preallocated, so to speak, so any scavanging to reclaim freespace has to be self-directed.  From a user&#8217;s point of view you know that backup copies won&#8217;t disappear just because some other user does something unrelated that causes the system to randomly reap backups.  Is this how Novell&#8217;s &quot;scavange&quot; worked?  Could VMS&#8217;s backup strategy be tuned to behave differently?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-304053">
				<div id="div-comment-304053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GAThrawn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-304053">
			September 7, 2005 at 11:26 am</a>		</div>

		<blockquote><p>
  You have to turn it on manually because on servers, everything defaults off for security reasons. (System Restore does something similar and everybody is furious that it&#8217;s on by default. Clearly this needs to be off by default too!)</p>
<p>Ahh, so you turn it on once for the server.</p>
<p>Your sentence near the beginning of the article &quot;&#8230;capture a snapshot of the files you specify&#8230;&quot; made it sound like individual users would have to specify files that they want shadow copied.</p>
<p>Re-reading it though I guess it could also mean that the admin would specify a group files, such as shadow copying the entire drive that contains all of marketing&#8217;s shared data.</p>
<p>One question that does come up from reading the linked article is what about deleted files? The user interaction seems to be aimed at restoring a previous version of an existing file, how would you get a file back that has been accidentally deleted by someone else?</p>
<p>Also what happens when files are moved between drives (or servers)? Do they take their shadow history across with them (obviously assuming that the target drive has shadow copying enabled) or are they treated as a file with no prior version history?
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-304073">
				<div id="div-comment-304073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-304073">
			September 7, 2005 at 11:51 am</a>		</div>

		<p>The server administrator specifies which files to build shadow copies for. I discussed deletion in the original article: &quot;In the case of a deleted file&quot;. If a file moves it looks like a deletion and a creation. (Imagine the confusion if moving a folder moved its history.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-304183">
				<div id="div-comment-304183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">N</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-304183">
			September 7, 2005 at 6:14 pm</a>		</div>

		<p>(Imagine the confusion if moving a folder moved its history.)</p>
<p>Imagine the confusion when it doesn&#8217;t. Microsoft is not the only company that&#8217;s shipped revision control software that doesn&#8217;t get this stuff right, but it&#8217;s no surprise that in 2005 they&#8217;re the ones still getting it wrong. A move is a move, you should be able to undo the /move/, but it&#8217;s still the same file, not &quot;a deletion and a creation&quot;. How&#8217;d this come to be wrong? Microsoft doesn&#8217;t understand the difference between a /file/ and a filename, see also the inability to rename files that are &quot;in use&quot;, and the consequent need to reboot Windows PCs all the time so that the OS can move a file out of the way&#8230;</p>
<p>As to the earlier comments, firstly yes, for most purposes this is equivalent to the existing snapshot functionality in your volume management system which everyone (again, except Microsoft) now seems to ship as the default way of handling fixed disks.</p>
<p>Secondly no, this isn&#8217;t version control, because it doesn&#8217;t know about versions. VMS and any revision control system keep every version, not just whatever you had 12, 24 and 36 hours ago (per the administrator&#8217;s arbitrary choices). If you do a lot of minor edits and once in a while you screw up big-time, you probably want (a decent version control system) and transparent (e.g. WebDAV) access, not this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-304213">
				<div id="div-comment-304213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-304213">
			September 7, 2005 at 6:37 pm</a>		</div>

		<p>Okay, let&#8217;s walk through it.</p>
<p>File &quot;dir1foo&quot; exists on Jan1.<br />
<br />On Jan2 it is moved to &quot;dir2foo&quot;.<br />
<br />On Jan3, you go to &quot;dir1&quot; and say &quot;View previous versions of this directory&quot; and select Jan1.<br />
<br />You expect to see foo there because foo existed in dir1 on Jan1.<br />
<br />Therefore, the Jan1 history for dir1foo needs to stay in dir1.</p>
<p>On Jan3, you go to &quot;dir2&quot; and say &quot;View previous versions of this directory&#8217; and select Jan1.<br />
<br />You do not expect to see foo there because foo did not exist in dir2 on Jan1.<br />
<br />Therefore the Jan1 history for dir2foo should not exist in dir2.</p>
<p>Volume shadowing is not version control and is not intended to replace version control. Volume shadowing is just a collection of recent volume snapshots.</p>
<p>(Enlighten me since I don&#8217;t know: Does &quot;everyone&quot; else really already implement automatic volume snapshots by default? Linux has &quot;lvcreate&quot; and Solaris &quot;fssnap&quot;, but these are manual processes, not an automatic one, and these snapshots do not persist across reboots. I don&#8217;t see anything for the Mac or FreeBSD but then again I didn&#8217;t look very hard.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-304223">
				<div id="div-comment-304223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ramon Garcia</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-304223">
			September 7, 2005 at 6:38 pm</a>		</div>

		<p>The Plan9 file server had exactly the same feature in 1995. </p>
<p>See for instance<br />
<br /><a rel="nofollow" target="_new" href="http://plan9.bell-labs.com/sys/doc/9.html" rel="nofollow">http://plan9.bell-labs.com/sys/doc/9.html</a><br />
<br />and search &quot;The File Server&quot;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-306933">
				<div id="div-comment-306933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.tallent.us/blog/PermaLink.aspx?guid=e1f5bb03-7265-4861-ab93-a908fa757e6a' rel='external nofollow' class='url'>Randomize</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-306933">
			September 18, 2005 at 9:35 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-343313">
				<div id="div-comment-343313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/02/06/525700.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-343313">
			February 6, 2006 at 10:00 am</a>		</div>

		<p>Not all folders in the user profile are stored in the user profile.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631453">
				<div id="div-comment-631453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/jgalloway/archive/2008/05/21/using-vista-previous-versions-to-restore-files-you-thought-you-d-lost.aspx' rel='external nofollow' class='url'>Jon Galloway</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050906-11/?p=34313#comment-631453">
			May 21, 2008 at 5:23 am</a>		</div>

		<p>I&#8217;m a big fan of being productive by not losing work. I don&#8217;t care how optimized your system and development</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

