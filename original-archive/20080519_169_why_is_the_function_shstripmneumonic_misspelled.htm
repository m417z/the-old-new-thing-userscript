<html>
<head>
<title>Why is the function SHStripMneumonic misspelled?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why is the function SHStripMneumonic misspelled?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 19, 2008 / year-entry #170</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>43</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If you wander through MSDN, you may stumble across the function SHStripMneumonic. The correct spelling is mnemonic. Why is the function name misspelled? "It was like that when I got here." The function was originally written for internal use only, and the person who wrote the function spelled the word incorrectly. Still, since it was...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If you wander through MSDN, you may stumble across the function <code>SHStripMneumonic</code>. The correct spelling is <i>mnemonic</i>. Why is the function name misspelled?</p>
<p> "It was like that when I got here." </p>
<p> The function was originally written for internal use only, and the person who wrote the function spelled the word incorrectly. Still, since it was an internal function, there was no real urgency to fix it. After all, there is no technical consequence of the spelling of a function's name, <a href="http://www0.us.ioccc.org/1987/hines.c"> as early entrants of the IOCCC discovered</a>. If you really wanted to, you could just call all your functions <code>F1</code> through <code>F578173</code>. </p>
<p> There the function remained, misspelled but inconsequentially so, for some time. Since it was an internal function, it didn't go through the normal scrutiny that a public interface receives. That's part of what makes it internal. </p>
<p> The effort required to fix the spelling was a bit more than usual, since the function was used by multiple teams, so there would have to be some coordination among the teams so everybody fixed their spelling at the same time. The issue sat on the back burner as a very low priority item since it wasn't hurting anybody, and the effort required to fix it really didn't justify the benefit (which was zero). </p>
<p> In 2001, the order came down to document all functions which met specific criteria (the details of which I will not go into, and I would appreciate it if others didn't try), and the <code>SHStripMneumonic</code> function was suddenly thrust onto the public stage before it had a chance to so much as comb its hair and make sure it didn't have food stuck in its teeth. The function had to be documented, warts and all, and the bad spelling was one of the warts. </p>
<p> Of course, now that the function has been published, its name is locked and can't be changed, because that would break all the programs that used the original bad spelling. </p>
<p> <b>Epilogue</b>: Some commenters are suggesting ways that the function could have combed its hair and removed food from its teeth, completely ignoring the point that the function <u>had to be documented, warts and all</u>. I assure you, nobody wanted to comb that function's hair more than me. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (43)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-630613">
				<div id="div-comment-630613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630613">
			May 19, 2008 at 10:06 am</a>		</div>

		<p>The authors of the HTTP spec misspelled referrer. So for the rest of eternity (or until they break backwards compatibility) it is a referer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630623">
				<div id="div-comment-630623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PinkDuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630623">
			May 19, 2008 at 10:11 am</a>		</div>

		<p>I&#8217;d say the benefit of fixing the typo is more than zero, as it stops annoying developers who can spell, makes the name more guessable, allows for searches on &#8216;mnemonic&#8217; to be more inclusive, and most importantly is one less character to type :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630633">
				<div id="div-comment-630633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630633">
			May 19, 2008 at 10:28 am</a>		</div>

		<p>A good solution would be to have offer both APIs, and mark the misspelled one as deprecated. &nbsp;Then after a few releases of the compiler and/or OS remove the original misspelled version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630643">
				<div id="div-comment-630643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.frozentransparency.com' rel='external nofollow' class='url'>Keith Bertelsen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630643">
			May 19, 2008 at 10:32 am</a>		</div>

		<p>What prevents the creation of SHStripMnemonic with the same arguments, and just have it be an alias for the misspelled version?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630653">
				<div id="div-comment-630653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630653">
			May 19, 2008 at 10:41 am</a>		</div>

		<p>Brian: You&#8217;d have to leave the misspelled version exported from the DLL forever; not everyone rewrites their code whenever a new OS comes out.</p>
<p>You could, of course, fix the spelling in the public SDK (the header files, possibly the .lib file, etc.) after a few releases of the SDK where the wrong spelling is deprecated. &nbsp;(You could even have the misspelled DLL export be a forwarder to the correctly-spelled export, so people spelunking in exports rather than reading the documentation might get a clue. &nbsp;And of course you wouldn&#8217;t want two copies of the implementation, so you&#8217;d probably want to do this anyway.)</p>
<p>But sadly, you can&#8217;t rely on everyone recompiling everything after any length of time, so I don&#8217;t think you can ever remove the misspelled export&#8230;</p>
<p>(Plus, what about VB6 or .net programs that call the misspelled name, but which never get compiled against header files? &nbsp;The DllImport attribute and the Declare Sub VB6 stuff both call a DLL function by its exported name; there&#8217;s no way to indicate that these programs will ever need to be changed.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630663">
				<div id="div-comment-630663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexander Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630663">
			May 19, 2008 at 10:41 am</a>		</div>

		<p>Somebody in SDK team have never heard of #define and DLL name forwarding (which would resolve old name).</p>
<p>On the other hand, those many functions in shlwapi should have never be exposed to outside world, as they&#8217;re shamefully badly designed. Think of that, a function that doesn&#8217;t have an output buffer size argument.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630683">
				<div id="div-comment-630683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630683">
			May 19, 2008 at 10:45 am</a>		</div>

		<p>There&#8217;s also the famous Unix API function creat()</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630693">
				<div id="div-comment-630693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630693">
			May 19, 2008 at 10:49 am</a>		</div>

		<p>Why do you need the SDK team to #define it with the correct spelling? You can do that all by yourself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630713">
				<div id="div-comment-630713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vsz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630713">
			May 19, 2008 at 11:50 am</a>		</div>

		<p>Come one, MS folks! You could add a corrected one as a duplicate with the same functionality, convert the old one as a wrapper (or vice versa), move the misspelled one deprecated compatibility status and you&#8217;re done&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630753">
				<div id="div-comment-630753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://deadnode.org/' rel='external nofollow' class='url'>James</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630753">
			May 19, 2008 at 12:23 pm</a>		</div>

		<p>This is all actually a cover story; in reality, the function is a hook for an anti-virus product, which was supposed to be spelled SHStripPneumonic and is intended to quarantine dangerous plague-carrying objects before they can affect the user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630763">
				<div id="div-comment-630763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630763">
			May 19, 2008 at 12:27 pm</a>		</div>

		<p>I can never remember how to spell mneumonic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630773">
				<div id="div-comment-630773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630773">
			May 19, 2008 at 12:49 pm</a>		</div>

		<div class=post>[<i>Yuhong Bao proceeds to raise a topic I specifically called out as &#8220;the details of which I will not go into, and I would appreciate it if others didn&#8217;t try.&#8221; I was afraid this would happen. Another category of blogging disappears from the queue. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630823">
				<div id="div-comment-630823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Starfish</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630823">
			May 19, 2008 at 1:33 pm</a>		</div>

		<p>Anything that arises or could possibly be connected to various Microsoft misdemeanours seems to attract this (sadly not pre-emptive-enough) snarky comment:</p>
<p>&quot;I have a bone to pick with Microsoft, so I will knowingly annoy one of their bloggers by encouraging them to bring up a dead horse everyone has long since beaten to death. Oh no, the blogger won&#8217;t play ball and has punished us all for doing what he told us not to. Obviously he is in the wrong.&quot;</p>
<p>I would rather see the comments disabled and stop things like the above than for future blogs to be purged.</p>
<p>On a related note, I guess the SHStripMneumonic function had to be exported with that name because of aforementioned reasons? Not that there is anything to prevent a #define, of course, but I hazard a guess that even adding a simple #define is not trivial if it needs to go through several reviews first. At a time when lots of functions had to be documented, fixing the typo was probably more frivolous than anything else.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630833">
				<div id="div-comment-630833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SteveL</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630833">
			May 19, 2008 at 1:35 pm</a>		</div>

		<p>For us UK programmers, most APIs are wrong, everything with Color or Center in them, for a start. So one more accidental error is neither here nor there.</p>
<p>We have had lots of fun in Apache Ant where the error message &quot;you have misspelt your task&quot; kept on generating lots of bugreps saying &quot;you have misspelled misspelt&quot; which we would file as invalid on account of EN_GB locale using &quot;misspelt&quot;. Eventually we got bored of this and switched to the some locale-neutral message like &#8216;typed it in wrong&#8217;. There goes our attempt to push back with UK spellings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630843">
				<div id="div-comment-630843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">/.er</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630843">
			May 19, 2008 at 1:38 pm</a>		</div>

		<p>I have a (non-technical) query and I&#8217;ve noticed the suggestion box has been closed for several months. Is the backlog too great / spam to voluminous for it to be reopened or does it just open for a very short period of time?</p>
<div class=post>[<i>Like it says: &#8220;Note the enormous topic backlog. Consequently, the suggestion box has been closed temporarily and will reopen once the existing backlog has cleared, which I estimate will happen sometime in early 2010. If your suggestion is that important, I&#8217;m sure you&#8217;ll remember it when the suggestion box reopens.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630853">
				<div id="div-comment-630853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wang-Lo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630853">
			May 19, 2008 at 2:19 pm</a>		</div>

		<p>&quot;If you really wanted to, you could just call all your functions F1 through F578173.&quot;</p>
<p>Be careful! &nbsp;Some poorly trained cargo-cult coder will do this and then tell everyone that you said it was all right.</p>
<p>-Wang-Lo.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt even thread-even depth-1" id="comment-630873">
				<div id="div-comment-630873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630873">
			May 19, 2008 at 2:29 pm</a>		</div>

		<p>Pre-emptive answer to obvious question:</p>
<p>No, it is NOT acceptable for Mr. Chen to make more blog posts a day than what he already does and it is NOT acceptable for him to post on the weekends. &nbsp;Like the rest of you, Mr. Chen also has a private that he would like to devote time to and also has a full-time job that requires a great deal of time. &nbsp;</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630883">
				<div id="div-comment-630883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Butler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630883">
			May 19, 2008 at 2:50 pm</a>		</div>

		<p>JamesNT: &quot;Mr. Chen also has a private that he would like to devote time to&#8230;&quot;</p>
<p>A private what?!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630893">
				<div id="div-comment-630893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fifth Amendment</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630893">
			May 19, 2008 at 2:50 pm</a>		</div>

		<p>&quot;If you really wanted to, you could just call all your functions F1 through F578173.&quot;</p>
<p>I used to work for a company as a manager, and we were developing a COM interface and the person that was the &quot;Expert&quot; came into the managers office and convinced 2 out of three mannagers to do this very thing, because COM interfaces once written couldn&#8217;t be changed. &nbsp;I didn&#8217;t buy his arguments but the other managers did, so for about 6 months the DLL&#8217;s for this project exposed function0 through function25. &nbsp;</p>
<p>It was about then that the flaws became apparent to the other managers, they were trying to trace a bug and the &quot;anonymous&quot; functiona made it near impossible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-630903">
				<div id="div-comment-630903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630903">
			May 19, 2008 at 3:07 pm</a>		</div>

		<p>&quot;I was afraid this would happen. Another category of blogging disappears from the queue.&quot;</p>
<p>Please let me encourage you not to choose the stock of your china shop solely on its bull-resistance, especially when you have just put that bull out to pasture. &nbsp;The history of this blog has shown that people&#8217;s behavior does improve; just take a trip back to 2004&#8217;s comments to see what I mean. &nbsp;I enjoy these excursions into quirkiness and would like to see them continue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630913">
				<div id="div-comment-630913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dmitry Kolosov</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630913">
			May 19, 2008 at 3:36 pm</a>		</div>

		<p>@SteveL</p>
<blockquote><p>
  For us UK programmers, most APIs are wrong, everything with Color or Center in them
</p></blockquote>
<p>Just imagine how wrong it is for us Russian programmers. AmEng and BrEng just happen to be similar enough to make you think it&#8217;s the same language :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kjkhyperion odd alt thread-odd thread-alt depth-1" id="comment-630933">
				<div id="div-comment-630933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630933">
			May 19, 2008 at 3:37 pm</a>		</div>

		<p>Public APIs aren&#8217;t always exempt:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/aa506097.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/aa506097.aspx</a></p>
<p>&quot;Note that these two names are misspelled, but are consistent with the names that appear in the header file, winsplp.h&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630943">
				<div id="div-comment-630943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630943">
			May 19, 2008 at 3:50 pm</a>		</div>

		<p>Great&#8230;</p>
<p>&#8211; Say something intriguing</p>
<p>&#8211; Ask people not to talk about it</p>
<p>&#8211; Sulkily take your ball home when the totally inevitable happens</p>
<p>Why do you do this? Repeatedly?</p>
<div class=post>[<i>Because I never learn my lesson. Perhaps I should run my topics past you, and you can tell me which ones are &#8220;intriguing&#8221; and therefore should be avoided. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-631003">
				<div id="div-comment-631003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631003">
			May 19, 2008 at 5:27 pm</a>		</div>

		<p>@Joe</p>
<p>A private LIFE!! &nbsp;Yes, I left out a word and apologies but surely we could all fill in the blank on that one with our dignities intact.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631023">
				<div id="div-comment-631023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Fifth Amendment</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631023">
			May 19, 2008 at 7:12 pm</a>		</div>

		<p>MadQ,</p>
<p>I apologize to have given the impression, but I wasn&#8217;t nitpicking, I forgot to include Wang-Lo&#8217;s comment: &quot;Be careful! &nbsp;Some poorly trained cargo-cult coder will do this and then tell everyone that you said it was all right.&quot;</p>
<p>It was in response to the Comment from Wang-Lo to show that it has already happened, but the blame was put on Microsoft documentation.</p>
<p>I won&#8217;t say too much more about that situation, except I did argue that this &quot;Expert&quot; was making a terrible suggestion.</p>
<p>It did make sense to standardize the names for this project, as it was using COM for a plug-in frame work, but even if his arguments were true there were better solutions.</p>
<p>Again, I apologize for the impression of nit-picking, and I fully appreciate the points Raymond is making.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631033">
				<div id="div-comment-631033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">x</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631033">
			May 19, 2008 at 7:26 pm</a>		</div>

		<blockquote><p>
  &gt; I was afraid this would happen. Another category of blogging disappears from the queue.
</p></blockquote>
<p>Please don&#8217;t. &nbsp;Just disable comment on these posts. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631043">
				<div id="div-comment-631043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.simpleigh.com/2008/05/link-of-the-day-2/' rel='external nofollow' class='url'>simpleigh.com - blog &raquo; Link of the day</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631043">
			May 19, 2008 at 7:40 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.simpleigh.com/2008/05/link-of-the-day-2/" rel="nofollow">http://blog.simpleigh.com/2008/05/link-of-the-day-2/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631073">
				<div id="div-comment-631073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hendonet.com' rel='external nofollow' class='url'>Neil</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631073">
			May 19, 2008 at 8:14 pm</a>		</div>

		<p>Are you sure that SHStripMneumonic is not actually a mis-spelling of:</p>
<p>SHStripPneumonic</p>
<p>Removes a lung from a human being.</p>
<p>Syntax:</p>
<p>BOOL SHStripPneumonic(LONG painTolerance, void *human);</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631083">
				<div id="div-comment-631083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lahosken.san-francisco.ca.us/' rel='external nofollow' class='url'>Larry Hosken</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631083">
			May 19, 2008 at 8:19 pm</a>		</div>

		<p>As a professional technical writer, I must point out that there is only one solution for this problem: more jargon. &nbsp;Specifically, you need to convince people that &quot;mneumonic&quot; means something. &nbsp;I suggest one of the following definitions:</p>
<ol>
<li>A mental trick for remembering which menu a menu item appears in. &nbsp;E.g., &quot;Cut, Copy, Paste, Undo; Under edit, one two. In File, here&#8217;s a hint: Save, Export, Close, Print&quot;</li>
<li>
<p>A mental trick for remembering what the f57183 function does.</p>
</li>
<li>
<p>It means&#8230; the thingy that SHStripMneumonic strips.</p>
</li>
</ol>
<p>Soon, everyone will be saying &quot;mneumonic&quot; all the time, probably in meetings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631103">
				<div id="div-comment-631103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631103">
			May 19, 2008 at 8:55 pm</a>		</div>

		<blockquote><p>
  I am thinking of writing about this on my own blog, and putting a link to it from here. Is that OK? I&#8217;m sure I can, since it is my own blog.
</p></blockquote>
<p>Why don&#8217;t you actually use your brain, and since you&#8217;re clearly pretty impressed with the capabilities of the one you have, the answer should be obvious whether that would be appreciated (although I am actually impressed you asked, perhaps you are learning how to intereact with adults).</p>
<p>I would remind you, Yuhong Bao, you promised to stop posting here. It&#8217;s a pity you don&#8217;t keep your promises.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631113">
				<div id="div-comment-631113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631113">
			May 19, 2008 at 9:41 pm</a>		</div>

		<p>MADQ: Actually, &quot;COM&quot; isn&#8217;t strictly binary. &nbsp;Any time you want to make your handy-dandy COM object visible to Javascript, you need to start making IDispatch() thingies &#8212; and those do make use of the actual string of the name.</p>
<p>(You might argue that &quot;that isn&#8217;t COM&quot; &#8212; but you&#8217;d be wrong. COM is an entire ecosystem and not just a fancy word for VTable)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-madq42 odd alt thread-odd thread-alt depth-1" id="comment-630953">
				<div id="div-comment-630953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MadQ1' rel='external nofollow' class='url'>MadQ1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-630953">
			May 19, 2008 at 4:07 pm</a>		</div>

		<p>&quot;&#8230;because COM interfaces once written couldn&#8217;t be changed.&quot;</p>
<p>Did anyone tell them that a COM contact is strictly binary? COM doesn&#8217;t care about names. Of course the semantics of an interface might say differently (a la IDispatch). The semantics are just the rules above and beyond COM. It&#8217;s up to the designer of the interface to communicate them.</p>
<p>Anyway&#8230; as long as the function stays in the same slot in the vtable, you can rename it till the cows come home. It&#8217;s actually done fairly frequently when using the CLR and COM InterOp.</p>
<p>Now, whether renaming things willy-nilly is a good idea, is an entirely different topic.</p>
<p>Geez, so much for a quick one-liner comment. Damn nit-pickers!</p>
<p>Regarding disappearing categories: *sigh* there&#8217;s just always that one person who just _has_ to p^Hrelieve themselves into the erm&#8230; liquid food.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-631173">
				<div id="div-comment-631173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631173">
			May 19, 2008 at 11:58 pm</a>		</div>

		<p>Peter: But you can write your IDispatch interface to take any value you like as the &quot;name&quot; and call whatever you like. &quot;Foo&quot; by IDispatch might call a totally different method to &quot;Foo&quot; by the VTable&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-631183">
				<div id="div-comment-631183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631183">
			May 20, 2008 at 1:52 am</a>		</div>

		<p>And just FYI, I&#8217;m certainly not advocating that anybody actually does what I suggested in the comment above :p~</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631193">
				<div id="div-comment-631193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">stdout</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631193">
			May 20, 2008 at 2:11 am</a>		</div>

		<p>That&#8217;s why he codes in C++, so he can keep his private members strictly private.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-631273">
				<div id="div-comment-631273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631273">
			May 20, 2008 at 5:08 am</a>		</div>

		<p>@KJK::Hyperion: I suspect that was a note to the copy editor not to correct the spelling, which was left in the final copy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631293">
				<div id="div-comment-631293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AndyC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631293">
			May 20, 2008 at 9:46 am</a>		</div>

		<p>@JamesNT, yes it was obvious you meant &quot;Life&quot;, but &quot;Detective Agency&quot; sounds so much more exciting! ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631233">
				<div id="div-comment-631233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Markus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631233">
			May 20, 2008 at 4:08 am</a>		</div>

		<p>In my experience, when working on *internal* projects, having to document the &quot;warts&quot; is the best time to remove them: it is often easier to fix strange/erroneous/unpredictable behaviour, mistyped names, and &quot;holes&quot; in the API than to document them. </p>
<p>Of course, you can&#8217;t do this easily in an API that is already baked into DLLs that are deployed in production programs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631333">
				<div id="div-comment-631333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631333">
			May 20, 2008 at 11:14 am</a>		</div>

		<p>[Because I never learn my lesson.]</p>
<p>I regret thus far you are right.</p>
<p>[Perhaps I should run my topics past you, and you can tell me which ones are &quot;intriguing&quot; and therefore should be avoided. -Raymond]</p>
<p>I can save you some time with a simple rule &#8212; give up immediately on anything where you feel the need to say &quot;please don&#8217;t discuss this in the comments&quot;, or similar.</p>
<p>Don&#8217;t take it personally. Just tedious to see this happening repeatedly. Your blog is sensational.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631393">
				<div id="div-comment-631393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lauren Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631393">
			May 20, 2008 at 9:16 pm</a>		</div>

		<p>Shouldn&#8217;t that be &quot;SHStripPneumonic&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631463">
				<div id="div-comment-631463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SuperKoko</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631463">
			May 21, 2008 at 6:24 am</a>		</div>

		<p>I don&#8217;t think fixing the typo is worth it.</p>
<p>A simple #define cannot solve the compatibility problem. Win32 isn&#8217;t bound to the C and C++ programming languages. It defines an ABI.</p>
<p>So, if a transition from the old name to the new name had to be performed, the DLL would have to export both symbols (SHStripMneumonic and SHStripMnemonic), at least for a long time. Most probably forever.</p>
<p>A typo isn&#8217;t important, in my opinion. It doesn&#8217;t kill kittens.</p>
<p>&quot;There&#8217;s also the famous Unix API function creat()&quot;</p>
<p>creat was intentionally misspelled, most probably because UNIX creators don&#8217;t like vowels and like very short names such as ls or ln, maybe because interactive typewriters were painful to use&#8230;</p>
<p>In my opinion, this name has advantages. It&#8217;s easier to search on google or on a web page than create() would be. By using a different pronunciation, it&#8217;s easy to unambiguously talk about this function.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631833">
				<div id="div-comment-631833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631833">
			May 21, 2008 at 4:21 pm</a>		</div>

		<p>Sometimes when reading the SHLWAPI docs it makes me feel somebody in the shell team loves to reinvent the wheel :)</p>
<p>Just look at all the StrXxx functions (are kernel32&#8217;s lstrxxx or msvcrt&#8217;s strxxx/wcsxxx functions not good enough?), or other functions that seem to just wrap another API function (example, the SH-Registry functions; although for all of these, one can assume that they were put there for Win9x compatibility, a.k.a on Win9x they did more to emulate NT behavior and/or support Unicode).</p>
<div class=post>[<i>What locale do strxxx/wcsxxx operate in? The answer may surprise you. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-631873">
				<div id="div-comment-631873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080519-00/?p=22273#comment-631873">
			May 21, 2008 at 4:52 pm</a>		</div>

		<p>[What locale do strxxx/wcsxxx operate in? The answer may surprise you. -Raymond]</p>
<p>My assumptions (pulled *totally* out of nowhere):</p>
<p>&#8211; kernel32&#8217;s lstrxxx: (w)char-per-(w)char-wise comparison/copy</p>
<p>&#8211; msvcrt&#8217;s strxxx/wcsxxx: using the C locale per default, unless overriden in the thread using setlocale (which can be a problem if not all the running code in the thread can be guaranteed to not change it under the rest of the code&#8217;s back, such as in shell extensions or other plugins)</p>
<p>But another one I forgot: NTDLL has it&#8217;s own mini-CRT, but I assume this one would be simplistic enough to not care about code pages and just operate on (w)chars blindly&#8230;</p>
<p>Which then reminds me, if I can&#8217;t assume all the C string functions will be deterministic because they are not &quot;blind enough&quot;, I&#8217;ll have a few 50000-line projects to search-and-replace the calls to dumber ones :(</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

