<html>
<head>
<title>When people ask for security holes as features: Hiding files from Explorer</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>When people ask for security holes as features: Hiding files from Explorer</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>April 19, 2005 / year-entry #98</td></tr>
<tr><td><b>Tags:</b></td><td>history;when-people-ask-for-security-holes-as-features</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>40</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">By default, Explorer does not show files that have the FILE_ATTRIBUTE_HIDDEN flag, since somebody went out of their way to hide those files from view. You can, of course, ask that such files be shown anyway by going to Folder Options and selecting "Show hidden files and folders". This shows files and folders even if...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>By default, Explorer does not show files that have the <code>FILE_ATTRIBUTE_HIDDEN</code> flag, since somebody went out of their way to hide those files from view.</p>
<p> You can, of course, ask that such files be shown anyway by going to Folder Options and selecting "Show hidden files and folders". This shows files and folders even if they are marked as <code>FILE_ATTRIBUTE_HIDDEN</code>. </p>
<p> On the other hand, files that are marked as both <code>FILE_ATTRIBUTE_HIDDEN</code> and <code>FILE_ATTRIBUTE_SYSTEM</code> remain hidden from view. These are typically files that involved in the plumbing of the operating system, messing with which can cause various types of "excitement".  Files like <a href="http://support.microsoft.com/kb/314482"> the page file</a>, <a href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/custom.asp"> folder configuration files</a>, and <a href="http://blogs.msdn.com/oldnewthing/archive/2003/11/20/55764.aspx"> the System Volume Information</a> folder. </p>
<p> If you want to see those files, too, then you can uncheck "Hide protected operating system files". </p>
<p> Let's look at how far this game of hide/show ping-pong has gone: </p>
<table>
<tr>
<th></th>
<th>Show</th>
<th>Hide</th>
</tr>
<tr>
<td>1.</td>
<td>Normal file</td>
</tr>
<tr>
<td>2.</td>
<td></td>
<td>Hidden file</td>
</tr>
<tr>
<td>3.</td>
<td>"Show hidden files"</td>
</tr>
<tr>
<td>4.</td>
<td></td>
<td>Hidden + System</td>
</tr>
<tr>
<td>5.</td>
<td>"Show protected<br>operating system files"</td>
</tr>
</table>
<p> You'd think this would be the end of the hide/show arms race, but apparently <a href="http://blogs.msdn.com/oldnewthing/archive/2004/11/23/268486.aspx#268936"> some people want to add a sixth level and make something invisible to Explorer, overriding the five existing levels</a>. </p>
<p> At some point this back-and-forth has to stop, and for now, it has stopped at level five. Adding just a sixth level would create a security hole, because it would allow a file to hide from the user. As a matter of security, a sufficiently-privileged user must always have a way of seeing what is there or at least know that there is something there that can't be seen. Nothing can be undetectably invisible. </p>
<p> If you add a sixth level that lets a file hide from level five, then there must be a level seven that reveals it. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (40)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-271373">
				<div id="div-comment-271373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miles Archer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271373">
			April 19, 2005 at 9:08 am</a>		</div>

		<p>If a no program can read a file, does it really exist?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271383">
				<div id="div-comment-271383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mschaef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271383">
			April 19, 2005 at 9:22 am</a>		</div>

		<p>On this Win2000 box, those options appear under the &quot;Advanced Settings&quot; list box, which is driven by information in HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionExplorerAdvancedFolder .</p>
<p>That should make it possible to remove the options entirely, which for a determined sysadmin, could be viewed as the &quot;sixth level&quot;.</p>
<p>(In any event, this reminds me of caller ID and the block-all-withheld-number-calls features offered by telephone companies, a few years ago)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271393">
				<div id="div-comment-271393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271393">
			April 19, 2005 at 9:31 am</a>		</div>

		<p>Programs that want to hide information already do so by utilizing a Alternate Data Stream function within NTFS. If that is considered to be the 6th level, there are no documented 7th level options to display these ADS (we can use 3rd party tools like from sysinternals though). Any reason, why explorer does not show the ADSs in the list or properties?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271403">
				<div id="div-comment-271403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mdahmus.thebaba.com/blog/' rel='external nofollow' class='url'>M1EK</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271403">
			April 19, 2005 at 9:33 am</a>		</div>

		<p>Although I usually argue the opposite side, on this one I have to side with the Unix folks and blame this on poor user/admin separation in the NT base. &quot;root&quot; on unix would obviously see all those files and be able to do whatever they wanted; normal user would not; and that works well in most cases.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271413">
				<div id="div-comment-271413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.jimbo.org.uk/' rel='external nofollow' class='url'>James Green</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271413">
			April 19, 2005 at 9:36 am</a>		</div>

		<p>If a sixth level, and corresponding 7th level, were to appear, I&#8217;m sure many users, including myself, would configure Explorer all the way to the 7th level without a thought, by default, just as we do with level 5 today.</p>
<p>Now there&#8217;s progress :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271423">
				<div id="div-comment-271423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.kryogenix.org/' rel='external nofollow' class='url'>Stuart Langridge</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271423">
			April 19, 2005 at 9:36 am</a>		</div>

		<p>Just in case I&#8217;m missing something, aren&#8217;t the Temporary Internet Files hidden successfully from Explorer? They don&#8217;t all show up, even with &quot;Show hidden files and folders&quot; on and &quot;Hide protected operating system files&quot; off. (They&#8217;re sort-of hidden from DOS; &quot;dir&quot; doesn&#8217;t show them all, but the TAB filename completion thing finds them.) I was sure you&#8217;d written something on this in the past, but the search engine fails to turn up anything for &quot;temporary internet files&quot;, so perhaps I imagined it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271443">
				<div id="div-comment-271443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271443">
			April 19, 2005 at 9:54 am</a>		</div>

		<p>The major problem of &quot;Explorer&quot; settings is that they are &quot;global&quot;. You can&#8217;t have the views in which the files with hidden attributes are shown and the views in which all the files are visible. And that&#8217;s exactly could be convenient. For example, when I search for documents (or programs) I&#8217;d like to be able to search through the disk but to ignore all the folders which are hidden (for example, skipping &quot;Temporary Intrnet Files&quot;). On the other hand, when I manage files (look what&#8217;s in some folder) I really want to see what&#8217;s really there.</p>
<p>When I would be able to run something like </p>
<p>&quot;Explorer /showHidden /root,.&quot; (which would mean &quot;open new explorer window of the directory I&#8217;m currently in, but with all files shown) (BTW, &quot;.&quot; is not working now, I always have to specify the full path, anybody knows why?)</p>
<p>then I guess I would leave hidden files not shown by default. Good UI alternative would be if I would be able to press some toolbar button to show/hide &quot;hidden&quot; files.</p>
<p>I guess right now most people discover that the Explorer doesn&#8217;t show everything they&#8217;re interested in, they turn it on (it&#8217;s not so pleasant to find where to flip the feature) and leave like this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271453">
				<div id="div-comment-271453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winwonk.com' rel='external nofollow' class='url'>Kim Gr&#228;sman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271453">
			April 19, 2005 at 9:55 am</a>		</div>

		<p>NTFS streams are a bit like that. Nothing, barring ACL:s I guess, stops me from adding a parallel data stream to C:autoexec.bat, containing my supersecret data.</p>
<p>Explorer won&#8217;t see it, but streams.exe may be considered a seventh level in this case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271463">
				<div id="div-comment-271463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271463">
			April 19, 2005 at 10:03 am</a>		</div>

		<p>The Temporary Internet Files folder has magic applied to it via a shell namespace extension. </p>
<p><a rel="nofollow" target="_new" href="http://www.microsoft.com/mind/0298/cutting0298.asp" rel="nofollow">http://www.microsoft.com/mind/0298/cutting0298.asp</a></p>
<p>Notice that if you add &quot;content.ie5&quot; to your TIF folder path you can actually see the files. You can also get to the actual files through the command line as long as you use /ah or /as to view hidden/system files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271473">
				<div id="div-comment-271473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Hancock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271473">
			April 19, 2005 at 10:42 am</a>		</div>

		<p>this is right up there with that INCREDIBLY stupid option to hide file extensions. 99% of those viruses in email that are now stripped out would not have been a problem if the hide file extensions of known types check box didn&#8217;t exist or at least it was defaulted to OFF.</p>
<p>I know you were trying to compete with mac back in the day, but really&#8230;. You&#8217;re not anymore, put back the file extensions!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271483">
				<div id="div-comment-271483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pookie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271483">
			April 19, 2005 at 11:38 am</a>		</div>

		<p>What I would like instead of the simple shown/hidden possibilities would be a flag based on user rights.</p>
<p>So you could log in as administrator and see all the files on the system; but when logged in as a standard user, some files would be hidden.</p>
<p>A kind of &quot;permissions&quot; on the &quot;show file&quot; flag if you will&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271493">
				<div id="div-comment-271493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271493">
			April 19, 2005 at 12:02 pm</a>		</div>

		<p>I&#8217;ve encountered folders that were not visible even with both options set correctly. I finally got them to show up in a cmd prompt by using dir telling it to show all attributes. It seems to have something to do with desktop.ini settings. But that was quite a while ago and I could be mistaken.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271513">
				<div id="div-comment-271513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271513">
			April 19, 2005 at 1:22 pm</a>		</div>

		<p>Really couldn&#8217;t this just lead to Explorer Replacements. I know I have already gotten sick with this Hiding crap. </p>
<p>For Example the other day I go to burn a DVD with about 4 gigs of MP3s on it. I can&#8217;t figure out what in the heck is taking up all the space, it doesn&#8217;t seem like 4 gigs of music where the heck is it going. I know somethings wierd but I didn&#8217;t really want to sit there and figure it out I just wanted to throw the DVD in my DVD player which also plays MP3s that are burnd on disk.</p>
<p>Well it also shows pictures. My DVD from the manuafacturer specifically states and this is a great feature. Burn a dvd of images and it will treat them all as a photo show. Burn a DVD of MP3s I can set up play lists and so on or it will just start playing the music I can set randomly and so on. </p>
<p>Now however if I put in a dvd with both images and mp3s it won&#8217;t do anything but display the files structure if I want to play a song I have to go choose each song if I want to see a pic I have to go select it.</p>
<p>Well thanks Microsoft for hiding the fact that you download the album cover images from Media Player and put them in that songs directory. I never Unhid files in that directory because I created it, I put things there, I organized it. I wasn&#8217;t expecting when I just dragged the entire music folder to the DVD Burning software that there were images in there. Now I sat there waiting for the entire thing to burn, Verify the burn. Then put the dang thing in there expecting it to work and it doesn&#8217;t because you hid files on me. Unhide them and look. Yep there are all these JPG files.</p>
<p>Oh and then it gets better. So I write a little script, fine I will just go delete all files in that directory *.jpg, reburn dvd again. ARRRRRRGGGGGGGGG System files thumbs.db that was hidden from being hidden and thubs.db only gets created if there are images in there&#8230;.. And they want to add another level.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271523">
				<div id="div-comment-271523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com/' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271523">
			April 19, 2005 at 2:49 pm</a>		</div>

		<p>&quot;Putting GDI in kernel mode in NT4, for speed reasons they claimed (reasons, that now, are completely irellevant!).&quot;</p>
<p>Why are those reasons irrelevant? Context switches between user mode and kernel mode are always going to be an expensive operation. Even if you run User and GDI in Ring 3 as NT 3.x did, the Win32 subsystem is regarded as so critical to the operation of the OS, that NT is actually designed to halt if that subsystem goes down.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271533">
				<div id="div-comment-271533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271533">
			April 19, 2005 at 2:59 pm</a>		</div>

		<p>While we&#8217;re ranting about explorer. Does anybody know how to disable that message box that shows up when you rename a file but also change the extension?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271543">
				<div id="div-comment-271543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271543">
			April 19, 2005 at 4:47 pm</a>		</div>

		<p>Why are we fighting an arms race with &quot;hide protected operating system files&quot; when we can simply &quot;protect operating system files&quot;? Who cares who gets to see the goodies when a foot thick bulletproof glass separates them from the Village Idiot?</p>
<p>And if visibility itself is core to somebody&#8217;s security, why not safeguard against a file&#8217;s enumeration via the ACL?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271563">
				<div id="div-comment-271563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.livejournal.com/users/merle_/' rel='external nofollow' class='url'>Merle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271563">
			April 19, 2005 at 6:37 pm</a>		</div>

		<p>Ah, but there is a sixth level.  What about the hidden &quot;desktop.ini&quot; file that holds a GUID that alters how explorer shows files?  That&#8217;s why fonts, IE history, etc all look different.</p>
<p>So it&#8217;s there.  It&#8217;s just not a file attribute, it&#8217;s a directory thing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271573">
				<div id="div-comment-271573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://brycekerley.net/' rel='external nofollow' class='url'>Bryce Kerley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271573">
			April 19, 2005 at 6:37 pm</a>		</div>

		<p>But what if somebody wants to modify their system files?  If they have the privileges, the system shouldn&#8217;t stop them from doing it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271503">
				<div id="div-comment-271503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271503">
			April 19, 2005 at 12:45 pm</a>		</div>

		<p>This post is not using traditional wording, for me, but I think it&#8217;s an issue important enough, and something that has had (negative) impact on me, my working and even private life, why I can&#8217;t sit silent. Should someone want to censor this: screw them.</p>
<p>I think, basically, Microsoft screwed up so bad with Win98 (and therefore NT5), that the race is lost.</p>
<p>This could be changed with one change; fix IE.</p>
<p>Really. Remove IE and all its hated HTML parsers, controls and viral infected crap. Make that *** &lt;i&gt;per user&lt;/i&gt;. Remove the HTML crap (for crap is what it is) from the Explorer used to view operating system filesystems. Just remove it! NT4 and Win95 Explorer.exe&#8217;s worked perfectly fine. Why destroy them? Just to display your power over customers, to open the doors to infect them with viruses, spyware and other crap that could be seen as the plague of Microsoft?</p>
<p>Break compatibility. Yes, I know that sucks, but would Microsoft rather forever support virus spreading and other *** with your software (which you do today, you freakin&#8217; idiots!), or break compatibility to do something right again for a change?</p>
<p>&quot;Right again&quot;? Yes. With NT (I&#8217;m thinking of the original 1.0/3.1), Microsoft hired (not bought, that started later) personnel did something good. Very good, if you ask me.</p>
<p>With NT4, they started to fsck up. GDI and USER worked like a charm in 3.51, but nooo&#8230; speed. Look at it today. Would you even recognize the speed difference between the 3.51 and 4.0 (meaning 4.0, 5.0, 5.1 and 5.2, aka 2003) model, using machines of today?</p>
<p>I dubt you would, meaning Microsoft committed the cardinal sin of premature optimization in around 1996. What&#8217;s especially bad with this &quot;violation&quot;, is that they opened the door for many, perhaps uncountable, security holes, and they NEVER displayed any interest in reverting that horribly bad decision. Much like anyone with tunnel sight doing something, Microsoft steamed ahead with this fucked up &quot;new&quot; design, making NT more into Win9x wrt. security. Way to go, morons!</p>
<p>Do you f.ex. know why Citrix, or TS, costs you so much, but the similar but often better functionality over X, using even free software if you like, costs less or is even free? It&#8217;s due to Microsoft:</p>
<p>1. Putting GDI in kernel mode in NT4, for speed reasons they claimed (reasons, that now, are completely irellevant!).</p>
<p>2. Making the interface for drivers &quot;secret&quot; (try getting [b]all[/b] data you need as a free software developer, and feel your anus stretch with an MS representative standing behind you and pressing hard).</p>
<p>Putting HTML junk into kmode, or &quot;even just&quot; the system itself, making HTML parsers and renderers system wide (and allowed to CreateProcess() through ShellExecute(), was likely the worst, ever, decision any human has ever made. Any sane person would never have ever &quot;invented&quot; it, but Microsoft not only created it, they have defended it for a decade now! It has estimated costed society something like 10-40 TIMES more than Microsoft itself is worth. What&#8217;s next, including a vial of Ebola with every license of XP sold?!</p>
<p>Sorry Raymond, for possibly abusing your blog like this. Feel free to edit, or even remove this post. I just had to get it off my chest.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271583">
				<div id="div-comment-271583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271583">
			April 19, 2005 at 8:56 pm</a>		</div>

		<p>Totally agreed. Feature that &quot;disallow people from edit/deleting essential files unless another action is explicitly taken first&quot; type of protection is enough, further requests of &quot;protection&quot; can indeed only create security holes.</p>
<p>P.S.: IMHO, *nix&#8217;s sticky-bit type of protection is quite good in terms of this &#8211; not &quot;user friendly&quot; enough for casual users to mess with it(accidentially delete the file under protection, or accidentialy set up the bit), but experienced users can easily play with it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271593">
				<div id="div-comment-271593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Fitzpatrick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271593">
			April 20, 2005 at 1:38 am</a>		</div>

		<p>And what about Windows File Protection- you know, that dllcache thing that MS hacked together. Whats up with that? Really makes you wonder what goes on in Redmond???</p>
<p>The thing about windows is that it suffers from a fatal flaw- it has no self respect. It allows any printer driver that a user installs to muck with the system files, and, by the way, make the app that you spend hunderds of hours on stop working! Happened to me. Now MS has a word for it- DLL HELL! or maybe they just picked that up from NNTP somewhere.</p>
<p>But seriously, DLLCACHE? Gotta make you wonder, who dreams this SH*T up for MS?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271603">
				<div id="div-comment-271603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">wound</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271603">
			April 20, 2005 at 2:31 am</a>		</div>

		<p>There is already at least one more level. Files which are hidden from the Win32 API by the kernel, such as NTFS metadata, which is where the next breed of root kits, spyware and virii will hide. Once you&#8217;ve got something running in kernel mode there is no way to know for certain that what your computer shows you is real.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271613">
				<div id="div-comment-271613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Lezard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271613">
			April 20, 2005 at 4:40 am</a>		</div>

		<p>Wait a minute &#8211; there IS a sixth layer of &quot;hiddenness&quot; &#8211; I don&#8217;t see Explorer revealing the super-hidden files such as C:$Boot, C:LogFile, C:$MFT, and others.</p>
<p>Explorer doesn&#8217;t have a chance, mind you, since they are protected by the filesystem API itself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271623">
				<div id="div-comment-271623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Lezard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271623">
			April 20, 2005 at 4:46 am</a>		</div>

		<p>Exactly what I was talking about, wound.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271633">
				<div id="div-comment-271633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271633">
			April 20, 2005 at 4:58 am</a>		</div>

		<p>Try putting a file in the recycle bin directory. It&#8217;ll be effectively invisible from the ui.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271653">
				<div id="div-comment-271653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com/' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271653">
			April 20, 2005 at 8:03 am</a>		</div>

		<p>&quot;And what about Windows File Protection- you know, that dllcache thing that MS hacked together. Whats up with that? Really makes you wonder what goes on in Redmond???&quot;</p>
<p>It&#8217;s quite simple really. Stopping applications from overwriting system files would break the apps, so they&#8217;ve allowed to overwrite and then the original system file is restored from the cache.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271723">
				<div id="div-comment-271723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://getwired.blogspot.com' rel='external nofollow' class='url'>Wes Miller</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271723">
			April 20, 2005 at 10:30 am</a>		</div>

		<p>&quot;It&#8217;s quite simple really. Stopping applications from overwriting system files would break the apps, so they&#8217;ve allowed to overwrite and then the original system file is restored from the cache.&quot;</p>
<p>True &#8211; though a better implementation of WFP would have used a filesystem write filter to let the application THINK it was writing the binary, but never overwrite it at all. Then there would be nothing to replace, and the bloat of DLLCache wouldn&#8217;t be required.</p>
<p>The only things that should have ever been able to overwrite a Microsoft signed binary in %windir% are Microsoft-sourced hotfixes, service packs, and Windows upgrades. Not installers for random applications.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-271733">
				<div id="div-comment-271733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271733">
			April 20, 2005 at 10:36 am</a>		</div>

		<p>But you can&#8217;t throw the writes away because some installers do a checksum of the file to make sure it got copied okay. So now you have to emulate all the file operations &#8211; and now you&#8217;re emulating a filesystem &#8211; why not just use the filesystem?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271743">
				<div id="div-comment-271743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marco</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271743">
			April 20, 2005 at 10:41 am</a>		</div>

		<p>LOL&#8230; with desktop.ini and alternate data stream, we have two ways to hide files that Raymond didn&#8217;t even mention. Does that mean we are at level nine now? ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271753">
				<div id="div-comment-271753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://getwired.blogspot.com' rel='external nofollow' class='url'>Wes Miller</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271753">
			April 20, 2005 at 10:48 am</a>		</div>

		<p>&quot;But you can&#8217;t throw the writes away because some installers do a checksum of the file to make sure it got copied okay. So now you have to emulate all the file operations &#8211; and now you&#8217;re emulating a filesystem &#8211; why not just use the filesystem?&quot;</p>
<p>You don&#8217;t have to immediately discard the writes &#8211; keep them around until the installer has exited&#8230; whatever. Don&#8217;t get me wrong &#8211; the last thing I think Windows needs is duct-tape (as I just proposed) holding things like WFP together. But if the problem is installers stomping on protected binaries, then preventing stomping is step 1. Step 2 is going back and cleaning up the fundamental flaws of file redistribution where every installer in the world ships a different version of every MS binary &#8211; causing DLLHell, and leading to the over-engineered solution that is side-by-side (see my duct-tape reference above).</p>
<p>I&#8217;m just sayin&#8217;&#8230; :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-271763">
				<div id="div-comment-271763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271763">
			April 20, 2005 at 10:48 am</a>		</div>

		<p>It appears that people misunderstood the scope of the original request. It wasn&#8217;t &quot;Hi, I&#8217;m making a rootkit and I want to hide stuff&quot;.  It&#8217;s &quot;Hi, I&#8217;m a program that has some important data files and I don&#8217;t want the user messing with them because my program will stop working if they get deleted or corrupted.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271783">
				<div id="div-comment-271783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joku</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271783">
			April 20, 2005 at 11:40 am</a>		</div>

		<p>I think even non-hidden files are well enough hidden when located in places like</p>
<p>C:Documents and SettingsUserLocal SettingsApplication DataMicrosoftInfoPathFormCache15A6420C5.AF6$7bbe17b22d2a6bc8_XDInfo_props.dat</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271793">
				<div id="div-comment-271793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vince</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271793">
			April 20, 2005 at 11:55 am</a>		</div>

		<blockquote><p>
  oldnewthing: It wasn&#8217;t &quot;Hi, I&#8217;m making a rootkit and I want to hide stuff&quot;. It&#8217;s &quot;Hi, I&#8217;m a program that has some important data files and I don&#8217;t want the user messing with them because my program will stop working if they get deleted or corrupted.&quot;</p>
<p>Wait.. so you have users that are smart enough to turn on viewing hidden system files, but too stupid to realize if they delete random files int he program directory the program might stop working?</p>
<p>In that case, why not just completely disable the file-browser?  I mean if you can&#8217;t trust the users, force them to only use the start menu or something.</p>
<p>If you do add some sort of level-7 of file hiding, companies will just start abusing it, like sticking 500MB marketing AVI&#8217;s on your hard-drive and knowing that you won&#8217;t be able to find what&#8217;s taking up all the room.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271823">
				<div id="div-comment-271823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin Olbrantz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271823">
			April 20, 2005 at 1:13 pm</a>		</div>

		<p>Funny you should mention that, memet. A while ago Nero blew up while creating an image on my computer. Now I&#8217;m stuck with this &quot;LOM_SE.&quot; file that Explorer and the command prompt have no clue how to delete (they always say that the file doesn&#8217;t exist). My best guess is that there&#8217;s a null or some other invalid character in the extension, that neither of them even know how to display.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271853">
				<div id="div-comment-271853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Pritchard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271853">
			April 20, 2005 at 4:35 pm</a>		</div>

		<p>I&#8217;ve recently seen some spyware perform a REALLY vicious trick. The program in question creates a file with an invalid filename in the file table (I&#8217;m not sure exactly how this is turn, but it&#8217;s undoubtedly low-level voodoo). The trick is to give the file the same name as a real file (in this case, mshta.exe in the system32 directory) except for a wildcard (&quot;?&quot;) placed just before the extension. </p>
<p>The effect of this seems to be to make the file invisible in Explorer, (perhaps because the wildcard is &quot;filtered out&quot;, and duplicate file names are not shown either, so the original file thus hides the intruder).</p>
<p>The only way to see the file is to do a &quot;dir&quot; with the a switch and place a wildcard &quot;?&quot; in the correct position. But of course you have to suspect that the file exists, otherwise you have no chance of finding it. </p>
<p>Has anybody else come across this? Can anyone shed any light on exactly why the spyware file doesn&#8217;t show up in Explorer? I&#8217;ve had to clean this infection off a couple of computers and it makes me wonder how many more &quot;ultra-hidden&quot; files there are lurking around out there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271813">
				<div id="div-comment-271813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">memet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271813">
			April 20, 2005 at 12:41 pm</a>		</div>

		<p>You know, there&#8217;s a way to actually hide files from the Win32 subsystem, and that&#8217;s by naming files with null embedded unicode names via the Native API.<br />
<br /> Now, when I first read of this, I thought it was a very &#8216;evil&#8217; trick that could be done out of malicious intent. But recently, I realized that it&#8217;s not at all that difficult. For some reason, the java runtime writes files with Unicode names via something other than the Win32 API. Why do I say this? because recently, I downloaded something via Azureus (a java based bit torrent client).<br />
<br /> One of the files that came with the download is this obnoxiously long named file. You can view it in explorer, but you can&#8217;t select, edit or delete it. This sounded exactly like a Unicode filename issue to me, since explorer displays the NULL terminated string returned by the Find Files API. But when it tries to open that NULL terminated file name, it doesn&#8217;t exist.<br />
<br /> I had to spend quite a few hours writing a native application to open the file and friggin rename it&#8230;</p>
<p> Anyways, as much of a headache as it was to me, I still don&#8217;t mind that there is this loophole in the system. But it *is* a loophole.</p>
<p>(ps. why don&#8217;t I mind? you might ask. Because &quot;if a bad guy gets you to run his code on your computer, it&#8217;s not your computer anymore&quot;. The loophole is not the reason why&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-271893">
				<div id="div-comment-271893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Justin Olbrantz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271893">
			April 20, 2005 at 9:17 pm</a>		</div>

		<p>Aha. That worked. Can&#8217;t imagine why I never thought to try that in the couple of years that file&#8217;s been there. Thx.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-271883">
				<div id="div-comment-271883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-271883">
			April 20, 2005 at 9:08 pm</a>		</div>

		<p>Justin:</p>
<p>How did you try to delete the file on the command line?  I&#8217;ve had this problem with some files before, and I&#8217;ve always been able to do it with wildcards.  If it&#8217;s the only file in the directory, did you try &quot;del *.*&quot;?</p>
<p>If there are other files in the directory, you can try wildcards like:</p>
<p>&quot;del LOM*&quot; or &quot;del LOM?SE?*&quot; or whatever.  If those don&#8217;t work, you have a more difficult problem than I&#8217;ve experienced before.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-272083">
				<div id="div-comment-272083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ripster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-272083">
			April 21, 2005 at 10:13 am</a>		</div>

		<p>Looks like there will be a sixth level after all:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.technet.com/windowsserver/archive/2005/04/20/404005.aspx" rel="nofollow">http://blogs.technet.com/windowsserver/archive/2005/04/20/404005.aspx</a></p>
<p><a rel="nofollow" target="_new" href="http://spaces.msn.com/members/wardralston/PersonalSpace.aspx?_c01_photoalbum=showdefault&amp;_c02_owner=1&amp;_c=photoalbum" rel="nofollow">http://spaces.msn.com/members/wardralston/PersonalSpace.aspx?_c01_photoalbum=showdefault&#038;_c02_owner=1&#038;_c=photoalbum</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-272753">
				<div id="div-comment-272753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael J.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050419-50/?p=35853#comment-272753">
			April 25, 2005 at 11:34 am</a>		</div>

		<p>[quote]<br />
<br />A while ago Nero blew up while creating an image on my computer. Now I&#8217;m stuck with this &quot;LOM_SE.&quot; file that Explorer and the command prompt have no clue how to delete (they always say that the file doesn&#8217;t exist).<br />
<br />[/quote]</p>
<p>It was so much easier in DOS times with Norton Disk Edit&#8230;</p>
<p>While we on Explorer, I would love to read about those HT files, which allow to configure L&amp;F for each directory.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

