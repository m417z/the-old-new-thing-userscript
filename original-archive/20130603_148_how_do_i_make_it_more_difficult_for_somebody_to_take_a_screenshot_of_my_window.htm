<html>
<head>
<title>How do I make it more difficult for somebody to take a screenshot of my window?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I make it more difficult for somebody to take a screenshot of my window?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 3, 2013 / year-entry #149</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>39</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Ultimately, you can't stop somebody from ignoring the words Confidential at the top of a document and whipping out a digital camera and taking a picture of the screen. But at least starting in Windows 7 you can make it a little more difficult. Take our scratch program and add this one line: ... SetWindowDisplayAffinity(hwnd, WDA_MONITOR);...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
Ultimately,
you can't stop somebody from ignoring the words
<i>Confidential</i> at the top of a document and
<a HREF="http://technet.microsoft.com/en-us/magazine/hh241037.aspx">
whipping out a digital camera
and taking a picture of the screen</a>.
But at least
starting in Windows&nbsp;7
you can make it a little more difficult.
</p>
<p>
Take our
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2003/07/23/54576.aspx">
scratch program</a>
and add this one line:
</p>
<pre>
    ...
    <font COLOR=blue>SetWindowDisplayAffinity(hwnd, WDA_MONITOR);</font>
    ShowWindow(hwnd, nShowCmd);
    ...
</pre>
<p>
Assuming you have the Desktop Window Manager enabled,
you will find that
attempting to capture our scratch program in a screenshot
or via the Snipping Tool
will result in black pixels.
</p>
<p>
Remember, this is just an obstacle, not a security measure.
If somebody is determined to get the pixels,
this step is only going to slow them down a little.
(For example,
on Windows&nbsp;7, they can simply disable the Desktop Window Manager.)
But it's handy for reducing the likelihood of an accidental
breach of confidential information.
</p>
<p>
<b>Pre-emptive hate</b>:
"DRM is evil!"
My response to you: If you don't like DRM,
then don't buy DRM-protected content.
If you don't like IRM,
then don't read IRM-protected documents.
If you don't like Blu-Ray,
then don't buy Blu-Ray DVDs.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (39)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1059333">
				<div id="div-comment-1059333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059333">
			June 3, 2013 at 7:05 am</a>		</div>

		<p>DRM is not evil, it is merely a silly waste of resources.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059343">
				<div id="div-comment-1059343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059343">
			June 3, 2013 at 7:07 am</a>		</div>

		<p>Run this code, get uninstalled for failing accessibility. ADA is not optional.</p>
<div class="post">[<em>Try it. Accessibility still works. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059363">
				<div id="div-comment-1059363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059363">
			June 3, 2013 at 7:18 am</a>		</div>

		<p>@Joshua: &nbsp;Does ADA demand the ability to take screen shots with DWM enabled?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059373">
				<div id="div-comment-1059373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059373">
			June 3, 2013 at 7:23 am</a>		</div>

		<p>And if you don&#39;t like drugs, don&#39;t buy drugs! If you don&#39;t like poverty, don&#39;t become poor!.. The whole point of disliking something is that you try to make this &quot;something&quot; disappear from reality.</p>
<p>Anyway, thanks for revealing the trick: now I will turn DWM off before trying to screenshot that one arrogant program.</p>
<div class="post">[<em>I was afraid this was going to happen. That&#39;s why I added the pre-empting hate, but it didn&#39;t work. I may have to shut off comments on this article if people keep debating DRM here. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059383">
				<div id="div-comment-1059383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059383">
			June 3, 2013 at 7:26 am</a>		</div>

		<p>@SimonRev: Advanced third-party magnifiers do. Starting in Windows 8, cannot just turn off DWM to break this code. Can&#39;t just use DWM magnify either. Might have to OCR and re-render text in a highly readable font.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matteo odd alt thread-odd thread-alt depth-1" id="comment-1059393">
				<div id="div-comment-1059393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059393">
			June 3, 2013 at 7:33 am</a>		</div>

		<p>[ DRM is not evil, it is merely a silly waste of resources. ]</p>
<p>Especially since it&#39;s optimizing for the wrong case. The &quot;normal&quot;, non-tech-savvy user doesn&#39;t try to rip Blu-Rays on his/her machine, he just opens the favorite P2P application/Torrent search engine and finds the work already done by people who know how to work around the obstacles.</p>
<p>Many anti-piracy initiatives seem to have this same problem; my favorite is the hideous &quot;Piracy is a crime&quot; mandatory, non-skippable ad (<a href="http://www.youtube.com/watch?v=HmZm8vNHBSU" rel="nofollow" target="_new">http://www.youtube.com/watch</a>), which annoys just the people who actually bought the official DVD (I&#39;ve never seen a DVD rip that includes annoying ads). The point is similar to the one made by Jeff Atwood here (<a href="http://www.codinghorror.com/blog/2008/04/the-problem-with-software-registration.html" rel="nofollow" target="_new">http://www.codinghorror.com/&#8230;/the-problem-with-software-registration.html</a>) about software registration &#8211; you are doing a disservice only to people who are actually willing to pay you.</p>
<div class="post">[<em>The primary audience here is probably not DRM but rather IRM. There is no torrent for &quot;The confidential email sent from the CEO.&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059423">
				<div id="div-comment-1059423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059423">
			June 3, 2013 at 8:31 am</a>		</div>

		<p>I feel like I have to bear the burden of pointing out there&#39;s no such thing as a &quot;Blu-Ray DVD&quot;&#8230; DVD and Blu-Ray Disc are two completely separate technologies, and that makes about as much sense as saying &quot;DVD CD&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059433">
				<div id="div-comment-1059433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059433">
			June 3, 2013 at 9:50 am</a>		</div>

		<p>Great, now &quot;accessibility&quot; is another thing Raymond will have to point out his sample programs don&#39;t support, along with error handling.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059443">
				<div id="div-comment-1059443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059443">
			June 3, 2013 at 10:42 am</a>		</div>

		<p>[Try it. Accessibility still works. -Raymond]</p>
<p>I refer the honourable gentleman the answer I already gave to SimonRev. If my eyes decay any farther I&#39;ll be looking at taking such an option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059453">
				<div id="div-comment-1059453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random832</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059453">
			June 3, 2013 at 12:15 pm</a>		</div>

		<p>&gt; Might have to OCR and re-render text in a highly readable font.</p>
<p>I thought programs were supposed to support system settings for large fonts (and high contrast) to be considered accessible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059463">
				<div id="div-comment-1059463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timothy Fries</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059463">
			June 3, 2013 at 12:18 pm</a>		</div>

		<p>MSDN doesn&#39;t document if the hWnd has to be owned by the current process/thread or not, though I&#39;d imagine it to be so (I&#39;m not in front of Windows 7 at the moment to test) otherwise someone could just enumerate over all top level windows and set their display affinity to WDA_NONE before taking a screenshot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059473">
				<div id="div-comment-1059473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Muller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059473">
			June 3, 2013 at 12:26 pm</a>		</div>

		<p>Arn&#39;t there discs that are Bluray on one side, DVD on the other?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059483">
				<div id="div-comment-1059483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059483">
			June 3, 2013 at 12:29 pm</a>		</div>

		<p>@Random832: And one other thing. Respect all font rendering selections made by the ClearType tuner, including both grey-scale and off (bi-level rendering) (clear type + high mag = misaligned). Windows 8 doesn&#39;t.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059513">
				<div id="div-comment-1059513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059513">
			June 3, 2013 at 12:53 pm</a>		</div>

		<p>So I tried it. &nbsp;As expected, when I take a screenshot my window&#39;s client area is now blacked out.</p>
<p>Then I ran Windows Magnifier. &nbsp;And my window&#39;s client area is blacked out in Magnifier.</p>
<p>Windows Magnifier is advertised as an accessibility tool even if it doesn&#39;t rely on technologies a developer would think of as &quot;accessibility&quot;. &nbsp;And this feature stops it working.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059523">
				<div id="div-comment-1059523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059523">
			June 3, 2013 at 1:37 pm</a>		</div>

		<p>Raymond, do you honestly think that childish reactions will do anything constructive? Furthermore, so far the comments don&#39;t contain a &lsquo;hate flamefest&rsquo;, just reasonable critique.</p>
<p>Maybe the reason that you the comments you get is that you read but don&#39;t adequately listen. If you internalise the comments and take them into proper account the next time you write an article, the reactions would be a lot more constructive and then the comments will move on also.</p>
<p>But your &lsquo;pre-emptive hate&rsquo; only shows that you didn&#39;t listen and hence things have to be said again. And if you go on like this, and do senseless things like removing comments, you&#39;ll get the exact same thing any time you write a tangentially related article.</p>
<p>And rightly so, because the commenters aren&#39;t the problem. You are out of step with reality and that&#39;s the problem. Fix yourself and the problem will disappear.</p>
<div class="post">[<em>I should&#39;ve just said, &quot;Let&#39;s not discuss whether DRM is a good idea or not, because (1) we&#39;ve been through it already, and (2) it&#39;s not not something that can be resolved here. It&#39;s not like I have the power to change it. Complaining to me accomplishes nothing.&quot; This was a test to see <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/08/04/10045651.aspx">if it was possible to mention an IRM-related feature without people complaining that the feature exists at all</a>. The answer is apparently &quot;No&quot;. Result: Back onto the topic embargo list it goes. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059533">
				<div id="div-comment-1059533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059533">
			June 3, 2013 at 1:48 pm</a>		</div>

		<p>Holy fatcats. I didn&#39;t make a comment about DRM, now did I? What I said was two things:</p>
<p>a) The argument from &quot;Pre-emptive hate&quot; is just a re-phrasing of &quot;If you don&#39;t like something, turn away from it&quot;, which is quite a silly argument; and</p>
<p>b) I have one pesky program which refuses to export data from it, so now I have one more way to try and make it cooperate (though it didn&#39;t work, sadly).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059543">
				<div id="div-comment-1059543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059543">
			June 3, 2013 at 2:14 pm</a>		</div>

		<p>@Anonymous Coward: &nbsp;He just wants to focus on his salad.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059553">
				<div id="div-comment-1059553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059553">
			June 3, 2013 at 2:32 pm</a>		</div>

		<p>So this API can ensure that a window is only displayed on a monitor. That makes me wonder, what are the alternatives? Is an RDP session considered a monitor?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059563">
				<div id="div-comment-1059563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059563">
			June 3, 2013 at 3:18 pm</a>		</div>

		<p>I could see this being super useful when doing a screencast.</p>
<p>But if this is intended as a DRM thing I doubt a process can toggle this setting on arbitrary windows.</p>
<p>The only example of a limitation I read on MSDN though is that it has to be called on a top level window.. The Get version says it works with windows of any process.. Does that mean the Set version doesn&#39;t?</p>
<p>I would try it but I don&#39;t have a copy of Windows atm..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059583">
				<div id="div-comment-1059583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059583">
			June 3, 2013 at 3:39 pm</a>		</div>

		<p>@Gabe: Really good question. Read the docs. Oh wait, the MSDN docs don&#39;t say.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1059593">
				<div id="div-comment-1059593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059593">
			June 3, 2013 at 5:07 pm</a>		</div>

		<p>Suppose it only works from within the same process. That just means an attacker would have to inject a thread into that process. Since the attacker is probably an administrator of that machine, that&#39;s hard to prevent.</p>
<div class="post">[<em>The purpose of this feature is not to defend against an attacker who can run code on the system. It&#39;s to defend against users who take a screen shot without realizing that the confidential budget data is visible in the background. See the linked article. -Raymond]</em></div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059603">
				<div id="div-comment-1059603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059603">
			June 3, 2013 at 6:33 pm</a>		</div>

		<p>We shouldn&#39;t have to wait until the end of the day and another embargo list before sanity. Maybe Raymond should delete most comments matching DRM from this article.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059623">
				<div id="div-comment-1059623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matteo Italia</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059623">
			June 3, 2013 at 6:54 pm</a>		</div>

		<p>[The primary audience here is probably not DRM but rather IRM. There is no torrent for &quot;The confidential email sent from the CEO.&quot; -Raymond]</p>
<p>Of course, sorry, I was digressing.</p>
<p>Actually, this function could have a widespread usage for the pÌ¶oÌ¶rÌ¶nÌ¶ privacy mode of the browsers, especially if it was applicable to their taskbar button &#8211; for one thing, it would avoid problems like this <a rel="nofollow" target="_new" href="http://thedailywtf.com/Articles/Whoops!.aspx">thedailywtf.com/&#8230;/Whoops!.aspx</a> :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059503">
				<div id="div-comment-1059503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059503">
			June 3, 2013 at 12:47 pm</a>		</div>

		<p>Raymond, if you actually read Joker&#39;s comment, you&#39;ll note it&#39;s in response to your &lsquo;pre-emptive hate&rsquo;. So your comment is like complaining that nuking Moscow to prevent Russia from nuking us didn&#39;t have the intended effect.</p>
<p>Anyway, I&#39;m more aligned with Raphael&#39;s view, but supposing for a moment that DRM could actually work, the companies that want DRM pretty much have a monopoly so your &lsquo;then don&#39;t buy DRM&#39;ed goods&rsquo; quip doesn&#39;t make any sense.</p>
<p>As it stands however, DRM doesn&#39;t work and that&#39;s the only reason that there are good alternatives do DRM&#39;ed content. But that does mean that saying &lsquo;If you don&#39;t like DRM, then don&#39;t buy DRM-protected content.&rsquo; is essentially the same as saying &lsquo;If you don&#39;t like DRM, then go to the Pirate Bay.&rsquo; and I doubt that was your intention.</p>
<p>In any case, given the subject of your article, DRM related comments are entire on-topic and censoring them would be *extremely* childish. If someone tells you something you don&#39;t want to know, but that is true, do you plug your ears and sing &lsquo;La la I can&#39;t hear you&rsquo; on the top of your voice? I posit no sensible adult would act in such a manner.</p>
<div class="post">[<em>I wrote the pre-emptive hate so people would stop rehashing the hate flamefest that happens every time I mention DRM, even in passing. It didn&#39;t work. I&#39;m going to be childish. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059633">
				<div id="div-comment-1059633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059633">
			June 3, 2013 at 10:14 pm</a>		</div>

		<p>Interesting article, Raymond. I&#39;ll have to keep this in mind if we even make a non-browser based interface for the system I work on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059653">
				<div id="div-comment-1059653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059653">
			June 4, 2013 at 12:48 am</a>		</div>

		<p>To everybody that says DRM doesn&#39;t work &#8211; that&#39;s wrong. DRM works just fine, it just doesn&#39;t do what most people think it does (prevent unauthorized copying). It&#39;s purpose is to prevent manufacturers from adding unapproved functionality to their devices and programs (anything that isn&#39;t explicitly allowed is forbidden, since you can&#39;t get the keys without signing a contract that tells you exactly what you can do).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059663">
				<div id="div-comment-1059663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny Moules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059663">
			June 4, 2013 at 1:18 am</a>		</div>

		<p>From the SetWindowDisplayAffinity MSDN page:</p>
<p>&quot;It is important to note that unlike a security feature or an implementation of Digital Rights Management (DRM), there is no guarantee that using SetWindowDisplayAffinity and GetWindowDisplayAffinity, and other necessary functions such as DwmIsCompositionEnabled, will strictly protect windowed content, for example where someone takes a photograph of the screen.&quot;</p>
<p>I&#39;d be impressed to see any &quot;security feature or an implementation of Digital Rights Management (DRM)&quot; that can leap out of the screen and disable my camera. Think they need a better example.</p>
<p>(NB. I didn&#39;t see the DRM conversation before drafting this. Hey-ho. Blame MSDN!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059673">
				<div id="div-comment-1059673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059673">
			June 4, 2013 at 2:28 am</a>		</div>

		<p>There are a lot of workplaces where phones/cameras are banned. So you&#39;re premise is not unreasonable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059753">
				<div id="div-comment-1059753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059753">
			June 4, 2013 at 8:39 am</a>		</div>

		<p>people do stupid things and they dont think about or care about data security. imagine that sales guy who decides to send an email to his personal account with that not yet published internal quartaly report so that he doesn&#39;t need to take the extra 2 seconds to log into the VPN. You all know that guy i&#39;m talking about. with IRM he&#39;ll get an error message and probably proceed to not read it and ask the helpdesk what the heck is wrong with there computers? The helpdesk can then respond that he shouldn&#39;t be emailing the report. mabye his manager gets involved and hopefully tells him the same thing. crisis adverted. thats the use case from IRM not protected it from someone who really wants to get at it. although people especially management will often think its to proect against &quot;hackers&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059833">
				<div id="div-comment-1059833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059833">
			June 4, 2013 at 1:48 pm</a>		</div>

		<p>@Raymond: &quot;It&#39;s to defend against users who take a screen shot without realizing that the confidential budget data is visible in the background. See the linked article.&quot;</p>
<p>No, that&#39;s not true. This is only the first step of many DRM features which will be harder and harder to circumvent for each Windows version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059843">
				<div id="div-comment-1059843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059843">
			June 4, 2013 at 1:56 pm</a>		</div>

		<p>@Miff: &quot;there&#39;s no such thing as a Blu-Ray DVD&quot;&#8230;</p>
<p>He probably meant HD DVD, xbox2&#39;s epic fail no one remembers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059883">
				<div id="div-comment-1059883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ray</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059883">
			June 4, 2013 at 5:21 pm</a>		</div>

		<p>What about in a VM? If I run the app in a VM and then switch back to the host, can I screenshot that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059923">
				<div id="div-comment-1059923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059923">
			June 4, 2013 at 8:10 pm</a>		</div>

		<p>@Ray: Missing the point bro. The feature is designed to stop unwanted information being leaked by users taking screenshots of programs but not realizing a confidential program is lingering in the background.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059933">
				<div id="div-comment-1059933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059933">
			June 5, 2013 at 4:19 am</a>		</div>

		<p>This function would be useful (as part of required defense in depth) for an application like SnapChat (along with functions like SecureZeroMemory).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1059963">
				<div id="div-comment-1059963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dark Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059963">
			June 5, 2013 at 6:12 am</a>		</div>

		<p>Would this also apply to Onenote&#39;s ability to take a screenshot? It seems to work a little differently then the normal &#39;Print Screen&#39;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059973">
				<div id="div-comment-1059973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">:-(</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059973">
			June 5, 2013 at 7:16 am</a>		</div>

		<p>Running this app on Windows 7, and attempting to call SetWindowDisplayAffinity on a top-level hwnd of another process results in error code 5. Even if run from a requireadministrator application belonging to the same user running the other app.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1060003">
				<div id="div-comment-1060003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1060003">
			June 5, 2013 at 8:26 am</a>		</div>

		<p>&quot;He probably meant HD DVD, xbox2&#39;s epic fail no one remembers.&quot;</p>
<p>What are you talking about? &nbsp;HD-DVD was &lt;i&gt;winning&lt;i/&gt; the format war until Sony spent about $3B bribing the major studios to switch to Blu-Ray.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059943">
				<div id="div-comment-1059943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1059943">
			June 5, 2013 at 4:35 am</a>		</div>

		<p>&gt;It&#39;s to defend against users who take a screen shot without realizing that the </p>
<p>&gt;confidential budget data is visible in the background. See the linked article.</p>
<p>What would be more useful in this case is a SelectiveSetWindowDisplayAffinity() that allowed you to, for example, take a snapshot of your browser screen without also capturing all your *** sites open in the tab bar at the top.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1060233">
				<div id="div-comment-1060233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny Moules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130603-00/?p=4193#comment-1060233">
			June 7, 2013 at 1:12 am</a>		</div>

		<p>&gt; There are a lot of workplaces where phones/cameras are banned. So you&#39;re premise is not unreasonable.</p>
<p>If you completely ignore the idea of context, that&#39;s fair comment. Can we not do that?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

