<html>
<head>
<title>Defrauding the WHQL driver certification process</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Defrauding the WHQL driver certification process</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 5, 2004 / year-entry #85</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>81</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">In a comment to one of my earlier entries, someone mentioned a driver that bluescreened under normal conditions, but once you enabled the Driver Verifier (to try to catch the driver doing whatever bad thing it was doing), the problem went away. Another commenter bemoaned that WHQL certification didn't seem to improve the quality of...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p><a href="http://blogs.msdn.com/oldnewthing/archive/2004/02/11/71307.aspx#71354">In  a comment to one of my earlier entries</a>,  someone mentioned a driver that bluescreened under normal  conditions, but once you enabled the Driver Verifier  (to try to catch the driver doing whatever bad thing it was doing),  the problem went away.  <a href="http://blogs.msdn.com/oldnewthing/archive/2004/02/11/71307.aspx#71572">  Another commenter bemoaned that WHQL certification didn't  seem to improve the quality of the drivers</a>.</p>
<p>  Video drivers will do anything to outdo their competition. Everybody knows that   <a href="http://www.tech-report.com/etc/2003q2/3dmurk03/">  they cheat benchmarks</a>, for example.  I remember one driver that ran the DirectX "3D Tunnel" demonstration program  extremely fast, demonstrating how totally awesome their video card is.  Except that if you renamed TUNNEL.EXE to FUNNEL.EXE, it ran slow again.  </p>
<p>  There was another one that checked if you were printing a specific  string used by a popular benchmark program.  If so, then it only drew the string a quarter of the time and merely  returned without doing anything the other three quarters of the time.  Bingo! Their benchmark numbers just quadrupled.  </p>
<p>  Anyway, similar shenanigans are not unheard of when submitting a  driver to   <a href="http://www.microsoft.com/whdc/hwtest/default.mspx">  WHQL</a> for certification. Some unscrupulous drivers will  detect that they are being run by WHQL and disable various  features so they pass certification. Of course, they also run  dog slow in the WHQL lab, but that's okay, because WHQL is  interested in whether the driver contains any bugs, not  whether the driver has the fastest triangle fill rate in the industry.  </p>
<p>  The most common cheat I've seen is drivers which check  for a secret "Enable Dubious Optimizations" switch in the  registry or some other place external to the driver itself. They take  the driver and put it in an installer which does not turn the  switch on and submit it to WHQL.  When WHQL runs  the driver through all its tests, the driver is running in  "safe but slow" mode and passes certification with  flying colors.  </p>
<p>  The vendor then takes that driver (now with the WHQL stamp  of approval) and puts it inside an installer that enables the  secret "Enable Dubious Optimizations" switch.  Now the  driver sees the switch enabled and performs all sorts of  dubious optimizations, none of which were tested by WHQL.  </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (81)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-150733">
				<div id="div-comment-150733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry Osterman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150733">
			March 5, 2004 at 8:10 am</a>		</div>

		<p>Ferris, how do you test a negative?  The registry key ISN&#8217;T there.  How could the WHQL people possibly know that turning this magic registry flag on would cause the driver to misbehave?</p>
<p>The manufacturer sent Microsoft the driver.  We tested it.  And it passed.  So we signed the binary and gave it back to them.  Then they changed the external conditions and effectively change the driver binary without changing the code &#8211; they enabled new codepaths that Microsoft wasn&#8217;t able to test.</p>
<p>There&#8217;s not much that Microsoft could do in that situation.</p>
<p>And I disagree about the &quot;WHQL means jack all&quot; comment &#8211; WHQL actually means a lot &#8211; at a minimum, it means that the user doesn&#8217;t get the &quot;This driver wasn&#8217;t tested by Microsoft, if you install it, it&#8217;s gonna crash your system.&quot; dialog that comes up on non WHQL signed binaries.</p>
<p>That&#8217;s why nVidia goes through all the trouble to sign their drivers &#8211; it makes customers feel better.  </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150743">
				<div id="div-comment-150743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150743">
			March 5, 2004 at 8:21 am</a>		</div>

		<p>[&quot;Ferris Beuller&quot;s messages have been removed for spamming. You may see responses to &quot;his&quot; messages without context.  It&#8217;s too bad because some of the comments were worthwhile.]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150763">
				<div id="div-comment-150763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150763">
			March 5, 2004 at 8:36 am</a>		</div>

		<p>&quot;Ferris Beuller&quot; asks (via a deleted message):</p>
<p>&quot;Spamming, they where legitimate issues with WHQL, if you cannot put them into a single post, you are an asshat. Is it that hard to copy and paste into a single post.&quot;</p>
<p>My response to &quot;Ferris&quot;:</p>
<p>If it&#8217;s so easy to copy and paste into a single post, then go ahead and do it yourself.  I am not your editor.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150773">
				<div id="div-comment-150773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150773">
			March 5, 2004 at 8:38 am</a>		</div>

		<p>When I was at 3dfx, I remember Microsoft using other parts of a contracts to enforce WHQL compliance?  Such as wanting to without our OpenGL ICQ and such.  Aren&#8217;t there any kinds of damages or fraud protection to be put into WHQL agreements to stop this behavior?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150783">
				<div id="div-comment-150783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Bueller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150783">
			March 5, 2004 at 8:45 am</a>		</div>

		<p>1) So called WHQL Certified drivers are NOT always on WindowsUpdate and cannot always be installed via the MMC Device Manager snapin. We are forced to install via custom .EXE that stomps over our system (DirectX- lucky this fails on lesser version install attemps) or installs AOL type adware. Logitech, Creative Labs and Nvidia are prime candidates that do this and also why I blacklist these companies as they are not pure driver installs and always not installable via windows update or the MMC (Creative Labs are ignorant at this, speak to theyre dublin call center and see what I mean). </p>
<p>2) You can test registry keys via Sysinternals Regmon, it will show FAILED read attempts in the registry. </p>
<p>3) Full disclosure should be a prerequisite for WHQL certification if bug finding is the main reason for certification, you can then run static analyzers over this code. No source, no certification, if they want certification so bad they will do this. </p>
<p>4) Full retail installs should be part of the process, you test what they ship. Most people dont care or understand what a certified driver is, they run windows update. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150793">
				<div id="div-comment-150793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Thresher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150793">
			March 5, 2004 at 8:45 am</a>		</div>

		<p>Why not make the WHQL certification process stricter. If the driver accesses the registry or files the manufacturer could be asked to explain what the driver is looking for. This would involve more work on both Microsoft&#8217;s and the manufacturers part but wouldn&#8217;t the end result run more reliably?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150803">
				<div id="div-comment-150803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150803">
			March 5, 2004 at 8:45 am</a>		</div>

		<p>WTF are you doing, I just put them into a single fuckin post.</p>
<p>Talk about ignorance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150813">
				<div id="div-comment-150813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150813">
			March 5, 2004 at 8:46 am</a>		</div>

		<p>I&#8217;m not sure of the specifics because I don&#8217;t work on WHQL (although I did work in the DirectX team at one time), but I think we (MS) have to be quite careful, because we&#8217;re sensitive to the charge that we might be playing favorites in a way that could get us into legal trouble.</p>
<p>So, in general, it&#8217;s a lot safer (legally) for us if everything is wrapped up in a well-defined suite of tests that&#8217;s either pass/fail, with not much room for human judgement. That way we can say that the test specifications are the same for everyone, and we&#8217;re not playing favorites. Of course, it does open the door to hardware vendors finding ways to sneak around the spirit of the tests while still conforming to the letter.</p>
<p>I can almost guarantee that if we started using our judgement to attempt to yank the WHQL certification from drivers/setups that we &#8216;know&#8217; are bad even though they passed the tests, then we&#8217;d get all sorts of whining and possibly legal threats from IHVs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150833">
				<div id="div-comment-150833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150833">
			March 5, 2004 at 8:49 am</a>		</div>

		<p>&quot;Ferris&quot;: Your account was still blocked when you posted the &quot;consolidated&quot; message. I&#8217;ve unblocked your account, but if you act up again, I will reinstate the block (and retroactively delete all your previous comments).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150843">
				<div id="div-comment-150843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150843">
			March 5, 2004 at 8:50 am</a>		</div>

		<p>Ferris,</p>
<p>2) Then they&#8217;ll find some other sneaky way to look for the special flags. There might also be legitimate reasons to look for some missing registry keys. At the end of the day, if they really want to mislead the tests, they will.</p>
<p>3) Never going to fly. Hardware vendors have a lot of sensitive IP tied up in their drivers. I can&#8217;t imagine them being happy to give us complete source code.</p>
<p>4) That&#8217;s a nice idea, but then hardware vendors would complain that we were hurting their ability to change their shipping bundles, which typically come with control panel applets and all sorts of other goop apart from the driver itself. They do special bundles for OEMs all the time. We&#8217;d either be swamped with all the various configurations of installation bundles, or we&#8217;d have angry hardware vendors claiming that we were stifling their ability to distribute things the way they wanted to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150853">
				<div id="div-comment-150853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150853">
			March 5, 2004 at 8:55 am</a>		</div>

		<p>IP in the drivers, isnt that what patents are for, and copyright and NDAs?</p>
<p>Its not like theyre giving theyre source to the consumers.</p>
<p>Ok well I want to enforce a standard MMC and windows update install option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150863">
				<div id="div-comment-150863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150863">
			March 5, 2004 at 9:19 am</a>		</div>

		<p>Consider: Your company&#8217;s entire livelihood is based on this success of this driver. Are you going to give its complete source code to Microsoft for scrutiny?  Even if it&#8217;s patented and copyrighted and NDA&#8217;d up the wazoo?  (Note that you can&#8217;t NDA a patent. A patent is public information.)  Are you going to take the chance that the source code might get Half-Life 2&#8217;d or Windows 2000&#8217;d?</p>
<p>And even if vendors were were willing to do that, that doesn&#8217;t solve the problem. All they have to do is find a way to fake out the static analyzers. &quot;Oh, Microsoft looks for registry access? Fine, I&#8217;ll put my flag in a named global object instead. Oh Microsoft is now looking for named global objects? I&#8217;ll create a custom ioctl.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150883">
				<div id="div-comment-150883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150883">
			March 5, 2004 at 9:36 am</a>		</div>

		<p>performance isnt part of the WHQL but stability is, however if they are deliberately avoiding you testing those codepaths, then they&#8217;re WHQL certificate should be revoked.  Doesnt mean anything to the consumer anyway.</p>
<p>You can enforce install methods for drivers (MMC and windowsupdate, it MUST be on Windowsupdate and hence avaialble via the MMC snapin to even get considered for WHQL) yet you dont enforce this, we the user gets assreamed by the lack of MMC install support yet thats what its there for, whatever happened to this so called driver model.</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150893">
				<div id="div-comment-150893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150893">
			March 5, 2004 at 9:38 am</a>		</div>

		<p>Show me a company based on drivers and drivers alone, they sell hardware and licenses for the reference platforms.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150903">
				<div id="div-comment-150903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150903">
			March 5, 2004 at 9:41 am</a>		</div>

		<p>How do you automate &quot;deliberately avoiding you testing those codepaths&quot;?  And suppose you manually discover a secret switch and retroactively revoke their certification. Then they complain, &quot;Hey, Microsoft is picking on me! No fair!&quot;</p>
<p>You&#8217;re saying you&#8217;ve never said, &quot;No, don&#8217;t buy that video card, their drivers suck.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150913">
				<div id="div-comment-150913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150913">
			March 5, 2004 at 9:46 am</a>		</div>

		<p>I dont buy NV anymore because theyre performance sucks on the hardware. Theyre drivers are good or where until 50.xx series but still my decisions on hardware are hardware capabilities, I never see the drivers when I buy hardware for obvious reasons.</p>
<p>I do know I dont buy Creative Labs because of theyre install practices and theyre hardware is a bus hog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150933">
				<div id="div-comment-150933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.silentblue.net' rel='external nofollow' class='url'>quanta</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150933">
			March 5, 2004 at 10:19 am</a>		</div>

		<p>You must excuse the crowd &#8211; videocards are a particularily sensitive topic among hardware enthusiasts. I wasn&#8217;t too thrilled to learn about so-called &quot;optimizations&quot; that a certain IHV was carrying out last year, which is probably why I currently own a Radeon 9800 Pro (but I digress).</p>
<p>You just wait Raymond, once the folks at Rage3D, nVNews and Beyond3D find this blog post, you&#8217;ll have a full-scale party (or war) on your hands&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-150953">
				<div id="div-comment-150953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150953">
			March 5, 2004 at 10:33 am</a>		</div>

		<p>Again I have to cry foul on some of this WHQL stuff as Microsoft played dirty ball with 3dfx.</p>
<p>Like, let&#8217;s see, they pressured us for OpenGL ICD source code and make us write a 2D device driver for NT to certify Voodoo2.  Of course, 3dfx probably signed an idiotic contract.</p>
<p>Either way, Microsoft could easily take measures to stop this WHQL madness, but I&#8217;m pretty sure they clearly don&#8217;t care all that much about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-150963">
				<div id="div-comment-150963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Some Guy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-150963">
			March 5, 2004 at 10:33 am</a>		</div>

		<p>&gt;&gt;You just wait Raymond, once the folks at Rage3D, nVNews and Beyond3D find this blog post</p>
<p>Yeah, never let the facts get in the way of a good M$-bashing session. ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151003">
				<div id="div-comment-151003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151003">
			March 5, 2004 at 10:54 am</a>		</div>

		<p>I just want installable drivers nothing more nothing less, available via windowsupdate and installable via the MMC how hard is that? Isnt that why we have that MMC snapin and windwos update? At the very least make them submit the final WHQL driver to windowsupdate, they can package theyre shitty CD however they want, we can always bag the latest after an install or even do it as a company policy via MS SMS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151013">
				<div id="div-comment-151013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151013">
			March 5, 2004 at 10:56 am</a>		</div>

		<p>Jack,</p>
<p>I&#8217;m not sure what measures you think MS could &quot;easily take to stop this WHQL madness&quot;. Trust me, fixing driver quality is pretty high up the priority list around here, because when things go wrong users tend to blame Microsoft at least as often as the driver vendor. If it were easy to fix, we&#8217;d do it in a heartbeat.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151023">
				<div id="div-comment-151023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/jeffdav' rel='external nofollow' class='url'>jeffdav</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151023">
			March 5, 2004 at 11:07 am</a>		</div>

		<p>The solution here is not really to bash WHQL.  I think this thread fairly establishes that WHQL does all it can politically and legally, if not technically.  </p>
<p>There is a company that makes very popular video cards.  I hate this company.  I hate their inability to write drivers that do not crash.  I hate their incessent attempts to install things in my system tray.  I hate their consistent refusal to release updated drivers for older cards when new OS releases require them.  I hate their buggy apps they ship with the cards to allow you to use special features of the cards.</p>
<p>And I let them know every chance I get.  I refuse to buy their cards, and I send them an e-mail when I buy a competitors card, just to let them know. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151033">
				<div id="div-comment-151033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151033">
			March 5, 2004 at 11:09 am</a>		</div>

		<p>Ferris: Well perhaps that&#8217;s what you want, just because you want somebody to do something doesn&#8217;t mean that they have to do it. Maybe the driver writer wants to sell the new driver in a &quot;premium edition&quot; or something.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151053">
				<div id="div-comment-151053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151053">
			March 5, 2004 at 11:34 am</a>		</div>

		<p>Why bother having Windows update then for 3rd party WHQL drivers in the first place? Isnt that whats its there for, why not mandata that all as part of the WHQL certificate the driver is available on windows update, why the hell not?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151093">
				<div id="div-comment-151093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151093">
			March 5, 2004 at 12:07 pm</a>		</div>

		<p>Ferris,</p>
<p>Because then Microsoft would get all sorts of complaints about how we&#8217;re forcing people to go through our distribution channel. Bad Microsoft, abuse of power, blah blah blah.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151103">
				<div id="div-comment-151103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151103">
			March 5, 2004 at 12:22 pm</a>		</div>

		<p>Tony, you wouldn&#8217;t be forcing anybody to do anything. Companies are not required to get WHQL certification, their crappy drivers can be installed and used without it. If they don&#8217;t want to comply with the rules they will not be certified, how difficult is that?</p>
<p>By allowing companies cheat WHQL you (as in Microsoft) are making your own certifications worthless. Nobody cares about the certification if you willingly allow drivers that are not up to par to be certified.</p>
<p>And as far as I remember, using MSI is a requirement for Designed for Windows certification, why exactly can&#8217;t you make similar requirement for WHQL certification?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151113">
				<div id="div-comment-151113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151113">
			March 5, 2004 at 12:30 pm</a>		</div>

		<p>You can&#8217;t stop people from cheating. You can try to catch them, but they will just look for new ways of cheating that are harder to detect.</p>
<p>See Tony&#8217;s answer to question 4 for why IHVs want to be able to repackage their drivers. Now you might say, &quot;Well Microsoft should tell those IHVs to screw off.&quot;  And then you wonder why people hate Microsoft. &quot;Microsoft is all so selfish, you have to do things their way or they tell you screw off.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151123">
				<div id="div-comment-151123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151123">
			March 5, 2004 at 12:46 pm</a>		</div>

		<p>The difference between &quot;Designed for Windows&quot; and WHQL is that &quot;Designed for Windows&quot; is a marketing program that doesn&#8217;t really have much of a &#8216;stick&#8217; inside Windows itself. Whereas if you try to install a non-WHQL driver, Windows will pop up all sorts of dire warnings in an attempt to discourage you from doing that. So for hardware vendors, WHQL is somewhat less optional than &quot;Designed for Windows&quot;, and hence they have more cause for complaint if the terms become too onerous.</p>
<p>Whenever Microsoft tries to &#8216;dictate&#8217; to other companies how they can interact with Windows, even if it&#8217;s really for ultimate good of end users, there&#8217;s always a vocal group of people complaining about how we&#8217;re abusing our power, yadda, yadda, yadda. So we have to be sensitive to that, and strike a balance.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151133">
				<div id="div-comment-151133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eugene Lin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151133">
			March 5, 2004 at 12:53 pm</a>		</div>

		<p>Windows is at its heart a platform upon which partners build their products. Those products can be apps, drivers, hardware, services or a combination of these. When you ask why Microsoft can&#8217;t &quot;make&quot; vendors just submit installable drivers to Windows Update, consider how inconsistent this is with our app story. Do we tell Adobe that we don&#8217;t like some features in Photoshop, so we won&#8217;t logo their app until they remove them? Do we tell our users that we think WordPad is good enough, so they shouldn&#8217;t need anything other than &quot;inbox&quot; apps? Partners ship whatever they want. Their customers decide whether they like their products. As a platform, we can do more to enable OUR customers to identify third-party products better. We should definitely allow our customers to decide whether they want a product based on its source (e.g. &quot;I trust Symantec but not NVidia&quot;). And we need to make it easier to yank stuff they don&#8217;t like. But in the end we deal with those products in a black-box way.<br />
<br />In a way, expecting Microsoft to police every driver on the planet is akin to expecting your home&#8217;s construction company to prevent you from putting ugly furniture in it. Say Company X sold a couch that unfolded at night and drilled holes in your wall. Would you be crying out to the construction companies of America to test all furniture for this kind of behavior? Would you blame the builder of your house for letting such a couch exist? No. It would be cool if the house told you that the couch did it. It would be cool if the house could automatically eject any piece of furniture you put in it. It would be cool if the house could warn you if you&#8217;re ever putting in another piece of furniture from the same company. That&#8217;s what we&#8217;re working on building into Windows.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151143">
				<div id="div-comment-151143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151143">
			March 5, 2004 at 1:46 pm</a>		</div>

		<p>Windows is PROPRIETRY, not a standard (in the commitee sense) so they play by the rules or theyre on theyre own.</p>
<p>I want drivers easily installable (MMC Device manager snapin) and accessable (windows update).</p>
<p>I guess us the users mean jack all when it comes to drivers. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151153">
				<div id="div-comment-151153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151153">
			March 5, 2004 at 2:06 pm</a>		</div>

		<p>Sure, we could do that. And who knows, maybe we could annoy our business partners to the point that they stop supporting our platform.</p>
<p>And then, of course, the Slashdot crowd starts screaming about anti-trust.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151163">
				<div id="div-comment-151163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151163">
			March 5, 2004 at 2:19 pm</a>		</div>

		<p>Ok , screw Windows Update then, I already cant find a few drivers I use on it, so why bother. </p>
<p>I just ran windows update on a peice of hardware taht is very very common on systems.</p>
<p>Logitech Quickcam &#8211; very common web camera &#8211; FAILED no such driver on windows update.</p>
<p>WHY BOTHER with windows update?  Im sure I can find more popular drivers that are not there.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151173">
				<div id="div-comment-151173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151173">
			March 5, 2004 at 2:21 pm</a>		</div>

		<p>I guess every consumer KNOWS where to get all those drivers for computers. I guess they love spending time visiting umpteen websites fighting with theyre different layouts looking for the RIGHT MODEL of device drivers.</p>
<p>Isnt that the entire point of windows update? A one stop shop for updating your system.</p>
<p>I guess you are talking out yer arse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151183">
				<div id="div-comment-151183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151183">
			March 5, 2004 at 2:28 pm</a>		</div>

		<p>So go complain to Logitech and tell them &quot;Hey, give Microsoft a copy of your (WHQL-certified) driver so they can put it on Windows Update.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151193">
				<div id="div-comment-151193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151193">
			March 5, 2004 at 3:15 pm</a>		</div>

		<p>Thats my point numbnuts, make it part of the certification process.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151203">
				<div id="div-comment-151203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151203">
			March 5, 2004 at 3:20 pm</a>		</div>

		<p>Um, I believe Tony Cox already explained why it isn&#8217;t.  And please lay off the rude insults or I&#8217;m going to have to ban you again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151213">
				<div id="div-comment-151213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chen Raymond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151213">
			March 5, 2004 at 3:24 pm</a>		</div>

		<p>Ban, rofl, how :D IP? Its a socks proxy, name? Yeah I cant change that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151283">
				<div id="div-comment-151283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Shane King</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151283">
			March 5, 2004 at 6:00 pm</a>		</div>

		<p>Maybe the installer executable should be certified, along with the driver files? That would at least stop the old installer switcheroo trick.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151293">
				<div id="div-comment-151293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151293">
			March 5, 2004 at 6:04 pm</a>		</div>

		<p>Wouldn&#8217;t stop anybody for long. You can just wrap the installer inside a bigger installer (and have the bigger installer set the secret flag).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151303">
				<div id="div-comment-151303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Charles Pence</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151303">
			March 5, 2004 at 11:50 pm</a>		</div>

		<p>&gt; I guess every consumer KNOWS where to get all<br />
<br />&gt; those drivers for computers. I guess they love<br />
<br />&gt; spending time visiting umpteen websites<br />
<br />&gt; fighting with theyre different layouts looking<br />
<br />&gt; for the RIGHT MODEL of device drivers. </p>
<p>No, most consumers just pop in the CD that came in the box with the hardware, install the drivers, and NEVER THINK ABOUT THEM AGAIN.  EVER.  Because they have no reason to.  The drivers work, the hardware works.  It is gamers, enthusiasts, and technicians that are concerned with staying on the leading edge of drivers&#8211;and as such, we might have to work a little harder to do it.  So be it&#8211;it&#8217;s not MS&#8217;s job to cater to that fringe market.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151323">
				<div id="div-comment-151323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ifeanyi Echeruo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151323">
			March 6, 2004 at 12:18 am</a>		</div>

		<p>Hasnt anyone figured out Ferris is just going to disagree with whatever justification for the current balance between enforcing quality and allowing customization? It has to be his way or the high way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151333">
				<div id="div-comment-151333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lurker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151333">
			March 6, 2004 at 12:33 am</a>		</div>

		<p>Don&#8217;t feed the troll. I know I do feed it by saying that, but it has to be said once.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151343">
				<div id="div-comment-151343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151343">
			March 6, 2004 at 3:27 am</a>		</div>

		<p>At first yes, not always, when they no longer have that box and alot of people do not keep those boxes they are told to go to windows update.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151353">
				<div id="div-comment-151353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151353">
			March 6, 2004 at 3:29 am</a>		</div>

		<p>Since when is the corporate enterprise a fringe market?  Would you prefer to use SMS to roll out a driver to every machine in a domain easily or just run the MMC device manager remotely to install a driver or go to every machine with a CD and install it for oh lets say 100 machines?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151373">
				<div id="div-comment-151373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://glob.com.au' rel='external nofollow' class='url'>byron</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151373">
			March 6, 2004 at 7:54 am</a>		</div>

		<p>so why doesn&#8217;t the WHQL driver certification process certify the complete package, installer and all?</p>
<p>then if the developer repackage the binary it would lose its cerification.</p>
<p>if an end user decided at a later stage to enable the optimisations, via a bundled tool or registry hack, at least it&#8217;s an explict action.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151383">
				<div id="div-comment-151383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151383">
			March 6, 2004 at 8:18 am</a>		</div>

		<p>This would mean that a vendor couldn&#8217;t get a driver certified until they finished writing their entire CD, down to the README file.</p>
<p>And this still won&#8217;t stop somebody from just putting the certified installer inside another installer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151403">
				<div id="div-comment-151403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://typicus.com' rel='external nofollow' class='url'>dada@cam.org (Stephane Lajoie)</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151403">
			March 6, 2004 at 9:22 am</a>		</div>

		<p>Mr. Chen, I must say I&#8217;m very impressed with your patience toward the misspelled-movie-character guy. I don&#8217;t know how you do it.</p>
<p>I hope the situation doesn&#8217;t sour the blogging experience for you because I really enjoy your writing and insights. If it gets out of hand, I suggest you simply disable comments altogether. It would be a shame to loose all the interesting discussion your more mature readers provide though&#8230;</p>
<p>Misspelled-movie-character guy: I agree with you that it&#8217;s a lot nicer when drivers are made available from windowsupdate.com: easier to install, no buggy extraneous software, etc. And I would also be happy to see the WHQL certification program be a little tougher on such abuse as described above. Believe it or not, it is possible to make these points without being rude and repeatedly lambasting our host&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151423">
				<div id="div-comment-151423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://members.cox.net/menright1' rel='external nofollow' class='url'>ATZ Man</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151423">
			March 6, 2004 at 11:08 am</a>		</div>

		<p>Here&#8217;s the deal:<br />
<br />If the driver isn&#8217;t already on my harddrive before I install new hardware, then the out-of-box experience is already at 1 on a scale of 1 to 100.<br />
<br />If a video driver makes the desktop properties/settings dialog take a fraction of a second longer to load so it can put its Flash-powered custom tab in the dialog, divide the rating by 10.<br />
<br />If I can&#8217;t choose to install the driver from Add/Remove New Hardware, divide the rating by 10.<br />
<br />If a driver (or any other component) of any kind adds an item to &quot;systray&quot; and there is no way to remove it, divide the rating by 10.</p>
<p>The only reason for gaming benchmarks, elaborate custom installs, systray icons and custom tabs in standard dialogs is EGO. These things do not benefit me, the end user. Never.</p>
<p>&#8212; The guy who didn&#8217;t use BBS front ends if they required a &quot;modem setup string&quot; other than ATZ.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151433">
				<div id="div-comment-151433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151433">
			March 6, 2004 at 11:10 am</a>		</div>

		<p>Your comment about renaming FUNNEL.EXE to TUNNEL.EXE reminded me of an interesting story.</p>
<p>Way back in the Win 3.1 days, when PC Magazine was considered one the leaders in techical computer mags, there was a particular video benchmark we would run.  It would print alternating screens of polygons and text.  The text was the words &quot;PC Magazine&quot;.  (Remember, this was long before 3D acceleration).</p>
<p>A certain video card from a certain company (now out of VGA card business) scored way too well on this test.  So we did a &quot;strings&quot; on their VGA BIOS, and found the words &quot;PC Magazine&quot; in several places in their BIOS code.  Hrm&#8230; I wonder what THAT was doing there?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151453">
				<div id="div-comment-151453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ferris Beuller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151453">
			March 6, 2004 at 3:04 pm</a>		</div>

		<p>The vendor is free to package it full of turds in the CD box if they want but they MUST make it available on windowsupdate and installable via the MMC Device Manager snapin as an option.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151463">
				<div id="div-comment-151463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack Mathews</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151463">
			March 6, 2004 at 5:01 pm</a>		</div>

		<p>Tony and Raymond:</p>
<p>Yeah, you guys are right.  I keep forgetting the perspective we had at the hardware companies about Microsoft controlling everything, homogenizing everything, that sort.  I suppose it&#8217;s a really slippery path with legal and there&#8217;s two sides to everything.</p>
<p>Bleh. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151473">
				<div id="div-comment-151473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Day</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151473">
			March 6, 2004 at 5:05 pm</a>		</div>

		<p>So, the driver makers are deliberately deceiving consumers about the compatibility, technical capabilities or both of their hardware and software. Has Microsoft been contected by the FTC to assist in their investigation of the fraud yet?</p>
<p>How bad is the hit from moving the video drivers out of the more trusted security rings so the failures they are causing are not as damaging? Would it actually help?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151523">
				<div id="div-comment-151523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Charles Pence</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151523">
			March 7, 2004 at 10:05 am</a>		</div>

		<p>James:  I dunno.  If the software that controls what displays on your screen crashes, regardless of what ring it&#8217;s running in it&#8217;s probably not good for your machine. =)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151563">
				<div id="div-comment-151563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas Hber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151563">
			March 7, 2004 at 3:14 pm</a>		</div>

		<p>James Day:<br />
<br />The part of the Win32 subsystem dealing with graphics (GDI) was a quite ordinary user-process in the first versions of Windows XP (NT 3.5 and NT3.51). However it was moved to the kernel-side for NT4.0.</p>
<p>You can read about why they did this here: <a target="_new" href="http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/dnarwbgen/html/msdn_movuser.asp" rel="nofollow">http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/dnarwbgen/html/msdn_movuser.asp</a></p>
<p>Maybe it would be better for Windows Server to have the GDI still as a user-level process?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151573">
				<div id="div-comment-151573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151573">
			March 7, 2004 at 3:22 pm</a>		</div>

		<p>Note that it was GDI, not the display driver, that ran in user-mode on NT 3.5. I.e., the component that worries about things like HBRUSHes and DIBs. The display driver still ran in kernel mode (since it needs privileged access to hardware resources).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151583">
				<div id="div-comment-151583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Maas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151583">
			March 7, 2004 at 3:56 pm</a>		</div>

		<p>You can&#8217;t do (accelerated) graphics at user-level these days because modern graphics cards have complex DMA engines (just like network cards and SCSI cards). There needs to be a kernel driver to handle the memory mapping and transfer of data. If there is a bug in that component, it will probably bring down the entire machine, so there isn&#8217;t much point in splitting out work to user space.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151593">
				<div id="div-comment-151593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151593">
			March 7, 2004 at 4:09 pm</a>		</div>

		<p>I am worry. What is MS doing to ensure this kind of deception doesn&#8217;t occur in Longhorn? From what I read, Longhorn will tie itself more directly to these video drivers. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151603">
				<div id="div-comment-151603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151603">
			March 7, 2004 at 10:50 pm</a>		</div>

		<p>Raymond Chen wrote:<br />
<br />&quot;The display driver still ran in kernel mode (since it needs privileged access to hardware resources). &quot;</p>
<p>To me, it seems like the display driver was split in two parts, one in each mode. See this figure: <a target="_new" href="http://msdn.microsoft.com/archive/en-us/dnarwbgen/html/movuser02.gif" rel="nofollow">http://msdn.microsoft.com/archive/en-us/dnarwbgen/html/movuser02.gif</a></p>
<p>&#8212;<br />
<br />With regards to drivers &amp; &quot;Longhorn&quot; you can find lot&#8217;s of information in the WinHEC2003 slides (<a target="_new" href="http://www.microsoft.com/whdc/winhec/pres03.mspx" rel="nofollow">http://www.microsoft.com/whdc/winhec/pres03.mspx</a>). And I assume WinHEC2004 will bring even more information.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151613">
				<div id="div-comment-151613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://wilhelm.svenselius@fragzone.se' rel='external nofollow' class='url'>Wilhelm Svenselius</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151613">
			March 7, 2004 at 11:42 pm</a>		</div>

		<p>Why not just split the WHQL process in two? </p>
<p>1) Test the driver as usual (let&#8217;s assume the driver passes).</p>
<p>2) When driver is released to end users, download it from manufacturer&#8217;s website as a normal consumer would. Then test it again. If it fails, WHQL certification is retroactively revoked (and there should be a website loudly proclaiming this, and that the manufacturer is releasing dodgy drivers).</p>
<p>Now, if a small-time hardware site did 2), especially the loudly proclaiming bit, they would be feeling the pressure from nVidia lawyers post haste. But Microsoft? Ner&#8230; nVidia can&#8217;t afford that risk, not with ATi eating their lunch with the Radeon 9&#215;00 series.</p>
<p>Note: Not saying nVidia are (the only ones) cheating. Just using them as an example because they&#8217;re big and well-known.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151623">
				<div id="div-comment-151623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.bigbeardy.co.uk' rel='external nofollow' class='url'>Mat Hall</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151623">
			March 8, 2004 at 1:41 am</a>		</div>

		<p>I&#8217;m not sure that the WHQL certification is much use anyway &#8212; drivers for Creative Labs products have been flaky for as long as I can remember, yet they&#8217;re now all certified.  It doesn&#8217;t stop them crashing at random, but I suppose at least when I install them I don&#8217;t have to click on &quot;Continue anyway&quot; a bunch of times&#8230;</p>
<p>Although Ferris is a bit of a troll, the point about forcing drivers to install via the MMC is a pretty good one; I&#8217;ve lost count of the number of things I&#8217;ve attached to my PC that include the line &quot;When the add new hardware wizard prompts you to locate the drivers, click Cancel&quot; in the install instructions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151633">
				<div id="div-comment-151633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151633">
			March 8, 2004 at 3:52 am</a>		</div>

		<p>&gt; Are you going to take the chance that the source code might get Half-Life 2&#8217;d or Windows 2000&#8217;d?</p>
<p>Surely you aren&#8217;t saying that MS is more likely to &quot;lose&quot; the source than the original company, Raymond? I must say though that the idea of MS agreeing that making access to the source mandatory to make sure that there is no code doing things it shouldn&#8217;t would make the /. crowd wet themselves with laughter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151643">
				<div id="div-comment-151643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">keithmo [exmsft]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151643">
			March 8, 2004 at 5:19 am</a>		</div>

		<p>Frankly, it really doesn&#8217;t matter if GDI/USER and the associated drivers live in user- or kernel-mode. If these critical subsystems die, the OS is toast. They are as critical to a running Windows system as CSRSS.EXE &#8212; &quot;just&quot; a user-mode process, but kill it and your system is kaput.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151713">
				<div id="div-comment-151713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151713">
			March 8, 2004 at 7:54 am</a>		</div>

		<p>What does it matter for a database-server if GDI is there or not?</p>
<p>In _theory_ you should be able to create, for example an e-mail service, running in Interix or OS/2 subsystem, and it should not make a difference for it if CSRSS.EXE is alive or not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151733">
				<div id="div-comment-151733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151733">
			March 8, 2004 at 8:07 am</a>		</div>

		<p>And that would help a few hundred out of the 300 millions Windows-based machines out there. And even then, only until you wanted to do some remote administration via Terminal Server and realize that you can&#8217;t.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151803">
				<div id="div-comment-151803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151803">
			March 8, 2004 at 8:40 am</a>		</div>

		<p>I assume that&#8217;s why SFU/Interix comes with a telnet server :P</p>
<p>That last one was just a joke&#8230; I agree with you that this isn&#8217;t a very useful thing. I&#8217;m just a bit curious in how dependent the rest of the system (NT Executive etc.) is on the Win32 subsystem. </p>
<p>I remember reading an interview with Jim Allchin a year ago where he spoke a bit about this issue (removing the need for a server to have GDI etc.). Unfortunately I can&#8217;t find the link back :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151813">
				<div id="div-comment-151813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151813">
			March 8, 2004 at 9:02 am</a>		</div>

		<p>It&#8217;d be very nice if Watson/OCA could tell you which device driver it was that caused your last BSOD. Then at least you would know who to chase up to get it fixed. Just knowing the file name might be enough although it might also be good to get the device description where it is a hardware driver fault.<br />
<br />70% of the BSODs I get say &quot;Error caused by a device driver&quot; but I never know which one is responsible so I can&#8217;t do much about upgrading it or bothering the Manufacturer about fixing it. Also it would be good to know if it is a MS device driver and if it has been signed. It sometimes seems like an easy way out to blame a device driver thinking it is not MSs responsibilty when in fact it may be a device driver created by MS.</p>
<p>At the moment I can crash my Tablet PC by reading a file off a Compact Flash card using BlueJ a Java IDE. I am using the XP SP2 beta so I suppose I should expect problems, but unless I know where the problem lies it doesn&#8217;t help much.</p>
<p>I agree about Windows update. All the drivers it suggests for my hardware are at least a year out of date and a lot of people I know have more problems after accepting a Windows Update supplied driver than they had before installing it.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151833">
				<div id="div-comment-151833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151833">
			March 8, 2004 at 9:14 am</a>		</div>

		<p>The problem is that assigning blame is not easy. Suppose driver X crashes &#8211; is the problem in driver X? Or maybe the problem was in driver Y who corrupted driver X&#8217;s memory? Or maybe driver Z passed driver X a bogus pointer? Or driver Q called driver X when the rules state that Q cannot call X until it first does P and it forgot to do P?</p>
<p>The Driver Verifier tries to catch these sorts of problems, but it slows your machine way, way down due to all the extra checks. But if you suspect a driver, you can tag it for extra attention and see if it survives.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151873">
				<div id="div-comment-151873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151873">
			March 8, 2004 at 10:30 am</a>		</div>

		<p>OK, I realise in kernel space any driver can corrupt any part of the OS memory so it is difficult to work out where it all started to go wrong.<br />
<br />In that case does the OCA determine that it was a driver that caused the problem to begin with, or  is it just where the faulting instruction occured?</p>
<p>How much is the OCA data looked at? Do they work out if a particular driver is consistently causing problems and contact the developer?</p>
<p>I just think it might be better if consumers were able to apply pressure to IHVs based on some evidence that they are to blame.<br />
<br />If I can&#8217;t get an updated driver, or a fix for the problem I might decide to rip that componant out and buy the competitors.</p>
<p>Don&#8217;t you think that Microsoft makes too much use of kernel mode drivers? The more stuff you run in there the more chance there is of something going wrong. Do I need an Acoustic echo canceller or a DRM audio descrambler able to bring down my machine?</p>
<p>How about you let me know when something else is trying to install a driver? I don&#8217;t want these CD copy protection schemes to use Autorun to attach a filter driver to my CD-Rom drive.</p>
<p>A criteria of WHQL certification is that the driver does not adversely effect the operation of another device. A driver that does not let me read data off a particular audio CD should not qualify, thus it should not be installed without my agreement.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151883">
				<div id="div-comment-151883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151883">
			March 8, 2004 at 10:40 am</a>		</div>

		<p>The &quot;Debugging tools for Windows&quot;[1] gives you all the information you need :) There is support to load a minidump and it then can analyze it to find out what the cause of the crash possibly is. However, the more information you give it &#8211; the better the result. </p>
<p>So, for example having the symbolfiles for all your drivers helps it a lot.</p>
<p>Just start for example windbg.exe (you can use the console-based debuggers too if you prefer) and load the crash-dump. After it has loaded the dumpfile you can type this command to get the analysis: !analyze -v</p>
<p>Tip: You can set the _NT_SYMBOL_PATH environment variable to download symbols from Microsoft when needed (for example set _NT_SYMBOL_PATH=SRV*C:DbgSymbols*<a target="_new" href="http://msdl.microsoft.com/download/symbols" rel="nofollow">http://msdl.microsoft.com/download/symbols</a>).</p>
<p>[1] <a target="_new" href="http://www.microsoft.com/whdc/ddk/debugging/default.mspx" rel="nofollow">http://www.microsoft.com/whdc/ddk/debugging/default.mspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151913">
				<div id="div-comment-151913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas Hber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151913">
			March 8, 2004 at 10:52 am</a>		</div>

		<p>[Oh, sorry for splitting up in multiple answers, but I didn&#8217;t see the last reponse before posting the first one]</p>
<p>OCA uses, AFAIK, the same analysis as you get with the use of the debuggers I explained above. See especially this WinHEC 2003 presentation for more information about how OCA works: <a target="_new" href="http://download.microsoft.com/download/c/f/1/cf1806ad-5a4f-4f7d-a5b2-07fdb59a7adb/WH03_DDT36.exe" rel="nofollow">http://download.microsoft.com/download/c/f/1/cf1806ad-5a4f-4f7d-a5b2-07fdb59a7adb/WH03_DDT36.exe</a>. However there&#8217;s a lot more about driver quality etc. in the other slides which you can find here: <a target="_new" href="http://www.microsoft.com/whdc/winhec/pres03.mspx" rel="nofollow">http://www.microsoft.com/whdc/winhec/pres03.mspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-151963">
				<div id="div-comment-151963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151963">
			March 8, 2004 at 11:24 am</a>		</div>

		<p>Thanks for the info, but it would be nice if this could be built into OCA. Instead of &quot;A Device Driver&quot; tell me the filename, then let me work the rest out for myself.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-151973">
				<div id="div-comment-151973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-151973">
			March 8, 2004 at 11:51 am</a>		</div>

		<p>I remember hitting one of these myself and  after a few days I got a piece of email telling me it was my video driver.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-152173">
				<div id="div-comment-152173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://members.rogers.com/sometimesboredinottawa' rel='external nofollow' class='url'>roy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-152173">
			March 8, 2004 at 8:43 pm</a>		</div>

		<p>Edward, Andreas:</p>
<p>  I can vouch for the windDbg utility.  I used it at work after I foolishly volunteered to find out why certain computers (about 200 on th e network) got the blue screen at work while generating MS Access reports via a VB 6 application. </p>
<p>Luckly, I had kept all my windows dump files over the last 3 months, then analyzed a few of them after loading all the symbols, and bingo, it told me what DLL and what function was responsible for the crash.</p>
<p>I then blamed a video driver (I was half right, half wrong).  The driver was old, and wasn&#8217;t robust enough to handle bad programming.  The function in the driver had something to do with generating a GDI bitmap.  So MS Access I thought was to blame.  As it turned out, someone (no names) was using some stupid threading library to display the progress bar!!  Yes, it was the progress bar, in combination with an old driver.</p>
<p>Moral of the story, BSODs can be debugged and it doesn&#8217;t take *that* much effort.  Google some more if you need help.</p>
<p>Sorry if I&#8217;ve gone off topic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-152213">
				<div id="div-comment-152213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">keithmo [exmsft]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-152213">
			March 9, 2004 at 3:34 am</a>		</div>

		<p>Andreas: You said &quot;In _theory_ you should be able to create, for example an e-mail service, running in Interix or OS/2 subsystem, and it should not make a difference for it if CSRSS.EXE is alive or not.&quot;</p>
<p>In this case (as in many others), &quot;in theory&quot; means &quot;not really&quot;.</p>
<p>How would this email service communicate with the OS/2 subsystem? Via CSRSS.EXE, that&#8217;s how.</p>
<p>However, I do agree with the basics of what you&#8217;re saying. As a geek, I&#8217;ve always thought it would be cool if Microsoft made the NT OS available separately from Windows, with a &quot;subsystem developers kit&quot; of some kind. The marketing dweebs obviously thought differently.</p>
<p>On a slightly different (but related) topic: I&#8217;ve recently noticed an interesting behavioral difference between the NT and Linux kernels. In NT, *any* unhandled kernel exception causes a BSOD, even when running in &quot;process context&quot;. In Linux, the kernel attempts to kill the offending process. Obviously, this is not always possible (an exception in an interrupt handler is always a Bad Thing), but it often *is* possible.</p>
<p>I think this is one reason Linux is considered more stable than NT. If some daemon hits some corner case down in a kernel API, the daemon is killed, the OS continues to operate, and the administrator restarts the daemon. If the same thing happens in NT, the system BSODs and must be rebooted.</p>
<p>I totally understand the philosophy behind NT&#8217;s behavor: kernel-mode is trusted, if there&#8217;s an unhandled exception, then trust is &quot;broken&quot;, the system is considered compromised, and *wham*, BSOD. But I wonder if it would be possible for the NT kernel to be just a little more &quot;forgiving&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-152493">
				<div id="div-comment-152493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas H&#228;ber</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-152493">
			March 9, 2004 at 4:31 pm</a>		</div>

		<p>keithmo wrote:<br />
<br />&quot;How would this email service communicate with the OS/2 subsystem? Via CSRSS.EXE, that&#8217;s how.&quot;</p>
<p>I can&#8217;t immediately see why you have to go via CSRSS for this. All the environment subsystems are isolated for each other. The communication primitives, such as events, pipes, mutexes etc. are implemented in ntdll.dll. Where does the need for having CSRSS in the middle come from?</p>
<p>Yeah, it would be really cool to see the Windows Subsystem SDK :) No need to get C64 emulators when you instead can create a C64 subsystem :) Maybe marketing could use that as an argument for why the microkernel-architecture of Windows is soo much cooler then the architecture of Linux? :D</p>
<p>More fault-tolerance would be good, but it seems like a very hard job to implement it correctly. The heuristics should be really advanced to instead of BSOD continue to operate.</p>
<p>However, there is already a little of this in Windows XP. Or maybe this is a different issue? Sometimes when a graphics driver gets unresponsive Windows decides to shift to the standard VGA driver and tell the user to clean up the box and restart. Would be nice if it handled my crappy TV-card driver the same way :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-152543">
				<div id="div-comment-152543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-152543">
			March 9, 2004 at 5:34 pm</a>		</div>

		<p>3/9/2004 3:34 AM keithmo [exmsft]:</p>
<p>&gt; I think this is one reason Linux is<br />
<br />&gt; considered more stable than NT.</p>
<p>Maybe that depends on who is doing the considering.  Yes in that particular way Linux has that particular stability which NT doesn&#8217;t have.  But overall, counting all kinds of crashes and hangs from all kinds of reasons, in my experience NT4 SP3 still beat Linux.</p>
<p>I&#8217;ve often written in public forums that there are two essential differences between Windows and Linux.  (1) With Linux, you DO get what you paid for, except if you paid for it.  (2) With Linux, when the code needs fixing, you DO have a snowball&#8217;s chance in hell of getting it fixed.</p>
<p>Of course Linux frequently improves (some steps forward, some steps back, but frequently catching up and improving).  So maybe someday it will beat NT4 SP3.  Of course if you were to compare Linux to NT4 SP4, or W2000, or XP, or W2003, there would be no contest, at the kernel level.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-153533">
				<div id="div-comment-153533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jimmy Layton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-153533">
			March 11, 2004 at 1:43 pm</a>		</div>

		<p>What has happened HAPPENEND, what is happening now is happening.</p>
<p>Stop it from happening by changing things in Longhorn</p>
<p>Makes the Os Smarter to detect the errors than the WHQL test.</p>
<p>That way the user can see if the hard earned money bought them a Legit Video card or if they were duped.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-153553">
				<div id="div-comment-153553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-153553">
			March 11, 2004 at 1:54 pm</a>		</div>

		<p>You can do that today: Run the video driver under the Driver Verifier. Of course, all the extra checking is not free. Your computer will run a lot slower. But if you want it, you can do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-170653">
				<div id="div-comment-170653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew Ward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-170653">
			May 3, 2004 at 3:21 pm</a>		</div>

		<p>Hoping that noone has mentioned this yet, but why not publish the benchmark from the WHQL test for a given driver?  Then the review websites &amp; consumers would be able to notice a WHQL cheat&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-297003">
				<div id="div-comment-297003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/08/16/452141.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-297003">
			August 16, 2005 at 10:00 am</a>		</div>

		<p>I&#8217;m not sure what these people are thinking.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-297503">
				<div id="div-comment-297503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/08/16/452141.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040305-00/?p=40373#comment-297503">
			August 16, 2005 at 7:21 pm</a>		</div>

		<p>I&#8217;m not sure what these people are thinking.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

