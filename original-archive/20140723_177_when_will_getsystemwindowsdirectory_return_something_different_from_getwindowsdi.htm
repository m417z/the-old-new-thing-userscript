<html>
<head>
<title>When will GetSystemWindowsDirectory return something different from GetWindowsDirectory?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>When will GetSystemWindowsDirectory return something different from GetWindowsDirectory?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>July 23, 2014 / year-entry #178</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>30</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Most of the time, the Get≠Window≠Directory returns the Windows directory. However, as noted in the documentation for Get≠System≠Windows≠Directory: With Terminal Services, the Get≠System≠Windows≠Directory function retrieves the path of the system Windows directory, while the Get≠Windows≠Directory function retrieves the path of a Windows directory that is private for each user. On a single-user system, Get≠System≠Windows≠Directory is...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Most of the time, the <code>Get&shy;Window&shy;Directory</code> returns the Windows directory. However, as noted in the documentation for <code>Get&shy;System&shy;Windows&shy;Directory</code>:</p>
<blockquote class="q"><p> With Terminal Services, the <b>Get&shy;System&shy;Windows&shy;Directory</b> function retrieves the path of the system Windows directory, while the <b>Get&shy;Windows&shy;Directory</b> function retrieves the path of a Windows directory that is private for each user. On a single-user system, <b>Get&shy;System&shy;Windows&shy;Directory</b> is the same as <b>Get&shy;Windows&shy;Directory</b>. </p>
</blockquote>
<p> What's going on here, and how do I test this scenario? </p>
<p> When Terminal Services support was being added to Windows NT&nbsp;4.0 in the mid 1990's, the Terminal Services team discovered that a lot of applications assumed that the computer was used by only one person, and that that person was a local administrator. This was the most common system configuration at the time, so a lot of applications simply assumed that it was the <i>only</i> system configuration. </p>
<p> On the other hand, a Terminal Server machine can have a large number of users, including multiple users connected simultaneously, and if the Terminal Services team took no special action, you would have found that most applications didn't work. The situation "most applications didn't work" tends not to bode well for adoption of your technology. </p>
<p> Their solution was to create a whole bunch of compatibility behaviors and disable them if the application says, "Hey, I understand that Terminal Server machines are different from your average consumer machine, and I know what I'm doing." One of those compatibility behaviors is to make the <code>Get&shy;Windows&shy;Directory</code> function return a private writable directory rather than the real Windows directory, because old applications assumed that the Windows directory was writable, and they often dumped their private configuration data there. </p>
<p> The signal to disable compatibility behaviors is the <code>IMAGE_<wbr>DLL<wbr>CHARACTER&shy;ISTICS_<wbr>TERMINAL_<wbr>SERVER_<wbr>AWARE</wbr></wbr></wbr></wbr></wbr></code> flag in the image attributes of the primary executable. You tell the linker that you want this flag to be set by passing the <code>/TSAWARE:YES</code> parameter on the command line. (At some point, the Visual Studio folks made <code>/TSAWARE:YES</code> the default for all new projects, so you are probably getting this flag set on your files without even realizing it. You can force it off by going to Configuration Properties, and under Linker, then System, change the "Terminal Server" setting to "Not Terminal Server Aware".) </p>
<p> Note that only the flag state on the primary executable has any effect. Setting the flag on a DLL has no effect. (This adds to the collection of flags that are <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/08/24/10199218.aspx"> meaningful only on the primary executable</a>.) </p>
<p> The other tricky part is that the Terminal Server compatibility behaviors kick in only on a Terminal Server machine. The way you create a Terminal Server machine has changed a lot over the years, as has the name of the feature. </p>
<ul>
<li>In Windows NT 4.0, it was a special edition of Windows,     known as Windows NT 4.0 Terminal Server Edition. </li>
<li>In Windows 2000, the feature changed its name from     Terminal Server to Terminal Services and became an optional     server component rather than a separate product.     You add the component from Add/Remove Programs. </li>
<li>In Windows Server 2003 and Windows Server 2008,     you go to the Configure Your Server Wizard and     add the server r&ocirc;le "Terminal Server." </li>
<li>In Windows Server 2008 R2, the feature changed its name again.     The instructions are the same as in Windows Server 2008,     but the r&ocirc;le name changed to     "Remote Desktop Services". </li>
<li>In Windows Server 2012, the feature retained its name     but became grouped under the category "Virtual Desktop Infrastructure."     This time, you have to enable the r&ocirc;le server     "Remote Desktop (RD) Session Host." </li>
</ul>
<p> Terminal Services is the Puff Daddy of Windows technologies. It changes its name every few years, and you wonder what it will come up with next. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (30)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1140773">
				<div id="div-comment-1140773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140773">
			July 23, 2014 at 7:14 am</a>		</div>

		<p>&gt;It changes its name every few years, and you wonder what it will come up with next.</p>
<p>You know that marketrrhoids need to justify their salary somehow. There is only so many Active-&gt;.NET-&gt;Direct-&gt;Live rebrandings you can do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140783">
				<div id="div-comment-1140783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140783">
			July 23, 2014 at 7:14 am</a>		</div>

		<p>Is a &quot;r√¥le&quot; the French version of a &quot;role&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140793">
				<div id="div-comment-1140793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140793">
			July 23, 2014 at 7:15 am</a>		</div>

		<p>Too bad it&#39;s not possible to buy licenses for hacked terminal services.</p>
<p>For reference: hacked terminal services is a patch floating around for Vista (made when Vista was new) that converts the box to a true terminal server by causing the connection enumerator used at login time to not be able to see active sessions.</p>
<p>The consequence therein is GetWindowsDirectory works as expected and the muted space hasn&#39;t been virtualized despite the fact that multiple users are on the system. As Windows servers allow 2 by default now this actually gets tested by vendors more frequently and so has better compatibility now.</p>
<p>Yes I said buy. I have no intention of cheating MS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1140803">
				<div id="div-comment-1140803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140803">
			July 23, 2014 at 7:16 am</a>		</div>

		<p>There is INI file redirection feature, which should be used for legacy app deployment instead.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140813">
				<div id="div-comment-1140813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140813">
			July 23, 2014 at 8:25 am</a>		</div>

		<p>This oddness didn&#39;t start in Windows NT.</p>
<p>In Windows 3.1 (and maybe earlier?) the documented place to store per-user INI files was in the directory returned by GetWindowsDirectory.</p>
<p>Windows 3.1 could run from a file server. &nbsp;For example, you could have a single Windows installation on NetWare shared among many users. &nbsp;When running in this configuration the directory returned by GetWindowsDirectory varied by user so that the INI files didn&#39;t get confused.</p>
<p>Developers have been assuming that GetWindowsDirectory always returns the system Windows directory since forever. &nbsp;I&#39;m not sure there&#39;s ever been a time when this has been true on all current versions of Windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140823">
				<div id="div-comment-1140823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140823">
			July 23, 2014 at 8:35 am</a>		</div>

		<p>&gt;Developers have been assuming that GetWindowsDirectory always returns the system Windows directory since forever. </p>
<p>To be fair, the name GetWindowsDirectory rather suggests that the function returns the Windows directory. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140833">
				<div id="div-comment-1140833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140833">
			July 23, 2014 at 8:55 am</a>		</div>

		<p>Raymond, I love the site, been reading for a long time (but this is the first comment I&#39;ve ever written). Seriously, get out of here with that circumflex. Ain&#39;t nobody got time for that. Who do you think you are, the New Yorker? smh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-brunopitrus odd alt thread-odd thread-alt depth-1" id="comment-1140853">
				<div id="div-comment-1140853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/kinokijuf' rel='external nofollow' class='url'>kinokijuf</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140853">
			July 23, 2014 at 10:07 am</a>		</div>

		<p>@alegr1 recently they had yet another rebranding, this time to ‚ÄúOne‚Äù.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140863">
				<div id="div-comment-1140863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140863">
			July 23, 2014 at 10:17 am</a>		</div>

		<p>I gave up years ago on the rebranding and continue to use:</p>
<p>Hotmail¬Æ</p>
<p>SkyDrive¬Æ</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140873">
				<div id="div-comment-1140873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">franz dicoccio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140873">
			July 23, 2014 at 10:35 am</a>		</div>

		<p>Hi Raymond,</p>
<p> I find &nbsp;your posts on coding really interesting. I&#39;m particularly interested in something you posted only a few days ago</p>
<p>(Enumerating integer compositions, 14 Jul 2014). What you discuss has applications in quantum Physics and could be very useful for something I&#39;m working on.</p>
<p> I have spent almost an hour trying to figure out how to contact you. I could not find a way to do that directly (the contact page is disabled due to spamming), and comments seem to be closed for the post I&#39;m interested in.</p>
<p>Is there a chance that you could re-open the post for comments, or discuss some coding details privately? </p>
<p>I really apologize for this &quot;last-ditch effort&quot; &nbsp;off-topic comment but, as I say, your post could be very useful for my work.</p>
<p>Thanks anyway</p>
<p>Franz</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140883">
				<div id="div-comment-1140883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark VY</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140883">
			July 23, 2014 at 11:24 am</a>		</div>

		<p>@Franz: what Raymond did in that post is not particularly specialized. &nbsp;If you don&#39;t succeed in getting him to talk to you about it, post a link to that post on Math Overflow and ask any question you like.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140893">
				<div id="div-comment-1140893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark VY</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140893">
			July 23, 2014 at 11:25 am</a>		</div>

		<p>How come this problem affects Terminal Services but not Remote Desktop?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mngoldeneagle even thread-even depth-1" id="comment-1140903">
				<div id="div-comment-1140903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140903">
			July 23, 2014 at 11:48 am</a>		</div>

		<p>@Mark VY: On a non-Terminal Services-enabled system, only one session may be active at any given time. &nbsp;If I&#39;m on the console session and someone logs in via RDP, I&#39;ll get kicked off (but not logged out), and vice versa. &nbsp;Prior to Windows XP/2003, I /would/ have been logged out, but the fast user switching functionality allows multiple users to remain logged in.</p>
<p>Though the real question isn&#39;t why it doesn&#39;t affect Remote Desktop, but really why it doesn&#39;t affect multi-user configurations in general (which have been supported since Windows 3.11 for Workgroups, I believe?). &nbsp;As Raymond stated before, though, most installations of Windows only used a single account for both consumers and servers, so most people would not have encountered this. &nbsp;It would only have been a potential problem if you had two users using separate accounts on the same machine with the same privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140913">
				<div id="div-comment-1140913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140913">
			July 23, 2014 at 11:51 am</a>		</div>

		<p>@MNGoldenEagle: Try Windows Server 2003 or newer server. 2 users can be active.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mngoldeneagle even thread-even depth-1" id="comment-1140923">
				<div id="div-comment-1140923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140923">
			July 23, 2014 at 12:03 pm</a>		</div>

		<p>@Joshua: Really? &nbsp;I guess over the course of the past few years we never tried logging in remotely to the same machine with two different uses on Windows 2003 or newer before. &nbsp;It had always either been the same username (which obviously kicks off the other person) or Windows 7 (which apparently is restricted to one RDP session).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140933">
				<div id="div-comment-1140933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nico</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140933">
			July 23, 2014 at 12:11 pm</a>		</div>

		<p>It&#39;s interesting that the TS folks were working on solving problems in the mid 90s which would resurface a decade later in the form of Vista&#39;s non-admin admins, user account control, and user/process isolation. &nbsp;I&#39;ve wondered how much overlap there was between the two, and how much that previous work went into building Vista.</p>
<p>Regarding the name &#8212; I hope we have a bit more of a repreieve before the next renaming. &nbsp;There&#39;s enough TS* stuff left over in the &quot;Remote Desktop&quot; Services that yet another new name will make even more of a mess :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140943">
				<div id="div-comment-1140943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">franz dicoccio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140943">
			July 23, 2014 at 1:01 pm</a>		</div>

		<p>@Mark VY: Mark, thanks a lot for your reply. I&#39;ll do what you suggest.</p>
<p>Franz</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-pageup odd alt thread-odd thread-alt depth-1" id="comment-1140953">
				<div id="div-comment-1140953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/HomeCloset' rel='external nofollow' class='url'>HomeCloset</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140953">
			July 23, 2014 at 1:59 pm</a>		</div>

		<p>I don&#39;t quite remember but, wasn&#39;t it WinFrame not NT4 TSE who introduced this behavior?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140963">
				<div id="div-comment-1140963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Malcolm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140963">
			July 23, 2014 at 2:18 pm</a>		</div>

		<p>@HomeCloset, I think you may be right. I remember a long time ago working on a system running Insignia NTRigue. That was a custom fork of NT 3.51 where Insignia had bought source code rights to NT 3.51, adapted to allow multi user use. A competing product with the same arrangement with MS was Tektronix WinDD, which I had to deal with on a subsequent job. </p>
<p>I don&#39;t think Microsoft sell the source of Windows to anyone anymore (or it&#39;s so expensive no one has ponied up the money) :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1140973">
				<div id="div-comment-1140973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Malcolm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1140973">
			July 23, 2014 at 2:26 pm</a>		</div>

		<p>&#8230; and I see now that Insignia sub-licensed WinFrame from Citrix, and then Citrix bought Insignia. So I guess WinFrame was where it started after all! NTRigue had per-user redirection, after all. It also had a nasty bug where it would blue screen once all memory was used up &#8230; I never did get to the bottom of that, almost got as far as proving it but left that job before it was acknowledged as a bug by Insignia &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141003">
				<div id="div-comment-1141003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141003">
			July 23, 2014 at 6:12 pm</a>		</div>

		<p>&quot;Yes I said buy. I have no intention of cheating MS.&quot;</p>
<p>You keep telling yourself that. Hacking Windows to make it do thing specifically disabled by Microsoft is a violation of the license agreement. You want a Remote Desktop Server, you buy the Server edition of Windows. Or you try to set up something like that on Linux. Have fun.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-harry-johnston odd alt thread-odd thread-alt depth-1" id="comment-1141013">
				<div id="div-comment-1141013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Harry+Johnston' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141013">
			July 23, 2014 at 7:29 pm</a>		</div>

		<p>@Raphael: whoosh!</p>
<p>(If you still don&#39;t get it, you should note that &quot;buy the Server edition&quot; is not a solution to the problem that &quot;the Server edition has lousy application compatibility&quot;. &nbsp;In Joshua&#39;s opinion, the hack is a technically superior option, but he refuses to use it because he doesn&#39;t have Microsoft&#39;s permission, even if he pays Server edition prices. &nbsp;That&#39;s a valid complaint.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1141023">
				<div id="div-comment-1141023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141023">
			July 23, 2014 at 7:48 pm</a>		</div>

		<p>I remember that there were companies that selling hardware + driver to convert your Win2k/WinXP box into 2 or more machines, with each user logging in different sessions.</p>
<p>I&#39;m still unable to tell whether it&#39;s legal or not. (The OS is not virtualized, and runs on single motherboard/CPU. It&#39;s the point it allows multiple active sessions of user that is unclear.) </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141033">
				<div id="div-comment-1141033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141033">
			July 24, 2014 at 1:15 am</a>		</div>

		<p>&gt; @MNGoldenEagle: Try Windows Server 2003 or newer server. 2 users can be active.</p>
<p>Server 2003 actually allows 3 sessions &#8211; 1 on console, and 2 remote. This doesn&#39;t work on 2008 and up, where only 2 users can be active.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141053">
				<div id="div-comment-1141053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141053">
			July 24, 2014 at 4:03 am</a>		</div>

		<p>Windows 2000 Server also allowed 3 sessions in Remote Administration mode, but unlike Server 2003, you couldn&#39;t remotely connect to the console session. (This also affected the Internet Connector licence, making it impossible to remotely administer the server through remote desktop.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141093">
				<div id="div-comment-1141093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141093">
			July 24, 2014 at 9:41 am</a>		</div>

		<p>@Joshua</p>
<p>If it was &quot;converted to a true Terminal Server,&quot; then no, GetWindowsDirectory would not work &quot;as expected,&quot; it would work as designed.</p>
<p>Anyone developing an application to work with the hacked, improperly-functioning Terminal Server, but not the real, properly functioning Terminal Server, is a terrible developer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141123">
				<div id="div-comment-1141123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141123">
			July 24, 2014 at 2:01 pm</a>		</div>

		<p>@Anon: It functions like Windows Terminal Services in remote administration mode (GetWindowsDirectory() still returns C:Windows).</p>
<p>It&#39;s not that they developed for the hacked terminal server, it&#39;s that they developed form multi-user (that is, fast user switching) but failed to develop for a terminal server and the hacked terminal server worked as a consequence.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141133">
				<div id="div-comment-1141133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Malcolm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141133">
			July 24, 2014 at 2:02 pm</a>		</div>

		<p>What is hacked and improperly functioning, IMHO, is MS&#39;s licensing model for TS CALs. Grr &#8230;</p>
<p>If the licensing was not so byzantine, and hard to quantify/lock down (It&#39;s not like you can buy 20 licenses and they just apply to your server &#8230; they get pooled throughout all TSs in the domain &#8230; when your company is composed of multiple units you then have arguments as to whom should pay for what &#8230;), we&#39;d be making far more use of Terminal Server.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1141303">
				<div id="div-comment-1141303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">_Andrew Xiang</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141303">
			July 27, 2014 at 7:41 pm</a>		</div>

		<p>One more (flags only for exe) to add: &quot;Prefer 32-bit&quot; (since .NET 4.5).</p>
<p>@Raymond: How do you manage to make the cross reference/links to articles years ago from yourself or others?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141593">
				<div id="div-comment-1141593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140723-00/?p=423#comment-1141593">
			July 30, 2014 at 5:31 am</a>		</div>

		<p>@Malcolm: CALs only exist because competition is so weak. &nbsp;But, I don&#39;t have a problem with CAL licensing. &nbsp;It can be per-user, so you just get one for each user. &nbsp;Have your units pay for their people. &nbsp;Now office licensing on RDS is a problem. &nbsp;It&#39;s only per-device and editions must match. &nbsp;&quot;The CEO used his iPad to run office on the RDS? &nbsp;Guess we need to buy him another office license.&quot; &nbsp;&quot;A computer with Office Professional connected to our RDS running Office Standard? &nbsp;Guess we need to buy another license of Office Standard.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

