<html>
<head>
<title>How do I hide a window without blocking on it?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I hide a window without blocking on it?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 9, 2012 / year-entry #108</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>35</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer was working on improving their application startup performance. They found that if their application was launched immediately after a fresh boot, the act of dismissing their splash screen was taking over 5% of their boot time. Their code removed the splash screen by calling Show­Window(hwndSplash, SW_HIDE). They suspect that the splash screen thread...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer was working on improving their application startup performance. They found that if their application was launched immediately after a fresh boot, the act of dismissing their splash screen was taking over 5% of their boot time. Their code removed the splash screen by calling <code>Show&shy;Window(hwndSplash, SW_HIDE)</code>. They suspect that the splash screen thread has, for some reason, stopped responding to messages, and while an investigation into that avenue was undertaken, a parallel investigation into reducing the cost of hiding the splash screen was also begun.</p>
<p> One of the things they tried was to remove the <code>WS_<wbr>EX_<wbr>TOOL&shy;WINDOW</wbr></wbr></code> style and call <code>ITaskbarList::DeleteTab(hwndSplash)</code> but they found that it wasn't helping. </p>
<p> The reason it wasn't helping is that <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/02/21/10131989.aspx"> editing the window style generates <code>WM_<wbr>STYLE&shy;CHANGING</wbr></code>/<wbr><code>WM_<wbr>STYLE&shy;CHANGED</wbr></code> messages to the target window</wbr></a>, and now you're back where you started. </p>
<p> A better way is to use <code>Show&shy;Window&shy;Async(hwndSplash, SW_HIDE)</code>. The <code>-Async</code> version of the <code>Show&shy;Window</code> function is the <code>Send&shy;Notify&shy;Message</code> version of <code>Show&shy;Window</code>: If the window belongs to another thread group, then it schedules the operation but does not wait for it to complete. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (35)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-983653">
				<div id="div-comment-983653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Arlie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983653">
			May 9, 2012 at 7:18 am</a>		</div>

		<p>If only they would just ditch the splash screen entirely. &nbsp;They&#39;re a total waste of resources, and they just get in the way. &nbsp;I cringe every time I see some god-awful splash screen, because I know how much memory it is wasting. &nbsp;Most of them are a bitmap, so there&#39;s the memory for the bitmap. &nbsp;Very often they are semi-translucent images, so the image has an alpha channel, and now the compositor has to do extra work to handle the translucency and Z-order constraints. &nbsp;And on most systems, the image must be copied from system memory to video memory, so there&#39;s an entire extra copy of it. &nbsp;Most systems have significantly less video memory than system memory, so the system probably had to evict something else (something more useful!) from video memory in order to accommodate the image.</p>
<p>A complete waste of time and resources. &nbsp;I understand why apps do it, but really a better fix is to have the shell (Explorer) indicate to the user that an app is being launched. &nbsp;Yes, this is a feature request, and I know how high the bar is for feature requests. &nbsp;But come on &#8212; OS X showed how to do a decent job of this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983663">
				<div id="div-comment-983663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983663">
			May 9, 2012 at 7:24 am</a>		</div>

		<p>Don&#39;t forget splash screens that animate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983693">
				<div id="div-comment-983693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983693">
			May 9, 2012 at 7:38 am</a>		</div>

		<p>@Arlie: Windows 7 will display a version of an application&#39;s progress bar within the application&#39;s taskbar icon. &nbsp;This could probably be leveraged to do what you suggest without additional changes by Microsoft.</p>
<p>MSDN&#39;s guidelines for Metra splash screens: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/windows/apps/hh465338.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/hh465338.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983703">
				<div id="div-comment-983703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983703">
			May 9, 2012 at 7:59 am</a>		</div>

		<p>Splash screens aren&#39;t always bad&#8230; If a program takes a long time to load, I like having a splash screen come to indicate that the computer is trying to respond to my request. I like what Office 2010 did to make them minimizable so if it gets in the way, you can at least dismiss it. That said, splash screens should not noticeably impact the load time of an app. That defeats the purpose entirely.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983713">
				<div id="div-comment-983713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Schroedl</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983713">
			May 9, 2012 at 8:14 am</a>		</div>

		<p>Nice tip! I didn&#39;t know about ShowWindowAsync()</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983733">
				<div id="div-comment-983733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">No One</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983733">
			May 9, 2012 at 8:47 am</a>		</div>

		<p>Re: Splash screens</p>
<p>If the splash screen isn&#39;t always-on-top then I don&#39;t mind it. &nbsp;If I can set it so that the splash screen is opened up behind other windows that&#39;d be great. &nbsp;That way if I want to wait for Firefox to reticulate its splines I can. &nbsp;If I want to keep working on something while Firefox reticulates its splines I can. &nbsp;I even like the Metro guidelines for splash screens.</p>
<p>I don&#39;t get all this hatred for splash screens &#8212; yes, they are often done horribly wrong, but if done right they can be a great aid to UX without much cost. &nbsp;A &#8211;nointo flag on the exe to avoid the splash screen would allay the problems that most people have with them though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983743">
				<div id="div-comment-983743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983743">
			May 9, 2012 at 8:56 am</a>		</div>

		<p>Many splash screens are actually topmost. Pure evil.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983753">
				<div id="div-comment-983753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983753">
			May 9, 2012 at 9:27 am</a>		</div>

		<p>Eliminate ALL the splash screens!</p>
<p>Put the branding in the application itself. &nbsp;Impress your users with a fast startup time rather that applying a splash screen bandaid to your embarrassingly slow initialization.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983763">
				<div id="div-comment-983763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983763">
			May 9, 2012 at 9:33 am</a>		</div>

		<p>@Brian: While your proposed solution could potentially work for a program already pinned to the taskbar, it presents a few hurdles. &nbsp;The first is that a taskbar icon doesn&#39;t generally appear until an application&#39;s first top-level window appears, except for pinned icons which have a different appearance (no block vs. block). &nbsp;You then have the problem of who is responsible for reporting the application&#39;s load progress. &nbsp;Obviously the Shell team can&#39;t do it, so the app itself has to report load progress. &nbsp;That being said, it probably then becomes more of a headache than it&#39;s worth, leading us right back to putting up a splash screen. &nbsp;:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983773">
				<div id="div-comment-983773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AsmGuru62</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983773">
			May 9, 2012 at 9:42 am</a>		</div>

		<p>I once worked on a team for a project where it has 118 DLLs (statically linked, of course) &#8212; startup time ~45sec.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983793">
				<div id="div-comment-983793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983793">
			May 9, 2012 at 10:58 am</a>		</div>

		<p>As annoying as splash screens are, what&#39;s the alternative? A blank window where it looks like you can act but really can&#39;t is certainly not a better user exerience. While some splash screens are purely unnecessary (put there just for branding), others are extremely expensive to do better than.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983803">
				<div id="div-comment-983803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983803">
			May 9, 2012 at 11:05 am</a>		</div>

		<p>What are we arguing about here? &nbsp;Are all splash screens bad or just the annoying ones? &nbsp;If the program&#39;s startup time can not be improved (as is sometimes the case when 3rd party frameworks or components are involved), I at least want some kind of feedback that something is happening. &nbsp;An unobtrusive splash screen would serve that purpose.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983833">
				<div id="div-comment-983833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tod</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983833">
			May 9, 2012 at 12:06 pm</a>		</div>

		<p>I remember using KDE3 on Knoppix about 5 years ago. It showed a bouncing ball with the icon of the application being launched next to the cursor.</p>
<p>Sadly half of the applications were broken and didn&#39;t launch at all, leading to frustrated waiting until the animation timed out. But that&#39;s a different issue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983843">
				<div id="div-comment-983843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Walter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983843">
			May 9, 2012 at 1:05 pm</a>		</div>

		<p>do Windows belong to threads or to &quot;thread groups&quot; as you call them, and if the latter, what is a thread group?</p>
<div class="post">[<i>Windows belong to threads, and threads belong to thread groups. (Therefore, windows belong indirectly to thread groups.) I discussed thread groups in my &quot;Five things every Win32 programmer should know&quot; talk. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983853">
				<div id="div-comment-983853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983853">
			May 9, 2012 at 1:06 pm</a>		</div>

		<p>Windows does something a bit similar, except that the busy cursor does not have the application icon, but is generic.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983783">
				<div id="div-comment-983783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983783">
			May 9, 2012 at 10:01 am</a>		</div>

		<p>When you show a splash screen, you&#39;re saying these things:</p>
<p>* Our ego is huge.</p>
<p>* Your time and your life are unimportant.</p>
<p>* Our software is bloated and our programmers incompetent.</p>
<p>* And we&#39;re proud of it.</p>
<p>Burn all splash screens.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983873">
				<div id="div-comment-983873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983873">
			May 9, 2012 at 5:24 pm</a>		</div>

		<p>@Adrian and all other splash haters that don&#39;t use their single neuron when saying &quot;get rid of ALL..&quot; &#8211; try sell a application which has resources over VPN in different location in the world, the light takes ~70 ms to travel from Los Angeles to Moscow, or do open a Excel file from Moscow while the resource is shared on a HDD in LA. Then talk again. I like splash screens that shows the feedback &#8211; your &quot;get rid of ALL&quot; statement(s)&#8230;well marry that neuron so you&#39;ll double your IQ.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-983883">
				<div id="div-comment-983883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983883">
			May 9, 2012 at 7:26 pm</a>		</div>

		<p>@AsmGuru62: How do you static link a DLL? I think static link means the code in .LIB get placed in the EXE file directly.</p>
<p>118 .LIB files doesn&#39;t necessary mean long load time if static linked, because when doing static linking, functions that&#39;s not used won&#39;t be put into the EXE file.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983893">
				<div id="div-comment-983893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983893">
			May 9, 2012 at 7:37 pm</a>		</div>

		<p>I suspect it actually is possible, but why you&#39;d want to do it I have no clue. If the offset of functions within the dll change, you&#39;re broken. Link dynamically with dlls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983903">
				<div id="div-comment-983903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983903">
			May 9, 2012 at 9:21 pm</a>		</div>

		<p>I think he meant implicit DLL linking, also known as a static load: <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/9yd93633.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/9yd93633.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983913">
				<div id="div-comment-983913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983913">
			May 9, 2012 at 10:51 pm</a>		</div>

		<p>@cheong00:</p>
<p>As meh said, this is refering to linking against the import library at compile time and then statically loading the DLL. This is just another of those interesting terms that people use. Obviously, the converse of this is dynamic linking. I guess it is helpful to be aware of these quirky terms at times.</p>
<p>Of course, statically loading 118 DLLs will cause slow down if all 118 DLLs do strange things in their DllMain functions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983923">
				<div id="div-comment-983923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mpz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983923">
			May 9, 2012 at 11:50 pm</a>		</div>

		<p>A splash screen that is contained within the application&#39;s actual window (client area) is perfectly acceptable (in other words, bring up the &quot;real&quot; application window immediately, even if it can&#39;t be interacted with (the splash &quot;screen&quot; communicates to the user that the application is still loading)). Just don&#39;t make it a separate window and DO NOT make it topmost. That is grounds for immediate uninstall in my books.</p>
<p>(The reason why I&#39;d prefer splash &quot;screens&quot; in the application window is because it&#39;s highly annoying when an application that is not focused, brings up its main window and steals focus even though I was doing something completely different, waiting for the application to launch..)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983933">
				<div id="div-comment-983933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thomas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983933">
			May 10, 2012 at 2:26 am</a>		</div>

		<p>@Gabe:</p>
<p>&quot;As annoying as splash screens are, what&#39;s the alternative?&quot;</p>
<p>Improve application load time? Make it load on demand instead of everything at startup?</p>
<p>Slow startup is a symptom that should be addressed &#8211; not put a big fat sticker on it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983953">
				<div id="div-comment-983953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BC_Programming</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983953">
			May 10, 2012 at 4:35 am</a>		</div>

		<p>Some of my applications involve actions such as compiling scripts, enumerating .NET assemblies for implementations of interfaces and derivations of certain abstract classes, loading images and sounds, as well as acting on a number of options provided as part of the settings of the application. The Splash screen provides feedback during this process in the form of a progress bar (that is the entire splash changing colour horizontally as well as the win7 taskbar progressbar). If a problem occurs it can stop and provide a diagnostic log that I can use to help them with the issue. It &nbsp;is animated as well and uses a bitmap, but the purpose is to &quot;distract&quot; the user for the 6-10 seconds for startup. It appears instantly, and if the user switches to another application it doesn&#39;t try to usurp the focus.</p>
<p>I hate programs that don&#39;t provide &lt;any&gt; feedback during initialization and give you a single generic error when anything bad happens, so I made mine provide clear feedback when something goes south by showing the progress and displaying any error traces visually in addition to automatically writing log files for inspection.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-983963">
				<div id="div-comment-983963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@BC_Programming</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983963">
			May 10, 2012 at 6:15 am</a>		</div>

		<blockquote><p>
  &gt;Some of my applications involve actions such as compiling scripts, enumerating .NET assemblies for implementations of interfaces and derivations of certain abstract classes, loading images and sounds, as well as acting on a number of options provided as part of the settings of the application&lt;&lt;
</p></blockquote>
<p>Because you are in .NET, you should let the runtime lazy-load all this. .NET makes it very easy and safe to implement &quot;initialization on first use&quot;: By defining &quot;static readonly&quot; members having the initilization value produced by a function.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-983973">
				<div id="div-comment-983973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-983973">
			May 10, 2012 at 7:38 am</a>		</div>

		<p>AsmGuru62: I hope you guys at least rebased the dlls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-984053">
				<div id="div-comment-984053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984053">
			May 10, 2012 at 8:35 am</a>		</div>

		<p>AsmGuru62 probably linked against the LIB files for the DLLs as normal. &nbsp;To compare, he could have asked the linker to delay-load these DLLs, which would have probably made a significant difference.</p>
<p>On the other hand, if the program actually has to call code from each of these DLLs on startup, then some more work is probably in order.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-984093">
				<div id="div-comment-984093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984093">
			May 10, 2012 at 9:22 am</a>		</div>

		<p>@Danny, you could tone it down a bit. &nbsp;There&#39;s no reason to be abusive!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-984103">
				<div id="div-comment-984103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AsmGuru62</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984103">
			May 10, 2012 at 9:25 am</a>		</div>

		<p>I wish I worked alone on that one.</p>
<p>I was just a consultant for a few outsourcers. :-)</p>
<p>118 DllMains indeed would do some cool and slow stuff.</p>
<p>So, we needed the splash, because of the slow startup.</p>
<p>Rebasing is a good idea, but I think system itself does it.</p>
<p>When XP starts an EXE &#8211; it caches the DLLs final loaded address, so next</p>
<p>startups for the same EXE (with the same timestamp) would be faster.</p>
<p>This effect however lasts until next reboot (or the new build, so EXE will be modified).</p>
<p>Splash screen was made on a different thread, so it can be dismissed by user if user is annoyed for some reason.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-984113">
				<div id="div-comment-984113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984113">
			May 10, 2012 at 9:52 am</a>		</div>

		<p>I&#39;d say bind. (LibreOffice/Openoffice can be sped up that way &#8211; AFAIK ~50%) Sounds like that project could use that as well. Warning: some compilers can produce binaries in such way that bind can break them. (notably GCC)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-984323">
				<div id="div-comment-984323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon R</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984323">
			May 11, 2012 at 4:37 am</a>		</div>

		<p>For bad splash screens &#8211; how about the Visual Studio 2010 one? VS takes long enough to load that it arguably needs a splash screen &#8211; but the problem is the splash screen itself often doesn&#39;t appear until a second or so after you&#39;ve launched VS, which defeats the point of having it! &nbsp;If I had a penny for every time I&#39;ve started two instances of VS because the delayed splash screen on the first instance made me think it wasn&#39;t launching, so I clicked to launch it again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-984493">
				<div id="div-comment-984493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984493">
			May 11, 2012 at 12:48 pm</a>		</div>

		<p>@Danny: &nbsp;Just bring up the app&#39;s main window in a non-editable state until the resources become available. &nbsp;What if I started the app by mistake. &nbsp;Why should I have to wait for bloated resources from Moscow just to close the app?</p>
<p>A splash screen just consumes additional resources for branding. &nbsp;And it&#39;s not the kind of branding you want. &nbsp;I only remember the splash screens from the slow starting app.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-984583">
				<div id="div-comment-984583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-984583">
			May 11, 2012 at 9:03 pm</a>		</div>

		<p>Adrian: What if the app doesn&#39;t know how to draw the window without those resources?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chris-j-leonard odd alt thread-odd thread-alt depth-1" id="comment-985163">
				<div id="div-comment-985163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Veltas' rel='external nofollow' class='url'>Veltas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-985163">
			May 15, 2012 at 7:19 am</a>		</div>

		<p>@BC_Programming</p>
<blockquote><p>
  It &nbsp;is animated as well and uses a bitmap, but the purpose is to &quot;distract&quot; the user for the 6-10 seconds for startup. It appears instantly, and if the user switches to another application it doesn&#39;t try to usurp the focus.
</p></blockquote>
<p>MSDN has something to say about animated splash screens.</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/aa511284#splash" rel="nofollow">msdn.microsoft.com/&#8230;/aa511284</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-985353">
				<div id="div-comment-985353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120509-00/?p=7673#comment-985353">
			May 16, 2012 at 12:59 am</a>		</div>

		<blockquote><p>
  MSDN has something to say about animated splash screens.
</p></blockquote>
<p>Office team didn&#39;t get that memo.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

