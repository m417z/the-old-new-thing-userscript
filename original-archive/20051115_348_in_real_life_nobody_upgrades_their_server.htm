<html>
<head>
<title>In real life, nobody upgrades their server</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>In real life, nobody upgrades their server</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 15, 2005 / year-entry #349</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>42</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">When you install Windows on a machine that already has a copy of Windows, you get the option of performing a "clean" install (installing the operating system from scratch, ignoring the existing one) or an "upgrade" install (upgrading the existing operating system to the new one). And in real life, it turns out, surveys show...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>When you install Windows on a machine that already has a copy of Windows, you get the option of performing a "clean" install (installing the operating system from scratch, ignoring the existing one) or an "upgrade" install (upgrading the existing operating system to the new one).</p>
<p> And in real life, it turns out, surveys show that nobody upgrades their servers. </p>
<p> Really. </p>
<p> Sure, IT administrators may get new hardware, they may upgrade the software, they may even install a new version of the operating system, but our research says that, to within experimental error, nobody does an "upgrade install". They always do a "clean install" and reinstall any applications that they need. Since this is a server, there aren't many applications that need to be installed, so reinstalling all the applications doesn't take quite so long. </p>
<p> What is the lesson here? </p>
<p> You have to <a href="http://blogs.msdn.com/cyrusn/archive/2004/05/25/141443.aspx"> dogfood</a> intelligently. If you're self-hosted on a server build and you install the latest build via an "upgrade install", you're not really helping to test setup, since <a href="http://blogs.msdn.com/oldnewthing/archive/2005/09/13/464706.aspx"> no real customer does what you're doing</a>. This type of disconnect has historically been a problem in the operating systems group, where people typically run through the interactive setup (or if they're really clever, hand it an <a href="http://www.microsoft.com/technet/prodtechnol/windows2000pro/deploy/unattend/sp1ch01.mspx"> unattend script</a> to answer the questions automatically), even though research shows that less than ten percent of all Windows systems are set up that way. The vast majority of the systems are installed via a process known as <a href="http://www.microsoft.com/resources/documentation/Windows/XP/all/reskit/en-us/prbc_cai_vnve.asp"> Sysprep</a>. But inside Microsoft, very few people use this Sysprep install mechanism. Result:  More attention is paid to improving the quality of manual setup at the expense of Sysprep because more internal bugs are filed against manual setup than against Sysprep. Even though Sysprep method is more commonly used in real life. </p>
<p> In other words, we failed to dogfood setup. </p>
<p> Fortunately, with Windows&nbsp;Vista, the setup team recognized this disconnect between what gets used at Microsoft and what gets used in the real world and attacked it head-on: The two setup models have been merged into one. (And, if you count "clean install" and "upgrade install" as two different models, which they sort of are, then in fact three setup models have merged to one.) The three types of setup (mass-produced, manual clean install, and manual upgrade install) are now just minor variations on a single engine. </p>
<p> The dogfood is back. </p>
<p> (Related: <a href="http://blogs.msdn.com/oldnewthing/archive/2005/09/13/464706.aspx"> Why is there no all-encompassing superset version of Windows?</a>) </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (42)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-322083">
				<div id="div-comment-322083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Typhoon121</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322083">
			November 15, 2005 at 10:24 am</a>		</div>

		<p>We do it because if you install over most installers just plain suck and if one thing is not right it will finish and not work, or you have mixed versioned files, or if it fails and rolls back some of the stuff you tried to do screws up somthing else by leaving some component of the newer version installed. Better to start clean and work up, less hassle and better restults. Less downtime cause if something screws up on an upgrade install you gotta troubleshoot it and many 24/7 servers cost big bucks to be down for extended time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jeff-parker odd alt thread-odd thread-alt depth-1" id="comment-322093">
				<div id="div-comment-322093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Parker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322093">
			November 15, 2005 at 10:39 am</a>		</div>

		<p>I agree with typhoon, I tried an upgrade from 3.5 to NT 4, server was so hosed spent a week trying to trouble shoot, I ended up reformatting. Tried 4.0 to 2000, this time I called microsoft support as we had it, it took 2 days to get a response back, which then they had to send me to an engineer, which took 2 days, then I had to compose all kinds of logs and dumps. Finally after a week of midnight support calls for me to reboot the server and so on. I came in that weekend reformatted and reloaded. That Monday an engineer finally got back to me to try something, but it was now too late. Server 2003 comes around, reformat reload, no problems never even attempt an upgrade. </p>
<p>I have tried desktop system and stuff as well, even 2000 pro to XP pro had wierd problems like File Save in any app would work, File save as on any app using common dialogs would crash the app with work unsaved. They bounced me from OS support to Office suport on that one for a while until I just reloaded. Anyway, I guess through the years I have learned, you never ever ever upgrade a Microsoft OS, it causes more problems than a fresh install. That will be the challenge I think for MS to overcome. When Vista rolls around, I am not daring enough to trust it to upgrade when I have yet to see an upgrade work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322123">
				<div id="div-comment-322123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Loughan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322123">
			November 15, 2005 at 11:04 am</a>		</div>

		<p>if installation is meant to match modern reality, why didnt the vista beta install onto clean hardware, or better yet, ship with vmware and VPC images?</p>
<p>Nowadays the primary means of testing an unstable OS is not &quot;find a scratch machine to install it on&quot; but &quot;lets host it under a new VM&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322133">
				<div id="div-comment-322133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://improbable.org/chris/' rel='external nofollow' class='url'>Chris Adams</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322133">
			November 15, 2005 at 11:07 am</a>		</div>

		<p>This is true &#8211; but only for Windows. We routinely upgrade Linux and OS X systems because the process is reliable; my personal experience, and that of the other Windows admins I know has been that people like the theory of upgrading Windows but have been so badly burned by systems which developed bizarre instabilities that they&#8217;ve given up on the process. </p>
<p>There are two problems which make Windows so much more expensive to manage (at least in our environment): one is that the Windows Installer is harder to get right than, say, the Debian package management system which makes install automation much harder than it should be. That&#8217;s a relatively minor problem, however, as the real killer is that flawed as MSI may be it&#8217;s far better than the demented installers (or extremely poorly-designed MSI packages if they do use them) most vendors insist on using which tend to be very poorly tested and fail as soon as you venture outside of the extremely limited QA process small companies like Adobe or Corel can afford.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tzagotta even thread-even depth-1" id="comment-322143">
				<div id="div-comment-322143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tzagotta</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322143">
			November 15, 2005 at 11:08 am</a>		</div>

		<p>I don&#8217;t trust upgrad installs for any OS &#8211; server or desktop &#8211; I always perform a clean install.  I run a lot of apps, but I have all my software installers on a network share, so it is quick and easy to re-install all the apps on my workstation&#8230;even with the large number of apps that I run.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322153">
				<div id="div-comment-322153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kbiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322153">
			November 15, 2005 at 11:21 am</a>		</div>

		<p>Is dogfood now a verb?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322163">
				<div id="div-comment-322163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322163">
			November 15, 2005 at 11:22 am</a>		</div>

		<p>&quot;We routinely upgrade Linux and OS X systems because the process is reliable&quot;</p>
<p>Er-HUH? I&#8217;ve been burned by RPM &amp; apt-get often enough. They&#8217;re ok for a package or two, but not for going from maybe RH 5.0 to 6.0</p>
<p>All installers suck, whether it&#8217;s UNIX or Windows.</p>
<p>I figure if it&#8217;s going to step on all my customizations anyway, I might as well install from scratch. And from source.</p>
<p>Heck, the system I&#8217;m posting from is so old it doesn&#8217;t even have RPM anymore, I just install from source tarballs.</p>
<p>(Granted it took me 5-1/2 hours this weekend to figure out how to make hotplug and udevd play well together to automount a USB stick, but think of all the time I&#8217;ll save not having to type &quot;mount /mnt/stick&quot; any more!! :-) but it was fun finding out and I know my system better. I discovered 3 config files, a set of utilities, and an important directory I didn&#8217;t know about.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-322173">
				<div id="div-comment-322173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322173">
			November 15, 2005 at 11:25 am</a>		</div>

		<p>Sysprep is the dominant setup for Windows in general, not for servers in particular. I used the server example as a lead-in to the dogfood angle (the shift in focus occurred at &quot;What is the lesson here?&quot;)</p>
<p>&quot;Why didn&#8217;t Vista beta ship as VPC images?&quot; Because that completely misses the point of my article. Shipping as VPCs would be testing the 0% case. The purpose of a beta test is not to &quot;find bugs in the beta installer&quot;. The purpose of a beta is to &quot;find bugs in the final product&quot;. And the final product does not ship as VPCs. Shipping the beta as VPCs means that no bugs in the installer would be found.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322183">
				<div id="div-comment-322183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">O</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322183">
			November 15, 2005 at 11:31 am</a>		</div>

		<p>I think this is because upgrading over windows is concidered by most to be &quot;A bad idea&quot;(tm).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322193">
				<div id="div-comment-322193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.guyswithtowels.com' rel='external nofollow' class='url'>Tim</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322193">
			November 15, 2005 at 11:41 am</a>		</div>

		<p>&quot;Is dogfood now a verb?&quot;</p>
<p>These days, people often shortcut their language usage by verbing nouns &#8211; it helps them to showcase their thoughts :-).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322203">
				<div id="div-comment-322203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrea D'Alessandro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322203">
			November 15, 2005 at 11:41 am</a>		</div>

		<p>In the old times, this was not true. You can check the Bob Supnik paper &quot;Bug, Feature, or Code Rot? Adventures in OS Debugging&quot; (<a rel="nofollow" target="_new" href="http://simh.trailing-edge.com/docs/bugfeature.pdf" rel="nofollow">http://simh.trailing-edge.com/docs/bugfeature.pdf</a>). Many tentatives to do a clean install of old operating systems like TENEX or ITS on hardware simulators aborted.<br />
<br />The later builds of these OS were never tried to be clean installed, as new hardware was not available anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322213">
				<div id="div-comment-322213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322213">
			November 15, 2005 at 11:50 am</a>		</div>

		<p>I&#8217;d be happy if the Vista installer was smarter about USB devices.  I tried installing Windows XP Pro using a REV drive on a legacy-free computer with no CD or floppy, and I found it impossible.  Sure, you can put the XP ISO on the Rev disk, sure the computer boots from the Rev drive just fine, heck, Setup even formats the drive perfectly and copies all its files.  Then it reboots and all hell breaks loose.</p>
<p>For some reason, Setup, which was running PERFECTLY FINE off a Rev drive 30 seconds ago, now has absolutely no knowledge of USB.  It doesn&#8217;t assign the Rev drive a letter, so when it asks you to find asetupfile.cab (or whatever), you&#8217;re completely sunk.</p>
<p>We ended up having to buy a $50 CD drive because Windows XP Setup loads USB drivers sometimes, and then sometimes it doesn&#8217;t.  What  an ass-pain that was.</p>
<p>I think Calvin and Hobbes said it best:  &quot;Verbing words weirds language.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322223">
				<div id="div-comment-322223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322223">
			November 15, 2005 at 11:59 am</a>		</div>

		<p>Another example of upgrade problems:  If you upgrade from Win2K Pro to Win XP Pro then no users can Remote Desktop in.  It looks like everything is setup correctly but doesn&#8217;t work.  Doing enough Google searching eventually leads to a knowledgebase article with some settings to tweak.  The time saved by doing an upgrade was wasted by troubleshooting things that should work but don&#8217;t.</p>
<p>The biggest problem I have is that new releases contain many new features.  If you do an upgrade install you typically aren&#8217;t asked about these features and only end up with the features you already had upgraded.</p>
<p>Yes, I am the person who always chooses &quot;Custom&quot; when installing software &#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322233">
				<div id="div-comment-322233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322233">
			November 15, 2005 at 12:28 pm</a>		</div>

		<blockquote><p>
  Yes, I am the person who always chooses &quot;Custom&quot; when installing software &#8230;.</p>
<p>Bingo. I&#8217;ve discovered upgrades only work well when you did a very plain vanilla install in the first place.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322243">
				<div id="div-comment-322243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322243">
			November 15, 2005 at 12:56 pm</a>		</div>

		<p>Uh oh, looks like there are two &quot;Bryan&quot;s running around here.  I&#8217;d probably better change my name to (hopefully) disambiguate.</p>
<p>Anyway.  In my experience helping fix Linux problems (at justlinux.com), it is true that many distros don&#8217;t easily upgrade from one version to another.  RPM-based distros, in particular, are crappy at this.  Windows seems to fare about as well as the RPM distros at this particular task.</p>
<p>However, apt-get seems to be able to handle it OK, as long as it doesn&#8217;t have to install too many updates at any one time.  If the upgrade happens over several runs of apt-get, it&#8217;s been OK so far.</p>
<p>But I haven&#8217;t tried upgrading from stable to testing (for instance) in one shot, so maybe that&#8217;s just as broken as RPMs and Windows.</p>
<p>What I want to eventually find out (and I probably will &#8212; in 2007 or 2008, once we get some Vista media here to play with&#8230; we always seem to be at least a year or two behind) is how the whole &quot;mass-produced setup&quot; thing works.  Does it still require a sysprep tool?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patriotb odd alt thread-odd thread-alt depth-1" id="comment-322263">
				<div id="div-comment-322263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">PatriotB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322263">
			November 15, 2005 at 1:42 pm</a>		</div>

		<p>A few months ago my sister&#8217;s Windows Me somehow got hosed (I&#8217;m surprised it lasted this long!), and I had to help her install XP over the phone.  We had to do an upgrade in order to not lose any of her stuff.</p>
<p>Surprisingly, it worked without a hitch.  But, once I get a chance to fly down to her place with a spare hard drive, I&#8217;m going to copy off all her stuff and do a clean install.  Even though things appear to be OK, I definitely wouldn&#8217;t trust a Me-to-XP upgrade for long term.</p>
<p>Besides the fact that I want to get her set up with a nonadmin account (when you upgrade from 9x, your 9x account is always made into an adminstrator).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tag even thread-even depth-1" id="comment-322273">
				<div id="div-comment-322273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Garry Trinder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322273">
			November 15, 2005 at 1:48 pm</a>		</div>

		<p>I do &quot;upgrades&quot;.</p>
<p>But only with same OS version as installed ;-)<br />
<br />Sometimes this is the only way to get server back to life for a while (to move data and format / reinstall ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322293">
				<div id="div-comment-322293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.x2line.com/al/' rel='external nofollow' class='url'>Anatoly Lubarsky</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322293">
			November 15, 2005 at 2:22 pm</a>		</div>

		<p>I upgraded at least 10 times from 2000 server to 2003 server, including online production servers. With no issues&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322303">
				<div id="div-comment-322303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AlexL</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322303">
			November 15, 2005 at 2:42 pm</a>		</div>

		<p>Oh my, what I just knocked my head against. That makes quite a lot of sense in terms of sysprep that MS isn&#8217;t using it internally.</p>
<p>Sysprep is seemingly an under-documented utility that makes life so much easier for a number of us. I wish more of it was made public &#8211; like what does it really do under the covers to &quot;sysprep&quot; (verbifying I guess. =P) an image aside from changing the SID? Or why is it that I must be careful to delete hardware or else be left with ghosted references to them. Why is there support for discovering some drivers but not others&#8230;. the list goes on.</p>
<p>As for clean installs, that&#8217;s me the whole way. I don&#8217;t believe in most upgrades&#8230;perhaps its only because I&#8217;ve never had any luck.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322313">
				<div id="div-comment-322313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeremy Martin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322313">
			November 15, 2005 at 3:00 pm</a>		</div>

		<p>In practice Sysprep is 90% there, with the other 10% being a cumbersome setup and a support structure that is tricky at best. Did you know that Sysprep will reboot infinitely if the telephony service is disabled? AND sysprep doesn’t check this before syspreping. Also sysprep queries the SMB lanmanserver service to enumerate the OS version. WHY??? I can think of 15 different methods that are better, and don’t require a service that Sysprep doesn’t use as intended.</p>
<p>I believe Sysprep would be a wonderful candidate for Open Source, similar to WIX (even if Vista fixes this by adding features to it&#8217;s install, the Windows Vista release is a long time away, never mind the time it will take for corporate infrastructure and end users to migrate&#8230; a realistic time frame may be 2.5-3 years from now before adoption is at a reasonable level vs. XP). This is a utility that many people will use, Microsoft will continue giving away, and truthfully people outside Microsoft are more interested in seeing work right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322323">
				<div id="div-comment-322323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322323">
			November 15, 2005 at 3:56 pm</a>		</div>

		<p>Eating one&#8217;s own dogfood is a good thing for everyone. Sadly, &quot;hundenahrung&quot; doesn&#8217;t roll off the tongue quite as easily.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322333">
				<div id="div-comment-322333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Grant</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322333">
			November 15, 2005 at 4:45 pm</a>		</div>

		<p>I&#8217;d have to disagree on the Linux scenario.  The primary reason everyone recommends that you install /var and /usr on different partitions is so that doing a clean install to upgrade is convienent.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322353">
				<div id="div-comment-322353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322353">
			November 15, 2005 at 5:47 pm</a>		</div>

		<p>Sysprep would be one of the WORST Microsoft programs to open source.<br />
<br />It does too much low level voodoo to open source. Raymond would have blog entries (and nightmares) for the next decade if third party developers started copying &quot;good&quot; ideas from an open sysprep.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322363">
				<div id="div-comment-322363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Moz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322363">
			November 15, 2005 at 6:04 pm</a>		</div>

		<p>The reason I always do a clean install (server or desktop) is that I keep the old boot disk as insurance in case the upgrade fails. If anything goes wrong, or we run out of time, or whatever, we just boot it off the old disk and we&#8217;re exactly back where we started. Disks are cheap compared to my time. Although now I&#8217;m using mirrored boot disks in most boxes I can afford to risk one of them, I still haven&#8217;t tried the upgrade approach.</p>
<p>Mind you, I&#8217;m a custom install fan, and upgrade relatively infrequently, so there tend to be now program versions too. Vista will be like this I think &#8211; so many things will have a Vista version that it&#8217;s probably not going to be worth upgrading the OS, then reinstalling/upgrading all my software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322113">
				<div id="div-comment-322113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adminfoo.net' rel='external nofollow' class='url'>Bryan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322113">
			November 15, 2005 at 11:02 am</a>		</div>

		<p>I&#8217;m pretty curious about this &#8211; although it hasn&#8217;t been explicitly said, the article seems to suggest that Sysprep is the dominant method of setting up Windows *servers*.</p>
<p>Is that really true? My own experience is that Sysprep/Ghost (and Ghost-like) methods are extremely common with desktop systems, but *not* so common with server systems, which tend to be installed via the manual install or unattended methods.</p>
<p>Or am I in the 10%?</p>
<p>(FWIW, I totally agree that no server admin I know would trust an upgrade install for production use &#8211; we&#8217;ve all been burned at least once by upgrade installs! It&#8217;s possible that upgrades work great by now, but server admins tend to be pretty cautious, once burned twice shy kind of people.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322373">
				<div id="div-comment-322373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322373">
			November 15, 2005 at 9:11 pm</a>		</div>

		<blockquote><p>
  The dogfood is back.</p>
<p>Although that&#8217;s a paragraph by itself, it looks like it&#8217;s referring to Vista.  If so, then who dogfooded the checked build of Vista beta 1?  How many months did it take to install?  I&#8217;m installing on a Pentium III 600 MHz with 320 MB of RAM and 17 GB partition (originally empty).  The first two phases and reboots went quickly.  After that, mscorsvw.exe has been using 90% of the CPU time for 53 days so far.  Although the RAM is close to minimal, it&#8217;s enough, since mscorsvw.exe is taking 90% of the CPU time and not waiting for paging operations.  Please ask the dogfooder(s) how many more months I should wait?</p>
<p>And when it finishes, will it let me log in to configure a fixed IP address on the LAN card and then activate, or will it insist on a catch 22 that I activate before logging in?  Most MSDN stuff has a grace period of 60 days, which is just 1 week away now.</p>
<p>In exchange for this issue, Mr. Chen will probably be glad to read the next one:</p>
<p>Tuesday, November 15, 2005 11:50 AM by James Schend<br />
  <br />&gt; We ended up having to buy a $50 CD drive<br />
  <br />&gt; because Windows XP Setup loads USB drivers<br />
  <br />&gt; sometimes, and then sometimes it doesn&#8217;t.</p>
<p>I can beat you.  My latest PC has a $50 DVD drive (if you&#8217;re talking US dollars).  It&#8217;s IDE not even USB.  KNOPPIX 4.0.2 booter loads ATA drivers sometimes, and then sometimes it doesn&#8217;t.  It starts booting, it finds its own DVD and starts loading its own kernel modules, and then hangs because it can&#8217;t find its own kernel modules any more.  If the drive is jumpered for master then Knoppix gets that far and gives an error about /dev/hda.  If the drive is jumpered for slave then Knoppix gets that far and gives an error about /dev/hdb.  So it knows where it&#8217;s coming from.  I think the DVD medium is OK because I could read it back with no error (on a different machine) and it can boot two Intel 32-bit based PCs with no trouble.  It sure looks like the same kind of inconsistency, confusing itself over what drivers it needs.</p>
<p>(Though notice that even with its failure to boot and its resuling unusability, it still doesn&#8217;t scribble all over the hard disk.)</p>
<p>Tuesday, November 15, 2005 11:41 AM by Andrea D&#8217;Alessandro<br />
  <br />&gt; You can check the Bob Supnik paper &quot;Bug,<br />
  <br />&gt; Feature, or Code Rot? Adventures in OS<br />
  <br />&gt; Debugging&quot;</p>
<p>Oh yeah.  You couldn&#8217;t even upgrade Dungeon 2.6 to 3.0.  You had to reinstall. ^u^
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322283">
				<div id="div-comment-322283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian Kemp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322283">
			November 15, 2005 at 2:19 pm</a>		</div>

		<p>Windows&#8230;I only upgrade when it&#8217;s on top of the current version.</p>
<p>Otherwise, everything gets wiped.  A plain install is just easier, keeps the cruft that windows installs too often get clean.</p>
<p>Ever tried to do surgery on a registry after an upgrade?  *shudder*</p>
<p>Open BSD is reinstalled&#8211;site.tgz is awesome for that. ;)</p>
<p>The Ubuntu boxes I have, however, get apt-get dist-upgrade.</p>
<p>I&#8217;ve had a dist-upgrade work so well it fixed locale information I accidentally destroyed (and I&#8217;m fairly sure I had the option to keep my broken settings)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322383">
				<div id="div-comment-322383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://vamitra.blogspot.com' rel='external nofollow' class='url'>vamitra</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322383">
			November 15, 2005 at 10:46 pm</a>		</div>

		<p>Personally, i do not upgrade on desktop because of third party applications. And the other reason is that, using automated installs, along with AD or SMS based software deployment makes it much simpler and less time consuming than any upgrade.</p>
<p>On the servers though, it is almost always paranoia, from 2K to 2K3 it was IIS settings, certified drivers from dell (in my case), recommendation from server manafacturers to upgrade firmware, drivers etc. ahead of time. Which almost always make the upgrade more complicated. AND most of all, it is easier to transfer settings/permissions/scripts than to fix them when an unexpected failure occurs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322393">
				<div id="div-comment-322393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.weatherley.net' rel='external nofollow' class='url'>JamesW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322393">
			November 15, 2005 at 11:10 pm</a>		</div>

		<p>&quot;We routinely upgrade Linux and OS X systems because the process is reliable&quot;</p>
<p>There&#8217;s been a Linux reply, so here&#8217;s an OS X one. I just don&#8217;t trust simple upgrades either &#8211; not that I&#8217;ve even tried them, they just give me a bad feeling! However, OS X has the really nice &#8216;Archive and Install&#8217; option. It works like this: all the non-OS data is left alone; the old OS stuff is moved to a backup folder; the new OS is clean installed. The pleasing result is: all your users are still there and untouched; the OS is virgin clean and all those little customisations you made to various config files are automatically backed up, letting you restore your tweaks as need be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322413">
				<div id="div-comment-322413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mbwardle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322413">
			November 15, 2005 at 11:22 pm</a>		</div>

		<p>We don&#8217;t upgrade because upgrades don&#8217;t work!</p>
<p>Operating system developers need to spend more time testing upgrades, not less.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322423">
				<div id="div-comment-322423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeremy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322423">
			November 16, 2005 at 12:29 am</a>		</div>

		<p>Matt &#8211; There is hardly voodoo magic in Sysprep. Sysinternals even has a similar tool to Sysprep for changing SIDs that has full source available, except it really isn’t geared for Sysprep&#8217;s level of system cloning. If you think open source projects need to be simple, please refer to emacs, the linux kernel, and even WIX. There are open source shell replacements for windows that have nearly 100% coverage of explorer&#8217;s features while adding new features of their own. I reiterate sysprep would be a wonderful open source candidate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322433">
				<div id="div-comment-322433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322433">
			November 16, 2005 at 7:07 am</a>		</div>

		<p>As always, this was a well-reasoned and well-written article.  I have one small issue with Windows server installs in general: why is it so impossible to boot the installer over the network?  Analogous processes would be jumpstarting a Solaris box or netbooting the OpenBSD installer</p>
<p>Microsoft employees, in their &quot;doing IT our way&quot; road show, described how every production server has a PE cd inserted for building and recovery (and why is PE so underdocumented?).</p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322443">
				<div id="div-comment-322443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bw</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322443">
			November 16, 2005 at 7:51 am</a>		</div>

		<p>i hate this god damn windows anyway, i cant customize it, becouse some jerk decided that probably i would need some features, for example</p>
<p>SendTo Menu -&gt; Send to Floppy</p>
<p>if you&#8217;re so smart, tell me, how to remove it, becouse it seems it&#8217;s hardcoded in the shell32.dll</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322463">
				<div id="div-comment-322463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322463">
			November 16, 2005 at 9:14 am</a>		</div>

		<p>It&#8217;s not just that we don&#8217;t upgrade when we install a new version of Windows on the desktop because the experience has been so horrendous in the past, it&#8217;s that we don&#8217;t even do a clean install of the new version until the hardware breaks down because of the fear that loads of things won&#8217;t work. With what we had before at least we&#8217;ve learned what doesn&#8217;t work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322453">
				<div id="div-comment-322453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weatherley.net' rel='external nofollow' class='url'>JamesW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322453">
			November 16, 2005 at 8:30 am</a>		</div>

		<p>&#8216;SendTo Menu -&gt; Send to Floppy&#8217;</p>
<p>What OS are you using. I&#8217;m on XP SP2 and the SendTo menu only has what I want in it &#8211; including my favourite a shortcut to SendTo itself. Take a look in:</p>
<p>Docu..&amp;&#8230;tings/&lt;user&gt;/SendTo/   (*)</p>
<p>and see what&#8217;s in it.</p>
<p>(*) I HATE the outrageously long folder name too. &#8216;/usr&#8217; or &#8216;/Users&#8217; and &#8216;cd ~&#8217; please.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322593">
				<div id="div-comment-322593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322593">
			November 16, 2005 at 6:17 pm</a>		</div>

		<p>[Begin rambling anecdotes]</p>
<p>About a decade ago, I worked for a very large company&#8217;s headquarters in their IS department, doing basic PC maintenance throughout the building.  They had about a thousand PCs (give or take) at the time; no doubt they have more today.  And at the time, the company had the policy that each department was responsible for paying for its own PCs &#8212; they all had to be bought through IS, but IS didn&#8217;t have a PC budget:  Individual departments did.</p>
<p>This meant that the individual departments (and sometimes individual employees) would be responsible for deciding what we would do to their computers:  Upgrade, replace, or the horror that was trickle-down (boss gets a new computer; his secretary gets his old one; her friend from accounting gets her old one; his old one goes to the intern; the intern&#8217;s goes to the temp guy&#8230; etc.).  In my time there, I installed dozens of apps and at least three OSes, several thousand times.</p>
<p>My experience was that most OS installs don&#8217;t work right until the third time, and all upgrades NEVER work right.  I can remember as far back as being forced to install Win3.1 on brand-new Compaq &#8216;386es where the installer would guaranteeably crash and reboot at semi-random intervals.</p>
<p>Since then, I&#8217;ve installed a *lot* of software, and you guys at Microsoft have improved your OS installers somewhat.  But, even so, the rule of thumb that the install doesn&#8217;t work until the third time you try it is *still* true:  Even when installing WinXP, I&#8217;ve encountered major glitches with PCI support, or with the USB system being broken, or with the built-in video or sound drivers producing a BSOD, right out of the box.  And this applies to many different computers from many different manufacturers:  This very computer, whose hardware is a mere six months old, has no power-management support in Windows, because setup would BSOD five minutes into booting the CD if I enabled power-management in the BIOS.  (Seems to be a bug in Setup&#8217;s drivers for PCI Express.)</p>
<p>[End rambling anecdotes]</p>
<p>I think my point is that while I&#8217;ll eventually install Vista just like so many others here, I&#8217;m going to (as usual) expect it to burst into flames the first few times I try to install it, because that&#8217;s simply what I&#8217;ve come to expect from Windows installers.  Maybe Vista&#8217;s installer will be better; maybe it&#8217;s been improved:  But Microsoft&#8217;s reputation precedes it on this one, and it&#8217;s a reputation of &quot;crash-and-burn.&quot;</p>
<p>That said, I&#8217;ve done a lot of Linux installs too, and while they&#8217;ve gotten a lot better than the all-night 36-hour install-a-thon I did in 1995, they still have a ways to go too. ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-322663">
				<div id="div-comment-322663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick Lamb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322663">
			November 17, 2005 at 5:38 am</a>		</div>

		<p>A few years ago now Red Hat shipped a version of their OS installer (Anaconda) which couldn&#8217;t handle NTFS partitions. It didn&#8217;t ignore them, or accidentally reformat them or anything like that, it just crashed. I think you got a Python backtrace or something equally useless.</p>
<p>And the reason seems to have been exactly what&#8217;s described here. lots of Red Hat&#8217;s customers (especially desktop users) dual-boot Windows, but Red Hat&#8217;s engineers aren&#8217;t running Windows, so they never saw the trouble during testing.</p>
<p>FWIW I&#8217;ve done a lot of Red Hat upgrades and they were very good, definitely better value than the install &amp; restore dance.  I think the earlier poster was correct to cite package management integration as a key issue here. Microsoft&#8217;s OS upgrades probably work a lot better if you only use Microsoft software, but who does that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-322963">
				<div id="div-comment-322963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-322963">
			November 18, 2005 at 7:18 am</a>		</div>

		<p>You know, Sean W. seems right on the money. Now that I think back, my brand new gaming box required that I restart the XP install about 3 times before it &quot;took&quot;.</p>
<p>In this case, none of it was the installers fault. It was fighting the fact that the shop had plugged my SATA drive into the wrong socket. Some other USB incompatability I cant quite recall, and, finally, a bundled Symantic firewall that came with the PC that caused it to bluescreen anytime any app &#8211; incluidng the upgrade wizard &#8211; tried to access the internet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-323183">
				<div id="div-comment-323183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-323183">
			November 19, 2005 at 6:09 pm</a>		</div>

		<p>The only time I ever did an upgrade install was when we were running SBS.  In that case you are sort of forced to do it.  Now I always do clean installs to remove all the old junk that has built up on the machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-323193">
				<div id="div-comment-323193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.livejournal.com/users/merle_/' rel='external nofollow' class='url'>Merle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-323193">
			November 19, 2005 at 8:50 pm</a>		</div>

		<p>No kidding.</p>
<p>Upgrades mean &quot;leave all sorts of stuff around and hope it doesn&#8217;t cause problems&quot;.  If you&#8217;re dealing with servers, and you have the time, clean installs are obviously safer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-323233">
				<div id="div-comment-323233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-323233">
			November 21, 2005 at 12:30 am</a>		</div>

		<p>i upgrade servers all the time.</p>
<p>I&#8217;ve had a couple fail, but for the most part it works just fine.  It does take some care and feeding to take care of lingering errors and unused software.</p>
<p>but to state &quot;nobody upgrades their server&quot; is wrong.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-493023">
				<div id="div-comment-493023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mattjp.wordpress.com/2005/12/14/sysprep-server-deployment-and-pain/' rel='external nofollow' class='url'>Sysprep, Server Deployment and Pain &laquo; Soda Water</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20051115-13/?p=33333#comment-493023">
			April 14, 2007 at 2:48 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://mattjp.wordpress.com/2005/12/14/sysprep-server-deployment-and-pain/" rel="nofollow">http://mattjp.wordpress.com/2005/12/14/sysprep-server-deployment-and-pain/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

