<html>
<head>
<title>Where did my mail control panel icon go?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Where did my mail control panel icon go?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>September 29, 2010 / year-entry #275</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>35</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer ran into the following problem: I was trying to add another email account to Outlook, and the instructions say that I should go to the mail icon in the Control Panel, which to my surprise is nowhere to be found! How can I figure out what went wrong? A little bit of psychic...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer ran into the following problem:</p>
<blockquote class="q"><p> I was trying to add another email account to Outlook, and the instructions say that I should go to the mail icon in the Control Panel, which to my surprise is nowhere to be found! How can I figure out what went wrong? </p>
</blockquote>
<p> A little bit of psychic debugging will solve this. </p>
<p> The customer was running Windows&nbsp;Vista, 64-bit edition. On 64-bit versions of Windows&nbsp;XP and Windows&nbsp;Vista, the Control Panel shows only 64-bit control panels. The 32-bit control panels are off in a separate 32-bit control panel, which you can find by <a href="http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2007/03/23/9176.aspx"> clicking the <i>View 32-bit Control Panel Items</i> icon</a>. </p>
<p> The separation of 32-bit and 64-bit control panels is an unfortunate consequence of the rule that 64-bit processes cannot load 32-bit DLLs and vice versa. On 64-bit Windows, Explorer is a 64-bit process, which means that it can't load traditional 32-bit control panels. (Recall that <a href="http://blogs.msdn.com/oldnewthing/archive/2003/12/26/45979.aspx"> control panel applications run as DLLs inside the host process</a>.) Therefore, Explorer has to pass off the work of working with 32-bit control panel applications to a 32-bit alter ego process. </p>
<p> Fortunately, Windows&nbsp;7 no longer segregates control panel applications by bitness: They all appear in the main Control Panel. This was done by running a puppet 32-bit copy of the Control Panel behind the scenes and making the puppet do the main Control panel's bidding whenever it needed to access information about 32-bit control panel applications. </p>
<p> "Hey, go enumerate the 32-bit control panel applications for me." </p>
<p> "Hey, go get the icon for this 32-bit control panel application." </p>
<p> "Hey, go launch this 32-bit control panel application." </p>
<p> "Hey, go make me a sandwich." </p>
<p> "Hey, give me a backrub." </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (35)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-864103">
				<div id="div-comment-864103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MikeCaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864103">
			September 29, 2010 at 7:18 am</a>		</div>

		<p>Obligatory XKCD: <a rel="nofollow" target="_new" href="http://xkcd.com/149/" rel="nofollow">http://xkcd.com/149/</a></p>
<p>&quot;Hey, go make me a sandwich.&quot;</p>
<p>&quot;No.&quot;</p>
<p>&quot;Sudo, hey, go make me a sandwich.&quot;</p>
<p>&quot;Okay!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864113">
				<div id="div-comment-864113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tsrblke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864113">
			September 29, 2010 at 7:19 am</a>		</div>

		<p>Obligatory XKCD reference: Sudo Make me a sandwhich. &nbsp;(I assume you were already going there, but I must state teh obvious.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864123">
				<div id="div-comment-864123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864123">
			September 29, 2010 at 7:27 am</a>		</div>

		<p>Obligatory question; why does a 32-bit dll need to be loaded just to display shortcuts in the Control Panel? Surely the only point at which the dll needs to be loaded is when the user actually clicks on an item to launch the dialog process.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864133">
				<div id="div-comment-864133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anders</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864133">
			September 29, 2010 at 7:36 am</a>		</div>

		<p>Are the sandwich and backrub functions going to be exposed in a public API in future versions of Windows?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864143">
				<div id="div-comment-864143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864143">
			September 29, 2010 at 7:37 am</a>		</div>

		<p>@James If the Control Panel API requires that the control panels be loaded when Control Panel is opened, they have to be loaded. &nbsp;You don&#39;t know what black magic they&#39;re going to do behind the scenes that completely breaks when you don&#39;t load them as they expect.</p>
<p>At the very least I think you have to load them to get localized names of the panels out of the DLL resources&#8230; not sure, I don&#39;t do much with DLL resources.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864153">
				<div id="div-comment-864153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jules</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864153">
			September 29, 2010 at 7:38 am</a>		</div>

		<p>@James &#8211; they aren&#39;t shortcuts. &nbsp;The way the control panel icons are found is by loading all the relevant DLLs (from a list in the registry), asking them how many icons they have and then asking for the details of each one in turn.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864163">
				<div id="div-comment-864163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864163">
			September 29, 2010 at 7:40 am</a>		</div>

		<p>Why does Control Panel expect the user to know whether the widget he/she is going to run to add a mail account is a 32 bit or a 64 bit widget? &nbsp;</p>
<p>&quot;Hey, go make me a sandwich&quot;</p>
<p>&quot;What&#39;s the latin name for wheat?&quot;</p>
<p>&quot;I don&#39;t know&quot;</p>
<p>&quot;Well, go boil your head!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864173">
				<div id="div-comment-864173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864173">
			September 29, 2010 at 7:41 am</a>		</div>

		<p>@James,</p>
<p>If I remember correctly, the icon is returned by the DLL callback. Also, all DLLs have to be loaded. It makes that big PITA to uninstall the control panel provider DLL.</p>
<p>The whole 64/32 bit control panel segregation debacle is just another case of Vista half-assedness. W7 FTW.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864183">
				<div id="div-comment-864183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864183">
			September 29, 2010 at 7:42 am</a>		</div>

		<p>@James: Because the CPlApplet interface allows for dynamic enumeration of Control Panel items. Until you know what&#39;s available (remember that icons like &quot;386 Enhanced&quot; didn&#39;t appear unless you were actually running 3.x in 386Enh mode), you don&#39;t know what icons to load. And since developers would have been quite annoyed if their simple message-based Control Panel applets from 3.1x had to become COM Explorer namespace extensions in 95, they kept the interface around.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864203">
				<div id="div-comment-864203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Don Reba</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864203">
			September 29, 2010 at 8:03 am</a>		</div>

		<p>@MikeCaron</p>
<p>runas/user:Administrator Make me a sandwhich!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864213">
				<div id="div-comment-864213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864213">
			September 29, 2010 at 8:22 am</a>		</div>

		<p>I was bitten by this about a month ago. Had to search the internets for the solution. The whole thing begs the question &#8211; why does creating a new account in Outlook involve going to the Control Panel? There are many solutions that are more user-friendly:</p>
<p>1) Let me create an account in Outlook itself &#8211; what&#39;s the big deal?</p>
<p>2) When I try to add an account in Outlook, launch the Control Panel applet for me</p>
<p>3) If there is simply no way to create a new account while Outlook.exe is running, make a shortcut &quot;Create new account&quot; in the start menu</p>
<p>4) If the work absolutely has to be done by a 32-bit DLL, make a 64-bit wrapper for it in the Control Panel that can launch the real one with rundll32</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864223">
				<div id="div-comment-864223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vaidotas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864223">
			September 29, 2010 at 8:29 am</a>		</div>

		<p>Hey but there is no 32-bit ODBC icon in Administration tools of Control panel in Windows 7 64-bit :).</p>
<p>So the merge is only in Control panel?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864263">
				<div id="div-comment-864263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864263">
			September 29, 2010 at 10:06 am</a>		</div>

		<p>Ivo: You will have to complain to the Outlook team for all this. Office 2010 is 64-bit now anyway, though there is still a 32-bit version.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864273">
				<div id="div-comment-864273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864273">
			September 29, 2010 at 10:08 am</a>		</div>

		<p>It&#39;s always bothered me that if I haven&#39;t opened the Control Panel in a while, it takes a significant amount of time (like 5-10 seconds at least) for Windows to enumerate all of the Control Panel icons, presumably because it&#39;s either loading all of the DLLs, or paging them in from disk if they were already loaded but paged out. &nbsp;This is on XP; I don&#39;t know if the situation has improved on Vista or 7.</p>
<p>I&#39;m not sure how to solve this problem (other than redesigning the Control Panel from scratch, which isn&#39;t going to happen). &nbsp;Maybe some sort of caching scheme where Windows remembers the icons from the last time you opened the Control Panel, and it displays that cached list immediately while it waits for the actual enumeration to complete behind the scenes?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864283">
				<div id="div-comment-864283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864283">
			September 29, 2010 at 10:09 am</a>		</div>

		<p>&quot;Vista half-assedness. &quot;</p>
<p>It had existed from the beginning of 64-bit Windows on IA-64, I think</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864293">
				<div id="div-comment-864293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Falcon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864293">
			September 29, 2010 at 10:14 am</a>		</div>

		<p>A third-party file manager uses a similar trick &#8211; it&#39;s a 32-bit app, but uses an auxiliary 64-bit program to allow access to 64-bit shell extensions (it lists them in an &quot;X64&quot; submenu).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864303">
				<div id="div-comment-864303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864303">
			September 29, 2010 at 10:37 am</a>		</div>

		<p>I guess the separate 32-bit control panel folder came about due to a chain of unfortunate events. When it was introduced, only advanced users would be affected by it. When Vista came about, priorities shifted away and no one fixed it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864313">
				<div id="div-comment-864313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864313">
			September 29, 2010 at 10:38 am</a>		</div>

		<p>Yuhong Bao: I know I should complain to the Office team, but I&#39;m hoping they read Raymond&#39;s blog. It is an excellent resource for all Win32 developers :)</p>
<p>I&#39;m also afraid they will just say: &quot;32-bit installers can&#39;t install 64-bit Control Panel items, go complain to the MSI team&quot;. The MSI team will say &quot;The 64-bit shell doesn&#39;t let us access it from our 32-bit code, go complain to the Shell team&quot;. Back to square 1 :)</p>
<p>BTW, the MSDN download page for Office says:</p>
<p>Important: Microsoft strongly recommends the use of 32-bit (x86) versions of Office 2010, Project 2010, Visio 2010, and SharePoint Designer 2010 applications as the default option for all platforms.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864343">
				<div id="div-comment-864343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Angry user</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864343">
			September 29, 2010 at 12:46 pm</a>		</div>

		<p>So MS is denying its users to see which Control Panel applets are native 64-bit and which are 32-bit? Also, what is this extremely evil non-sense decision about not allowing users to run the 32-bit version of Windows Explorer as a file manager or as the shell in 64-bit editions of Windows 7.? 64-bit editions of Windows Vista and Windows XP allowed executing the 32-bit shell/Windows Explorer and making it the default for compatibility with shell extensions. All my 32-bit only shell extensions, some of which used to work but development abandoned are incompatible with 64-bit versions of Windows 7. Another example of things working even in Vista but broken in 7. Give me back my money or give me back 32-bit shell in 64-bit Windows. Imagine if the IE team did the same EVIL and completely removed IE 32-bit from 64-bit Windows 7. SP1 sadly doesn&#39;t fix this, this is I guess by design. Moronic stupid evil design or some shell guys who screwed up plenty of other shell features too. Till RC, 32-bit shell worked, so clearly someone wanted to spoil the experience for RTM. MS owes at least a note of this change somewhere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864353">
				<div id="div-comment-864353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miral</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864353">
			September 29, 2010 at 1:54 pm</a>		</div>

		<p>@Ivo: The control panel provides a subset of the UI in Outlook&#39;s own account management pages. &nbsp;(At least for Outlook 2007. &nbsp;It&#39;s possible that things are different for other versions, especially Express.)</p>
<p>@Angry user: On Win7, the control panel shows &quot;Mail (32-bit)&quot;, making it pretty obvious that it&#39;s a 32-bit control panel. &nbsp;Not that standard users will care. &nbsp;As Raymond said, W7 got it right. &nbsp;Also: don&#39;t use abandoned or broken shell extensions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864363">
				<div id="div-comment-864363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864363">
			September 29, 2010 at 2:12 pm</a>		</div>

		<p>And how did something like this get past any kind of interface design review? Splitting the control panel into two pieces based on something as user-meaningless as 32-bit vs 64-bit? Architecture might require they be segregated behind the scenes, but surely there&#39;s no excuse for exposing that split to the user?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864383">
				<div id="div-comment-864383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864383">
			September 29, 2010 at 2:43 pm</a>		</div>

		<p>@Miral: From what I remember, it was impossible to add an Exchange account from inside Outlook. When I ran Outlook for the first time it asked me about my account and connected fine. Then a year later I switched companies and wanted to switch my account. I deleted the old one and tried to add the new one. I got a message that I have to go to the Control Panel and look for Mail. But just like the user in Raymond&#39;s story, it wasn&#39;t there!</p>
<p>@Simon: Since it was fixed in Windows 7, I&#39;m assuming the fix was deemed to be too expensive or unimportant to include in the Vista build. But I&#39;m glad that the forces of good (and sanity) prevailed in the end :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864403">
				<div id="div-comment-864403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrismcb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864403">
			September 29, 2010 at 3:28 pm</a>		</div>

		<p>And this is why you don&#39;t let technology drive the design.</p>
<p>Some dev or pm must have said &quot;Explorer is a 64-bit process, which means that it can&#39;t load traditional 32-bit control panels.&quot; Except that it is possible, otherwise Win7 wouldn&#39;t be &quot; running a puppet 32-bit copy of the Control Panel behind the scenes &quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864443">
				<div id="div-comment-864443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">benjamin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864443">
			September 29, 2010 at 4:20 pm</a>		</div>

		<p>Hasn&#39;t the &#39;Add Account&#39; option been under Tools in Outlook since like OL2K?</p>
<p>Also, Falcon&#39;s comment about the X64 menu finally explained this weird problem I&#39;ve noticed in [3rd party file manager] not displaying the context menu for [popular open source compression program].</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864453">
				<div id="div-comment-864453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864453">
			September 29, 2010 at 4:30 pm</a>		</div>

		<p>benjamin: No, you can&#39;t add a new Exchange account from Outlook. When you try to do it you get a message:</p>
<p>&quot;A new Microsoft Exchange account cannot be manually configured while Outlook is running. To add a manually configured account, exit Outlook. In Control Panel, open Mail, and then click E-mail Accounts.&quot;</p>
<p>You can add POP3, SMS or Hotmail accounts just fine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864463">
				<div id="div-comment-864463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864463">
			September 29, 2010 at 4:41 pm</a>		</div>

		<p>Explorer already runs shell extensions in a separate process. Why this process (or an additional process) cannot be 32-bit is only because shell team is lazy. As control panel has shown, it&#39;s clearly possible to do.</p>
<div class="post">[<i>Only certain shell extensions run in a separate process. Most shell extensions cannot be run in a separate process for compatibility reasons. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864493">
				<div id="div-comment-864493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864493">
			September 29, 2010 at 6:31 pm</a>		</div>

		<blockquote><p>
  Office 2010 is 64-bit now anyway.
</p></blockquote>
<p>Yes, and I&#39;m glad I prepared for it before it happened, so when it did happen I only had to go fix a bug in my preparedness.</p>
<p>On a related note, it&#39;s freaky when you attach to process without source, see the disassembly, and immediately know what the problem is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864503">
				<div id="div-comment-864503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Angry user</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864503">
			September 29, 2010 at 6:45 pm</a>		</div>

		<p>@Miral, easy to give advice. Read clearly. I am not using broken or obsolete shell extensions, I was using perfectly working 32-bit shell extensions which were unmaintained nnd have not been updated for 64-bit but working well. Windows 7 64-bit broke all of these by not allowing a 32-bit Explorer and now I am forced to use 32-bit Windows 7 or 64-bit Vista.</p>
<p>Also, do all 32-bit Control Panel icons indicate in the mixed Control Panel that they&#39;re 32-bit? I think not. I am not saying separate Control Panels are better but MS can easily have them included in the same namespace but under different group headers.</p>
<p>Shell team, please fix both these in SP1 or Windows 8. You can&#39;t kill all 32-bit shell extensions, especially if future Windows is 64-bit only. That&#39;s plain evil and a massive inconvenience. Please note that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864523">
				<div id="div-comment-864523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DriverDude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864523">
			September 29, 2010 at 8:57 pm</a>		</div>

		<p>Next thing you know, they&#39;ll be running a puppet 32-bit operating system in a VM behind the scenes and making the puppet do&#8230; oh, wait, that&#39;s been done.</p>
<p>Seems like there isn&#39;t anything that can&#39;t be solved with an additional layer of indirection, shims, wrappers and/or virtual machines.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matteo odd alt thread-odd thread-alt depth-1" id="comment-864433">
				<div id="div-comment-864433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864433">
			September 29, 2010 at 4:04 pm</a>		</div>

		<p>@chrismcb: I don&#39;t understand your point.</p>
<p>&quot;Explorer is a 64-bit process, which means that it can&#39;t load traditional 32-bit control panels&quot;: well, this *is* true.</p>
<p>&quot;Except that it is possible&quot;: nope. 64 bit explorer *can&#39;t* load traditional 32-bit CPLs, in facts a *separate* 32 bit process has to be started, and it&#39;s *this* process that loads the legacy CPLs, doing to them what the 64 bit control panel tells him via IPC.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864543">
				<div id="div-comment-864543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864543">
			September 30, 2010 at 12:19 am</a>		</div>

		<p>How do you report a WOW64 issue to Microsoft? &nbsp;I ran into what I think is a bug: SHOpenFolderAndSelectItems doesn&#39;t highlight the target item when executed from WOW64. &nbsp;It returns 0x80040155 (interface not registered) to 32-bit programs. &nbsp;It opens the correct folder, but doesn&#39;t highlight the target item. &nbsp;When recompiling for x86-64, it works fine. &nbsp;This is on Win7 Professional x64 RTM LDR. &nbsp;This error also occurs for a .NET example program if I use /platform:X86.</p>
<p>By the way, regarding CommandLineToArgvW, it has another problem for people trying to use it: the created &quot;argv&quot; array does not have a null terminator; that is, the expected truth argv[argc] == NULL is not true and in fact reads past the end of argv. &nbsp;The CommandLineToArgvW thread is locked to new comments already.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864553">
				<div id="div-comment-864553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864553">
			September 30, 2010 at 12:26 am</a>		</div>

		<p>And on the subject of quickly-locked threads, /LARGEADDRESSAWARE actually does work on a 64-bit program; the linker just sets it by default. &nbsp;If you do /LARGEADDRESSAWARE on an x64 program, it will only have access to the low 2 GB of address space even though it&#39;s a 64-bit program. =^_^=</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864513">
				<div id="div-comment-864513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864513">
			September 29, 2010 at 8:07 pm</a>		</div>

		<p>@AU: Why should technical details place limitations on the presentation of something? Whether a Control Panel applet is 32- or 64-bit makes *absolutely no difference* for the vast majority of users (in fact, I would venture to say &quot;for everyone other than you&quot;). If you care so much about whether it&#39;s a 32- or 64-bit applet, go locate the associated file (it&#39;s really not hard to find) and check. The rest of us can get by without having to think about an utterly irrelevant (in this context) distinction every time we want to use something from the control panel.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-864563">
				<div id="div-comment-864563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864563">
			September 30, 2010 at 3:27 am</a>		</div>

		<p>Outlook 2003 on Windows XP actually gave you convenient access to the mail setup from the Start menu. Another thing that was broken by Vista?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-864573">
				<div id="div-comment-864573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100929-00/?p=12703#comment-864573">
			September 30, 2010 at 3:29 am</a>		</div>

		<p>Windows XP and Outlook 2003 conspired to give you easy access to Mail Setup from the Start menu.</p>
<p>Sorry if this is a duplicate post but posts take so long to submit these days :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

