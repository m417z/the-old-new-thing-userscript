<html>
<head>
<title>Is it real that you are still using Visual C++ 6 and 5?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Is it real that you are still using Visual C++ 6 and 5?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 7, 2010 / year-entry #166</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>40</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Commenter Sys64738 points out that Bjarne Stroustrup's Web site says that "Literally everything at Microsoft is built using various flavors of Visual C++ - mostly 6.0 and 7.0 but we do have a few holdouts still using 5.0 :-(" and wonders if it's true. Well, let's see. Visual C++ 6 came out in 1998 and...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Commenter Sys64738 points out that  Bjarne Stroustrup's Web site says that "<a href="http://web.archive.bibalex.org/web/20071011225313/http://public.research.att.com/~bs/applications.html" _href="http://www.research.att.com/~bs/applications.html">Literally everything at Microsoft is built using various flavors of Visual C++ - mostly 6.0 and 7.0 but we do have a few holdouts still using 5.0 :-(</a>" and <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/05/23/407234.aspx#1498788"> wonders if it's true</a>.</p>
<p> Well, let's see. Visual C++ 6 came out in 1998 and doesn't support <a href="http://msdn.microsoft.com/en-us/library/8dbf701c.aspx"> the /GS flag</a>, nor does it support various replacement functions like <code>strcpy_s</code>. This makes it hard for anything compiled with Visual C++ 6 to conform to Microsoft's Security Development Lifecycle which <a href="http://msdn.microsoft.com/en-us/magazine/cc163705.aspx"> requires all code to be compiled with /GS</a> and <a href="http://msdn.microsoft.com/en-us/library/bb288454.aspx"> bans functions like <code>strcpy</code></a>. </p>
<p> As a result, I would suspect that the statement is no longer true. It may have been mostly true when the statement was originally written in the late 1990's, but things have changed a lot since then. </p>
<p> (The statement wasn't even 100% true when it was written, because <a href="http://technet.microsoft.com/en-us/magazine/cc742531.aspx"> Windows&nbsp;95 used a special version of the compiler not found in nature</a> for selected portions of the operating system.) </p>
<p> I find it interesting that the fact that the claim appeared on Bjarne Stroustrup's Web site caused the reader to turn off all brain functions responsible for critical evaluation of information. It is unlikely that Mr.  Stroustrup has first-hand knowledge of the information on that page; it's almost certainly just  a compilation of information reported to him by unnamed sources. (Actually, he even says as much in the opening paragraphs.) And do you honestly think that Visual Studio 2010 is compiled with Visual C++ 6? </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (40)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-837653">
				<div id="div-comment-837653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JS Bangs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837653">
			June 7, 2010 at 7:21 am</a>		</div>

		<p>This reminds me of a comment that I found at the website of a prominent open-source advocate, which claimed that Microsoft doesn&#39;t use source control for any of its Windows development.</p>
<p>Seriously, where do people get this stuff?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837673">
				<div id="div-comment-837673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837673">
			June 7, 2010 at 7:48 am</a>		</div>

		<p>VC6+Visual Assist X+WndTabs FTW (everyone said vc10 was the next vc6, it&#39;s not)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837683">
				<div id="div-comment-837683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837683">
			June 7, 2010 at 7:52 am</a>		</div>

		<p>I think the idea that MS still uses VC6 internally was because the Windows Driver Development Kit required VC6 due to changes in the name-mangling of later VC++ compilers. &nbsp;This statement comes from when I was looking at writing a driver just a few years ago, and I don&#39;t know if it&#39;s true any more given the software policies as reported by Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-leo-davidson odd alt thread-odd thread-alt depth-1" id="comment-837693">
				<div id="div-comment-837693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Leo+Davidson' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837693">
			June 7, 2010 at 7:52 am</a>		</div>

		<p>I have a hunch none of Microsoft&#39;s C# apps were compiled using Visual C++ 6 either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837703">
				<div id="div-comment-837703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sumdumgai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837703">
			June 7, 2010 at 7:53 am</a>		</div>

		<p>I work in one of the largest European investment banks. We use Visual C++ 6.0 for one of our most important software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837723">
				<div id="div-comment-837723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark R.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837723">
			June 7, 2010 at 7:57 am</a>		</div>

		<blockquote><p>
  And do you honestly think that Visual Studio 2010 is compiled with Visual C++ 6?
</p></blockquote>
<p>I just read somewhere that VS2010 was compiled with Visual Basic 6. Microsoft now calls this &quot;legacy dogfooding.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837733">
				<div id="div-comment-837733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter da Silva</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837733">
			June 7, 2010 at 8:00 am</a>		</div>

		<p>I suspect this meme came about during the period when Microsoft was pushing hard to get everyone on VS.NET and everyone was going &quot;screw that, VS6 is good enough for Microsoft, it&#39;s good enough for us&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837743">
				<div id="div-comment-837743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tor Lillqvist</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837743">
			June 7, 2010 at 8:08 am</a>		</div>

		<p>I think this misconception might come from the fact that Windows code uses MSVCRT.DLL, which some people think is &quot;the MSVC6 runtime&quot;.</p>
<p>Which actually brings up a pet peeve of mine: Why is it so hard for non-Microsoft developers to build software written in plain C against MSVCRT.DLL using Microsoft&#39;s tools? (For MinGW it is the default C runtime.) For much portable software written in plain C, MSVCRT.DLL is quite sufficient, and building against it has the benefit that you don&#39;t need to bundle any C runtime with your installer. (For C++, I fully agree that you want to use something relatively-latest-and-greatest. But then personally I much prefer C# to C++ anyway.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837753">
				<div id="div-comment-837753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837753">
			June 7, 2010 at 8:13 am</a>		</div>

		<p>It&#39;s not just that the version numbers are wrong; many of those products are not written in C++. I know that WinNT/2k/XP are mostly in C, and I&#39;m pretty sure that SQL Server is also mostly in C. Of course C++ is still heavily used, but it&#39;s wrong to say that Windows is written in C++ when the kernel itself and all major DLLs are actually in C.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837783">
				<div id="div-comment-837783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837783">
			June 7, 2010 at 8:30 am</a>		</div>

		<p>Gabe: &nbsp;That depends on how you define what Windows is.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837793">
				<div id="div-comment-837793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837793">
			June 7, 2010 at 8:52 am</a>		</div>

		<p>IIRC, Windows was compiled with the WDK tools, which exist a bit outside the Visual C++ realm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837803">
				<div id="div-comment-837803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837803">
			June 7, 2010 at 9:01 am</a>		</div>

		<p>Pretty sure that the WDK has the Visual C++ compiler (sometimes the same version, sometimes a different build revision) and other tools but different headers and libraries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837813">
				<div id="div-comment-837813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">blah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837813">
			June 7, 2010 at 9:03 am</a>		</div>

		<p>LOL. VS2010 is far too slow to have been primarily written in a real language.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837823">
				<div id="div-comment-837823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837823">
			June 7, 2010 at 9:09 am</a>		</div>

		<p>@Marquess,</p>
<p>Compiler/link toolchain is the same, though the revisions are not synchronized with VC releases.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837853">
				<div id="div-comment-837853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rsola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837853">
			June 7, 2010 at 10:51 am</a>		</div>

		<p>There is a technique to link a program directly to Msvcrt.dll, instead of MsvcrXX.dll, by using a library which comes from the Windows Driver Kit. But if you want the program be functional on versions prior to Windows Vista, you need to link another object file, and this precludes using most of the secure CRT functions, unless you put some hacks into the code. Also, a debug build wouldn&#39;t work because Msvcrtd.dll is not publicly available. Definitely, this might be useful for small in-house developed tools, but not for more complex projects.</p>
<p>Although it might be misleading sometimes, the linker version field in the PE header structure would match the Microsoft compiler version used to build a specific Microsoft file. For example, most of Windows XP, as of Service Pack 3, was built with compilers based on either Visual C++ 7.0 (matching Visual Studio .NET 2002) or Visual C++ 7.1 (matching Visual Studio .NET 2003).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837863">
				<div id="div-comment-837863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mott555</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837863">
			June 7, 2010 at 11:54 am</a>		</div>

		<p>@blah:</p>
<p>Define &quot;real&quot; language.</p>
<p><a rel="nofollow" target="_new" href="http://xkcd.com/378/" rel="nofollow">http://xkcd.com/378/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837873">
				<div id="div-comment-837873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837873">
			June 7, 2010 at 12:25 pm</a>		</div>

		<p>Offtopic:</p>
<p>I&#39;m coming to Redmond for a plugfest. If you see a man whistling a tune from, say, Mahler&#39;s 6th, that&#39;s probably me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-837883">
				<div id="div-comment-837883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837883">
			June 7, 2010 at 1:21 pm</a>		</div>

		<p>&quot;For example, most of Windows XP, as of Service Pack 3, was built with compilers based on either Visual C++ 7.0 (matching Visual Studio .NET 2002) or Visual C++ 7.1 (matching Visual Studio .NET 2003).&quot;</p>
<p>Probably depending on whether the file was from original XP or updated as part of SP2.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao even thread-even depth-1" id="comment-837893">
				<div id="div-comment-837893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837893">
			June 7, 2010 at 1:27 pm</a>		</div>

		<p>&quot;There is a technique to link a program directly to Msvcrt.dll, instead of MsvcrXX.dll, by using a library which comes from the Windows Driver Kit. But if you want the program be functional on versions prior to Windows Vista, you need to link another object file&quot;</p>
<p>Indeed, that is how MS internally does it, I think.</p>
<p>&quot;But if you want the program be functional on versions prior to Windows Vista, you need to link another object file, and this precludes using most of the secure CRT functions, unless you put some hacks into the code. &quot;</p>
<p>That is probably not a problem because MS likely internally use the Strsafe.h functions instead.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837903">
				<div id="div-comment-837903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aram Hăvărneanu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837903">
			June 7, 2010 at 2:32 pm</a>		</div>

		<p>Windows uses the WDK. It just uses Msvcrt.dll, there&#39;s no need for any hacks.</p>
<p>I use the WDK for everything, including user space code. I find Visual Studio big and slow and useless, and I particularly dislike vcbuild/msbuild. I absolutely love WDK&#39;s build.exe + nmake.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837763">
				<div id="div-comment-837763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RobertWrayUK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837763">
			June 7, 2010 at 8:19 am</a>		</div>

		<p>@Tor Lillqvist, I *think* it&#39;s because you&#39;re not supposed to&#8230; See <a rel="nofollow" target="_new" href="http://msdn.microsoft.com/en-us/library/abx4dbyh%28VS.80%29.aspx" rel="nofollow">msdn.microsoft.com/&#8230;/abx4dbyh%28VS.80%29.aspx</a></p>
<p>Specifically (about halfway down the page):</p>
<p>What is the difference between msvcrt.dll and msvcr80.dll?</p>
<p>The msvcrt.dll is now a &quot;known DLL,&quot; meaning that it is a system component owned and built by Windows. It is intended for future use only by system-level components.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837913">
				<div id="div-comment-837913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837913">
			June 7, 2010 at 4:16 pm</a>		</div>

		<p>It is known that Windows at one time used GNU make as its make program, GNU make was invoked recursively.</p>
<p>It is also known that some parts of Services for UNIX were at one time compiled with GCC.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837923">
				<div id="div-comment-837923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">X</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837923">
			June 7, 2010 at 7:56 pm</a>		</div>

		<p>strcpy_s is never a problem, there is a thing &quot;Platform SDK&quot;(i using version feb 03 or 04),</p>
<p>#include &lt;strsafe.h&gt;</p>
<p>#pragma comment(lib, &quot;strsafe.lib&quot;)</p>
<p>i think that StringCbCopy() is better than strcpy_s.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837943">
				<div id="div-comment-837943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837943">
			June 7, 2010 at 10:40 pm</a>		</div>

		<p>It&#39;s amazing how many people, and sites, and still using VC++ 6.0 (I&#39;ve joked in the past that Microsoft has two major C development suites, Visual Studio &lt;insert-current-year-here&gt; and VC++ 6.0). &nbsp;I support a globally-used piece of OSS and every couple of years I ask users whether I can disable 6.0 support, and every year I get the same chorus of replies saying &quot;Hell, no!&quot;.</p>
<p>I think the reason for VC++ 6.0&#39;s ongoing popularity is that it runs circles around any of its successors in terms of speed and responsiveness (every time I&#39;ve moved to a new version of VS I&#39;ve felt like I was wading through molasses until I got used to the slowdown), and if you&#39;re doing straight C development there&#39;s nothing really compelling in newer VS releases that outweigh the bloat that comes with them.</p>
<p>I have to admit, I still develop primarily in VC++ 6.0, optionally in VS 2005 if I need newer features. &nbsp;2008 and 2010 were just too painfully heavyweight to use. &nbsp;From informal surveys of people still on VC++ 6.0 this seems to be the general case, it&#39;s good enough for most purposes of the people using it and old enough that it hasn&#39;t succumbed to the VS bloat/molasses effect yet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837953">
				<div id="div-comment-837953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.motheyes.com' rel='external nofollow' class='url'>Joel</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837953">
			June 7, 2010 at 10:44 pm</a>		</div>

		<p>I&#39;ll observe here that nothing in the Microsoft section implies that the source is anything but a single email (probably from an MS employee), but from 6-7 years ago. I&#39;d guess it was probably a lot more true 6-7 years ago.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837963">
				<div id="div-comment-837963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837963">
			June 8, 2010 at 12:04 am</a>		</div>

		<p>We still have many use of VC6 here for old project maintainance.</p>
<p>While those project does have moved to VC2005/08, those companies (cough&#8230; banks) has bought components from much older version that&#39;s before we port-ed the source to newer compilers. They have paid renewal service contract so we can&#39;t drop those support, and under the terms we cannot change the required compiling/execution environment without their consent. (Considering my company even still have to support a few products for DOS, this is hardly surprising&#8230;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-837973">
				<div id="div-comment-837973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Teo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837973">
			June 8, 2010 at 12:24 am</a>		</div>

		<p>Before I discovered WDK, I searched the binary Windows files for clues what version of the toolchain they used. And it was fun &#8211; kind of little detective game. Now I just go to %ddk%binx86_amd64 and check the version of c2.dll :-D</p>
<p>That said, the two other major MS products &#8211; Office and SQL Server have own pace and I do not know what compiler they use. Causal observation of SQL Server 2008 makes me think it&#39;s built with VS 2005 / VC9.</p>
<p>(Offtopic rant, feel free to ignore) While VS IDES since &#39;98 are very bad for C/C++ developer, the compilers (and the other parts of the toolchain) are getting better and better. I&#39;d use vs 2008 over vs 98 any time, simply because the compiler is MUCH less buggy (in terms of bad code generation), it understands C++ (the vc6 compiler was atrocious); it generates good code &#8211; I&#39;ve seen instances where vc6 generates one screenful of code where vs2008 generates two asm instructions! And things like stack protection really helps finding bugs early in the development stage &#8211; it did this for me yesterday. For VS2010 &#8211; well, the new X++ 0x features are like heaven&#39;s gift, but the IDE is so slow that it&#39;s completely unusable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-837983">
				<div id="div-comment-837983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JamesP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-837983">
			June 8, 2010 at 5:23 am</a>		</div>

		<p>While the speed of Visual C++ is an issue, personally I&#39;ve found the tab behaviour (Goes in MRU order rather than the order of the tabs in the toolbar) and the lack of C99 support are bigger nuisances. This is Visual Studio 2008, mind, not sure if 2010 fixes any of that.</p>
<p>The way the compiler evangelises strcpy_s and kin is also a bit of an irritance, but you can shut it up easily enough.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-838033">
				<div id="div-comment-838033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838033">
			June 8, 2010 at 8:58 am</a>		</div>

		<p>VC++ 6.0 is fine if you&#39;re using C only. &nbsp;In fact in twelve years of fairly heavy use I&#39;ve never found a code-generation bug in the C subset of the compiler, which is almost unique in any compiler I&#39;ve used. &nbsp;And as you say, VS has been getting slower and slower with each release (your pain tolerance must be higher than mine, I regard 2005 as marginal and anything beyond that as completely unusable, not just the 2010 version).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-838043">
				<div id="div-comment-838043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838043">
			June 8, 2010 at 8:58 am</a>		</div>

		<p>VC++ 6.0 is fine if you&#39;re using C only. &nbsp;In fact in twelve years of fairly heavy use I&#39;ve never found a code-generation bug in the C subset of the compiler, which is almost unique in any compiler I&#39;ve used. &nbsp;And as you say, VS has been getting slower and slower with each release (your pain tolerance must be higher than mine, I regard 2005 as marginal and anything beyond that as completely unusable, not just the 2010 version).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-838083">
				<div id="div-comment-838083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838083">
			June 8, 2010 at 9:46 pm</a>		</div>

		<p>&quot;Literally everything at Microsoft is built using various flavors of Visual C++ &#8211; mostly 6.0 and 7.0 but we do have a few holdouts still using 5.0 :-(&quot;</p>
<p>This link is slow. The site is still up, so just get rid of the <a rel="nofollow" target="_new" href="http://web.archive.bibalex.org/web/20071011225313/" rel="nofollow">web.archive.bibalex.org/&#8230;/20071011225313</a> part.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-838093">
				<div id="div-comment-838093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838093">
			June 8, 2010 at 9:48 pm</a>		</div>

		<p>In fact, looks like they already updated the page. <a rel="nofollow" target="_new" href="http://public.research.att.com/~bs/applications.html" rel="nofollow">public.research.att.com/&#8230;/applications.html</a> now says that:</p>
<p>&quot;Microsoft: Literally everything at Microsoft is built using recent flavors of Visual C++ (using older versions would automatically cause an application to fail the security review).&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-838103">
				<div id="div-comment-838103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ASK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838103">
			June 8, 2010 at 11:59 pm</a>		</div>

		<p>So what is Visual Studio 2010 compiled with?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-838113">
				<div id="div-comment-838113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838113">
			June 9, 2010 at 1:51 am</a>		</div>

		<p>If CFF Explorer is to be believed, the IDE was built with VS2005. The toolchain &#8230; not so much.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-838123">
				<div id="div-comment-838123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">POKE53280,0</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838123">
			June 9, 2010 at 2:29 am</a>		</div>

		<p>[ASK]</p>
<blockquote><p>
  So what is Visual Studio 2010 compiled with?
</p></blockquote>
<p>Using Dependency Walker tool, a dependency from MSVCR100.DLL can be found. So it seems that they may have used VC10 to build VS2010 :-)</p>
<p>BTW: Part of the IDE changed from using native technologies like GDI (in VS200x, x &lt;= 8) to WPF; so VS2010 must be a mix of C++ and C#.</p>
<p>PS:</p>
<p>I find it interesting that the fact that the topic is discussed on Raymond Chen&#39;s blog &nbsp; &nbsp;caused Bjarne Stroustrup to finally update his web site :-)</p>
<p>PPS:</p>
<p>I find it more interesting that several people still use VC6 (which &#8211; despite not having a C++0x-compliant C++ compiler &#8211; has a great IDE focused on C++, especially if combined with Visual Assist X and WndTabs), after several iterations of VS.</p>
<p>BTW:</p>
<p><a rel="nofollow" target="_new" href="http://public.research.att.com/~bs/applications.html" rel="nofollow">public.research.att.com/&#8230;/applications.html</a></p>
<blockquote><p>
  Windows XP, Vista, System 7
</p></blockquote>
<p>I was unaware of &quot;Windows System 7&quot; :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-838353">
				<div id="div-comment-838353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838353">
			June 9, 2010 at 3:29 pm</a>		</div>

		<p>In Windows itself, Microsoft doesn&#39;t have to worry when using recent &quot;secure&quot; functions from MSVCRT, because you know that the user has a certain version of Windows!</p>
<p>Now if only Microsoft would release the compiler they use internally for putting infrequently-executed code into different parts of the executable&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao even thread-even depth-1" id="comment-838423">
				<div id="div-comment-838423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838423">
			June 9, 2010 at 10:27 pm</a>		</div>

		<p>&quot;(The statement wasn&#39;t even 100% true when it was written, because Windows 95 used a special version of the compiler not found in nature for selected portions of the operating system.) &quot;</p>
<p>What was the banner this compiler displayed when it started up?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-838373">
				<div id="div-comment-838373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sarath</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838373">
			June 9, 2010 at 5:24 pm</a>		</div>

		<p>Microsoft had rapid succession with Visual Studio releases, which introduces new language features, new frameworks, new .NET platforms which was tightly coupled to each version of Visual Studio. One of the biggest Japanese company I&#39;m working with still using Visual C++ 6.0 for developing. They&#39;re slowly switching for the new versions of Visual Studios. And we&#39;ve a number of problems facing for creating build using msbuild, upgrading *huge source* and make it compatible with the newest versions of Visual studio. The product releases and business is important than upgrading to a new version of compiler and it&#39;s a mammoth effort. Most of their code are proven for long time even without the secure version of libraries. It&#39;s easy for small companies to switch according to Microsoft&#39;s frequent releases but for a big company, it&#39;s truly hard and the amount spend for license is too huge and it&#39;s for a short period of time and then Microsoft come up with entirely new product.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-838903">
				<div id="div-comment-838903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-838903">
			June 11, 2010 at 5:18 am</a>		</div>

		<p>security APIs as a litmus test was not my first thought.</p>
<p>64-bit support is. Visual C++ 6&#39;s compiler doesn&#39;t support 64-bit.</p>
<p>I would still use VC6 if I didn&#39;t have to do 64-bit&#8230; the level of C++ it support is just find for almost everything we need in our 14 milion line of code app. &nbsp;There&#39;s just a couple of template things missing.</p>
<p>And.. edit-and-continue, debugging, browser, and find-in-file UI was fast and reliable. So much more productive..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-839333">
				<div id="div-comment-839333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Teo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100607-00/?p=13793#comment-839333">
			June 12, 2010 at 12:48 am</a>		</div>

		<p>The interesting question is, what build system MS uses? nmake? build from WDK? msbuild? VS ide build system? team build? internal one company wide? internal one for teams? batch files? Or gnu make using the posix subsystem :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

