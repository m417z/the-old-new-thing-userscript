<html>
<head>
<title>Windows could not properly load the XYZ keyboard layout</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Windows could not properly load the XYZ keyboard layout</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>July 22, 2008 / year-entry #245</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>14</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">In my rôle as the family technical support department, I get to poke around without really knowing what I'm doing and hope to stumble across a solution. Sometimes I succeed; sometimes I fail. Today, I'm documenting one of my successes in the hope that it might come in handy for you, the technical support department...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>In my r&ocirc;le as <a href="http://blogs.msdn.com/oldnewthing/archive/2007/01/01/1393908.aspx"> the family technical support department</a>, I get to poke around without really knowing what I'm doing and hope to stumble across a solution. Sometimes I succeed; sometimes I fail.</p>
<p> Today, I'm documenting one of my successes in the hope that it might come in handy for you, the technical support department for your family. (If not, then I guess today is not your day.) </p>
<p> The boot drive on the laptop belonging to one of my relatives became corrupted, and her brother-in-law had the honor of extracting the drive, sticking it into a working computer, doing the <code>chkdsk</code> magic, reinstalling the software that got corrupted, and otherwise getting the machine back on its feet. (It's a good thing I wasn't the one to do it because all of the programs are in Chinese, and I can't read Chinese beyond a few dozen characters.) Anyway, the machine returned to life, mostly. The bizarro proprietary hardware (that a certain manufacturer insists on using in order to make their machines <i>special</i>) still doesn't have drivers, but it was happy for the most part. </p>
<p> There was just one problem remaining, and it fell upon me to fix it: She couldn't type Chinese characters any more. Normally, this is done by selecting an appropriate IME, but no matter what we picked, it was as if we were always using the US-English keyboard. </p>
<p> One clue was that if you deleted the IME and then re-added it, you got the error message <code>Windows could not properly load the XYZ keyboard layout</code>. </p>
<p> Here is how I fixed it. (This was a Windows&nbsp;XP machine.) Maybe it will help you, maybe not. </p>
<p> First, go to the Regional and Language Options control panel and set everything back to English (US): </p>
<ul>
<li>On the Advanced tab, under "Select a language to match the language     version of the non-Unicode programs you want to use",     select "English (United States)". </li>
<li>On the Languages tab,     under "Text services and input languages", click the Details     button. Change your default input language to     "English (United States) - US"     and remove all the non-English keyboard layouts. </li>
</ul>
<p> Restart to make sure that nobody is using those old services. </p>
<p> After the restart, go back to the Regional and Language Options control panel, go to the Languages tab, and uncheck "Install files for East Asian languages." That is the whole point of this exercise. All the other steps were just removing enough obstacles so we could do that. </p>
<p> Restart to make sure nobody is using any of the East Asian fonts. </p>
<p> After the restart, add the East Asian fonts back, and when you're asked whether you should use the files already on the machine, say "No." That way, they will be re-copied from the CD. </p>
<p> (This step was trickier for me, because one of the hardware devices that didn't work was the DVD drive! I thought I was stuck, but then I realized that the wireless network antenna still was functional, so I went to another computer in the house, put the Windows&nbsp;XP CD in the drive, and shared out the CD-ROM drive. Then I went back to the first computer and told it to install the files from the second computer.) </p>
<p> Once everything gets reinstalled (including the corrupted keyboard layout files), you can go back and add the Chinese IME back, and reset all those other settings back to Chinese. </p>
<p> Neither I nor the owner of the laptop is very good at the other's native language (though she is far better at English than I am at Chinese), so fixing her computer is the best way I have of showing her my appreciation. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (14)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-nathan_works even thread-even depth-1" id="comment-648713">
				<div id="div-comment-648713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/nathan_works' rel='external nofollow' class='url'>nathan_works</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-648713">
			July 22, 2008 at 10:04 am</a>		</div>

		<p>You are giving me bad flashbacks of helping set up the internationalization machines in the QA lab.. Such a necessary task, but could be very painful at times.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-648723">
				<div id="div-comment-648723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-648723">
			July 22, 2008 at 10:22 am</a>		</div>

		<p>I fear the day this info will become useful ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-648763">
				<div id="div-comment-648763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">this box intentionally left blank</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-648763">
			July 22, 2008 at 10:59 am</a>		</div>

		<p>&gt; fixing her computer is the best way I have of showing her my appreciation</p>
<p>Your appreciation of what? Enquiring minds want to know.</p>
<div class="post">[<i>What, you don&#8217;t like your relatives? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-648773">
				<div id="div-comment-648773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-648773">
			July 22, 2008 at 11:41 am</a>		</div>

		<p>Maybe in a few more years, solid-state drives will save us all from the dropped laptop corrupted disk demons.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-648913">
				<div id="div-comment-648913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-648913">
			July 22, 2008 at 5:14 pm</a>		</div>

		<p>Nathan_works: My experience with testing various-languages machines is:</p>
<p>English &#8211; no problems</p>
<p>European languages &#8211; You can manage. And you get to read out words in a funny accent. I like Italian best.</p>
<p>Russian &#8211; You find someone who speaks it (lots of those around here)</p>
<p>East-Asian languages &#8211; Uh-oh&#8230;</p>
<p>And more to the point, my tech support for people who want to type Chinese often fails at the &quot;you&#8217;ll need the Windows XP CD&quot; point. That&#8217;s why everything from the CD is installed in Vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-648933">
				<div id="div-comment-648933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-648933">
			July 22, 2008 at 6:07 pm</a>		</div>

		<p>Raymond: &quot;What, you don&#8217;t like your relatives?&quot;</p>
<p>I adore mine, but not enough to navigate dialogs saying things like &quot;Select a language to match the language version of the non-Unicode programs you want to use&quot;.</p>
<p>I think I would have been much more likely to install an OS from scratch when the boot drive became corrupted than to try to recover it; I admire your (and his) persistence&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649023">
				<div id="div-comment-649023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tony Siu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649023">
			July 22, 2008 at 7:41 pm</a>		</div>

		<p>I had the same experience a couple years ago helping my relatives with her Chinese version of XP &#8211; I managed to stumble my way through the Control Panel (I could just recognised where the Region and Language option is, everything else was a blur). Luckily, I had a copy of the CD nearby. In the end, I scored myself a fancy lunch!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649033">
				<div id="div-comment-649033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649033">
			July 22, 2008 at 7:56 pm</a>		</div>

		<p>@Peter:</p>
<p>The problem is that there is often more stored on the boot volume than just the operating system. This is essentially always true if you buy a PC from Dell/HP/Gateway/etc and usually true in any other case.</p>
<p>Recovering a system and files from a failed disk is one of my least favorite thing to do, but is becoming more and more common as computers bought 3-5 years ago begin to age. &nbsp;I&#8217;ve been encouraging (with varying success) my family to buy an external drive and do simple Robocopy backups.</p>
<p>It&#8217;s surprising how many people don&#8217;t even realize hard drives can utterly fail and they can lose everything.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649053">
				<div id="div-comment-649053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">zmx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649053">
			July 22, 2008 at 8:42 pm</a>		</div>

		<p>&quot;East-Asian languages &#8211; Uh-oh&#8230;&quot;</p>
<p>You should be able to find a Chinese, or Korean, or Japanese co-worker to help you on this, just as you find someone who speaks Russian.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649073">
				<div id="div-comment-649073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649073">
			July 23, 2008 at 1:16 am</a>		</div>

		<p>@Nick:</p>
<p>True, but often the easiest is to reformat and reinstall. Given how cheap drives are, you can toss in a new laptop drive, reinstall, and get a case for the old one.</p>
<p>Especially when it isn&#8217;t the hard drive that&#8217;s failed, but the filesystem that&#8217;s gotten horrendously corrupted somehow. Fixing the problem might only be temporary until the drive corrupts itself again. Reinstalling gives it a fresh start.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649083">
				<div id="div-comment-649083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">this box intentionally left blank</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649083">
			July 23, 2008 at 3:51 am</a>		</div>

		<blockquote><p>
  What, you don&#8217;t like your relatives?
</p></blockquote>
<p>I couldn&#8217;t eat a whole one.</p>
<p>You made it sound (to me) like you were returning a favour she had done you, that was all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649333">
				<div id="div-comment-649333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649333">
			July 23, 2008 at 5:27 pm</a>		</div>

		<p>@Nick: In my experience, no software supplied with most PC&#8217;s by Dell/HP/whoever is worth saving anyway. If you mean some sort of weird &quot;restore partition&quot; thing, those are clearly useless since they obviously won&#8217;t work if your hard drive dies &#8211; having it on another medium is essential.</p>
<p>Obviously I&#8217;d save their personal data before nuking the drive (Knoppix or similar is excellent for this), but my experience of trying to rescue corrupted operating systems is that it&#8217;s easier to get on with reinstalling.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-649563">
				<div id="div-comment-649563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">hamy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649563">
			July 25, 2008 at 1:49 am</a>		</div>

		<p>You simply saved my a**. Thank you</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-649913">
				<div id="div-comment-649913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zen Luo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080722-00/?p=21523#comment-649913">
			July 27, 2008 at 1:54 pm</a>		</div>

		<p>&quot;so fixing her computer is the best way I have of showing her my appreciation&quot;</p>
<p>Hello Raymond! I use this trick also&#8230; when I like a girl and she call me for support I always spend a lot time with here to fix the computer problem&#8230; ha ha!</p>
<p>thanks for the blog raymond i&#8217;m a reader day by day</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

