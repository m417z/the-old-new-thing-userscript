<html>
<head>
<title>When selecting system colors, match but don't mix</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>When selecting system colors, match but don&#8217;t mix</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 12, 2007 / year-entry #437</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>35</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Here's a question that came in from a customer: Is there a way to view all the Windows color schemes at once? We want to display text in the COLOR_BTNTEXT color against a background of COLOR_INACTIVECAPTION, and we want to check that this looks good in all of the themes. A mistake I see from...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Here's a question that came in from a customer:</p>
<blockquote class="q"><p> Is there a way to view all the Windows color schemes at once? We want to display text in the <code>COLOR_BTNTEXT</code> color against a background of <code>COLOR_INACTIVECAPTION</code>, and we want to check that this looks good in all of the themes. </p>
</blockquote>
<p> A mistake I see from some programs is mixing system colors that are not meant to be mixed. The colors I'm talking about are the ones obtained from the <code>GetSysColor</code> function. Here are the text and background color pairs, with a sample of what those colors are <!--[if gte IE 5]>     on your system right now. <![endif]-->     on a default install of Windows&nbsp;XP.  </p>
<table>
<tr>
<th>Text</th>
<th>Background</th>
<th>Sample</th>
</tr>
<tr>
<td><code>COLOR_WINDOWTEXT</code></td>
<td><code>COLOR_WINDOW</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=window><font COLOR=windowtext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="white"><font color="black">sample</font></td>
</tr>
<tr>
<td><code>COLOR_HOTLITE</code></td>
<td><code>COLOR_WINDOW</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=window><font COLOR=blue>sample*</font></td>
<p> <![endif]-->     </p>
<td bgcolor="white"><font color="blue">sample</font></td>
</tr>
<tr>
<td><code>COLOR_HIGHLIGHTTEXT</code></td>
<td><code>COLOR_HIGHLIGHT</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=highlight><font COLOR=highlighttext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="#316AC5"><font color="white">sample</font></td>
</tr>
<tr>
<td><code>COLOR_INFOTEXT</code></td>
<td><code>COLOR_INFOBK</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=infobackground><font COLOR=infotext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="#FFFFE1"><font color="black">sample</font></td>
</tr>
<tr>
<td><code>COLOR_MENUTEXT</code></td>
<td><code>COLOR_MENU</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=menu><font COLOR=menutext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="white"><font color="black">sample</font></td>
</tr>
<tr>
<td><code>COLOR_BTNTEXT</code></td>
<td><code>COLOR_BTNFACE</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=buttonface><font COLOR=buttontext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="#ECE9D8"><font color="black">sample</font></td>
</tr>
<tr>
<td><code>COLOR_CAPTIONTEXT</code></td>
<td><code>COLOR_ACTIVECAPTION</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=activecaption><font COLOR=captiontext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="#0054E3"><font color="white">sample</font></td>
</tr>
<tr>
<td><code>COLOR_INACTIVECAPTIONTEXT</code></td>
<td><code>COLOR_INACTIVECAPTION</code></td>
<p> <!--[if gte IE 5]>     </p>
<td BGCOLOR=inactivecaption><font COLOR=inactivecaptiontext>sample</font></td>
<p> <![endif]-->     </p>
<td bgcolor="#7A96DF"><font color="#D8E4F8">sample</font></td>
</tr>
</table>
<p> If you're going to combine colors, and you need them to contrast against each other (for example, because you're going to draw text with them as the foreground and background colors), choose a pair from one of the rows above. Do not choose colors from different rows because there is no guarantee that they will be readable against each other. </p>
<p> For example, I like to use <font color="black" style="background: #71FFFF">black on #71FFFF</font> as my color scheme for highlighted text. I've seen programs which break the above rule and draw text in the <code>COLOR_HIGHLIGHT</code> color against a background of <code>COLOR_WINDOW</code>, on the assumption that the highlight color contrasts against the window color. (They get away with this in the default Windows&nbsp;XP color scheme because the window color is white and the highlight color is medium blue.) Unfortunately, on my machine, this results in <font color="#71FFFF" style="background: white">text that is extremely painful on the eyes</font>. </p>
<p> Remember: When it comes to system colors, match. Don't mix. </p>
<!--[if gte IE 5]> </p>
<p> <b>Footnote</b> </p>
<p> *Internet Explorer does not have a built-in name for this system color, so I hard-coded blue. Sorry. </p>
<p> <![endif]-->
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (35)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-576723">
				<div id="div-comment-576723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mastmaker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576723">
			December 12, 2007 at 11:47 am</a>		</div>

		<p>Isn&#8217;t there ONE hacker among the readership of this blog who can make these &#8216;pingback&#8217;ers eat their crow? This is getting to be too much!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576733">
				<div id="div-comment-576733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576733">
			December 12, 2007 at 12:29 pm</a>		</div>

		<p>I have a question:</p>
<p>Is there somewhere some documentation which shows what colors does Windows use while drawing controls (especially common controls)?</p>
<p>The problem is that when I implement a custom drawn listview for example I want to know what colors to use for example for the unfocused selection rectangle (the color when the listview is unfocused but has an always-show-selection). It seems to be gray, but is it always gray? Is there a GetSysColor for it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576773">
				<div id="div-comment-576773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576773">
			December 12, 2007 at 1:31 pm</a>		</div>

		<p>mastmaker: I think pingbacks are what are supposed to make blogs &quot;special&quot; when compared to traditional news scripts. &nbsp;That and comments. &nbsp;It&#8217;s sort of like a reverse hyperlink that shows whenever another blog links to yours.</p>
<p>NoiseEHC: &nbsp;Google for a program called &quot;3D Color Changer&quot;, it allows you to change a few more system colors than Windows&#8217; built in tool does. &nbsp;What I do is i set each element to a different bright and ugly color. &nbsp;Since every element is now a different color, it becomes easier to see what color is being used to draw a control.</p>
<p>An annoying thing I&#8217;ve noticed is that webpages assume all &lt;input&gt; fields default to color: black when instead they default to BTNTEXT (at least in Firefox; I guess this is sort of a bug in Firefox because I disabled the option which uses system colors as defaults in HTML documents).</p>
<p>The result is that some sites change the background-color of input elements (buttons and textboxes in particular), for example to white, and leave the color property alone. &nbsp;I liked having an inverted theme, with white on black for WINDOWTEXT/WINDOW and dark BTNFACE and light BTNTEXT. &nbsp;Of course, I ended up with white on white textboxes on many websites and I ended up writing a few Stylish CSS rules to fix a few specific websites.</p>
<p>This mistake is actually pointed out to you if you use the w3c CSS validator, which complains if you set background-color without color or visa-versa.</p>
<p>I am happy to say in my programs (and websites) I have never been guilty of system color &quot;mixing&quot;.</p>
<p>A related thing that you should never do is mix system colors with hardcoded colors, because it&#8217;s very easy to end up with eye-tearing color schemes that way (even easier than Raymond&#8217;s example&#8230; this is pretty much what the aforementioned websites do).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576793">
				<div id="div-comment-576793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576793">
			December 12, 2007 at 1:50 pm</a>		</div>

		<p>Well, you could call SetSysColors() with each enumeration until the color changes. &nbsp;Then you know which one you need to use. &nbsp;But my guess would be that it&#8217;s probably hard-coded.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576803">
				<div id="div-comment-576803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Weiss</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576803">
			December 12, 2007 at 2:04 pm</a>		</div>

		<p>Maybe this is common knowledge among web developers &#8211; but i didn&#8217;t realize that you could use Windows system colors as named HTML colors (which is what Raymond has done in this item).</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/aa358804.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/aa358804.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576813">
				<div id="div-comment-576813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576813">
			December 12, 2007 at 2:08 pm</a>		</div>

		<p>Mike, it was news to me. Seems to work in Firefox Opera, and even Safari/Win. I wonder what it does on a Mac?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576833">
				<div id="div-comment-576833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576833">
			December 12, 2007 at 2:20 pm</a>		</div>

		<p>Mike and Dave: &nbsp;Well, it is part of CSS2.1 (but deprecated in CSS3, in favor of an &quot;appearance&quot; setting in the UI module instead; appearance also affects the cursor, outline, etc.), so I suspect that anything that supports CSS2 will work with it.</p>
<p>The CSS2.1 spec says that if you don&#8217;t have a given system color, you should map to &quot;the nearest system value&quot; (whatever that is) or &quot;a default color&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576853">
				<div id="div-comment-576853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mastmaker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576853">
			December 12, 2007 at 2:55 pm</a>		</div>

		<p>Dan:</p>
<p>I was referring to &#8216;comment spam&#8217;ming pingbacks from &#8216;abosultely people search&#8217; fella(s). Oh&#8230;I really wish there were a hell and I could send these spammers there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576873">
				<div id="div-comment-576873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jivlain.wordpress.com' rel='external nofollow' class='url'>Jivlain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576873">
			December 12, 2007 at 3:20 pm</a>		</div>

		<p>Mike: look at the source. I&#8217;m assuming that means it&#8217;s IE only.</p>
<p>&lt;TR&gt;&lt;TD&gt;&lt;CODE&gt;COLOR_BTNTEXT&lt;/CODE&gt;&lt;/TD&gt;</p>
<p>&nbsp; &nbsp;&lt;TD&gt;&lt;CODE&gt;COLOR_BTNFACE&lt;/CODE&gt;&lt;/TD&gt;</p>
<p>&lt;!&#8211;[if gte IE 5]&gt;</p>
<p>&nbsp; &nbsp;&lt;TD BGCOLOR=buttonface&gt;&lt;FONT COLOR=buttontext&gt;sample&lt;/FONT&gt;&lt;/TD&gt;</p>
<p>&lt;![endif]&#8211;&gt;&lt;![if !gte IE 5]&gt;</p>
<p>&nbsp; &nbsp;&lt;TD BGCOLOR=#ECE9D8&gt;&lt;FONT COLOR=black&gt;sample&lt;/FONT&gt;&lt;/TD&gt;</p>
<p>&lt;![endif]&gt;</p>
<p>&nbsp; &nbsp;&lt;/TR&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576883">
				<div id="div-comment-576883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sandman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576883">
			December 12, 2007 at 3:25 pm</a>		</div>

		<p>@Mike: Thats not quite what Raymond&#8217;s done.</p>
<p>What Raymond has done is to do it an IE&gt;=v5 only section, and it falls back to using colour defined in the CSS/HTML specs if this &nbsp;clause isn&#8217;t matched.</p>
<p>For instance I don&#8217;t think windows colour names would work for me, running iceweasel on Debian. </p>
<p>Raymond &#8211; thanks for doing this in a sensible backwards compatible way .</p>
<div class=post>[<i>I have no choice. If I don&#8217;t do it, I get flamed. (See: VML.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-madq42 even thread-even depth-1" id="comment-576893">
				<div id="div-comment-576893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MadQ1' rel='external nofollow' class='url'>MadQ1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576893">
			December 12, 2007 at 3:56 pm</a>		</div>

		<p>@NoiseEHC: The color ListViews use for selected items when unfocused seems to be the COLOR_3DFACE. The background color of the selected column in detail view isn&#8217;t a system color. It seems to be the same hue as COLOR_WINDOW with different saturation and luminance values, which happens to clash with my preferred COLOR_3DFACE. It would be nice to know how the listview control creates that color. Does anyone know? Bueler? Bueler?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-friedicusrediculoushotmail-com odd alt thread-odd thread-alt depth-1" id="comment-576903">
				<div id="div-comment-576903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Fried' rel='external nofollow' class='url'>Mike Fried</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576903">
			December 12, 2007 at 4:01 pm</a>		</div>

		<p>I should point out that Office 2003 UI had some large number of colors that were carefully chosen by designers. How large &#8211; offhand, I recall that the spec contained something like ~200 x 4 colors in a matrix &#8211; we used them in many ways across the custom UI components in all Office apps. The colors mapped in one of 4 ways, depending on if the user was using one of the 3 XP theme colors or if they were running without themes (as was the case in Windows 2000). I can&#8217;t remember how we handled High Contrast Mode, but I am positive there were even more special cases for it.</p>
<p>I didn&#8217;t work with Office 2007&#8217;s UI theming, so I can&#8217;t say what is different about it except that there is an option to set one of 3 skins for the UI: Blue, Silver, or Black.</p>
<p>That&#8217;s just talking about the UI. For documents, Office has color schemes which are designed to contrast by default (and to help customers make schemes that contrast). In Office 2007, we standardized document color schemes across the core apps. The color schemes in Office 2007 give you 2 pairs of dark/light colors for text/background to chose from, 6 accent colors which in general should contrast well with both pairs of dark/light, and 2 hyperlink colors. Customers can add new themes via the UI which provides a little rendering of a chart to demonstrate how well the currently chosen colors would work against each other. These theme colors are used everywhere in Office 2007 so that to as much an extent as possible when you change the theme or color scheme, you change all colors used in your documents / presentations / worksheets.</p>
<p>You can read more on the color schemes from the Lead PM of the Schemes/Styles team in Office 2007, Howard Cooperstein in one of his blog posts:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/jensenh/archive/2006/02/22/537054.aspx" rel="nofollow">http://blogs.msdn.com/jensenh/archive/2006/02/22/537054.aspx</a></p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/powerpoint/archive/2006/07/13/664413.aspx" rel="nofollow">http://blogs.msdn.com/powerpoint/archive/2006/07/13/664413.aspx</a></p>
<p>-Mike</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576913">
				<div id="div-comment-576913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zamboch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576913">
			December 12, 2007 at 4:29 pm</a>		</div>

		<p>Dan: could you please share your CSS for firefox ? Thanks!</p>
<p>I like to have inverted windows theme as well, but because of issues with web pages, I would like to keep usual white background for firefox. Does anyone know how to hack firefox, so that it will use different colors for OS UI components like textbox ? Or how to change system colors for single application ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576933">
				<div id="div-comment-576933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Grant</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576933">
			December 12, 2007 at 5:27 pm</a>		</div>

		<p>[Maybe this is common knowledge among web developers &#8211; but i didn&#8217;t realize that you could use Windows system colors as named HTML colors]</p>
<p><a rel="nofollow" target="_new" href="http://www.w3.org/TR/CSS2/ui.html#system-colors" rel="nofollow">http://www.w3.org/TR/CSS2/ui.html#system-colors</a></p>
<p>My understanding is these have been deprecated in CSS 3.0 because not all browsers implemented them the same way, making them worse than useless.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576963">
				<div id="div-comment-576963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Cox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576963">
			December 12, 2007 at 8:05 pm</a>		</div>

		<p>My pet peeve in this arena are the large # of applications that honor your tooltip foreground color but not the background color. I like to use a darkish blue background and white-ish text. Becomes unreadable of course. <font color=red>ABC</font> is a classic example of an app that does this &#8211; at least with the default theme and the smoke theme that I use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576943">
				<div id="div-comment-576943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://greasemonkey.nonlogic.org' rel='external nofollow' class='url'>GreaseMonkey</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576943">
			December 12, 2007 at 6:14 pm</a>		</div>

		<p>It probably *is* implemented in the Windows version of Firefox, as it was designed to be compatible with IE-based pages (minus ActiveX, of course).</p>
<p>Oh, BTW, looks like that pingbacker got owned:</p>
<p><a href="http://www.absolutely-people-search.info/" rel="nofollow">http://www.absolutely-people-search.info/</a></p>
<p>Look at the page source:</p>
<p>&lt;body&gt;</p>
<p>&lt;?php</p>
<p>Header( “HTTP/1.1 301 Moved Permanently” );</p>
<p>Header( “Location: <a href="http://www.absolutely-free-people-searches.com”" rel="nofollow">http://www.absolutely-free-people-searches.com”</a> );</p>
<p>?&gt;</p>
<p>&lt;p class=&#8221;style1&#8243;&gt;&amp;nbsp;&lt;/p&gt;</p>
<p>They didn&#8217;t even bother with a META redirect XD XD XD</p>
<div class=post>[<i>That&#8217;s not ownage. That&#8217;s just part of their business model. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576993">
				<div id="div-comment-576993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576993">
			December 13, 2007 at 4:45 am</a>		</div>

		<p>I&#8217;ve used an inverted color scheme for years now, and the thing that&#8217;s most annoying is when programs hardcode some colors, but use the system colors for something else (usually by hardcoding the text to black while keeping the system background color).</p>
<p>This makes me wonder, is an EULA I can&#8217;t see still legally binding?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-577003">
				<div id="div-comment-577003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Elliott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577003">
			December 13, 2007 at 5:20 am</a>		</div>

		<p>The thing that gets me is those two-tone menus, where the highlight gets done by blending the window colour and the highlight colour. On my system I end up with unselected items as black-on-#F3F3F3 and the selected item as black-on-#F2F2F2.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577013">
				<div id="div-comment-577013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577013">
			December 13, 2007 at 5:51 am</a>		</div>

		<p>Thanks for the answers! Probably it is time for Raymond to kick some ass at MS to finally in 2007 create a documentation about colors&#8230; I do not dare to even think about what happens in Vista&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-576973">
				<div id="div-comment-576973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-576973">
			December 13, 2007 at 12:50 am</a>		</div>

		<p>I&#8217;ve noticed the exact same problem with <font color=red>XYZ</font>&#8216;s control panel. &nbsp;I&#8217;m not sure the exact constants they used, but when I look at the tree view down the left hand side, all of the text within is *completely invisible.* &nbsp;White-on-white.</p>
<p>On a related note, back when I had an <font color=red>ABC</font> video card, they apparently had never tested their fancy control panel with different font sizes. &nbsp;Because you couldn&#8217;t resize the window, I lost about 30% of the control panel off the sides, and almost none of the text was readable.</p>
<p>Sometimes, I really wish companies would just stop trying to be clever; it only seems to cause problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577023">
				<div id="div-comment-577023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577023">
			December 13, 2007 at 9:52 am</a>		</div>

		<p>@NoiseEHC: Forgive me if I don&#8217;t understand a word of what you&#8217;re saying&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-577033">
				<div id="div-comment-577033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577033">
			December 13, 2007 at 10:19 am</a>		</div>

		<p>@meh:</p>
<p>Translation:</p>
<p>The conclusion is that there is no documentation about colors. The best I can hope for is that Raymond somehow pushes MS developers to document what colors they are using in Windows code since as you can see, a lot of programs cannot draw their UI consistent with the selected Windows color scheme. Clearly it is a little bit late in 2007 but better than never.</p>
<p>Anyhow I thank you for the info you have given to me but somehow I feel that testing every control&#8217;s colors in every version of Windows (like Vista) is a little bit too much work for me&#8230;</p>
<p>ps:</p>
<p>If you still do not understand it then it is clearly the fault of my limited English skills.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577063">
				<div id="div-comment-577063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577063">
			December 13, 2007 at 11:07 am</a>		</div>

		<p>My window (background) color is a faint blue. &nbsp;It&#8217;s easier on the eyes than stark white.</p>
<p>Sometimes, Web pages or other apps will randomly set the window color to white or leave it at the user&#8217;s default &#8212; leaving some funny-looking patches of white and light blue scattered around.</p>
<p>And as Raymond says, if an application displays text against the user&#8217;s default window color, it might not be visible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-577313">
				<div id="div-comment-577313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577313">
			December 13, 2007 at 4:27 pm</a>		</div>

		<p>BryanK, of course when I talk about colors I mean COLOR_INFOTEXT like system color indexes. For example what is the color of the SysLink Control? If I want to create a link control (for example in a data grid) then probably I want to match its color to the color of the system&#8217;s control.</p>
<p>A page with control screen shots with numbered color constants would suffice on MSDN I think.</p>
<div class=post>[<i>Publishing a diagram like the one you suggest would have precluded the introduction of visual styles. And then when people&nbsp;ask, &#8220;Why can&#8217;t Microsoft update the Windows look so it doesn&#8217;t look so dorky?&#8221;, I&#8217; could&nbsp;tell them &#8220;Because NoiseEHC locked us into the dorky look.&#8221;&nbsp;&nbsp;-Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577393">
				<div id="div-comment-577393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577393">
			December 13, 2007 at 6:05 pm</a>		</div>

		<p>Okay Raymond, for a table like that I will take the blame&#8230; :)</p>
<p>My MSDN (for VS2005) says:</p>
<p>COLOR_HOTLIGHT = 26</p>
<p>Color for a hot-tracked item. Single clicking a hot-tracked item executes the item.</p>
<p>See, after all, somebody at MS took the time in the last 2 years to document it. I think it is not too much to ask for a little table.</p>
<p>IMHO owner drawn controls will never be compatible with UxTheme so matching colors would at least help if I do not want my UI to fall apart with a different color theme&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-577423">
				<div id="div-comment-577423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577423">
			December 13, 2007 at 6:16 pm</a>		</div>

		<p>[And whatever answer you get will be wrong in Windows Vista+n (n&gt;0), so what&#8217;s the point? (You already saw it happen &#8211; any answer from Windows 2000 was wrong in Windows XP when the GetThemeSysColor function was introduced.) -Raymond]</p>
<p>Yes, that table should include all the Windows versions. To tell you the truth, I believe in that this themed controls thing is incompatible with custom drawn controls so I do not even try to keep them consistent (but it is clearly outside of this conversation). I would be totally happy if at least the colors would match.</p>
<div class="post">[<i>For the table to be useful, it would have to include all future versions of Windows, too. Otherwise, your program breaks in Windows Vista+n. I don&#8217;t know whether the &#8220;predicting the future machine&#8221; or the &#8220;time travel machine&#8221; is higher priority over there in the research division. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577443">
				<div id="div-comment-577443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NoiseEHC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577443">
			December 13, 2007 at 6:59 pm</a>		</div>

		<p>[For the table to be useful, it would have to include all future versions of Windows, too. Otherwise, your program breaks in Windows Vista+n. I don&#8217;t know whether the &#8220;predicting the future machine&#8221; or the &#8220;time travel machine&#8221; is higher priority over there in the research division. -Raymond]</p>
<p>I am aware of that this table would break down in future Windows versions. However I would be happy if my program would work OK with the existing versions.</p>
<p>What you are arguing is effectively that GetThemeSysColor and GetSysColor and the like are useless because in Windows 2015 it is possible that for example they would have different gray colors for an unfocused ListView and TreeView. However what I would need is some documentation up to Windows 2008 for the mentioned two functions. The simplest documentation would be a table, that&#8217;s it.</p>
<p>As I said I am certain of that this custom UI problem cannot even be solved but what I am proposing is better than the current unusable documentation syndrome.</p>
<div class=post>[<i>I disagree that this is better than what we have today. Your proposal effectively guarantees that programs written today will stop working on future versions of Windows. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-577463">
				<div id="div-comment-577463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577463">
			December 13, 2007 at 7:41 pm</a>		</div>

		<p>Why does Vista default file/folder selection has such a poor contrast? I am not that much visually impaired but I can barely notice it. Perhaps someone from Microsoft mixed and matched what they shouldn&#8217;t?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cjacks even thread-even depth-1" id="comment-577143">
				<div id="div-comment-577143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Jackson+-+MSFT' rel='external nofollow' class='url'>Chris Jackson - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577143">
			December 13, 2007 at 1:17 pm</a>		</div>

		<p>I can&#8217;t tell you how many times I&#8217;ve had to shim up LOB apps with FakeLunaTheme because people got so overly psyched about theme support in .NET 2.0 that they used it everywhere, assuming nobody would ever use anything other than Luna. Ever.</p>
<p>And, of course, my latest adventure (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/cjacks/archive/2007/12/07/investigating-windows-vista-compatibility-issues-by-decompiling-vb-code-don-t-be-afraid-to-cheat.aspx" rel="nofollow">http://blogs.msdn.com/cjacks/archive/2007/12/07/investigating-windows-vista-compatibility-issues-by-decompiling-vb-code-don-t-be-afraid-to-cheat.aspx</a>), whereby they decided Title Bar Text was a good text color for the background of the form. &#8216;Cause that will never be anything other than white. *sigh*</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-577183">
				<div id="div-comment-577183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577183">
			December 13, 2007 at 1:53 pm</a>		</div>

		<p>&gt; The best I can hope for is that Raymond somehow pushes MS developers to document what colors they are using in Windows code since as you can see, a lot of programs cannot draw their UI consistent with the selected Windows color scheme.</p>
<p>No, that&#8217;s the wrong solution. &nbsp;Documenting &quot;the RGB value of COLOR_HIGHLIGHT under each theme&quot; makes people rely on that info, and it changes with every OS release. &nbsp;(Not to mention new themes!) &nbsp;Documenting it would merely encourage people to say &quot;well we know that the highlight color is this shade of blue, so we can paint text in all kinds of weird places in this app using #ffffff, and we can use COLOR_HIGHLIGHT as the background!&quot;</p>
<p>The *correct* way to do it is to figure out which row in the table above you need to use, and then use both system colors from that row. &nbsp;If you&#8217;re actually painting a highlighted area, then use COLOR_HIGHLIGHTTEXT text with a COLOR_HIGHLIGHT background. &nbsp;DON&#8217;T use #ffffff text on a COLOR_HIGHLIGHTTEXT background, because the RGB value for COLOR_HIGHLIGHTTEXT can change.</p>
<p>(And in fact, users can already change the theme colors, so even *if* Microsoft decided to document the colors that they use, that documentation would be useless as soon as one user decides they want COLOR_HIGHLIGHTTEXT to be black and COLOR_HIGHLIGHT to be yellow, or something like that. &nbsp;Now your program is painting white on yellow: exactly what people here are complaining about programs doing.)</p>
<p>Alternately, if none of the rows in the table above work for whatever you&#8217;re painting, you MUST use explicit colors (e.g. #ffffff on #0, or whatever the equivalent is in win32).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577343">
				<div id="div-comment-577343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://uiguidelines.wordpress.com' rel='external nofollow' class='url'>Ian Boyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577343">
			December 13, 2007 at 5:21 pm</a>		</div>

		<p>i think NoiseEHC is wondering what COLOR_Xxx constant do i need to pass to GetSysColor or GetThemeSysColor in order to have the color that a SysLink uses for it&#8217;s text.</p>
<p>i wouldn&#8217;t want to hard-code a blue-ish color &#8211; in case some preferences or OS change and links are not supposed to be blue anymore.</p>
<p>But since the control text is blue-ish, it is probaby using one of:</p>
<p> &nbsp; COLOR_HOTLIGHT</p>
<p> &nbsp; COLOR_HIGHLIGHT</p>
<p> &nbsp; COLOR_ACTIVECAPTION</p>
<p> &nbsp; COLOR_INACTIVECAPTION</p>
<p>But which one? A quick search of MSDN for COLOR_HOTLIGHT says, &#8220;Color for a hyperlink or hot-tracked item.&#8221; &nbsp;So it seems a reasonable *assumption* that SysLink uses COLOR_HOTLIGHT for it&#8217;s text color &#8211; but it&#8217;s not a given.</p>
<p>On the other hand, if i wanted to know the background color of a ListView control, GetSysColor offers no insights. i could do a reasonable guess and say COLOR_WINDOW, but who knows.</p>
<p>Can&#8217;t really blame someone for guessing wrong&#8230;</p>
<div class="post">[<i>And whatever answer you get will be wrong in Windows Vista+n (n&gt;0), so what&#8217;s the point? (You already saw it happen &#8211; any answer from Windows 2000 was wrong in Windows XP when the GetThemeSysColor function was introduced.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-577513">
				<div id="div-comment-577513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577513">
			December 14, 2007 at 1:47 am</a>		</div>

		<p>I think what NoiseEHC is asking for is some documentation for each control that describes which of the system colours it uses for each &quot;part&quot;. For example, for a tree view, you might have:</p>
<p>background = COLOR_WINDOW</p>
<p>normal text = COLOR_WINDOWTEXT</p>
<p>selected background = COLOR_HIGHLIGHT</p>
<p>selected text = COLOR_HIGHLIGHTTEXT</p>
<p>selected, unfocues background = whatever it is</p>
<p>etc</p>
<p>The idea is that if you wanted to emulate a treeview control (or some part of it, e.g. owner draw) you can look up this table for that control.</p>
<p>The values would have to be updated with each version of Windows, sure. And if the controls ever use a different COLOR_* for their drawing in a newer version of Windows it means any custom controls that try to emulate the functionality will be different, but that&#8217;s obviously going to be true anyway if you just guess.</p>
<p>You can generally figure out which one is used by looking up GetSysColor, but it&#8217;s not always completely obvious (as in the case of the selected, unfocused &quot;gray&quot; background of the treeview control)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-577583">
				<div id="div-comment-577583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://uiguidelines.wordpress.com' rel='external nofollow' class='url'>Ian Boyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-577583">
			December 14, 2007 at 9:38 am</a>		</div>

		<p>Will it always be appropriate to show text that is COLOR_WINDOWTEXT on a background that is COLOR_WINDOW? Or will that be different in Windows 3.1+n(n&gt;0)?</p>
<div class=post>[<i>I&#8217;m afraid you missed the point of the article. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-578003">
				<div id="div-comment-578003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-578003">
			December 16, 2007 at 1:21 pm</a>		</div>

		<p>Speaking of COLOR_HOTLITE, it&#8217;s been available since Windows 98, right? How can you set this color without editing the registry directly or using TweakUI &#8211; the Appearance tab doesn&#8217;t let you do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-578033">
				<div id="div-comment-578033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20071212-00/?p=24203#comment-578033">
			December 16, 2007 at 5:05 pm</a>		</div>

		<p>ender: I think you already answered your own question. I can&#8217;t believe I had to write that.</p>
<p>Hehe, that&#8217;s fun :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

