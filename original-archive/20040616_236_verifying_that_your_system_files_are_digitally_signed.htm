<html>
<head>
<title>Verifying that your system files are digitally signed</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Verifying that your system files are digitally signed</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 16, 2004 / year-entry #237</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>13</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If you want to re-check that the files on your system haven't been tampered with, you can run sigverif (by typing its name into the Start.Run dialog) and tell it to start scanning. (UI note: If you go into the Logging page on the Advanced dialog, you can get trapped where it insists on having...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If you want to re-check that the files on your system  haven't been tampered with, you can run  <a href="http://www.microsoft.com/windows2000/en/datacenter/help/sig_verification_tool.htm">  sigverif</a>  (by typing its name into the Start.Run dialog)  and tell it to start scanning.</p>
<p>  (UI note: If you go into the Logging page on the Advanced dialog,  you can get trapped where it insists on having a valid  log file name even if you didn't ask for logging!)  </p>
<p>  The signature verification process takes a while, so go and  do something else while you're waiting. When it's done, you'll  get a list of all the system files that are not digitally  signed by Microsoft.  Just because a file is listed here  doesn't mean that it's necessarily bad, however.  For example, it might be a video driver or printer driver.  </p>
<p>  (Another UI note: You can't right-click the items in the list  to view their properties, say, to see what company issued the files.)  </p>
<p>  One case when you would want to run sigverif is after you remove  <a href="http://weblogs.asp.net/oldnewthing/archive/2003/08/12/54634.aspx">  the test root certificate  which was causing your desktop to say "for test/evaluation purposes  only"</a>.  That way you can find all the uncertified drivers that snuck in  under cover of the test signature.  </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-184033">
				<div id="div-comment-184033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184033">
			June 16, 2004 at 8:13 am</a>		</div>

		<p>So how do you verify sigverif (and the parts of the OS that it depends on)?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-184093">
				<div id="div-comment-184093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184093">
			June 16, 2004 at 9:29 am</a>		</div>

		<p>well, you could build a bootable linux cd with a known good copy of sigverif on it. For the full version, check out &#8216;On Trusting Trust&#8217;: <a target="_new" href="http://www.acm.org/classics/sep95/" rel="nofollow">http://www.acm.org/classics/sep95/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-184293">
				<div id="div-comment-184293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.people.cornell.edu/pages/wml4' rel='external nofollow' class='url'>will</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184293">
			June 16, 2004 at 5:11 pm</a>		</div>

		<p>In reply to the acm linking dude-<br />
<br />you could also use a known good version of WinPE to run sigverif on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-184223">
				<div id="div-comment-184223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://217.45.146.189/archive/2004/06/17/245.aspx' rel='external nofollow' class='url'>Notes2Self.net</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184223">
			June 16, 2004 at 5:26 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-184313">
				<div id="div-comment-184313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184313">
			June 16, 2004 at 6:54 pm</a>		</div>

		<p>Ben:<br />
<br />That&#8217;s one of the tough questions for us.  In the future NGSCB might be an answer.</p>
<p>Cooney/will:<br />
<br />Running sigverif from a different OS install will probably give you lots of false results.  Most of the files that are signed in Windows are signed indirectly with catalog (.cat) files.  An install of the OS might have catalogs installed from a patch, service pack, or a 3rd party driver installation.  So the one you&#8217;re running your check from won&#8217;t necessarily ahve the catalogs from the OS you&#8217;re checking.<br />
<br />And WinPE won&#8217;t work because the infrastructure to check signatures (and store catalogs) isn&#8217;t there.  Something like BartPE could be coaxed into working, but that means licensing trouble.<br />
<br />Linux CD &#8211; Maybe if WINE supports the right APIs and implements cryptsvc.  I&#8217;m putting this on my list of things to try sometime when I don&#8217;t have anything better to do.  I have my doubts that it would work &quot;out of the box&quot; on any Linux distro, though.</p>
<p>Unfortunately we don&#8217;t have a good (public, released) tool to find/view a signature for catalog-signed files at the moment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-184473">
				<div id="div-comment-184473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harcourt Jarenmyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184473">
			June 17, 2004 at 1:32 am</a>		</div>

		<p>I ran this check, which scanned 2339 files. 842 files were not scanned, and 15 files were found that were not signed.</p>
<p>Now what?</p>
<p>I cannot find any info on each of these files by clicking on them. I cannot connect to a server to check if these files have been tampered with. I cannot connect to a server to verify that these files are genuine, and then have this app sign the files as valid.</p>
<p>In fact, once the scan is over I get a list that I cannot even export to a txt file so I can send it somewhere to do something. Unless I specify it FIRST in the &quot;Advanced&quot; section.</p>
<p>I would suggest that you are already advanced if you are running this app from the cli, and these options should be strung across the front of the tool.</p>
<p>So, I have a machine that has unsigned dlls and other cruft, which someone could be using to compromise my machine, or in a compromise of my machine, and there is no immediate, simple action that I can take to &quot;enclose my confidence&quot;.</p>
<p>Just thinking aloud!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-184843">
				<div id="div-comment-184843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184843">
			June 17, 2004 at 2:40 pm</a>		</div>

		<p>Not all files are going to be signed even if they&#8217;re &quot;approved&quot; &#8211; .log files created by the OS, for example.<br />
<br />The signtool/capicom combo is a much better way to check signatures.  It tells you what error was encountered.<br />
<br />Yes, Harcourt &#8211; sigverif is clunky.  It&#8217;s existed more or less unchanged since at least Win9x days.  Which is probably why it&#8217;s too geeky for the average user yet too feature-poor for a geek.  :-(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-184623">
				<div id="div-comment-184623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-184623">
			June 17, 2004 at 8:25 am</a>		</div>

		<p>If a file shows up in the list it means &quot;This is a file that is not in the list of approved Windows files.&quot;  It could be because it&#8217;s been tampered with.  It could be because it is a driver written by somebody other than Microsoft. The tool doesn&#8217;t know; it&#8217;s just listing everything it finds. (As you can easily tell by now, the tool is definitely *not* user friendly; its target audience was propeller-headed ultrageeks.) It&#8217;s now up to you to decide what you want to do with this information.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-185523">
				<div id="div-comment-185523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">YV</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-185523">
			June 19, 2004 at 2:29 pm</a>		</div>

		<p>Why does sigverif need to connect to internet halfway throught the process. ZoneAlaram alerted me , any ideas?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-185533">
				<div id="div-comment-185533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-185533">
			June 19, 2004 at 5:05 pm</a>		</div>

		<p>I have no idea. Perhaps it&#8217;s done as part of certificate verification? I&#8217;m just guessing. You could always debug it and find out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-199853">
				<div id="div-comment-199853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-199853">
			July 29, 2004 at 10:31 pm</a>		</div>

		<p>Commenting closes after two weeks. </p>
<p><a target="_new" href="http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx" rel="nofollow">http://weblogs.asp.net/oldnewthing/archive/2004/02/21/77681.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-203723">
				<div id="div-comment-203723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/larryosterman/archive/2004/08/17/215857.aspx' rel='external nofollow' class='url'>Larry Osterman's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-203723">
			August 17, 2004 at 1:40 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-210553">
				<div id="div-comment-210553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/archive/2004/09/14/229793.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040616-00/?p=38853#comment-210553">
			September 15, 2004 at 2:12 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

