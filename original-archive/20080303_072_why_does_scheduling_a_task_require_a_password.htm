<html>
<head>
<title>Why does scheduling a task require a password?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why does scheduling a task require a password?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 3, 2008 / year-entry #73</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>45</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Kevin asks, "Windows XP lets me install applications, delete files, etc., so why does scheduling a task requires a password?" (I guess the answer to this question wasn't obvious since nobody answered it in the suggestion box.) Because scheduled tasks run after you have logged off. All those other operations occur while you are logged on....</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p><a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#493126"> Kevin asks</a>, "Windows&nbsp;XP lets me install applications, delete files, etc., so why does scheduling a task requires a password?" (I guess the answer to this question wasn't obvious since nobody answered it in the suggestion box.)</p>
<p> Because scheduled tasks run after you have logged off. </p>
<p> All those other operations occur while you are logged on. Your user token has been authenticated with the relevant security authority. The system has confirmed your identity and your permissions and stored them in your user token. </p>
<p> But once you log off, your token goes away. </p>
<p> Since scheduled tasks can run even if you aren't logged on (that's sort of the point of them after all), the system needs to re-establish your identity and your permissions, because your account may have been deleted or restricted in the meantime. And to do that, you need a password. Scheduled tasks can't use some "just act like I'm that user over there, trust me" magic cookie, because that would be <a href="http://blogs.msdn.com/oldnewthing/archive/2005/05/04/414602.aspx"> equivalent to a password</a>. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (45)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-606013">
				<div id="div-comment-606013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606013">
			March 3, 2008 at 10:17 am</a>		</div>

		<p>The corresponding UNIX daemon (cron) doesn&#8217;t seem to have this limitation. So I&#8217;m curious why Windows would need the password in order to create a session for a user.</p>
<p>Is it because under certain configurations (encrypted volumes or a windows domain account) it would need it? So instead of asking for it only some of the time it just asks for it all the time?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606073">
				<div id="div-comment-606073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">e.thermal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606073">
			March 3, 2008 at 11:10 am</a>		</div>

		<p>not to mention a common gotcha of tasks. &nbsp;I see it all too often; user will map a network drive say N: then try to use N: in a scheduled task. &nbsp;They then log off, task runs and fails. &nbsp;This is easily worked around but it isn&#8217;t obvious to even most administrators.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606083">
				<div id="div-comment-606083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">X</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606083">
			March 3, 2008 at 11:12 am</a>		</div>

		<p>BTW, if you select the &#8216;run only when logged in&#8217;, you aren&#8217;t required to provide a password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606093">
				<div id="div-comment-606093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606093">
			March 3, 2008 at 11:14 am</a>		</div>

		<p>In general Unix cron doesn&#8217;t have this problem because a Unix user ID is just a 16-bit (or 32-bit) integer that crond can set to whatever it wants because it runs as root. If your Unix machine has kerberos, though, you&#8217;ll run into the same problem because kerberos doesn&#8217;t just let you pretend to be any user you want.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606103">
				<div id="div-comment-606103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Greg P</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606103">
			March 3, 2008 at 11:15 am</a>		</div>

		<p>Further question: Why do you have to enter a password twice in scheduled tasks?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606133">
				<div id="div-comment-606133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606133">
			March 3, 2008 at 12:05 pm</a>		</div>

		<p>To guard against typos. &nbsp;You&#8217;re unlikely to typo the password the same way twice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606143">
				<div id="div-comment-606143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606143">
			March 3, 2008 at 12:07 pm</a>		</div>

		<blockquote><p>
  Further question: Why do you have to enter a password twice in scheduled tasks?
</p></blockquote>
<p>I imagine it&#8217;s to prevent the situation where &quot;really long tedious task I set to run overnight&quot; failed because you mistyped your password. Anywhere there isn&#8217;t immediate feedback for a mistyped password it&#8217;s a good idea to confirm the password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606173">
				<div id="div-comment-606173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606173">
			March 3, 2008 at 12:18 pm</a>		</div>

		<blockquote><p>
  Anywhere there isn&#8217;t immediate feedback for a mistyped password
</p></blockquote>
<p>There could be immediate feedback. &nbsp;Instead of asking for the password twice, just check it when adding the scheduled task.</p>
<p>One problem I had with scheduled tasks that made me seek out an alternate solution is that they stopped working when I (as a good user) changed my password. &nbsp;It was too much of a headache to then change the password for all the scheduled tasks. &nbsp;When I tried to create a &quot;scheduled tasks account&quot; that would do nothing other than run the scheduled tasks, the GUI for the tasks wouldn&#8217;t show up for the logged-in user because it was a different account. &nbsp;</p>
<p>In the end, I found a piece of freeware, System Scheduler, that did what I wanted (behave like win9x scheduled tasks.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606213">
				<div id="div-comment-606213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">x</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606213">
			March 3, 2008 at 1:01 pm</a>		</div>

		<p>&gt;&gt; you can at least stop it by rebooting the machine</p>
<p>&#8230; and removing the Run key and possibly the root kit if you run as admin.</p>
<p>If you run an evil program you have to rebuild the machine. &nbsp;If that evil program can get your password you need to build all you machines.</p>
<div class=post>[<i>True, but at least you can contain the damage for non-administrators. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606233">
				<div id="div-comment-606233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nksingh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606233">
			March 3, 2008 at 1:02 pm</a>		</div>

		<p>@whatever:</p>
<p>As far as I know, you never decrypt stored passwords, because it isn&#8217;t encryption&#8230; it&#8217;s hashing. &nbsp;You simply cannot go backwards from hash to password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606243">
				<div id="div-comment-606243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606243">
			March 3, 2008 at 1:04 pm</a>		</div>

		<blockquote><p>
  Why do you have to enter a password twice in scheduled tasks?
</p></blockquote>
<p>Same reason you enter it twice when changing it, I would expect &#8211; confirmation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606273">
				<div id="div-comment-606273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606273">
			March 3, 2008 at 1:34 pm</a>		</div>

		<blockquote><p>
  &gt;&gt;There could be immediate feedback. &nbsp;Instead of asking for the password twice, just check it when adding the scheduled task.&lt;&lt;&lt;
</p></blockquote>
<p>Sure, but that could slow things down a bit. &nbsp;Especially if you were scheduling a task for a remote machine. &nbsp;It&#8217;s not a huge problem, but I&#8217;m just saying that immediately checking the password is not necessarily a better solution than just entering the password twice. &nbsp;Just different, and not the solution they decided to go with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606293">
				<div id="div-comment-606293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606293">
			March 3, 2008 at 1:59 pm</a>		</div>

		<p>&quot;The corresponding UNIX daemon (cron) doesn&#8217;t seem to have this limitation. So I&#8217;m curious why Windows would need the password in order to create a session for a user.&quot;</p>
<p>Because the UNIX cron runs as root and can pretend to be any user it wants (except when kerberos is used, per Gabe)</p>
<p>Whereas in Windows, not even Local System has the power to masquerade as any user &#8211; if it could, then Local System can masquerade as TrustedInstaller and do all sorts of nasty things on Vista.</p>
<p>(We all know LocalSystem has full control of the filesystem and can do anything it wants, but the challenge is to change things as if TrustedInstaller itself changed them)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606313">
				<div id="div-comment-606313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Steward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606313">
			March 3, 2008 at 2:10 pm</a>		</div>

		<blockquote><p>
  &gt;&gt;&gt;There could be immediate feedback. &nbsp;Instead of asking for the password twice, just check it when adding the scheduled task.&lt;&lt;&lt;</p>
<p>  Sure, but that could slow things down a bit. &nbsp;Especially if you were scheduling a task for a remote machine. &nbsp;It&#8217;s not a huge problem, but I&#8217;m just saying that immediately checking the password is not necessarily a better solution than just entering the password twice. &nbsp;Just different, and not the solution they decided to go with.
</p></blockquote>
<p>Also, if the password will be different by the time the task starts (or the account is only enabled at certain times), you can still create the task. &nbsp;Why check something now when you&#8217;re clearly talking about a different time?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606343">
				<div id="div-comment-606343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606343">
			March 3, 2008 at 4:21 pm</a>		</div>

		<blockquote><p>
  One problem I had with scheduled tasks that made me seek out an alternate solution is that they stopped working when I (as a good user) changed my password. &nbsp;It was too much of a headache to then change the password for all the scheduled tasks. &nbsp;When I tried to create a &quot;scheduled tasks account&quot; that would do nothing other than run the scheduled tasks, the GUI for the tasks wouldn&#8217;t show up for the logged-in user because it was a different account.&lt;
</p></blockquote>
<p>There&#8217;s a much easier way to do this. &nbsp;Tick the &quot;Run only if logged on&quot; tickbox. &nbsp;It then runs in the GUI and doesn&#8217;t need your password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606353">
				<div id="div-comment-606353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martijn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606353">
			March 3, 2008 at 4:27 pm</a>		</div>

		<p>One thing I did never get in similar respect is the shutdown utility, which I am not allowed to run as myself, although I can easily turn of the computer using the start menu&#8230;</p>
<div class=post>[<i>Works fine for me. &#8220;shutdown /h&#8221; hibernated my machine. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606373">
				<div id="div-comment-606373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabest</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606373">
			March 3, 2008 at 5:00 pm</a>		</div>

		<p>I don&#8217;t want to go off-topic, just mentioning something worth for another article. Since through remote desktop start menu doesn&#8217;t have the usuall shutdown/reboot options, and under vista even task manager lost this functionallity, I&#8217;m also using shutdown from command line. Any reason why this has to be so awkward when not being logged on locally?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606403">
				<div id="div-comment-606403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606403">
			March 3, 2008 at 5:44 pm</a>		</div>

		<p>What about the AT command? &nbsp;No password required. &nbsp;The resulting process runs as SYSTEM, and normally needs to be an Administrator to use it. &nbsp;But there&#8217;s a Registry hack that lets Operators use it. &nbsp;So obviously there&#8217;s a mechanism to start processes without a password. &nbsp;I&#8217;m guessing AT uses the &#8220;Schedule&#8221; Service (Task Scheduler) too.</p>
<div class=post>[<i>But that task doesn&#8217;t run as you. The operating system knows the schedule service&#8217;s password. It doesn&#8217;t know yours. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606413">
				<div id="div-comment-606413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606413">
			March 3, 2008 at 6:12 pm</a>		</div>

		<p>But what about application installs? They often perform operations after reboot &#8212; whose credentials they use (my guess is System/Local) then? Your token is also not present after reboot and before you login.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606433">
				<div id="div-comment-606433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yoni</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606433">
			March 3, 2008 at 6:32 pm</a>		</div>

		<p>Actually, I thought of relying on the fact that the &quot;login&quot; is done when creating the task rather than when running the program, to use tasks as a sort of &quot;setuid&quot; solution.</p>
<p>Create a task scheduled to an expired/invalid/disabled time, and configured to run as Administrator (password entered upon task creation). Then you can run the task as any user, and the program it points to will run as Administrator without prompting for password, just like setuid programs in Unix.</p>
<p>Sounds like it should work, but I wonder whether there&#8217;s a cleaner way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis even thread-even depth-1" id="comment-606443">
				<div id="div-comment-606443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606443">
			March 3, 2008 at 6:36 pm</a>		</div>

		<p>@Martijn: &nbsp;The &quot;shutdown.exe&quot; command-line utility in Windows XP has a LUA bug that prevents non-admin users from using it to shut down or restart the computer.</p>
<p>Workaround documented here:</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/aaron_margosis/archive/2006/01/27/518214.aspx" rel="nofollow">http://blogs.msdn.com/aaron_margosis/archive/2006/01/27/518214.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606023">
				<div id="div-comment-606023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">whatever</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606023">
			March 3, 2008 at 10:45 am</a>		</div>

		<p>I confess, I didn&#8217;t understand your reasoning the first time around, Raymond.</p>
<p>If some program calls the imaginary &#8220;GetPasswordOfCurrentUser&#8221; it is *already running*. There&#8217;s no need for it to get the password to do &#8220;something evil&#8221; later on, it can just do it &#8220;now&#8221; and be done with it.</p>
<p>I think the truth may be somewhat more like the fact that one never decrypts stored passwords (well, not in theory, anyway), one instead encrypts entered passwords and compares them against the encrypted stored password.</p>
<div class="post">[<i>Even if they can start doing evil now, you can at least stop it by rebooting the machine. But if they can steal your password, then they can do something evil forever. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606263">
				<div id="div-comment-606263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606263">
			March 3, 2008 at 1:27 pm</a>		</div>

		<p>&gt; If some program calls the imaginary &quot;GetPasswordOfCurrentUser&quot; it is *already running*. There&#8217;s no need for it to get the password to do &quot;something evil&quot; later on, it can just do it &quot;now&quot; and be done with it.</p>
<p>It can just do it &quot;now&quot; on the current system. &nbsp;It *can&#8217;t* (without the password) impersonate the user to a remote system (say, ebay or paypal) and do evil there.</p>
<p>(And as we all know, users *NEVER* use the same password for more than one service, right? &nbsp;Now please excuse me while I go laugh in a corner for a while&#8230;)</p>
<p>Anyway, that&#8217;s not necessarily the only reason that such an API doesn&#8217;t exist, but it&#8217;s another good reason.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606533">
				<div id="div-comment-606533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">TN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606533">
			March 3, 2008 at 10:11 pm</a>		</div>

		<p>&quot;But what about application installs? They often perform operations after reboot&#8230; &nbsp;Your token is also not present after reboot and before you login.&quot;</p>
<p>That is flawed installer logic. It is relying on most users being an Administrator and relying on people always logging in as the same user.</p>
<p>Those installers only work because most users are admins and relies on everybody being an admin and continue to promote using the computer as an admin. In other words, those installers are outmolded and should be replaced with something that doesn&#8217;t require a reboot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606543">
				<div id="div-comment-606543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606543">
			March 4, 2008 at 1:58 am</a>		</div>

		<p>@TN: They can do stuff before you log on (at least on Vista). So how does that rely on my account, which is not logged on, to be administrator?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606553">
				<div id="div-comment-606553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606553">
			March 4, 2008 at 3:35 am</a>		</div>

		<p>Drak: I would guess that the Installer service can be told to finish installation procedures after a reboot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606563">
				<div id="div-comment-606563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tepsif&#252;les</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606563">
			March 4, 2008 at 4:22 am</a>		</div>

		<p>Setting programs to run at startup is almost the same security vulnerability (runs when the user is logged in, but can&#8217;t really control her environment), and is done silently. Strange.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606573">
				<div id="div-comment-606573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">whatever</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606573">
			March 4, 2008 at 4:47 am</a>		</div>

		<p>&gt; Even if they can start doing evil now, you can at least stop it by rebooting the machine</p>
<p>The existence of viruses (or is it virii?) says that is not necessarily true.</p>
<div class="post">[<i>Sorry, I thought we had restricted to the case of non-administrators. Log the user off, power-cycle the machine, <u>don&#8217;t log the user back on</u>, do your clean-up. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606583">
				<div id="div-comment-606583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Malcolm Smih</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606583">
			March 4, 2008 at 6:12 am</a>		</div>

		<blockquote><p>
  Whereas in Windows, not even Local System has the power to masquerade as any user &#8211; if it could, then Local System can masquerade as TrustedInstaller and do all sorts of nasty things on Vista.
</p></blockquote>
<p>It is possible to give this ability to Local System (or to any other account), and I remember successfully doing this when running an SSH daemon under Cygwin. However, the masquerade will only extend as far as the local machine. Any restricted fileshares will still not accept your new identity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606603">
				<div id="div-comment-606603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606603">
			March 4, 2008 at 6:38 am</a>		</div>

		<p>Brian wrote on Monday, March 03, 2008 12:05 PM:</p>
<p>[why enter password twice]</p>
<blockquote><p>
  To guard against typos. &nbsp;You&#8217;re unlikely to typo the password the same way twice.
</p></blockquote>
<p>I do not agree. An administration password on work is &quot;such bad&quot;, I tend to type it wrong in the same way at least 5 times in a row. It is just the order of keys that is unusual, and it is against the way my fingers want to type. I am not the only person having problems with that password. (The password is required by management, thus, we are not allowed to use another one.)</p>
<p>Additionally, if your keyboard language is set wrong, or CAPS LOCK is on, or similar things, it is very likely to type it wrong in the same way multiple times.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606633">
				<div id="div-comment-606633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ingix</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606633">
			March 4, 2008 at 7:47 am</a>		</div>

		<p>Doesn&#8217;t this behaviour imply that the password is stored somewhere (even surviving a reboot) and thus makes it possible to discover it by some malicious program?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606643">
				<div id="div-comment-606643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606643">
			March 4, 2008 at 8:42 am</a>		</div>

		<blockquote><p>
  Doesn&#8217;t this behaviour imply that the password is stored somewhere (even surviving a reboot) and thus makes it possible to discover it by some malicious program?
</p></blockquote>
<p>Just about to ask the same thing.</p>
<p>Doesn&#8217;t scheduling a task involve creating such a magic cookie? And cause the same security risk? Couldn&#8217;t some malicious person/program grab that cookie and then use it?</p>
<p>Or is there an airtight hatchway involved?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-606653">
				<div id="div-comment-606653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606653">
			March 4, 2008 at 9:20 am</a>		</div>

		<p>One would presume that the password that&#8217;s stored for a scheduled task is somehow encrypted, much the way a service&#8217;s password must be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-606823">
				<div id="div-comment-606823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">whatever</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606823">
			March 4, 2008 at 12:54 pm</a>		</div>

		<p>We don&#8217;t need no steenking password! <a rel="nofollow" target="_new" href="http://www.theage.com.au/news/security/hack-into-a-windows-pc--no-password-needed/2008/03/04/1204402423638.html" rel="nofollow">http://www.theage.com.au/news/security/hack-into-a-windows-pc&#8211;no-password-needed/2008/03/04/1204402423638.html</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-606923">
				<div id="div-comment-606923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-606923">
			March 4, 2008 at 2:55 pm</a>		</div>

		<blockquote><p>
  The existence of viruses (or is it virii?)
</p></blockquote>
<p>Technically it&#8217;s viri, if you want to follow strict Latin rules.</p>
<p>But everyone says &quot;viruses&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-607033">
				<div id="div-comment-607033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607033">
			March 4, 2008 at 5:26 pm</a>		</div>

		<p>Please don&#8217;t say virii: that implies there&#8217;s a word &quot;virius&quot;. &nbsp;Computer people of late aren&#8217;t very good at inventing new words.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-607053">
				<div id="div-comment-607053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://vista-how-to.blogspot.com/' rel='external nofollow' class='url'>cyanna</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607053">
			March 4, 2008 at 6:15 pm</a>		</div>

		<p>@nksingh: &quot;You simply cannot go backwards from hash to password.&quot;</p>
<p>Uh&#8230;&#8230;<a rel="nofollow" target="_new" href="http://loginrecovery.com/" rel="nofollow">http://loginrecovery.com/</a> begs to differ and it works even if they only get the LMHash. I demo it every time I need to convince somebody to not use alpha-numeric passwords.</p>
<p>PS Virii/viruses: doctors say virii, geeks say viruses, both would sound funny using the other term.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-607123">
				<div id="div-comment-607123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607123">
			March 5, 2008 at 6:37 am</a>		</div>

		<p>for %s in (hippopotam radi vir doof b) do @echo The plural of %sus is %si</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-607293">
				<div id="div-comment-607293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607293">
			March 5, 2008 at 3:54 pm</a>		</div>

		<p>cyanna: no they don&#8217;t. &nbsp;Booksmart medics would rarely write &quot;viri&quot; (one &quot;i&quot;); it&#8217;s geeks who are obsessed with the hypercorrective &quot;virii&quot;. &nbsp;Sometimes &quot;-i&quot; is used for categorisation (like cacti), but -uses is not wrong. &nbsp;Anyway, we&#8217;re probably annoying Raymond again by being the kids at the back of the class having their own conversation&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-607303">
				<div id="div-comment-607303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607303">
			March 5, 2008 at 4:00 pm</a>		</div>

		<p>P.S. cyanna: what do you mean, &quot;if they only get the LMHash&quot;? &nbsp;LM is the easiest to crack.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-607393">
				<div id="div-comment-607393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607393">
			March 5, 2008 at 11:09 pm</a>		</div>

		<p>&quot;<a rel="nofollow" target="_new" href="http://loginrecovery.com/" rel="nofollow">http://loginrecovery.com/</a> begs to differ and it works even if they only get the LMHash&quot;</p>
<p>As Anonymous says, it&#8217;s pretty widely known that LM password hashes can be brute-forced almost instantly. You can turn LM password hash generation off if you don&#8217;t have any Win 9X machines (or NT4) on your network (and in fact, it&#8217;s turned off by default in Vista): <a rel="nofollow" target="_new" href="http://support.microsoft.com/?kbid=299656" rel="nofollow">http://support.microsoft.com/?kbid=299656</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-607443">
				<div id="div-comment-607443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">whatever</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607443">
			March 6, 2008 at 6:45 am</a>		</div>

		<blockquote><p>
  Technically it&#8217;s viri
</p></blockquote>
<p>Hey, I didn&#8217;t claim to be able to spell!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-607563">
				<div id="div-comment-607563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607563">
			March 6, 2008 at 11:47 am</a>		</div>

		<p>So cute. Too bad the password hashes needed to logon to remote machines, for the last 10 users to use this machine, are already stored in the registry with the default setup (for allowing logons while the domain controllers are unreachable).</p>
<p>These hashes cannot (easily) be reversed to passwords, but they contain all information you need to logon to another computer (using microsofts protocols).</p>
<p>Oh well, this just makes me face the choice. Save a password on the disk (and remember not to change it, ever, or you&#8217;ll be continually locked out)? Or run the service as the all-powerful system account (even if it doesn&#8217;t need such powers). Neither is secure, and neither is what I want. Suddenly I remember why my critical services do not run on Microsoft OSs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis odd alt thread-odd thread-alt depth-1" id="comment-607623">
				<div id="div-comment-607623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-607623">
			March 6, 2008 at 5:04 pm</a>		</div>

		<p>@anon re cached data for last 10 interactive users: &nbsp;Not true. &nbsp;The hashes are not stored; they are credential verifiers only &#8211; there is enough information to verify a logon and reconstitute an access token for local use, but it won&#8217;t give you anything you can use to access remote resources. &nbsp;You need to get to a DC to do that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-608253">
				<div id="div-comment-608253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pagetable.com/' rel='external nofollow' class='url'>Myria</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080303-00/?p=23243#comment-608253">
			March 8, 2008 at 12:51 am</a>		</div>

		<blockquote><p>
  Whereas in Windows, not even Local System has the power to masquerade as any user
</p></blockquote>
<p>Ever heard of NtCreateToken?</p>
<p>The more accurate answer to all this is that Windows is frequently set up for network login (domain). &nbsp;Sure, a LocalSystem process can create whatever token it likes, but the token would have no meaning outside the current machine.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

