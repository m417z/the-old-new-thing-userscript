<html>
<head>
<title>Why not use animated GIFs as a lightweight alternative to AVIs in the animation common control?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why not use animated GIFs as a lightweight alternative to AVIs in the animation common control?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 21, 2011 / year-entry #278</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>27</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Commenter Vilx- wondered why animated GIFs weren't used as the animation format for the shell animation common control. After all, "they are even more lightweight than AVIs." Animated GIFs are certainly more lightweight than general AVIs, since AVI is just a container format, so decoding a general AVI means decoding any encoding format invented now...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Commenter Vilx- wondered <a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/04/17/9553626.aspx#9554397"> why animated GIFs weren't used as the animation format for the shell animation common control</a>. After all, "they are even more lightweight than AVIs."</p>
<p> Animated GIFs are certainly more lightweight than general AVIs, since AVI is just a container format, so decoding a general AVI means decoding any encoding format invented now or in the future. On the other hand, the shell common control imposed enough limits on the type of AVIs it could handle to the point where what was left was extremely lightweight, certainly much more lightweight than an animated GIF. </p>
<p> Think about it: To use an animated GIF, you need a GIF decoder. And a GIF decoder is already significantly larger (both in terms of code and memory) than the RLE-8 decoder. Also significantly more complicated, and therefore <a href="http://www.bing.com/search?q=gif+vulnerability"> significantly more likely to have bugs</a>. Whereas RLE-8 is so simple there isn't much that can go wrong, and the RLE-8 decoder had been around since Windows&nbsp;3.0, so it was already a known quantity. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/04/08/9537051.aspx"> All you have to do to invoke the RLE-8 decoder is call <code>Set&shy;DI&shy;Bits&shy;To&shy;Device</code></a>. One line of code is hard to beat. </p>
<p> Windows&nbsp;95 did not come with a GIF decoder. Remember, Internet Explorer&nbsp;1.0 did not come with Windows&nbsp;95; it was part of the Plus! pack. As I recall, at the time Windows&nbsp;95 released to manufacturing, the Plus! pack was still under development. (And at the time the animation common control was being designed, Internet Explorer didn't exist. Heck, <i>Mosaic</i> didn't exist!) Plus the fact that the common controls were available in both 16-bit and 32-bit versions&mdash;in fact it was the 16-bit versions that were written first since Windows&nbsp;95 didn't have good Win32 support at the start of the project. More accurately, Windows&nbsp;95 didn't have <i>any</i> Win32 support at the start of the project. </p>
<p> So I'm kind of amused by the description of GIF as a lightweight animation encoding algorithm. <a href="http://www.fileformat.info/format/bmp/corion-rle8.htm"> Compared to RLE</a>, <a href="http://en.wikipedia.org/wiki/Graphics_Interchange_Format#Animated_GIF"> the GIF format</a> weighs a ton! </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (27)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-948473">
				<div id="div-comment-948473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948473">
			November 21, 2011 at 7:15 am</a>		</div>

		<p>And here I thought the answer was going to be as simple as the animated GIF standard hadn&#39;t been invented by Netscape until after Win95 was released. While the GIF standard existed, the animation extension only came out with Netscape 2.0 in 1996.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948483">
				<div id="div-comment-948483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948483">
			November 21, 2011 at 7:39 am</a>		</div>

		<p>Hey Raymond mentioned me in his blog! I&#39;m famous!!! Yay! I&#39;m going to start selling tickets to people who want to touch me!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948493">
				<div id="div-comment-948493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948493">
			November 21, 2011 at 7:39 am</a>		</div>

		<p>Not sure if this was a factor, but 1993 was when Unisys became aware that the GIF format (developed in 1987) used the LZW compression, and entered into licensing negotiations with CompuServe. So the GIF format was controversial at the time (in 95 the PNG format was developed as an intended replacement). Source: Wikipedia</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948503">
				<div id="div-comment-948503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948503">
			November 21, 2011 at 7:41 am</a>		</div>

		<p>Umm&#8230; something happened to my first comment (before the Yay). Maybe it&#39;s still in moderation, maybe not&#8230; I&#39;ll re-post just to be sure:</p>
<p>Ahh, just goes to show what I know. :) All valid points.</p>
<p>Although the animation extension was around since 1989 already. I know &#8211; I implemented GIF reader in .NET! :) True though, the spec says in Appendix D: &quot;Animation &#8211; The Graphics Interchange Format is not intended as a platform for animation, even though it can be done in a limited way.&quot; Netscape just added the looping extension. Otherwise the animation would run only once.</p>
<p>But I hadn&#39;t thought/known that the RLE8 AVI was even simpler, or that the code was already in Windows 3.0 (meaning that GIF was just born and not very popular). The gut instinct was AVI == complexity; GIF == simplicity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948513">
				<div id="div-comment-948513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948513">
			November 21, 2011 at 7:42 am</a>		</div>

		<p>Gabe, i guess the modern gif format &#8211; gif89a &#8211; got 89 ins name for a reason.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948533">
				<div id="div-comment-948533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948533">
			November 21, 2011 at 9:52 am</a>		</div>

		<p>IIRC, the other non-animated GIF variant is gif87. But without Netscape&#39;s looping feature, animation in a GIF is pretty useless, it seems to me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948543">
				<div id="div-comment-948543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RichB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948543">
			November 21, 2011 at 9:52 am</a>		</div>

		<p>@gabe:</p>
<p>There is conflicting information about when NN2 came out. The following page says NN2 with animated gif support came on September 18, 1995.</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Netscape_(web_browser)" rel="nofollow">en.wikipedia.org/&#8230;/Netscape_(web_browser)</a></p>
<p>I certainly remember animated gifs in a web browser in early 1995, so perhaps that was a beta of NN2?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948553">
				<div id="div-comment-948553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Miff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948553">
			November 21, 2011 at 9:53 am</a>		</div>

		<p>The source of those comments is more then likely people associating AVI with something like MJPEG or XVID.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948563">
				<div id="div-comment-948563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948563">
			November 21, 2011 at 10:00 am</a>		</div>

		<p>AVI support is included in video for windows, which was released years ahead of any 32-bit ms os. WfV is a pluggable architecture, with support for ANY codec. You could implement a gif codec as a VfW codec.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948583">
				<div id="div-comment-948583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MikeCaron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948583">
			November 21, 2011 at 10:06 am</a>		</div>

		<p>640k: Yes, that is certainly a good way to use GIFs as a lightweight animation! Just embed a movie player!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948603">
				<div id="div-comment-948603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948603">
			November 21, 2011 at 12:04 pm</a>		</div>

		<p>@640k</p>
<p>Video for Windows: November 1992</p>
<p>Windows NT 3.1: July 1993</p>
<p>And knowing is half the battle!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948613">
				<div id="div-comment-948613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Silly</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948613">
			November 21, 2011 at 3:42 pm</a>		</div>

		<p>ASCII: The best animation format ever!!</p>
<p><a rel="nofollow" target="_new" href="http://www.asciimation.co.nz/" rel="nofollow">http://www.asciimation.co.nz/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948623">
				<div id="div-comment-948623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948623">
			November 21, 2011 at 4:30 pm</a>		</div>

		<p>&quot;(And at the time the animation common control was being designed, Internet Explorer didn&#39;t exist. Heck, Mosaic didn&#39;t exist!&quot;</p>
<p>Mosaic for Windows came out in 1993.</p>
<div class="post">[<i>I don&#39;t know the exact date, but the animation common control was designed around 1990ish I think. (Count the number of hedge words.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-948633">
				<div id="div-comment-948633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948633">
			November 21, 2011 at 5:43 pm</a>		</div>

		<p>Back in the Win3.X days, the only animation formats that I know are AVI and FLIC. In my secondary school, one of my friend possess God like animated 3D graphics skill (in the eyes of me, of course) and chained many 486 machines in computer room to render movies for competition.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948573">
				<div id="div-comment-948573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948573">
			November 21, 2011 at 10:01 am</a>		</div>

		<p>Prior to Netscape&#39;s use of GIFs for animation, GIFs were not thought of as a means of conveying animation. Had Netscape not chosen GIF as its animation format in 1995 (or &#39;96, or &#39;94), the question would have never been asked because nobody would think of GIF as an animation format.</p>
<p>The extensions added by CompuServe in 1989 were not intended to facilitate animation. They are capable of describing animation, but it seems the Graphic Control Extension (which allows you to specify a delay) was intended for something more like specifying PowerPoint-like slideshow presentations. I say this because it specifies the delay in increments of 0.01 sec (rather than ms or fps), it allows you to specify that the previous contents be displayed after a frame is shown, and there is a flag to indicate that user interaction (like a key press or mouse click) is called for. They also added an extension for showing text.</p>
<p>I mean, sure, you could use a GIF for animation, but at that point what format *can&#39;t* you use for animation? You may as well have asked why they didn&#39;t use TIFF, for example. It already has multiple image support and RLE compression (though I understand it&#39;s the Mac format).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948663">
				<div id="div-comment-948663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948663">
			November 22, 2011 at 2:16 am</a>		</div>

		<p>@Gabe: The problem with TIFF is that it&#39;s almost like AVI &#8211; it supports a ton of different encodings, and there&#39;s no guarantee that the TIFF you have will open in every program that claims to support TIFF (or that such program will be able to create a TIFF file that a different program will be able to open).</p>
<p>(Also, what idiots wrote this blog software &#8211; having to post everything twice is not good UX.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948673">
				<div id="div-comment-948673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948673">
			November 22, 2011 at 2:26 am</a>		</div>

		<p>Presumably I failed to understand Raymond, or maybe Windows 95 really does owe nothing to Win32s or WinNT.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948683">
				<div id="div-comment-948683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948683">
			November 22, 2011 at 5:25 am</a>		</div>

		<p>@Neil:</p>
<p>Win95 should owe a lot to both. The Win32 API which was used is what was designed for Windows NT. Win32s was an addon for Windows 3.x that allowed it to run in proper 32 bit mode.</p>
<p>What Raymond really said, was at the start of the Windows 95 project, the initial builds were 16 bit. 32 bit support was built into it later. It was at that point where they used the knowledge gained from Win32s and the API from Windows NT to get the 32 bit support in Windows 95.</p>
<p>I&#39;m sure if you look at it&#39;s architecture, you would find a lot of similarities between Windows 95 and Windows 3.11 with Win32s.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948783">
				<div id="div-comment-948783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948783">
			November 22, 2011 at 8:50 am</a>		</div>

		<p>Animated GIF is a lot more bloaty than it needs to be. &nbsp;It seems to have been designed to allow the LZW dictionary to be reused across frames but later specs preclude this, presumably because nobody implemented it properly.</p>
<p>And even if Internet Explorer had existed in the Win95 timeframe, you wouldn&#39;t have wanted to use the animated GIF support: it&#39;s dreadful. &nbsp;When it displays a frame it seems to be decoding the entire GIF as far as that frame, so playback becomes progressively slower.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948813">
				<div id="div-comment-948813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948813">
			November 22, 2011 at 9:36 am</a>		</div>

		<p>You should either decode entire GIF or at least keep last decoded frame, because frames (can) be stored as &quot;changes&quot; from from previous frame by mean of using smaller region, i.e. new frame should be placed ontop of old one, so yes, if you need to access last frame you may have to decode all previous frames.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948883">
				<div id="div-comment-948883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948883">
			November 22, 2011 at 11:47 am</a>		</div>

		<blockquote><p>
  You should either decode entire GIF or at least keep last decoded frame, because frames (can) be stored as &quot;changes&quot; from from previous frame by mean of using smaller region, i.e. new frame should be placed ontop of old one, so yes, if you need to access last frame you may have to decode all previous frames.
</p></blockquote>
<p>You&#39;d have to keep multiple frames in memory though, wouldn&#39;t you? &nbsp;And at least two of them (current and previous) could never be swapped out? &nbsp;Something you wouldn&#39;t think twice about nowadays of course, but back then&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-948933">
				<div id="div-comment-948933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948933">
			November 22, 2011 at 3:53 pm</a>		</div>

		<p>@mh:</p>
<p>You only have to keep two frames in memory: the one displayed on the screen and the one you&#39;re updating. &nbsp;When you want to display the next frame you load the next delta from the gif file (which is often much smaller than a frame) and calculate the new frame in the off-screen copy.</p>
<p>If you decode the gif from the beginning of the file for each frame (as IE seems to) you need just as much memory for the decoding AND you need to re-read much of the gif file (or keep the whole thing in memory). &nbsp;You&#39;ll often need to do this ten or twenty times a second, in which case the gif data will never be paged out. &nbsp;So you actually use more memory.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-948753">
				<div id="div-comment-948753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Topley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-948753">
			November 22, 2011 at 8:23 am</a>		</div>

		<p>@Crescens2k: </p>
<p>Win32s was an add-on for Windows 3.x that allowed it to run *some* 32-bit software by providing a subset of the Win32 API as implemented in early versions of Windows NT. The &quot;s&quot; in Win32s actually stood for &quot;subset&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-949083">
				<div id="div-comment-949083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-949083">
			November 23, 2011 at 6:28 am</a>		</div>

		<p>@John Topley</p>
<p>win32s was more than a strict subset, it was a completely different enviroment.</p>
<p>Proof: Some win32s programs (freecell) doesn&#39;t work in real 32-bit windows os.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-949353">
				<div id="div-comment-949353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-949353">
			November 24, 2011 at 12:47 am</a>		</div>

		<p>@640k: I&#39;ve got Windows 3.1 with Win32s installed in DOSBox, and Freecell that ships with Win32s works just fine on my Windows 7 x64 (it also works in Windows 95 in VMWare).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-949783">
				<div id="div-comment-949783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-949783">
			November 26, 2011 at 8:33 pm</a>		</div>

		<p>&quot;Plus the fact that the common controls were available in both 16-bit and 32-bit versions—in fact it was the 16-bit versions that were written first since Windows 95 didn&#39;t have good Win32 support at the start of the project.&quot;</p>
<p>BTW, why was the 16-bit COMMCTRL and new functions in 16-bit KRNL386/USER/GDI in Win9x never officially documented, at least in release documentation?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-949793">
				<div id="div-comment-949793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111121-00/?p=9073#comment-949793">
			November 27, 2011 at 12:15 am</a>		</div>

		<p>@Yuhong Bao: My guess is they wanted every one out of 16-bit giving every incetive to move. Provide and documetn new api in 16-bít and they just stay there&#8230;</p>
<p>(We are sometimes quite lazy ;) )</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

