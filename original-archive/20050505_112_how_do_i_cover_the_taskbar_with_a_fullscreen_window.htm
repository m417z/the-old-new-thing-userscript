<html>
<head>
<title>How do I cover the taskbar with a fullscreen window?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I cover the taskbar with a fullscreen window?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 5, 2005 / year-entry #113</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>44</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">For some reason, people think too hard. If you want to create a fullscreen window that covers the taskbar, just create a fullscreen window and the taskbar will automatically get out of the way. Don't go around hunting for the taskbar and poking it; let it do its thing. As always, start with the scratch...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
For some reason,
<a HREF="http://groups.google.com/groups?selm=jko6s0pgvb9mnehtrgkd0louoe284jqojf@4ax.com">
people think too hard</a>.
If you want to create
a fullscreen window that covers the taskbar, just create a fullscreen
window and the taskbar will automatically get out of the way.
Don't go around hunting for the taskbar and poking it; let it do its thing.
</p>
<p>
As always, start with
<a href="http://blogs.msdn.com/oldnewthing/archive/2003/07/23/54576.aspx">
the scratch program</a> and add the following:
</p>
<pre>
HWND CreateFullscreenWindow(HWND hwnd)
{
 HMONITOR hmon = MonitorFromWindow(hwnd,
                                   MONITOR_DEFAULTTONEAREST);
 MONITORINFO mi = { sizeof(mi) };
 if (!GetMonitorInfo(hmon, &amp;mi)) return NULL;
 return CreateWindow(TEXT("static"),
       TEXT("something interesting might go here"),
       WS_POPUP | WS_VISIBLE,
       mi.rcMonitor.left,
       mi.rcMonitor.top,
       mi.rcMonitor.right - mi.rcMonitor.left,
       mi.rcMonitor.bottom - mi.rcMonitor.top,
       hwnd, NULL, g_hinst, 0);
}

void OnChar(HWND hwnd, TCHAR ch, int cRepeat)
{
 if (ch == TEXT(' ')) {
  CreateFullscreenWindow(hwnd);
 }
}

    HANDLE_MSG(hwnd, WM_CHAR, OnChar);
</pre>
<p>
Note that this sample program doesn't worry about destroying that
fullscreen window or preventing the user from creating more than one.
It's just a sample.
The point is seeing how the <code>CreateFullScreenWindow</code> function
is written.
</p>
<p>
We use
<a HREF="http://msdn.microsoft.com/library/en-us/gdi/monitor_2m5z.asp">
the <code>MonitorFromWindow</code> function</a>
to figure out which monitor we should go fullscreen to.
Note that in a multiple monitor system, this might not be the same
monitor that the taskbar is on.  Fortunately, we don't have to worry
about that; the taskbar figures it out.
</p>
<p>
I've seen people hunt for the taskbar window and then do
a <code>ShowWindow(hwndTaskbar, SW_HIDE)</code> on it.
This is nuts for many reasons.
</p>
<p>
First is a mental exercise you should always use when evaluating
tricks like this: "What if two programs tried this trick?"
Now you have two programs both of which think they are in charge
of hiding and showing the taskbar, neither of which is coordinating
with the other.  The result is a mess.  One program hides
the taskbar, then the other does, then the first decides it's finished
so it unhides the taskbar, but the second program wasn't finished yet
and gets a visible taskbar when it thought it should be hidden.
Things only go downhill from there.
</p>
<p>
Second, what if your program crashes before it gets a chance
to unhide the taskbar?
The taskbar is now permanently hidden
and the user has to log off and back on to get their taskbar back.
That's not very nice.
</p>
<p>
Third, what if there is no taskbar at all?
It is common in Terminal Server scenarios to
<a HREF="http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/ServerHelp/1a7b1894-e095-4cbc-9a9d-a8ae14e2a1bd.mspx">
run programs by themselves without Explorer</a>
[<a HREF="http://web.archive.org/web/20030713202609/http://www.microsoft.com/windowsxp/home/using/productdoc/en/mstsc_start_program.asp">archived</a>].
In this configuration, there is no Explorer, no taskbar.
Or maybe you're running on a future version of Windows
that doesn't have a taskbar,
it having been replaced by some other mechanism.
What will your program do now?
</p>
<p>
Don't do any of this messing with the taskbar.
Just create your fullscreen window and let the taskbar do its thing
automatically.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (44)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-274153">
				<div id="div-comment-274153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">meh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274153">
			May 5, 2005 at 9:07 am</a>		</div>

		<p>Your coding style has little to be desired. Do you normally code that way to be difficult to read with bad indenting?  Glad you dont work here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274163">
				<div id="div-comment-274163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.cataraxia.com/' rel='external nofollow' class='url'>Kristoffer Henriksson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274163">
			May 5, 2005 at 9:10 am</a>		</div>

		<p>Come on now, that&#8217;s just rude. Code style is a relative thing; what looks perfectly readable to you may not be to someone not used to it.</p>
<p>Back on topic, it seems like lots of programmers purposely look for the hardest way to do something. Instead of just creating a full size window and seeing what the task bar does they start out by assuming that they need to write complicated code to hide the task bar.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274173">
				<div id="div-comment-274173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sriram</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274173">
			May 5, 2005 at 9:11 am</a>		</div>

		<p>The link to the Terminal Server page is throwing a 404 &#8211; guess there&#8217;s a typo there</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-274183">
				<div id="div-comment-274183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274183">
			May 5, 2005 at 9:24 am</a>		</div>

		<p>No this isn&#8217;t my normal coding style. I have to alter it to conserve space and because nobody wants to read 200 lines of boring code in a blog entry.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274203">
				<div id="div-comment-274203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Elliott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274203">
			May 5, 2005 at 9:41 am</a>		</div>

		<p>I reckon if a future version of Windows doesn&#8217;t have a taskbar, it&#8217;ll still be forced to pretend it does, for compatibility with misbehaved apps; the same way that there&#8217;s still a PROGMAN window for installers to have DDE conversations with in WinXP.<br />
<br />Then again, the ill-behaved program could be running on NT 3.51 which certainly doesn&#8217;t have a taskbar.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274233">
				<div id="div-comment-274233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bleh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274233">
			May 5, 2005 at 10:13 am</a>		</div>

		<p>Coding style is not a relative thing when trying to convey information or in a workplace.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274243">
				<div id="div-comment-274243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Massuda</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274243">
			May 5, 2005 at 10:15 am</a>		</div>

		<p>The link &quot;run programs by themselves without Explorer&quot; is broken.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274253">
				<div id="div-comment-274253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274253">
			May 5, 2005 at 10:20 am</a>		</div>

		<p>My apologies if this is too off-topic.</p>
<p>I use an autohide taskbar, and there are times that I&#8217;m using a maximized application, and moving the cursor to the edge of the window where the taskbar is hiding doesn&#8217;t bring up the taskbar.  I have to Alt-Tab to another application or use the windows key to bring it up.  This doesn&#8217;t happen all the time, and I haven&#8217;t been able to find any pattern to the behavior.  I&#8217;m pretty sure that the applications aren&#8217;t doing anything intentionally to cause this, because one of them is VS.NET 2003, and another is my application.  It also happens to some of our customers.  I don&#8217;t imagine that VS is doing anything, and I know I&#8217;m not messing with the taskbar.  I&#8217;m also not using CreateFullscreenWindow().</p>
<p>Is there anything else that will block access to the taskbar?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274263">
				<div id="div-comment-274263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274263">
			May 5, 2005 at 10:23 am</a>		</div>

		<p>The expression is &quot;leaves a lot to be desired&quot;.  What you said is actually a compliment, it says that his coding style is almost perfect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274273">
				<div id="div-comment-274273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274273">
			May 5, 2005 at 10:26 am</a>		</div>

		<p>Uh, ignore that last comment, I read it as &quot;leaves little&quot;, not &quot;has little&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274283">
				<div id="div-comment-274283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274283">
			May 5, 2005 at 10:30 am</a>		</div>

		<p>Now that we know how to make a full screen window, I ask that the developers out there use this feature sparingly.  Such a feature could easly be abused.  I personally like my taskbar and don&#8217;t want it covered except in limited instances such as full screen games (e.g. Unreal Tournament), and maybe the occasional full screen web browsing session.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mike-dimmick odd alt thread-odd thread-alt depth-1" id="comment-274293">
				<div id="div-comment-274293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Mike+Dimmick' rel='external nofollow' class='url'>Mike Dimmick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274293">
			May 5, 2005 at 10:34 am</a>		</div>

		<p>I think the link should be <a rel="nofollow" target="_new" href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/mstsc_start_program.mspx" rel="nofollow">http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/mstsc_start_program.mspx</a>. Terminal Services allows you to specify a program to be started &#8211; in effect that program is then the shell. When that program is closed, your session ends. You can still disconnect from the server, and leave the program running, as usual.</p>
<p>Another case where Explorer isn&#8217;t the shell is if you boot in &#8216;Safe Mode with Command Prompt&#8217;. In this case your shell is CMD.EXE, the NT command interpreter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274313">
				<div id="div-comment-274313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frank</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274313">
			May 5, 2005 at 10:42 am</a>		</div>

		<p>Should that not be:<br />
<br />mi.rcMonitor.right &#8211; mi.rcMonitor.left + 1<br />
<br />and<br />
<br />mi.rcMonitor.bottom &#8211; mi.rcMonitor.top + 1<br />
<br />??</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274303">
				<div id="div-comment-274303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://developmentscience.com' rel='external nofollow' class='url'>Mike Weiss</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274303">
			May 5, 2005 at 10:47 am</a>		</div>

		<p>&lt;quote&gt;<br />
<br />Or maybe you&#8217;re running on a future version of Windows that doesn&#8217;t have a taskbar, it having been replaced by some other mechanism. What will your program do now?<br />
<br />&lt;/quote&gt;</p>
<p>Clearly these application wouldn&#8217;t even run. They&#8217;d either crash from sending a undocumented windows messages to explorer and mucking with internal data structures (now changed in Windows 2020)&#8230; or adding 60 to the NM_DBLCLK notify struct for coords, or maybe they&#8217;d simply refuse to start with incorrectly OS version checks&#8230; geesh I think I read this blog WAY too much&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274323">
				<div id="div-comment-274323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.involution.com' rel='external nofollow' class='url'>Tony Perrie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274323">
			May 5, 2005 at 11:01 am</a>		</div>

		<p>Meh, what are you on, man?  Raymond is a lvl 900 ninja coder.  He could cast a 1200 damage VC++ spell as an afterthought.  Also, he knows Itanium assembly.  Pour out your Haterade.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274333">
				<div id="div-comment-274333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274333">
			May 5, 2005 at 11:53 am</a>		</div>

		<p>Ah, but what will your program do when, in the future, people have stopped using monitors altogether and are using retina implants?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274343">
				<div id="div-comment-274343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274343">
			May 5, 2005 at 11:55 am</a>		</div>

		<p>meh, when you have spent fifteen years like Raymond has, helping literally millions of developers via USENET and this blog, when you have personally developed major parts of the most widely used operating system in the world, when you have an incredibly deep knowledge of Windows programming and can share it with Raymond&#8217;s amazing clarity,  then come back here and complain about the standard of a code sample.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-274353">
				<div id="div-comment-274353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274353">
			May 5, 2005 at 12:04 pm</a>		</div>

		<p>Frank: Try it and see. Report back your findings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274363">
				<div id="div-comment-274363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274363">
			May 5, 2005 at 12:20 pm</a>		</div>

		<p>I use Aloe Vera impregnated kitchen towels after I stop kissing Raymond&#8217;s bottom as it leaves my goate beard smoother and refreshed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274373">
				<div id="div-comment-274373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://oswaldproject.blogspot.com' rel='external nofollow' class='url'>D. Philippe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274373">
			May 5, 2005 at 12:34 pm</a>		</div>

		<p>This is slight OT:</p>
<p>In WinCE, the taskbar doesn&#8217;t play nicely.  A maximized, fullscreen app will still be covered by the taskbar because by default the &quot;Always on top&quot; option is turned on and the &quot;Auto hide&quot; option is turned off.  This is normal.</p>
<p>But what is not normal is that an app can set the registry keys[1] to hide the taskbar and then broadcast a WM_SETTINGCHANGE message (or send a WM_WININICHANGE message) and the taskbar will ignore it.</p>
<p>The only way to coax the taskbar to abide by its settings as the shell loads is to set these keys in the registry via the Platform Builder, which most app writers don&#8217;t have access to.</p>
<p>One of the common solutions in the CE newsgroups to this problem has been to use FindWindow(&quot;HHTaskBar&quot;) to find and hide the taskbar.</p>
<p>So I guess my point, if I have one, is that sometimes people think too hard, but other times they&#8217;re forced into bad solutions by people who didn&#8217;t think hard enough.</p>
<p>[1]<br />
<br />HKLMSOFTWAREMicrosoftShellOnTop<br />
<br />HKLMSOFTWAREMicrosoftShellAutoHide</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-274383">
				<div id="div-comment-274383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274383">
			May 5, 2005 at 12:49 pm</a>		</div>

		<p>Where is it documented that whacking registry keys is the correct way to change Taskbar settings on WinCE? Tomorrow I&#8217;ll talk about the documented way of changing Taskbar settings on XP. And it doesn&#8217;t involve whacking registry keys.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274393">
				<div id="div-comment-274393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://oswaldproject.blogspot.com' rel='external nofollow' class='url'>D. Philippe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274393">
			May 5, 2005 at 1:08 pm</a>		</div>

		<p>Raymond: Since the Taskbar itself sets this registry key when a user clicks the &quot;Always on top&quot; checkbox, it seems a little bit heavy-handed to call it &quot;whacking the registry,&quot; doesn&#8217;t it?</p>
<p>At any rate, I&#8217;m looking forward to tomorrow&#8217;s post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274403">
				<div id="div-comment-274403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.michaelruck.de/technical' rel='external nofollow' class='url'>Michael Ruck</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274403">
			May 5, 2005 at 1:52 pm</a>		</div>

		<p>Raymond,</p>
<p>maybe you can answer this question: Your code above does create a proper fullscreen window. I&#8217;ve been using similar code for my fullscreen windows, yet some applications e.g. MSN Messenger push their toast windows on top of mine, even though the TOPMOST style bit is set. Other apps, such as Windows Media Player don&#8217;t get the toasts pushed on top of them &#8211; how is an application supposed to detect the presence of a fullscreen app and specifically how does Messenger do it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-274413">
				<div id="div-comment-274413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274413">
			May 5, 2005 at 2:22 pm</a>		</div>

		<p>The Taskbar is allowed to modify its internal data. But other people aren&#8217;t. I fail to see what&#8217;s so unfair about this. I&#8217;m sure your code prbably wasn&#8217;t designed for other programs to mess with its internal data structures either.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-274423">
				<div id="div-comment-274423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274423">
			May 5, 2005 at 2:30 pm</a>		</div>

		<p>MSN Messenger toasts appear on top of my Media Player window. Maybe yours is configured differently? You can have multiple topmost windows and clearly only one of them can win.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274433">
				<div id="div-comment-274433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.jasmusic.com' rel='external nofollow' class='url'>Joshua Schaeffer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274433">
			May 5, 2005 at 2:34 pm</a>		</div>

		<p>Frank, RECT&#8217;s in Windows have 1 added to the right and the bottom for a number of reasons that I believe Raymond discussed months ago in this blog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008195987d even thread-even depth-1" id="comment-274443">
				<div id="div-comment-274443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Spire' rel='external nofollow' class='url'>Spire</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274443">
			May 5, 2005 at 2:53 pm</a>		</div>

		<p>One widely used program that hunts for the taskbar window and explicitly hides it is Apple&#8217;s QuickTime Player, when the user plays a file full-screen using Ctrl+F.</p>
<p>What makes it worse is that QuickTime Player often fails to unhide the taskbar window when it comes back out of full-screen mode. It&#8217;s infuriating.</p>
<p>It happens often enough that I ended up writing a tiny utility that hunts for the taskbar window and unhides it, and binding that utility to a global keyboard shortcut.</p>
<p>Maybe the upcoming QuickTime 7 will finally fix the problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274193">
				<div id="div-comment-274193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://q.queso.com/' rel='external nofollow' class='url'>Jason</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274193">
			May 5, 2005 at 9:31 am</a>		</div>

		<p>Honestly, I stopped counting the number of times I&#8217;ve found myself needing to restart the Explorer process to get my taskbar back; likewise, I stopped counting the number of uninstallers I&#8217;ve run to get rid of the programs that forced me to do that. :)  Good advice, indeed, Raymond.</p>
<p>(And lemme give you a hint, meh &#8212; you&#8217;d absolutely *kill* to have Raymond working wherever you happen to have found a sucker gullible enough to hire you.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274463">
				<div id="div-comment-274463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">boxmonkey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274463">
			May 5, 2005 at 4:31 pm</a>		</div>

		<p>Raymond,<br />
<br />Your reaction to people &quot;whacking&quot; the registry reminded me of this snippet from MS&#8217;s tweakomatic utility (<a rel="nofollow" target="_new" href="http://www.microsoft.com/technet/scriptcenter/tools/twkmatic.mspx#EJAA" rel="nofollow">http://www.microsoft.com/technet/scriptcenter/tools/twkmatic.mspx#EJAA</a>) documentation.</p>
<p>As you probably know, Microsoft has a sort of love-hate relationship with the registry. The registry is the configuration database for Windows and Windows applications, and many options can only be set by manually changing a value in the registry. For example, if you’ve ever read a Microsoft Knowledge Base article, you’ve likely seen a sentence similar to this:</p>
<p>“To correct this problem, change the following value in the registry.”</p>
<p>Now that’s fine, except that this sentence is invariably followed by a disclaimer similar to this one:</p>
<p>Warning<br />
<br />Don’t ever change a value in the registry. Ever. We know we just told you to do that, but would you jump off a cliff if we told you to? Don’t ever change a value in the registry. Don’t even say the word registry. We know a guy once who said the word registry, and three days later he was hit by a bus. True story. As a matter of fact, you shouldn’t even have a registry on your computer. If you suspect that you do have a registry on your computer, please call us and a trained professional will be dispatched to your office to remove the registry immediately. If you accidentally touch the registry, wash your hands with soap and water and call a doctor. Do not swallow the registry or get it in your eyes!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274223">
				<div id="div-comment-274223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274223">
			May 5, 2005 at 10:11 am</a>		</div>

		<p>You can use shells other than Explorer on any version of Windows, and then you&#8217;ll likely have no taskbar.  I doubt it would cause any trouble with naughty apps in this case, in fact it might be better because then they won&#8217;t succeed in hiding the shell&#8217;s goodies.</p>
<p>The interesting thing for me is *how* the shell detects a full-screen window.  IIRC there&#8217;s a notification, but it&#8217;s not entirely reliable.  (ISTR that IE windows can give false positives or somesuch)  Then there&#8217;s ITaskbarList2::MarkFullscreenWindow, but I doubt many use it.  (new in XP)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274483">
				<div id="div-comment-274483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274483">
			May 5, 2005 at 5:54 pm</a>		</div>

		<p>I think boxmonkey is referring to the fact that most of the settings that Tweakomatic allows you to tweak are THROUGH the registry and not through some API&#8230; [Check out all the Windows Explorer related settings in Tweakomatic!]</p>
<p>Therefore, it seems like in some cases even MS acknowledges that tweaking settings (NOT troubleshooting) through messing with the registry is OK.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-274493">
				<div id="div-comment-274493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274493">
			May 5, 2005 at 6:37 pm</a>		</div>

		<p>Specifically, you mean that the Tweakomatic part of MS approves of registry hacking. The shell team disapproves.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274503">
				<div id="div-comment-274503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274503">
			May 5, 2005 at 7:03 pm</a>		</div>

		<p>Yes, except I don&#8217;t see how anyone not working with or for Microsoft can fathom this difference.</p>
<p>[OK, I&#8217;m being obtuse. You can if you try hard enough &#8212; but it seems that life would be easier if at least MS could present a consistent face to the external world.]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274513">
				<div id="div-comment-274513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274513">
			May 5, 2005 at 8:51 pm</a>		</div>

		<p>Yes, I know I always expect HP&#8217;s printer, server, and soho sales departments to always be in sync in prices, PR, strategy, and best practices. Because everything the company does gets vetted by the CEO. Right?</p>
<p>MS is the same as HP or IBM, with gazillions of departments; just because they almost all do software or software support doesn&#8217;t mean they&#8217;re on the same page.</p>
<p>Besides, tweakomatic comes with one of those huge DO THIS AT YOUR OWN RISK disclaimers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even thread-even depth-1" id="comment-274473">
				<div id="div-comment-274473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274473">
			May 5, 2005 at 4:34 pm</a>		</div>

		<p>Sigh. Apparently people fail to distinguish between information for *troubleshooting* purposes and information for general use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274523">
				<div id="div-comment-274523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2005/05/06/415158.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274523">
			May 6, 2005 at 2:20 pm</a>		</div>

		<p>Use SHAppBarMessage</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274553">
				<div id="div-comment-274553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil Hodgson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274553">
			May 6, 2005 at 5:48 pm</a>		</div>

		<p>I posted a comment here last night (regarding the need for documentation and the tweaks needed for frame windows to go full screen) and it received a couple of replies but is no longer here. If this was deliberate, that is fine but it didn&#8217;t appear controversial to me so could indicate that the site software has problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-274563">
				<div id="div-comment-274563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274563">
			May 6, 2005 at 5:58 pm</a>		</div>

		<p>The server software is being upgraded &#8211; I&#8217;m told that comments lost during the upgrade will be restored when the upgrade is complete.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274573">
				<div id="div-comment-274573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274573">
			May 7, 2005 at 12:22 am</a>		</div>

		<p>Neil, forget what I said earlier about the WS_POPUP window style. What matters is whether the window has a title bar and a sizing border (WS_CAPTION+WS_THICKFRAME), see &quot;Taskbar Display Options&quot; at MSDN:<br />
<br /><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_int/shell_int_programming/taskbar.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/programmersguide/shell_int/shell_int_programming/taskbar.asp</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-274613">
				<div id="div-comment-274613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JDM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274613">
			May 7, 2005 at 9:57 am</a>		</div>

		<p>Oops.. in my previous comment I meant to say<br />
<br />&quot;applications like MSN Messenger&quot;, but I left off<br />
<br />the &quot;Messenger&quot; by mistake.  Also, I wanted to clarify that I realize WM_PAINT gets sent when one window has moved over another, but I just wanted to know if there was a more specific message (b/c WM_PAINT could have been sent for any number of reasons, especially in a game).<br />
<br />Thanks, in advance, anyone who cares to respond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-274603">
				<div id="div-comment-274603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JDM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274603">
			May 7, 2005 at 9:58 am</a>		</div>

		<p>Michael Ruck had posted about applications like<br />
<br />MSN, that also use topmost windows, appearing on top of your fullscreen window.  I was curious about the same thing.  Sorry if this is a dumb question, but I am new to Win32 programming and have not found an answer to it using search engines or MSDN.  Is there a message that gets posted to a window when another window appears above any part of it?  I am guessing that if one were to handle that message, they could push the offending window back under the fullscreen window (assuming this is in an application like a game, where you would want to do that b/c some people do not want other things appearing while they are playing).  Is that wrong, or is there an easier way?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-274643">
				<div id="div-comment-274643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-274643">
			May 7, 2005 at 1:49 pm</a>		</div>

		<p>&quot;push the offending window back&quot; &#8211; That just creates an arms race. More on this subject on June 7th.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275913">
				<div id="div-comment-275913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Bacarella</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-275913">
			May 13, 2005 at 6:04 pm</a>		</div>

		<p>Speaking of leaving the taskbar alone&#8230;</p>
<p>Not that I&#8217;ve ever had spyware on my own PC, but I thought I&#8217;d try out Microsoft &quot;AntiSpyware Beta&quot;.  I ran a scan and then forgot about it.</p>
<p>A few hours later, when I tried to start Cygwin, a notification window warning me about something or other comes up.  The window slides up from the bottom right corner of the screen and perches itself atop the taskbar.</p>
<p>Of course, that&#8217;s what it was trying to do.  But since I align my taskbar to the right of the screen, instead the notification just shot upwards until it fell off the top of my screen. </p>
<p>It was kind of cute.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-702553">
				<div id="div-comment-702553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hilpers.com/954263-taskleiste-ausblenden' rel='external nofollow' class='url'>Taskleiste ausblenden | hilpers</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050505-04/?p=35703#comment-702553">
			January 20, 2009 at 10:53 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.hilpers.com/954263-taskleiste-ausblenden" rel="nofollow">http://www.hilpers.com/954263-taskleiste-ausblenden</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

