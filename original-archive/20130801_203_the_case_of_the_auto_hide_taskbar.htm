<html>
<head>
<title>The case of the auto-hide taskbar</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>The case of the auto-hide taskbar</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>August 1, 2013 / year-entry #204</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>43</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer reported that their taskbar would sometimes spontaneously go into auto-hide mode. What made this particularly insidious was that they had deployed a group policy to prevent users from changing the auto-hide state (because they never wanted the taskbar to auto-hide), so when the taskbar went into auto-hide mode, there was no way to...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer reported that their taskbar would sometimes
spontaneously go into auto-hide mode.
What made this particularly insidious was that they
had deployed a group policy to
prevent users from changing the auto-hide state
(because they never wanted the taskbar to auto-hide),
so when the taskbar went into auto-hide mode,
there was no way to get it out of that mode!
</p>
<p>
The customer's first investigation was to find out
where the auto-hide state was recorded.
A little bit of registry spelunking
(because as far as these people are concerned,
<i>everything</i> is in the registry)
showed that a single bit in the
<code>StuckRects2</code> registry value controlled
the auto-hide setting.
They used
<a HREF="http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx">
Process Monitor</a>
and observed that it was Explorer that was updating the value.
That was as far as they could troubleshoot the problem
and came to the Windows team for further guidance.
</p>
<p>
It turns out that watching the registry value get updated
doesn't tell you anything interesting.
Explorer always writes that value when you log off,
and the value written is the taskbar's current auto-hide state.
The real culprit is the person who <i>changed</i> the taskbar's state,
causing Explorer to save the updated state at logoff.
And that culprit is somebody who called
<code>SHApp&shy;Bar&shy;Message</code> with the
<code>ABM_<wbr>SETSTATE</code> parameter,
in order to turn on the <code>ABS_<wbr>AUTOHIDE</code> bit.
</p>
<p>
I warned you many years ago that
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2005/05/06/415158.aspx">
the auto-hide and always-on-top
states are user settings</a>,
and programs should modify them only under the instructions of the user.
</p>
<p>
The support technician was able to put together an
instrumented version of the
<code>SHApp&shy;Bar&shy;Message</code> function
that logged any attempt to put the taskbar into auto-hide mode.
(This step took a little while because the first attempt wasn't
quite right and ended up not working.)
</p>
<p>
A few days later, the support technician reported back:
The culprit was found with his hand in the cookie jar!
One of the applications the customer was using was indeed calling
<code>SHApp&shy;Bar&shy;Message</code> with the
<code>ABM_<wbr>SETSTATE</code> parameter,
and passing the
<code>ABS_<wbr>AUTOHIDE</code> flag to make the taskbar auto-hide,
and the application never called the function again to restore
it back to normal.
Result:
Taskbar goes to auto-hide and stays there.
</p>
<p>
Mind you, even if the application remember to set the auto-hide flag
back to its original value, that still wouldn't have been the correct
solution.
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2005/06/07/426294.aspx">
Suppose two programs did this</a>.
</p>
<pre>
bool fWasTaskbarAutoHide;

OnStartup()
{
    fWasTaskbarAutoHide = GetTaskbarAutoHideState();
    SetTaskbarAutoHide(true);
}

OnExit()
{
    SetTaskbarAutoHide(fWasTaskbarAutoHide);
}
</pre>
<p>
The user first runs the other program, which remembers that the taskbar
is not auto-hide, then sets it to auto-hide.
Now the user runs your program, which remembers that the taskbar is
auto-hide, and then sets the taskbar (redundantly) to auto-hide.
The user exits the first program, which sets the taskbar to normal.
Now the taskbar is in normal state even though the your program wants
it to be auto-hide.
Finally, your program exits, and it "restores" the taskbar to auto-hide.
</p>
<p>
This is just
another case of
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2008/12/11/9193695.aspx">
using a global setting to solve a local problem</a>.
The local solution is to
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2005/05/05/414910.aspx">
create a fullscreen window</a>,
and the taskbar will get out of the way automatically.
</p>
<p>
The customer went to the online support forum for the program that was
setting the taskbar to auto-hide and forgetting to restore it.
And, how about that,
there was a thread in that forum called something like
"After I run Program&nbsp;X, my taskbar gets set to auto-hide."
</p>
<p>
<b>Bonus reading</b>:
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2012/07/05/10326972.aspx">
How your taskbar auto-hide settings can keep getting overwritten</a>.
It seems this problem happens a lot.
This is the sort of problem you get when you decide to
expose a user setting programmatically:
Applications start messing with the setting when they shouldn't.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (43)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1070023">
				<div id="div-comment-1070023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070023">
			August 1, 2013 at 7:08 am</a>		</div>

		<p>Slow day, huh Ray? Everything you wrote here is variation of something you already wrote and all the links are pointing to former posts. So how about a dream? They seem interesting.</p>
<div class="post">[<em>I thought it was interesting that the same problem occurred more than once. I wrote up the second occurrence, then went to hook up links and realized that this happened once before. There are multiple lessons here. (1) The problem at hand. (2) The fact that the same problem occurs more than once. (3) That most of the time, solving problems consists of applying information you already know. (4) Copying Mark Russinovich&#39;s popular &quot;the case of&quot; model doesn&#39;t mean you will be as popular as he is. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070033">
				<div id="div-comment-1070033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070033">
			August 1, 2013 at 7:20 am</a>		</div>

		<p>There&#39;s a game out there that tries to create a full-screen window, but disables the restore and maximize buttons. &nbsp;Something about it confuses Explorer, at least on Windows 8, such that the window goes behind the taskbar. &nbsp;Wouldn&#39;t be so bad except that it likes to place buttons so that only 2-3 pixels of them are not covered by the taskbar. &nbsp;You might say it&#39;s not very Civilized.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070043">
				<div id="div-comment-1070043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ajgelado_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>ajgelado@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070043">
			August 1, 2013 at 7:21 am</a>		</div>

		<p>Sadly, this is too frequent. I have a relatively large list of companies whose software is banned from my computers (and from the ones of my customers that are managed by me) because they do things they are not supposed to do, or because they do things at your back, without warning or prompting. In that list there are a couple of big companies whose software can be found on almost every Windows computer, because of their &quot;update services&quot;. You know which ones I am talking about :-) .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070063">
				<div id="div-comment-1070063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070063">
			August 1, 2013 at 7:58 am</a>		</div>

		<p>@Ray</p>
<p>Also, don&#39;t listen to the trolls. These are some of the best articles.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070073">
				<div id="div-comment-1070073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070073">
			August 1, 2013 at 9:25 am</a>		</div>

		<p>The way lots of people learn stuff is through repetition&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070083">
				<div id="div-comment-1070083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070083">
			August 1, 2013 at 9:58 am</a>		</div>

		<p>I&#39;d actually be interested in more information about the &quot;instrumented version of the SHApp&shy;Bar&shy;Message.&quot; This sounds like it could be a good technique to troubleshoot a whole range of issues.</p>
<div class="post">[<em>The support technician made a change to <code>shell32.dll</code>, recompiled it, and deployed it to the customer&#39;s machine. Recompiling shell32 is not something most people can do. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070093">
				<div id="div-comment-1070093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jack B Nimble</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070093">
			August 1, 2013 at 10:00 am</a>		</div>

		<p>And here I thought the story was going to end with the program in question having been developed by the customer with the issue. </p>
<p>&quot;oh, uh, we need that application to hide the task bar&#8230;&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070103">
				<div id="div-comment-1070103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/wswiktor_4000_poczta.fm/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>wswiktor@poczta.fm</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070103">
			August 1, 2013 at 10:03 am</a>		</div>

		<p>There&#39;s also another problem with taskbar auto-hide. Since its dawn in Windows 95, sometimes it happens that the taskbar refuses to hide. The auto-hide option is still on, and the taskbar is annoyingly covering parts of other programs (e.g. status bars).</p>
<p>What helps is to click on ALL taskbar buttons, including tray icons. Usually one of them is the culprit, but it&#39;s hard to guess which one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070113">
				<div id="div-comment-1070113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">alexx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070113">
			August 1, 2013 at 10:13 am</a>		</div>

		<p>Speaking of programs that change global settings, once I had to patch a well-known modem&#39;s software that change &quot;show window content while dragging&quot; setting while it is running, probably just so it can hide the flickering while its window is resized.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1070123">
				<div id="div-comment-1070123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070123">
			August 1, 2013 at 10:16 am</a>		</div>

		<p>Why does explorer write-on-exit instead of writing-on-change?</p>
<div class="post">[<em>Batching up writes is generally considered to be a good thing. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070133">
				<div id="div-comment-1070133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070133">
			August 1, 2013 at 10:34 am</a>		</div>

		<p>@Maurits: what possible value would it have to record the change during the session? This is not exactly transactionally sensitive information that must be preserved across a crash. It only needs to be preserved across sessions, and that&#39;s what Explorer does. I can imagine Explorer has a bunch of things it needs to record like that, and saving them all in one gulp at the end probably saves some cycles.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070153">
				<div id="div-comment-1070153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070153">
			August 1, 2013 at 11:28 am</a>		</div>

		<p>[The support technician made a change to shell32.dll, recompiled it, and deployed it to the customer&#39;s machine. Recompiling shell32 is not something most people can do. -Raymond]</p>
<p>In /this/ case, it would just take a good bit of assembly. Add a new CODE section, move the entry point to the new section, log the call and jump to the original entry point. Don&#39;t forget to add two more fixups.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070163">
				<div id="div-comment-1070163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Surly</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070163">
			August 1, 2013 at 11:55 am</a>		</div>

		<p>&quot;This is the sort of problem you get when you decide to expose a user setting programmatically: Applications start messing with the setting when they shouldn&#39;t.&quot;</p>
<p>Because microsoft knows best and having a system in place to control access (allowing both fin-grained and broad control) to such api&#39;s is unthinkable, isn&#39;t it?</p>
<p>Oh wait, isn&#39;t UAC exactly such a system, although a very poorly implemented one?</p>
<p>Don&#39;t even get me started on the settings not even the user have access to.</p>
<p>Why are users not allowed to change them? Microsoft answers: Because our users are illiterate morons that cant read instructions before their monkey fingers starts hammering on every single setting randomly (and we make more money by herding the sheep).</p>
<p>Microsoft making the decisions for the user is like a baker telling the wedding planner: &quot;This is how the wedding cake will look and taste like, no you can not change it, this is the best shape and taste for a wedding cake according to my opinion, business plan and vaguely collected unverifiable statistics&quot;</p>
<p>As the wedding planner i would go to another baker but there exists no other baker that does cakes for a wedding so yeah.</p>
<p>The baker invents something great than suddenly out of some reason presumably greed turns around and shafts its loyal customers that liked what the baker used to stand for. (Freedom of choice, etc)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070173">
				<div id="div-comment-1070173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave G</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070173">
			August 1, 2013 at 12:08 pm</a>		</div>

		<p>&quot;[The support technician made a change to shell32.dll, recompiled it, and deployed it to the customer&#39;s machine. Recompiling shell32 is not something most people can do. -Raymond]&quot;</p>
<p>How hard is it to pull the source code from the repo, make the changes and press compile?</p>
<p>(Compile as in send code with changes to a build machine which does the compilation).</p>
<p>Please don&#39;t tell me microsoft still use custom flaky make scripts that only the one that wrote it can barely understand or know how to use?</p>
<p>Afterthought: Is this why it takes so long for microsoft to come out with updates and new windows versions?</p>
<p>I thought it was because NSA was slow at responding to e-mails.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070193">
				<div id="div-comment-1070193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070193">
			August 1, 2013 at 12:16 pm</a>		</div>

		<p>@Surly</p>
<p>A baker can use their expertise and interact with the customer for each cake to determine how to make what the customer wants, and to steer them away from ideas that simply won&#39;t work.</p>
<p>The Microsoft bakery has to publish a brochure with all the possible cake options. It has to carefully test every possible combination of options to make sure that every cake will taste good and not fall apart. If a customer orders some unusual combination they didn&#39;t expect, they have to produce exactly what was specified, even if it is a horrible cake, and take the blame for it. When they update the brochure with new cake options, they can&#39;t revise it to make it so you can&#39;t order that horrible cake, because the customer has found a way to repurpose them as halloween decorations or something and will throw a fit when they are no longer available and the new nice cakes aren&#39;t backwards-compatible with his halloween decorating business.</p>
<p>I don&#39;t think the bakery analogy works for operating systems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1070203">
				<div id="div-comment-1070203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070203">
			August 1, 2013 at 12:18 pm</a>		</div>

		<p>[The support technician made a change to shell32.dll, recompiled it, and deployed it to the customer&#39;s machine. Recompiling shell32 is not something most people can do. -Raymond]</p>
<p>Would not a conditional breakpoint be able to do that?</p>
<div class="post">[<em>As I recall, this issue was reported by the customer&#39;s employees, so it was presumably deployed to a few thousand machines, none of whose users know how to use a debugger. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1070213">
				<div id="div-comment-1070213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070213">
			August 1, 2013 at 12:24 pm</a>		</div>

		<p>Now if only Windows stopped to fudge SPI_GETWORKAREA while disconnected and after reconnecting to the console&#8230; It&#39;s very frustrating to have IE/other app to be obscured by the taskbar and not being able to recover that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1070223">
				<div id="div-comment-1070223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070223">
			August 1, 2013 at 12:25 pm</a>		</div>

		<p>&gt;Microsoft answers: Because our users are illiterate morons that cant read instructions before their monkey fingers starts hammering on every single setting randomly (and we make more money by herding the sheep).</p>
<p>There is more truth to that that you realize. Not in the users&#39; favor.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070233">
				<div id="div-comment-1070233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070233">
			August 1, 2013 at 12:34 pm</a>		</div>

		<p>@Dave G: While writing your snarky comment you sadly missed to oh so much more obvious reason for why &quot;most people&quot; can&#39;t recompile shell32.</p>
<p>Or did MS open source their OS while I wasn&#39;t looking? </p>
<p>@Surly: &quot;Because microsoft knows best and having a system in place to control access (allowing both fin-grained and broad control) to such api&#39;s is unthinkable, isn&#39;t it?&quot; </p>
<p>Umn and now go ahead and tell us how you plan to actually implement this system to control access to those APIs. Because you know it&#39;s pretty hard to keep the user and a determined enough programmer apart. If you manage to come up with a working solution I&#39;m sure MS would be very happy about that.</p>
<p>@alegr1: Rather more complicated for the users having to step through the assembly and reverse engineering the code considering that the customer doesn&#39;t have the source code. This way they just have to replace some file, let the machine running for a while and then check a log file &#8211; seems more convenient and easy.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070243">
				<div id="div-comment-1070243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070243">
			August 1, 2013 at 12:34 pm</a>		</div>

		<p>&gt; The support technician made a change to shell32.dll, recompiled it, and deployed it to the customer&#39;s machine.</p>
<p>I&#39;ve not done a lot of it, but wouldn&#39;t creating a simple logging window hook for the taskbar be easier and more flexible (or already exist)? &nbsp;Though maybe adding a single line to OutputDebugString in shell32 isn&#39;t too hard (or maybe it is, if it took multiple tries!) :)</p>
<p>I admit wondering why there&#39;s never been a flag added to explicitly indicate that a window is supposed to be full-screen and instead relying solely on the implicit guessing done by Explorer. &nbsp;I&#39;ve seen it fail for whatever reason often enough (for example, when a certain browser&#39;s plugin for flashy content tries to show full-screen video with the Windows DPI setting increased).</p>
<p>@Jon</p>
<p>Most analogies fall down if you poke them hard enough. &nbsp;I think Surly has a point, though; if someone wants a cake with blue carrot cake and pink spearmint frosting topped with Red Hots, the baker should oblige (or lose the customer&#39;s business). &nbsp;A tightly-controlled walled garden approach is attractive to companies because overall it&#39;s cheaper (and recently become acceptable and even fashionable), but it just doesn&#39;t fly on desktops. &nbsp;This is because of the reason you gave: it&#39;s impossible to anticipate all of the myriad of ways the system will be used.</p>
<div class="post">[<em>The log would say &quot;Explorer.exe. Explorer.exe. Explore.exe. Explorer.exe&#8230;&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070253">
				<div id="div-comment-1070253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mpz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070253">
			August 1, 2013 at 12:49 pm</a>		</div>

		<p>@alexx: Oh god, I know exactly what software you&#39;re talking about. I solved the problem by creating a Dial-Up Networking config that connects to the Internet, and then used MDMA with a certain AT command to disable the virtual CD drive that either starts up the software install process or forcibly launches said software (ie. makes the device appear as a modem, as it should). MDMA /hwstorage:0 disables the virtual CD-ROM device. Now I can connect to the Internet without having my graphics options mucked with.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070263">
				<div id="div-comment-1070263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Surly</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070263">
			August 1, 2013 at 12:58 pm</a>		</div>

		<p>@Jon</p>
<p>&quot;The Microsoft bakery has to publish a brochure with all the possible cake options. It has to carefully test every possible combination of options to make sure that every cake will taste good and not fall apart.&quot;</p>
<p>Have you not heard of standard recipes that bakers offer?</p>
<p>They are standard recipes known to be good that can be customized if needed based on bakers suggestions and customers taste.</p>
<p>&quot;If a customer orders some unusual combination they didn&#39;t expect, they have to produce exactly what was specified, even if it is a horrible cake, and take the blame for it.&quot;</p>
<p>Bakers take custom orders all the time. Take birthday cakes shaped as genitals for a good example.</p>
<p>The baker offers a service. That service is to bake for the customer. It is quite clear.</p>
<p>While the baker can make suggestions that might fit the customers need better, in the end it is up to the customer.</p>
<p>The service is clear: it is to bake for the customer and not judge the customers taste.</p>
<p>Microsoft offers..offered the same sort of service. The service was clear. The customer knew what microsoft offered.</p>
<p>Then microsoft made the service they offered unclear, fuzzy and began to order the customer around, telling them what they could and couldn&#39;t have.</p>
<p>Microsoft went retard as the expression goes and tried to fix something that was not broken.</p>
<p>In a service there will always be bad customers that whine about everything. That cannot be helped.</p>
<p>Although microsoft thought they could do the impossible. Make everyone happy.</p>
<p>Instead of taking the blame from the bad customer as for what it was microsoft did something horrible, that lacks the most simple of common sense in a business, unthinkable. Microsoft listened to the blame and changed based on it. The result: all good customers when WTF?! and started to complain. Suddenly microsoft with its inflated-ego hurt, went no i will not change again, the previous change costed much money. The change is final.</p>
<p>&quot;When they update the brochure with new cake options, they can&#39;t revise it to make it so you can&#39;t order that horrible cake, because the customer has found a way to repurpose them as halloween decorations or something and will throw a fit when they are no longer available and the new nice cakes aren&#39;t backwards-compatible with his halloween decorating business.&quot;</p>
<p>Everyone gets upset when their favorite ice-cream flavor gets removed. Especially when the flavor that replaced it tastes horrible.</p>
<p>Bakery analogy works well i think.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070273">
				<div id="div-comment-1070273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J Walroth</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070273">
			August 1, 2013 at 1:10 pm</a>		</div>

		<p>&quot;(4) Copying Mark Russinovich&#39;s popular &quot;the case of&quot; model doesn&#39;t mean you will be as popular as he is.&quot;</p>
<p>Mark got popular because he showed how bad microsoft was at coding and handling issues and feedback.</p>
<p>This blog post only shows how bad microsoft is at informing and educating the developers about when and how to use the api&#39;s.</p>
<p>To third-party developers this is a sore subject. You should have expected some frustrated regurgitation&#39;s from devs getting reminded.</p>
<p>To be fair since Mark joined microsoft it is as if he died.</p>
<p>Mark have stopped making good and interesting blog posts.</p>
<p>I actually thought Mark had died for a short period because Marks activities stopped so abruptly.</p>
<p>Sort of proves that if you join microsoft you die inside as if it sucks you dry of some vital fluid needed for making interesting and useful things.</p>
<p>&quot;the case of&quot; model works well if the case is interesting and hard to deduce.</p>
<p>Marks model also used to provide solutions that the user could do themselves.</p>
<p>Recompiling shell32 is not something a user could do themselves.</p>
<p>This would have been an interesting post if you had provided a way for the user to track down such an issue themselves.</p>
<p>The devil is in the details and the delivery.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070283">
				<div id="div-comment-1070283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070283">
			August 1, 2013 at 1:19 pm</a>		</div>

		<p>I know you don&#39;t allow speculation about which program &quot;Program X&quot; really is, but what I&#39;d be interested to know is whether the creators of &quot;Program X&quot; actually ended up doing the right thing and fixing their stuff?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070303">
				<div id="div-comment-1070303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070303">
			August 1, 2013 at 1:24 pm</a>		</div>

		<p>&gt; [The log would say &quot;Explorer.exe. Explorer.exe. Explore.exe. Explorer.exe&#8230;&quot; -Raymond]</p>
<p>Well clearly this Explorer.exe needs to be terminated before it causes any further harm!</p>
<p>Ha ha, oops.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070313">
				<div id="div-comment-1070313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070313">
			August 1, 2013 at 2:29 pm</a>		</div>

		<p>Of course, it would be really great if group policy would actually prevent the user from toggling the setting it&#39;s protecting instead of just locking down explorer. Would it really be so hard to block the corresponding API calls and registry keys?</p>
<div class="post">[<em>Often, you want to block the behavior only at the UI level and not the API level. For example &quot;block access to the C drive&quot; is a UI level block, because if it were an API level block you couldn&#39;t even boot the computer. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070323">
				<div id="div-comment-1070323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070323">
			August 1, 2013 at 2:33 pm</a>		</div>

		<p>There are conditions where it is appropriate to batch up changes and save them all at once. In Explorer&#39;s case, though, most changes are infrequent and the only way to save them includes closing all your applications.</p>
<p>Since my use case for Explorer is one where I log on, and stay logged on until the computer crashes or loses power (or Explorer crashes or my RDP session is terminated due to idle timeout), my settings never get saved. If I want some settings saved, I have to make the change, log off, log back on, and restart whatever apps I had running.</p>
<p>In a more pathological case, I often deal with workstations whose states are &quot;frozen&quot;. That is, changes made to the filesystem are stored in memory or some separate disk, and only applied when some special action is taken to &quot;thaw&quot; the system.</p>
<p>So ideally you would &quot;thaw&quot; the system, make your settings change, and &quot;freeze&quot; it again. Instead, you have to &quot;thaw&quot; the system, make your settings change, log off, log back on, and &quot;freeze&quot; the system.</p>
<p>Even if it did have to batch settings changes, it would be nice if it could do it periodically instead of just when logging off, so that after a crash my settings didn&#39;t revert to what they were 6 months ago.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070053">
				<div id="div-comment-1070053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070053">
			August 1, 2013 at 7:57 am</a>		</div>

		<p>Speaking of the taskbar&#8230;</p>
<p>I reported this years and years ago, I think when we got our first &quot;Whistler&quot;-branded XP beta discs, but if you right-click and application in the locked taskbar and then drag the taskbar, which is easier to accidentally do than one might first think, it will dock to the top of the screen regardless of lock state.</p>
<p>This also causes the desktop and all opened windows to rearrange themselves, which can be EXTREMELY irritating if you&#39;re using, say, a CAD application that needs to refresh a render when the window is moved.</p>
<p>I really wish that had been fixed in Win7. I guess fixing it in Win8 was better than nothing, for those who think Win8 is etc. *rimshot*</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070333">
				<div id="div-comment-1070333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070333">
			August 1, 2013 at 5:35 pm</a>		</div>

		<p>often time you can&#39;t educate developers about something like this, because it&#39;s a program manager that&#39;s asking for the taskbar to be turned to autohide, and that&#39;s the end of that discussion. sometimes it&#39;s even sales. &nbsp;if there wasn&#39;t an api, some wm command message would be sent somewhere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-1070343">
				<div id="div-comment-1070343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070343">
			August 1, 2013 at 7:33 pm</a>		</div>

		<p>@Joshua: There is still the issue of how to satisfy WFP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070363">
				<div id="div-comment-1070363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070363">
			August 2, 2013 at 3:32 am</a>		</div>

		<p>Why does Explorer even persist the SHAppBarMessage state, rather than just the state of the checkbox?</p>
<div class="post">[<em>You&#39;re assuming that the SHAppBarMessage state is different from the checkbox state. Imagine if that were true. &quot;My taskbar is auto-hiding, but when I look at the properties, auto-hide is unchecked. What&#39;s going on?&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070373">
				<div id="div-comment-1070373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/wswiktor_4000_poczta.fm/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>wswiktor@poczta.fm</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070373">
			August 2, 2013 at 4:43 am</a>		</div>

		<p>@Nick: what is a full-screen window is well documented: just create a borderless window (use WS_POPUP) that exactly covers the entire screen.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070383">
				<div id="div-comment-1070383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070383">
			August 2, 2013 at 5:39 am</a>		</div>

		<p>The trolling rate is exponentially proportional to the repeated topics. This may be a correlation between the sum of the old trolls plus the new ones which are as many as the old ones. All of them are just waiting for an oportunity to unleash their ire on-topic (troll doesn&#39;t mean mindless beast, only beast).</p>
<p>@Raymond, batching up writes is a good thing if you have huge amounts of data to write. Nevertheless, you should write as soon as feasibly possibly, such as when a buffer is full or after some time without writes.</p>
<p>This is just delaying writes as much as possible (in this case, the lifetime of the process, and even so, only if it terminates cleanly), which is a bad thing. I bet that, even though all write operations happen when Explorer is quitting, each registry value is written individually, most probably not in a transaction.</p>
<p>There&#39;s also this duality: file type (e.g. extension) settings are written on demand, but other preferences aren&#39;t (or are they? perhaps some are, others aren&#39;t), even though they&#39;re all under the same dialog (in this case, Folder Options).</p>
<p>Contrast with Internet Explorer, Office, Visual Studio et al, that write configurations when the user presses OK. To be fair, I bet these applications also have similar problems, but not as a general rule.</p>
<p>@JM, about sessions, I&#39;ve experienced configuring Explorer, using Windows for a few hours and the power went down. When power was restored and I rebooted the computer, most of my Explorer settings were forgotten.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070353">
				<div id="div-comment-1070353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070353">
			August 1, 2013 at 11:45 pm</a>		</div>

		<p>Ok, *some* group policy settings would be hard to implement in an actually useful manner. But you can&#39;t even effectively block your users from changing the wallpaper without removing Firefox.</p>
<div class="post">[<em>Well, because if you blocked it at the API level, how would the IT department&#39;s &quot;set_the_wallpaper_to_the_official_wallpaper.exe&quot; logon script be able to set the wallpaper to the company standard wallpaper? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1070443">
				<div id="div-comment-1070443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070443">
			August 2, 2013 at 9:59 am</a>		</div>

		<p>All these issues with arrogant/malicious/ignorant programs changing some global state just prove that Microsoft is too late with a concept of application isolation. An application without an appropriate signature should not have access to system-global or user-global state, even when run in the administrator login session. Especially if it&#39;s a plugin, like friggin Java, which was a reason my daughter got a ransomware a few days ago. Luckily, it only was a user account (not an admin) and I was able to mount the user&#39;s hive and clean the program from user&#39;s Run key.</p>
<div class="post">[<em>You need to get in a room with the people who say &quot;It&#39;s my computer, I should be able to write a program to do whatever I want&quot; and let me know who wins. (Even if you say &quot;Only Explorer can change this setting&quot;, all somebody has to do is inject code into Explorer.) And if things worked the way you wanted, you wouldn&#39;t have been able to mount the user&#39;s hive (because that&#39;s global state). -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com odd alt thread-odd thread-alt depth-1" id="comment-1070463">
				<div id="div-comment-1070463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070463">
			August 2, 2013 at 10:23 am</a>		</div>

		<p>&quot;Why does explorer write-on-exit instead of writing-on-change?&quot;</p>
<p>@Maurits, IIRC, in Windows 7 MS made some change so Explorer saves settings more often, not just on exit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1070483">
				<div id="div-comment-1070483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070483">
			August 2, 2013 at 11:14 am</a>		</div>

		<p>[You need to get in a room with the people who say &quot;It&#39;s my computer, I should be able to write a program to do whatever I want&quot; and let me know who wins.]</p>
<p>Which are 0.01% of all users. Are people still jailbreaking iPhones? </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070513">
				<div id="div-comment-1070513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070513">
			August 2, 2013 at 12:34 pm</a>		</div>

		<p>&gt; Which are 0.01% of all users.</p>
<p>First, it&#39;s more than that and second, it&#39;s that many *now*. &nbsp;When you take away 75% of the Windows tools and utilities and programs people use every day that number will go up, and fast. &nbsp;PS: The filesystem is &quot;global state&quot;. &nbsp;Now my programs can&#39;t share files.</p>
<p>&gt; Are people still jailbreaking iPhones? </p>
<p>Yes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1070603">
				<div id="div-comment-1070603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070603">
			August 3, 2013 at 2:27 pm</a>		</div>

		<p>@alex: Speaking of programs that change global settings, once I had to patch a well-known modem&#39;s</p>
<p>software that change &quot;show window content while dragging&quot; setting while it is running, probably</p>
<p>just so it can hide the flickering while its window is resized.</p>
<p>This is unfortunately a common problem with most commercial remote desktop applications. Take a</p>
<p>look at the big company which has a terminal server-like product, their client does the same,</p>
<p>programmatically changes the window content redraw setting. I found it so irritating I had to</p>
<p>develop an util which resets it back to default as fast as it changes.</p>
<p>@Raymond: Often, you want to block the behavior only at the UI level and not the API level.</p>
<p>This is contrary what you have claimed earlier, that the user should be in control, not applications.</p>
<p>A setting should at least be changeable in the standard gui by the user, if an app the user executes can change it.</p>
<p>@Raymond: Well, because if you blocked it at the API level, how would the IT department&#39;s</p>
<p>&quot;set_the_wallpaper_to_the_official_wallpaper.exe&quot; logon script be able to set the wallpaper</p>
<p>to the company standard wallpaper?</p>
<p>GPOs should be distributed by accounts that has admin rights on computers, not by simple user accounts.</p>
<p>This might be a fundamental flaw in windows/AD though. In general, trying to set things at login time,</p>
<p>running as a user, should not be allowed in many cases. Ordinary users should not be able to change lots</p>
<p>of settings.</p>
<p>@alegr1: You need to get in a room with the people who say &quot;It&#39;s my computer</p>
<p>They have to be admins then, not ordinary users. And they should be accountable if anything screws up,</p>
<p>like desktop settings. At a company they will have to fix it in there spare time, or pay some admin to do it.</p>
<div class="post">[<em>Administrative policy beats user preference. In the wallpaper case, the policy is implemented by Explorer, and Explorer uses (ta daa) the wallpaper API to change the wallpaper. If you blocked the API, then how would Explorer set the wallpaper according to policy? -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1070893">
				<div id="div-comment-1070893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1070893">
			August 5, 2013 at 12:19 pm</a>		</div>

		<p>Sorry if this is a repost, I didn&#39;t get a post confirmed from the software:</p>
<p>It&#39;s always interesting to read these topics as it seems to be a popular one for the trolls.</p>
<p>It comes down to a never ending battle of walls and ladders as Raymond has mentioned so many times before. The way I see it is you either: Give too much leeway and people complain that the system is unstable and its Microsoft&#39;s fault -or- lock it down too much and people complain that its anti-competitive/tin-foil hats come out in force. You&#39;re damned if you do, damned if you don&#39;t.</p>
<p>As usual the truth lies somewhere in the middle, the best solution I think is to attempt to educate users (through blog posts such as this) that explain the issue and give people the tools to start the name and shame game. Microsoft (and Raymond) has chosen not to participate in this game (as is their right) but nothing is preventing the end users from starting a blog or database of known &quot;poorly written software&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1071163">
				<div id="div-comment-1071163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1071163">
			August 6, 2013 at 12:04 pm</a>		</div>

		<p>[Administrative policy beats user preference.]</p>
<p>Another pointless wall. Read the sysinternals blogs. GPO falls to a competent local admin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com000300008794c744 odd alt thread-odd thread-alt depth-1" id="comment-1071223">
				<div id="div-comment-1071223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Wisefaq' rel='external nofollow' class='url'>Wisefaq</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1071223">
			August 6, 2013 at 7:35 pm</a>		</div>

		<p>@Joshua</p>
<p>&quot;GPO falls to a competent local admin&quot;</p>
<p>Most security blocks fail if you already have local admin rights.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1071523">
				<div id="div-comment-1071523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130801-00/?p=3643#comment-1071523">
			August 7, 2013 at 3:09 pm</a>		</div>

		<p>&gt; The local solution is to create a fullscreen window, and</p>
<p>&gt; the taskbar will get out of the way automatically.</p>
<p>Sure&#8230; except when it doesn&#39;t.</p>
<p>I think the reason people do this is because this feature is, to this day, not 100% reliable (like many things with Explorer&#8230; for example desktop icon positions).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

