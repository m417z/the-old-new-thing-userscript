<html>
<head>
<title>Can a server-side Web application trigger the creation of thumbs.db files?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Can a server-side Web application trigger the creation of thumbs.db files?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 13, 2016 / year-entry #262</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>9</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Probably not.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer had a server-side Web application which creates
a large number of image files.
The customer was concerned that the system would spend
a lot of effort generating thumbnails to be put into
the <code>thumbs.db</code> file
and wanted to disable
the <code>thumbs.db</code> file in order to improve
the performance of their Web application.
The customer liaison added,
"From a brief experiment, it seems that the <code>thumbs.db</code>
file is written when a user displays thumbnails on Explorer.
Merely creating and copying image files does not trigger the
creation of a <code>thumbs.db</code> file.
I don't think the customer needs to worry about the overhead
of the <code>thumbs.db</code> file since neither the user account
of the Web application nor the SYSTEM account will create
a thumbnail cache.
Is that correct?"
</p>
<p>
Yes, that's correct.
</p>
<p>
The
<code>thumbs.db</code> file is created by Explorer
or any other application that
<a HREF="https://msdn.microsoft.com/en-us/library/bb774628(VS.85).aspx">
uses Explorer's thumbnail cache</a>.
It is unlikely that the customer's Web server is using the Explorer thumbnail cache,
so the file won't be created.
</p>
<p>
To be extra sure, the customer can set the policy
<i>User Configuration, Administrative Templates,
Windows Components, File Explorer,
<a HREF="http://gpsearch.azurewebsites.net/#4762">
Turn off the caching of thumbnails in hidden thumbs.db files</a></i>.
</p>
<p>
The customer liaison
thanked us for confirming what their experimentation
revealed.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (9)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1 parent" id="comment-1276745">
				<div id="div-comment-1276745" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrea Martinelli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276745">
			December 13, 2016 at 8:04 am</a>		</div>

		<p>There are a few thumbs.db files on my computer that I know for sure have not been generated by Windows XP.<br />
Are there any scenarios in which modern versions of Windows store thumbnails in Thumbs.db?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mngoldeneagle odd alt depth-2" id="comment-1276825">
				<div id="div-comment-1276825" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276825">
			December 13, 2016 at 2:50 pm</a>		</div>

		<p>Programs may generate the thumbs.db if they opt into it.  For example, the common Save/Open dialog boxes that most programs use will leverage the thumbnail database.  I believe Windows Media Player and its associates do as well for album covers.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1276755">
				<div id="div-comment-1276755" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276755">
			December 13, 2016 at 8:32 am</a>		</div>

		<p>Never underestimate the shenanigans of bad developers. I don&#8217;t know an immediate cause but it&#8217;s possible they did something so bad with the shell namespace COM components as to cause thumbs.db to generate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1276765">
				<div id="div-comment-1276765" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276765">
			December 13, 2016 at 8:39 am</a>		</div>

		<p>I really dislike these files. Windows has Thumbs.db and desktop.ini, MacOS has .DS_Store, even KDE has a &#8220;.directory&#8221; file it creates when you change the preview settings for a folder (at least it stores the thumbnails in a global per-user cache).</p>
<p>Of them, in my opinion the Windows ones are the worst ones, since they intrude in the namespace. The other two start with a dot, which clearly separates them from the user-created files, but Thumbs.db sits well in the middle of the namespace.</p>
<p>And there&#8217;s also the obvious privacy leak: create a folder with three images, have Explorer create the Thumbs.db, then delete one of the images and create a ZIP of the whole folder. The Thumbs.db file, sent to your client, can still have the thumbnail for the deleted image.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1276776">
				<div id="div-comment-1276776" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Piotr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276776">
			December 13, 2016 at 9:23 am</a>		</div>

		<p>That&#8217;s why thumbs.db is marked as hidden &#8211; no need to rely on magic names. You have metadata for that. But another valid point is when those are created on network shares. That&#8217;s what is really rude.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-3" id="comment-1276855">
				<div id="div-comment-1276855" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276855">
			December 13, 2016 at 5:50 pm</a>		</div>

		<p>That&#8217;s why &#8220;disable thumbnail&#8221; and &#8220;change to detail view and apply to all folders&#8221; are on the list of things I want to do on each system install/reinstall.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mngoldeneagle even depth-2 parent" id="comment-1276835">
				<div id="div-comment-1276835" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276835">
			December 13, 2016 at 2:54 pm</a>		</div>

		<p>I suspect if they implemented this feature today it would be a central store database inside of System Volume Information instead, which would make all kinds of more sense.  But I doubt that will happen now simply because what they have works and the cost to reimplement, change existing tests, communicate to customers, etc. would be prohibitively high.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1276865">
				<div id="div-comment-1276865" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.silverbacknetworks.tech' rel='external nofollow' class='url'>Joshua Bowman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276865">
			December 13, 2016 at 8:41 pm</a>		</div>

		<p>Since Vista, it&#8217;s been at %USERPROFILE%\AppData\Local\Iconcache.db, so it&#8217;s at least centralized per-user.</p>
<p>I don&#8217;t think adding it to System Volume Information would be a good idea, since that puts it in a protected location, and now you need new APIs to add, retrieve, and erase them, and have an additional unnecessary security risk.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mngoldeneagle even depth-4" id="comment-1276885">
				<div id="div-comment-1276885" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20161213-00/?p=94925#comment-1276885">
			December 14, 2016 at 7:11 am</a>		</div>

		<p>Presumably if one were to reimplement it you could design the APIs appropriate to the implementation. ;-) A user-level datastore makes sense, though, just in the sense that it means you don&#8217;t have to worry about tracking permissions for the thumbnails and who&#8217;s able to access what.  The advantage to using a system-level store is that you can deduplicate the thumbnails generated across all users and cache them within a system service, similar to how the Indexer works.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

