<html>
<head>
<title>Why won't my computer go to sleep?  Where is the energy going?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why won&#8217;t my computer go to sleep?  Where is the energy going?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>October 26, 2009 / year-entry #339</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>20</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">The powercfg utility has been around for a while, but in Windows 7, it gained a little bit more awesome. powercfg /energy will analyze your computer's power consumption and report on things like devices that prevent the computer from sleeping, devices which won't suspend, and processes which are increasing your battery drain. Another neat flag is...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>The <code>powercfg</code> utility <a href="http://blogs.msdn.com/oldnewthing/archive/2008/02/13/7658352.aspx"> has been around for a while</a>, but in Windows&nbsp;7, it gained a little bit more awesome.</p>
<p> <a href="http://blogs.technet.com/jamesone/archive/2009/02/18/testing-windows-7-on-a-laptop-try-this.aspx"> <code>powercfg /energy</code></a> will analyze your computer's power consumption and report on things like devices that prevent the computer from sleeping, devices which won't suspend, and processes which are increasing your battery drain. </p>
<p> Another neat flag is <code>powercfg /requests</code> which will report on why your computer can't go to sleep, for example, because it has open files on the network, or because the clown will eat it. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (20)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-780543">
				<div id="div-comment-780543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nathan_works</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780543">
			October 26, 2009 at 7:17 am</a>		</div>

		<p>I hope the DDK (or WDK now ?) was also updated.. Driver power config under the win2k WDM model was, well, hard. I worked on a software driver that didn&#8217;t correctly handle power IRPs. Thanks to the OSR guys for explaining &quot;null power management&quot;.. I was able to close out a long-standing &quot;laptops won&#8217;t go into sleep/suspend mode when $MY_PRODUCT was installed&quot;.</p>
<p>Yes, this was now almost 10 years ago.. Haven&#8217;t done much driver work in the past 8 or so..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780553">
				<div id="div-comment-780553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780553">
			October 26, 2009 at 7:18 am</a>		</div>

		<p>Also, computers are afraid of seeing 2&#8217;s in their nightmares.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780563">
				<div id="div-comment-780563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780563">
			October 26, 2009 at 9:20 am</a>		</div>

		<p>&quot;Gained a little bit more awesome?&quot; You&#8217;re writing posts like Fark comments now. Awesome.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780573">
				<div id="div-comment-780573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mike jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780573">
			October 26, 2009 at 9:54 am</a>		</div>

		<p>I have the opposite problem&#8230; On an unattended machine a batch file uses powercfg to select the High Performance plan and my machine still goes to sleep. &nbsp;Does a plan change require a reboot?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780583">
				<div id="div-comment-780583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">spike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780583">
			October 26, 2009 at 11:17 am</a>		</div>

		<p>i can just imagine &#8230;</p>
<p>C:&gt; powercfg /requests</p>
<p>Can&#8217;t sleep due to fear of clowns!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780603">
				<div id="div-comment-780603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780603">
			October 26, 2009 at 11:58 am</a>		</div>

		<p>Very handy! Thanks for pointing it out.</p>
<p>Working out which driver/etc. is b0rking sleep mode can be quite a pain and this looks like something that&#8217;ll help a lot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780613">
				<div id="div-comment-780613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Puckdropper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780613">
			October 26, 2009 at 12:24 pm</a>		</div>

		<p>The energy switch is the most awesome addition to power management yet. &nbsp;The only problem is it thinks not sleeping and going straight to hibernate is a problem. &nbsp;Sleep mode is screwed up on my laptop, so sometimes it goes to sleep forever.</p>
<p>I&#8217;ve love to see this one thing backported to Vista for those who are having sleep problems but haven&#8217;t upgraded yet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780623">
				<div id="div-comment-780623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam V</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780623">
			October 26, 2009 at 12:35 pm</a>		</div>

		<blockquote><p>
  You&#8217;re writing posts like Fark comments now. Awesome.
</p></blockquote>
<p>It&#8217;s more like a sbemail. The real question is, how does Raymond type with those boxing gloves on?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780633">
				<div id="div-comment-780633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Washu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780633">
			October 26, 2009 at 1:10 pm</a>		</div>

		<p>I knew those clowns were up to no good!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780653">
				<div id="div-comment-780653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">power-shell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780653">
			October 26, 2009 at 1:23 pm</a>		</div>

		<p>Speaking of power management, can the horrid shell team undo some horrid changes made in Windows 7 and Vista? Please make all three power plans accessible directly from the notification area power icon, allow desktop users without a UPS to display the power icon and allow the comp to ask the user what to do when the power button is pressed every time like XP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780663">
				<div id="div-comment-780663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Howard Phillips L.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780663">
			October 26, 2009 at 1:32 pm</a>		</div>

		<p>Research at Miskatonic University has shown that clowns are, in fact, the incarnation of evil itself.</p>
<p>And &#8217;tis a true pity that Windows PE doesn&#8217;t have any power management features. Would have been great to see the current capacity of my netbook&#8217;s battery &#8230;</p>
<p>@power-shell:</p>
<p>Or at least asking for confirmation without having to activate the shutdown event tracker (which doesn&#8217;t work with sleep, either).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780673">
				<div id="div-comment-780673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">n</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780673">
			October 26, 2009 at 3:20 pm</a>		</div>

		<p>It is about time windows can monitor power usage like this. &nbsp;Maybe this will make the power management tax that much higher a priority because it is now more visible. &lt;<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/08/22/454487.aspx&gt;" rel="nofollow"></a><a href="http://blogs.msdn.com/oldnewthing/archive/2005/08/22/454487.aspx&#038;gt" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/08/22/454487.aspx&#038;gt</a>;</p>
<p>@mike jones</p>
<p>You need to check the machines high performance settings, because changing configs does not require a restart to take effect.</p>
<p>The problem is that by default even high performance will cause the computer to hibernate when plugged in (even sooner when on battery).</p>
<p>Also, when you change it don&#8217;t do it in the pretty control panel interface, you need to go into the advanced settings and also make sure that both sleep and hibernate are turned off because sleep is the only thing you can set from the pretty control panel interface.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780683">
				<div id="div-comment-780683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780683">
			October 26, 2009 at 5:29 pm</a>		</div>

		<p>I&#8217;m very impressed: this is incredible functionality. Yet another reason to go for Windows 7.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780713">
				<div id="div-comment-780713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Big Stew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780713">
			October 27, 2009 at 1:46 am</a>		</div>

		<p>Clowns? Why don&#8217;t cannibals eat clowns? Because they taste funny&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780743">
				<div id="div-comment-780743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ConstB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780743">
			October 27, 2009 at 4:07 am</a>		</div>

		<p>It&#8217;s good news, though I&#8217;m still curious, why &quot;Hibernate&quot; is no longer available through &#8216;start&#8217; menu even if it&#8217;s enabled with powercfg? Why I now have to run &#8216;shutdown /h&#8217; in admin shell instead of pushing a button?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780753">
				<div id="div-comment-780753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">someone else</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780753">
			October 27, 2009 at 5:58 am</a>		</div>

		<p>Because Hybrid Sleep is enabled. Either disable it, or cut power after putting your computer to sleep.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780773">
				<div id="div-comment-780773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeroen Mostert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780773">
			October 27, 2009 at 6:04 am</a>		</div>

		<p>nterror.h:</p>
<p>#define NT_STATUS_CANT_SLEEP_CLOWN_WILL_EAT_ME(0xC0000000 | 0x07c8)</p>
<p>winerror.h:</p>
<p>//</p>
<p>// MessageId: ERROR_COULROPHOBIC_INSOMNIA</p>
<p>//</p>
<p>// MessageText:</p>
<p>//</p>
<p>// &nbsp;Windows is unable to suspend because it fears it will be</p>
<p>// &nbsp;eaten by a clown. If this condition persists, contact your &nbsp;</p>
<p>// &nbsp;network psychiatrist.</p>
<p>//</p>
<p>#define ERROR_COULROPHOBIC_INSOMNIA    1992L</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-780873">
				<div id="div-comment-780873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kog999</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780873">
			October 27, 2009 at 12:31 pm</a>		</div>

		<p>&quot;Also, computers are afraid of seeing 2&#8217;s in their nightmares.&quot;</p>
<p>Its ok John, therse no such thing as a 2</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-780933">
				<div id="div-comment-780933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mattfife.net' rel='external nofollow' class='url'>matt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-780933">
			October 27, 2009 at 4:22 pm</a>		</div>

		<p>But does it FINALLY report when a SERVICE woke up the machine????</p>
<p>I had the opposite problem. &nbsp;In Vista, I would come home and find my machine awake &#8211; and it would wake at random times during the day and night. &nbsp;And WHY??? &nbsp;Powercfg wouldn&#8217;t tell me. &nbsp;It turned out to be the media center&#8217;s TV schedule update service that would wake the machine.</p>
<p>It was infuriatingly broken &#8211; and still is. &nbsp;I either disable the service and get an error message and horrible slow UI control every time I open media center, or I leave it on and have my machine waking at random times.</p>
<p>Here was the whole trackdown &#8211; and LOTS of other people have this same problem:</p>
<p><a rel="nofollow" target="_new" href="http://mattfife.net/wordpress/?p=178" rel="nofollow">http://mattfife.net/wordpress/?p=178</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-781053">
				<div id="div-comment-781053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Achtanabla</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20091026-01/?p=16263#comment-781053">
			October 28, 2009 at 6:00 am</a>		</div>

		<p>Hm when I enter on my Windows 7 machine powercfg /energy it doesn&#8217;t recognize /energy as a valid parameter but when I enter powercfg -energy it works.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

