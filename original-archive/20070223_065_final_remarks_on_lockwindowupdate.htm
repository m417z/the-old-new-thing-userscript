<html>
<head>
<title>Final remarks on LockWindowUpdate</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Final remarks on LockWindowUpdate</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>February 23, 2007 / year-entry #66</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>38</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Now that you understand the intended purpose of LockWindowUpdate, I'm going to tell you why you don't want to use it, not even for its intended purpose! You have to go back to the historical context in which LockWindowUpdate was created. Rewind back to 16-bit Windows, specifically Windows 3.1. Back in these days, memory was expensive....</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Now that you understand the intended purpose of <code>LockWindowUpdate</code>, I'm going to tell you why you don't want to use it, not even for its intended purpose!</p>
<p> You have to go back to the historical context in which <code>LockWindowUpdate</code> was created. Rewind back to 16-bit Windows, specifically Windows&nbsp;3.1. Back in these days, memory was expensive. Video drivers were pretty limited in functionality. There was no DirectX. There was no AlphaBlend function. All you had was a screen buffer. The <code>LockWindowUpdate</code> function let you take control over one window's portion of that screen buffer so you could apply your fancy effects to the window without that window's knowledge. </p>
<p> It's been over a decade since Windows&nbsp;3.1, and in the meanwhile, we gained DirectX overlays, regional windows, layered windows, alpha blending, desktop composition, all sorts of cool graphical effects that weren't available back in the old days. In particular, those layered windows and regional windows pretty much let you do nearly all of the stuff you would have wanted to do with <code>LockWindowUpdate</code> anyway. If you want to draw a highlight around a window, you can position a regional window around it. If you want to draw a drag image over a window, you can just create layered window and position it over the target window. Give the layered window a region and whatever fancy alpha channel you want, and let the graphics engine do the heavy lifting of alpha blending and composition. Even better, the layered window can extend outside the window you are dragging over, something that <code>LockWindowUpdate</code> can't do. (You can see this effect in Windows&nbsp;XP if you do a "select all" in an Explorer window and drag the entire selection around the screen. Notice that the drag image is not constrained to the boundaries of the window you are dragging over.) </p>
<p> What's more, in the exciting new composited world of Vista's <a href="http://blogs.msdn.com/greg_schechter/archive/category/12510.aspx"> desktop window manager</a>, <code>LockWindowUpdate</code> is even less desirable. Locking a particular window for update isn't so bad since the desktop window manager can just give you the backing bitmap for the window. But if you lock the entire screen (which I've seen may people do), the desktop window manager needs to compose all of the windows into an <i>actual bitmap</i> that it can give you when you call <code>GetDCEx</code> with the <code>DCX_LOCKWINDOWUPDATE</code> flag. The desktop window manager does composition on the fly with the help of DirectX and accelerated video drivers. The result of all this composition normally goes straight to the screen without actually residing in a "composited" bitmap anyway. But if you lock the screen and ask for a DC to it, the desktop window manager needs to emulate the old behavior and give you access to something that represents what you <i>would have gotten</i> if there were no composition in the first place. That ain't cheap. </p>
<p> <b>Epilogue</b>. I'm not sure if this series was a success or not. My goal was just to help people use <code>LockWindowUpdate</code> more effectively and guide them towards alternatives when <code>LockWindowUpdate</code> is the wrong tool for the job. In other words, it's an article about <code>LockWindowUpdate</code>, not function documentation. I tried to keep the presentation light, but I guess my jokes fell flat, and people just used them as a springboard for negative comments. </p>
<p> And extra thanks to the people who took it as an opportunity to complain about the documentation. I mean, duh, if the documentation were perfect, I wouldn't have written this series in the first place. Though these people also neglected to read <i>all</i> of the documentation; they looked only at the function description page. There's more to documentation than dry function descriptions, people! The function description is a <i>reference</i>; you go there when you already know what's going on and you just need to fine-tune a detail. The real learning happens in the overviews and articles. If you want to learn how to operate your radio, you don't read the schematic first. </p>
<p> I think Ronald D.&nbsp;Moore is really onto something when he says, "You have to be tough enough to listen to the podcast." </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (38)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-475403">
				<div id="div-comment-475403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Craig</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475403">
			February 23, 2007 at 10:18 am</a>		</div>

		<p>Thanks for the series! I had never heard of LockWindowUpdate until now&#8230;and so I&#8217;m imagining all the intriguing-but-performance-ruining things I might be able to do with it.</p>
<p>Your comments about the DWM in Vista whetted my appitite, though. I&#8217;d love to read a series chatting about that and how to do strange things like rescale all the windows on your system, or rotate them in 3D!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475423">
				<div id="div-comment-475423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Risto</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475423">
			February 23, 2007 at 10:32 am</a>		</div>

		<p>Battlestar Galactica reference! Woo hoo! Love that show. Here is a suggestion for unhelpful comments &#8230; a system where we can mod them down.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475433">
				<div id="div-comment-475433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sergio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475433">
			February 23, 2007 at 10:43 am</a>		</div>

		<p>Raymond: &quot;I&#8217;m not sure if this series was a success or not.&quot;</p>
<p>Of course it was. As I saw from the comments not only I but more people who actually develop in Win32 really learned something.</p>
<p>Even the overview theme should give positive results: motivate readers to reread the overviews from time to time can be considered success.</p>
<p>Thank you!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475443">
				<div id="div-comment-475443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475443">
			February 23, 2007 at 11:01 am</a>		</div>

		<p>Nice series, Raymond. Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475473">
				<div id="div-comment-475473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ChrisR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475473">
			February 23, 2007 at 11:25 am</a>		</div>

		<p>Thanks for the series, Raymond. &nbsp;Don&#8217;t let the negative commenters get you down.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475523">
				<div id="div-comment-475523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zabkat.com' rel='external nofollow' class='url'>nikos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475523">
			February 23, 2007 at 11:51 am</a>		</div>

		<p>Raymond, i&#8217;m not sure what you mean by &quot;regional windows&quot;&#8230; is that non-rectangular windows e.g. as in</p>
<p><a rel="nofollow" target="_new" href="http://msdn2.microsoft.com/en-us/library/ms997507.aspx" rel="nofollow">http://msdn2.microsoft.com/en-us/library/ms997507.aspx</a> (?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475563">
				<div id="div-comment-475563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Koro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475563">
			February 23, 2007 at 12:22 pm</a>		</div>

		<blockquote><p>
  &gt; But if you lock the screen and ask for a DC to it, the desktop window manager needs to emulate the old behavior and give you access to something that represents what you would have gotten if there were no composition in the first place. That ain&#8217;t cheap.
</p></blockquote>
<p>Does that mean that using GetDC(NULL) to get a temporary DC to call functions such as GetTextMetrics is a very wrong? If yes, what should be done instead? Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475573">
				<div id="div-comment-475573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BA</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475573">
			February 23, 2007 at 12:31 pm</a>		</div>

		<p>Here, I&#8217;ll update the documentation for LockWindowUpdate:</p>
<p>&quot;LockWindowUpdate &#8211; Deprecated&quot;</p>
<p>Done. The ultimate &quot;use at your own risk&quot; tag.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475593">
				<div id="div-comment-475593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Doug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475593">
			February 23, 2007 at 12:59 pm</a>		</div>

		<p>Re: reading all the documentation.</p>
<p>When the function description page doesn&#8217;t tell you what you need to know and it doesn&#8217;t have any useful links. Internet search may not have the answer especially if you don&#8217;t know what question to ask. &nbsp;How do you find the answer within the multiple gigabytes of documentation without reading all of it? (How long would it take to read all of the MSDN content?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475603">
				<div id="div-comment-475603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475603">
			February 23, 2007 at 12:59 pm</a>		</div>

		<p>I think that Larry Lard is right &#8212; those who want to complain about some aspect of a topic are naturally more vocal than the silent appreciation of many.</p>
<p>And maybe the doc writers who read these comments will keep them in mind the next time they write new documentation, and do it better.</p>
<p>The comments don&#8217;t represent a valid scientific poll, of course!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475613">
				<div id="div-comment-475613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Doug</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475613">
			February 23, 2007 at 1:01 pm</a>		</div>

		<p>Thanks for the pointer to layered and regional windows. &nbsp;I have wondered how to do a nice drag and drop display.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475643">
				<div id="div-comment-475643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ned Wolf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475643">
			February 23, 2007 at 1:32 pm</a>		</div>

		<p>Awesome series, Raymond. &nbsp;Not only does it teach one specific aspect, but it also helps teach the thought pattern &#8212; I love the idea of the social history around the APIs. &nbsp;As an architect/technologist, I love seeing the line of questioning and thought that you take so I can apply it elsewhere.</p>
<p>Rock on, mightily rock on,</p>
<p>Ned, A fellow wearer-of-ties.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475663">
				<div id="div-comment-475663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475663">
			February 23, 2007 at 1:54 pm</a>		</div>

		<p>These series are great and highlight the history of the API. &nbsp;At the same time, with as good as the MSDN is, they also highlight big gaping holes in the documentation. &nbsp;How many other methods in the Win32 API are there that we aren&#8217;t supposed to use (and aren&#8217;t marked as deprecated.) &nbsp;Should I do a google search and read 3 articles on each API call before using it?</p>
<p>Just a brief note about its INTENDED USE might be helpful and then references to other ways to accomplish the same thing if it is deprecated&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475693">
				<div id="div-comment-475693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475693">
			February 23, 2007 at 2:15 pm</a>		</div>

		<p>You posted a kind of blogger manifesto some times ago that explained all the things your blog isn&#8217;t and all the things you are not and are not able to act on.</p>
<p>There should be a reader manifesto too:</p>
<p>&#8211; Not all things we say is meant for you to act on.</p>
<p>&#8211; We assume people at MS read this and may act on it.</p>
<p>&#8211; We have accuracy at heart. If something is not as clear as we think it should be, we will say so.</p>
<p>&#8211; The high-quality of content magnifies any defect. See previous point.</p>
<p>&#8211; We voice our opinions. Take them or leave them, it&#8217;s your choice. No one is twisting your arm. (Urm, okay, some are, but we know who they are.)</p>
<p>But I really think MS should review their model of the documentation reader if your comment is any indication of their position. Most people I know read the function documentation first and only go to the lengthy articles if they need more details.</p>
<p>Caveats, obsolete functions, and the like should go in the function documentation, not be buried in some explanatory overview. (Warning: I did not read the LockWindowUpdate docs, no need to point out that it&#8217;s already there if it is.)</p>
<div class="post">[<i>But the comments are going onto <u>my</u> web site; therefore they are all directed at me by default. If the comment isn&#8217;t meant for me, then say so. (And if it isn&#8217;t meant for me, why post it onto my web site?) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475703">
				<div id="div-comment-475703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475703">
			February 23, 2007 at 2:49 pm</a>		</div>

		<p>Insightful and good to know. &nbsp;Using the Community Content feature on MSDN, you ought to post links from the appropriate articles to here. &nbsp;Heck, I&#8217;m tempted to do it myself&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475753">
				<div id="div-comment-475753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475753">
			February 23, 2007 at 3:40 pm</a>		</div>

		<p>&lt;i&gt;(And if it isn&#8217;t meant for me, why post it onto my web site?)&lt;/i&gt;</p>
<p>Because you actually read them and respond. &nbsp;You&#8217;re the face of a huge corporation, like it or not.</p>
<div class="post">[<i>So they <u>are</u> meant for me after all, even though people say they aren&#8217;t. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475763">
				<div id="div-comment-475763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mikepope.com/blog/DisplayBlog.aspx?permalink=1700' rel='external nofollow' class='url'>mike's web log</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475763">
			February 23, 2007 at 3:51 pm</a>		</div>

		<p>I have been known, recently even, to opine on the breadth of documentation required to properly teach a product. Raymond Chen made the same point in a recent post (emphasis mine, of course): I&#8217;m not sure if this series [of blog posts] was a succes ..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475773">
				<div id="div-comment-475773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sonokie.net' rel='external nofollow' class='url'>eikonos</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475773">
			February 23, 2007 at 3:56 pm</a>		</div>

		<p>I&#8217;m one of the people who searched MSDN for a way to prevent a window from updating while doing something in the background and LockWindowUpdate was the first thing I found. &nbsp;I still think the documentation should be more clear though I understand your point of view on the subject. &nbsp;If you hadn&#8217;t written about it I would never have learned the proper way to lock a window from updating, so thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475803">
				<div id="div-comment-475803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475803">
			February 23, 2007 at 5:49 pm</a>		</div>

		<p>Koro: CreateIC (though the documentation is kind of lame, look at CreateDC&#8217;s to figure out what to pass to all the fields).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475833">
				<div id="div-comment-475833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475833">
			February 23, 2007 at 6:12 pm</a>		</div>

		<p>AlmostAlive wrote:</p>
<p>&quot;But the comments aren&#8217;t what you write, they&#8217;re for the community to discuss whatever they want about the topic.&quot;</p>
<p>imho that&#8217;s exactly wrong&#8230;this ain&#8217;t no democracy. &nbsp;The comments here are not for discussing anything other than whatever topic Raymond has raised. &nbsp;If he decided to enlighten us on the inner-workings of MSDN (right)&#8230;that&#8217;d be different.</p>
<p>And guess what&#8230;I wouldn&#8217;t be reading it. &nbsp;</p>
<p>Until then, please keep it on-topic&#8230;Raymond&#8217;s topic&#8230;so we can all learn about things which we already know aren&#8217;t cleared up by simply reading docs. &nbsp;Why do you think he does this in the first place?</p>
<p>Rock on, Raymond&#8230;I never learned so much actually useful info as I do here.</p>
<p>JD</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475483">
				<div id="div-comment-475483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.crazyontap.com' rel='external nofollow' class='url'>AlmostAlive</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475483">
			February 23, 2007 at 11:29 am</a>		</div>

		<p>&quot;I&#8217;m not sure if this series was a success or not.&quot;</p>
<p>*Yesterday* googling for LockWindowUpdate had this blog as the *first* result. &nbsp;If that continues to hold, the series will continue to be a success and enlightening people on the issues of LockWindowUpdate for years to come.</p>
<p>I know arguing about function documentation isn&#8217;t something that you wanted everyone to do. &nbsp;It&#8217;s not part of your blog. &nbsp;But the comments aren&#8217;t what you write, they&#8217;re for the community to discuss whatever they want about the topic. &nbsp;After reading this last post on the matter, it seems even more *obvious* that the documentation is lacking. &nbsp;If using it in Vista is so horrible and alternatives exist then the documentation should say it. &nbsp;Not your problem, I agree. &nbsp;But you shouldn&#8217;t be taking blog comments so personally &#8212; nobody said *you* should be doing anything about it. &nbsp;Maybe we&#8217;ll get lucky and somebody else at Microsoft will read these comments.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475863">
				<div id="div-comment-475863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ulric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475863">
			February 23, 2007 at 7:33 pm</a>		</div>

		<blockquote><p>
  I&#8217;m not sure if this series was a success or not.
</p></blockquote>
<p>&quot;But, I&#8217;m Good Enough, I&#8217;m Smart Enough, and Doggone It, People Like Me!&quot;</p>
<p>-Raymond Smalley</p>
<p>:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475503">
				<div id="div-comment-475503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry Lard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475503">
			February 23, 2007 at 11:41 am</a>		</div>

		<p>&gt;&gt; I tried to keep the presentation light, but I guess my jokes fell flat, and people just used them as a springboard for negative comments.</p>
<p>I suspect and hope that the negative comments are from the few, whereas the appreciation of the many is largely silent. In common with all my cow-orkers who read your blog, I find your posts both enlightening and entertaining, but I&#8217;ve never thought it particularly pointful to post and say so.</p>
<p>Please don&#8217;t think that just because the comments tend to be a home for snark and pickiness, that that&#8217;s what most of your readers are actually thinking &#8211; after all, *commenters* are but a small proportion of *readers* &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475883">
				<div id="div-comment-475883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475883">
			February 23, 2007 at 8:35 pm</a>		</div>

		<p>&quot;I&#8217;m not sure if this series was a success or not.&quot;</p>
<p>Raymond &#8212; not only are you tops for &#8216;lockwindowupdate&#8217; in the major search engines &#8212; but the rest of the results (when they&#8217;re relevant) all give the BAD information about LockWindowUpdate (shudder &#8212; even a bunch of information on the Microsoft site).</p>
<p>You&#8217;ve done good, and thank you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475583">
				<div id="div-comment-475583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475583">
			February 23, 2007 at 12:36 pm</a>		</div>

		<p>These series are always informative and interesting, so please keep them coming. </p>
<p>Maybe you need a new tagline: Instead of &#8216;not actually a .NET blog&#8217; how about &#8216;I Did Not Write *All* Of Windows&#8217;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-475813">
				<div id="div-comment-475813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475813">
			February 23, 2007 at 5:52 pm</a>		</div>

		<p>Raymond: &quot;the desktop window manager needs to compose all of the windows into an actual bitmap that it can give you when you call GetDCEx with the DCX_LOCKWINDOWUPDATE flag &#8230; desktop window manager does composition on the fly with the help of DirectX and accelerated video drivers.&quot;</p>
<p>LockWindowUpdate/DCX_LOCKWINDOWUPDATE isn&#8217;t the problem, it&#8217;s what people inevitably do *after* they&#8217;ve locked the screen &#8212; screen readback. &nbsp;When you read back from the screen, the DWM has to copy the bits back from video memory to a system memory bitmap (which is expensive for a number of reasons); the DWM never renders without DirectX+hardware acceleration. &nbsp;Screen readback can happen explicitly (e.g. using the screen DC as the source for a BitBlt) or implicitly (e.g. when the screen is the target for an AlphaBlend or PatBlt). &nbsp;These readback operations will be expensive whether or not LockWindowUpdate is used.</p>
<p>Also, it&#8217;s worth noting that UpdateLayeredWindow/SetLayeredWindowAttributes can only do straight up alpha blending and not any fancy ROPs, so if you *really* need to, say, R2_MERGEPENNOT with a yellow pen to the screen, then unfortunately there isn&#8217;t an alternative.</p>
<p>Using layered windows or region windows is ideal if you can use it instead.</p>
<p>Koro: &quot;Does that mean that using GetDC(NULL) to get a temporary DC to call functions such as GetTextMetrics is a very wrong?&quot;</p>
<p>No, GetDC(NULL) is fine to do. &nbsp;It&#8217;s only when readback happens that it becomes a problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-476013">
				<div id="div-comment-476013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://aundh.blogspot.com' rel='external nofollow' class='url'>JamesW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476013">
			February 24, 2007 at 12:17 pm</a>		</div>

		<p>@eikonos</p>
<p>&#8216;I&#8217;m one of the people who searched MSDN for a way to prevent a window from updating while doing something in the background and LockWindowUpdate was the first thing I found.&#8217;</p>
<p>Me too. Though I probably looked on Google before MSDN. This series has been helpful, as I&#8217;ve found some of our code that is probably misusing LockWindowUpdate(). I don&#8217;t think I&#8217;d heard of SetWindowRedraw(), so without this series I wouldn&#8217;t have known any better. Good to hear that this information is top of the Google hit parade for LockWindowUpdate(), that ought to save others going down the wrong path.</p>
<p>As for the documentation, yes I was a bit surprised that LockWindowUpdate() didn&#8217;t do what I thought it did, and MSDN didn&#8217;t do anything to clear my confusion. Still, I find that MSDN is on the whole is remarkably good. It&#8217;s certainly better than Apple&#8217;s documentation IMO.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-476033">
				<div id="div-comment-476033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.microsoft.com/mediacenter' rel='external nofollow' class='url'>Fred</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476033">
			February 24, 2007 at 5:51 pm</a>		</div>

		<p>nikos: The term &quot;regional windows&quot; refers to the support exposed by the SetWindowRgn() API. &nbsp;It predates compositing effects like layered windows by some time &#8211; the feature was introduced in Windows NT 3.51 and Windows 95.</p>
<p>SetWindowRgn() adds a step to the clipping calculation for the visible region of your window (calculations the window manager already does to support partial or full occlusion). &nbsp;The simplest way to think of this is &quot;non-rectangular&quot; window support.</p>
<p>Complex clipping incurs a performance penalty on drawing operations, so care must be taken. &nbsp;Also, updating the region can have side-effects on invalid regions of your window and the windows under you, so unlike layered windows, you shouldn&#8217;t use regional windows for animation.</p>
<p>On the other hand, there is no backing store required so some simple non-animating effects are far cheaper to implement with regional windows.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-475993">
				<div id="div-comment-475993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-475993">
			February 24, 2007 at 10:32 am</a>		</div>

		<p>As someone who highlighted problems with the documentation, I assume I&#8217;m one of the &#8216;negative&#8217; posters various people are complaining about.</p>
<p>My view (apart from my opinion that I was trying to be constructive and positive) was that as Raymond&#8217;s blog is at least partially about compatibility issues in Windows, often caused by incorrect usages of APIs that then have to be supported, that problems with documentation that *cause* these errors was relevant. &nbsp;Particularly in the specific case of the function/API being discussed by Raymond.</p>
<p>Apparently that isn&#8217;t relevant after all, and documentation is something that happens to other people, so I apologise for the noise.</p>
<p>(As an aside, I did go and read the overviews on MSDN. &nbsp;There was more specific info on LockWindowUpdate, but still no clear indication that it should not be used for the purposes many people use it for &#8211; i.e. those purposes that might be assumed from its name. &nbsp;Also, I saw no mention of SetWindowRedraw() etc either. &nbsp;In fact, try searching MSDN for SetWindowRedraw() &#8211; even when you know the name of the function it&#8217;s not exactly easy to find.)</p>
<p>Oh well, whatever. &nbsp;After a period of hearing some people vehemently defend something (that most people agree is defective) from constructive suggestions that require small effort to implement, you kind of stop caring. &nbsp;That&#8217;s where I am now. &nbsp;It&#8217;s no wonder people misuse APIs.</p>
<div class="post">[<i>&#8220;This wouldn&#8217;t have happened if the documentation didn&#8217;t suck&#8221; is hardly a novel contribution. And that&#8217;s why I write series like this from time to time. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-476053">
				<div id="div-comment-476053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://com2kid.wordpress.com' rel='external nofollow' class='url'>Devlin Bentley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476053">
			February 25, 2007 at 1:21 am</a>		</div>

		<p>Well, for one thing, you are someone we can complain to! &nbsp;Also, there is a chance for the readers to learn something as well!</p>
<p>The thing is, I think 95% of the people who complain know that they are doing something wrong, but they don&#8217;t want to admit that they are doing something wrong, and it becomes easy to blame MS.</p>
<p>I believe that the open source movements have an advantage that if I care to look, I can actually find out who wrote the documentation for a function and send my complains that way! &nbsp;Indeed, below all MAN pages, there is the author&#8217;s e-mail address, for good reason! &nbsp;MSDN would likely be a lot better if that where the case for all MSDN documentation as well. &nbsp;:) &nbsp;Of course, people move on, but within a year or so of being written, enough complains would be filed to get the documentation to a state better than that in which it started.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-476173">
				<div id="div-comment-476173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wilhelm Svenselius</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476173">
			February 26, 2007 at 1:40 am</a>		</div>

		<p>Excellent series, Raymond. Despite the fact that I lurk 99% of the time I felt the need to mention this as you seem to think the negative people are in something other than a pathetic minority.</p>
<p>Just ignore the complainers &#8212; eventually they&#8217;ll figure out how pathetic they are blaming $GIANT_CORP for their lack of programming skills.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-476213">
				<div id="div-comment-476213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476213">
			February 26, 2007 at 10:41 am</a>		</div>

		<p>@Devlin Bentley</p>
<p>You&#8217;re mising the subject of this entry. Please write that in some other forum.</p>
<p>The readers who actually learn something here should try to save Raymond to be able to expect from him to write more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-476303">
				<div id="div-comment-476303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476303">
			February 26, 2007 at 11:44 am</a>		</div>

		<p>&#8220;And if it isn&#8217;t meant for me, why post it onto my web site?&#8221;</p>
<p>Like I said, a lot of posters assume that people who could act on it, MS insiders, can act on the comments.</p>
<p>Like it or not, your blog is under blogs.msdn and you allow comments. So, yes, it does give the impression that it is somewhat related to MSDN in general and people will comment on stuff you can&#8217;t change. We don&#8217;t know just how much power you have to effect changes.</p>
<p>Beside, even though your comments may change some people&#8217;s behavior, I doubt it will generally. I think it&#8217;s better to acknowledge this state of affair and only deal with what you can and not sweat it.</p>
<div class="post">[<i>Perhaps I need to move the blog then. If being hosted on blogs.msdn is the key factor, then why not distribute these comments over the hundreds of blogs on blogs.msdn? Share the love. The power I have to effect change is to submit feedback to the MSDN folks, same as you. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-476563">
				<div id="div-comment-476563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476563">
			February 26, 2007 at 2:55 pm</a>		</div>

		<p>I agree that &#8216;the documentation sucks&#8217; is not a novel contribution, but I thought I was saying a bit more than that &#8211; well, in fact, I was curious as to how much people like Raymond felt they were able to cause these things to be fixed (or not) &#8211; i.e. from the perspective of within MS.</p>
<p>As I mentioned, I&#8217;m fully aware that despite what some people may think, Raymond doesn&#8217;t wield some sort of superhuman power within MS. &nbsp;I also think that saying just because his blog is on the msdn blogs site that he is able to do stuff is not particularly valid. &nbsp;But then that may only be because I&#8217;ve been reading this blog for quite a while and I know what&#8217;s in Raymond&#8217;s power to change, and what is not.</p>
<p>To be super clear: I&#8217;m not moaning about this series. &nbsp;I&#8217;m very glad it&#8217;s here, so if I ever need to use LockWindowUpdate(), I&#8217;ve got some good pointers. &nbsp;</p>
<p>After all, Raymond&#8217;s series on shell extensions was the only way I ever worked out how to interface to Explorer to copy virtual files, etc. &nbsp;I&#8217;m not likely to start complaining about oldnewthing itself now :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-476883">
				<div id="div-comment-476883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-476883">
			February 26, 2007 at 9:59 pm</a>		</div>

		<p>Raymond, you&#8217;ve said in the past that you post entries in your blog at times so that other people in MS may see what they&#8217;re doing wrong. &nbsp;If you think it&#8217;s likely that other people at MS will read your posts, it should then be logical to assume that other people at MS will read the comments as well, and that these comments are directed at the same audience as the original posts. &nbsp;For that reason, it makes sense to assume they&#8217;re not directed at you unless they specifically say that they&#8217;re directed at you.</p>
<p>I&#8217;ve really enjoyed reading your blog, and have learned a lot from it. &nbsp;I&#8217;d hate for you to have to stop because you think people are bashing on you, especially if that&#8217;s not their intent.</p>
<div class="post">[<i>There is no comments RSS feed, and even if there were, I doubt many people would subscribe to it. I sure don&#8217;t subscribe to the comment feeds of the blogs I follow. If you are directing your comments to a particular team, post a comment to their blog (if they have one). -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-477433">
				<div id="div-comment-477433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">GregM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-477433">
			February 27, 2007 at 9:23 pm</a>		</div>

		<p>I guess I&#8217;m weird, then, because I read the comments via RSS. &nbsp;Each post has its own feed, and my reader shows me those feeds. &nbsp;For example, the feed for this post is at</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/commentrss.aspx?PostID=1747713" rel="nofollow">http://blogs.msdn.com/oldnewthing/commentrss.aspx?PostID=1747713</a></p>
<p>I don&#8217;t find it out of place that posts about things that people do wrong spark discussions about things that people do wrong or point out possible reasons that people do these things wrong and how to fix the problems that cause people to do things wrong. &nbsp;Private email, yes, that would be out of place, but not public discussion. &nbsp;I guess the big difference is whether one views blog comments as responses directly to the poster, or as public discussion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-478893">
				<div id="div-comment-478893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Bray</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-478893">
			March 2, 2007 at 12:03 pm</a>		</div>

		<blockquote><p>
  I&#8217;m not sure if this series was a success or not.
</p></blockquote>
<p>Well I enjoyed it for one, and I suspect many other people who like peeking under the bonnet of Windows did too.</p>
<p>So ignore the negative posters and keep the geeky articles coming! :-)</p>
<p>James Bray</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-500223">
				<div id="div-comment-500223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.csdn.net/balonfan/archive/2007/05/05/1597021.aspx' rel='external nofollow' class='url'>BalonFan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070223-00/?p=27893#comment-500223">
			May 5, 2007 at 2:08 am</a>		</div>

		<p>ç°å¨å¤§å®¶äºè§£äºLockWindowUpdateçè®¾è®¡æå¾ï¼æç°å¨å°è¦åè¯å¤§å®¶ä½ ä»¬ä¸ºä»ä¹ä¸åºå½ä½¿ç¨è¿ä¸ªå½æ°ï¼çè³ä¸æ¯å ä¸ºå¶è®¾è®¡æå¾çç¼å ã</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

