<html>
<head>
<title>How can I tell if Windows Update is waiting for the system to reboot?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How can I tell if Windows Update is waiting for the system to reboot?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>September 21, 2015 / year-entry #197</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>45</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Today's Little Program shows how to ask whether Windows Update is waiting for the system to reboot. You might want to check this in your installer, so that you don't try to install your program while the system is in a mixed state where an update is partially-installed. Testing this from script is easy. MSDN...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
Today's Little Program shows how to ask whether Windows Update
is waiting for the system to reboot.
You might want to check this in your installer,
so that you don't try to install your program while the system
is in a mixed state where an update is partially-installed.
</p>
<p>
Testing this from script is easy.
<a HREF="http://technet.microsoft.com/en-us/library/ee692834.aspx">
MSDN contains sample code to do that</a>.
Let's do it from C++.
Today's smart pointer class is (rolls dice)
<code>_com_ptr_t</code>!
Remember that Little Programs do little to no error checking.
</p>
<pre>
#include &lt;windows.h&gt;
#include &lt;comdef.h&gt; // for _COM_SMARTPTR_TYPEDEF
#include &lt;wuapi.h&gt;  // for ISystemInformation
#include &lt;stdio.h&gt;  // for printf (horrors! mixing stdio and C++!)

_COM_SMARTPTR_TYPEDEF(ISystemInformation, __uuidof(ISystemInformation));

int __cdecl main(int argc, char** argv)
{
 <a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2004/05/20/135841.aspx">CCoInitialize</a> init;
 ISystemInformationPtr info;
 info.CreateInstance(CLSID_SystemInformation);

 VARIANT_BOOL rebootRequired;
 info-&gt;get_RebootRequired(&map;rebootRequired);

 printf("Reboot required? %d\n", rebootRequired);
 return 0;
}
</pre>
<p>
Remember that
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2004/12/22/329884.aspx">
<code>VARIANT_<wbr>BOOL</code> uses <code>-1</code> to represent
<code>VARIANT_<wbr>TRUE</code></a>,
so if a reboot is required, you will see <code>-1</code>.
Personally, I would treat any nonzero value as logically true.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (45)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1203091">
				<div id="div-comment-1203091" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203091">
			September 21, 2015 at 7:05 am</a>		</div>

		<p>[any nonzero as logically true]</p>
<p>What a pleasant use for the !! operator.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1203081">
				<div id="div-comment-1203081" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203081">
			September 21, 2015 at 7:07 am</a>		</div>

		<p>Hmmm, is this any different (in overall result) than checking HKLMSOFTWAREMicrosoftWindowsCurrentVersionWindowsUpdateAuto UpdateRebootRequired ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1203071">
				<div id="div-comment-1203071" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">EduardoS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203071">
			September 21, 2015 at 7:13 am</a>		</div>

		<p>Does the &quot;↦&quot; have any meaning or is just a copy &amp; paste error?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman odd alt thread-odd thread-alt depth-1" id="comment-1203061">
				<div id="div-comment-1203061" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203061">
			September 21, 2015 at 7:14 am</a>		</div>

		<p>@Neil: I would suppose that the API method is officially supported while pinging a registry key is not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1203051">
				<div id="div-comment-1203051" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Medinoc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203051">
			September 21, 2015 at 7:18 am</a>		</div>

		<p>This Boolean remark reminds me of the TAR format and its numerous variants. In the end, I couldn&#39;t find enough information on whether a single-byte Boolean field was guaranteed (or even supposed) to be 0/1 or &#39;0&#39;/&#39;1&#39; (and on which TAR variant), so I decided to treat both 0 and &#39;0&#39; as logically false, and anything else as logically true.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1203041">
				<div id="div-comment-1203041" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">VinDuv</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203041">
			September 21, 2015 at 7:18 am</a>		</div>

		<p>@Eduardo: It’s a typo in the HTML code: @amp; -&gt; @map; (which renders as an arrow because it apparently means “maps to”)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1203031">
				<div id="div-comment-1203031" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Martin Bonner</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203031">
			September 21, 2015 at 8:01 am</a>		</div>

		<p>@VinDuv: &nbsp;Eek! &nbsp;That means Raymond must be typing the HTML by hand. &nbsp;I knew he was hardcore, but that is _seriously_ hardcore!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1203021">
				<div id="div-comment-1203021" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Another John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203021">
			September 21, 2015 at 8:07 am</a>		</div>

		<p>What happens if you want to determine if a remote computer requires a reboot? If I have a server farm I might want to work out which machines were in need of rebooting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mngoldeneagle even thread-even depth-1" id="comment-1203011">
				<div id="div-comment-1203011" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MNGoldenEagle' rel='external nofollow' class='url'>MNGoldenEagle</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1203011">
			September 21, 2015 at 8:25 am</a>		</div>

		<p>@Another John: Some googling around shows that there doesn&#39;t seem to be a good supported method for this, but it looks like someone worked out an &quot;unsupported&quot; way via remote registry (<a rel="nofollow" target="_new" href="https://gallery.technet.microsoft.com/scriptcenter/Get-PendingReboot-Query-bdb79542">gallery.technet.microsoft.com/&#8230;/Get-PendingReboot-Query-bdb79542</a>). &nbsp;It&#39;s PowerShell, so you could easily pass it a list of computers to inspect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 odd alt thread-odd thread-alt depth-1" id="comment-1202991">
				<div id="div-comment-1202991" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202991">
			September 21, 2015 at 9:26 am</a>		</div>

		<p>@Another John: Ideally you wouldn&#39;t let servers just update themselves whenever new updates were available. &nbsp;You&#39;d schedule and control that and reboot them right away to make sure they come back up etc&#8230; Ideally you&#39;d be using something like Microsoft System Center with Configuration Manager (or suitable third-party equivalent) to manage your farm.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202981">
				<div id="div-comment-1202981" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202981">
			September 21, 2015 at 10:41 am</a>		</div>

		<p>I just want to figure out how to run Group Policy on Windows 10 Home so I can move Windows Update to manual mode&#8230; &gt;.&lt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202971">
				<div id="div-comment-1202971" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202971">
			September 21, 2015 at 10:45 am</a>		</div>

		<p>&gt; (rolls dice)</p>
<p>I really hope you keep a die on your desk that you actually roll for these.</p>
<div class="post">[<em>(Looks around nervously.) (whisper) The dice are loaded. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202961">
				<div id="div-comment-1202961" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Billy O'Neal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202961">
			September 21, 2015 at 11:13 am</a>		</div>

		<p>@Joshua Please do the world a favor and use != 0 instead</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202951">
				<div id="div-comment-1202951" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202951">
			September 21, 2015 at 12:32 pm</a>		</div>

		<p>@Myria </p>
<p>You cannot, and there&#39;s no reason for anyone on Home to be suspending Windows Updates indefinitely.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202931">
				<div id="div-comment-1202931" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202931">
			September 21, 2015 at 2:07 pm</a>		</div>

		<p>@Myria: making the appropriate registry changes (and setting permissions on the keys to disallow further modification) would probably do the trick. &nbsp;Unsupported, of course.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202921">
				<div id="div-comment-1202921" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202921">
			September 21, 2015 at 3:59 pm</a>		</div>

		<p>@Anon: yes there is; for instance you are going to travel tomorrow and don&#39;t want any surprises, or you are in the woods and your connection is very slow and shared with ten other people. Suspending updates until you are in a &quot;safe&quot; situation (for instance, at a friend&#39;s house with a fast Internet connection) is a good idea.</p>
<p>@Martin Bonner: we all typed HTML by hand back in the 90&#39;s. Don&#39;t you remember all the &quot;made with Notepad&quot; icons? It&#39;s not that hardcore, just old-fashioned.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202911">
				<div id="div-comment-1202911" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">foo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202911">
			September 21, 2015 at 4:35 pm</a>		</div>

		<p>@Another John. I would guess CoCreateInstanceEx (ie: using DCOM). Although using DCOM to solve a problem can be kind of like using regex [now you have two problems] if firewalls are involved or the machines cross trust boundaries, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202901">
				<div id="div-comment-1202901" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202901">
			September 21, 2015 at 7:03 pm</a>		</div>

		<p>That&#39;s handy. I wanted to implement an &quot;I&#39;m leaving&quot; button since a while.</p>
<p>if (updates_pending()) do_shutdown(); else do_sleep();</p>
<p>↓ PS: background info ↓:</p>
<p>You know how windows 7 shows a fancy shut down button before it installs those updates? And how—to give the user an additional kick in the balls—it just shows the usual sleep button after the updates are installed and the countdown is running?</p>
<p>Here’s a list of things which force you to disable auto-updates on Windows 7 (and thus avoid the automatic reboots) </p>
<p> – watching movies full-screen</p>
<p> – playing games full-screen (especially multiplayer games, and those hard-core games where you can&#39;t pause or save)</p>
<p> – running a heavy processing job overnight</p>
<p> – generally, working. It&#39;s easy to hide that popup when you&#39;re clicking around.</p>
<p>It&#39;s hard to explain just how aggravating it is to have your PC reboot all of a sudden.</p>
<p>So Windows 10 addresses this by scheduling reboots overnight, but you can&#39;t disable updates. This has the following problems:</p>
<p> – disk trashing while installing updates. A laptop with a 5400rpm harddrive will be pretty much unresponsive while those updates are installed. It&#39;s pretty bad on a desktop with a 7200rpm drive (AFAIK installing on a mechanical drive is still officially supported).</p>
<p> – network trashing on slow connections or connections with limited data volume. If you regularly use 3G tethering on your laptop you&#39;ll very badly screwed in most countries.</p>
<p> – running a heavy processing job overnight can still screw up.</p>
<p> – not sure how this will work in my case. I&#39;m one of those people who never reboots his computer, but who suspends it overnight. I don&#39;t want my PC to reboot right after switching it on in the morning. That&#39;s why I want my fancy button I mentioned above.</p>
<p>It&#39;s a hard problem to solve. You have to reboot at some point to install kernel updates. But for many users there is not really a convenient time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202891">
				<div id="div-comment-1202891" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202891">
			September 21, 2015 at 9:40 pm</a>		</div>

		<p>Funny. Some hours ago I realized that under Windows 10 supplying power to your notebook means that Windows restarts itself automatically _without even asking_ if there are pending updates in queue. I skip my flame and the question of &quot;why in hell do you do that?&quot; for now because it is not relevant to this post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202881">
				<div id="div-comment-1202881" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202881">
			September 21, 2015 at 9:56 pm</a>		</div>

		<p>@RS: well, my Win7 computer wakues up from sleep at 3AM, does its updates, reboots, and goes to sleep again. Isn&#39;t that default? OTOH my Win8.1 tablet shows &quot;updates were installed. This computer will reboot this day if you don&#39;t do it yourself&quot; &#8212; for a week, if you put it to sleep between uses. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202871">
				<div id="div-comment-1202871" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jerzyszczur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202871">
			September 22, 2015 at 12:08 am</a>		</div>

		<p>&quot;@RS: well, my Win7 computer wakues up from sleep at 3AM, does its updates, reboots, and goes to sleep again. Isn&#39;t that default?&quot;</p>
<p>I am afraid your computer is possessed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202861">
				<div id="div-comment-1202861" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202861">
			September 22, 2015 at 3:41 am</a>		</div>

		<p>@Engywuck: how do you prevent the 3AM update from being blocked by applications which ask for data to be saved? I usually restart during the day, and every time I have to save the data I really need, then instruct Windows to force shutdown on the rest (since I can&#39;t be bothered to manually resolve each situation).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202831">
				<div id="div-comment-1202831" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202831">
			September 22, 2015 at 7:15 am</a>		</div>

		<p>@Boris &#8212; speaking from Windows 8 experience you just lose the data. &nbsp;It has bit me once or twice at home.</p>
<p>Fortunately one good thing from the phone app experience that is slowly trickling to the desktop experience is auto save. &nbsp;I see more and more software that will just pick up where you left off when you restart it, regardless of whether you saved your documents. &nbsp;I suspect this bit of Windows 10 will further encourage that behavior.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202631">
				<div id="div-comment-1202631" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yukkuri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202631">
			September 22, 2015 at 12:04 pm</a>		</div>

		<p>@RS: The word you were looking for is &#39;thrashing&#39;, not &#39;trashing&#39;. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202611">
				<div id="div-comment-1202611" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">HdS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202611">
			September 22, 2015 at 12:28 pm</a>		</div>

		<p>The annoying thing about W10 is that the updates are even trying to install if the pc sleeps due to hibernate. Than the PC starts, discoers that some programs are running and stays awake. Which costs money and startles our pets which make quite a raket in the middle of the night.</p>
<p>Thank microsoft for making hibernate unusuable&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 odd alt thread-odd thread-alt depth-1" id="comment-1202561">
				<div id="div-comment-1202561" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202561">
			September 22, 2015 at 1:51 pm</a>		</div>

		<p>@everybody-wanting-to-disable-delay-windows-updates:</p>
<p>YOU are the reason we can&#39;t have nice things. &nbsp;I don&#39;t see a single valid reason above that isn&#39;t just some manufactured scenario.</p>
<p>&#8211; In the woods on a tethered connection? &nbsp;Seriously? &nbsp;You do know that by default Windows won&#39;t download updates over a metered connection don&#39;t you? &nbsp;</p>
<p>&#8211; 5400 RPM Laptop? &nbsp;Do those even exist anymore?</p>
<p>&#8211; It updates at the wrong time, I&#39;m awake and working at 3AM &#8211; so reschedule the time no problem&#8230;</p>
<p>All of my current machines reboot in under a minute and even my several-years-old laptop comes back under 2 minutes. &nbsp;Go for a soda or empty yourself of the last one while it reboots. &nbsp;Not wanting to reboot is so 1995. &nbsp;You didn&#39;t want to because it took so long but now? Get a grip people.</p>
<p>Ok, I feel better now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202481">
				<div id="div-comment-1202481" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202481">
			September 22, 2015 at 6:24 pm</a>		</div>

		<p>@David: <a rel="nofollow" target="_new" href="http://www.dell.com/nz/p/inspiron-15-5558-laptop/pd?ref=PD_OC">http://www.dell.com/&#8230;/pd</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1202441">
				<div id="div-comment-1202441" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202441">
			September 22, 2015 at 7:09 pm</a>		</div>

		<p>@David: [In the woods on a tethered connection? &nbsp;Seriously? &nbsp;You do know that by default Windows won&#39;t download updates over a metered connection don&#39;t you?]</p>
<p>Windows don&#39;t know it&#39;s on metered connection unless you&#39;re using a 3G/4G enabled version. If you&#39;re connecting it over &quot;3G/4G connection sharing device&quot; that&#39;s common when you travel to Japan (it allows flexible per day/per bandwidth usage rates, so is better choice than fixed bandwidth usage prepaid cards), it wouldn&#39;t know the difference.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202431">
				<div id="div-comment-1202431" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Barts</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202431">
			September 22, 2015 at 7:34 pm</a>		</div>

		<p>I&#39;m probably dense, but is there a technical reason you used printf in your Little Program, or do you just prefer format strings to iostreams?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202361">
				<div id="div-comment-1202361" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202361">
			September 22, 2015 at 10:24 pm</a>		</div>

		<p>@David Totzke</p>
<p>Ok, so yesterday evening I needed to quickly print out a document from my PC before taking the bus to a friend&#39;s place. My PC decided, while I was exploring for the document, to reboot.</p>
<p>It then started installing updates which took about 10 minutes for who knows what reason (my PC has only SSDs, and an Intel i7, so I assume it should be &quot;fast&quot;).</p>
<p>Net result: I missed the bus, had to take a later one.</p>
<p>Was I happy about this automatic reboot? No. Would I have been happy if I could have suspended it, say, 15 minutes? Yes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202341">
				<div id="div-comment-1202341" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dead1ne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202341">
			September 23, 2015 at 1:39 am</a>		</div>

		<p>@David</p>
<p>I leave my PC on 24/7 and almost never reboot. Right now I have:</p>
<p>3 Terminal Windows</p>
<p>2 Browser Windows with 10 and 7 tabs</p>
<p>1 Text Editor with 14 tabs</p>
<p>4 Misc Apps</p>
<p>I am not even actively working on anything right now if I am working there is usually more.</p>
<p>Of those only the text editor can restart and return to its current state. For the browser windows the tabs do come back but the page state is reset ie my 3 paused youtube vids lose their place and start playing. For me any automatic reboot is unacceptable simply because of the effort to restore my environment. I need to be able to choose exactly when I reboot to apply an update at a time that will cause the least disruption. While you could blame the programs that cannot gracefully handle reboots I should not be punished for the fact that the applications I need cannot currently do so.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202331">
				<div id="div-comment-1202331" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202331">
			September 23, 2015 at 3:16 am</a>		</div>

		<p>dead1ne is dead on. For me it tends to be open Visual Studio windows, perhaps a couple of Notepad windows with log files I didn&#39;t change deliberately, a bunch of open Word documents I didn&#39;t change deliberately either, etc. The solution is a couple of manual saves for items I did want to change + Force Restart.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202321">
				<div id="div-comment-1202321" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202321">
			September 23, 2015 at 4:16 am</a>		</div>

		<p>@David:</p>
<p>&gt; &#8211; In the woods on a tethered connection? &nbsp;Seriously? &nbsp;You do know that by default Windows won&#39;t download updates over a metered connection don&#39;t you? &nbsp;</p>
<p>I&#39;ve got a computer at my weekend that&#39;s primarily used by my family members to check their e-mail (not everybody has a laptop, and some aren&#39;t comfortable using a smartphone). Since the weekend is mostly in use during the summer, there&#39;s no point in getting a DSL connection (there isn&#39;t even a phoneline), so we simply use a pre-paid 3G dongle. Guess what the update options are.</p>
<p>&gt; &#8211; It updates at the wrong time, I&#39;m awake and working at 3AM &#8211; so reschedule the time no problem&#8230;</p>
<p>I lost several hours of work when I left a long-running task overnight, and Windows decided it would be great to reboot for updates (and I never saw the notification that the update reboot is scheduled &#8211; because that only appears for about 30 seconds, and was apparently shown while I was away from my computer; so much for letting me plan the reboot). Luckily a group policy change worked around this problem, but good luck doing this on a non-domain-joined computer.</p>
<p>&gt; All of my current machines reboot in under a minute and even my several-years-old laptop comes back under 2 minutes. &nbsp;Go for a soda or empty yourself of the last one while it reboots. &nbsp;Not wanting to reboot is so 1995. &nbsp;You didn&#39;t want to because it took so long but now? Get a grip people.</p>
<p>Windows boots in about 30 seconds at work. Getting all of the programs I use open again and to the state they were before the reboot takes about 10 minutes. This is an i5 with 12GB RAM and SSD, but some programs are simply slow (and good luck getting the vendors to fix that).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1202191">
				<div id="div-comment-1202191" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202191">
			September 23, 2015 at 9:23 am</a>		</div>

		<p>@David Totzke, you&#39;re gaining a lot of hate on this. &nbsp;Here&#39;s some more.</p>
<p>I want the computer to do what I need to do, not exactly what it needs to do. &nbsp;If it needs to do something that messes up with what I want to do, the decision should go through me.</p>
<p>YOU are the reason why we&#39;ll all find it normal to be subjugated by machines. &nbsp;And I mean all, even those in high-command that everyone believes is telling the machines what to do and not the other way around.</p>
<p>Go restart you PC.</p>
<p>So seriously:</p>
<p>&#8211; Tethering is the easiest way to have internet anywhere nowadays: smartphones, 3G wifi routers, dongles that pretend to be regular ethernet network cards, etc. &nbsp;Windows couldn&#39;t be more wrong about what is or is not a metered connection, unless we could tell it.</p>
<p>&#8211; Not only do slow disks exist, lots of Windows 7 and Windows 8 computers are from an era where SSD was too expensive for most pockets.</p>
<p>&#8211; Rescheduling is only an option if you&#39;re staring at the computer when it decides it must reboot in X minutes in case you don&#39;t reschedule.</p>
<p>The solution are live updates, which are essentially impossible in most scenarios. &nbsp;Perhaps when you can virtualize kernel-mode drivers, user-mode drivers, applications from libraries, applications from the running environment, etc, that becomes possible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1202131">
				<div id="div-comment-1202131" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202131">
			September 23, 2015 at 10:21 am</a>		</div>

		<p>@Brian_EE: I would suppose that the API method is officially supported while pinging a registry key is not.</p>
<p>Pinging registry doesn&#39;t require heavy weight COM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 odd alt thread-odd thread-alt depth-1" id="comment-1202061">
				<div id="div-comment-1202061" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202061">
			September 23, 2015 at 1:10 pm</a>		</div>

		<p>Safe by Design, Safe by Default, Safe in Depth. I believe that was the new mantra when Microsoft did a full-stop security sweep back in the XP-SP2 (?) days. &nbsp;It&#39;s what everyone, to within experimental error, was and has been screaming for. &nbsp;Now you have it and you&#39;re complaining.</p>
<p>On a domain joined machine you are at the mercy of Group Policy, subvert that at your peril. &nbsp;I&#39;m at a place right now where they give you a day or two of a window and if you don&#39;t apply the advertised updates it gets done automatically and a reboot is forced. &nbsp;I&#39;m OK with that. &nbsp;I was warned.</p>
<p>On a pro version of Windows not joined to a domain you have control. &nbsp;On Windows 10: Settings -&gt; Windows Update &#8211; Advanced options -&gt; Choose how updates are installed. &nbsp;Select &quot;Notify to schedule restart&quot;. If you didn&#39;t change the settings to something that suits you that&#39;s on you not Microsoft.</p>
<p>Is there no place to choose when/how updates are installed with Home version? I haven&#39;t used a &quot;home version&quot; in forever. Personally anyone running home version can&#39;t be trusted [tongue-in-cheek] so automatic forced reboots are fine with me.</p>
<p>Finally, I, for one, have always supported equal rights for artificially intelligent entities and look forward to serving our new cybernetic overlords. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1202011">
				<div id="div-comment-1202011" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202011">
			September 23, 2015 at 7:11 pm</a>		</div>

		<p>@David: Tell me, for average PC users, how could you justify buying an OS that doubles the price when all the function you need from a business version is just the way to turn off Windows Update, when you can buy Win7 Home that does it.</p>
<p>It just mean the only option we have when asked about whether Win7/8 Home users should upgrade to Win10 must be &quot;Hell, no. If you upgrade, pray everytime you need to shutdown you don&#39;t get new updates, and pray everytime you need to update it won&#39;t break your computer, all because you won&#39;t be able to do anything to it.&quot;</p>
<p>Go figure.</p>
<p>Note: This is the advice I&#39;m given to anyone asking me this question up to now, and I don&#39;t plan to change it unless Microsoft changed the decision to allow Home edition to have these option again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1202001">
				<div id="div-comment-1202001" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1202001">
			September 23, 2015 at 7:12 pm</a>		</div>

		<p>s/given/giving/</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1201961">
				<div id="div-comment-1201961" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201961">
			September 24, 2015 at 1:45 am</a>		</div>

		<p>@David:</p>
<p>&gt; On a pro version of Windows not joined to a domain you have control. &nbsp;On Windows 10: Settings -&gt; Windows Update &#8211; Advanced options -&gt; Choose how updates are installed. &nbsp;Select &quot;Notify to schedule restart&quot;. If you didn&#39;t change the settings to something that suits you that&#39;s on you not Microsoft.</p>
<p>I set that, and came the next morning with the computer having rebooted and lost about 12 hours of work. The notification only works if you happen to be using the computer the moment it appears &#8211; and it only appears for about 30 seconds. If you were on a break while it appeared, you won&#39;t get any further notice, unless you go to Settings -&gt; Updates and check there. According to you, that&#39;s what I should be doing every time I return to the computer after being away for more than a few seconds.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 odd alt thread-odd thread-alt depth-1" id="comment-1201941">
				<div id="div-comment-1201941" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201941">
			September 24, 2015 at 4:57 am</a>		</div>

		<p>&gt;&gt;I set that, and came the next morning with the computer having rebooted and lost about 12 hours of work</p>
<p>Let&#39;s imagine that you are given the option to suspend rebooting indefinitely. &nbsp;How much work do you lose if the power goes out? &nbsp;I&#39;m willing to bet you don&#39;t have a backup generator. &nbsp;Most UPS only give you enough run time to allow a clean shut-down. &nbsp;This long-running process you have created should be robust to interruption and able to restart where it left off. &nbsp;Again, that&#39;s on you, not Microsoft. &nbsp;</p>
<p>&gt;&gt;According to you, that&#39;s what I should be doing every time I return to the computer after being away for more than a few seconds.</p>
<p>If 12 hours worth of work was at risk, I would definitely check that, probably twice, before I left for the night. </p>
<p>&gt;&gt;how could you justify buying an OS that doubles the price when all the function&#39;</p>
<p>Easily. &nbsp;How much does not having that function cost you over time?</p>
<p> &nbsp;if(additionalWindowsCost &lt; costOfLostWorkEtc) {goodInvestment = true;}</p>
<p>&gt;&gt;and pray everytime you need to update it won&#39;t break your computer</p>
<p>If updates are needed, your computer is already broken. &nbsp;It might be broken in a way that allows the Bad Guys to take everything you have. You&#39;re going to have to do it at some point. &nbsp;You seem to be asking for a zero-risk maintenance cycle. &nbsp;That does not and cannot exist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1201861">
				<div id="div-comment-1201861" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201861">
			September 24, 2015 at 10:39 am</a>		</div>

		<p>@David Totzke:</p>
<p>&gt; If updates are needed, your computer is already broken. (&#8230;) You seem to be asking for a zero-risk maintenance cycle. &nbsp;That does not and cannot exist.</p>
<p>We disagree on both arguments.</p>
<p>We&#39;re asking for the operating system to hold until WE tell it&#39;s OK to install updates. &nbsp;It&#39;s different from never installing updates, but hey, even that should be supported e.g. in the name of having a reliable historical physical device (not VM) to test something.</p>
<p>Then, 12 hours of work are not necessarily document-wise. &nbsp;It might have to do with e.g. debugging a distributed system with multiple solutions and having the stars aligned to replicate a bug. &nbsp;Sometimes, you just can&#39;t recover easily from this, so although you might not take 12 hours setting up everything the next time, the now-gone 12 hours are otherwise wasted. &nbsp;And good luck setting up the environment and everything just like it was, even if you documented every step throughout.</p>
<p>As for the Home edition, it&#39;s just the most used edition. &nbsp;I agree it should install updates by default (and I think it has been so since Vista), but it should not restart without explicit permission (new in Windows 10). &nbsp;And it&#39;s not like Home edition users deserve less, for instance, many are computer science students or developers in a &quot;domainless&quot; company with a cheap laptop.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1201631">
				<div id="div-comment-1201631" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201631">
			September 26, 2015 at 4:11 pm</a>		</div>

		<p>As I just discovered, even Windows 10 Pro will reboot without the user&#39;s permission, even when set to &quot;notify and schedule restart&quot;. &nbsp;I wonder if it even respects the group policy settings? &nbsp;That could really be a deal-breaker at my workplace. &nbsp;We can&#39;t have people randomly losing work like that.</p>
<p>(I swear it also didn&#39;t notify me that updates were available until I looked at the control panel. &nbsp;They&#39;ve been out for a couple of weeks, right? &nbsp;I should have gotten them before now.)</p>
<p>&gt; How much work do you lose if the power goes out?</p>
<p>Not the same thing. &nbsp;Power cuts occur rarely and are an unavoidable risk. &nbsp;Using an operating system that *deliberately* loses your work once or twice a month is neither.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcohn even thread-even depth-1" id="comment-1201621">
				<div id="div-comment-1201621" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201621">
			September 26, 2015 at 9:33 pm</a>		</div>

		<p>Maybe I am missing something, but anybody can disable Windows Update by crafting an /etc/hosts file. This may be cheaper than upgrading from Home edition to perform all-night calculation or work with 3G internet. Actually, there are quite a few more hosts yours truly would consider to set &#39;0.0.0.0&#39; when internet downloads are expensive.</p>
<p>Disclaimer: it would be wise to restore the windowsupdate entries and reboot as soon as possible, because, you know, not installing some update may be even worse for you and your computer than having it reboot at wrong moment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1201591">
				<div id="div-comment-1201591" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201591">
			September 27, 2015 at 4:10 pm</a>		</div>

		<p>@Alex:</p>
<p>Stopping service should be easier and still work. (I know it will stop download)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1201561">
				<div id="div-comment-1201561" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20150921-00/?p=91551#comment-1201561">
			September 28, 2015 at 1:08 am</a>		</div>

		<p>@David:</p>
<p>&gt; I&#39;m willing to bet you don&#39;t have a backup generator. &nbsp;Most UPS only give you enough run time to allow a clean shut-down.</p>
<p>I&#39;ve got an UPS, and while the building (to my knowledge) doesn&#39;t have a backup generator, the UPS hasn&#39;t actually logged a power cut in 3 years I&#39;ve had it (with the exception of the yearly scheduled maintenance, which is always announced a month before, and which is the only time I shut down my machine). Oh, and the UPS lets my machine run for 45 minutes.</p>
<p>&gt; Again, that&#39;s on you, not Microsoft. &nbsp;</p>
<p>This is on Microsoft, not me &#8211; not only has the behaviour changed from previous Windows versions, but the settings also lie by making you think you can avoid unexpected reboots, when that only happens in very rare circumstances.</p>
<p>@Harry Johnston:</p>
<p>&gt; I wonder if it even respects the group policy settings?</p>
<p>Luckily, it does, but I only discovered I need that after it already rebooted on me.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

