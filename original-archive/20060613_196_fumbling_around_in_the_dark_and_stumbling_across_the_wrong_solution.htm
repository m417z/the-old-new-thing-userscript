<html>
<head>
<title>Fumbling around in the dark and stumbling across the wrong solution</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Fumbling around in the dark and stumbling across the wrong solution</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 13, 2006 / year-entry #197</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>68</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">I don't mean to pick on this series of entries, but it illustrates an interesting pattern of stumbling across the wrong "solution". The series begins by attempting to trigger the system's monitor blank timeout by posting a message to the desktop window. As we saw earlier, the desktop window is a very special window and...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
I don't mean to pick on this series of entries,
but it illustrates an interesting pattern of
stumbling across the wrong "solution". 
</p>
<p>
<a HREF="http://dotnetjunkies.com/WebLog/victorv/archive/2004/09/13/25380.aspx ">
The series begins</a>
by attempting to trigger the system's monitor blank timeout
by posting a message to the desktop window.
As we saw earlier,
<a HREF="http://blogs.msdn.com/oldnewthing/archive/2004/02/24/79212.aspx">
the desktop window is a very special window</a>
and as a rule
should be avoided, since it won't behave like windows created
by applications.
In particular, the author tried to post a message to the desktop
window.
This used to work in the
<a HREF="http://blogs.msdn.com/oldnewthing/archive/2005/10/21/483438.aspx">
historically open world of the window manager</a>,
but security and robustness concerns have come to take
priority over compatibility.
In Windows&nbsp;XP&nbsp;SP2, the desktop window resists being disabled
because programs were doing it inadvertently,
and
it appears that the desktop also resists having messages posted to it.
My guess is that this was done as a way to strengthen protection against
shatter attacks.
This did improve robustness and stability,
but
<a HREF="http://dotnetjunkies.com/WebLog/victorv/archive/2004/09/13/25386.aspx">
it also broke the article's dubious <code>PostMessage</code> hack</a>.
</p>
<p>
<a HREF="http://dotnetjunkies.com/WebLog/victorv/archive/2004/09/13/25394.aspx ">
Enter round three</a>,
wherein the author fumbled around for other windows the
monitor blank timeout message could be posted to,
and eventually
the author found that
posting the message to the mysterious window
<nobr><code>HWND_TOPMOST = -1</code></nobr>
seemed to do the trick.
</p>
<p>
I knew in the back of my mind that people developed software
this way, but the hopeful part of my brain continued to wish
that it was merely taking place in a fantasy world.
Making up intentionally invalid parameters
and seeing what happens falls into the
category of malicious goofing around,
not in the realm of software engineering and design.
Even if you find something that seems to work,
you certainly wouldn't design a product around it!
</p>
<p>
(Similarly, I've seen people ask questions like
"What does message 49251 mean?"
This is the reverse case: Seeing a made-up number and
attempting to assign meaning to it.
Message numbers starting at <code>0xC000</code>
(decimal 49152) are messages registered via
<code>RegisterWindowMessage</code>.
The numerical value of the message associated with a
registered window message is unpredictable and varies
from desktop to desktop.
The only guarantee is that it will remain consistent
within a single desktop.)
</p>
<p>
If you look more carefully at what the author stumbled
across, you'll see that the "solution" is actually another bug.
It so happens that the numerical value
<nobr><code>-1</code></nobr>
for
a window handle is suspiciously close to the value of
<code>HWND_BROADCAST</code>:
</p>
<pre>
#define HWND_BROADCAST  ((HWND)0xffff)
</pre>
<p>
It so happens that internally, the window manager
supports
<nobr><code>(HWND)-1</code></nobr>
as an alternative value
for <code>HWND_BROADCAST</code>.
(I leave you to speculate why.)
As a result, what the author actually is doing is broadcasting
the monitor power-off message to all top-level windows!
As we saw before, broadcasting messages is a very dangerous
business, and in this case,
the author is just lucky that all the windows on the desktop
interpret the message the same way, that it is safe to
process the message multiple times,
and none of the windows
perform any special filtering for that message.
(Another author
<a HREF="http://www.codeproject.com/system/display_states.asp">
stumbled across the same incorrect "solution"</a>
but didn't provide any insight into the process by which the
result was arrived at.
<a HREF="http://www.codeproject.com/useritems/Monitor_management_guide.asp">
Yet another author sort of found some issues but didn't quite put them
all together</a>.)
</p>
<p>
For example, a presentation program might want to suppress
monitor power-off when it is the foreground window by
trapping the message and turning the monitor back on.
If such a program happens to be running,
broadcasting the power-off message to all top-level windows
would turn off the monitor for all the windows that
deferred to system default behavior, but when that presentation
program received the message, it would turn the monitor back on.
Now you're at the mercy of the order in which the windows process
that broadcast message.
When the presentation program processes the message,
the monitor will turn back on,
and if that program happens to be the last one to process
the message (say, it got paged out and was slow to page back in),
then the monitor will merely blink off and back on.
</p>
<p>
The correct solution is not to post messages to random windows.
If you want the message to go through window message
default processing, create a window and process it yourself.
Don't try to trick some other window (or in this case,
hundreds of other windows simultaneously) into doing it for you.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (68)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-aaron-margosis even thread-even depth-1" id="comment-390563">
				<div id="div-comment-390563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390563">
			June 13, 2006 at 10:25 am</a>		</div>

		<p>Re HWND_TOPMOST vs. HWND_BROADCAST issue&#8230; I searched MSDN for HWND_TOPMOST and found a handful of items where it&#8217;s described as a valid (or even required) target to send/post messages to:</p>
<p>About Messages and Message Queues<br />
<br /><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/messagesandmessagequeues/aboutmessagesandmessagequeues.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/messagesandmessagequeues/aboutmessagesandmessagequeues.asp</a><br />
<br />&quot;If the window handle is HWND_TOPMOST, DispatchMessage sends the message to the window procedures of all top-level windows in the system.&quot;</p>
<p>Using Messages and Message Queues<br />
<br /><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/messagesandmessagequeues/usingmessagesandmessagequeues.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/windowing/messagesandmessagequeues/usingmessagesandmessagequeues.asp</a><br />
<br />&quot;If the handle is HWND_TOPMOST, the system posts the message to the thread message queues of all top-level windows.&quot;</p>
<p>WM_TIMECHANGE<br />
<br /><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/en-us/sysinfo/base/wm_timechange.asp" rel="nofollow">http://msdn.microsoft.com/library/en-us/sysinfo/base/wm_timechange.asp</a><br />
<br />&quot;Windows Me/98/95: &nbsp;An application should send this message to all top-level windows after changing the system time using the SendMessageTimeout function with HWND_TOPMOST. Do not send this message by calling SendMessage with HWND_BROADCAST.&quot;</p>
<p>I only ever used it with SetWindowPos to make a window topmost&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390573">
				<div id="div-comment-390573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.uesp.net' rel='external nofollow' class='url'>Dave</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390573">
			June 13, 2006 at 10:33 am</a>		</div>

		<p>Don&#8217;t leave us hanging&#8230;what is the correct method of powering down the monitor? A quick search on MSDN reveals &#8216;SetActivePwrScheme&#8217; as a good start anyways.</p>
<p>Another dangerous habit I noticed looking at the examples is misusing special parameters such as HWND_BROADCAST and HWND_TOPMOST. These values are only valid in certain functions, PostMessage/SendMessage and SetWindowPos in this case. You cannot expect any function that takes an HWND to properly handle these values. It seems obvious but its one of those mistakes I made when starting Windows programming.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390583">
				<div id="div-comment-390583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Margaret Bowmall</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390583">
			June 13, 2006 at 10:38 am</a>		</div>

		<p>So, what is the correct way of turning off the monitor?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390603">
				<div id="div-comment-390603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390603">
			June 13, 2006 at 10:47 am</a>		</div>

		<p>Ok now I think I may have badly interpreted your last paragraph, and that sending a message is not the correct solution! (And I am reassured!)<br />
<br />Still, why does the posted solution work? Is it because of the defwndproc or is a window intercepting the notification and doing the correct API call? (That would still leave me wondering why)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390623">
				<div id="div-comment-390623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390623">
			June 13, 2006 at 10:54 am</a>		</div>

		<p>Your article started by saying the user was trying to &#8220;trigger the<br />
system&#8217;s monitor blank timeout&#8221;. &nbsp;He said he was trying to power<br />
off the monitor. &nbsp;Are those the same things?</p>
<div CLASS=post>[<i>Picky, picky. If you trigger the monitor blank timeout, then the monitor turns off. Do you also nitpick the difference between &#8220;Triggering the screen saver timeout&#8221; and &#8220;starting the screen saver&#8221;? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390643">
				<div id="div-comment-390643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan McCarty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390643">
			June 13, 2006 at 10:57 am</a>		</div>

		<p>&quot;Making up intentionally invalid parameters and seeing what happens falls into the category of malicious goofing around, not in the realm of software engineering and design.&quot;</p>
<p>Some would describe it as hacking, which isn&#8217;t always malicious, or goofing around. &nbsp;We owe a good many of the world&#8217;s inventions to people who were just &quot;seeing what happens.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390663">
				<div id="div-comment-390663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390663">
			June 13, 2006 at 11:04 am</a>		</div>

		<p>The correct way is to make your own window and once it&#8217;s up and running to SendMessage or PostMessage to it. If your window procedure is correctly written, the messages which are not handled by your code will be handled by the system, and that&#8217;s what you want.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390673">
				<div id="div-comment-390673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.uesp.net' rel='external nofollow' class='url'>Dave</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390673">
			June 13, 2006 at 11:08 am</a>		</div>

		<p>From the MSDN articles Aaron dug up I see there&#8217;s even a little internal confusion between HWND_TOPMOST and HWND_BROADCAST. Perhaps this is partly the reason why the window manager accepts an alternate value of -1 for HWND_BROADCAST.</p>
<p>Another thing I&#8217;m wondering about, hasn&#8217;t HWND always been an unsigned value? If so, isn&#8217;t</p>
<p>#define HWND_TOPMOST &nbsp; &nbsp;((HWND)-1)</p>
<p>a bad idea?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390713">
				<div id="div-comment-390713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390713">
			June 13, 2006 at 11:41 am</a>		</div>

		<p>If Windows was open source we wouldn&#8217;t have to &#8220;fumble around in the<br />
dark&#8221;. &nbsp;Us poor non-Microsoft developers often have to reverse<br />
engineer Windows to get our job done; please don&#8217;t demean us because of<br />
it. &nbsp;We don&#8217;t really want to use Windows &#8212; its just forced on us<br />
by the marketplace.</p>
<div CLASS=post>[<i>I would argue the reverse. With the source code, people would be <u>more likely</u> to break the rules, because they can see which rules they can get away with breaking. &#8220;Oh, sure it&#8217;s documented as &#8216;must be zero&#8217;, but I can pass garbage since I checked the source code and nobody uses it.&#8221; Yeah, nobody uses it <u>yet</u>. And then Vista starts using the parameter and you crash. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390723">
				<div id="div-comment-390723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Steve Loughran</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390723">
			June 13, 2006 at 11:49 am</a>		</div>

		<p>I&#8217;m going to be ruthless and defend the developers actions. Power management in windows is pretty minimally documented except in the driver pages, and support in .NET is particularly sparse. And of course, there is no source code for all of us to look at.</p>
<p>Raymond: you have the advantages of (a) the source and (b) the ability to email someone who will know someone who knows the answer. The rest of us have to make do with experiments. Just be glad this isnt shipping software that you have to support in future.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390763">
				<div id="div-comment-390763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nektar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390763">
			June 13, 2006 at 12:26 pm</a>		</div>

		<p>Please tell us:<br />
<br />1. How to power off the monitor in the right way and<br />
<br />2. How to prevent the monitor from turning off, if you are writing eg. a presentation program.<br />
<br />Are these two things even possible?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390803">
				<div id="div-comment-390803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">STATIC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390803">
			June 13, 2006 at 1:06 pm</a>		</div>

		<p>So, is the correct method to power-off a monitor to:</p>
<p>hwnd = CreateWindow(WC_MYCLASS, WS_POPUP..);<br />
<br />PostMessage(hwnd, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_OFF);<br />
<br />[pump messages]</p>
<p>Where WC_MYCLASS has a WndProc like:</p>
<p>LRESULT MyWndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)<br />
<br />{<br />
<br /> &nbsp;// TODO: Close after processing?<br />
<br /> &nbsp;if (message == WM_DESTROY) PostQuitMessage(0);<br />
<br /> &nbsp;return DefWindowProc(hWnd, message, wParam, lParam);<br />
<br />}</p>
<p>As an aside, is there a built-in Windows class that has a virtually-empty procedure body, save calling DefWindowProc and handles WM_DESTROY by calling PostQuitMessage? Or, is it easier to create a top-level hidden STATIC window (or something similiar) to perform that processing?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390853">
				<div id="div-comment-390853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.uesp.net' rel='external nofollow' class='url'>Dave</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390853">
			June 13, 2006 at 1:34 pm</a>		</div>

		<p>Huh, I didn&#8217;t think it would work but indeed posting a SC_MONITORPOWER message to an existing window does in fact turn the monitor off. For example, from a MFC application: </p>
<p>::PostMessage(SomeCWnd.m_hWnd, WM_SYSCOMMAND, SC_MONITORPOWER, 2); </p>
<p>I&#8217;m still wondering how you&#8217;d do it if you don&#8217;t have a window handle, such as a console application, without creating a temporary window. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390863">
				<div id="div-comment-390863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wang-Lo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390863">
			June 13, 2006 at 1:35 pm</a>		</div>

		<p>&#8220;With the source code, people would be more likely to break the rules, because they can see which rules they can get away with breaking.&#8221; &#8211;Raymond </p>
<p>If I have neither the source code nor reliable documentation, I can only find (by experiment) what works right now. &nbsp;I can&#8217;t even determine if I am really breaking any rules. &nbsp;With either source code access or correct documentation, I can discover the correct thing to do, and then decide whether to take chances. </p>
<p>I posit that I am much more likely to track changes in released source code or in reliable documentation than I am to repeat my entire series of experiments whenever I suspect that something may have changed. </p>
<p>-Wang-Lo. </p>
<div CLASS=post>[<i>How does having the source code tell you what the rules are? The source code tells you what something does, not how something was meant to be used. There&#8217;s nothing in the source code to a wrench that says &#8220;Do not use to hammer nails.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390873">
				<div id="div-comment-390873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.winstep.net' rel='external nofollow' class='url'>Jorge Coelho</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390873">
			June 13, 2006 at 1:40 pm</a>		</div>

		<p>Exactly! To power off the monitor you just </p>
<p>SendMessage(MyhWnd, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_OFF)</p>
<p>where MyhWnd is the handle to a window you created yourself. The message is then passed to DefWindowProc which does the dirty deed for you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis odd alt thread-odd thread-alt depth-1" id="comment-390883">
				<div id="div-comment-390883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390883">
			June 13, 2006 at 2:10 pm</a>		</div>

		<p>To put Raymond&#8217;s comments re open source another way &#8211; having the source code will make developers MORE likely to rely on the side effects of internal implementation details than they already do. &nbsp;That&#8217;s fine as long as the internal implementation details NEVER change, but that is rarely true of any product that lives beyond version 1.0. &nbsp;Believe me, I feel your pain &#8211; I live with it too. &nbsp;But open source is the wrong medicine for that pain.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390943">
				<div id="div-comment-390943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390943">
			June 13, 2006 at 4:04 pm</a>		</div>

		<p>Well, yes and no. &nbsp;They&#8217;re rhetorical in that the answer is obvious. &nbsp;They&#8217;re not rhetorical in that they still deserve an answer.</p>
<p>MSDNWiki covers &quot;Visual Studio 2005 and .NET Framework 2.0.&quot; &nbsp;Yes, .NET is great and all, but an awfully large percentage of software isn&#8217;t written in it, and an awfully large percentage of software probably never will be. &nbsp;You&#8217;re not going to see any drop in questions about Win32 until you have the documentation about it posted there and available for edit and discussion.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-390973">
				<div id="div-comment-390973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390973">
			June 13, 2006 at 4:16 pm</a>		</div>

		<p>Sean, your claim was that a Wiki would generate correct and complete documentation. </p>
<p>Raymond&#8217;s effectively using the VS 2005 and CLR V2 Wiki as a test harness. &nbsp;If, after 6 months the CLR V2 Wiki has better documentation than MSDN, clearly you were right. &nbsp;If, on the other hand, it doesn&#8217;t, then a wiki isn&#8217;t the right solution. </p>
<div CLASS=post>[<i>Telling me that won&#8217;t accomplish anything. Why not tell the MSDN Wiki team? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390983">
				<div id="div-comment-390983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geocities.com/mvaneerde' rel='external nofollow' class='url'>Maurits</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390983">
			June 13, 2006 at 4:41 pm</a>		</div>

		<p>I must disagree with your (Raymond&#8217;s) argument that open source APIs are more prone to misuse. &nbsp;Your argument boils down to &#8220;people can see the guts of the thing, so they&#8217;re more likely to rely on implementation choices; when the implementation changes, their app will be broken.&#8221; </p>
<p>APIs are contracts; the API promises to provide such-and-such functionality if called in such-and-such fashion. </p>
<p>If the correct calling procedure is documented in an easy-to-find way, there is no excuse for the developer to break the contract by calling it in a way other-than-specified. </p>
<p>So much is true of both open and closed source software. </p>
<p>The problem is that documentation tends to quickly fall out of sync. </p>
<p>Open source has the advantage that the contract can be specified right in the code. &nbsp;This obviates (to a certain extent) the need to consult and maintain outside documentation. </p>
<p>So open source has the advantage when it comes to maintaining and exploring APIs (for any given development team.)</p>
<div CLASS=post>[<i>So if you got the source code to hundreds of undocumented APIs, that would <u>discourage</u> you from calling them? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390993">
				<div id="div-comment-390993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Billy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390993">
			June 13, 2006 at 4:43 pm</a>		</div>

		<p>So Raymond, who pissed in your cornflakes today? &nbsp;Seriously, either the documentation needs to be improved or you should stop bitching about how we try to call the under documented items. &nbsp;Actually noting how to call the function (or answering any of the 4 or 5 comments asking may have helped as well).</p>
<div CLASS=post>[<i>Even if the documentation is bad, does that justify basing a solution on passing intentionally invalid parameters? Is it justifiable to break the law because you can&#8217;t find any legal alternative to what you&#8217;re trying to do? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391003">
				<div id="div-comment-391003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geocities.com/mvaneerde/' rel='external nofollow' class='url'>Maurits</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391003">
			June 13, 2006 at 4:55 pm</a>		</div>

		<blockquote><p>
  if you got the source code to hundreds of undocumented APIs, that would discourage you from calling them </p>
<p>I want to underline too&#8230; :'( </p>
<p>Well, it&#8217;s your blog :) </p>
<p>Anyway&#8230; why are they undocumented? </p>
<p>Quality of documentation is important. &nbsp;&#8220;No documentation&#8221; is just another form of bad documentation. </p>
<p>&#8220;Legacy &#8211; do not use in new code&#8221; is perfectly acceptable documentation.</p>
<div CLASS=post>[<i>&#8220;Implementation detail &#8211; not part of the interface contract; may change at any time.&#8221; -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391033">
				<div id="div-comment-391033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geocities.com/mvaneerde/' rel='external nofollow' class='url'>Maurits</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391033">
			June 13, 2006 at 5:11 pm</a>		</div>

		<blockquote><p>
  &#8220;Implementation detail &#8211; not part of the interface contract; may change at any time.&#8221; </p>
<p>Yeah, like that. </p>
<p>Or to avoid developer fatigue, something like: </p>
<p>&#8220;All these APIs are subject to change except the ones marked OK TO USE&#8221; </p>
<p>TMTOWTDI</p>
<div CLASS=post>[<i>So you&#8217;re saying there should be a section in MSDN called, &#8220;Undocumented functionality&#8221; that reads, &#8220;Functions, structures, flags, etc. not documented here are reserved for the implementation and are not part of the interface contract. They are subject to change at any time and are not supported&#8221;? I can ask them to write up that one-paragraph documentation section if it&#8217;ll make you happy. -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391043">
				<div id="div-comment-391043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">FF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391043">
			June 13, 2006 at 5:24 pm</a>		</div>

		<p><a href="http://msdnwiki.microsoft.com/" target=_new rel=nofollow rel="nofollow">http://msdnwiki.microsoft.com/</a> &#8211;&gt; <br />&#8220;We are not able to support editing in Firefox for this release. Check back soon for an updated release that will provide better Firefox support.&#8221; <br />Will this be fixed in 6 month?</p>
<div CLASS=post>[<i>Why are you asking me? I have nothing to do with the MSDN Wiki. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391053">
				<div id="div-comment-391053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://smokinn.tengun.net' rel='external nofollow' class='url'>Guillaume Theoret</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391053">
			June 13, 2006 at 5:37 pm</a>		</div>

		<p>I would&#8217;ve thought that by now people would&#8217;ve stopped requesting &quot;the right way&quot; to stop the monitor from turning off.</p>
<p>The &quot;right way&quot; is to get the user to go into his power settings and choose presentation mode or always on or something to that effect.</p>
<p>To understand why he&#8217;s responded to a few other posts and not to the ones requesting this information, perhaps you should read this: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2005/06/07/426294.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2005/06/07/426294.aspx</a></p>
<p>which is his post entitled &quot;What if two programs did this?&quot; and think about what would happen if one program tried to turn the monitor off while another tried to keep it on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390593">
				<div id="div-comment-390593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390593">
			June 13, 2006 at 10:42 am</a>		</div>

		<p>Hmm&#8230; Raymond, do you mean that in order to put the monitor into blank timeout, one has to post a message to ITS window?<br />
<br />How is that logical?<br />
<br />And besides, I hope the message in question is not the one tried in the linked blog, because he is sending (WM_SYSCOMMAND, SC_MONITORPOWER), which is described as a notification (<a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardaccelerators/keyboardacceleratorreference/keyboardacceleratormessages/wm_syscommand.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardaccelerators/keyboardacceleratorreference/keyboardacceleratormessages/wm_syscommand.asp</a>)<br />
<br />and not as being able to result as an order to the &#8216;system&#8217;! I am not a GUI programmer, so maybe I don&#8217;t understand the windowing &quot;model&quot;, but I would expect that this &nbsp;WM_SYSCOMMAND notification only have an impact on the defwndproc for the maximize&amp;co notifications, the monitor&amp;screensavers being simple &quot;notifications&quot; on which the window/app shall not have any influence (other than saying &quot;hey i&#8217;m using the display, please don&#8217;t do that&quot;) and certainly I wouldn&#8217;t expect *my* defwndproc to handle the screensaver start by itself.<br />
<br />I can see why many people thought that the desktop window was &quot;responsible&quot; for the screensaver and monitor shutdown, but granted they should have checked in the doc! :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390633">
				<div id="div-comment-390633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390633">
			June 13, 2006 at 10:56 am</a>		</div>

		<p>I have often wanted my 2 monitors (on separate computers) to come *out* of power-save mode (power off mode?) at about 8:00 AM each weekday, just before I arrive at work.</p>
<p>Not crucial in the scheme of things, but one can always hope&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390653">
				<div id="div-comment-390653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390653">
			June 13, 2006 at 10:58 am</a>		</div>

		<p>How man!<br />
<br />My previous MSDN link says (in the remarks) that the defwndproc, when passed the WM_SYSCOMMAND, *does* the action corresponding to the notification. Well as I said before, I can understand for the maximize, close &amp; co but not for the screensaver &amp; monitor power&#8230;<br />
<br />This GUI stuff is confusing for me&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391073">
				<div id="div-comment-391073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geocities.com/mvaneerde/' rel='external nofollow' class='url'>Maurits</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391073">
			June 13, 2006 at 6:05 pm</a>		</div>

		<blockquote><p>
  Functions, structures, flags, etc. not documented here are reserved for the implementation and are not part of the interface contract </p>
<p>I think that&#8217;s implicit&#8230; not necessary to make another section. </p>
<p>&gt; what would happen if one program tried to turn the monitor off while another tried to keep it on </p>
<p>Irresistible force vs. immovable object :)</p>
<div CLASS=post>[<i>Now I&#8217;m confused. First you said that some documentation to the effect of &#8220;Implementation detail, subject to change&#8221; is needed, now you say it&#8217;s implicit&#8230; -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391093">
				<div id="div-comment-391093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nawak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391093">
			June 13, 2006 at 6:34 pm</a>		</div>

		<p>Guillaume: so the right way to put the monitor in standby is to pop a message box asking the user to make it &#8216;always-on&#8217;? ;-)<br />
<br />Maybe you meant &quot;pop-up a message box to ask the user to shut down his monitor&quot; ;)<br />
<br />The &quot;what if two programs did this&quot; doesn&#8217;t apply here, what if two programs wanted to shut down the monitor? Hmm I don&#8217;t know&#8230; maybe&#8230; shut down the monitor!!<br />
<br />Anyway, I guess the correct solution is the defwndproc one. Still, I don&#8217;t understand what is the idea behind it&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391103">
				<div id="div-comment-391103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391103">
			June 13, 2006 at 7:05 pm</a>		</div>

		<p>Guillaume:</p>
<p>So you&#8217;re seriously saying that the user should toggle the power settings himself every time he wants to watch a DVD? Blech.</p>
<p>Nektar:</p>
<p>Add a handler for WM_SYSCOMMAND. If wParam is SC_MONITORPOWER and lParam is 1 or 2, return 0. All other wParam and lParam values, if not already handled by your code, should be forwarded to DefWindowProc. A similar approach exists for SC_SCREENSAVE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391123">
				<div id="div-comment-391123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Wilson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391123">
			June 13, 2006 at 7:58 pm</a>		</div>

		<p>To turn the power off, I have used this <br />#include &#8220;stdafx.h&#8221; <br />#include &lt;windows.h&gt; </p>
<p>int _tmain(int argc, _TCHAR* argv[]) <br />{ <br />SendMessage(GetForegroundWindow(),WM_SYSCOMMAND, SC_MONITORPOWER, 1); <br />return 0; <br />} </p>
<p>and it seems to work. <br />Of course, that doesnt account for if there is a foreground window that actually processes SC_MONITORPOWER instead of passing it to DefWindowProc. </p>
<div CLASS=post>[<i>And it assumes that there is a foreground window at all and that you have permission to send a message to it. Just create your own window already. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391133">
				<div id="div-comment-391133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Billy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391133">
			June 13, 2006 at 8:09 pm</a>		</div>

		<blockquote><p>
  &gt;Even if the documentation is bad, does that justify basing a solution on passing intentionally invalid parameters? Is it justifiable to break the law because you can&#8217;t find any legal alternative to what you&#8217;re trying to do? -Raymond &lt;&lt; </p>
<p>I don&#8217;t know, ask Rosa Parks. &nbsp;Breaking bad laws is one of the cornerstones of civil disobedience&#8230;</p>
<div CLASS=post>[<i>So passing intentionally invalid parameters is a form of civil disobedience. Remember that another cornerstone of civil disobedience is the expectation of being arrested. Do you expect Windows to block your program when you do these things? -Raymond</i>]</div>
</blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391143">
				<div id="div-comment-391143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jolyon Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391143">
			June 13, 2006 at 8:18 pm</a>		</div>

		<p>Monitor Blank vs Power Off </p>
<p>At first I was thinking along the lines of the vertical blank on CRT devices &#8211; which iirc was the period of time it took for the CRT guns to reset from the end of the final line on the display to the beginning of the first line. </p>
<p>Terminology exists for a reason &#8211; mixing up terms, even if the context seems to make it obvious what is meant. &nbsp;In this case I can&#8217;t even see a reason for having changed the terminology at all. </p>
<p>The &#8220;screensaver defense&#8221; is a little disingenuous. </p>
<p>Screensaver = screensaver = screensaver. </p>
<p>But blanking the monitor doesn&#8217;t necessarily involve turning it off, and the term &#8220;blank&#8221; has other, very precise meanings for display devices. </p>
<p>Also I find it a little odd to criticise a consumer of an API for naively making a call that the API itself seems to be mis-interpreting &#8211; for whatever reason &#8211; and then lambasting the consumer code for the API&#8217;s idiosynchracies. </p>
<p>This blog is usually interesting, often informative, but every now and again it seems to miss the point a little. </p>
<p>Had the tone of the piece been different it wound&#8217;t have mattered, but it seemed to be just a little condescending and critical, rather than a factual critique of an innocent mistake. </p>
<p>&lt;shrug&gt; </p>
<p>Keep it up though. </p>
<p>:) </p>
<div CLASS=post>[<i>So much for blogs being an informal means of communication. Do I need to hire an editor now? My point was &#8220;I can&#8217;t believe people actually develop software this way &#8211; randomly doing stuff to see what happens instead of thinking about what they are actually doing.&#8221; But from the feedback it appears that it&#8217;s unfair of me to suggest that people try to understand what they&#8217;re doing. So go ahead, pass random parameters. We&#8217;ll make more. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391183">
				<div id="div-comment-391183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391183">
			June 13, 2006 at 9:06 pm</a>		</div>

		<p>Is it justifiable to break the law because you can&#8217;t find any legal alternative to what you&#8217;re trying to do? -Raymond</p>
<p>Yes, depending on what you want to do. Of course, that&#8217;s a philosophy debate.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390913">
				<div id="div-comment-390913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390913">
			June 13, 2006 at 2:52 pm</a>		</div>

		<p>So if open source is the wrong medicine for the pain of underdocumentation, then what is the right medicine &#8212; given that the average developer cannot contact people inside Microsoft to ask them either (A) how it&#8217;s supposed to work or (B) to fix the documentation? </p>
<p>Microsoft, for years, has had a very opaque corporate structure to the outside world; I&#8217;ll place bets the majority of readers of this blog (myself included) don&#8217;t even know which team *Raymond* is on, much less how to contact members of the right team. &nbsp;That dearth of information has started to change over the last few years, but the net effect is that Microsoft has gone from an opaque wall to an opaque wall with a few pinholes of knowledge poked through it &#8212; far from transparent. </p>
<p>Here&#8217;s a proposal: &nbsp;Convert a large portion of the Windows API documentation over to a Wiki, so that anybody can post, comment, and edit, with a suitable history log and rollbacks in case of abuse. &nbsp;My guess is that less than six months after converting it, the complaints about the confusing parts of the API would vanish almost entirely. &nbsp;Of course, this would mean embracing open communication, and I get the feeling there are a lot of folks inside Microsoft who really don&#8217;t want to do that.</p>
<div CLASS=post>[<i>You mean <a HREF="http://msdnwiki.microsoft.com/" rel="nofollow">like this</a>? We&#8217;ll see if your six month prediction comes true. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391223">
				<div id="div-comment-391223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">paul2</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391223">
			June 13, 2006 at 10:19 pm</a>		</div>

		<p>So you&#8217;re seriously saying that the user should toggle the power settings himself every time he wants to watch a DVD? Blech. &nbsp;&#8211; Bob</p>
<p>Any program that went and automatically changed the power scheme or monitor setting goes straight into the recycle bin on my machine. Keep your filthy mits off my personal user settings!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-390933">
				<div id="div-comment-390933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-390933">
			June 13, 2006 at 3:39 pm</a>		</div>

		<p><a href="http://msdnwiki.microsoft.com/wikiedit/search.aspx?query=createwindow" target=_new rel=nofollow rel="nofollow">http://msdnwiki.microsoft.com/wikiedit/search.aspx?query=createwindow</a> </p>
<p>&gt; &nbsp;MSDN Wiki <br />&gt; <br />&gt; &nbsp; &nbsp; CreateWindow &nbsp; &nbsp;[Search] <br />&gt; <br />&gt; &nbsp;There are no search results to display. </p>
<p>Um, exactly what is this site supposed to be documenting, anyway? &nbsp;It seems a little lacking on Win32, which is where most of the Windows-related questions seem to be. &nbsp;I&#8217;d say the six months starts when the content is actually *posted* the first time around, and it sure doesn&#8217;t seem to be yet. </p>
<p>*sigh* &nbsp;Wish it didn&#8217;t take upwards of 30 seconds to load a single page there, either. &nbsp;Traceroute gets as far as a few servers on msn.net before reaching ungodly ping times. &nbsp;:-(</p>
<div CLASS=post>[<i>I&#8217;ll assume your questions were rhetorical since there&#8217;s an FAQ right on the site. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391233">
				<div id="div-comment-391233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391233">
			June 13, 2006 at 10:58 pm</a>		</div>

		<p>Win32 API documentation is poor. Until the documentation is as good as<br />
i want it to be, my life would be easier if i had the source code.</p>
<p>Let&#8217;s pull out a random example, since AJAX is the new cool thing: IXMLHttpRequest.Send()</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/52aaf5ff-e302-4490-821a-cb3a085fe5ee.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/52aaf5ff-e302-4490-821a-cb3a085fe5ee.asp</a></p>
<p>If i do a synchronous request, will OnReadyStateChange get called? If so, how many times?</p>
<p>i already know the answer, i&#8217;m not asking for technical support.<br />
i&#8217;m pointing out one example were the &#8220;contract&#8221; between the API<br />
writers and the developers is not fully spelled out. </p>
<p>Yes, there is a contract that we want to adhere to, but you have to tell us what the contract is.</p>
<div CLASS=post>[<i>I don&#8217;t doubt that the documentation is lacking in many places. But if you were going to fill in the gaps, would you really consider intentionally passing invalid parameters as part of the missing documentation? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391023">
				<div id="div-comment-391023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geocities.com/mvaneerde/' rel='external nofollow' class='url'>Maurits</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391023">
			June 13, 2006 at 5:02 pm</a>		</div>

		<p>&gt; Is it justifiable to break the law because you can&#8217;t find any legal alternative to what you&#8217;re trying to do?</p>
<p>It depends on:<br />
<br />* the consequences of breaking the law (why the law is there)<br />
<br />* the consequences of not being able to do what you&#8217;re trying to do<br />
<br />* how hard you tried to find a legal alternative<br />
<br />* what else is on your list of things to do</p>
<p>Finding a &quot;correct&quot; way of doing things is a halting problem&#8230; it&#8217;s hard to tell if the answer is just one more search away, or doesn&#8217;t exist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391083">
				<div id="div-comment-391083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ramblings.aaronballman.com' rel='external nofollow' class='url'>Aaron Ballman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391083">
			June 13, 2006 at 6:31 pm</a>		</div>

		<p>Dear god, (some)people! &nbsp;If it&#8217;s not documented, it&#8217;s logical to assume absolutely nothing about it. &nbsp;Doc writers will never think to write down every way to NOT use something &#8212; only the proper ways *to* use it (think about how long the documentation would be for SendMessage!) and perhaps some common mistakes. &nbsp;I&#8217;m shocked people think this is some new revelation &#8212; this is simply the way documentation has always worked for every toolkit ever made.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391113">
				<div id="div-comment-391113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.geocities.com/mvaneerde/' rel='external nofollow' class='url'>Maurits</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391113">
			June 13, 2006 at 7:07 pm</a>		</div>

		<p>&gt; First you said that some documentation to the effect of &quot;Implementation detail, subject to change&quot; is needed</p>
<p>Yes&#8230; *in the source code.* &nbsp;That comment fell under the scope of your &quot;if you got the source code to hundreds of undocumented APIs&quot; scenario.</p>
<p>To save copy/paste time, it would suffice to have a rule that &quot;everything in source code is subject to change unless it specifically says otherwise,&quot; and then just tag certain chunks of code as /* public */</p>
<p>&gt; now you say it&#8217;s implicit&#8230;</p>
<p>In a /library of external documentation/ it&#8217;s implicit.</p>
<p>*poor-man&#8217;s bold*<br />
<br />/poor-man&#8217;s italic/<br />
<br />/* just a comment */</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391153">
				<div id="div-comment-391153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.werkema.com' rel='external nofollow' class='url'>Sean W.</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391153">
			June 13, 2006 at 9:00 pm</a>		</div>

		<p>Larry says, &#8220;Raymond&#8217;s effectively using the VS 2005 and CLR V2 Wiki as a test harness. &nbsp;If, after 6 months the CLR V2 Wiki has better documentation than MSDN, clearly you were right. &nbsp;If, on the other hand, it doesn&#8217;t, then a wiki isn&#8217;t the right solution.&#8221; </p>
<p>I understand that. &nbsp;The principle behind a Wiki is that you should get the best results with the most eyeballs. &nbsp;Lots of folks are interested in .NET, sure, but not anywhere near as many as are interested in accurate documentation of Win32. &nbsp;So wouldn&#8217;t it make sense to populate the Wiki initially with the most desired information, which in this case would be the Win32 API? </p>
<p>Raymond says, &#8220;My point was &#8216;I can&#8217;t believe people actually develop software this way &#8211; randomly doing stuff to see what happens instead of thinking about what they are actually doing.&#8217; But from the feedback it appears that it&#8217;s unfair of me to suggest that people try to understand what they&#8217;re doing.&#8221; </p>
<p>Ray, I think you&#8217;re right on both counts. &nbsp;It&#8217;s pretty insane that people try to develop that way, and I doubt anybody here would disagree with that. &nbsp;To quote MST3K: &nbsp;&#8220;Randomly blowing up things is not a good battle strategy in a spaceship.&#8221; </p>
<p>But, that said, the only reason folks resort to the software equivalent of guerrila warfare is because the known documentation is either misleading, hard to find, or just plain wrong. &nbsp;It&#8217;s fair to suggest people know what they&#8217;re doing, but unfair to *require* it. &nbsp;You and I may have degrees in computer science or software engineering, but the majority of people coding for Windows don&#8217;t, so it behooves you to provide the best documentation for them that you can. &nbsp;I would think that by this point, having heard a thousand people complaining that the Win32 documentation has significant problems and almost nobody claiming it&#8217;s good the way it is, and that with thousands of people getting the API calls wrong, that you&#8217;d at least consider that maybe, just maybe, there&#8217;s a problem with it. &nbsp;This poor guy sounds to me like an exasperated programmer who tried everything he could to do it right and finally just gave up and tried anything he could think of until he found something that worked (and yes, we&#8217;ve all been at the &#8220;just work already!&#8221; stage; don&#8217;t claim you haven&#8217;t!). &nbsp;Had the docs been more precise and easier to find, he might never have resorted to the crazy solutions.</p>
<div CLASS=post>[<i>How could the SendMessage documentation have been improved to solve this problem? &#8220;When sending a message to a window, make sure it&#8217;s really a window&#8221;? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391313">
				<div id="div-comment-391313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391313">
			June 14, 2006 at 4:00 am</a>		</div>

		<p>This does suggest that perhaps a Win32 API Wiki might be appropriate. Then all these people suggesting API doc improvements could, well, improve the API docs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391323">
				<div id="div-comment-391323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391323">
			June 14, 2006 at 4:06 am</a>		</div>

		<p>Bloody hell. There IS an msdn wiki. Who knew? Not I for certain. I sense a certain .NET focus however.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391343">
				<div id="div-comment-391343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391343">
			June 14, 2006 at 4:46 am</a>		</div>

		<p>&quot;I&#8217;m still wondering how you&#8217;d do it if you don&#8217;t have a window handle, such as a console application, without creating a temporary window.&quot;</p>
<p>Lookup GetConsoleWindow()</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391353">
				<div id="div-comment-391353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391353">
			June 14, 2006 at 6:11 am</a>		</div>

		<p>So, how do we avoid fumbling around in the dark in the first place? For instance, I&#8217;d like to emulate the effect of pressing Alt+Esc. (I do know you can&#8217;t use WM_SYSCOMMAND in this case because it starts a modal event loop looking for the release of the Alt key).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391363">
				<div id="div-comment-391363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">A/C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391363">
			June 14, 2006 at 6:29 am</a>		</div>

		<p>It is possible to just do this without creating a temporary window:<br />
<br />DefWindowProc(0, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_OFF); </p>
<div CLASS=post>[<i>Another example: &#8220;Hey, NULL is an invalid parameter to DefWindowProc. Let&#8217;s pass it and see what happens!&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391383">
				<div id="div-comment-391383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391383">
			June 14, 2006 at 7:20 am</a>		</div>

		<p>paul2: Any program that went and automatically changed the power scheme or monitor setting goes straight into the recycle bin on my machine. Keep your filthy mits off my personal user settings!<br />
<br />&#8212;<br />
<br />The approach given DOES keep its mitts off your profile. Do you complain that games change your &quot;personal user settings&quot; when they open a fullscreen window?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-391253">
				<div id="div-comment-391253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391253">
			June 14, 2006 at 1:08 am</a>		</div>

		<p>[How could the SendMessage documentation have been improved to solve this problem? &quot;When sending a message to a window, make sure it&#8217;s really a window&quot;? -Raymond]</p>
<p>There&#8217;s nothing wrong with the SendMessage documentation. the problem is with the WM_SYSCOMMAND documentation. For reference:</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardaccelerators/keyboardacceleratorreference/keyboardacceleratormessages/wm_syscommand.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardaccelerators/keyboardacceleratorreference/keyboardacceleratormessages/wm_syscommand.asp</a></p>
<p>First of all, the title of the page is &quot;WM_SYSCOMMAND Notification&quot; which implies that the message is a *notification* and not something you&#8217;d generate yourself.</p>
<p>Then, the first paragraph says:</p>
<p>&quot;A window receives this message when the user chooses a command from the Window menu (formerly known as the system or control menu) or when the user chooses the maximize button, minimize button, restore button, or close button.&quot;</p>
<p>Which is totally wrong in this case. Now further down the page it says this:</p>
<p>&quot;An application can carry out any system command at any time by passing a WM_SYSCOMMAND message to DefWindowProc.&quot;</p>
<p>Which is probably what the original person was wanting. This suggests that the functionality of WM_SYSCOMMAND has probably evolved over time, while the documentation has not evolved as well.</p>
<p>I&#8217;ll not suggest that what the original person did was right, and thinking about what is written in the documentation should have come up with the &quot;correct&quot; solution. But you can&#8217;t deny the documentation for WM_SYSCOMMAND probably needs some work.</p>
<p>Should I post a comment on the documentation page asking them to clarify it? Probably. But I&#8217;m a busy person, and if I wanted to submit corrections every time I spotted them, I&#8217;d be using open source software :p~</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391393">
				<div id="div-comment-391393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391393">
			June 14, 2006 at 8:18 am</a>		</div>

		<p>&lt;quote&gt;But if you were going to fill in the gaps, would you really consider intentionally passing invalid parameters as part of the missing documentation?&lt;/quote&gt;</p>
<p>i would have thought so, yes. But when i actually read the guys posts for myself, i see that he wasn&#8217;t randomly passing garbage and hoping it would work. He did what we all do, read through differect sections of the SDK documentation, trying to cobble together the idea of how it&#8217;s supposed to work. &nbsp;The fact that code iteration #1 and #2 didn&#8217;t work obviously means that the documentation wasn&#8217;t clear enough and he did something wrong. So we keep trying things that are along the same line until it does work. The fact that it works by accident isn&#8217;t something that we&#8217;re supposed to just divine.</p>
<p>If you look at the documentation for SC_MONITORPOWER there is no indication that you are allowed to send the message anywhere. If fact, looking at the documentation for WM_SYSCOMMAND there is no indication that you&#8217;re supposed to be allowed to send any WM_SYSCOMMAND messages anywhere. The contract doesn&#8217;t specify it being allowed, so it must be forbidden &#8211; and therefore &quot;hacking.&quot; &nbsp;Yet i find no shortage of people sending fake SC_MINIMIZE and SC_CLOSE messages. </p>
<p>So maybe it&#8217;s not so bad after all &#8211; just poorly documented.</p>
<p>Next, i receive a SC_MONITORPOWER notification when the monitor is powering down. It is a chance for me to know this is happening, and i can react accordinly (e.g. make my program do less graphical stuff.) Windows will know i&#8217;ve seen the message when i call DefWindowProc. Fair enough. But now someone is suggesting that if i simply generate a SC_MONITORPOWER notification message, and pass it to the DefWindowProc, and that will magically shut down the monitor is crazy. That is not only counter-intuitiave, but not mentioned in the documentation (even taking into account the line &quot;The DefWindowProc function carries out the window menu request for the predefined actions specified in the previous table.&quot;). And as we&#8217;ve seen before</p>
<p><a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/05/12/596113.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/05/12/596113.aspx</a></p>
<p>simply mimicing the thing doesn&#8217;t make it so. Just because you decide to generate a SC_MONITORPOWER message doesn&#8217;t mean that the monitor was in the process of turning off, or that the process will suddenly startup &#8211; at least the documentation provides no indication of that. And yet other people used to do it and it worked. So either it was a bug in Windows that it didn&#8217;t react as documentation, or it was an undocumented feature &#8211; subject to change in future versions of Windows, or it was a poorly documented feature. Yet i find no shortage of people sending fake SC_MONITORPOWER messages. </p>
<p>So maybe it&#8217;s not so bad after all &#8211; just poorly documented</p>
<p>Finally, he didn&#8217;t broadcast a message, he sent a message to WM_TOPMOST. Apparently if i fake the symptoms of a monitor in the process of shutting down, then it shuts down. So one gets the idea that if i send a SC_MONITORPOWER message, the monitor will start to power down. Well obviously i can&#8217;t send it to myself, because i have no ability to initiate a monitor shutdown. i need to send it to some central &quot;windows&quot; authority who will then initiate the monitor shutdown procedure, and in turn broadcast a message to every window on the system, letting them know the monitor is about to turn off, as part of the normal preparation for monitor shutdown. Sounds perfectly reasonable and logical. But how shall we tell Windows the monitor should be shut off? Well, who starts the process in the first place? Windows of course. What is our way in to talk to &quot;the sytem&quot;?</p>
<p>SendMessage(0, &#8230;<br />
<br />SendMessage(-1, &#8230;<br />
<br />SendMessage(GetDesktopWindow(), &#8230;</p>
<p>One of those outta work. No? Dammit, wish this stuff was documented. Any other Windowsy hWnd&#8217;s we can find?</p>
<p>SendMessage(HWND_TOPMOST, &#8230;</p>
<p>Documentation doesn&#8217;t say to can send WM_SYSCOMMANDS, but you can. Documentation doesn&#8217;t say you can initiate a monitor shutdown by calling yourself, but you can.</p>
<p>If i generate a WM_POWER message and pass it to DefWindowProc will the computer turn off? Documentation doesn&#8217;t really say. It says &quot;Notifies applications that the system is about to enter a suspended mode.&quot; &nbsp;Still ambigious. &nbsp;</p>
<p>So, in the absense of documentation as good as i want it to be, couse code please. Perhaps you could just redo windows in CLR, so we would decompile it ourselves into readable source code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391403">
				<div id="div-comment-391403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Billy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391403">
			June 14, 2006 at 8:57 am</a>		</div>

		<blockquote><p>
  &gt;It is possible to just do this without creating a temporary window:<br />
  <br />DefWindowProc(0, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_OFF);<br />
  <br />&lt;&lt;</p>
<p>That does not work, at least not on XP SP2. &nbsp;<br />
  
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391283">
				<div id="div-comment-391283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Roger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391283">
			June 14, 2006 at 2:22 am</a>		</div>

		<p>I agree that the guy with the crazy solution is wrong. But I can&#8217;t help to sympathize.</p>
<p>As Sean W mentioned: How many times when you want to do something and you don&#8217;t know how? Documentations doesn&#8217;t help. You can spend hours on MSDN unless you have the right keywords. So you google it or ask your friends how &#8211; but this likely leads to a buggy solution from the last guy who experienced the same problem.</p>
<p>And this is mainly the fault of Microsoft for being so big. When you have millions of developers, you&#8217;re bound to get many wrong solutions for the same problem &#8211; especially when the &quot;right&quot; solution isn&#8217;t obvious.</p>
<p>The only way to improve this situation is for Microsoft to address the needs for all these developers. Have a database for how-to-do-stuff that&#8217;s easy to find. **Advertise it**. 3rd parties websites have already done it (only with possibly buggy solutions).</p>
<p>Either this, or put up with sketchy code and compatibility problems from now until windows become obsolete.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391423">
				<div id="div-comment-391423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Victor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391423">
			June 14, 2006 at 10:14 am</a>		</div>

		<p>@OldNewThing,<br />
<br />As the author of the &#8216;offending&#8217; articles, it seems only logical to respond to this. Let me state that this is oooold code and medio 2004 it was a pain in the ass to find code or a hint about powering down a monitor.</p>
<p>First of all, some background. I needed the monitor power off/on functionality for a TFT monitor in a painting frame on the wall at home. This monitor displays photos I shoot during holidays, cats etc, but also serves another role. The monitor is touch enabled and shows me a TV guide, photo browsing, movies at the local movie theatre and &#8211; important &#8211; trafic jam info (as I live near Amsterdam).<br />
<br />The monitor power off occurs at 11:30PM and the monitor is switched on again at 6:30AM. At least the living room is not lit up anymore during the night.</p>
<p>As soon as I published the code, Raymond Chen (you!?) notified me that this was not the &#8216;best&#8217; way to do this. Unfortunately, Chen&#8217;s comments on my blog did not survive upgrade to Community Server&#8230;</p>
<p>&lt;EDIT&gt;<br />
<br />Googling for Raymond Chen leads me to OldNewThing, so you HAVE been helping me in 2004! &lt;large grin&gt;<br />
<br />&lt;/EDIT&gt; </p>
<p>Enfin, on Chen&#8217;s comments, I modified the code to NOT use HWND_TOPMOST anymore, but just post the message to the handle of the .NET form, as Chen indicated. Unfortunately, I did not conclude the article series with the proper version (because it was already in the comments) and thus serves a happy bashing session two years later.</p>
<p>This is the code I use after Chen&#8217;s suggestion:<br />
<br />PostMessage((int)this.Handle, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_OFF); </p>
<p>The &#8216;this.Handle&#8217; is the handle of the WinForm showing the photos and has been working splendidly for two years. And this is also what you and others are suggesting.</p>
<p>Actual code is (after refactor sessions):<br />
<br />User32.NativeMethods.PostMessage((int)this.Handle, User32.Constants.WM_SYSCOMMAND, User32.Constants.SC_MONITORPOWER, User32.Constants.MONITOR_OFF); </p>
<p>And yes, I was &#8216;fumbling&#8217; to find a solution. Documentation about the messages was not usable, no code existed on blogs or article sites like Codeproject. And thus you experiment until a &#8216;solution&#8217; appears and publish your findings. By publishing, Chen educated me and helped me refine the solution. The more eyes look at code, the better.<br />
<br />My published search for a better impersonation (in SharePoint) also yielded better versions of de solution.</p>
<p>The least you could have done in this blog post, is provide some code of a correct solution, instead of letting the readers guess for it. This also helps any other developer in finding the best solution for powering down a monitor.</p>
<p>I hope you will be as helpful as in 2004 next time I have a hardcore windows problem. ;-)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391303">
				<div id="div-comment-391303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">steveg</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391303">
			June 14, 2006 at 3:41 am</a>		</div>

		<p>&quot;Making up intentionally invalid parameters and seeing what happens falls into the category of malicious goofing around, not in the realm of software engineering and design.&quot; </p>
<p>I&#8217;d argue that this *is* part of software engineering. It&#8217;s reverse engineering and<br />
<br />you&#8217;ve touched on it before (<a rel="nofollow" target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2006/03/31/565878.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2006/03/31/565878.aspx</a> and other compatibility posts).</p>
<p>Someone must have said this before, but if not, I claim it: &quot;Reverse engineering, the 2nd oldest [software] profession&quot;.</p>
<p>[BTW I like the inline comments better than replies to your own posts. I wonder sometimes why you persevere, though. I hope the good outweighs the bad].</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-391543">
				<div id="div-comment-391543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ramblings.aaronballman.com' rel='external nofollow' class='url'>Aaron Ballman</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-391543">
			June 14, 2006 at 12:07 pm</a>		</div>

		<p>@Victor &#8212; the correct solution was posted in the last paragraph of the post. &nbsp;Granted, it&#8217;s not code, but it also shouldn&#8217;t be hard to translate &quot;make a window and post the message there&quot; into workable code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392023">
				<div id="div-comment-392023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-392023">
			June 15, 2006 at 12:20 pm</a>		</div>

		<p>Re: [Picky, picky.]</p>
<p>Raymond, I was honsetly asking if those were the same things. &nbsp;I didn&#8217;t know. &nbsp; (I thought maybe the monitor would BLANK instead of power off. &nbsp;I *know* that blanking a screen and powering it off aren&#8217;t the same.)</p>
<p>Now that you have yelled at me, I now know. &nbsp;Sorry for questioning it, because it&#8217;s not obvious that those are the same things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392273">
				<div id="div-comment-392273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-392273">
			June 16, 2006 at 6:46 am</a>		</div>

		<p>So passing intentionally invalid parameters is a form of civil<br />
disobedience. Remember that another cornerstone of civil disobedience<br />
is the expectation of being arrested. Do you expect Windows to block<br />
your program when you do these things? -Raymond</p>
<p>Yes. In fact, that would have stopped the original code you<br />
complain about. If Windows would have thrown a BadParam exception, the<br />
original user would never have posted it. The first test run would have<br />
made it clear it was illegal.</p>
<p>I&#8217;m not sure if this would require a special developers build of<br />
XP, but even if, Microsoft could also sell that as a &#8216;hardened&#8217; version<br />
just like Sun created hardened Solaris.</p>
<div CLASS=port>[<i>There is  already a special developer build of Windows for this. It&#8217;s called the checked build. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-392763">
				<div id="div-comment-392763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cd-MaN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-392763">
			June 19, 2006 at 2:15 am</a>		</div>

		<p>Just wanted to point out that code IS documentatoin (code by contract anyone? <a rel="nofollow" target="_new" href="http://www.artima.com/cppsource/deepspace3.html" rel="nofollow">http://www.artima.com/cppsource/deepspace3.html</a>)<br />
so yes, in this way open source is better (a little promo: ReactOS<br />
0.3.0 RC1 just came out, so try it out if you want an open source<br />
windows :) ).</p>
<p>Also when you are complaining about people adressing you questions<br />
which are not your responsibility: &nbsp;Microsoft is for us a big<br />
opaque thing, it&#8217;s not like on the bottom of every page there is a<br />
link: if you want to provide feedback, click here! For example you say<br />
that we should address our complaints regarding the blog software to<br />
the &#8220;makers of the software&#8221;. But who are they? In every open source<br />
forum / blog software you would have found the link to the author at<br />
the bottom of the page, but not here. IMHO a more suitable response<br />
would be: it&#8217;s not my responsability / area of expertise, contact X<br />
(with a mail address or a link to the contact page) for it. Remember,<br />
you are not just yourself, you represent the entire company, like it or<br />
not.</p>
<p>(Just in a sidedone, although I&#8217;m sure I&#8217;ll start a flame war: if<br />
open source isn&#8217;t better, how is it possible that in 4 years we have<br />
built a browser which is more secure, and the IE team still couldn&#8217;t<br />
plug all the holes and almost every month they come out with a remote<br />
code execution attack? I know that rewriting software from scratch is<br />
bad, but this is embarrasing)</p>
<div CLASS=post>[<i>If code is documentation, then how can you safely change the code? Somebody may have been relying on the code you changed, and it was &#8220;documented&#8221; as such. The blog software used to put a link to the software author at the bottom of the page; it looks like they&#8217;ve removed it. There has always been a link to the blog software author on the Suggestion Box page. And I can&#8217;t say &#8220;You should contact X with your problem&#8221; if I don&#8217;t know who X is. And I don&#8217;t want people just throwing random questions at me because &#8220;Oh, even though it&#8217;s not Raymond&#8217;s area, he&#8217;ll tell me who X is&#8221;. I don&#8217;t want to become an &#8220;X finder&#8221;. As for IE: Can you open your My Computer folder from your favorite non-IE browser? How about an FTP site in icon mode so you can drag/drop files to upload/download? Or view a PDF file inside the browser window instead of using an external plug-in? IE has a much larger surface area than most other browsers. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-392793">
				<div id="div-comment-392793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-392793">
			June 19, 2006 at 8:31 am</a>		</div>

		<p>Regarding IE:</p>
<p>&gt; Can you open your My Computer folder from your favorite non-IE browser?</p>
<p>No, but on the other hand, I don&#8217;t see the point of being able to<br />
do this, either. &nbsp;That&#8217;s what Windows Explorer is for. &nbsp;(No<br />
matter how much Microsoft marketing wanted us to believe that the<br />
Internet was no different from the local machine 5 years ago, it wasn&#8217;t<br />
true then, and it&#8217;s even less true now. &nbsp;The local machine can be<br />
trusted much more than the Internet can be.)</p>
<p>(Note that I can do it (or its equivalent, view the root directory)<br />
in Konqueror. &nbsp;It&#8217;s just that Konqueror isn&#8217;t my *favorite* non-IE<br />
browser.)</p>
<p>&gt; How about an FTP site in icon mode so you can drag/drop files to upload/download?</p>
<p>What&#8217;s the point of this? &nbsp;It makes it slightly easier for new<br />
users, or something? &nbsp;If you have a browser, why would you expect<br />
to be able to drag-and-drop to download a file? &nbsp;Wouldn&#8217;t users<br />
expect to click a file to download it, just like when you&#8217;re browsing<br />
via HTTP? &nbsp;Except, oh, that&#8217;s right, marketing says that the<br />
Internet is no different from the local filesystem again.</p>
<p>OTOH, most third-party FTP programs have a drag-and-drop mode (and<br />
it&#8217;s possible that some of them will accept drops from Windows Explorer<br />
too, I don&#8217;t know). &nbsp;Not sure how many of them are free, though.<br />
&nbsp;And when you&#8217;re using a different program for FTP, it&#8217;s a little<br />
more obvious that a different action may be required to download a<br />
file, so the interface &#8220;cost&#8221; of going fully DnD isn&#8217;t as high.</p>
<p>(Actually, Konqueror may be able to do this also, but I&#8217;ve never<br />
tried it so I don&#8217;t know for sure. &nbsp;Certainly the infrastructure<br />
is there; someone would just need to write an FTP kioslave.)</p>
<p>&gt; Or view a PDF file inside the browser window instead of using an external plug-in?</p>
<p>&#8220;External plug-in&#8221; like the one from Adobe that&#8217;s required for IE<br />
too (at least IE6SP1)? &nbsp;No, I can&#8217;t view PDFs without that.<br />
&nbsp;But with it, I can view them &#8220;inside the browser window&#8221;.</p>
<p>(But I doubt that Adobe has a plug-in for Konqueror. &nbsp;However,<br />
KDE does have a PDF viewer (named, appropriately enough, kpdf), and<br />
it&#8217;s possible that kpdf can be invoked inside the Konqueror window.<br />
&nbsp;Never tried that either, though, so I don&#8217;t know for sure.)</p>
<div CLASS=post>[<i>I&#8217;m not saying that any of these were necessarily good ideas, but once you&#8217;ve shipped a feature you&#8217;re committed to supporting it. Even the bad features. Companies have built line of business processes around these features. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393353">
				<div id="div-comment-393353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Revenant</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-393353">
			June 20, 2006 at 6:28 am</a>		</div>

		<p>Originally posted by Raymond:<br />
<br />[Or view a PDF file inside the browser window instead of using an external plug-in?]</p>
<p>That reminds me of an interesting thing my PC does&#8230;</p>
<p>I have several toolbars set up as a sidebar on the desktop, including a &quot;My Computer&quot; bar which lets me browse my filesystem via drop-down menus. One interesting side-effect of this method is that when I open a PDF from this menu, it opens in IE!</p>
<p>I&#8217;m guessing this is because the ability to make toolbars out of folders came with IE4, which was the first version of IE to be integrated into Windows, and that somehow they&#8217;re treated as being part of the &quot;IE side&quot; of Explorer, which naturally opens PDFs inline?</p>
<p>&#8230; Will this be bugfixed in Vista? ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393383">
				<div id="div-comment-393383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-393383">
			June 20, 2006 at 8:49 am</a>		</div>

		<blockquote><p>
  [I&#8217;m not saying that any of these were necessarily good ideas, but once you&#8217;ve shipped a feature you&#8217;re committed to supporting it.]</p>
<p>Ah, I get it. &nbsp;So it sounds like the problem with IE is Microsoft&#8217;s marketing department way back in 1995-96-ish, perhaps along with a lack of clairvoyance about future threats. &nbsp;:-P</p>
<p>(However, if Konqueror can indeed do all those things &#8212; and it&#8217;s been 4-5 years since I last used it &#8212; then the fact that it&#8217;s not coming out with a new patch every month should imply something too.)</p>
<p>Revenant &#8212; You turn that toolbar on from the taskbar&#8217;s context menu, right? &nbsp;(Right-click the taskbar, Toolbars, New Toolbar, select My Computer, hit OK.) &nbsp;That toolbar shows PDFs in Acrobat for me, not IE. &nbsp;This is 2K Pro SP4, though, so maybe that has something to do with it? &nbsp;(Also, IE is no longer my default browser, so that might be part of the difference too.)
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393403">
				<div id="div-comment-393403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Revenant</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-393403">
			June 20, 2006 at 9:51 am</a>		</div>

		<p>BryanK &#8212; Yes, that&#8217;s the toolbar. (I was quite gratified when they started making it one of the default toolbars, since I&#8217;ve been using this particular feature since Win98.)</p>
<p>I&#8217;m running XP Pro SP2, and IE is not my default browser either. In fact, I told Windows never to use it &#8211; yeah, I know, like that ever made a difference&#8230;</p>
<p>Specifically, my PC is opening PDFs with the Acrobat plugin in an IE window. If I open then via a normal Explorer window, my application preferences are honoured.</p>
<p>Just out of interest: was your &quot;My Computer&quot; toolbar part of the taskbar when you tested, or part of a separate toolbar? If it was part of the taskbar, you might want to give it a go as part of a sidebar and see what happens. You&#8217;ll need another (blank or otherwise) toolbar on the same screen edge to make it use the menu function.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-393473">
				<div id="div-comment-393473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-393473">
			June 20, 2006 at 1:02 pm</a>		</div>

		<p>Oh, you&#8217;re right, it was part of the taskbar. &nbsp;But I put it on the right side of the screen (well, I put the Address toolbar on the right side of the screen, then added My Computer to it), and it didn&#8217;t open up IE, just Acrobat. &nbsp;I also tried a file located on a mapped network drive (so it&#8217;s from a different zone), and that didn&#8217;t seem to make any difference.</p>
<p>What happens if you open the PDF from the Start-&gt;Run box? &nbsp;(Are ShellExecute and ShellExecuteEx working, in other words?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394613">
				<div id="div-comment-394613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-394613">
			June 22, 2006 at 8:33 pm</a>		</div>

		<p>I wish to duplicate this followup in this thread because it follows up to this thread and there&#8217;s no way to do newsgroup-style crossposts.</p>
<p>&gt; It so happens that the numerical value -1<br />
<br />&gt; for a window handle is suspiciously close to<br />
<br />&gt; the value of HWND_BROADCAST:<br />
<br />&gt; #define HWND_BROADCAST &nbsp;((HWND)0xffff)<br />
<br />&gt; It so happens that internally, the window<br />
<br />&gt; manager supports (HWND)-1 as an alternative<br />
<br />&gt; value for HWND_BROADCAST. (I leave you to<br />
<br />&gt; speculate why.)</p>
<p>We can leave it to MSDN to say why.</p>
<p><a rel="nofollow" target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/dataexchange/dynamicdataexchange/usingdynamicdataexchange.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/dataexchange/dynamicdataexchange/usingdynamicdataexchange.asp</a></p>
<p>* &nbsp;Usually, the client broadcasts this message<br />
<br />* &nbsp;by calling SendMessage, with &#194;1 as the<br />
<br />* &nbsp;first parameter.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-395333">
				<div id="div-comment-395333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-395333">
			June 24, 2006 at 3:10 pm</a>		</div>

		<p>The reason why -1 still can be used as a substute for 0xFFFF is because, in 16-bit Windows, -1 = 0xFFFF because the message value was 16-bit. It no longer equals 0xFFFF because the message value is increased to 32-bit in Win32.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-579623">
				<div id="div-comment-579623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.anti-tgtsoft.com/?p=35' rel='external nofollow' class='url'>anti|tgtsoft</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-579623">
			December 21, 2007 at 2:27 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://www.anti-tgtsoft.com/?p=35" rel="nofollow">http://www.anti-tgtsoft.com/?p=35</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-589143">
				<div id="div-comment-589143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://withinwindows.com/?p=29' rel='external nofollow' class='url'>Within Windows</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-589143">
			January 13, 2008 at 9:42 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://withinwindows.com/?p=29" rel="nofollow">http://withinwindows.com/?p=29</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-650653">
				<div id="div-comment-650653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.malcom.pl/2008/07/30/wygaszanie-ekranu/' rel='external nofollow' class='url'>MalDevBlog &raquo; Wygaszanie ekranu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20060613-05/?p=30893#comment-650653">
			July 30, 2008 at 10:30 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://blog.malcom.pl/2008/07/30/wygaszanie-ekranu/" rel="nofollow">http://blog.malcom.pl/2008/07/30/wygaszanie-ekranu/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

