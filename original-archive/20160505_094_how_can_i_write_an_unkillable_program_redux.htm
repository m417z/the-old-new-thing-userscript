<html>
<head>
<title>How can I write an unkillable program, redux</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How can I write an unkillable program, redux</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 5, 2016 / year-entry #95</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>52</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">License to not be killed.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer wanted to know how to write an unkillable process.
Specifically, they want to write a program that runs continuously
in the background, and they don't want the logged-in used
(who is not an administrator) to be able to terminate it.
They wanted to know if there was a way to hide the program
from Task Manager, so the user cannot click "End Task".
</p>
<p>
The usual way to prevent a user from killing a program is
to run the program as some other user.
Users can kill their own programs (by virtue of being the owner),
but they cannot kill programs that are owned by others,
unless they have administrator privileges,
or something administrator-equivalent like debug privilege,
or unless the program permits others to
terminate it.
</p>
<p>
"To clarify the scenario:
This program needs to display a message to the user.
Therefore, it cannot run as a service, because that would
open the service to a shatter attack.
The message is one to tell the user that the work day is
over and they need to wrap things up and go home.
We found that users are killing the program to make the message
go away."
</p>
<p>
Okay, so what we really have here is a social problem,
not a technical one.
You want to remind the user to go home.
Those that want to keep working are killing the program.
You think the solution is to make the program unkillable,
but that really doesn't change the situation.
Even if you made the program unkillable, the user can
simply <i>ignore the message</i>.
There's nothing you can do to make a user pay attention to
a message.
If they want to ignore it, then they will ignore it.
</p>
<p>
"Yes, that was my advice to the customer,
but the customer isn't looking for a solution.
They just want an answer. They absolutely want
to write the program that displays the 'Go home' message
and make it unkillable."
</p>
<p>
What you can do is have a service inject the program
into the session, and let it run as the logged-on user.
(You have to make it run as the logged-on user in order
to avoid a shatter attack.)
The service can monitor the program, and if the user
terminates it, the service can log an entry to the
security event log, and you can roll up those events
into a report so you can see which users are killing the
reminder app,
then apply appropriate social pressure.
</p>
<p>
If you want to be really annoying about it, you can
even relaunch the app that displays the "Go home" message.
Of course, that'll just trigger
<a HREF="https://blogs.msdn.microsoft.com/oldnewthing/20080416-00/?p=22723">
Le Chatelier's Principle for complex systems</a>:
The user will write a script that kills the app
as soon as it is relaunched,
or attack the app so it doesn't show the message
in the first place.
</p>
<p>
If you want to make sure the user goes home,
you can have the service lock the workstation
and
set a restricted logon policy so the user
cannot log
back in until 9am the next morning.
The service can inject a program into the
session to display a countdown timer.
In this case,
the user can terminate the countdown timer
app all they want;
that's not going to stop the workstation from
being locked.
They're just shooting the messenger.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (52)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-bboorman even thread-even depth-1 parent" id="comment-1247217">
				<div id="div-comment-1247217" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247217">
			May 5, 2016 at 7:05 am</a>		</div>

		<p>At first I wondered why an employer would want to force employees to go home. But then maybe these employees are paid by the hour and the employer wants to control overtime pay costs.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1247235">
				<div id="div-comment-1247235" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247235">
			May 5, 2016 at 7:23 am</a>		</div>

		<p>Employees can unilaterally decide to have overtime and that&#8217;s it?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bboorman even depth-3" id="comment-1247265">
				<div id="div-comment-1247265" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247265">
			May 5, 2016 at 7:42 am</a>		</div>

		<p>I suppose you could fire employees who abuse the process. There is this plain-English analysis: <a href="http://www.employmentlawfirms.com/resources/employment/overtime-pay/are-employers-obligated-to-pay-unauthorized-overtime" rel="nofollow">http://www.employmentlawfirms.com/resources/employment/overtime-pay/are-employers-obligated-to-pay-unauthorized-overtime</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3 parent" id="comment-1247315">
				<div id="div-comment-1247315" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247315">
			May 5, 2016 at 8:06 am</a>		</div>

		<p>If an hourly employee does work, they legally have to be paid for all of the time they worked. If the employer wants to limit hours to a certain point, it&#8217;s their responsibility to make sure that employees stop working and go home when they hit those limits. If an employee ignores the schedule and decides to keep working for one extra hour, the employer is required to pay them for that hour (including overtime, if applicable), even if they clocked out before doing the work. The law takes a dim view of unpaid work, regardless of the reason.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4" id="comment-1247335">
				<div id="div-comment-1247335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247335">
			May 5, 2016 at 8:24 am</a>		</div>

		<p>It&#8217;s not just work at the end of the day.  According to Coyote Blog, he had employees who voluntarily worked through lunch in violation of California labor laws, which say you must be provided a 30-minute or whatever unpaid lunch break where you don&#8217;t work.  Even when he had them sign a waiver saying they wanted to do it, people would still sue him after the fact.  In the end, he had to make working lunches a fireable offense to get people to stop doing it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-4 parent" id="comment-1247375">
				<div id="div-comment-1247375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BZ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247375">
			May 5, 2016 at 9:33 am</a>		</div>

		<p>When I was last an hourly employee (3 years ago, not that long), I filled out a timesheet, printed it, and faxed to the agency that employed me every week. If I worked extra hours and didn&#8217;t report them, nobody knew. After all, I was the interested party, so it was up to me to get them to pay me. They *could* have set things up in such a way that they did know, but it was in everyone&#8217;s best interest to rely on self-reporting. Of course there is room for abuse in such a system (they force you to work overtime without payment, or I report more work time than I really worked), but any technology-based system to enforce work hours could be gamed in one way or another save for something really draconian like locking you in if you don&#8217;t leave or having staff escort you out.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-5" id="comment-1247875">
				<div id="div-comment-1247875" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CatCube</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247875">
			May 6, 2016 at 8:00 pm</a>		</div>

		<p>BZ,</p>
<p>And you could possibly sue for those hours you weren&#8217;t paid.  The company could argue that they didn&#8217;t know you were doing it, but if they didn&#8217;t discipline people (to include firing) when they found out they were doing this, then you&#8217;d probably win.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hikari odd alt depth-2" id="comment-1247365">
				<div id="div-comment-1247365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Crowther' rel='external nofollow' class='url'>Chris Crowther</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247365">
			May 5, 2016 at 9:15 am</a>		</div>

		<p>They may be ensuring the workers don&#8217;t go over their limit under the EU Working Time Directive, assuming they&#8217;re in the EU.  </p>
<p>I know one of my friends got ordered to go home by both her manager and her union rep when she hit her maximum number of hours when she was working in France at TI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1247425">
				<div id="div-comment-1247425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247425">
			May 5, 2016 at 10:31 am</a>		</div>

		<p>@Brian_EE I guess when they have solved the problem of getting employees to work on time they need to find something else to do :-)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mzzt odd alt thread-odd thread-alt depth-1 parent" id="comment-1247255">
				<div id="div-comment-1247255" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/The+MAZZTer' rel='external nofollow' class='url'>The MAZZTer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247255">
			May 5, 2016 at 7:34 am</a>		</div>

		<p>My workplace does this with forced reboots to apply system updates. You can delay them a limited number of times, but eventually it&#8217;ll come down to a countdown you can&#8217;t stop and then your system forces a reboot.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bboorman even depth-2" id="comment-1247275">
				<div id="div-comment-1247275" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247275">
			May 5, 2016 at 7:45 am</a>		</div>

		<p>Yup. And when you are unfortunate &#8211; it happens on the weekend while a multi-day unattended test with data-collection is occurring, and this test data is required to satisfy obligations for a government contract.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1247455">
				<div id="div-comment-1247455" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247455">
			May 5, 2016 at 10:52 am</a>		</div>

		<p>That doesn&#8217;t make you stop work and go home, that makes you wait for the updates to be installed and then get back to work.</p>
<p>The problem with forcing the user to logout and then not allow them to login until the next morning is that when the manager decides he wants the users to work outside of hours he cannot make them do so. </p>
<p>You also don&#8217;t want a house that cannot be broken into, because if you lose your keys or the lock breaks then you would have to buy another house.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1247285">
				<div id="div-comment-1247285" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodríguez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247285">
			May 5, 2016 at 7:51 am</a>		</div>

		<p>It&#8217;s over and over again the same old: &#8220;the user doesn&#8217;t read this warning, so I will make it system modal an with a 24 pt bright red font&#8221;. You are only training the user to click a random button whenever something unexpected pops up. Training him, precisely, not to read your messages.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-iboyd odd alt thread-odd thread-alt depth-1 parent" id="comment-1247295">
				<div id="div-comment-1247295" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247295">
			May 5, 2016 at 8:03 am</a>		</div>

		<p>I know the concepts of Objects, and ACLs on those objects, run deep in Windows NT. My understanding is that nearly everything is an object, and has a set of discretionary access control lists on those objects.</p>
<p>Is there an ACL on the Process object? And is there an ACL entry where i can &#8220;deny&#8221; myself permission to terminate the process?  It&#8217;s all a very nebulous area in Windows (and this is still after buying a copy of Keith Brown&#8217;s Programming Windows Security).</p>
<p>I read that a process can have the PROCESS_TERMINATE access right (a process has the access right? Not the user), which is &#8220;required to terminate a process using TerminateProcess&#8221;. Can i remove the PROCESS_TERMINATE access right from my process (GetCurrentProcess) after i startup?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1247325">
				<div id="div-comment-1247325" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Falcon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247325">
			May 5, 2016 at 8:19 am</a>		</div>

		<p>Raymond has mentioned before that object owners have WRITE_DAC permission on their objects. Here&#8217;s one example: <a href="https://blogs.msdn.microsoft.com/oldnewthing/20150610-00/?p=45411/" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20150610-00/?p=45411/</a></p>
<p>So, even if you can deny yourself permission to terminate the process, you can remove the restriction later.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-iboyd odd alt depth-3 parent" id="comment-1247445">
				<div id="div-comment-1247445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/IanBoyd' rel='external nofollow' class='url'>IanBoyd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247445">
			May 5, 2016 at 10:47 am</a>		</div>

		<p>&gt; even if you can deny yourself permission to terminate the process, you can remove the restriction later.</p>
<p>Yes *i*, the program, could remove the restriction. But a user would not be able (easily) to remove the deny.</p>
<p>They would have to inject a thread into my process, and restore the restriction. Not only would that be difficult for an end-user to accomplish, they don&#8217;t have required administrative permissions to do it.</p>
<p>So, *is* there an ACL on a process that controls a user&#8217;s ability to terminate the process? MSDN seems to indicate that there is none &#8211; that instead there is a right set on the process (not an access control list)</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-4 parent" id="comment-1247485">
				<div id="div-comment-1247485" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247485">
			May 5, 2016 at 12:12 pm</a>		</div>

		<p>The user can change the ACLs on any object for which he is the owner. If the process is running as the user, then the user can change the ACL and grant himself TERMINATE rights.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1247515">
				<div id="div-comment-1247515" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247515">
			May 5, 2016 at 1:27 pm</a>		</div>

		<p>In this case the user is expected to be a non-programmer, or at least that&#8217;s how I read IanBoyd&#8217;s comment.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1247525">
				<div id="div-comment-1247525" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247525">
			May 5, 2016 at 1:38 pm</a>		</div>

		<p>&gt; If the process is running as the user, then the user can change the ACL and grant himself TERMINATE rights.</p>
<p>He can, but he needs a program to do that. Is there anything in the &#8216;commonly available Windows program repertoire&#8217; that allows twiddling the DACL on a process? Are these particular users the sort of users that can write programs or find programs in obscure corners of the internets?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt depth-5" id="comment-1247535">
				<div id="div-comment-1247535" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247535">
			May 5, 2016 at 3:24 pm</a>		</div>

		<p>I think the process object owner (creator) can be different from the process user token. In which case the user will not be able to do anything with the process, even though the process runs under their account.</p>
<p>Also, a process can create a desktop, switch to it, and the user will not be able to do anything about that (wonder if Ctrl-Alt-Del will switch it to the main desktop back, or invoke the Task Manager on the second desktop)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1247545">
				<div id="div-comment-1247545" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://harryjohnston.wordpress.com' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247545">
			May 5, 2016 at 4:23 pm</a>		</div>

		<p>Yeah, I think alegr1 is right.  Who the program runs as and who owns it / has any rights to it are different things, at least potentially.  I&#8217;m not sure whether it would be straightforward to create such a process, though, you might need to run through some hoops.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-msn odd alt depth-5" id="comment-1247596">
				<div id="div-comment-1247596" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/poizan42' rel='external nofollow' class='url'>poizan42</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247596">
			May 6, 2016 at 4:36 am</a>		</div>

		<p>You can just change the owner of the process object. You can try this with Process Hacker. Here I have changed the owner to SYSTEM and removed the other ACLs: <a href="http://imgur.com/fvLtc6q" rel="nofollow">http://imgur.com/fvLtc6q</a>. The associated token is still the one for my user: <a href="http://imgur.com/b0cBpEi" rel="nofollow">http://imgur.com/b0cBpEi</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-5" id="comment-1247706">
				<div id="div-comment-1247706" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247706">
			May 6, 2016 at 10:12 am</a>		</div>

		<p>> Is there anything in the &#8216;commonly available Windows program repertoire&#8217; that allows twiddling the DACL on a process?</p>
<p>The debugger is a great tool. You are allowed to debug your own processes, so debug the process and then click &#8220;Stop debugging&#8221; (which terminates the process). Even non-programmers can be taught to do this. (Actually, since all you want to do is stop the program from annoying you, just patch out the ShowWindow call.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1247905">
				<div id="div-comment-1247905" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247905">
			May 7, 2016 at 11:00 am</a>		</div>

		<p>&gt;Even non-programmers can be taught to do this.</p>
<p>And teaching non-programmers to do things like this can be very profitable (either in money or favours). The user isn&#8217;t your only adversary. Good enough is never good enough.</p>
<p>You should assume that you&#8217;re trying to stop someone who is cleverer than you.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1247305">
				<div id="div-comment-1247305" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Piotr Siódmak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247305">
			May 5, 2016 at 8:06 am</a>		</div>

		<p>Next episode: &#8220;how do I kill an unkillable program?&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1247316">
				<div id="div-comment-1247316" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247316">
			May 5, 2016 at 8:11 am</a>		</div>

		<p>With the power button, of course.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1247326">
				<div id="div-comment-1247326" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Falcon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247326">
			May 5, 2016 at 8:20 am</a>		</div>

		<p>In this particular case, that&#8217;s pretty much what they want the users to do!</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1247465">
				<div id="div-comment-1247465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247465">
			May 5, 2016 at 10:54 am</a>		</div>

		<p>@Piotr Siódmak </p>
<p>&gt;Next episode: “how do I kill an unkillable program?”</p>
<p>The bonus is surely for &#8220;how do I kill my competitors unkillable program but prevent them from killing mine?&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1247346">
				<div id="div-comment-1247346" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247346">
			May 5, 2016 at 9:03 am</a>		</div>

		<p>It turns out there is in fact a solution to this problem. I had to use it when tackling a more annoying variant.</p>
<p>The solution is to steal the winlogon token for the winlogon process on the active session. You can then use that token to start a process as SYSTEM on that session that has the ability to render windows and receive input. Always handle WM_TIMER even if you don&#8217;t use timers and create no standard controls; EM_GETSELTEXT would give somebody else a very good day and you a very bad one.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1247546">
				<div id="div-comment-1247546" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://harryjohnston.wordpress.com' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247546">
			May 5, 2016 at 6:32 pm</a>		</div>

		<p>Don&#8217;t see why you&#8217;d need the token from winlogon in particular.  Duplicating a standard SYSTEM token and changing the Remote Desktop session should have the same effect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1247585">
				<div id="div-comment-1247585" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.silverbacknetworks.tech' rel='external nofollow' class='url'>Josh B</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247585">
			May 6, 2016 at 12:39 am</a>		</div>

		<p>Congratulations, you just created another vector for a Shatter attack. That was the whole point of making it a user process, not System, in the first place.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-even depth-1" id="comment-1247385">
				<div id="div-comment-1247385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247385">
			May 5, 2016 at 9:53 am</a>		</div>

		<p>You could have the keyboard shock the user, or have the monitor explode, or something, if the user kills the process.  :-)</p>
<p>Yes, these are sociological issues that people want to handle technologically.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1247495">
				<div id="div-comment-1247495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247495">
			May 5, 2016 at 1:00 pm</a>		</div>

		<p>How do shatter attacks work now that UIPI is a thing? Does simply having a window from a process running as SYSTEM in a user&#8217;s session effectively give that user SYSTEM privileges?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1247526">
				<div id="div-comment-1247526" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ZLB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247526">
			May 5, 2016 at 1:45 pm</a>		</div>

		<p>Actually, the customer is asking a reasonable question.</p>
<p>&#8220;I am responsible for these computers and what the users are doing on them. As the supreme lord Administrator of all I survey, how can I ensure a process is running in their session and they don&#8217;t keep killing it?&#8221;</p>
<p>Ok. A user unkillable process that runs in the user&#8217;s session. That&#8217;s not going be misused is it? I&#8217;m going to get me a really nice bonus!</p>
<p>But on the other hand think about things like parental control software. (Activity monitoring/reporting/blocking)</p>
<p>The network administrator/company/institution may be legally responsible or under a duty of care for the individuals using the computers.</p>
<p>This leaves us in a state where the choices are:</p>
<p>1) Just run the application from a service in the user&#8217;s session as SYSTEM. Great! Now you have horrible security problems, and you have to impersonate the user for stuff.</p>
<p>2) Build a privileged app and a user app that chat over IPC. Still not a great solution because the user can kill the user app just as fast as you can re-spawn it. And you&#8217;ve lost all the state. So you move more and more of the state, to the privileged app, followed by UI&#8230;see point 1 for further details.</p>
<p>Really, we need some concept of a protected process that runs in the context of the user but the user is not able to fiddle with.</p>
<p>Other than suggesting some sort of Authenticode signing requirements, I can&#8217;t think of a way that this won&#8217;t be abused by spyware or the shovelware that seems to be pre-loaded on every laptop these days.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1247566">
				<div id="div-comment-1247566" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mdfs.net/Docs/Comp/Windows/Hints' rel='external nofollow' class='url'>jgh</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247566">
			May 5, 2016 at 7:44 pm</a>		</div>

		<p>Could be time-limited access on a public access computer. At my local library when you log on there&#8217;s a countdown timer on the task bar. If you kill it it comes back after a couple of seconds. When there&#8217;s only five minutes left of your session a window pops up warning you to save everyhting and prepare to log off. At 30 seconds a window pops up with a countdown timer. Even if you keep killing things all apps are killed at the end of your session and the computer soft reboots.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-msn odd alt depth-2" id="comment-1247595">
				<div id="div-comment-1247595" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/poizan42' rel='external nofollow' class='url'>poizan42</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247595">
			May 6, 2016 at 4:29 am</a>		</div>

		<p>&gt; Really, we need some concept of a protected process that runs in the context of the user but the user is not able to fiddle with.</p>
<p>There is, you can just change the owner of the process object to SYSTEM and remove the ACLs for the user and session. You can try it yourself with Process Hacker, it seems to work fine as far as I can tell. I can&#8217;t do anything with the process afterwards without elevating.</p>
<p>You may have to be careful with processing windows messages if you really want it to be protected &#8211; running it under high integrity is probably the easiest way to avoid this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1247605">
				<div id="div-comment-1247605" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brad Westness</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247605">
			May 6, 2016 at 4:44 am</a>		</div>

		<p>If the employees do most of their work online, you could maybe just do something with the company&#8217;s network where all internet access is blocked after a certain time, and any URL request in a browser is intercepted and redirected to a &#8220;Go home&#8221; message.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1247615">
				<div id="div-comment-1247615" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">12BitSlab</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247615">
			May 6, 2016 at 5:07 am</a>		</div>

		<p>This is a classic &#8220;using technology to solve a management problem&#8221; problem.  I am sure many here have run into this before.</p>
<p>Years ago, I was working on a medical system.  One of things it had to do was to keep track of patients’ medical records that were in turn supplied to nursing homes.  While we were gathering requirements, one of the end users asked if we could add spell checking to the med records stuff since much of it is free form text entered by a user.  I replied that conceivably, we could, but we would put that down as a V2 requirement since the systems they were using at the time did not have spell checking.</p>
<p>After hearing that, a different user asked, &#8220;You can do that?&#8221;  I replied, &#8220;We can, but there isn&#8217;t time to do that in V1.&#8221;  He went on to then ask, &#8220;If you can do that, can you add a dirty word filter?&#8221;  To which I replied, &#8220;Dirty word filter?  What do you mean by that?&#8221;  He came back and explained that sometimes you have disgruntled employees and they write inappropriate things in the med records just to make the nursing homes mad.&#8221;  </p>
<p>I said, &#8220;In regards to &#8216;dirty words&#8217;, that is not a technology problem.  That is a management problem.  Rather than trying to use the system to do a manager&#8217;s job, the managers should simply do their job.  If they aren&#8217;t capable of doing that, you have the wrong managers.&#8221;</p>
<p>He reluctantly agreed that I was correct.  I also later found out that he was in charge of the managers who supervise the medical records people.</p>
<p>The bottom line is that sometimes as developers, we need to be honest with users even if it is not comfortable.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-alegrigoriev even depth-2" id="comment-1247705">
				<div id="div-comment-1247705" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247705">
			May 6, 2016 at 9:48 am</a>		</div>

		<p>That&#8217;s clbuttic feature request.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1247625">
				<div id="div-comment-1247625" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">parkrrrr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247625">
			May 6, 2016 at 5:22 am</a>		</div>

		<p>Why not create the interactive process as another unprivileged user, perhaps one created for the purpose of running this program? Granted, that potentially gives an attacker a vector by which to make their own process unkillable by the logged-on user as well, but at least it doesn&#8217;t give them administrative privileges.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1247635">
				<div id="div-comment-1247635" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ZLB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247635">
			May 6, 2016 at 5:33 am</a>		</div>

		<p>This won&#8217;t work at all.</p>
<p>The other unprivileged user doesn&#8217;t have access to objects in the users session. Things like the desktop or files.</p>
<p>The unprivileged user will also not have the impersonate right.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1247665">
				<div id="div-comment-1247665" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247665">
			May 6, 2016 at 8:13 am</a>		</div>

		<p>Hmmm, this is not so bad; however the implementation is tricky. Logging on the unprivileged user won&#8217;t give you access to the desktop. You would have to read the window station&#8217;s access rights to find the nonce SID and construct the correct token out of thin air with NtXxxxxxXxxxx undocumented call (if you know the call you can identify it from the mask, and if you can&#8217;t find out you should not be using this technique).</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1248035">
				<div id="div-comment-1248035" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ZLB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1248035">
			May 9, 2016 at 7:37 am</a>		</div>

		<p>Ok. I&#8217;m on it.</p>
<p>&#8230;hmm. Doesn&#8217;t seem to work for all versions of Windows. Is there a AppCompat shim I can manually enable?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1247785">
				<div id="div-comment-1247785" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">parkrrrr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247785">
			May 6, 2016 at 1:06 pm</a>		</div>

		<p>There&#8217;s at least a couple ways to get around the desktop issue, I&#8217;d think. One obvious way is to use a stub program that runs as SYSTEM on the logged-in user&#8217;s desktop, adds appropriate permissions to its own desktop handle, creates the &#8220;unkillable&#8221; program on that desktop, and terminates. Since the SYSTEM stub doesn&#8217;t have a message loop, it&#8217;s not vulnerable to shatter attacks. (I&#8217;ve just checked my own desktop on a Win7 machine, and it does have WRITE_DAC access for SYSTEM.)<br />
Access to files is irrelevant for a program like this, I&#8217;d think, but if it needs to use specific files it can probably use appropriately-hardened RPC to the system service for whatever access it needs.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-davebacher even thread-odd thread-alt depth-1" id="comment-1247675">
				<div id="div-comment-1247675" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dave+Bacher' rel='external nofollow' class='url'>Dave Bacher</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247675">
			May 6, 2016 at 8:46 am</a>		</div>

		<p>At one place that I worked, you were authorized to use the computer (or be in the building) specific hours &#8212; they had a nag message like this.  If you ignored it, you were talking to a security guard both to get out of the building that night and then again to get into the building the next day.  That wasn&#8217;t about money &#8212; they wanted to know who was in the building, when and why.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1247695">
				<div id="div-comment-1247695" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247695">
			May 6, 2016 at 9:14 am</a>		</div>

		<p>Never heard of &#8220;shatter attack&#8221; till now, but wow that explains a couple things about Windows 7 that I didn&#8217;t know before: why the logged on user no longer on session 0 (can&#8217;t use tscon 0 /dest:console anymore, have to check which session number to use, though it&#8217;s probably 1), and why a service that posts a message box causes this really weird switch to a pocket dimension just to see it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-adarsha-mv even thread-odd thread-alt depth-1 parent" id="comment-1247725">
				<div id="div-comment-1247725" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/mvadu' rel='external nofollow' class='url'>mvadu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247725">
			May 6, 2016 at 10:27 am</a>		</div>

		<p>Were they any way related to developers of &#8220;Microsoft Office Communicator&#8221;? You right click on the notification icon and select &#8220;Exit&#8221;, and you get a nice balloon saying &#8220;Communicator is still running&#8221;, they kind of did develop an unkillable program, or more like program which wanted to live on at any cost..</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-2 parent" id="comment-1247736">
				<div id="div-comment-1247736" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247736">
			May 6, 2016 at 10:43 am</a>		</div>

		<p>I can never figure out how to exit that app.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1247745">
				<div id="div-comment-1247745" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247745">
			May 6, 2016 at 12:17 pm</a>		</div>

		<p>Assuming it&#8217;s the same one I briefly used to enable Outlook 2003 to talk to exchange online, I couldn&#8217;t really find a use case to exit it. It&#8217;s more like a service that happens to care what user is logged in than any normal desktop app.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1247915">
				<div id="div-comment-1247915" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247915">
			May 7, 2016 at 11:12 am</a>		</div>

		<p>&gt;I can never figure out how to exit that app.</p>
<p>What is it worth to you?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1247986">
				<div id="div-comment-1247986" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dennis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1247986">
			May 9, 2016 at 5:05 am</a>		</div>

		<p>I think the customer is <font color=red>deleted</font> and the program in question is <font color=red>deleted</font>. [<i>Remember the ground rules. -Raymond</i>]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1248465">
				<div id="div-comment-1248465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Petro</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160505-00/?p=93415#comment-1248465">
			May 11, 2016 at 4:18 am</a>		</div>

		<p>Just write a service which will use net send to deliver message to user.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

