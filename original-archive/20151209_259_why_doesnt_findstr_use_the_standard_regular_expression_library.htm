<html>
<head>
<title>Why doesn't findstr use the standard regular expression library?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why doesn&#8217;t findstr use the standard regular expression library?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 9, 2015 / year-entry #260</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>45</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Tim wonders why there isn't a standard library that was settled on and used by everyone by now. (While you're at it, why isn't there a standard for electrical outlets that was settled on and used by everyone by now?) And the answer is the same: Things started out with everybody doing their own thing,...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
Tim wonders
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2014/10/21/10566091.aspx#10566266">
why there isn't a standard library that was settled on and used
by everyone by now</a>.
(While you're at it,
<a HREF="http://gizmodo.com/5391271/giz-explains-why-every-country-has-a-different-fing-plug">
why isn't there a standard for electrical outlets
that was settled on and used by everyone by now</a>?)
And the answer is the same:
Things started out with everybody doing their own thing,
and by the time a standard emerged, it was too late.
</p>
<p><span id="more-92361"></span></p>
<p>
The <code>findstr</code> program was written in 1990
by a colleague of mine who retired in the year 2000.
Let's call him Bob.
It was originally written for MS-DOS and was called
<code>qgrep</code>.
I don't know what the <code>q</code> stands for,
but it couldn't call itself <code>grep</code> because
that name was already taken.
And since this was Bob's little program, he got to choose
which regular expression language it accepted.
</p>
<p>
The <code>qgrep</code> program sat in Bob's bag of tricks,
and he shared it with his closest friends,
who shared it with their friends,
and so on.
Meanwhile, Bob ported <code>qgrep</code> to OS/2
(because he needed a version that ran on OS/2)
and eventually Windows NT (because he needed a version
that ran on Windows NT).
</p>
<p>
At this point, <code>qgrep</code> caught the attention of
the people in charge of the Windows Resource Kit.
They were on the prowl for handy little utilities that
could be tossed onto the CD.
They said,
"Hey, can we put <code>qgrep</code> on the Resource Kit CD?"
Bob said,
"Sure, here you go."
And then the Resource Kit people said,
"Okay, but we are afraid to call it <code>qgrep</code>
because that might create licensing or trademark problems,
so we're going to have to call it something else.
We'll call it <code>findstr</code>!
Also, we'd like to change the command line switches to match
the other Resource Kit tools,
and we'd like to change the help text based on this feedback
from our editors."
</p>
<p>
"Whatever," said Bob.
"I'm going to keep calling mine <code>qgrep</code>,
thanks the same.
Here you go:
I created a clone of <code>qgrep</code>, renamed it
<code>findstr</code>, and made the changes you requested."
</p>
<p>
That's how things stood for several years.
Bob had <code>qgrep</code>.
The Resource Kit had <code>findstr</code>, a mutant offshoot
of <code>qgrep</code>.
</p>
<p>
One piece of common feedback from system administrators was
that a lot of the Resource Kit tools were really handy,
but it was pain to have to install them on every computer.
And since they aren't part of the core Windows installation,
the tools aren't available for use in logon scripts either.
</p>
<p>
And that's how <code>findstr</code> ended up part of Windows.
It came in through on the coattails of the Resource Kit.
I remember when they were added to Windows
because becoming part of the core product meant another round
of security reviews.
</p>
<p>
Okay, that's a nice story, but it doesn't answer the question.
Why wasn't <code>findstr</code> upgraded to use a newer
regular expression engine?
</p>
<p>
Recall that
Bob retired in 2000.
And since <code>qgrep</code> was Bob's baby,
all development on <code>qgrep</code> stopped when he retired.
When Bob gave the <code>findstr</code> project to the Resource Kit team,
they got the source code,
but there was no knowledge hand-off
so that somebody on the Resource Kit team understood how the
program worked, in case they needed to fix a bug or add a feature.
Not that there was anybody on the Resource Kit team available
to receive said knowledge.
The Resource Kit was primarily a <i>book</i>,
so the Resource Kit team consisted mostly of writers and editors,
not programmers.
(That's probably why they were so excited about changing the help text.)
The CD filled with tools was considered a bonus feature,
not the primary product.
I guess they
figured that if they needed a bug fixed or a feature added,
they'd just ask Bob.
</p>
<p>
Besides, you can't change the regular expression language accepted
by a program after it has been released,
because that would break all the scripts that used the old language.
Remember those logon scripts that use <code>findstr</code>?
If any of them used a regular expression whose meaning changed
between the old syntax and the new syntax,
those scripts would subtly stop working properly.
A change in the regular expression syntax would require a new
switch to opt into the new behavior.
</p>
<p>
I don't recall Bob ever mentioning to me that somebody asked him to
upgrade the regular expression engine in <code>qgrep</code>.
I suspect nobody asked, seeing as perl-style regular expressions
didn't become popular until long after Bob retired.
Also, Bob is not a lawyer, so he doesn't want to have to read
the license for a third-party library and figure out how to remain
in compliance with it.
</p>
<p>
(From reading
<a HREF="http://www.pcre.org/licence.txt">
the PCRE license</a>, it appears that if your program uses PCRE,
you must reproduce "the above copyright notice", but there are
<i>three</i> copyright notices on that page.
Does the program need to reproduce all of them?
Or just the last one?
It seems to me that nearly everybody just ignores the license
requirements.
For example, Safari uses PCRE,
but the PCRE copyright, licensing terms, and disclaimer
do not appear in
<a HREF="http://images.apple.com/legal/sla/docs/Safari.pdf">
the Safari EULA</a> or any other Safari documentation I can find.)</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (45)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1217901">
				<div id="div-comment-1217901" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sarkies.blogspot.com' rel='external nofollow' class='url'>Sarkie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217901">
			December 9, 2015 at 7:08 am</a>		</div>

		<p><a href="https://xkcd.com/927/" rel="nofollow">https://xkcd.com/927/</a></p>
<p>xkcd reference needed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1217921">
				<div id="div-comment-1217921" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken in NH</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217921">
			December 9, 2015 at 7:36 am</a>		</div>

		<p>I know! There should be a checkbox for power users. It should be global in nature of course.</p>
<p>Ok, Ok, I&#8217;ll stop now.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1218031">
				<div id="div-comment-1218031" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adamrosenfield.com' rel='external nofollow' class='url'>Adam Rosenfield</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218031">
			December 9, 2015 at 1:09 pm</a>		</div>

		<p>Grep has such a checkbox.  Two of them, actually.</p>
<p>You want Basic Regular Expressions?  Use the default options.  You want Extended Regular Expressions?  Use the -E flag.  You want Perl Regular Expressions?  Use the -P flag.</p>
<p>It would not be a totally unreasonable thing to do to add a new flag to findstr to support a more modern flavor of regexes, which new scripts have to opt into using (licensing issues/implementation details notwithstanding) &#8212; I think this particular feature would meet the -100 points bar.</p>
<p>It would also not be a totally unreasonable thing to do to keep findstr unchanged.  If someone wants to use PCRE-compatible regexes in new scripts, there are plenty of alternatives to findstr available.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1218061">
				<div id="div-comment-1218061" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218061">
			December 9, 2015 at 1:55 pm</a>		</div>

		<p>Well since findstr is by now relegated to backwards compatibility cruft and every sane person uses PowerShell for new scripts anyhow, this problem has been solved nicely.</p>
<p>Because PowerShell has support for regex out of the box and (obviously) uses .NET&#8217;s regex library, which while probably not identical to Perl&#8217;s supports all the useful things you&#8217;d usually need (I imagine, but then I personally prefer a short little parser to a 3 line regex that absolutely nobody understands and that you&#8217;ll have to rewrite if you want to make a trivial change).</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1217931">
				<div id="div-comment-1217931" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodríguez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217931">
			December 9, 2015 at 9:14 am</a>		</div>

		<p>The Gizmodo article linked in the first paragraph is really interesting, and worrying, too. Knowing how powerful standards can be when followed, is a pity when you see those messes because of parallel development. But, once more, XKCD&#8217;s Randall Munroe hits the spot and demonstrates that -sadly- there is no solution :-( .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1217932">
				<div id="div-comment-1217932" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anders Munch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217932">
			December 9, 2015 at 9:14 am</a>		</div>

		<p>Safari does show the PCRE license. It seems to be an older version of the license, from 2005, it doesn&#8217;t like the one you linked to. It&#8217;s in Help|Acknowledgements. There&#8217;s an ftp download link to get the source, and the link actually works! Remarkable.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2" id="comment-1218411">
				<div id="div-comment-1218411" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218411">
			December 11, 2015 at 9:17 am</a>		</div>

		<p>The requirements say &#8220;in the documentation and/or other materials provided with the distribution.&#8221; The &#8220;Acknowledgements&#8221; box is not documentation, but is it &#8220;other materials provided with the distribution&#8221;? I interpreted that to mean a LICENSE.txt file or something similar. Maybe this is why software developers shouldn&#8217;t try to interpret licensing terms.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mndos odd alt thread-even depth-1 parent" id="comment-1217941">
				<div id="div-comment-1217941" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MacIn173' rel='external nofollow' class='url'>MacIn173</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217941">
			December 9, 2015 at 10:20 am</a>		</div>

		<p>I BEG you, please return the old style.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1217971">
				<div id="div-comment-1217971" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217971">
			December 9, 2015 at 11:20 am</a>		</div>

		<p>I second the imploration.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-vbdotnet odd alt depth-3 parent" id="comment-1217981">
				<div id="div-comment-1217981" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vbdotnet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217981">
			December 9, 2015 at 11:35 am</a>		</div>

		<p>+1.  At least put the lovely orange background color back, that alone handles 80% of my nostalgia factor :)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4" id="comment-1218021">
				<div id="div-comment-1218021" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218021">
			December 9, 2015 at 12:50 pm</a>		</div>

		<p>To be clear, I have nothing against the nested comments or the newfound ability to post them from iOS as well, but the white background, the blue hyperlinks, the red-on-pink code and all these new fonts just aren&#8217;t oldnew any more. They&#8217;re simply new.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1218041">
				<div id="div-comment-1218041" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">not important</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218041">
			December 9, 2015 at 1:35 pm</a>		</div>

		<p>++</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-3 parent" id="comment-1218331">
				<div id="div-comment-1218331" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rafael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218331">
			December 11, 2015 at 7:41 am</a>		</div>

		<p>return new Promise( bringBack( oldStyle ) );</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-4 parent" id="comment-1218352">
				<div id="div-comment-1218352" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218352">
			December 11, 2015 at 7:50 am</a>		</div>

		<p>You seem to be under the impression that I control the blog software.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mndos even depth-5" id="comment-1218671">
				<div id="div-comment-1218671" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MacIn173' rel='external nofollow' class='url'>MacIn173</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218671">
			December 12, 2015 at 1:54 pm</a>		</div>

		<p>Thanks to this blog, we&#8217;re under strong impression that MS is good at keeping backwards compatibility.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1218071">
				<div id="div-comment-1218071" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218071">
			December 9, 2015 at 1:57 pm</a>		</div>

		<p>Yeah, we really don&#8217;t want a working mobile site and nested comments and.. wait. Sure a different stylesheet could give it a more unique flair (hey I&#8217;ve been a reader for a decade or so too, I understand the nostalgia!), but the new blog software is a vast, vast improvement to the previous cruft..</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-mndos even depth-3" id="comment-1218111">
				<div id="div-comment-1218111" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/MacIn173' rel='external nofollow' class='url'>MacIn173</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218111">
			December 9, 2015 at 4:17 pm</a>		</div>

		<p>Is there mutual exclusion between usual design and new functionality?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1217942">
				<div id="div-comment-1217942" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217942">
			December 9, 2015 at 10:48 am</a>		</div>

		<p>Safari doesn&#8217;t use PCRE any more &#8211; they switched to their own regex engine called YARR (which Firefox use to use before switching to Chromium&#8217;s irregexp).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1217952">
				<div id="div-comment-1217952" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Slashdotter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217952">
			December 9, 2015 at 10:53 am</a>		</div>

		<p>And thank you for the follow up on the Quake credits post (<a href="https://blogs.msdn.microsoft.com/oldnewthing/20151111-00/?p=91972/" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20151111-00/?p=91972/</a> ) &#8211; I&#8217;m the one who asked you about it your suggestion box originally! I only wish I&#8217;d posted a comment on it while the comments were still open.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1217962">
				<div id="div-comment-1217962" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Killer{R}</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217962">
			December 9, 2015 at 11:05 am</a>		</div>

		<p>Windows Server 2003 Resource Kit notice mentions qgrep, but not findstr: <a href="http://www.microsoft.com/en-us/download/details.aspx?id=17657" rel="nofollow">http://www.microsoft.com/en-us/download/details.aspx?id=17657</a><br />
And after installed on Win7 it works and its command line help differs from findstr&#8217;s. So renaming and code change occured at least after year 2003. And anybody still can take that original Bob&#8217;s qgrep :) BTW little googling discovers at least couple of other qgrep-s on github.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rat even thread-even depth-1" id="comment-1217972">
				<div id="div-comment-1217972" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/hacksoncode' rel='external nofollow' class='url'>hacksoncode</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217972">
			December 9, 2015 at 11:27 am</a>		</div>

		<p>I realize that it would have been a *way* more boring article, but couldn&#8217;t all of this just been replaced with &#8220;Backward Compatibility, duh.&#8221;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1217982">
				<div id="div-comment-1217982" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Waleri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217982">
			December 9, 2015 at 12:00 pm</a>		</div>

		<p>Now would be a good time to hear the story about why Visual Studio *did* change the regular expression library.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1218001">
				<div id="div-comment-1218001" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218001">
			December 9, 2015 at 12:26 pm</a>		</div>

		<p>Probably because there are no batch files that script the Visual Studio search UI.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1218051">
				<div id="div-comment-1218051" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">roeland</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218051">
			December 9, 2015 at 1:52 pm</a>		</div>

		<p>Visual Studio is a bit of an outlier when it comes to regular expressions. It&#8217;s the only program I know of which uses curly brackets { } for capturing groups, and  for word boundaries.</p>
<p>Was that introduced before others settled on ( ) and \b respectively?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bob-rao even depth-4" id="comment-1218101">
				<div id="div-comment-1218101" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Vulpini' rel='external nofollow' class='url'>Vulpini</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218101">
			December 9, 2015 at 3:28 pm</a>		</div>

		<p>Looks like that was introduced with VS 2003: <a href="https://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.71%29.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.71%29.aspx</a></p>
<p>Still existed in VS 2010: <a href="https://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.100%29.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.100%29.aspx</a></p>
<p>Was updated to more conventional syntax in VS 2012: <a href="https://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.110%29.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/2k3te2cs%28v=vs.110%29.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-3 parent" id="comment-1218281">
				<div id="div-comment-1218281" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218281">
			December 11, 2015 at 3:13 am</a>		</div>

		<p>I&#8217;m not sure that is a valid argument as human brains are much harder to change than scripts. I&#8217;ve never seen a benefit in the regular expression change in visual studio, but somehow it was still more important to change it than the impact it would have on me and other developers.</p>
<p>I&#8217;d expect that type of reasoning from a manager, but not from a developer.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-andycadley2 even depth-4" id="comment-1218561">
				<div id="div-comment-1218561" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/AndyCadley' rel='external nofollow' class='url'>AndyCadley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218561">
			December 11, 2015 at 10:09 pm</a>		</div>

		<p>I think the &#8220;human brains are harder to change than scripts&#8221; was pretty much the exact reason for the change. It was annoyingly difficult to mentally switch between the regular expression syntax you were using in code to the Visual Studio only one used by the UI. Having the same regular expressions in both removed an enormous pain point for many developers.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1217991">
				<div id="div-comment-1217991" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1217991">
			December 9, 2015 at 12:15 pm</a>		</div>

		<p>&gt; Besides, you can’t change the regular expression language accepted by a program after it has been released, because that would break all the scripts that used the old language.</p>
<p>That&#8217;s a non-sequitur.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1218011">
				<div id="div-comment-1218011" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218011">
			December 9, 2015 at 12:28 pm</a>		</div>

		<p>Suppose you have a batch file that searches for a parenthesized &#8220;x&#8221; by doing findstr /r /c:&#8221;(x)&#8221;  if you switch to PCRE, then that will find all occurrences of x, even those that aren&#8217;t in parentheses.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-3" id="comment-1218121">
				<div id="div-comment-1218121" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218121">
			December 9, 2015 at 5:31 pm</a>		</div>

		<p>IMO, if they can still find Bob, just add a new switch for a different set of RegEx is acceptable. That&#8217;ll be unlikely to break things because the parsing code would be a seperate one.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1218073">
				<div id="div-comment-1218073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lowell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218073">
			December 9, 2015 at 2:07 pm</a>		</div>

		<p>&gt; For example, Safari uses PCRE, but the PCRE copyright, licensing terms, and disclaimer do not appear in the Safari EULA or any other Safari documentation I can find.</p>
<p>It&#8217;s included with the product (the only place it needs to be); Help -&gt; Acknowledgements.</p>
<p><a href="http://i.imgur.com/98rCr3t.png" rel="nofollow">http://i.imgur.com/98rCr3t.png</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1218091">
				<div id="div-comment-1218091" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://harryjohnston.wordpress.com' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218091">
			December 9, 2015 at 3:00 pm</a>		</div>

		<p>A useful resource for anyone using findstr: <a href="http://stackoverflow.com/q/8844868/886887" rel="nofollow">http://stackoverflow.com/q/8844868/886887</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1218142">
				<div id="div-comment-1218142" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mason Wheeler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218142">
			December 10, 2015 at 6:58 am</a>		</div>

		<p>&#8230;and now we have three problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command odd alt thread-even depth-1" id="comment-1218291">
				<div id="div-comment-1218291" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218291">
			December 11, 2015 at 6:05 am</a>		</div>

		<p>— &#8220;From reading the PCRE license, it appears that if your program uses PCRE, you must reproduce “the above copyright notice”, but there are three copyright notices on that page. Does the program need to reproduce all of them?&#8221;</p>
<p>What you are referring to is a 3-clause BSD license. The person creating a derivative work must reproduce all applicable copyright notices, although I don&#8217;t think anyone would include all three works (basic library, PCRE2 JIT, and Stackless JIT) in a one derivative work. So, most of the time, one of the notices gets reproduced along with three clauses.  For more information, look up &#8220;BSD licenses&#8221; on English Wikipedia.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1218372">
				<div id="div-comment-1218372" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kaz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218372">
			December 11, 2015 at 8:04 am</a>		</div>

		<p>Reams of TL;DR surrounding the only real point here, which is obvious: changing the default regex language accepted by a tool breaks existing scripts.</p>
<p>Who cares about some guy who wrote a poor imitation of a Unix tool on Windows. It is insignificant and irrelevant.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-gregm odd alt depth-2" id="comment-1218461">
				<div id="div-comment-1218461" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/GregM' rel='external nofollow' class='url'>GregM</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218461">
			December 11, 2015 at 10:52 am</a>		</div>

		<p>If you don&#8217;t want all the extra flavor in your stories, feel free to not read the stories here, because they all contain a lot of that, which is what makes them interesting.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even depth-2" id="comment-1218572">
				<div id="div-comment-1218572" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218572">
			December 11, 2015 at 11:23 pm</a>		</div>

		<p>Those who matter must care.</p>
<p>Even in art, where originality of the work is important, poor or rudimentary renditions do not rapidly fall into &#8220;who cares?&#8221; category. (Copyright laws make sure that it does not.) In science, on the other hand, the first rudimentary work is celebrated. Example: Wheel. It is celebrated as a cornerstone invention, even though that wheel is considered junk today. (The Nobel Prize is also given for the *advancement* of science; something that Leonard Hofstadter&#8217;s mother does not seem to know!)</p>
<p>Software is both art and science. In this case, it is more science. This, plus the compatibility issue that Raymond explained.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1218541">
				<div id="div-comment-1218541" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218541">
			December 11, 2015 at 7:20 pm</a>		</div>

		<p>Scripts written in the 80-ies by developers that doesn&#8217;t care to keep them updated and compatible with new standards *should* break. If the owner of software isn&#8217;t interested in keeping it updated, replace the software. Software should in all cases be updated continuously, and stuff that isn&#8217;t compatible with latest standards should not be used. Embrace change.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1218621">
				<div id="div-comment-1218621" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218621">
			December 12, 2015 at 9:34 am</a>		</div>

		<p>Tell that to the company with <a href="https://blogs.msdn.microsoft.com/oldnewthing/20061106-01/?p=29123" rel="nofollow">9000 install scripts</a>. &#8220;Your scripts are supposed to be broken. Replace them all. Embrace change.&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3 parent" id="comment-1218881">
				<div id="div-comment-1218881" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218881">
			December 14, 2015 at 12:57 pm</a>		</div>

		<p>That&#8217;s what successful companies does and it works perfectly. Being compatible with scripts from the 80-ies will limit your ability to innovate.</p>
<p>Even luddites with 9k scripts scripts from the last millennium will probably make more money if they continuously update their scripts to the latest and greatest tech.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1218891">
				<div id="div-comment-1218891" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Richard</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218891">
			December 14, 2015 at 1:28 pm</a>		</div>

		<p>@640k: </p>
<p>What if the 9k scripts were done by government agencies (and they STILL work, thanks to MS$ &#8220;backwards compatibility&#8221;).  Are you OK spending tax payer dollars on &#8220;innovation&#8221; or &#8220;latest and greatest technologies&#8221;, just for the sake of it?   Even more so for a non-profit organization, where any $$ spent on such &#8220;fluff&#8221; takes away from the reason of the organization (like feeding the homeless).</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5 parent" id="comment-1219142">
				<div id="div-comment-1219142" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1219142">
			December 15, 2015 at 3:44 pm</a>		</div>

		<p>Keeping a system compatible with 30 year old batch files instead of refactor it to be compatible with modern and mobile apps, is questionable and will help neither you employer or your customers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-5" id="comment-1219161">
				<div id="div-comment-1219161" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1219161">
			December 15, 2015 at 5:15 pm</a>		</div>

		<p>The company doesn&#8217;t need to keep the system compatible with 30 year old batch files. Microsoft takes care of that. And how do you refactor a batch file to be compatible with mobile apps? Batch files don&#8217;t run on phones.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-oldnewthing bypostauthor odd alt depth-4" id="comment-1218903">
				<div id="div-comment-1218903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218903">
			December 14, 2015 at 2:52 pm</a>		</div>

		<p>Do you want me to forward your contact information to them, so you can show them how spending 10 man-years of effort upgrading 9000 perfectly-functional scripts will make them more money?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hankhein even thread-odd thread-alt depth-1" id="comment-1218871">
				<div id="div-comment-1218871" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Henri+Hein' rel='external nofollow' class='url'>Henri Hein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151209-00/?p=92361#comment-1218871">
			December 14, 2015 at 12:14 pm</a>		</div>

		<p>&#8220;The wonderful thing about standards is there are so many of them to choose from.&#8221;  &#8211; Grace Hopper (maybe)</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

