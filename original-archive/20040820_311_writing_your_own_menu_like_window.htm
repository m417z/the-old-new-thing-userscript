<html>
<head>
<title>Writing your own menu-like window</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Writing your own menu-like window</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>August 20, 2004 / year-entry #312</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>32</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Hereby incorporating by reference the "FakeMenu" sample in the Platform SDK. It's in the winui\shell\fakemenu directory. For those who don't have the Platform SDK, what are you doing writing Win32 programs without the Platform SDK? Download it if it didn't come with your development tools. If for some reason you don't want the Platform SDK...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Hereby incorporating by reference the "FakeMenu" sample in the Platform SDK.  It's in the winui\shell\fakemenu directory.</p>
<p> For those who don't have the Platform SDK, what are you doing writing Win32 programs without the Platform SDK? <a href="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/"> Download it</a> if it didn't come with your development tools. </p>
<p> If for some reason you don't want the Platform SDK yet you want to write Win32 programs (I bet you're the sort of person who throws away the manual as soon as you buy something), you can look at the version that <a href="http://www.mvps.org/user32/">Chris Becke</a> has stashed away <a href="http://www.mvps.org/user32/rc/">on this page</a>. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (32)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-204603">
				<div id="div-comment-204603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204603">
			August 20, 2004 at 7:23 am</a>		</div>

		<p>Raymond,</p>
<p>Do you know if the XP SP2 changes are going to be incorporated into the main Platform SDK anytime soon?  I know there is a separate XP SP2 RC2 SDK (yay for acronyms!) available for download, but I&#8217;m hoping to be able to get it all in one place.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204623">
				<div id="div-comment-204623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204623">
			August 20, 2004 at 7:40 am</a>		</div>

		<p>I don&#8217;t know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204643">
				<div id="div-comment-204643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.philweber.com' rel='external nofollow' class='url'>Phil Weber</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204643">
			August 20, 2004 at 7:57 am</a>		</div>

		<p>&quot;For those who don&#8217;t have the Platform SDK, what are you doing writing Win32 programs without the Platform SDK?&quot;</p>
<p>Who writes Win32 programs anymore? The new millenium is all about managed code! ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204653">
				<div id="div-comment-204653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204653">
			August 20, 2004 at 7:58 am</a>		</div>

		<p>&quot;not actually a .NET blog&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204663">
				<div id="div-comment-204663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Will</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204663">
			August 20, 2004 at 8:21 am</a>		</div>

		<p>Heh, Jonathan beat me to it, but I had the exact same question about the Platform SDK.  :P  It used to be updated every 3-6 months it seemed, but now there hasn&#8217;t been an update in over a year.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204673">
				<div id="div-comment-204673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gary</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204673">
			August 20, 2004 at 8:41 am</a>		</div>

		<p>I actually work with a guy who refuses to download Platform SDK.  He doesn&#8217;t understand why we need it and thinks it&#8217;s a waste of space. </p>
<p>Phil:  Boo for managed code.  Go Win32!! :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204683">
				<div id="div-comment-204683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204683">
			August 20, 2004 at 8:53 am</a>		</div>

		<p>When I&#8217;m answering programming questions from people who are trying to call some API and getting an undefined-symbol error, the most common cause is they&#8217;re still using the headers that came with VC 6.  How they expect to use headers/libs from 1998 to call APIs written in 2002, I&#8217;ll never know. (The windows.h in VC 6 is so old, it mentions &quot;NT 5.0&quot;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204743">
				<div id="div-comment-204743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Morten Andersen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204743">
			August 20, 2004 at 10:19 am</a>		</div>

		<p>The reason why I lived without the Platform SDK for VERY long time, is that it is/was so dammed difficult to install from the site you refer.</p>
<p>First: You can&#8217;t access the site using Moz. &#8211; Have to use IE.</p>
<p>Second: Ok, I used IE, but was unable to use the &quot;automatic install&quot;, as it required MS XML 3 (some specific sub version), and I had long time ago installed MS XML 4. So I tried a couple of things, but was never able to get it to work. (at least I assume that is why it failed?)</p>
<p>Third: The links on the full download site <a target="_new" href="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm" rel="nofollow">http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm</a> was defect at least until July this year (sorry I am on &quot;another&quot; platform without IE right now, so I can&#8217;t verify if the links are still defect, as the section with the links seem to be generated by some ActiveX component?).</p>
<p>I assume even the maintainer(s) of the SDK download site, gave up on getting the links to work correctly. Instead they updated the FAQ for the download with information about substituting the defect &quot;NA&quot; section with the correct version for the February 2003 version. (sorry that I can find the FAQ right now, but the site won&#8217;t let me enter at all with Mozilla :-)).</p>
<p>So, I didn&#8217;t know whether I should cry or laugh in how much of an adventure it is/was to install the Platform SDK, from the web :-).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204913">
				<div id="div-comment-204913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Feinman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204913">
			August 20, 2004 at 11:05 am</a>		</div>

		<p>Johnatan, Will: Supposedly very soon</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204923">
				<div id="div-comment-204923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Morten Andersen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204923">
			August 20, 2004 at 11:19 am</a>		</div>

		<p>Update to my last comment on how hard it was to install the Platform SDK. I just booted to an IE-friendly OS, and it wasn&#8217;t in the FAQ the broken links is mentioned, it is in the &quot;Troubleshooting Installation&quot; section on the &quot;Instructions&quot; page:<br />
<br /><a target="_new" href="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/sdkhelp.htm" rel="nofollow">http://www.microsoft.com/msdownload/platformsdk/sdkupdate/sdkhelp.htm</a></p>
<p>There is probably a very good reason why an ActiveX component must create the links, but it does seem a little bit mysterious that it is so hard to supply 15 correct links :-)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204953">
				<div id="div-comment-204953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/loripe/' rel='external nofollow' class='url'>Lori Pearce [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204953">
			August 20, 2004 at 12:48 pm</a>		</div>

		<p>There will be a new PSDK for WinXP SP2 in a matter of days.</p>
<p>We are changing SDKUpdate.  It will work much like any other MSDN download from now on and that should eliminate the downloading hassles that folks experienced with the SDK Update site.</p>
<p>If you&#8217;d like to continue the discussion about the PSDK and the problems you&#8217;re having or have had with it, comment at my blog <a target="_new" href="http://blogs.msdn.com/loripe/" rel="nofollow">http://blogs.msdn.com/loripe/</a> or continue here and I&#8217;ll try to keep looking.</p>
<p>THANKS FOR ALL THE COMMENTS SO FAR! We are trying to create a better experience with the PSDK and would love to hear how you&#8217;d like to see us change it</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-204983">
				<div id="div-comment-204983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204983">
			August 20, 2004 at 1:43 pm</a>		</div>

		<p>Call me silly, but exactly what sorts of things does the Platform SDK have that I don&#8217;t already have with VC6+SP5?    I&#8217;ve spent the last 45 minutes googling and have yet to find a decent description of what the PSDK is.  I assume that PSDK contains tools and resources for using Windows features invented since 1998 and possibly documentation for formerly &quot;secret&quot; stuff required by the lawsuit settlement.  What else is there and why should I care?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204993">
				<div id="div-comment-204993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204993">
			August 20, 2004 at 2:05 pm</a>		</div>

		<p>So, ahem, here&#8217;s what&#8217;s in the Platform SDK:</p>
<p><a target="_new" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sdkintro/sdkintro/devdoc_platform_software_development_kit_start_page.asp" rel="nofollow">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sdkintro/sdkintro/devdoc_platform_software_development_kit_start_page.asp</a></p>
<p>Well, my work here is done&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205013">
				<div id="div-comment-205013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205013">
			August 20, 2004 at 2:29 pm</a>		</div>

		<p>Eeep. How did you find that? I didn&#8217;t know it was there!<br />
<br />When last did I update that anyway. And more worrying &#8211; what happened to the time I used to have to do the updates in&#8230;<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-204973">
				<div id="div-comment-204973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/loripe/archive/2004/08/20/217926.aspx' rel='external nofollow' class='url'>Lori Pearce's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-204973">
			August 20, 2004 at 4:10 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205033">
				<div id="div-comment-205033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205033">
			August 21, 2004 at 8:15 am</a>		</div>

		<p>Jim&gt; On VC 6 without the PSDK, you have headers and libs that were built in 1998. At that time, the shipping platforms were Win 95 OSR2, NT 4, and IE 4, so your headers/libs only have the APIs that were written up to that time.</p>
<p>Now, try using anything in Win32 written after 1998, like a rebar (in IE 5) or SetWindowTheme (XP). It won&#8217;t be in your header files so how are you going to use it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-205043">
				<div id="div-comment-205043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.rotd.org/' rel='external nofollow' class='url'>Andreas Magnusson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205043">
			August 21, 2004 at 1:37 pm</a>		</div>

		<p>I also remember installing the Platform SDK a BIG hassle. I couldn&#8217;t use the automagic install (don&#8217;t ask me why, it just failed).<br />
<br />So I tried the full download but IE would only download like 65k of each cab-file and nothing more.<br />
<br />So in the end what I had to do was to copy the link to each cab-file from IE into Mozilla. That worked but I have done more funny things in my life.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205053">
				<div id="div-comment-205053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205053">
			August 21, 2004 at 2:06 pm</a>		</div>

		<p>It seems that the new Platform SDK does not support VC6 anymore:</p>
<p>strsafe.lib(strsafe.obj) : fatal error LNK1103: debugging information corrupt; recompile module</p>
<p>Also the debug symbols of SP2 are not compatible to VC6 anymore. Isn&#8217;t it possible to add PDB7 support to VC6?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-205063">
				<div id="div-comment-205063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Candy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205063">
			August 21, 2004 at 10:58 pm</a>		</div>

		<p>To Lori</p>
<p>The SDK is filled with totally irrelevent stuff. I generally want i header file as the MSDN CDs doesn&#8217;t include the values of constants. These days I search google for the .h file as I can read it in 10 seconds compared to an hour to install then uninstall the PSDK.</p>
<p>Why don&#8217;t you put it up as a folder structure so we can take what we want from it, which is generally 0.000000001% of it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205093">
				<div id="div-comment-205093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codeproject.com/script/articles/list_articles.asp?userid=152' rel='external nofollow' class='url'>Mike Dunn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205093">
			August 22, 2004 at 8:38 am</a>		</div>

		<p>Sven&gt; I hate VC 2003 so I never use it if I can help it, but at this point, any new code that MS releases publicly is going to require 2003. At work we just got hit with this &#8211; we used to use VC 6, but we got new libs from the WMP team that wouldn&#8217;t compile in 6, so we had to burn a week converting all our stuff to work in 2003 (and casting various evil spells and curses on the awful 2003 IDE).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-205143">
				<div id="div-comment-205143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sven</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205143">
			August 22, 2004 at 3:05 pm</a>		</div>

		<p>I tried to work with VS 2003, but after two weeks I returned to VC6. The missing Class Wizard is really annoing, besides that I found some things slowing down my daily work:</p>
<p>1) Folder display in Solution Explorer</p>
<p>In my projects I use folders to group files. In the first level of a project all files are sorted after the folders (as in VC6), but from second level all files are sorted before the folders. </p>
<p>2) Resource view</p>
<p>The projects in the resource view are sorted case-sensitive, while the projects in the solution explorer are sorted case-insensitive.</p>
<p>3) Filenames in IDE</p>
<p>The files in IDE always have a small drive letter. You can see this in the &quot;Window&quot; dialog box, in the task list or in the tooltip for the tab.</p>
<p>4) Output and Intermediate Directory</p>
<p>Both directories are always created with small letters. If I specify &quot;.objsUnicode_Release&quot; than &quot;.objsunicode_release&quot; is created.</p>
<p>5) String Table Editor</p>
<p>&#8211; If I open the string table editor than the items are not sorted by value.</p>
<p>&#8211; I miss the separator lines every 16 items. These lines are very helpful if I compare string tables for different languages to find out, which items are missing.</p>
<p>&#8211; The column widths should be stored in the registry.</p>
<p>&#8211; New items are created at the bottom while VC6 inserted the items in the line below.</p>
<p>6) Dialog editor</p>
<p>If keyboard cues are disabled, the dialog editor does not show the mnemonic keys in the layout view. If I press &lt;Enter&gt; on a dialog item (this opens the property window in VC6) the text of the dialog item is deleted and there is no undo support.</p>
<p>7) F4/Shift-F4 goes to the next/previous compiler error. In VC6 the cursor is set automatically on the error line, while in VC7 you have to press &lt;Return&gt; everytime.</p>
<p>8) F4/Shift-F4 does not work for &quot;Find in files&quot; anymore.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205183">
				<div id="div-comment-205183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205183">
			August 22, 2004 at 6:40 pm</a>		</div>

		<p>In VS 2003, not only is the Class Wizard missing, but the help files give incorrect instructions on where to look for the missing functionality.</p>
<p>Meanwhile VS6 SP6 is dated this year, 2004.  Header files that needed to be changed between 1998 and 2004 sure ought to be updated by SP6.</p>
<p>Plus, with VS6 and VS2003 side by side, the SDK integrated itself with VS2003 but not with VS6.  In some thread last year, someone kindly gave me instructions on how to solve that.</p>
<p>Then, with VS6 (SP5 then) and the SDK cooperating, compilation errors arose which didn&#8217;t arise before installing the SDK.  For example an identifier that used to be a typedef changed to a macro or vice-versa, making problems for a header that hadn&#8217;t been updated.  For example the number of closest-match candidates for some COM method call increased from 1 to 2, creating an ambiguity so I had to find the actual class names and guess which one to specify.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-205233">
				<div id="div-comment-205233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dante Shamest</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205233">
			August 22, 2004 at 8:39 pm</a>		</div>

		<p>Been looking for such a sample for some time. Didn&#8217;t know it was all along on my computer in the Platform SDK. ^__^</p>
<p>Annoyance: right-clicking again on the owner window doesn&#8217;t seem to show another &quot;fake menu&quot;. The first &quot;fake menu&quot; has to be closed first.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205253">
				<div id="div-comment-205253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205253">
			August 23, 2004 at 12:29 am</a>		</div>

		<p>What are valid uses for a menu-like window? That is, what can you do with a menu-like window that you can’t with a proper menu?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-205273">
				<div id="div-comment-205273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dante Shamest</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205273">
			August 23, 2004 at 1:24 am</a>		</div>

		<blockquote><p>
  &gt; what can you do with a menu-like window that you can’t with a proper menu?</p>
<p>I guess it allows for more customization. You could make irregular shaped menus with window regions. And you can do your own drawing instead of owner-drawing regular menus.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-205733">
				<div id="div-comment-205733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-205733">
			August 24, 2004 at 5:58 pm</a>		</div>

		<p>Not just menus. Anything that pops up like making your own combo box or code completion dropdown.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-206583">
				<div id="div-comment-206583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Centaur</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-206583">
			August 30, 2004 at 2:45 am</a>		</div>

		<p>So, these are the “I-want-to-be-different” uses… What can you do with a menu-like window that you *absolutely* can’t with a proper menu or combo box?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-206853">
				<div id="div-comment-206853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-206853">
			August 31, 2004 at 6:16 pm</a>		</div>

		<p>The FakeMenu code is how you implement any modal window including dialogs, menus, and comboboxes. You spin your own message loop and then return whatever value you need to the caller doing your own message filtering and dispatching.</p>
<p>The reason Raymond posted this article is because of:<br />
<br /><a target="_new" href="http://blogs.msdn.com/oldnewthing/archive/2003/10/29/55479.aspx#55485" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2003/10/29/55479.aspx#55485</a></p>
<p>I&#8217;m sure you can retrofit the drop down color picker in word, radial menus, and the hotbar in maya to use real menus or a combobox but it&#8217;s a pain in the ass. I&#8217;d be willing to bet drag and drop, the move/resize window code, and autoscrolling (the thing where you middle click and that circle appears so you can scroll around by moving the mouse) are implemented in similar ways.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-209533">
				<div id="div-comment-209533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-209533">
			September 12, 2004 at 3:05 am</a>		</div>

		<p>@rem echo <a target="_new" href="http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm" rel="nofollow">http://www.microsoft.com/msdownload/platformsdk/sdkupdate/psdk-full.htm</a><br />
<br />@rem echo wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.bat" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.bat</a><br />
<br />@rem echo  PSDK-FULL.bat and extract.exe are always the same<br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/3790.0/FULL/PSDK-FULL.bat" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/3790.0/FULL/PSDK-FULL.bat</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/extract.exe" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/extract.exe</a></p>
<p>wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.1.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.1.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.2.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.2.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.3.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.3.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.4.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.4.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.5.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.5.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.6.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.6.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.7.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.7.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.8.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.8.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.9.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.9.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.10.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.10.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.11.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.11.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.12.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.12.cab</a><br />
<br />wget -c <a target="_new" href="http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.13.cab" rel="nofollow">http://download.microsoft.com/download/platformsdk/sdk/update/win98mexp/en-us/2600.2180/FULL/PSDK-FULL.13.cab</a></p>
<p></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-306953">
				<div id="div-comment-306953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jfoscoding/archive/2005/09/18/471048.aspx' rel='external nofollow' class='url'>jfo's coding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-306953">
			September 18, 2005 at 11:53 pm</a>		</div>

		<p>Orangy asks: </p>
<p>Hello, thanks for nice articles. Could you please write one about creating combobox-style&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-306963">
				<div id="div-comment-306963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jfoscoding/archive/2005/09/18/471048.aspx' rel='external nofollow' class='url'>jfo's coding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-306963">
			September 19, 2005 at 12:15 am</a>		</div>

		<p>Orangy asks: </p>
<p>Hello, thanks for nice articles. Could you please write one about creating combobox-style&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-388143">
				<div id="div-comment-388143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2006/06/06/619040.aspx' rel='external nofollow' class='url'>The Old New Thing</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20040820-00/?p=38103#comment-388143">
			June 6, 2006 at 10:00 am</a>		</div>

		<p>It was for scrolling menus.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

