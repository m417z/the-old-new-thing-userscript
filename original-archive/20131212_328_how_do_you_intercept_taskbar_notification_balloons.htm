<html>
<head>
<title>How do you intercept taskbar notification balloons?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do you intercept taskbar notification balloons?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 12, 2013 / year-entry #329</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>15</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer wanted to know how they could monitor and intercept taskbar notification balloons. In particular, they wanted to intercept the clicks on a particular balloon and take alternative action. There is no supported mechanism for intercepting taskbar notification balloons or redirecting clicks on them. Imagine if that were possible: Fabrikam would intercept notification balloons...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer wanted to know how they could monitor and intercept taskbar notification balloons. In particular, they wanted to intercept the clicks on a particular balloon and take alternative action.</p>
<p> There is no supported mechanism for intercepting taskbar notification balloons or redirecting clicks on them. </p>
<p> Imagine if that were possible: Fabrikam would intercept notification balloons for Contoso. If they had access to the balloon text itself, they might change the message from "Contoso products are back in stock. Click here to place your order." to "Special offer for Contoso customers: Take 10% off your first order from Fabrikam." </p>
<p> If they could intercept clicks, then Fabrikam might take clicks on the balloon that normally send the user to the Contoso ordering dialog and instead sends them to a Web page where they can download Fabrikam Supply Chain Management Software. </p>
<p> And then Contoso would ask for a way to block the interception because Fabrikam is preventing their software from working. And then Fabrikam would say "Infinity", and then Contoso would say "Infinity plus one." </p>
<p> While those two programs are busy fighting over who gets the clicks, LitWare sneaks in and says, "I want to steal the clicks that those two companies are fighting over, so I can display <i>my</i> custom user interface instead." </p>
<p> The only way to win is not to play the game. There is no facility for intercepting balloon notifications or redirecting their clicks. The application which creates the balloon decides what the balloon says and what happens if the user clicks on it. If you want to alter the text or behavior of a balloon notification, you get to work with the developers of the application that is displaying the balloon and see if they are willing to give you a way to intercept their messages and clicks. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1094183">
				<div id="div-comment-1094183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094183">
			December 12, 2013 at 7:07 am</a>		</div>

		<p>I already imagined this and can see why it should exist.</p>
<p>1. Accessibility</p>
<p>2. Alternate shell</p>
<p>I don&#39;t see how these can be both possible w/o what was asked for here being possible. Last one to move wins though.</p>
<div class="post">[<em>Accessibility does not need to intercept clicks or modify static text. It reads the screen and generates clicks. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094193">
				<div id="div-comment-1094193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094193">
			December 12, 2013 at 7:17 am</a>		</div>

		<p>@Joshua: &quot;2. Alternate shell&quot;</p>
<p>I&#39;d love an alternate shell as much as the next person, but in this case I think Raymond gives a reasonably convincing case that providing an intercept mechanism (at least while explorer is active, e.g. if you wanted to do a thin wrapper around explorer) would compromise the experience of using the normal shell. And if you look at things at what makes the most people happy, supporting alternate shells doesn&#39;t come out looking so good.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman even thread-even depth-1" id="comment-1094203">
				<div id="div-comment-1094203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094203">
			December 12, 2013 at 7:29 am</a>		</div>

		<p>Joshua: &quot;Greetings, Professor Falken.&quot;</p>
<p>Stephen Falken: &quot;Hello, Joshua.&quot;</p>
<p>Joshua: &quot;A strange game. The only winning move is not to play. How about a nice game of chess?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094223">
				<div id="div-comment-1094223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094223">
			December 12, 2013 at 7:37 am</a>		</div>

		<p>I haven&#39;t been able to find documentation; however I suspect the wrapper is not very thin. I have reason to believe it&#39;s the entire desktop and taskbar.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094243">
				<div id="div-comment-1094243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094243">
			December 12, 2013 at 8:22 am</a>		</div>

		<p>Doesn&#39;t your scenario involve being on the other side of this airtight hatchway?</p>
<p>Not to mention it&#39;d be solved rather quickly by litigation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1094253">
				<div id="div-comment-1094253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094253">
			December 12, 2013 at 8:26 am</a>		</div>

		<p>The unanswered (or unasked) question is, of course, &quot;why do you want that?&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094263">
				<div id="div-comment-1094263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094263">
			December 12, 2013 at 8:36 am</a>		</div>

		<p>@Brian: litigation means nothing if the target of the litigation is from a foreign jurisdiction. Microsoft Windows is used in more than just the USA.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094273">
				<div id="div-comment-1094273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094273">
			December 12, 2013 at 8:42 am</a>		</div>

		<p>[Accessibility does not need to &#8230; modify static text. It reads the screen &#8230; -Raymond]</p>
<p>The ability to read the screen is the ability to know it&#39;s there. The ability to know it&#39;s there (for desktop applications) is the ability to overlay it. Some legit accessibility fixes do this.</p>
<div class="post">[<em>True, you could put something over it to steal the clicks. But that&#39;s different from the notification system designing in a feature to let people steal clicks. At that point, you know you&#39;re doing something bad. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094293">
				<div id="div-comment-1094293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094293">
			December 12, 2013 at 9:26 am</a>		</div>

		<p>But the answer is that you CAN do this. You inject into the process and Detour &quot;Shell_NotifyIcon&quot; so that you get the click when the balloon is shown and then call the &quot;real&quot; handler once you&#39;re done.</p>
<p>Then, if Litware wants to prevent Contoso from messing with the balloons &#8211; they just ACL their process so Contoso can&#39;t inject into their process. If the user then goes ahead and gives Contoso super-user privileges, well, it&#39;s the user&#39;s computer, they can do what they like.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094303">
				<div id="div-comment-1094303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Erbo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094303">
			December 12, 2013 at 11:04 am</a>		</div>

		<p>Perhaps you should just tell the customer, &quot;How would you like it if someone were able to intercept YOUR intercepts, and change the actions that you wanted taken when that balloon is clicked on? Because that&#39;s what would be enabled by the capability you&#39;re asking for.&quot;</p>
<p>Something like a &quot;Golden Rule&quot; for UI interactions: &quot;What you would not like if it were done to you, do not do to others.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094313">
				<div id="div-comment-1094313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094313">
			December 12, 2013 at 11:47 am</a>		</div>

		<p>@Erbo: &#8230; Golden Rule &#8230;: From reading most of these, they seem to come from either high-up or (occasionally) particularly clueless managers with too big an ego to be able to apply the Golden Rule, and given to some probably mediocre engineer who can&#39;t do it directly so uses the support contract they have with MS to ask the question.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1094323">
				<div id="div-comment-1094323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Escaper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094323">
			December 12, 2013 at 1:54 pm</a>		</div>

		<p>Why are we talking about intercepting notification balloons and not about other ways to interfere with someone else&#39;s application? There are many such ways in Windows I believe and intercepting balloons is quite exotic one among them. If we want to prevent such intervention, we should start with preventing processes from getting handlers to each other&#39;s windows. That is possible however, as far as I know.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094343">
				<div id="div-comment-1094343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094343">
			December 13, 2013 at 5:58 am</a>		</div>

		<p>Golden rule? &nbsp;That&#39;s not the world we live in. &nbsp;</p>
<p><a rel="nofollow" target="_new" href="http://www.dowling.edu/mydowling/tech/images/bb-TooManyToolbars.jpg">http://www.dowling.edu/&#8230;/bb-TooManyToolbars.jpg</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1094723">
				<div id="div-comment-1094723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094723">
			December 15, 2013 at 5:45 pm</a>		</div>

		<p>On the other hand, if I were writing &quot;Blade cluster&quot; like server solutions, is there supported way for me to redirect ALL notification balloons to our *super awesome* monitor console?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1094793">
				<div id="div-comment-1094793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20131212-00/?p=2393#comment-1094793">
			December 16, 2013 at 7:19 am</a>		</div>

		<p>That&#39;s what&#39;s accessibility scrapers are for.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

