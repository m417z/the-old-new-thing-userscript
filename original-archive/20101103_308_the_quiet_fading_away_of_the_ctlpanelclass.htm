<html>
<head>
<title>The quiet fading away of the CtlPanelClass</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>The quiet fading away of the CtlPanelClass</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 3, 2010 / year-entry #309</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>23</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">If you search MSDN for CtlPanelClass, you'll find a few really old Knowledge Base articles that include it in a list of "class names of common Windows applications." I'm not sure why the Knowledge Base articles bothered to list those classes; there is no technical reason for applications to need to know this, and including...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>If you search MSDN for <code>CtlPanelClass</code>, you'll find a few really old Knowledge Base articles that include it in a list of "class names of common Windows applications." I'm not sure why the Knowledge Base articles bothered to list those classes; there is no technical reason for applications to need to know this, and including the information merely encourages programmers to rely on the window class name in strange undocumented ways. (This is another one of those cases where <a href="http://blogs.msdn.com/oldnewthing/archive/2006/04/24/582152.aspx"> a Knowledge Base article written to assist in troubleshooting becomes interpreted as formal documentation</a>.)</p>
<p> Windows Vista finally got rid of that window class. It took only ten years. </p>
<p> The window class was used by the old Windows&nbsp;3.1 Control Panel application. Back in Windows&nbsp;3.1, the Control Panel was a standalone application and was not integrated into the shell namespace (in large part because there was no such thing as a shell namespace back then for it to be a part of). </p>
<p> There was one program which not only searched for a window of that specific class name, but it also sent the window <code>WM_COMMAND</code> messages, since of course it knew what the menu IDs were for the Control Panel application, and it knew that the Windows developers would never change the IDs or replace the standalone Control Panel application with anything else. </p>
<p> When the standalone Control Panel application was converted to a virtual folder, it also came with <a href="http://blogs.msdn.com/oldnewthing/archive/2006/01/09/510781.aspx"> some decoys</a> in order to maintain compatibility with older programs that relied on the old behavior in strange undocumented ways. </p>
<p> One of those decoys, the <code>CtlPanelClass</code> was removed for Windows Vista. A crash was traced back to a bug in the decoy window which manifested itself if a control panel took more than ten seconds to launch itself. To fix the bug, we just removed the decoy window, but we were prepared to write a compatibility shim in case there were people still running that ancient application from 1993. We didn't actually turn the compatibility shim on, but we were ready just in case. </p>
<p> We removed the decoy and crossed our fingers. </p>
<p> We got lucky. Nobody noticed. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (23)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-871163">
				<div id="div-comment-871163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chloraphil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871163">
			November 3, 2010 at 7:30 am</a>		</div>

		<p>Old classes never die, they just fade away</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871173">
				<div id="div-comment-871173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">R. Bemrose</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871173">
			November 3, 2010 at 7:37 am</a>		</div>

		<p>@chloraphil:</p>
<p>Old programs never die, either.</p>
<p>The first thing my father asked me to do when he got a new laptop with Windows 7 64-bit on it was to install Quicken 2000 Deluxe on it. &nbsp;Despite that Quicken has a new version every year.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-871183">
				<div id="div-comment-871183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871183">
			November 3, 2010 at 7:40 am</a>		</div>

		<p>Which shims can I turn on with registry flags?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871193">
				<div id="div-comment-871193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871193">
			November 3, 2010 at 7:56 am</a>		</div>

		<p>Holy crap, you&#39;d think by Vista you&#39;d have thrown out a lot of those compatibility hacks. I think a more sensible model to support old features would be supporting Windows XP forever, but charge users an exorbitant yearly license to keep the development team alive. Or simply provide support on demand, through third parties, or whatever. Just keeping all those hacks around adds a whole layer of crap to a perfectly sound codebase, that in many cases just introduces bugs for the benefit of 3 guys who want their oscilloscopes to run the latest Windows,</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-871203">
				<div id="div-comment-871203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">hakzor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871203">
			November 3, 2010 at 7:59 am</a>		</div>

		<p>@640k:</p>
<p>HKLMSoftwareMicrosftWindowsShimsImDuMb42FA9900</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871213">
				<div id="div-comment-871213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871213">
			November 3, 2010 at 8:05 am</a>		</div>

		<p>@david: that assumes that compat systems are needed by a small group of people all the time. &nbsp;In reality, they&#39;re needed by just about everyone, but only for a couple of applications. &nbsp;Not having the compat system would mean NOONE would be able to upgrade, because of a small number of things holding them back</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-871233">
				<div id="div-comment-871233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871233">
			November 3, 2010 at 8:08 am</a>		</div>

		<p>@david: &nbsp;Aas Raymond has said before, when uses upgrade their operating system, and applications stop working, who are they going to blame? &nbsp;Not the application vendor who used undocumented features taht dn&#39;t work any more. &nbsp;</p>
<p>Causing users pain to &quot;prove a point&quot; to application vendors is not helpful. &nbsp;Some of the application vendors might have gone out of business. &nbsp;And charging users a big license fee is probably not a workable model either, although it is an interesting thought&#8230;. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871253">
				<div id="div-comment-871253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871253">
			November 3, 2010 at 8:21 am</a>		</div>

		<p>Causing users pain to prove a point is helpful, if it&#39;s an appropriate amount of pain and doesn&#39;t actually prevent them from getting their work done.</p>
<p>Vista and Windows 7 already have this Action Center thing that sits in my taskbar and nags me because I&#39;ve dared to use Windows Update settings that prompt me before replacing code on my computer. &nbsp;Action Center also nags to submit error reports about blue screens of death and upgrade video drivers. (Unfortunately while it was correct about an outdated driver initially, because it tried to put 32-bit drivers on my 64-bit OS, I ended up doing the upgrade without Action Center&#39;s help and now it isn&#39;t smart enough to recheck the version. &nbsp;Oh well.) &nbsp;It seems to me that having an Action Center entry for &quot;Obtain updates for the following applications to improve Windows 7 compatibility: &lt;list all apps with active shims&gt;&quot; would be just the right amount of pain.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-871263">
				<div id="div-comment-871263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Henke37</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871263">
			November 3, 2010 at 9:13 am</a>		</div>

		<p>They have a shim to inflict pain on users, it shows a MessageWindow before the program loads with a notice about compatibility issues. And then it optionally prevents the program from being started.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-871283">
				<div id="div-comment-871283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871283">
			November 3, 2010 at 10:09 am</a>		</div>

		<p>&quot;We got lucky. Nobody noticed. &quot;</p>
<p>Well, keep in mind that 64-bit Windows does not support 16-bit apps at all anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-871353">
				<div id="div-comment-871353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871353">
			November 3, 2010 at 4:17 pm</a>		</div>

		<p>&quot;keep in mind that 64-bit Windows does not support 16-bit apps at all anyway&quot;</p>
<p>I&#39;m pretty sure Raymond HAS kept that in mind, given that someone invariably mentions it in the comments to every second post for some reason&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871373">
				<div id="div-comment-871373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871373">
			November 3, 2010 at 9:10 pm</a>		</div>

		<p>If Windows has a compatibility shim for your company&#39;s application, how do you determine what those shims are?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-zian even thread-even depth-1" id="comment-871383">
				<div id="div-comment-871383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Zian+Choy' rel='external nofollow' class='url'>Zian Choy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871383">
			November 3, 2010 at 9:47 pm</a>		</div>

		<p>@Myria</p>
<p>I&#39;m pretty sure the Windows SDK has something that lets you view existing shims.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-zian odd alt thread-odd thread-alt depth-1" id="comment-871393">
				<div id="div-comment-871393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Zian+Choy' rel='external nofollow' class='url'>Zian Choy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871393">
			November 3, 2010 at 9:48 pm</a>		</div>

		<p>@Myria</p>
<p>I&#39;m pretty sure the Windows SDK has something that lets you view existing shims.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-871413">
				<div id="div-comment-871413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Geary</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871413">
			November 3, 2010 at 11:00 pm</a>		</div>

		<p>I was helping a friend set up a new monitor on his Windows 7 system, and I noticed an antique-looking Office Quick Launch panel displayed at startup. I asked him and he old me, &quot;Oh, we have the latest Microsoft Office on here.&quot; I said, &quot;Office 2010? It doesn&#39;t look like that.&quot; He replied, &quot;No, it&#39;s Office 2007. Version 7.&quot;</p>
<p>I checked the About box and he was almost right &#8211; it is Version 7. Microsoft Office for Windows 95. Version 7. Only 15 years old.</p>
<p>Raymond, I&#39;d say you got lucky on this one! :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871423">
				<div id="div-comment-871423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Henke37</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871423">
			November 4, 2010 at 4:41 am</a>		</div>

		<p>@myria, I would assume that the application compatibility team is nice enough to give you a call before they release their hack set. That is, if you still exist at that point.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-871403">
				<div id="div-comment-871403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871403">
			November 3, 2010 at 10:25 pm</a>		</div>

		<p>@Myria You can use the Application Compatibility Toolkit[1], which actually gives you a bucket-load of info. Personally, I think all developers should run their software through ACT before release. It not only tells you what problems you&#39;re having *now* but also what problems you might run into in the future.</p>
<p>[1] <a rel="nofollow" target="_new" href="http://www.microsoft.com/downloads/en/details.aspx?displaylang=en&amp;FamilyID=24da89e9-b581-47b0-b45e-492dd6da2971" rel="nofollow">http://www.microsoft.com/&#8230;/details.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871433">
				<div id="div-comment-871433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">prunoki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871433">
			November 4, 2010 at 6:15 am</a>		</div>

		<p>@Michael Geary: and the most beautiful thing is that everyone takes it for granted that Office 95 should work on Windows 7. Me too. This shows the quality of work those application compatibility guys do. That is surely one thing why I use Win.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-871753">
				<div id="div-comment-871753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871753">
			November 5, 2010 at 8:26 am</a>		</div>

		<p>most win32s programs cannot even run on vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-871823">
				<div id="div-comment-871823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871823">
			November 5, 2010 at 10:41 am</a>		</div>

		<p>@640k: What do you mean and some examples would be good. (Win32s ??? like that thing for Win 3.11? There were apps targeting it?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-871833">
				<div id="div-comment-871833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-871833">
			November 5, 2010 at 10:41 am</a>		</div>

		<p>@640k: What do you mean and some examples would be good. (Win32s ??? like that thing for Win 3.11? There were apps targeting it?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-872303">
				<div id="div-comment-872303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-872303">
			November 8, 2010 at 3:12 pm</a>		</div>

		<p>freecell (win32s version)</p>
<p>btw, the blog software suck.</p>
<div class="post">[<i>The blog software doesn&#39;t like short comments. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-872363">
				<div id="div-comment-872363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">nobugz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101103-00/?p=12363#comment-872363">
			November 8, 2010 at 4:58 pm</a>		</div>

		<p>Awesome that you could drop it, bet it took a fair amount of knocking wood. &nbsp;Next candidate: ComboBoxEx. &nbsp;Just a personal pet peeve because it is documented and I always went &quot;jeez, what&#39;s the point&quot;.</p>
<p>From the other end: DirectUIHWND is starting to rub.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

