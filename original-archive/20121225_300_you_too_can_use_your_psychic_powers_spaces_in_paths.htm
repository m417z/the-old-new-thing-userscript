<html>
<head>
<title>You too can use your psychic powers: Spaces in paths</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>You too can use your psychic powers: Spaces in paths</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 25, 2012 / year-entry #301</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>29</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">I'm going to be lazy today and make you solve the problem. Did a recent security hotfix change change the way we handle UNC paths with spaces? Normally, if we open the Run dialog and type \\server\share\Support Library\, the Support Library folder opens. But recently it stopped working. Instead of opening the Support Library folder,...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p> I'm going to be lazy today and make you solve the problem. </p>
<blockquote class="q">
<p> Did a recent security hotfix change change the way we handle UNC paths with spaces? Normally, if we open the <i>Run</i> dialog and type <code>\\server\<wbr>share\<wr>Support Library\</wr></wbr></code>, the <code>Support Library</code> folder opens. But recently it stopped working. Instead of opening the <code>Support Library</code> folder, we get the <i>Open With</i> dialog: </p>
<table border="0" cellpadding="0" cellspacing="0" style="border-width: 2px; border-style: outset; width: 25em;               font-family: Segoe UI, Tahoma, Arial, sans-serif">
<tr style="background: activecaption; color: captiontext; padding: 2px">
<td><b>Open with</b></td>
<td align="right" valign="middle">     <button style="padding: 0px; margin: 2px">       </p>
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td><font face="Marlett"><!--[if IE]>r<![endif]-->&#61554;</font></td>
</tr>
</table>
<p>     </button></td>
</tr>
<tr style="height: 10em; background: threedface; color: buttontext">
<td colspan="2" style="padding: 1em">
<p>     Choose the program you want to use to open this file:     </p>
<p>     File: Support     </p>
<div style="background: window; color: windowtext;                 border-width: 2px; border-style: inset;                 height: 10em; width: 23em; overflow: auto">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td align="center"><font size="+3">&#9812;</font></td>
<td>&nbsp;</td>
<td>Contoso Chess Challenger 5.0</td>
</tr>
<tr>
<td align="center"><font size="+3">&#9835;</font></td>
<td>&nbsp;</td>
<td>Contoso Music Studio</td>
</tr>
<tr>
<td align="center"><font size="+3">&#9685;</font></td>
<td>&nbsp;</td>
<td>Fabrikam Chart 2.0</td>
</tr>
<tr>
<td align="center"><font size="+3">&#8466;</font></td>
<td>&nbsp;</td>
<td>Litware 2010</td>
</tr>
<tr>
<td align="center"><font size="+3">$</font></td>
<td>&nbsp;</td>
<td>Woodgrove Bank Online</td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&#9731;</font>         </td>
<td>&nbsp;</td>
<td>Happy Holidays!</td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
<tr>
<td align="center"><font size="+3">&nbsp;</font></td>
</tr>
</table>
</div>
<table border="0" cellpadding="0" cellspacing="0" style="padding: 1ex 0pt">
<tr>
<td valign="baseline"><input type="checkbox">&nbsp;</td>
<td valign="baseline">Always use the selected program to open this kind of file</td>
</tr>
</table>
<p align="right">     <button style="width: 12.5ex">Browse...</button>     </p>
<p align="right">     <button style="width: 12.5ex">OK</button>     &nbsp;     <button style="width: 12.5ex">Cancel</button>     </p>
</td>
</tr>
</table>
</blockquote>
<p> Can you figure out what happened recently that introduced this problem? You have all the information you need. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (29)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1028203">
				<div id="div-comment-1028203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028203">
			December 25, 2012 at 7:12 am</a>		</div>

		<p>A file named &quot;Support&quot; was created on &quot;share&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028213">
				<div id="div-comment-1028213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Denial ain't a river, bub</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028213">
			December 25, 2012 at 7:18 am</a>		</div>

		<p>Happy Holidays to you too, Raymond!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028223">
				<div id="div-comment-1028223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeffrey Davis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028223">
			December 25, 2012 at 7:24 am</a>		</div>

		<p>I like how the dialog box actually works. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028233">
				<div id="div-comment-1028233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jake</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028233">
			December 25, 2012 at 7:26 am</a>		</div>

		<p>A remote file named Support was added to the \servershare folder?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com even thread-even depth-1" id="comment-1028243">
				<div id="div-comment-1028243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028243">
			December 25, 2012 at 7:41 am</a>		</div>

		<p>^^ What alegr1 said and they didn&#39;t use quotes. :D P.S. I wish Windows 8 had the &#39;classic&#39; Open With dialog. The new Open With dialog (<a rel="nofollow" target="_new" href="http://3.bp.blogspot.com/-mosvJttBtH8/T1cC05T4vqI/AAAAAAAAAL4/E-iD6GSqxpU/s1600/Open+With.png" rel="nofollow">3.bp.blogspot.com/&#8230;/Open+With.png</a>) breaks the NoInternetOpenWith and NoFileAssociate Group Policies (due to another decision to remove programmatic file associations). It is a Metro-style floating dialog that looks out of place on the desktop. And browsing for a program not listed in it requires lots of clicks and scrolling and its keyboard usability is broken.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1028253">
				<div id="div-comment-1028253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028253">
			December 25, 2012 at 7:54 am</a>		</div>

		<p>The &quot;File: Support&quot; kind of gives the game away :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028263">
				<div id="div-comment-1028263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028263">
			December 25, 2012 at 8:11 am</a>		</div>

		<p>Butt out xpclient. We know the Windows shell is as good as dead but MS hasn&#39;t figured it out yet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com odd alt thread-odd thread-alt depth-1" id="comment-1028273">
				<div id="div-comment-1028273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028273">
			December 25, 2012 at 8:24 am</a>		</div>

		<p>@Joshua, I hope you&#39;re kidding. If the old Windows Shell was dead, there wouldn&#39;t any improvements to it in Windows 8 like Undo New Document or UAC overlay shield on taskbar pinned icons set to run as admin. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028283">
				<div id="div-comment-1028283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr&#237;guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028283">
			December 25, 2012 at 9:31 am</a>		</div>

		<p>Please don&#39;t feed the troll. Even if it (he) is almost a pet here :-) .</p>
<p>[Insert obligatory compliment about how good Raymond is recreating arbitrary dialog boxes in plain HTML]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028303">
				<div id="div-comment-1028303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Leo Davidson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028303">
			December 25, 2012 at 12:13 pm</a>		</div>

		<p>In this case, I think the real troll is the Windows 8 Open-With dialog. There are so many things wrong with it that it&#39;s difficult to know where to start, and hard to imagine it turned out so bad by accident. I honestly thought my Windows 8 install or VM drivers were malfunctioning the first time it appeared. :)</p>
<p>Merry Christmas, everyone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028323">
				<div id="div-comment-1028323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lawrence</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028323">
			December 25, 2012 at 1:35 pm</a>		</div>

		<p>I love it how when Raymond is claiming to be &#39;lazy&#39; he still creates a fully-functional dialog box that works across all browsers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028333">
				<div id="div-comment-1028333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chunky Ks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028333">
			December 25, 2012 at 4:23 pm</a>		</div>

		<p>Bonus point, how it happened: What probably happened is someone with write/create privileges tried to open that file in a program that doesn&#39;t understand spaces.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028343">
				<div id="div-comment-1028343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yasunori</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028343">
			December 25, 2012 at 4:51 pm</a>		</div>

		<p>The Windows 8 Open-with dialog really is a shocker.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028353">
				<div id="div-comment-1028353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bhind</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028353">
			December 25, 2012 at 5:06 pm</a>		</div>

		<p>it is not important,but&#8230;</p>
<p>&quot;Support&quot; file has no extension,so &quot;Always use the selected program to open this kind of file&quot; is grayed out,isn&#39;t it?</p>
<h1>happy holidays too!</h1>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028363">
				<div id="div-comment-1028363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">j b</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028363">
			December 25, 2012 at 5:45 pm</a>		</div>

		<p>Chunky Ks:</p>
<p>Note that \servershareSupport Library is a directory, not a file, and opening av &quot;Support Library&quot; directory (or one of the files in it) for write is a rather uncommon operation.</p>
<p>Nevertheless, your explanation may very well be the explanation of how the file came to life. (I probbly would never have thought of that myself!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028373">
				<div id="div-comment-1028373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alternate Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028373">
			December 25, 2012 at 6:06 pm</a>		</div>

		<p>Came to give props on the functional dialog boxes even in g-reader, but I see the topic was already covered. &nbsp;So let me just add in another. &nbsp;That&#39;s some top-notch blogging, Mr. Chen.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028383">
				<div id="div-comment-1028383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeffrey Bosboom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028383">
			December 25, 2012 at 8:53 pm</a>		</div>

		<p>It&#39;s a nice dialog box, but perhaps the &#39;Browse&#39; button could be hooked up to open a file chooser dialog?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028393">
				<div id="div-comment-1028393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028393">
			December 26, 2012 at 1:54 am</a>		</div>

		<p>@bhind: haven&#39;t used Windows for a while, but doesn&#39;t it hide file extensions by default? The &quot;Support&quot; file might in fact be &quot;Support.ext&quot;, but the &quot;.ext&quot; is hidden unless the user knew the secret incantation to disable hiding file extensions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028403">
				<div id="div-comment-1028403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028403">
			December 26, 2012 at 3:19 am</a>		</div>

		<p>So, I clicked on of the dialog &quot;buttons&quot; and now the site wants me to enter a comment&#8230; perhaps the buttons should have been given type=&quot;button&quot; (or perhaps type=&quot;reset&quot; in the case of the cancel button?) Nice use of Unicode characters in the &quot;listbox&quot; though.</p>
<p>@bhind: Good catch! The first thing I noticed was that it wasn&#39;t checked, because the first thing I do when I get the &quot;Open With&quot; dialog is to uncheck that option.</p>
<p>@Cesar: It&#39;s possible I guess, but it would have to be one of those rare known extensions without a handler. (And not including .DLL or .SYS either, as they prompt a special warning.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028413">
				<div id="div-comment-1028413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bhind</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028413">
			December 26, 2012 at 3:31 am</a>		</div>

		<p>(why doesn&#39;t my post show up?)</p>
<p>@Cesar,I thought so, but Explorer option is &quot;Hide extensions for known file types&quot;. if the extesion is hidden, we can&#39;t get Open With dialog.</p>
<p>I tried this(windwos 7).</p>
<ol>
<li>enable &quot;Hide extensions&#8230;&quot;</li>
<li>
<p>open command prompt.type &quot;echo aa &gt; test.ext&quot;</p>
</li>
<li>
<p>type &quot;start test.ext&quot;</p>
</li>
</ol>
<p>it shows filename with extension &quot;.ext&quot;.but&#8230; shows &quot;windows cannot open this file&quot; dialog&#8230;um why?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028453">
				<div id="div-comment-1028453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">grahamesd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028453">
			December 26, 2012 at 7:45 am</a>		</div>

		<p>So Windows thinks something is there. &nbsp;Yet we know that &quot;Support&quot; doesn&#39;t exist, it&#39;s just the first part of the folder or share name. &nbsp;Yet we didn&#39;t get the &quot;Windows cannot access &quot;\servershareSupport&quot; which is what I would have expected.</p>
<p>So I&#39;m guessing that the first step in responding to the Run request, the step of parsing the string &quot;\servershareSupport Library&quot; worked, because Windows didn&#39;t complain that &quot;Support&quot; wasn&#39;t accessible or that it didn&#39;t exist. so therefore it found something and the thing I&#39;m guessing it found was &quot;Support Library&quot;. &nbsp;</p>
<p>The next step is for Windows to figure out what to do with what it found. &nbsp;So the parsing by that step failed and instead of just opening the folder &quot;Support Library&quot;, it thought it had to open a resource called &quot;Support&quot; and it couldn&#39;t find an associated app (no association to no extension) so it brought up the &quot;Open With&quot; dialog so the user could decide.</p>
<p>So either the parsing on step 2 failed or step 1 screwed up the name when passing it to step 2.</p>
<p>That&#39;s my guess. &nbsp;I hope I&#39;m somewhere in the ballpark.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028503">
				<div id="div-comment-1028503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Falcon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028503">
			December 26, 2012 at 8:04 am</a>		</div>

		<p>@grahamesd: But we DON&#39;T know that &quot;Support&quot; doesn&#39;t exist &#8211; the question made no mention of that fact. Before such a file was created, Explorer found that it did not exist and continued the parsing process by treating the rest of the string (there are no more spaces until the end) as a path, found the &quot;Support Library&quot; folder and opened it. Then, one day, the &quot;Support&quot; file somehow got created, so Explorer tried to execute &quot;\servershareSupport&quot; with &quot;Library&quot; as an argument.</p>
<p>Maurits mentioned the &quot;File: Support&quot; clue in the dialog, which I initially missed, but managed to figure out the problem anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028543">
				<div id="div-comment-1028543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028543">
			December 26, 2012 at 9:01 am</a>		</div>

		<p>IMO, the Run dialog (and the ShellExecute/CreateProcess/etc APIs) should have just required quote marks around a filename with spaces in it, so it would never be ambiguous where the filename ends. I hate software that tries to be &quot;smart&quot; and does what it thinks I want (unpredictably), rather than just doing what I say (predictably).</p>
<div class="post">[<em>In other words, &quot;IMO, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/06/23/431876.aspx" rel="nofollow">Windows NT should have been allowed to fail</a> with the consolation that it was able to maintain its purity of design all the way to the grave. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028553">
				<div id="div-comment-1028553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Yates</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028553">
			December 26, 2012 at 9:57 am</a>		</div>

		<p>I&#39;ve caused this problem myself in the same sort of folder (a share where I stick all of my various downloads). &nbsp;I want to download a new SQL cumulative update and store it on my NAS at \domain.localdatadownloadsSQL Server2012RTMCU4 (DFS shares rock!)</p>
<p>Note the sapce in &quot;SQL Server&quot;.</p>
<p>Rather than browse there in IE&#39;s &quot;save as&quot; box, I just hit Win+R and type cmd (ie, bring up a command prompt) and then type &quot;md &quot; followed by the path I wanted to make (pasting it in usually). &nbsp;If I forget the quotes, I make a folder called &quot;SQL&quot; in the downloads share PLUS another folder tree starting with Server, then a nested folder in there called 2012, etc.</p>
<p>This is all so I can then paste the same path into IE&#39;s save as window and hit enter. &nbsp;It sounds long-winded but it&#39;s actually quite fast and all keyboard based. &nbsp;I usually use Win+R&#39;s textbox as the scratch space to populate the clipboard with the path I want so I can paste it into the just-created command prompt and also into IE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028703">
				<div id="div-comment-1028703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Don Benson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028703">
			December 26, 2012 at 5:21 pm</a>		</div>

		<p>Did somebody create a runnable file called &quot;support&quot; in the share folder? Now &quot;library&quot; is interpreted as a command line argument.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chris-j-leonard odd alt thread-odd thread-alt depth-1" id="comment-1028833">
				<div id="div-comment-1028833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Veltas' rel='external nofollow' class='url'>Veltas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028833">
			December 27, 2012 at 11:23 am</a>		</div>

		<p>Oh dear, I&#39;ve been relying on Run getting the spaces right without thinking about the ambiguity for years. &nbsp;Then again, whenever I type something without quotes the first thing I check if there is an error is the quotes not being there.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028923">
				<div id="div-comment-1028923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028923">
			December 27, 2012 at 8:54 pm</a>		</div>

		<p>@Jeff: A big part of the problem is that the original kernel interface (harking back to the days of WinExec) accepted the command line as a single flat string instead of an array of strings, like Unix&#39;s argc/argv in the execve(2) interface. &nbsp;With a string array, the kernel never has to do any parsing because there&#39;s no possibility of ambiguityâ€”if a program wants to start another program with a space in an argument, then by golly it puts a space in that argument.</p>
<p>But that decision to pass the command line as a single string was set in stone a long time ago, and until Microsoft perfects its time machine, we&#39;re stuck with it. &nbsp;As Raymond said, the pragmatic thing to do for backwards compatibility&#39;s sake is to have the kernel parse the command line in more than one way until it finds a matching executable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1028933">
				<div id="div-comment-1028933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NT</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028933">
			December 27, 2012 at 9:26 pm</a>		</div>

		<p>Since last time it worked, someone created the file &quot;\servershareSupport&quot;, possibly by doing something careless like (unquoted) &quot;copy foo.bar \servershareSupport Library&quot; in the shell.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1028943">
				<div id="div-comment-1028943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121225-00/?p=5743#comment-1028943">
			December 28, 2012 at 4:36 am</a>		</div>

		<p>@Adam: The kernel doesn&#39;t do any parsing of your command line string. All of that parsing nonsesnse is done by libraries in user mode.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

