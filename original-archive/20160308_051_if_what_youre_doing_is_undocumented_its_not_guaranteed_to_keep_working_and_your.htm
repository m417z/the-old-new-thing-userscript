<html>
<head>
<title>If what you're doing is undocumented, it's not guaranteed to keep working, and your promise not to complain doesn't really hold water</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>If what you&#8217;re doing is undocumented, it&#8217;s not guaranteed to keep working, and your promise not to complain doesn&#8217;t really hold water</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 8, 2016 / year-entry #52</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>13</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Because that's what undocumented implies.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer (via their customer liaison) wanted to know how their
application can control another application's common dialogs.
</p>
<blockquote CLASS="q"><p>
They have code that works on Windows XP that extracts the
common dialog history from an undocumented registry key,
then edits the history in order to inject themselves into it.
It all works great.
But on Windows 7, the structure of this registry key changed,
and they cannot figure out how to reimplement the feature.
Can you tell us where Windows 7 stores this information,
and how to decode it,
and how to re-encode the desired replacement data?
Thanks!
</p>
</blockquote>
<p>
The feature you desire is not supported.
Mucking about in undocumented registry keys is not supported.
The implementation can change at any time,
and as your customer noticed,
<i>it did</i>.
</p>
<p>The customer liaison replied,
</p>
<blockquote CLASS="q"><p>
Yes, I was afraid that this was the case.
But maybe somebody can tell us how to do it anyway.
I have already told the customer that what they are doing
is unsupported and can change at any time.
I can provide a strong warning that this is
something they should not be doing.
</p>
</blockquote>
<p>
I replied,
"The strong warning didn't help last time,
when they complained that their trick stopped
working in Windows 7.
There's no indication that they won't complain
again when they test on Windows 8 and found
that the keys changed <i>again</i>."
</p>
<p>
The customer liaison conceded,
"Good point."</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-wndsks even thread-even depth-1 parent" id="comment-1229291">
				<div id="div-comment-1229291" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229291">
			March 8, 2016 at 7:22 am</a>		</div>

		<p>While I can see how this could be useful if these applications complimented each other (SVG and Bitmap editors etc) but odds are that they are doing this for other reasons and that is pure evil. Too bad you have the naming policy because some apps deserve to be called out.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fredericmagnyf odd alt depth-2" id="comment-1229301">
				<div id="div-comment-1229301" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229301">
			March 8, 2016 at 8:01 am</a>		</div>

		<p>Indeed, this sounds like &#8220;bonus for that feature&#8221; material.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1229303">
				<div id="div-comment-1229303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://programmerman.net/' rel='external nofollow' class='url'>Nick</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229303">
			March 8, 2016 at 9:15 am</a>		</div>

		<p>Pretty sure the Official AnswerÂ® is to call the Other Application&#8217;s creator and ask how to control their common dialogs (and be told some strong version of &#8220;no&#8221;).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1229312">
				<div id="div-comment-1229312" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229312">
			March 8, 2016 at 9:23 am</a>		</div>

		<p>Huge proxy fight. I wonder what the response might be if presented with choice of abuse undocumented behavior or leave Windows.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-alexcohn even depth-2" id="comment-1229331">
				<div id="div-comment-1229331" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229331">
			March 8, 2016 at 1:12 pm</a>		</div>

		<p>I am afraid that it will be much harder to control common dialogs of a third-party Windows application from an app running under some alternative OS.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1229332">
				<div id="div-comment-1229332" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229332">
			March 8, 2016 at 5:46 pm</a>		</div>

		<p>As a coincidence, a few years ago I actually implemented my variant of the file dialog in Windows 98 then Win2K then XP with history for directories (and also folder select dialog with history). File dialog used custom template. It&#8217;s been a pain to keep them compatible.<br />
I haven&#8217;t have time to make it working with latest MFC because the latest MFC  relies on the new file dialog API.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1229351">
				<div id="div-comment-1229351" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229351">
			March 8, 2016 at 11:23 pm</a>		</div>

		<p>I suppose the correct answer would be that the functionality is unsupported, but Microsoft would really, really like to help if only they would describe the reason for doing so more clearly and explicitly. We assume the best of intentions, but if it should turn out to be unsupported or even illegal activity, then Microsoft can&#8217;t very well help, now can it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1229354">
				<div id="div-comment-1229354" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scarlet Manuka</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229354">
			March 9, 2016 at 12:08 am</a>		</div>

		<p>Surely it is only a matter of time before a malware author contacts their customer liaison to complain that the exploit they were using has been patched, and asking for another method they can use to achieve remote code execution.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong even depth-2" id="comment-1229361">
				<div id="div-comment-1229361" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229361">
			March 9, 2016 at 12:18 am</a>		</div>

		<p>I think if they&#8217;re not able to find one themselves, they pay for others for one.</p>
<p>I heard there&#8217;s market on this sort of things on those hacker sites, but never go and confirm myself. :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1229553">
				<div id="div-comment-1229553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://nbtparse.org' rel='external nofollow' class='url'>Kevin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229553">
			March 9, 2016 at 11:08 pm</a>		</div>

		<p>I am 99% certain there is at least one script kiddie who was dumb enough to do exactly that.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-raykoopa even thread-even depth-1" id="comment-1229363">
				<div id="div-comment-1229363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ray+Koopa' rel='external nofollow' class='url'>Ray Koopa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229363">
			March 9, 2016 at 1:36 am</a>		</div>

		<p>That&#8217;s just pure lazyness right away. Since Windows 7, there&#8217;s a custom section for program-specific links in the open/save dialogs at the very top of the explorer tree where their cheap program could throw its own interesting locations in.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1229364">
				<div id="div-comment-1229364" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1229364">
			March 9, 2016 at 6:56 am</a>		</div>

		<p>We can go further: the implementation can change at any time, not only on major upgrades (XP -&gt; 7 is a major upgrade).</p>
<p>It could change on a minor upgrade (SP1 -&gt; SP2 for instance). It could change on a small patch (KBnnnnnn&#8230;). It could even change with no upgrade at all! For instance, the history they are meddling with might be a cache which can randomly be discarded and regenerated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1230564">
				<div id="div-comment-1230564" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pierre</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20160308-00/?p=93123#comment-1230564">
			March 16, 2016 at 10:50 am</a>		</div>

		<p>Win RT: the OS/2 of the 21st century.</p>
<p>BTW you don&#8217;t accept suggestions anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

