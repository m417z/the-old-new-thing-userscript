<html>
<head>
<title>Fixups are not the same as rewriting code, they're just fixups</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Fixups are not the same as rewriting code, they&#8217;re just fixups</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 5, 2009 / year-entry #72</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>18</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Classically speaking, a linker cannot rewrite the code the compiler generated; its job is merely to resolve symbols. Of course, resolving symbols means that references to those symbols in the code generated by the compiler turn from "I don't know" to "Here it is." Somebody named George appeared to be confused by this, believing that...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Classically speaking, a linker cannot rewrite the code the compiler generated; its job is merely to resolve symbols. Of course, resolving symbols means that references to those symbols in the code generated by the compiler turn from "I don't know" to "Here it is." Somebody named George <a href="http://groups.google.com/groups?selm=2EAD77B3-CB96-4FB7-9019-70D272D4B65B%40microsoft.com"> appeared to be confused by this</a>, believing that all changes by the linker counted as "rewriting code."</p>
<p> Obviously if the linker weren't allowed to change anything at all, there wouldn't be much point to having a linker. For example, you wouldn't be able to access functions or variables in a separate compilation unit (for example, from a library) because the compiler doesn't know what the final address is; that's what the linker is supposed to figure out. (Indeed, if <a href="http://msdn2.microsoft.com/en-us/library/xsa71f43.aspx"> function-level linking</a> is enabled, then even calls within a compilation unit are left as <i>insert address here</i>.) The linker resolves symbols and patches up code references that used to say <i>insert address here</i> so that they contain the actual address. </p>
<p> I think George took my statement a bit too literally. The linker can't change a direct call to an indirect call; that's not something that the compiler told the linker how to do. All the linker can do is patch up <i>insert address here</i> fixups. It can't say "Oh, I'm going to take your two <code>mov</code> instructions and reverse the destination registers, and then flip the arguments to the subsequent <code>sub</code> instruction." (I'm talking about classical linking; the introduction of <a href="http://msdn.microsoft.com/msdnmag/issues/02/05/Hood/"> link-time code generation</a> further blurs the line between the compiler and the linker.) </p>
<p> George also made the common mistake not only of calling this Web site a "document from MSDN" but also applying the same description to a <i>Microsoft Systems Journal</i> article from 1997. The back issues of MSJ are included in MSDN as a courtesy. Neither the back issues nor the contents of this Web site are under MSDN editorial control. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (18)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-713803">
				<div id="div-comment-713803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713803">
			March 5, 2009 at 10:27 am</a>		</div>

		<p>The first thing I thought of when I read the title was the &quot;report&quot; that 60% of the code in Windows Vista was going to be rewritten. &nbsp;The next thing I thought of was the perception that Windows 7 is just a fixup of Windows Vista.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-713813">
				<div id="div-comment-713813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt [C++ MVP]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713813">
			March 5, 2009 at 10:32 am</a>		</div>

		<p>Or more simply, immediate mode operands aren&#8217;t code, they&#8217;re data (albeit inside the text segment which is marked executable).</p>
<p>As a related aside, if/when this data is interpreted as code (i.e. instruction pointer is mid-instruction) bad things happen. &nbsp;Unless some hacker over-enthused with efficiency and code obfuscation designed it that way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-713833">
				<div id="div-comment-713833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dog</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713833">
			March 5, 2009 at 11:46 am</a>		</div>

		<p>&gt; George also made the common mistake not only of calling this Web site a &#8220;document from MSDN&#8221;</p>
<p>Erm, Raymond, in case you haven&#8217;t noticed, the URL of this website is &#8220;<a href="http://blogs.msdn.com/oldnewthing%22" target=_new rel=nofollow rel="nofollow"></a><a href="http://blogs.MSDN.com/oldnewthing" rel="nofollow">http://blogs.MSDN.com/oldnewthing</a>&#8220; and it says &#8220;Welcome to MSDN Blogs&#8221; at the top of the page. While clearly this blog is not part of the &#8220;MSDN Library&#8221; it is branded as part of MSDN, so calling it a &#8220;document from MSDN&#8221; is not inaccurate.</p>
<div class=post>[<i>Then it depends what you mean by &#8220;from MSDN&#8221;. If you mean &#8220;from a Web site that has MSDN in its URL&#8221; then, well, that could be anything. (Besides, the MSDN Web site isn&#8217;t even msdn.com; it&#8217;s msdn.microsoft.com.) I prefer to think of it as meaning &#8220;from a Web site that MSDN has editorial control over.&#8221; Otherwise, you could say that all of social.msdn.microsoft.com is &#8220;from MSDN.&#8221; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-713843">
				<div id="div-comment-713843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713843">
			March 5, 2009 at 12:05 pm</a>		</div>

		<p>Remember kids, there&#8217;s no such thing as a stupid question, unless your question involves Raymond. &nbsp;Then you should be prepared to be mocked publicly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-713853">
				<div id="div-comment-713853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">arousedboat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713853">
			March 5, 2009 at 12:39 pm</a>		</div>

		<blockquote><p>
  &#8230;no such thing as a stupid question&#8230;
</p></blockquote>
<p>It wasn&#8217;t so much a stupid question as a rather poor assumption that something that is obviously a blog should bear any sort of credibility.</p>
<p>I love Raymond&#8217;s blog. Most of the stuff he posts to it is factual or at least insightful. But it is still a blog. It is not written by a professional doc writer. It is not peer reviewed.</p>
<p>This should be pretty obvious.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-713863">
				<div id="div-comment-713863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">msdn != msdn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713863">
			March 5, 2009 at 12:48 pm</a>		</div>

		<p>Why isn&#8217;t msdn associated with msdn.com? Which department owns the msdn.com domain?</p>
<div class=post>[<i>The MSDN folks have nothing to do with running msdn.com. The blogging folks set it up behind their backs in order to have a catchy name for their site. Bloggers are renegades. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-713873">
				<div id="div-comment-713873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713873">
			March 5, 2009 at 1:18 pm</a>		</div>

		<p>Raymond: &quot;The MSDN folks have nothing to do with running msdn.com.&quot;</p>
<p>Might be. But, how should the average John Doe find out about this? As already mentioned, on the top, there is &quot;Welcome to MSDN Blogs&quot;, and at the bottom, there is &quot;&#169; 2009 Microsoft Corporation. All rights reserved.&quot;</p>
<p>I think you are asking too much from the average user, especially if that one does not read here regularly and only stumbled upon your posting via a $SEARCHENGINE search.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-713883">
				<div id="div-comment-713883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">arousedboat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713883">
			March 5, 2009 at 1:30 pm</a>		</div>

		<blockquote><p>
  &#8230;how should the average John Doe find out about this?&#8230;
</p></blockquote>
<p>The word &quot;Blogs&quot; should probably tip you off.</p>
<p>Would you cite information on someone&#8217;s MySpace page as some sort of inside information on Fox Interactive Media just because &quot;myspace&quot; appears in the URL and the page is branded with MySpace logos and legal text?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-713893">
				<div id="div-comment-713893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713893">
			March 5, 2009 at 1:36 pm</a>		</div>

		<p>It&#8217;s all so clear to me now. &nbsp;Raymond is pissed off all the time because PEOPLE ARE IDIOTS!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-713923">
				<div id="div-comment-713923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.tapuchim.com' rel='external nofollow' class='url'>configurator</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713923">
			March 5, 2009 at 2:36 pm</a>		</div>

		<blockquote><p>
  Would you cite information on someone&#8217;s MySpace page as some sort of inside information on Fox Interactive Media just because &quot;myspace&quot; appears in the URL and the page is branded with MySpace logos and legal text?
</p></blockquote>
<p>Of course!</p>
<p>Also, on this very page, Microsoft claimed that &quot;people are idiots&quot;. I find that very offensive and would like a formal apology from Microsoft.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-713943">
				<div id="div-comment-713943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713943">
			March 5, 2009 at 3:31 pm</a>		</div>

		<p>I would say the original poster is not off base in his assumption that everything printed here is &quot;from MSDN&quot;. &nbsp;This blog is part of the Microsoft Developer Network. &nbsp;It is a network (or collection) of resources, which includes Web sites that have documentation and other content. &nbsp;</p>
<p>Why should the OP care who has &quot;editorial control&quot; over some of the content, and which parts are not &quot;editorially controlled&quot; by some group of people that Raymond claims he is not part of? &nbsp;(Yes, I know, you would not be a member of any club that would accept you as a member&#8230;)</p>
<p>I would go so far as to claim that Raymond himself is a resource that is part of the network (or collection) of resources that developers use. &nbsp;Hence, Raymond is part of MSDN! &nbsp;:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-713953">
				<div id="div-comment-713953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713953">
			March 5, 2009 at 4:35 pm</a>		</div>

		<p>Sorry, we shouldn&#8217;t lose sight of the intent of the original article. &nbsp;Fixups are not the same as rewriting code. &nbsp; :[)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-713973">
				<div id="div-comment-713973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-713973">
			March 5, 2009 at 5:15 pm</a>		</div>

		<blockquote><p>
  you could say that all of social.msdn.microsoft.com is &quot;from MSDN.&quot;
</p></blockquote>
<p>I could and I will.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-714013">
				<div id="div-comment-714013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jolyon Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-714013">
			March 5, 2009 at 7:15 pm</a>		</div>

		<p>Of course no-one is going to think that any/all content on MySpace comes from Fox, because most people know that MySpace is just a medium through which any number of people communicate with the world.</p>
<p>Similarly, in the tech world, most people know that MSDN is (ostensibly) a Microsoft community.</p>
<p>The site is branded &quot;MSDN&quot;. &nbsp;It is copyright &quot;Microsoft&quot;. &nbsp;The &quot;Terms of Use&quot;, &quot;Trademarks&quot; and &quot;Privacy Statement&quot; links ALL refer visitors to OFFICIAL Microsoft pages (Terms of Use referring specifically to the actual, Microsoft MSDN &quot;Terms of Use&quot;).</p>
<p>It really is NOT surprising that someone might think that this blog is an MSDN product, directly or indirectly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-714033">
				<div id="div-comment-714033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lawrence@paradicesoftware.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-714033">
			March 6, 2009 at 12:18 am</a>		</div>

		<p>Regarding George&#8217;s actual question, he no doubt comes from a background where a Linker is not something that you see everyday. (he could be used to Visual Basic, Delphi, lots of things). So his original problem is completely forgivable.</p>
<p>But where he loses his way is in treating something with &quot;blog&quot; in the URL as official documentation. The MySpace example above is a good one, and saying &quot;Most people know what Myspace is&quot; is not a defense (most people visiting this site know what a blog is).</p>
<p>Saying that, if I was Raymond, I would probably try to get something added somewhere that says &quot;this blog is NOT for beginners!&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-714063">
				<div id="div-comment-714063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-714063">
			March 6, 2009 at 10:15 am</a>		</div>

		<p>Paradice, &quot;not actually to establish a blogging point where individuals can enrich their learns on facilitating and leveraging .NET-related activities most effectively&quot; should&#8217;ve communicated that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-714143">
				<div id="div-comment-714143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-714143">
			March 6, 2009 at 12:11 pm</a>		</div>

		<p>The link to George&#8217;s post is broken now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-714283">
				<div id="div-comment-714283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://K.Hagan@thermoteknix.com' rel='external nofollow' class='url'>Ken Hagan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090305-00/?p=18933#comment-714283">
			March 7, 2009 at 5:52 am</a>		</div>

		<p>Since this whole discussion appears to revolve around what you mean by &quot;re-write&quot; (or &quot;MSDN&quot;), perhaps I should insert some confusion over &quot;linker&quot;.</p>
<p>/LTCG anyone?</p>
<p>Raymond&#8217;s comments are perfectly true for a traditional compiler/linker separation of powers, but Microsoft&#8217;s own offering in this area hasn&#8217;t /really/ worked that way for many years. That&#8217;s where George went wrong. He has a mental model of his tools that is a decade or two out of date.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

