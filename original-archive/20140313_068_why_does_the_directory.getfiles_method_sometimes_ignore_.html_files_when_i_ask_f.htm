<html>
<head>
<title>Why does the Directory.GetFiles method sometimes ignore *.html files when I ask for *.htm?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why does the Directory.GetFiles method sometimes ignore *.html files when I ask for *.htm?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 13, 2014 / year-entry #69</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>68</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">The documentation for the Directory.Get­Files method says When using the asterisk wildcard character in a search­Pattern, such as "*.txt", the matching behavior when the extension is exactly three characters long is different than when the extension is more or less than three characters long. A search­Pattern with a file extension of exactly three characters returns...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>The <a href="http://msdn.microsoft.com/en-us/library/ms143316(v=vs.110).aspx"> documentation for the <code>Directory.<wbr>Get&shy;Files</wbr></code> method</a> says</p>
<blockquote class="q"><p> When using the asterisk wildcard character in a <i>search&shy;Pattern</i>, such as "*.txt", the matching behavior when the extension is exactly three characters long is different than when the extension is more or less than three characters long. A <i>search&shy;Pattern</i> with a file extension of exactly three characters returns files having an extension of three or more characters, where the first three characters match the file extension specified in the <i>search&shy;Pattern</i>. A <i>search&shy;Pattern</i> with a file extension of one, two, or more than three characters returns only files having extensions of exactly that length that match the file extension specified in the <i>search&shy;Pattern</i>. When using the question mark wildcard character, this method returns only files that match the specified file extension. For example, given two files, "file1.txt" and "file1.txtother", in a directory, a search pattern of "file?.txt" returns just the first file, while a search pattern of "file*.txt" returns both files. </p>
</blockquote>
<p> A customer reported that one of their programs stopped working, and they traced the problem to the fact that a search for <code>*.htm</code> on some machines was no longer return files like <code>awesome.html</code>, contrary to the documentation. What's going on? </p>
<p> What's going on is that the documentation is trying too hard to explain an observed behavior. (My guess is that some other customer reported the behavior, and the documentation team incorporated the customer's observations into the documentation without really thinking it through.) </p>
<p> The real issue is that the <code>Get&shy;Files</code> method matches against both short file names and long file names. If a long file name has an extension that is longer than three characters, the extension is truncated to form the short file name. And it is that short file name that gets matched by <code>*.htm</code> or <code>*.txt</code>. </p>
<p> Even as originally written, in the presence of short file names, the documentation is wrong, because it would imply that a search for <code>reallylong*.txt</code> could match <code>reallylong_filename.txtother</code>. But try it: It doesn't. That's because the short name is probably <code>REALLY~1.TXT</code>, and that doesn't match <code>reallylong*.txt</code>. </p>
<p> What happened is that short file name generation was disabled on the drive at the time the files were created, so there was no short file name available, so there was consequently no <code>SHORTN~1.HTM</code> file to match against. </p>
<p> The documentation should really say something more like this: </p>
<blockquote class="q"><p> Because this method checks against file names with both the 8.3 file name format (if available) and the long file name format, a search pattern like "*.txt" may return unexpected results. For example, the file <code>longfilename.txtother</code> may be returned if the short file name for the file is <code>LONGFI~1.TXT</code>. </p>
</blockquote>
<p> <b>Update</b>: It looks like the documentation has added my alternate remarks, but they kept the original misleading remarks as well, so now it's double-confusing. And to make things even more confusing, the original misleading remark has been made <i>even more misleading</i> in the part where it talks about question marks overriding the three-character rule. This is another failed attempt to explain observed behavior. If you search for "file?.txt", it will not match "file1.txtother". But the reason is not that the question mark overrides the three-character rule. The reason is that the short name for "file1.txtother" is "FILE1~1.TXT", and the question mark matches only one character. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (68)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1112083">
				<div id="div-comment-1112083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112083">
			March 13, 2014 at 7:09 am</a>		</div>

		<p>I use this &quot;feature&quot; routinely. For example, whenever I need to find an Excel file and don&#39;t know whether it&#39;s .XLS or .XLSX, I just search for *.XLS and I find it either way.</p>
<p>I can&#39;t imagine writing code to rely on it, though. How could a person write documentation that describes the behavior in such detail and not think that there must be something wrong. Surely they didn&#39;t think somebody intentionally designed a system where only in certain circumstances an extension of exactly 3 characters is supposed to find extensions of 3 or more characters!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112093">
				<div id="div-comment-1112093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NIck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112093">
			March 13, 2014 at 7:21 am</a>		</div>

		<p>Looks like your changes have been added to the documentation and the original essay removed :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112113">
				<div id="div-comment-1112113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RP7</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112113">
			March 13, 2014 at 7:34 am</a>		</div>

		<p>@Nick,</p>
<p>Not when I visit. &nbsp;I see both the original incorrect note as well as an extra note which says some but not all of what Raymond is saying. &nbsp;The statement that using &quot;?&quot; forces an exact match on file extensions is simply wrong, but you can see how they came up with it. &quot;Test?.txt&quot; won&#39;t match &quot;test1.txtother&quot;. &nbsp;But &quot;test??.txt&quot; will.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112133">
				<div id="div-comment-1112133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112133">
			March 13, 2014 at 7:48 am</a>		</div>

		<p>So much for .NET&#39;s portability. &nbsp;For actually accurate results, one still has to filter out what Directory.GetFiles returns. &nbsp;And this is a core class, not e.g. WinForms.</p>
<p>@NIck, but they forgot to update Directory.GetFileSystemEntries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112143">
				<div id="div-comment-1112143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick (a different one)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112143">
			March 13, 2014 at 7:53 am</a>		</div>

		<p>@640k: Sure, disable short name generation. Otherwise, longfilename.txtother is also named longfi~1.txt (or whatever prefix). Or skip using the match pattern on Directory.GetFiles, write your own .Where() clause, and turn it back into an array (Directory.GetFiles(path).Where(f =&gt; f.ToLower().EndsWith(&quot;.txt&quot;)).ToArray()).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1112153">
				<div id="div-comment-1112153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112153">
			March 13, 2014 at 7:54 am</a>		</div>

		<p>Short names need to go away. Should be disabled by default. Nobody cares anymore. If some retarded enterprise runs some retarded program, just load a virtual XP.</p>
<div class="post">[<em>News flash: There are <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/03/01/82103.aspx">a lot of retarded enterprises with retarded programs out there</a>. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112173">
				<div id="div-comment-1112173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Henke37</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112173">
			March 13, 2014 at 8:00 am</a>		</div>

		<p>Fun fact: As already covered, the file system is responsible for deciding what the short name is for a long name. Not all file systems do it the same way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-bboorman odd alt thread-odd thread-alt depth-1" id="comment-1112183">
				<div id="div-comment-1112183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112183">
			March 13, 2014 at 8:01 am</a>		</div>

		<p>@Raymond: &quot;The documentation should really say something more like this&#8230;&quot;</p>
<p>Perhaps this is a good application of the mantra &quot;Be somebody&quot; <a href="http://blogs.msdn.com/b/oldnewthing/archive/2011/01/18/10116870.aspx" rel="nofollow" target="_new">blogs.msdn.com/&#8230;/10116870.aspx</a></p>
<div class="post">[<em>I was somebody already. That&#39;s how the second note got there. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112193">
				<div id="div-comment-1112193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RaceProUK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112193">
			March 13, 2014 at 8:18 am</a>		</div>

		<p>@John Doe: In this case, .NET is at the mercy of the underlying OS/filesystem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1112203">
				<div id="div-comment-1112203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112203">
			March 13, 2014 at 8:56 am</a>		</div>

		<p>[News flash: There are a lot of retarded enterprises with retarded programs out there. -Raymond]</p>
<p>Yep. And, all these 10 years since your link (or 11?), they&#39;re still running Windows XP. Why does Microsoft want to kill its support, then?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1112213">
				<div id="div-comment-1112213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112213">
			March 13, 2014 at 8:58 am</a>		</div>

		<p>[News flash: There are a lot of retarded enterprises with retarded programs out there. -Raymond]</p>
<p>That link is a bad example, because MS doesn&#39;t even support 16 bit programs in the server SKU (and the client 64 bit SKU) anymore.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112243">
				<div id="div-comment-1112243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112243">
			March 13, 2014 at 9:48 am</a>		</div>

		<p>Really reminds me of some &quot;This bug cannot be fixed because it would break existing code&quot; discussions&#8230; (And yes, I&#39;ve had them. 10 year old obvious bugs that MUST not be fixed&#8230;)</p>
<p>Honestly: At some point you have to draw a line. Short file-names are a thing of the 16-bit area. Windows 7 (x64) doesn&#39;t support 16-bit applications anymore. So why are we still talking about short file-names?</p>
<div class="post">[<em>Because there are 32-bit applications which rely on short file names (often by accident). Just look at all the PROGRA~1 entries in your registry. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1112253">
				<div id="div-comment-1112253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112253">
			March 13, 2014 at 9:49 am</a>		</div>

		<p>I assume searchPattern is just handed to FindFirstFile? If so I would like to see all of the searchPattern remarks go away and be replaced with a &quot;see FindFirstFile&quot; link.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112263">
				<div id="div-comment-1112263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112263">
			March 13, 2014 at 9:58 am</a>		</div>

		<p>I personally think it&#39;s retarded that .NET&#39;s find files doesn&#39;t pass FindExInfoBasic to FindFirstFileEx but it wasn&#39;t available at the time. FindFirstFile&#39;s wildcard expansion is getting really long in the tooth anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-zlynx even thread-even depth-1" id="comment-1112273">
				<div id="div-comment-1112273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Zan+Lynx%27' rel='external nofollow' class='url'>Zan Lynx'</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112273">
			March 13, 2014 at 10:50 am</a>		</div>

		<p>I&#39;ve been disabling short file names on my home-built systems since Vista. So if there have been programs using PROGRA~1 in the registry, they haven&#39;t been working. And I haven&#39;t missed them. Perhaps it has been saving me from useless programs that like to run on user login.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1112283">
				<div id="div-comment-1112283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112283">
			March 13, 2014 at 11:02 am</a>		</div>

		<p>[Just look at all the PROGRA~1 entries in your registry. -Raymond]</p>
<p>Those programs would not work with legacy non-English OS, anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112293">
				<div id="div-comment-1112293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112293">
			March 13, 2014 at 11:28 am</a>		</div>

		<p>&gt; News flash: There are a lot of retarded enterprises with retarded programs out there.</p>
<p>&gt; -Raymond</p>
<p>Most of Windows users dont use those retarded programs!</p>
<p>You dont need to cripple Windows for ALL users just to support some braindead retards.</p>
<p>And: 64-bit applications MUST support &quot;long filenames&quot;, and 64-bit Windows does not support NTVDM any more.</p>
<p>Stop the cargo cult!</p>
<p>&gt; Because there are 32-bit applications which rely on short file names (often by accident).</p>
<p>These accidents can be fixed: turn off short filename generation!</p>
<p>&gt; Just look at all the PROGRA~1 entries in your registry. -Raymond</p>
<p>NONE. Since 1997!</p>
<p>JFTR: see MSKB 164351 (yes, rather old)</p>
<p>[HKEY_LOCAL_MACHINESystemCurrentControlSetControlFileSystem]</p>
<p>&quot;Win95TruncatedExtensions&quot;=dword:00</p>
<div class="post">[<em>The problem is that everybody probably will encounter at least one retarded program. I had to deal with one just the other day. It was an old game. Not only did it require XP, it required that you be logged on as an administrator. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112303">
				<div id="div-comment-1112303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112303">
			March 13, 2014 at 11:31 am</a>		</div>

		<p>@alegr1: It is those programs which are responsible for opening an explorer window on every boot when using non-English OS. This was apparently such a common bug that microsoft had to compensate for it in later oses.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112323">
				<div id="div-comment-1112323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ANon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112323">
			March 13, 2014 at 12:10 pm</a>		</div>

		<p>[I was somebody already. That&#39;s how the second note got there. -Raymond]</p>
<p>@Brian_EE</p>
<p>For the record, there&#39;s a lot of good discussion on that original post about exactly why people DON&#39;T want to &quot;Be Somebody,&quot; especially at MS.</p>
<p>If you&#39;re ALREADY &#39;somebody,&#39; your problem gets resolved. If you&#39;re not, people just go &quot;Who is this jackass trying to be?&quot; and ignore the problem (at best).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112333">
				<div id="div-comment-1112333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark (The Other Mark)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112333">
			March 13, 2014 at 12:46 pm</a>		</div>

		<p>I almost expected Mr. Chen&#39;s link to be to my companies Website.</p>
<p>Just the other day, we had folks ask how to get an application working on 64 bit Win 7. Turned out the error message was that it was a 16 bit app. </p>
<p>Now they want to try it in DOSbox.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112343">
				<div id="div-comment-1112343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112343">
			March 13, 2014 at 1:05 pm</a>		</div>

		<p>[it required that you be logged on as an administrator. -Raymond]</p>
<p>Old game requiring admin = writes to the install directory. Usually just give permissions away and it works. I&#39;m not surprised UAC redirect didn&#39;t fix it. It never worked correctly.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1112363">
				<div id="div-comment-1112363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112363">
			March 13, 2014 at 1:41 pm</a>		</div>

		<p>[I had to deal with one just the other day. It was an old game. Not only did it require XP, it required that you be logged on as an administrator. -Raymond]Yep, that&#39;s a very important enterprise piece of software. And just another day, I wanted to run old Vikings game. Unfortunately, it wanted bare DOS and real Sound Blaster.</p>
<div class="post">[<em>Enterprise software is in many ways quite similar to crappy XP games: They&#39;re crappy, they&#39;re designed for XP, nobody has the source code. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1112373">
				<div id="div-comment-1112373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112373">
			March 13, 2014 at 1:47 pm</a>		</div>

		<p>[Enterprise software is in many ways quite similar to crappy XP games: They&#39;re crappy, they&#39;re designed for XP, nobody has the source code. -Raymond]That&#39;s why Software Gods created virtual machines.</p>
<div class="post">[<em>Enterprise software is worse than crappy XP games. XP games don&#39;t care about interoperating with the other apps or files on the system. But if you have an Enterprise app that wants you to drag/drop some content from an Excel spreadsheet, or to drop your 2014 budget document for scanning, you&#39;re kind of stuck. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112073">
				<div id="div-comment-1112073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112073">
			March 13, 2014 at 7:03 am</a>		</div>

		<p>Is there a way to search for *.txt without searching for *.txtother?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112103">
				<div id="div-comment-1112103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frenchguy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112103">
			March 13, 2014 at 7:33 am</a>		</div>

		<p>@Gabe: wouldn&#39;t searching for *.XLS* do the trick?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112383">
				<div id="div-comment-1112383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112383">
			March 13, 2014 at 2:45 pm</a>		</div>

		<p>I commonly use short file names to work around applications/scripts which don&#39;t like spaces in file names. If it doesn&#39;t like c:Program Files, c:Progra~1 (or even c:/Progra~1) may well work. Some of these apps/scripts were developed on Linux/Unix, where spaces in file names are officially allowed but in practice far more frowned upon than on Windows, and then ported to Windows. But I&#39;ve even seen it in software originally developed for Windows (oh, our default install directory is C:VENDOR, we never tested it with &quot;C:Program FilesVENDOR&quot;, why did you change it to that?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112393">
				<div id="div-comment-1112393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112393">
			March 13, 2014 at 3:00 pm</a>		</div>

		<p>&gt; we never tested it with &quot;C:Program FilesVENDOR&quot;, why did you change it to that?</p>
<p>In our case, we did test it. It worked just fine until Vista&#39;s UAC came along and we ended up with too many side-reactions with too many third-party applications (MS-Office, Adobe PDF, some third-party image viewers, scanning drivers, etc.) that we gave up and said C:ProgramsVENDOR.</p>
<p>Every once in awhile, somebody tries it again. BOOM.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112403">
				<div id="div-comment-1112403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Harry Johnston</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112403">
			March 13, 2014 at 3:24 pm</a>		</div>

		<p>@640k: having received all the potential matches, it shouldn&#39;t be too hard to check whether the names as returned actually match or not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hikari even thread-even depth-1" id="comment-1112223">
				<div id="div-comment-1112223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Crowther' rel='external nofollow' class='url'>Chris Crowther</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112223">
			March 13, 2014 at 9:03 am</a>		</div>

		<p>I really hate methods that don&#39;t do what you intuitively expect them to. &nbsp;If I ask for *.htm I expect to get *.htm. not *.htm and maybe *.htmsomething depending on how the filesystem is feeling. &nbsp;If I wanted *.htm and *.html I&#39;d do *.htm? and double check the results for any other extensions that might have been included in the process.</p>
<p>An overload that let you indicate that you want to include short file name in the search wouldn&#39;t be a terrible thing, though I suspect laborious bordering on infeasible.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112413">
				<div id="div-comment-1112413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Malcolm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112413">
			March 13, 2014 at 5:30 pm</a>		</div>

		<p>Creating virtual machines is all good and well, until your Powers that Be decide that all 32 bit OSes are evil, and your only option for old 32 bit &#39;rubbish&#39; is to run it on Server 2003 32 bit. Which gives you about one year&#39;s breathing space &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112423">
				<div id="div-comment-1112423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112423">
			March 13, 2014 at 7:01 pm</a>		</div>

		<p>@Malcolm: I&#39;m just waiting to see the output of the tech support call for a 16 bit service ending up requiring somebody to try to purchase server CALS for Windows 8.1 workstation 32 bit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112433">
				<div id="div-comment-1112433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lucidfox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112433">
			March 13, 2014 at 11:46 pm</a>		</div>

		<p>So why does a core method in the supposedly &quot;cross platform&quot; .NET expose Windows implementation details?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112443">
				<div id="div-comment-1112443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112443">
			March 14, 2014 at 12:35 am</a>		</div>

		<p>This blog usually is a good morning reading for me, but today it ruined my mood, because I was reminded again that &quot;short file names&quot; exist. </p>
<p>I really wish there was some other OS besides Windows and Linux to use, without so many unfixable design decisions from the past. But nobody with required knowledge and skill will try and write a whole new kernel today, unfortunately.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112453">
				<div id="div-comment-1112453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112453">
			March 14, 2014 at 1:21 am</a>		</div>

		<p>&gt; The problem is that everybody probably will encounter at least one retarded program.</p>
<p>Dump them in your garbage bin, next to all the other &quot;rotten&quot; programs which don&#39;t run any more on current systems, which need administrative privileges or cant handle &quot;long&quot; filenames.</p>
<p>&gt; I had to deal with one just the other day. It was an old game. Not only did it require XP,</p>
<p>&gt; it required that you be logged on as an administrator. -Raymond</p>
<p>Welcome IRL. Sometimes you&#39;ll have to dump old things; but you can get new ones which work on current systems, without the need for any quirks.</p>
<p>The original/first &quot;Designed for Windows&quot; specs, published about 19 years ago, had 1. applications must run without administrative privileges, 2. applications must install below %ProgramFiles% and 3. applications must write their data to %APPDATA% as MINIMUM requirements.</p>
<p>It REALLY time to enforce these basic rules and dump all non-compliant crap.</p>
<p>PS: it was Microsofts deliberate decision more than 20 years ago NOT to enforce &quot;clean programming&quot; for their new Win32 API and &quot;New Technology&quot; OS, which both were incompatible to the previous Win16 API and DOS/DOS-based Windows, from the very beginning. You grew exactly the programmers you wanted!</p>
<div class="post">[<em>You tell a company to <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/03/01/82103.aspx">dump the program that is central to running their business</a>. See how far you get. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112463">
				<div id="div-comment-1112463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112463">
			March 14, 2014 at 1:34 am</a>		</div>

		<p>&gt; &quot;Test?.txt&quot; won&#39;t match &quot;test1.txtother&quot;. &nbsp;But &quot;test??.txt&quot; will.</p>
<p>This is but just an accident.</p>
<p>The &quot;short&quot; 8.3 name of &quot;test1.txtother&quot; can be &quot;test~1.txt&quot;, &quot;test~2.txt&quot;, &quot;test~3.txt&quot;, &quot;test1234.txt&quot; or &quot;testabcd.txt&quot; etc. Only the first three short names will match. The next million names but not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112473">
				<div id="div-comment-1112473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112473">
			March 14, 2014 at 2:00 am</a>		</div>

		<p>&gt; Those programs would not work with legacy non-English OS, anyway.</p>
<p>Of course they would work on non-english OS!</p>
<p>The 8.3 names are created on the running system. If &quot;%ProgramFiles%&quot; happens to be a &quot;long&quot; filename starting with &quot;Progra&quot;, then &quot;Progra~1&quot; would be the (first) generated short name.</p>
<p>Only the &quot;retards&quot; who wrote &quot;PROGRA~1&quot; in their code (cf. MANY *.INF from our beloved manufacturer) were bitten on some non-english OS.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112483">
				<div id="div-comment-1112483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112483">
			March 14, 2014 at 2:05 am</a>		</div>

		<p>&gt; and your only option for old 32 bit &#39;rubbish&#39; is to run it on Server 2003 32 bit. Which</p>
<p>&gt; gives you about one year&#39;s breathing space &#8230;</p>
<p>Nope, you have 5 years to go with 32 bit NT 5.x, and some more years with 32 bit NT 6.x</p>
<p>Windows Embedded POSReady 2009 (which is an english Windows XP with SP3) is in main stream support until next patch tuesday. After that you get another five years of extended support. Updates are provided via Windows Update.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kirbyfcf2 odd alt thread-odd thread-alt depth-1" id="comment-1112543">
				<div id="div-comment-1112543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Kirby+FC' rel='external nofollow' class='url'>Kirby FC</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112543">
			March 14, 2014 at 4:37 am</a>		</div>

		<p>@ Stefan Kanthak</p>
<p>&quot;The original/first &quot;Designed for Windows&quot; specs, published about 19 years ago, had 1. applications must run without administrative privileges, 2. applications must install below %ProgramFiles% and 3. applications must write their data to %APPDATA% as MINIMUM requirements.&quot;</p>
<p>Unfortunately, there is no penalty for not following the &quot;Designed for Windows&quot; spec, i.e., Bill Gates doesn&#39;t come to your house and kick you in the groin. &nbsp;Sure, you can&#39;t put a nice fancy &quot;Designed for Windows&quot; sticker on your product&#39;s box, but most of the really crappy software is only used internally by businesses.</p>
<p>And that&#39;s the dirty little secret, that&#39;s not so secret. &nbsp;The business world is filled with millions of applications that:</p>
<p>(a) are very poorly written and just barely work, </p>
<p>(b) will stop working if you make any change (hardware, operating system, etc), </p>
<p>(c) can&#39;t be fixed because you don&#39;t have the source code, because it was written by a third party vendor who no longer exists or no longer cares, </p>
<p>(d) or was written by an incompetent programmer who is no longer with the company, nobody understands how the program works, and the only way to &quot;fix&quot; it would be a complete re-write. Which, due to the cost, isn&#39;t likely to happen in your lifetime.</p>
<p>This is why there are still so many computers running Windows XP today.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112553">
				<div id="div-comment-1112553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KapilK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112553">
			March 14, 2014 at 4:59 am</a>		</div>

		<p>I propose two separate APIs depending on whether they use the 8.3 names &#8211; DIRECT~1.GETFIL~1 vs Directory.GetFiles. &nbsp;:-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112573">
				<div id="div-comment-1112573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Azarien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112573">
			March 14, 2014 at 6:23 am</a>		</div>

		<p>I don&#39;t see the problem. Just don&#39;t rely on the fact that search patterns be reliable. If you really REALLY need exact matches only (and you probably don&#39;t) just filter out the results.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112583">
				<div id="div-comment-1112583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112583">
			March 14, 2014 at 7:10 am</a>		</div>

		<p>Little Side-Story: Short-Names can be very conflicting if you use different user names and folder redirection.</p>
<p>I recently ran into a problem with COM Server Registration (Original Delphi code always registers the TLB path as short-name&#8230;). Long story short: I&#39;ve managed to get the same (short) folder name twice which means that the lookup of the TLB failed when loading the DLL.</p>
<p>Problem: I&#39;ve installed the registered the COM Server as Admin which looked at the &quot;Program Files (x68)&quot; and created a new short name with ~1. However as user, the ~1 already existed (as redirected folder. A legacy of an earlier installation where an application wrote data to the user directory).</p>
<p>It took me several hours debugging to realize the actual source of the problem&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112613">
				<div id="div-comment-1112613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112613">
			March 14, 2014 at 7:53 am</a>		</div>

		<p>@Joker_vD: There&#39;s also MacOS, but it&#39;s from the same family as Linux.</p>
<p>Other than Windows, the only surviving systems with non-negligible install base are from the Unix family. Even phones are based on Unix systems nowadays.</p>
<p>As for short file names: a file having a second, invisible name (unless you open the command line and use the &quot;dir&quot; command) is really confusing. As others have noted, folder redirection is really confusing. Both have in common that they are not visible in the user interface, breaking the user&#39;s mental model (in which a file has only one name, and paths don&#39;t change magically all the time).</p>
<p>Backwards compatibility might be great, but it can&#39;t go on forever; someday, you have to clean the accumulated cruft, before it collapses under its own weight.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112633">
				<div id="div-comment-1112633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112633">
			March 14, 2014 at 8:06 am</a>		</div>

		<p>&quot;Dump them in your garbage bin, next to all the other &quot;rotten&quot; programs which don&#39;t run any more on current systems, which need administrative privileges or cant handle &quot;long&quot; filenames.&quot;</p>
<p>Sure, we&#39;ll just spend $2300 or so on Installshield and totally rewrite our installer builder just because our current ancient version of XXX Installer only has a 16-bit installer on the installation CD.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112643">
				<div id="div-comment-1112643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112643">
			March 14, 2014 at 8:14 am</a>		</div>

		<p>(which is to say, XXX Installer ships with both a 16- and 32-bit version on the CD, but the actual software on the CD that installs the software (i.e., what autorun.inf launches) is 16-bit, so you can&#39;t even install the 32-bit version on 64-bit Windows!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1112683">
				<div id="div-comment-1112683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112683">
			March 14, 2014 at 10:01 am</a>		</div>

		<p>@Rick C:</p>
<p>You&#39;ve had it coming for LONGLONG time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112493">
				<div id="div-comment-1112493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112493">
			March 14, 2014 at 3:29 am</a>		</div>

		<p>The Windows NT 3.51 common dialogs didn&#39;t take this into account, so if you used an application that tried to open *.htm;*.html files then all the .html files got repeated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112693">
				<div id="div-comment-1112693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112693">
			March 14, 2014 at 11:44 am</a>		</div>

		<p>@Simon &nbsp; </p>
<p>What is annoying is when space in file name problems don&#39;t get picked up and the default is to install in a directory other than program files. People in QA will instantly ignore the default and refuse to test anything else until the issue has been fixed, when in reality it&#39;s not a blocking issue. </p>
<p>Yes it&#39;s crappy enterprise software, but enterprise software is always going to be crappy as there aren&#39;t enough customers to justify spending enough time on writing the software properly. You won&#39;t be given enough development time to do it properly because it would push the delivery date passed what has been promised, but when the bugs come back later then they can blame you for not doing it properly in the first place.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112713">
				<div id="div-comment-1112713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112713">
			March 14, 2014 at 1:52 pm</a>		</div>

		<p>&gt; Sure, we&#39;ll just spend $2300 or so on Installshield &#8230;</p>
<p>You dont need InstallShield (in fact, this is crap too: an installer that doesnt work without installing some proprietary extensions first is crap)!</p>
<p>Just create an *.MSI, or use the SetupAPI. Both exist since the last millenium.</p>
<p>OTOH: if your &quot;product&quot; is as &quot;good&quot; as its installer, its perfect that it fails during installation. Your customers will appreciate that they can use a better product from one of your competitors then.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112723">
				<div id="div-comment-1112723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112723">
			March 14, 2014 at 1:58 pm</a>		</div>

		<p>&gt; This is why there are still so many computers running Windows XP today.</p>
<p>Nope.</p>
<p>This is why Microsoft jumps through loops and can&#39;t get rid of most of the quirks they put into Windows in the last 20 years.</p>
<p>Raymond just wrote about one if them!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112743">
				<div id="div-comment-1112743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112743">
			March 14, 2014 at 2:21 pm</a>		</div>

		<p>&gt; You tell a company to dump the program that is central to running their business. See how far you get. -Raymond</p>
<p>Isn&#39;t this exactly what Microsoft tells their customers who are still running Windows XP?</p>
<p>| Enterprise software is in many ways quite similar to crappy XP games: They&#39;re crappy, they&#39;re designed for XP, nobody has the source code. -Raymond</p>
<div class="post">[<em>And look how far we&#39;re getting. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112753">
				<div id="div-comment-1112753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nico</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112753">
			March 14, 2014 at 2:28 pm</a>		</div>

		<p>@Alegr1:</p>
<p>&gt; LONGLONG time.</p>
<p>Haha! That certainly deserves a star :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112763">
				<div id="div-comment-1112763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112763">
			March 14, 2014 at 3:05 pm</a>		</div>

		<p>&gt; And look how far we&#39;re getting. -Raymond</p>
<p>Yes, it&#39;s sad, really.</p>
<p>Just to pick up one point: in Windows 8.1 the user account(s) created during setup still have administrative rights.</p>
<p>It&#39;s time to get into your time machine and fix at least the worst decisions that were made during the introduction of NT and later.</p>
<p>Yes, reality bites (back).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1112773">
				<div id="div-comment-1112773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112773">
			March 14, 2014 at 8:45 pm</a>		</div>

		<p>&gt;Just to pick up one point: in Windows 8.1 the user account(s) created during setup still have administrative rights.</p>
<p>The single biggest reason for Windows having extremely poor security reputation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112803">
				<div id="div-comment-1112803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112803">
			March 15, 2014 at 6:52 am</a>		</div>

		<p>@Stefan Kanthak: ok you have one chance to convince me as in user why I should upgrade to Windows 9 if it breaks several of perfectly fine working applications that I either couldn&#39;t replace or that would cost lots of money to by anew.</p>
<p>Hint: &quot;it makes life easier for developers&quot; or &quot;but it&#39;s already broken you just don&#39;t notice&quot; will not interest me even a teensy bit &#8211; no really if you can&#39;t name a real concrete advantage for &quot;me&quot; I won&#39;t care at all.</p>
<p>After this thought experiment you&#39;ll probably understand MS&#39;s position a bit better.. And if you actually come up with good reasons that the average user/manager will understand I guess you just made a fortune.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112813">
				<div id="div-comment-1112813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">immibis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112813">
			March 15, 2014 at 7:52 pm</a>		</div>

		<p>@voo: the real concrete advantage is that people will stop telling you to upgrade to Windows 9 :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112823">
				<div id="div-comment-1112823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112823">
			March 16, 2014 at 2:41 pm</a>		</div>

		<p>&gt; And if you actually come up with good reasons that the average user/manager will understand I guess you just made a fortune.</p>
<p>That&#39;s SOOO simple: unsupported software is &#8230; you guess it &#8230; UNSUPPORTED.</p>
<p>Without support, non-trivial software begins to &quot;rot&quot;: newly discovered bugs wont be fixed. If such a nice bug allows an adversary to crash the unsupported software you use or execute his own code you (and perhaps all your precious data) are lost (or stolen). If a bug allows elevation of privilege you and all your colleagues who use your system(s)/network are lost. Your and their precious data too can get lost or stolen!</p>
<p>Ask your manager how he covers his ass^W^W^Wmitigates this risk!</p>
<p>Ask him whether he will fire you for using unsupported software that enabled an attacker to gain access to your computer or your companies network and steal your companies assets!</p>
<p>Ask your companies lawyer too what can/will happen after a breach when customer/confidential data gets into the wrong hands.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112833">
				<div id="div-comment-1112833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112833">
			March 16, 2014 at 3:02 pm</a>		</div>

		<p>&gt; &quot;but it&#39;s already broken you just don&#39;t notice&quot; will not interest me even a teensy bit.</p>
<p>Ignorance is bliss.</p>
<p>Broken software (like the typical enterprise crap that refuses to run without administrative rights) is even worse than unsupported software: its bugs and security holes are well-known, and there is NO protection against tampering with all your precious data on your system(s) or your network!</p>
<p>Privilege separation is well-known for at least half a century. Software that does not support it is defective &#8230; take a look into european law, for example.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112843">
				<div id="div-comment-1112843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112843">
			March 16, 2014 at 5:03 pm</a>		</div>

		<p>@Stefan Kanthak: So your solution to getting people to update is to.. wait until their current OS looses support and then rely on them updating. Will that work? As we see with XP.. well somewhat. But fun fact did you know that extended support for MS&#39; OSes is about 10 years? (Win 7 ends extended support in January 2020 and was released in 2009)</p>
<p>So basically you&#39;re banking on the idea that MS is fine selling everyone a new OS every decade instead of every two years.. I think it&#39;s a fair assumption to make that MS may not be too happy with your solution.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112853">
				<div id="div-comment-1112853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112853">
			March 16, 2014 at 7:45 pm</a>		</div>

		<p>&quot;That&#39;s SOOO simple: unsupported software is &#8230; you guess it &#8230; UNSUPPORTED.&quot;</p>
<p>Exactly. Their main application is unsupported. And there is no replacement. But it still works, without any additional money needed, while re-writing it from scratch, repeating the testing cycle, re-deploying and re-training the users would cost moneyâif it would be possible at all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112873">
				<div id="div-comment-1112873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112873">
			March 17, 2014 at 5:07 am</a>		</div>

		<p>The thing is, since we&#39;re talking about .Net, it is actually quite possible to feed the old buggy behaviour with short names to legacy applications, while by default using the correct long name only behaviour for new software. .Net has all the plumbing in place for that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112863">
				<div id="div-comment-1112863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112863">
			March 17, 2014 at 1:04 am</a>		</div>

		<p>&quot;If such a nice bug allows an adversary to crash the unsupported software you use or execute his own code you (and perhaps all your precious data) are lost (or stolen).&quot;</p>
<p>Real-life counter&#39;arguments&#39;: &quot;but we aren&#39;t so big that anyone would want to steal from us/crash our operations&quot;, &quot;the computer is only used in a production environment, not on the internet&quot; (true &#8211; until the software company &#39;needs&#39; direct access for updates/troubleshooting or a service technician adds his infected notebook directly into the (properly VLANed) line).</p>
<p>Only solution: get *written* information to your superiors and (preferably) written replys that they know of the problem and don&#39;t want you to solve it. Then at least when the manure hits the rotary device it spreads to them, too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112933">
				<div id="div-comment-1112933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112933">
			March 17, 2014 at 10:20 am</a>		</div>

		<p>@alegr1 but I can&#39;t convince my bosses to buy software to replace something that actually works, as long as 32-bit Windows is still available at all, first because of the expense, and second, because as I said, I&#39;d also have to rewrite our installer builder to work with any new program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112953">
				<div id="div-comment-1112953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112953">
			March 17, 2014 at 10:27 am</a>		</div>

		<p>@Stefan Kanthak: &quot;That&#39;s SOOO simple: unsupported software is &#8230; you guess it &#8230; UNSUPPORTED.&quot;</p>
<p>All the reasons in your post below are irrelevant to me. &nbsp;My software is updated regularly. &nbsp;You can think of it as a Java application for purposes of this conversation, although it&#39;s not, but it does run in a VM like Java applications do, and it does work with current versions of the VM software.</p>
<p>It&#39;s been installed thousands of times since 1999 or so, and nobody&#39;s ever had problems with the installer other than complaints about things like it having Windows 3-style common file dialogs. &nbsp;Personally I&#39;d love to replace XXX Installer with NSIS, but I can&#39;t convince my bosses in doing something that has no perceived benefit to the end user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1112973">
				<div id="div-comment-1112973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gechurch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112973">
			March 17, 2014 at 2:48 pm</a>		</div>

		<p>@Stefan Kanthak &nbsp; </p>
<p>&quot;That&#39;s SOOO simple: unsupported software is &#8230; you guess it &#8230; UNSUPPORTED.&quot;</p>
<p>We&#39;re talking about programs that were written years ago, where the developer has long-since left, and in many cases the old source code is gone. The threat of living with unsupported software isn&#39;t new to these people&#8230; they&#39;ve been living with that reality for years.</p>
<p>There&#39;s a good way of validating your opinion. When your conclusion differ so wildly from everyone else&#39;s, you should seriously start to consider the possibility that you&#39;re wrong. And when you&#39;ve given the topic 5 minutes thought based off a blog post, whereas all the people that disagree with you have spent years living with this problem you should just give up and recognise that the problem isn&#39;t as &#39;simple&#39; as you like to make it. And that your &#39;solution&#39; of throwing away the software that runs your company because it&#39;s crappy, or spending hundreds of thousands of dollars (or more) and months and months (or years) rewriting it possibly isn&#39;t the wonderful solution you propose. If it was, everyone would be doing it.</p>
<p>Of course though, it&#39;s better for the pride to continue to think everyone else is an idiot and you&#39;re the only one awesome enough to see the truth. </p>
<p>&quot;Ignorance is bliss&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1112943">
				<div id="div-comment-1112943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1112943">
			March 17, 2014 at 10:22 am</a>		</div>

		<p>@Stefan Kanthak, those are some uncalled-for attacks. &nbsp;First, XXX installer is perfectly cromulent, if aging. &nbsp;We just can&#39;t install *it* on a 64-bit OS. &nbsp;Second, &quot;just use the Setup API&quot; again means a major rewrite of an existing program for minor benefit, and finally, our application works perfectly fine as well&#8211;it&#39;s just installed with an ancient tool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113043">
				<div id="div-comment-1113043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marc K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1113043">
			March 18, 2014 at 5:30 am</a>		</div>

		<p>One of the shocking revelations I became aware of in my career is that software quality is often inverse to price. &nbsp;I used to think that software that cost $2000 per user would be of the best quality because all that money should allow the vendor to hire enough of the best people to really iron things out. &nbsp;Then I ended up in a position having to support said software&#8230; &nbsp;Where the money goes? &nbsp;I have no idea&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1113583">
				<div id="div-comment-1113583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1113583">
			March 19, 2014 at 10:43 am</a>		</div>

		<p>&gt; My software is updated regularly.</p>
<p>Which means that it is supported. It&#39;s the installer that is broken.</p>
<p>JFTR: stay away from NSIS or other 3rd party tools! Use the native tools/APIs that are shipped with the target platform.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1113593">
				<div id="div-comment-1113593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140313-00/?p=1513#comment-1113593">
			March 19, 2014 at 10:48 am</a>		</div>

		<p>&gt; they&#39;ve been living with that reality for years.</p>
<p>The dinosaurs also lived for years &#8230; until their extinction!</p>
<div class="post">[<em>Dinosaurs lasted over 150 million years. I don&#39;t think any corporation will beat that. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

