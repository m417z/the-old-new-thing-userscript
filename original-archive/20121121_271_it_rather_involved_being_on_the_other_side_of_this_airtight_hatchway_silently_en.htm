<html>
<head>
<title>It rather involved being on the other side of this airtight hatchway: Silently enabling features</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>It rather involved being on the other side of this airtight hatchway: Silently enabling features</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 21, 2012 / year-entry #272</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>41</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A security vulnerability report arrived which went roughly like this: When you programmatically enable the XYZ feature, the user receives no visual alert that it is enabled. As a result, malware can enable this feature and use it as part of an attempt to turn the machine into a botnet zombie. The XYZ feature should...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A security vulnerability report arrived which went roughly like this:</p>
<blockquote class="q"><p> When you programmatically enable the XYZ feature, the user receives no visual alert that it is enabled. As a result, malware can enable this feature and use it as part of an attempt to turn the machine into a botnet zombie. The XYZ feature should notify the user when it is enabled, so that to presence of malware is more easily determined. </p>
</blockquote>
<p> Okay, first of all, before we get to the security part of this issue, let's look at the user interface design. The proposed change is that, when the XYZ feature is enabled programmatically, the user receive a notification "XYZ is now enabled." </p>
<p> You know what most users are going to do when they get that notification? </p>
<p> Ignore it. </p>
<p> There are two cases where XYZ can be programmatically enabled. The user may have enabled it themselves by, say, checking a checkbox, and the code that handles the checkbox turns around and programmatically enables the XYZ feature. In this case, the notification is an annoyance like my three-year-old niece who narrates every single thing she does. The user goes to the XYZ control panel, enables XYZ, and in response to the XYZ control panel enabling XYZ, the user gets a notification balloon that says "XYZ is now enabled." </p>
<p> Well DUH. </p>
<p> The other case is that the user did <i>not</i> enable it themselves, in which case the balloon is an annoyance because it says something that the user doesn't care about and probably doesn't even understand. </p>
<p> "The tech tech tech is now tech tech tech." </p>
<p> Displaying a notification doesn't really help. Either the user expects it, in which case it's an annoyance, or the user doesn't expect it, in which case they most likely won't understand it either, so it's still just an annoyance. (And taking no action leaves the feature enabled.) </p>
<p> Okay, now let's look at the security aspect of this report. Enabling the XYZ feature requires administrator privileges, so any malware which successfully turns on the XYZ feature has already pwned your machine. <i>It's already on the other side of the airtight hatchway.</i> </p>
<p> Displaying a warning when your machine is pwned doesn't accomplish anything: Since the malware already has complete control of the machine, it can patch out the code that displays the notification balloon. In other words, the only case in which the user actually sees the XYZ notification is when the user was expecting it to be turned on anyway, at which point you're just being a chatty Cathy. </p>
<p> <b>Exercise</b>: "You can get rid of the notification in the case where the user enabled the feature manually adding a <code>fSuppressWarnings</code> parameter to the <code>Enable&shy;XYZ</code> function, and have the code that handles the checkbox pass <code>fSuppressWarnings = TRUE</code>. That leaves only the second case, which is exactly the case we want the user to be annoyed." Discuss. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (41)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1021793">
				<div id="div-comment-1021793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sunil Joshi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021793">
			November 21, 2012 at 7:03 am</a>		</div>

		<p>Exercise: Your friendly malware author is likely to pass fSuppressWarnings = TRUE. The flag helps not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021803">
				<div id="div-comment-1021803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Zarat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021803">
			November 21, 2012 at 7:10 am</a>		</div>

		<p>I already get these kind of notifications, from my antivirus software.</p>
<p>I&#39;m still annoyed because almost always they are false positives.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1021843">
				<div id="div-comment-1021843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021843">
			November 21, 2012 at 7:22 am</a>		</div>

		<p>While it&#39;s not security related, am I only one annoyed by &quot;Windows color scheme switched to basic, because an application is incompatible&quot;, the application in question being a popular DVD/BR player favored by OEMs?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021863">
				<div id="div-comment-1021863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021863">
			November 21, 2012 at 7:28 am</a>		</div>

		<p>Exercise: Yeah, and let&#39;s add that evil bit to TCP packets while we&#39;re at it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021873">
				<div id="div-comment-1021873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021873">
			November 21, 2012 at 7:28 am</a>		</div>

		<p>@John Doe, maybe I&#39;m remembering and it wasn&#39;t the UAC dialog that popped up below others. &nbsp;But I remember getting a lot of modal dialogs under other windows. &nbsp;I definitely never did anything explicit to configure anything about UAC.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021883">
				<div id="div-comment-1021883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021883">
			November 21, 2012 at 7:30 am</a>		</div>

		<p>@Andrew:</p>
<p>Because the first click in on the explorer window, which is on your normal desktop. Malware on your desktop can post messages to that window to send fake clicks, hence the system cannot tell whether you decided to rename &quot;C:Windows&quot; to &quot;C:Pwndows&quot; or whether the malware did.</p>
<p>For UAC, the dialog is on the secure desktop (in fact, the faded other windows you can see aren&#39;t actually there &#8211; that&#39;s the desktop wallpaper of the secure desktop). Since malware CAN&#39;T post messages there, UAC can be sure that it&#39;s ACTUALLY you doing the clicking, and not the malware.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021893">
				<div id="div-comment-1021893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021893">
			November 21, 2012 at 7:30 am</a>		</div>

		<p>@Andrew</p>
<p>Windows cannot verify (at least in current implementation) who clicked any button in any application. That is the whole point of Secure Desktop: it is isolated and under Windows&#39; control.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021903">
				<div id="div-comment-1021903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021903">
			November 21, 2012 at 7:31 am</a>		</div>

		<p>@alegr1: That annoyance is fixed in Windows8. There is no more &quot;basic mode&quot; and aero is always on.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021913">
				<div id="div-comment-1021913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021913">
			November 21, 2012 at 7:35 am</a>		</div>

		<p>Speaking of airtight hatchways, I just read about this vulnerability in Windows 8: <a rel="nofollow" target="_new" href="http://www.passcape.com/index.php?section=blog&amp;cmd=details&amp;id=27" rel="nofollow">http://www.passcape.com/index.php</a> . &nbsp;The key text being &quot;any user of the PC with the Administrator privileges can easily recover [the text password]&quot;.</p>
<p>Of course, despite requiring being on the other side of the hatchway, it&#39;s still a serious issue because recovering the plaintext password of another user could have much larger repercussions if they reuse the same password anywhere else, among other things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021923">
				<div id="div-comment-1021923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vilx-</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021923">
			November 21, 2012 at 7:36 am</a>		</div>

		<p>@Matt &#8211; Actually, there is no more &quot;aero&quot; in Windows 8. The DWM is now permanently on, yes, but the pretty &quot;aero&quot; skin is gone. :( I for one keep my fingers crossed and hope that it will return one day. Or maybe people will figure out how to make skins for Windows 8 like they did for Windows XP. Ahh, the good old days&#8230; :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1021933">
				<div id="div-comment-1021933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021933">
			November 21, 2012 at 8:21 am</a>		</div>

		<p>@Andrew:</p>
<p>If you&#39;re using a default Windows installation, your everyday account type is a member of Administrators, with &quot;Restricted&quot; token attached (this confirms that Microsoft . For such account, you don&#39;t have to enter your password. The confirmation dialog is shown on a separate GUI surface called &quot;Desktop&quot; in Win32 terms, which is not accessible for other processes, so the confirmation cannot be faked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1021943">
				<div id="div-comment-1021943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021943">
			November 21, 2012 at 8:28 am</a>		</div>

		<p>@matt:</p>
<p>&quot;I had an annoyance that once in a while I had rash on my face. Now that somebody splashed acid on me, I don&#39;t have rash anymore. Problem solved&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021953">
				<div id="div-comment-1021953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Philip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021953">
			November 21, 2012 at 9:00 am</a>		</div>

		<p>about the exercise: How would the checkbox determine that it was actually the user who clicked it? It could easily have been clicked by the malware sending appropriate windows messages (or any other method for simulating input). I guess the only way to solve that is to show the dialog with the checkbox in a privileged desktop, but AFAIK, only windows itself can do that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021963">
				<div id="div-comment-1021963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@alegr1</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021963">
			November 21, 2012 at 9:03 am</a>		</div>

		<p>&quot;Now that somebody splashed acid on me&quot;</p>
<p>Subjective. I like win8 a lot more than 7, theme included. My only gripe is that with the aubergine-purple color I use for titlebars, the title text could not be customized white. I can live with that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021973">
				<div id="div-comment-1021973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021973">
			November 21, 2012 at 9:08 am</a>		</div>

		<p>There was this virus going around to which UAC was no barrier. It used remote desktop to press continue on the UAC prompt.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022003">
				<div id="div-comment-1022003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022003">
			November 21, 2012 at 12:20 pm</a>		</div>

		<p>It feels like there should be an &quot;airtight hatchway&quot; category for blogs that mention &quot;being on the other side of this airtight hatchway.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022013">
				<div id="div-comment-1022013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022013">
			November 21, 2012 at 12:45 pm</a>		</div>

		<p>&quot;I guess the only way to solve that is to show the dialog with the checkbox in a privileged desktop, but AFAIK, only windows itself can do that.&quot;</p>
<p>It&#39;s possible to switch between desktops with the right privileges (Mark Russinovich had a good article and code sample for this) &#8211; then again, of course, it&#39;s also possible to install your own keyboard, mouse and device driver to feed in &quot;genuine&quot; input from fake hardware, which of course is exactly what remote control software will do. Switching to your own secure desktop is quite a good way of locking out most would-be malware.</p>
<p>Original suggestion rephrased: &#39;malware should tell the user when it installs itself&#39;. Far too much of it does seem to do that these days, calling itself a &#39;toolbar&#39; coming bundled with something legitimate&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022023">
				<div id="div-comment-1022023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">gubment.cheez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022023">
			November 21, 2012 at 1:20 pm</a>		</div>

		<p>@Andrew: in addition to everything else everyone has said about the UAC, if a minimized program triggers a UAC prompt, the UAC prompt itself is minimized as well, which leads to Fun Times(TM) if you&#39;re not expecting it</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1022033">
				<div id="div-comment-1022033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022033">
			November 21, 2012 at 1:45 pm</a>		</div>

		<p>I find UAC is actually useful now that I log in as a limited user account.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022043">
				<div id="div-comment-1022043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alistair Young</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022043">
			November 21, 2012 at 2:10 pm</a>		</div>

		<p>Exercise: And even in the hypothetical powered-by-magic case in which you could prevent the malware from passing the no-really-not-evil flag, the user would &lt;i&gt;still&lt;/i&gt; ignore it. &nbsp;So, instead of alerting the user, that should instead e-mail the system administrator to go beat the user around the ears for letting the malware get on their machine in the first place.</p>
<p>(For home users and others without system administrators? &nbsp;Well, then, have it e-mail the genie who&#39;s providing the magic that makes the first part of this exercise work.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022053">
				<div id="div-comment-1022053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022053">
			November 21, 2012 at 2:11 pm</a>		</div>

		<p>&gt; You know what most users are going to do when they get that notification?</p>
<p>&gt; Ignore it.</p>
<p>Just like most people will ignore it when you tell them smoking/sugar/salt is bad for their health.</p>
<p>If you can warn some users, even one user, why not do it? Not to annoy others who will likely to become a botnet zombie in a short time???</p>
<p>Doesn&#39;t make sense to me.</p>
<p>&gt; It&#39;s already on the other side of the airtight hatchway.</p>
<p>That is 100% correct.</p>
<p>But, &quot;if the burglar is already in your house, you need not be notified about that, because it somehow accomplishes nothing, you will be just annoyed.&quot; Is that the reasoning here? If my system is screwed, I would rather be given the chance to learn about it as soon as possible.</p>
<p>&gt; Since the malware already has complete control of the machine, it can patch out the code that displays the notification balloon.</p>
<p>True. Then again we have activations, DRMs, registration codes, copy protection systems. And we know that all of these can be bypassed. Why do we bother?</p>
<p>Not all malware will be able to, or even bother to, path the notification code. Some are bound to think that most people will ignore the notification and just be annoyed by it(!).</p>
<div class="post">[<em>Now all you have to do is convince the people who hate UAC. &quot;If you can warn some users, even one user, why not do it?&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021813">
				<div id="div-comment-1021813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021813">
			November 21, 2012 at 7:10 am</a>		</div>

		<p>Raymond, I&#39;m curious: I have a vague recollection, when Vista came out, of constantly getting the chatty Cathy form of *confirmation* dialog. &nbsp;Is this different somehow, security-wise? &nbsp;It seemed I would say, &quot;Do this!&quot; and Windows would pop up a dialog saying, &quot;Warning! &nbsp;Someone has just asked your machine to do this! &nbsp;Allow or deny?&quot; &nbsp;I&#39;d then have to click the &quot;Allow&quot; button. &nbsp;Do you know why, and how this is different? &nbsp;Sorry I&#39;m fuzzy on the details. &nbsp;(Side question: if I remember right, these confirmation dialogs often appeared *beneath* my active window in the Z-order, and they&#39;d lock out all interaction with everything else, such that unless I noticed the flashing icon for the notification in the taskbar, I&#39;d assume my machine had locked up. &nbsp;Ever heard of that behavior before? &nbsp;Any comment?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021823">
				<div id="div-comment-1021823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021823">
			November 21, 2012 at 7:13 am</a>		</div>

		<p>@Andrew: I guess you mean the UAC dialog, in which case the change happens *after* you respond to the dialog, not before.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021833">
				<div id="div-comment-1021833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021833">
			November 21, 2012 at 7:21 am</a>		</div>

		<p>@RP: probably, yeah. &nbsp;Just skimmed Wikipedia on UAC. &nbsp;I guess here&#39;s my question: if Windows can somehow securely verify that *I&#39;m* the one who clicked that &quot;Allow&quot; button (I don&#39;t remember having to re-enter my password like on OS X), why wouldn&#39;t the same apply for my initial interaction with the application that required elevated privileges? &nbsp;I don&#39;t get how me clicking an extra button is any more proof that I wanted that task done than my initial click in the app. &nbsp;Maybe I just need to read more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021853">
				<div id="div-comment-1021853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1021853">
			November 21, 2012 at 7:26 am</a>		</div>

		<p>@Andrew, the UAC dialog appears in a secure, separate desktop by default. You must have customized it to not do so, instead appearing in the current desktop. Therefore, *you* allowed any software you&#39;re running to click the button.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022073">
				<div id="div-comment-1022073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ted</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022073">
			November 21, 2012 at 4:24 pm</a>		</div>

		<p>Re: the exercise; could you do something along the lines of the broker pattern, where the manual control was run with higher trust than anything with programmatic access could get?</p>
<div class="post">[<em>And how would the broker know that it was invoked by the user rather than programmatically? (And what&#39;s to prevent the malware from hacking the broker?) All you did was move the problem. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1022083">
				<div id="div-comment-1022083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022083">
			November 21, 2012 at 5:50 pm</a>		</div>

		<p>@Joshua: Emmm&#8230; I think Remote Desktop currently blocks connection from localhost to get rid of &quot;infinate mirror&quot; problem&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022093">
				<div id="div-comment-1022093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022093">
			November 21, 2012 at 8:42 pm</a>		</div>

		<p>@cheong00: No, it doesn&#39;t. It does indeed block a loopback connection onto the same session, but I forward the remote desktop port over ssh so to both ends it looks like I&#39;m connecting to localhost but I&#39;m not and that works so it doesn&#39;t know by port. BTW, the virus contained an internal remote desktop client to make scraping easier.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022103">
				<div id="div-comment-1022103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sh code</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022103">
			November 21, 2012 at 9:50 pm</a>		</div>

		<p>the malware can use the fSupressWarning parameter as well, what&#39;s there to discuss?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022113">
				<div id="div-comment-1022113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022113">
			November 21, 2012 at 10:22 pm</a>		</div>

		<p>The first half of the article can only be used to argue that XYZ should maybe not exist in it&#39;s present form, not that there is nothing to be done. For example, we only learn in the second half of the article that XYZ requires admin privileges; if that had not been the case already then XYZ would have had to be changed (possibly by adding admin privileges although it&#39;s impossible to know whether that actually is the best solution without knowing what XYZ is) although not in the way requested.</p>
<p>As for the last sentence, that won&#39;t work because Windows is badly designed and all programs run at the same privilege levels. In a sensibly designed system, applications would be properly isolated and not be able to do all the same things as say the control panel. Making sure that a notification pops up only when the use checks the relevant box is possible but would require a complete redesign of the operating system.</p>
<div class="post">[<em>All the malware would have to do is inject a thread into Control Panel (or attach as a debugger) and then call the &quot;special API that only Control Panel can call.&quot; You would have to block applications from doing things like injecting threads. Fortunately, your long-desired complete redesign is here: The Windows 8 application model. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-paulcoddingtonhotmail-com even thread-even depth-1" id="comment-1022123">
				<div id="div-comment-1022123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Paul+Coddington' rel='external nofollow' class='url'>Paul Coddington</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022123">
			November 21, 2012 at 11:38 pm</a>		</div>

		<p>I wish someone with Raymond&#39;s reasoning was on the Internet Explorer team. &nbsp;My browser constantly warns me that a site is requesting access to a plug-in, but only gives me the option to &quot;Enable&quot; or &quot;Enable for all Sites&quot;. Nobody thought to add a sorely needed &quot;Ignore&quot; (and &quot;Ignore for this Session&quot;) option.</p>
<p>And so it keeps nagging me and tempting me to lower security by &quot;Enable for all Sites&quot; just to be free of it.</p>
<p>I also wonder how Acrobat and Java plug-ins manage to bypass these restrictions altogether.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-xpclientgmail-com odd alt thread-odd thread-alt depth-1" id="comment-1022143">
				<div id="div-comment-1022143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/xpclient' rel='external nofollow' class='url'>xpclient</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022143">
			November 22, 2012 at 1:09 am</a>		</div>

		<p>That&#39;s what Action Center somewhat does and we can selectively &quot;Turn off messages/notifications about ______&quot;. If you don&#39;t want a setting silently changed, just use Local Group Policy to force enable/disable/configure the feature.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022153">
				<div id="div-comment-1022153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gechurch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022153">
			November 22, 2012 at 6:51 am</a>		</div>

		<p>@Burak KALAYCI</p>
<p>&quot;If you can warn some users, even one user, why not do it?&quot;</p>
<p>There&#39;s a trade-off between usability and security. It&#39;s been well established that users don&#39;t like things they didn&#39;t ask for popping up and getting in their way or distracting them. If you make the decision to show notifications every time a feature that malware could potential use is turned on you&#39;re not just adding one alert &#8211; there may well be hundreds of features malware could misuse, which means potentially hundreds of notifications. Given the security benefits of doing this are dubious I can see why the decision was made not to do this.</p>
<p>&quot;But, &quot;if the burglar is already in your house, you need not be notified about that, because it somehow accomplishes nothing, you will be just annoyed.&quot; Is that the reasoning here? If my system is screwed, I would rather be given the chance to learn about it as soon as possible.&quot;</p>
<p>There are some fundamental differences here:</p>
<p>1) People understand what a burgular is. They understand the consequences. Most won&#39;t understand what &quot;a new site was added to the local intranet zone&quot; (or whatever the notification is about) means.</p>
<p>2) If a burgular is in your home then yes &#8211; you are definitely screwed. If a new site is added to your local intranet zone then although there&#39;s a chance you are screwed (or on your way), there&#39;s a much better chance that everything is functioning normally.</p>
<p>A closer analogy would be a notification if a person was in your house. Sure, there&#39;s a chance that person is a burgular. But there&#39;s a better chance it&#39;s just an everyday occurrence that is nothing to worry about. If your security company started calling you every time a person was in your house you&#39;d probably get annoyed pretty quickly. &quot;Yes I know there&#39;s someone in my house. I live with my wife and two kids&#8230; it&#39;s not surprising someone is in my house. Stop calling me already!&#39;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1022193">
				<div id="div-comment-1022193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022193">
			November 22, 2012 at 6:59 pm</a>		</div>

		<p>[Fortunately, your long-desired complete redesign is here: The Windows 8 application model. -Raymond]</p>
<p>I think lots of &quot;gold finger patch&quot; used by gamers work by injecting threads to the game. Gamers won&#39;t like to hear this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022173">
				<div id="div-comment-1022173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Burak KALAYCI</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022173">
			November 22, 2012 at 11:19 am</a>		</div>

		<p>[Now all you have to do is convince the people who hate UAC. &quot;If you can warn some users, even one user, why not do it?&quot; -Raymond]</p>
<p>Hey wait! *I* hate UAC!</p>
<p>I miss the old times when you could know if you had malware by just listening to the extra noise (or disk light flashing) of your hard drive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022203">
				<div id="div-comment-1022203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022203">
			November 22, 2012 at 8:19 pm</a>		</div>

		<p>[Fortunately, your long-desired complete redesign is here: The Windows 8 application model. -Raymond]</p>
<p>Nah. The malware will be a traditional desktop app. Since anything with enough power to do anything interesting will be one anyway, nobody will blink. I didn&#39;t check but I wouldn&#39;t be surprised if a traditional app that calls up no windows doesn&#39;t switch to desktop when launched from metro.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022243">
				<div id="div-comment-1022243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">NB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022243">
			November 22, 2012 at 11:24 pm</a>		</div>

		<p>Perhaps the idea is that after some time there will ONLY be the Windows 8 application model.</p>
<p>The old desktop model might stick around as optional extension like Windows XP Mode in Windows 7 perhaps.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022253">
				<div id="div-comment-1022253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022253">
			November 23, 2012 at 12:56 am</a>		</div>

		<p>Man that was predictable. Learn to read, Raymond. If application were properly isolated, a normal application wouldn&#39;t be able to inject threads into the control panel, or muck about with its user interface or whatever. Also, as already pointed out Win8 doesn&#39;t fix it. And again, it is possible to make warnings pop up only if the user didn&#39;t click on the checkbox in the control panel (although without knowing what XYZ is no one can be sure if that&#39;s the best solution) but to do that would require a redesign of the operating system.</p>
<div class="post">[<em>As I already noted, new-style applications are isolated in the manner you describe. So stick to new-style applications and you&#39;re in good shape. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022273">
				<div id="div-comment-1022273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022273">
			November 23, 2012 at 8:02 am</a>		</div>

		<p>[So stick to new-style applications and you&#39;re in good shape. -Raymond]</p>
<p>That model can&#39;t live.</p>
<p>Challenge:</p>
<p>Write two applications that share data.</p>
<p>Write a compiler.</p>
<p>Automate builds of some project using the compiler.</p>
<p>If you complete these tasks, show how the security model isn&#39;t equivalent to the classic security model.</p>
<div class="post">[<em>Your typical end-user does not need a compiler. My point is that end-users who stick to new-style applications get the benefits of the new isolation model and can therefore use their computers more confidently. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022323">
				<div id="div-comment-1022323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022323">
			November 23, 2012 at 12:42 pm</a>		</div>

		<p>[Your typical end-user does not need a compiler.]</p>
<p>And my point is an environment that is hostile to compilers is hostile to programmers, which results in most of the useful stuff not backed by corporate $$$ will not live in it, and so even ordinary users will be transitioning out of it all the time.</p>
<div class="post">[<em>Can you and AC get into a room and settle your disagrement privately, then let me know what your answer is? The point is that desktop apps are the &quot;full power, full risk&quot; apps that you want, and the new-style applications are the &quot;isolated applications that cannot interfere with each other&quot; apps that AC wants. Choose the type of app based on your personality. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022333">
				<div id="div-comment-1022333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121121-00/?p=6033#comment-1022333">
			November 23, 2012 at 2:16 pm</a>		</div>

		<p>Sharing data between apps is so 90&#39;s. Even compilers are run in the cloud these days. File system access is GONE.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

