<html>
<head>
<title>Le Chatelier's Principle in action: Administrative overrides</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Le Chatelier&#8217;s Principle in action: Administrative overrides</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>April 22, 2014 / year-entry #103</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>43</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Today we have another example of Le Chatelier's Principle as interpreted by John Gall: Every system resists its proper functioning. There was a video card manufacturer which was using the AppInit_DLLs key so that they could inject their DLL into every process. I have no idea why. Perhaps to get a nice bonus. In Windows...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Today we have another example of <a href="http://blogs.msdn.com/oldnewthing/archive/2008/04/16/8398400.aspx"> Le Chatelier's Principle as interpreted by John Gall</a>: Every system resists its proper functioning.</p>
<p> There was a video card manufacturer which was using the <code>AppInit_<wbr>DLLs</wbr></code> key so that they could inject their DLL into every process. I have no idea why. Perhaps to <a href="http://blogs.msdn.com/b/oldnewthing/archive/2006/11/01/922449.aspx"> get a nice bonus</a>. </p>
<p> In Windows Vista, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/12/13/6648400.aspx"> the <code>AppInit_DLLs</code> registry key was deactivated</a> for both engineering and security reasons. Oh no! Undeterred, the video card manufacturer issued an update to their driver so that in addition to adding themselves to <code>AppInit_<wbr>DLLs</wbr></code>, they also set the <a href="http://blogs.msdn.com/b/nickkramer/archive/2006/04/18/577962.aspx"> administrative override switch</a> that re-enabled the feature. Boom, they probably got a second bonus for that. </p>
<p> Another lesson from this story is that if you provide an administrative override to restore earlier behavior, then you never really removed the earlier behavior. Since installers run with administrator privileges, they can go ahead and flip the setting that is intended to be set only by system administrators. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (43)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1121273">
				<div id="div-comment-1121273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Kohne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121273">
			April 22, 2014 at 9:18 am</a>		</div>

		<p>Again, I call for a name and shame policy at Microsoft! When MS becomes aware of this kind of BS, they should be announcing the perp far and wide. One of the problems these days is that few people have any idea why things are so screwed up. If MS would help by pointing the finger when appropriate, it wouldn;t hurt the situation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121283">
				<div id="div-comment-1121283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121283">
			April 22, 2014 at 9:25 am</a>		</div>

		<p>AppInit_DLLs has one use. Patching up security flaws for which MS has not yet released a patch without touching the binaries and thereby breaking future updates.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121293">
				<div id="div-comment-1121293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121293">
			April 22, 2014 at 10:15 am</a>		</div>

		<p>@Joshua: PsSetLoadImageNotifyRoutine is better suited to that task than AppInit_DLLs. &nbsp;For one thing, AppInit_DLLs cannot fix security holes for services that do not load user32.dll.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121303">
				<div id="div-comment-1121303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121303">
			April 22, 2014 at 10:32 am</a>		</div>

		<p>@Myria: When&#39;s the last security remotely exploitable hole in Windows API reachable but not through user32.dll?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121333">
				<div id="div-comment-1121333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121333">
			April 22, 2014 at 11:15 am</a>		</div>

		<p>Maybe windows defender should start highlighting problems like these.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121343">
				<div id="div-comment-1121343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Hans</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121343">
			April 22, 2014 at 11:19 am</a>		</div>

		<p>@Peter Ferrie</p>
<p>I wish this is not the same video card manufacturer which had since a certain driver version introduced the &quot;cursor freeze&quot; problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121353">
				<div id="div-comment-1121353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan Hamilton</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121353">
			April 22, 2014 at 11:21 am</a>		</div>

		<p>@Michael Kohne: &quot;Typical Microsoft, shifting the blame to their customers.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1121363">
				<div id="div-comment-1121363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121363">
			April 22, 2014 at 11:23 am</a>		</div>

		<p>The way I am parsing this story, it sounds like we put out a feature, someone started using it, but we don&#39;t know why, then we turned the feature off because we didn&#39;t like it (but without giving a reason why), but left a way to turn it back on, and we are now expressing our shock and amazement when the people who used it turned it back on.</p>
<p>So I&#39;m missing something.</p>
<p>What are the security and engineering reasons for disabling AppInit_DLLs? In particular, how can turning off AppInit_DLLs be a security feature, when using AppInit_DLLs requires administrative access in the first place?</p>
<p>What was the video driver using the feature for? In particular, what did the .dll do once it was loaded?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121373">
				<div id="div-comment-1121373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121373">
			April 22, 2014 at 11:41 am</a>		</div>

		<p>I don&#39;t know what DLLs other people are referring to, but there is a popular vendor that loads a D3D shim DLL via this method. Since this is such a problem, MS should work with this vendor to come up with a solution that doesn&#39;t involve loading self-signed DLLs into every process.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121383">
				<div id="div-comment-1121383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121383">
			April 22, 2014 at 11:52 am</a>		</div>

		<p>I really hate device drivers that insist on being more than device drivers. &nbsp;Please give me a package that just has the driver software that lets the system use the device. &nbsp;If you want to throw in a bunch of window dressing, put that in another installation package &#8211; don&#39;t force it on me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121393">
				<div id="div-comment-1121393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Hagan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121393">
			April 22, 2014 at 11:56 am</a>		</div>

		<p>@smf: &quot;Maybe windows defender should start highlighting problems like these.&quot;</p>
<p>Why pick on defender? Every AV vendor ought to highlight issues like these and those that don&#39;t should be named and shamed in the trade press.</p>
<p>Given how widespread the problem of malware appears to be, it continues to amaze me that there is an apparent conspiracy of silence when &quot;mainstream&quot; vendors use the same set of dirty tricks. With all the history of anti-trust, I can actually understand that Microsoft are in a difficult position when it comes to calling out third-party vendors for bad coding, but the other AV vendors have no excuse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121253">
				<div id="div-comment-1121253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kyle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121253">
			April 22, 2014 at 7:09 am</a>		</div>

		<p>I have seen such AppInit DLLs cause access violations in a program that I work on. &nbsp;Nothing like explaining to a customer that even though the access violation occurs *in* our program, it&#39;s not actually *caused by* our program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121263">
				<div id="div-comment-1121263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121263">
			April 22, 2014 at 7:30 am</a>		</div>

		<p>semi-fitting: I just these days had a problem with HKLM&#8230;winlogonuser*init*. Some program managed to not only install itself there like malware would, but *also* to use a folder non-readable to most users to add there. Result was that logon was directly followed by logoff for nearly everyone. Quite nice on a terminalserver&#8230;</p>
<p>Do I need to mention that this program is used for &quot;enterprisy&quot; features, so the &quot;someone probably got a nice bonus&quot; quite likely is true here, too?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121413">
				<div id="div-comment-1121413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121413">
			April 22, 2014 at 4:16 pm</a>		</div>

		<p>@Michael Kohne &#8211; &nbsp;&#39;it wouldn;t hurt the situation&#39; &#8211; It wouldn&#39;t help either.</p>
<p>@Maurits [MSFT] &#8211; &nbsp;&#39;In particular, how can turning off AppInit_DLLs be a security feature, when using AppInit_DLLs requires administrative access in the first place?&#39; &#8211; Installers run as admin, regular user innocently installs a program which add entries here. Suddenly &#39;random&#39; programs start crashing and all bets are off. And don not forget that any program launched with admin now has a chance to execute this dll as admin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1121423">
				<div id="div-comment-1121423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121423">
			April 22, 2014 at 4:55 pm</a>		</div>

		<p>@Dom: not sure you understood my point&#8230;</p>
<p>&gt; Installers run as admin</p>
<p>Some do, yes; fine.</p>
<p>&gt; regular user innocently installs a program which add entries here</p>
<p>User innocently runs malicious code, elevated? Oops. The malicious code now owns their system. It can install a service, it can inject code into running processes, it can do all kinds of nasty things directly. AppInit_DLLs isn&#39;t much of a concern at this point; the game&#39;s already over.</p>
<p>&gt; Suddenly &#39;random&#39; programs start crashing and all bets are off.</p>
<p>At this point programs crashing is the least of your worries.</p>
<p>&gt; And don not forget that any program launched with admin now has a chance to execute this dll as admin.</p>
<p>You mean, the bad .dll gets another chance to run every time you launch another program elevated? I suppose that&#39;s a nice convenience for the author of the malicious code, but they don&#39;t really need it; they can launch their own long-lived processes from the installer without relying on the user to run other processes later, and they can arrange for their code to be run again on logout/login or reboot.</p>
<p>So AppInit_DLLs is not of much use to malware vendors. It is apparently of value to the video driver vendor, though. I&#39;m curious as to why.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121433">
				<div id="div-comment-1121433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121433">
			April 22, 2014 at 5:13 pm</a>		</div>

		<p>@Maurits: &quot;It is apparently of value to the video driver vendor, though. I&#39;m curious as to why.&quot;</p>
<p>If it&#39;s the video card driver I&#39;m aware of which does this, it&#39;s so it can hook DirectX in usermode. This gives it the opportunity to speed up a couple of hotpaths through DirectX to its video driver (e.g. it could map video memory into usermode so polygons sent to the videocard don&#39;t need to go via the multiple indirect calls in DirectX usermode, kernelmode, the shader pre-translation path in kernel mode and the syscall boundary).</p>
<p>Speeding up graphics operations &#8211; by practically any and all means necessary &#8211; is a fairly major goal of graphics card vendors. And personally if Microsoft is going to give them a way to do this and then retract that reason without giving the graphics card vendors a good reason why they shouldn&#39;t re-enable it, of course they&#39;re just going to turn it back on! If this gives your graphics card a 5% boost in performance compared with your rivals on the market, you&#39;d be mental not to!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121313">
				<div id="div-comment-1121313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Peter Ferrie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121313">
			April 22, 2014 at 10:34 am</a>		</div>

		<p>There *continues* to be a video card manufacturer which is using the AppInit_DLLs registry key, even on Windows 8.1, and it is known to cause all kinds of problems.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121443">
				<div id="div-comment-1121443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">foo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121443">
			April 22, 2014 at 6:01 pm</a>		</div>

		<p>Well I checked my Windows 7 work computer and saw the registry settings exactly as described in the article. But the DLL in question resides in the System32 directory, so in theory (cough) as long as the DLL itself is secure then it is protected from being replaced by some sort of airtight hatch. But why still the need for the DLL, especially after a number of years? (Rhetorical question&#8230; I can googles that for myself, and now refreshing before posting I see Matt helped with that, and maybe it&#39;s no longer needed and I just don&#39;t update my work computer&#39;s graphics software as often as I should).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1121453">
				<div id="div-comment-1121453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121453">
			April 22, 2014 at 6:23 pm</a>		</div>

		<p>@Hans: Don&#39;t know, but if you&#39;re talking about A brand, I heard people successfully makes the problem go away after they disabled the &quot;vertical sync&quot; option in the video card&#39;s advanced settings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1121463">
				<div id="div-comment-1121463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121463">
			April 22, 2014 at 6:30 pm</a>		</div>

		<p>@Ken Hagan: I found some antivirus already doing something similar.</p>
<p>For example, the antivirus always prompt that my P2P software could make my browsing speed slow&#8230; Thank you, I&#39;ve set the max upload/download limit so it won&#39;t affect me. Please go away.</p>
<p>Funny that this P2P software is the only piece of software that invoked that warning, and there are other well known software the could cause problems but all were ignored. I bet someone is getting real nice bonus on that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1121473">
				<div id="div-comment-1121473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121473">
			April 22, 2014 at 6:32 pm</a>		</div>

		<p>Sorry, I just checked and it should be N brand that the vertical sync fix is about.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121403">
				<div id="div-comment-1121403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ChrisR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121403">
			April 22, 2014 at 12:18 pm</a>		</div>

		<p>@Ken Hagan: Additionally, it really irritates me that the AV vendors will gleefully block useful software because it is self-signed (or not signed at all), but they will allow all this **** to intentionally make systems more vulnerable, just because it has been downloaded by a lot of people and/or is signed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kai-schatzl even thread-even depth-1" id="comment-1121483">
				<div id="div-comment-1121483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Kai+Sch%C3%A4tzl' rel='external nofollow' class='url'>Kai Schätzl</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121483">
			April 23, 2014 at 12:56 am</a>		</div>

		<p>N brand fits, it&#39;s the one known injecting via AppInit. A few years ago it caused crashes in IE after a major version upgrade of IE.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121493">
				<div id="div-comment-1121493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vova</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121493">
			April 23, 2014 at 1:13 am</a>		</div>

		<p>Why don&#39;t commenters tell the brand name?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121503">
				<div id="div-comment-1121503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121503">
			April 23, 2014 at 1:14 am</a>		</div>

		<p>I just checked my computers, and it appears that the green videocard vendor uses AppInit_DLLs, and the blue (which only does integrated graphics) one ones doesn&#39;t. I don&#39;t currently have access to any computer with the red manufacturer&#39;s cards, so I couldn&#39;t check that one.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121523">
				<div id="div-comment-1121523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121523">
			April 23, 2014 at 4:07 am</a>		</div>

		<p>@Ken Hagan:Why pick on defender? Every AV vendor ought to highlight issues like these and those that don&#39;t should be named and shamed in the trade press.</p>
<p>I was assuming that at the point you installed the driver you&#39;d probably still be using defender. But also Microsoft are in control of defender and they are in the best position to make the decision on what is bad programming practise. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gregm even thread-even depth-1" id="comment-1121533">
				<div id="div-comment-1121533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/GregM' rel='external nofollow' class='url'>GregM</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121533">
			April 23, 2014 at 5:42 am</a>		</div>

		<p>&quot;Why don&#39;t commenters tell the brand name?&quot;</p>
<p>Because it&#39;s against the rules here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121543">
				<div id="div-comment-1121543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joker_vD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121543">
			April 23, 2014 at 6:39 am</a>		</div>

		<p>Hmm, I wonder if using abbreviations of brand&#39;s names okay? E.g., &quot;IBM&quot; instead of &quot;International Business Machines Corporation&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121563">
				<div id="div-comment-1121563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Soonts</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121563">
			April 23, 2014 at 8:06 am</a>		</div>

		<p>I have an idea why, and it&rsquo;s not about bonuses.</p>
<p>They are using this feature for better support of GPU switching. They were first to invent that, and Windows still does not provide adequate support for this feature (e.g. per-application policy saying which GPU to use).</p>
<div class="post">[<em>&quot;I got a bonus for doing something unsupported and outside sound engineering practices in order to get this feature working.&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kai-schatzl odd alt thread-odd thread-alt depth-1" id="comment-1121513">
				<div id="div-comment-1121513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Kai+Sch%C3%A4tzl' rel='external nofollow' class='url'>Kai Schätzl</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121513">
			April 23, 2014 at 1:51 am</a>		</div>

		<p>It&#39;s rather a video *chip* manufacturer. And who of the bazillion small card manufacturers does actually code drivers? Is N now clear enough?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1121623">
				<div id="div-comment-1121623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121623">
			April 23, 2014 at 9:22 am</a>		</div>

		<p>&gt;This is true, but they are probably in the worst (legal) position to start naming names.</p>
<p>Microsoft needs to start using their legal department for the good. I suppose they have people capable of drawing a letter that tells politely to go F themselves.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121633">
				<div id="div-comment-1121633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121633">
			April 23, 2014 at 10:05 am</a>		</div>

		<p>[&quot;I got a bonus for doing something unsupported and outside sound engineering practices in order to get this feature working.&quot; -Raymond]</p>
<p>Which is a different claim from all previous cases of &quot;nice bonus for that feature&quot; where the feature itself was unsound where in this case only the implementation was.</p>
<div class="post">[<em>True, but I kind of also use &quot;nice bonus&quot; to cover &quot;I violated sound engineering practices in order to get a bonus.&quot; -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121643">
				<div id="div-comment-1121643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Random User 948573</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121643">
			April 23, 2014 at 10:26 am</a>		</div>

		<p>Maurits, really it is the same &quot;security&quot; dangers any time an unexpected DLL is injected. &quot;Perfectly harmless&quot; DLL being injected into _everything_ has bizarre interaction with some other vendor&#39;s process that would normally have just thrown an AV or something, and now we have an EoP, or a disclosure, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121553">
				<div id="div-comment-1121553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ken Hagan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121553">
			April 23, 2014 at 6:55 am</a>		</div>

		<p>@smf: &quot;But also Microsoft are in control of defender and they are in the best position to make the decision on what is bad programming practise.&quot;</p>
<p>This is true, but they are probably in the worst (legal) position to start naming names. Then again, none of the other AV vendors seem willing to take the risk. When &quot;a well known company&quot; that happened to own a record label was caught distributing root kits on CDs a few years ago, it was notable that *none* of the AV vendors either before or after the revelation were willing to flag it up as malware. Even when the parent company accepted that it was a bad thing and withdrew it, still no-one was willing to criticise.</p>
<p>@cheong00 &amp; ChrisR: Yes. It&#39;s almost as though the entire AV business is just a scareware racket.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fleet-command even thread-even depth-1" id="comment-1121663">
				<div id="div-comment-1121663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121663">
			April 23, 2014 at 3:40 pm</a>		</div>

		<p>&quot;Every system resists its proper functioning.&quot;</p>
<p>Every system resists Microsoft and its perception. Microsoft is something that people find useful but never lovely. So, the burden of convincing them to go &quot;Microsoft Way&quot; is on Microsoft. Generally, the perception is that:</p>
<p>&quot;Microsoft resists the proper functioning of every system.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1121683">
				<div id="div-comment-1121683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121683">
			April 23, 2014 at 7:22 pm</a>		</div>

		<p>@alegr1 : Spending time of legal department on issues caused by individual commenters of blog posts doesn&#39;t sound like the best use of it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121693">
				<div id="div-comment-1121693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121693">
			April 23, 2014 at 10:53 pm</a>		</div>

		<p>I just noticed that on our servers providing Terminal Service functions with the C brand there&#39;s also a AppInit_DLLs &quot;hook&quot;, and in another part of the registry, under their own name, there&#39;s a whole lot of sub-keys under the key &quot;AppInit_DLLs&quot;, providing support for flash, printing, seamless integration, etc. (according to the names of the keys). In a version designed for 2008R2, so well after the AppInit_DLLs was deprecated/turned off. Seems to be quite widespread&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121713">
				<div id="div-comment-1121713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">q</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121713">
			April 24, 2014 at 12:45 am</a>		</div>

		<p>[&quot;I got a bonus for doing something unsupported and outside sound engineering practices in order to get this feature working.&quot; -Raymond]</p>
<p>Normally I agree with you, but this time I&#39;m not sure it&#39;s a good argument. Basically you are saying that Microsoft has an authority to prevent technological innovation. (I&#39;m assuming Const82&#39;s explanation of the purpose of the discussed gimmick). I agree that the solution chosen by the graphics vendor is not a good one from the engineering standpoint, but what they are to do? The feature (dynamic graphics card switching) is really very useful. In the ideal world, they would have talked with Microsoft and jointly established an API suitable for the purpose; however more than one Windows release happened since graphics card switching was invented, and there&#39;s no suitable API, so I guess Microsoft doesn&#39;t see any value in it for itself.</p>
<p>This reminds me of the time when I worked for a company building a 3rd-party Bluetooth stack for all kinds of Windows. In Vista we wanted to integrate with its new BT stack: provide some new profiles (for which there is a documented way) and support BT 3.0 (for which there isn&#39;t). The answer we got from Microsoft: &quot;No, we don&#39;t plan to support BT beyond 2.1 in the BT core in the foreseeable future. No, we can&#39;t give you documentation for the core driver. No, we won&#39;t allow a 3rd-party driver to replace our core driver. Feel free to ship entire BT stack if you want 3.0&quot;. </p>
<p>OK, we did ship the entire stack (of course, with its own GUI and with its own private API, for rejoicing of future apps writers who now have to support one more unique API).</p>
<p>But we had a customer who wanted MS API-compatible stack, so we shipped another version which included two minifilter drivers (one to go below the MS BT core driver and one above) which bolted on the support for BT 3.0. Good engineering? No, but what are the choices?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1121753">
				<div id="div-comment-1121753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121753">
			April 24, 2014 at 3:19 am</a>		</div>

		<p>@immibis: This happens a lot. But more often the case will be that, on the next reboot, the computer suddenly fail to boot. This is because the antivirus is so help that, when it cannot delete the file, it&#39;ll attempt to delete it on the next boot time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1121723">
				<div id="div-comment-1121723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">immibis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121723">
			April 24, 2014 at 12:48 am</a>		</div>

		<p>Suppose one antivirus program detected this video driver as potential malware.</p>
<p>Antivirus: &quot;nvatigma32.dll is possible malware. Remove?&quot;</p>
<p>User: *clicks Remove*</p>
<p>Antivirus: &quot;File removed.&quot; *reboots*</p>
<p>User: *goes to play a game*</p>
<p>Game: *runs really slowly*</p>
<p>User, to friends: &quot;Hey everyone, don&#39;t use Awesome Antivirus 3000 Ultimate! It&#39;ll make your computer really slow!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121763">
				<div id="div-comment-1121763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121763">
			April 24, 2014 at 8:16 am</a>		</div>

		<p>It is obvious that q understands the forces involved.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1121783">
				<div id="div-comment-1121783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121783">
			April 24, 2014 at 2:38 pm</a>		</div>

		<p>@q:</p>
<p>Microsoft BluTooth is pathetic. Microsoft BT mouse can&#39;t keep paired with Microsoft BT stack. And this is in Windows 8. You would have though they got things working.</p>
<p>Microsoft Intellimouse software suffers from insane wheel scrolling speed. And it&#39;s been suffering from it for many many years, with no fix in sight.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1121813">
				<div id="div-comment-1121813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">q</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140422-00/?p=1173#comment-1121813">
			April 25, 2014 at 12:36 am</a>		</div>

		<p>@alegr1</p>
<p>To be honest, Bluetooth architecture is much to blame here. It&#39;s overcomplicated in many places and underspecified in some places, and there is just too many possibilities to get something wrong. Bluetooth SIG tries to help by organizing quarterly UnPlugFests, global interoperability testing events where vendors get together and test their devices or software against each other in whatever combinations they are interested. But it&#39;s physically impossible to test everything against everything, so some bugs or quirks stay in for a long time.</p>
<p>I rather liked Microsoft&#39;s Vista and Win7 BT stack architecture; it&#39;s major problem was that it was stuck at BT 2.1 for many years. Their GUI choices seemed weird in some places, but at least it was consistent. :)</p>
<p>It seems that they implemented BT 4.0 in Windows 8, which might explain new issues. (I&#39;m not in that field anymore so I don&#39;t know for sure.) Though I&#39;d have thought iterop with own trademark devices should be on top of the list&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

