<html>
<head>
<title>How do I get the title of a dialog from a dialog resource?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I get the title of a dialog from a dialog resource?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 30, 2011 / year-entry #76</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>13</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer submitted the following question: We are developing automated tests for our application. Among other things, our application uses property sheets, which means that the name of the tab is stored as the title of the dialog template resource. Since we want our automated tests to run on all language versions of our application,...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer submitted the following question:</p>
<blockquote class="q"><p> We are developing automated tests for our application. Among other things, our application uses property sheets, which means that the name of the tab is stored as the title of the dialog template resource. Since we want our automated tests to run on all language versions of our application, we don't want to hard-code the tab names in our automated test. I have not been able to find any information on how to programmatically extract the dialog titles from the dialog resources. Any pointers would be appreciated. </p>
</blockquote>
<p> I replied with some pointers: </p>
<ul>
<li>     Classic dialog templates use     <a href="http://msdn.microsoft.com/en-us/library/ms645394.aspx">     DLGTEMPLATE</a>. </li>
<li>     Extended dialog templates use     <a href="http://msdn.microsoft.com/en-us/library/ms645398.aspx">     DLGTEMPLATEEX</a>. </li>
<li>     <a href="http://blogs.msdn.com/oldnewthing/archive/2004/06/21/161375.aspx">     Walkthrough of a classic dialog template</a>. </li>
<li>     <a href="http://blogs.msdn.com/oldnewthing/archive/2004/06/23/163596.aspx">     Walkthrough of an extended dialog template</a>. </li>
</ul>
<p> The customer was grateful for the pointers, then asked: </p>
<blockquote class="q"><p> Then the only way to do this is to load the dialog resource and parse the data looking for the string I want? Is it even possible to do this in C#? </p>
</blockquote>
<p> Well it depends on what your definition of "the only way" is. </p>
<p> At the end of the day, <i>somebody</i> has to load the dialog resource and parse it, because after all that is what you said you want to do: "I want to get the title of the dialog from the dialog resource." The alternative is, what, psychic powers? </p>
<p> There is no dialog template parsing library that comes with Win32. If you don't want to do the parsing, then maybe you can find somebody else who will. And if you're lucky, that other person may even have provided a C# interface. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (13)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-904353">
				<div id="div-comment-904353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">davep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904353">
			March 30, 2011 at 7:33 am</a>		</div>

		<p>There&#39;s the old &quot;Chinese&quot; saying &quot;may you live in interesting times&quot;. The Chen-version of this is &quot;may you get an interesting response&quot;!.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-904363">
				<div id="div-comment-904363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904363">
			March 30, 2011 at 8:07 am</a>		</div>

		<p>Another way is to create the dialog window and get its caption. Not as elegant as parsing the template data, and has some potential problems, but might be good enough for the customer&#39;s case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-904373">
				<div id="div-comment-904373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904373">
			March 30, 2011 at 8:40 am</a>		</div>

		<p>My psychic powers say that what they really wanted to do was to create the dialog with no name in the tab, then use some data they get from elsewhere to see what the title should be. &nbsp;then the question says &quot;How do I change the title on a tab of a property page?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-904393">
				<div id="div-comment-904393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timothy Byrd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904393">
			March 30, 2011 at 11:34 am</a>		</div>

		<p>We will likely have a similar issue here. When that happens, I&#39;ll suggest giving the (translated) .rc files to the test team, and then they can parse the DIALOG(EX) to their hearts content.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-904403">
				<div id="div-comment-904403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904403">
			March 30, 2011 at 12:40 pm</a>		</div>

		<p>@Ivo:</p>
<p>LoadLibraryEx(LOAD_LIBRARY_AS_DATAFILE), &nbsp;CreateDialog, GetWindowText, DestroyWindow. But it may fail if custom controls are used.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-904413">
				<div id="div-comment-904413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904413">
			March 30, 2011 at 3:22 pm</a>		</div>

		<p>I don&#39;t think their follow-up question is unreasonable, myself.</p>
<p>Asked for advice on how to extract the title, you&#39;ve replied with a bunch of file format info &#8211; it seems quite natural that they&#39;d want to confirm that since you hadn&#39;t mentioned one, there wasn&#39;t a API for doing this kind of thing. They may be technically fine with parsing the files themselves, but just not wanting to do it that way if there was a more standard solution. Don&#39;t want to end up on DailyWTF, afterall&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-904433">
				<div id="div-comment-904433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tergiver</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904433">
			March 30, 2011 at 4:34 pm</a>		</div>

		<p>I couldn&#39;t resist the &quot;challenge&quot;, and I was bored today. <a rel="nofollow" target="_new" href="http://tergiver.wordpress.com/2011/03/30/parsing-win32-dialog-templates/" rel="nofollow">tergiver.wordpress.com/&#8230;/parsing-win32-dialog-templates</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-904443">
				<div id="div-comment-904443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrismcb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904443">
			March 30, 2011 at 6:02 pm</a>		</div>

		<p>Ivo I suspect they want to verify that the caption of the window is the caption that is in the resource (hence the whole automated test thing)</p>
<p>Of course I have it on good authority from expensify that you can only cook 1.6 oz hamburgers in c#</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-904453">
				<div id="div-comment-904453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904453">
			March 30, 2011 at 7:46 pm</a>		</div>

		<p>@Chris &#8211; I don&#39;t think so. Imagine if you loaded the dialog resource in memory. You can either parse the template data yourself, or use CreateDialogIndirect + GetWindowText. What if you get different results? That would mean that either your test code is wrong, or CreateDialogIndirect is wrong. My money is on your code being wrong.</p>
<p>But as Alex mentioned, this will not work if the dialog is using an unknown control class (either a custom control, or if you didn&#39;t call InitCommonControls, or if you didn&#39;t load the rich text DLL).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-904463">
				<div id="div-comment-904463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904463">
			March 30, 2011 at 9:29 pm</a>		</div>

		<p>Joe: I think you&#39;re mistaken. They&#39;re doing automated testing, which implies that either they want to verify that the correct title is going to be displayed, or they need a way to find it in order to get at its controls.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-904473">
				<div id="div-comment-904473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">.net resource</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904473">
			March 31, 2011 at 5:14 am</a>		</div>

		<p>c# dialogs are not saved as win32 resources.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-904553">
				<div id="div-comment-904553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Markus B.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904553">
			March 31, 2011 at 12:02 pm</a>		</div>

		<p>I once wrote a parser for win32 ressources. It was quite fun to do it, I even did it in C#.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcohn even thread-even depth-1" id="comment-904603">
				<div id="div-comment-904603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Alex+Cohn' rel='external nofollow' class='url'>Alex Cohn</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110330-00/?p=11093#comment-904603">
			April 1, 2011 at 4:02 am</a>		</div>

		<p>@Tergiver: well done!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

