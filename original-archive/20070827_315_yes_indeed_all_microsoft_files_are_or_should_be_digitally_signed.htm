<html>
<head>
<title>Yes indeed, all Microsoft files are (or should be) digitally signed</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Yes indeed, all Microsoft files are (or should be) digitally signed</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>August 27, 2007 / year-entry #316</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>52</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Yes indeed, all Microsoft files are (or should be) digitally signed (as far as I'm aware). So I'm not quite sure what commenter Dave is getting at: The Microsoft file should have embedded vendor/product information saying it's from Microsoft and will be cryptographically signed by Microsoft. Similarly-named malware won't be signed by Microsoft, unless Verisign...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Yes indeed, all Microsoft files are (or should be) digitally signed (as far as I'm aware). So I'm not quite sure what <a href="http://blogs.msdn.com/oldnewthing/archive/2006/04/12/574927.aspx#574993"> commenter Dave is getting at</a>:</p>
<blockquote class="q"><p> The Microsoft file should have embedded vendor/product information saying it's from Microsoft and will be cryptographically signed by Microsoft. Similarly-named malware won't be signed by Microsoft, unless Verisign slipped up *again* and issued another bogus certificate.  </p>
</blockquote>
<p> Wow, this is such a great idea, that it's been true for many years now. All Microsoft files are digitally signed. They have to be; otherwise, Windows File Protection wouldn't be able to tell whether this new version of <code>shell32.dll</code> is a security update or just some malware trying to replace a system file. As I noted quite some time ago, <a href="http://blogs.msdn.com/oldnewthing/archive/2004/06/16/157084.aspx"> you can run the <code>sigverif</code> program to validate the digital signatures of all system files</a>. </p>
<blockquote class="q"><p> Long descriptive names are just as much an opportunity to malware makers as they are to legit software developers. Gee, why would you want to stop a file named "Critical Security Update Service.exe" for example?  </p>
</blockquote>
<p> And that's why Windows&nbsp;XP Service Pack&nbsp;2 added the ability to mark a file as "I got this from the Internet." (Internet Explorer applies this marking when you download a file from the Internet.) Before you run such a file, Explorer will prompt you with a warning and show you the digital signature information so that you can confirm that the download is what it purports to be and has not been tampered with. </p>
<p> This is just one example of a commenter who <a href="http://blogs.msdn.com/oldnewthing/archive/2006/11/09/1044149.aspx#1044391"> suggests that Windows do things that it already does</a>: Drop down lists do let you type multiple characters. <a href="http://blogs.msdn.com/oldnewthing/pages/407234.aspx#438164">Here's another example</a>. Windows has been multilingual since Windows&nbsp;2000. </p>
<p> For now, I'm going to keep ignoring them. <a href="http://blogs.msdn.com/oldnewthing/archive/2007/07/24/4019215.aspx"> Just because you say something in my presence and I don't raise an objection doesn't mean that I agree</a>. Or that what you said is even true. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (52)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-542963">
				<div id="div-comment-542963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thomas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-542963">
			August 27, 2007 at 10:17 am</a>		</div>

		<p>I don&#8217;t know whether all Microsoft files are digitally signed but I&#8217;d suspect not. &nbsp;According to Microsoft all hardware drivers should be signed and verified? &nbsp;I don&#8217;t know the particulars, just that when doing a fresh XP SP2 install I am warned about installing seven of the hardware drivers coming straight &nbsp;off the XP install. &nbsp;</p>
<p>I don&#8217;t know whether these are &#8220;technically&#8221; Microsoft files and drivers but they all claim to be from Microsoft corp. and they&#8217;re all on the install CD, so perhaps Microsoft should have signed and verified them.</p>
<p>Given that track record I suspect there&#8217;s a sizable fraction of Microsoft files that are unsigned.</p>
<div class=post>[<i>Hence the two parentheticals in the opening sentence. Don&#8217;t make me bring back the Nitpicker&#8217;s Corner. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-542983">
				<div id="div-comment-542983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DeGustibus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-542983">
			August 27, 2007 at 10:26 am</a>		</div>

		<p>&gt;&gt; Windows has been multilingual since Windows 2000.</p>
<p>I think the reader was referring to &#8220;buy Windows2000/XP/2003 English and being able to set it to Italian&#8221;.</p>
<p>It doesn&#8217;t seem to me this can be done on 2000 and/or XP (I may be<br />
wrong, but really I can&#8217;t find the setting&#8230;). Things have changed<br />
with Vista it seems, however.</p>
<div class="post">[<i>Windows 2000 and Windows XP use the same<br />
mechanism as Windows Vista: Install the Italian MUI pack. I installed<br />
the Swedish MUI pack back in 2003 and <a href="http://blogs.msdn.com/oldnewthing/archive/2006/04/24/582153.aspx" rel="nofollow">switched to German in 2006</a>. There was also a brief stretch where I ran Traditional Chinese. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543003">
				<div id="div-comment-543003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543003">
			August 27, 2007 at 10:34 am</a>		</div>

		<p>Is the &quot;I got this from the tubes&quot; bit user-accessible? I don&#8217;t see anything about it in SetFileAttributes or any immediately obviously related function.</p>
<p>Note: I don&#8217;t care if it&#8217;s write-only, but it seems like a useful tag for files downloaded through means other than Internet Explorer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543013">
				<div id="div-comment-543013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543013">
			August 27, 2007 at 10:37 am</a>		</div>

		<p>So why does sigverif show all of the .NET dlls as unsigned?</p>
<div class="post">[<i>I don&#8217;t know but I can guess, and so can you. The<br />
.NET files are not in the signature catalogs since they don&#8217;t<br />
come from the core OS group. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543043">
				<div id="div-comment-543043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543043">
			August 27, 2007 at 11:03 am</a>		</div>

		<p>Bob,</p>
<p>The &quot;downloaded from the Internet&quot; tag is written into an alternative data stream (ADS) on the file, at least if the file lives on an NTFS drive.</p>
<p>If you search for &quot;Internet Explorer Alternative Data Streams Zone.Identifier&quot; you&#8217;ll find a few pages talking about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543053">
				<div id="div-comment-543053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adrian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543053">
			August 27, 2007 at 11:19 am</a>		</div>

		<p>Actually, I think the commentor about multiple-character input to a drop-down box is a good idea. &nbsp;I don&#8217;t understand why Raymond thinks the default drop-down control does this.</p>
<p>Empirically, it seems the drop-down controls look only at the most recently typed character and select the first item that starts with that character. &nbsp;If several items start with the same character, typing additional characters doesn&#8217;t help. &nbsp;If you type the same character over-and-over, however, the selection will move down through items that start with that character. &nbsp;That&#8217;s something, but it&#8217;s not a great solution in a long list.</p>
<div class="post">[<i>Okay, I sat down and wrote the program. We&#8217;ll see it tomorrow since it&#8217;s too big to fit in a comment. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543063">
				<div id="div-comment-543063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543063">
			August 27, 2007 at 11:23 am</a>		</div>

		<p>Cool. Thanks, Leo. I doubt I would have found that on my own.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543073">
				<div id="div-comment-543073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ace</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543073">
			August 27, 2007 at 11:31 am</a>		</div>

		<blockquote><p>
  &gt; Raymond: (&#8230;)I installed the Swedish MUI (&#8230;)
</p></blockquote>
<p>In case other people didn&#8217;t know (like me):</p>
<p><a rel="nofollow" target="_new" href="http://www.microsoft.com/globaldev/DrIntl/faqs/MUIFaq.msp" rel="nofollow">http://www.microsoft.com/globaldev/DrIntl/faqs/MUIFaq.msp</a></p>
<p>&quot;Q: How can I acquire Windows MUI?</p>
<p>A: The Windows XP/2000 MUI is sold only through Volume Licensing programs such as the Microsoft Open License Program (MOLP / Open), Select, and Enterprise agreement (or with a new computer as an OEM version at customer request). It is not available through retail channels.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543083">
				<div id="div-comment-543083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DeGustibus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543083">
			August 27, 2007 at 11:47 am</a>		</div>

		<blockquote><p>
  &gt; [Windows 2000 and Windows XP use the same mechanism as Windows Vista: Install the Italian MUI pack. I installed the Swedish MUI pack back in 2003 and switched to German in 2006. There was also a brief stretch where I ran Traditional Chinese. -Raymond]
</p></blockquote>
<p>Cool. Didn&#8217;t know about that :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543153">
				<div id="div-comment-543153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543153">
			August 27, 2007 at 12:35 pm</a>		</div>

		<p>&quot;Drop down lists do let you type multiple characters.&quot;</p>
<p>Only if the combo box is created with the CBS_SORT style. A lot of people assume there&#8217;s no reason to include the style if the items they&#8217;re inserting are already in sorted order.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543163">
				<div id="div-comment-543163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543163">
			August 27, 2007 at 12:49 pm</a>		</div>

		<p>Hi, it&#8217;s me!</p>
<p>When I said &quot;should&quot; I just meant &quot;usually do&quot; so there is no disagreement. Actually, if you read the second sentence (&quot;Similarly-named malware won&#8217;t be signed by Microsoft..&quot;) I think it makes the previous sentence&#8217;s use of &quot;should&quot; pretty clear. You simply misunderstood. No sarcasm is needed to deflate a point I didn&#8217;t make.</p>
<p>My point on long file names is that users are suckers for cool sounding names. Many users are quite comfortable with clicking through scary warning dialogs. The more they encounter (I&#8217;m talking to you, Vista UAC) the easier it is to click OK.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543173">
				<div id="div-comment-543173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543173">
			August 27, 2007 at 12:53 pm</a>		</div>

		<p>&#8220;Windows XP Service Pack 2 added the ability to mark a file as &#8220;I got this from the Internet.&#8221; (Internet Explorer applies this marking when you download a file from the Internet.) &#8220;</p>
<p>How can I, as a user, see this ? It&#8217;s one of the things I miss when I have to use Windows instead of a Mac. Normally, when I want to see where I got some piece of documentation from, I just right-click the file and select &#8220;Get info&#8221; &nbsp;and the original URL is right there in the file info screen. Really useful when e.g. you need to specify the source of some information in a paper.</p>
<p>How is this stored in Win32 an where is it exposed in the UI ?</p>
<div class=post>[<i>Right-click, Properties (approximately equivalent to &#8220;Get info&#8221; I guess), &#8220;This file came from another computer and might be blocked to help protect this computer.&#8221; Windows doesn&#8217;t track the URL the file came from, since there&#8217;s no technical reason to keep it. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543183">
				<div id="div-comment-543183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe Bruno</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543183">
			August 27, 2007 at 12:56 pm</a>		</div>

		<p>And however &#8220;multilingual&#8221; Windows may be, it still isn&#8217;t available in English.</p>
<div class=post>[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2004/06/09/151689.aspx#151773" rel="nofollow">Old news</a>. No need to rehash. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543193">
				<div id="div-comment-543193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Carlin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543193">
			August 27, 2007 at 12:59 pm</a>		</div>

		<p>&#8220;Only if the combo box is created with the CBS_SORT style. A lot of people assume there&#8217;s no reason to include the style if the items they&#8217;re inserting are already in sorted order.&#8221;</p>
<p>This is what I was talking about. &nbsp;Internet Explorer 6 (dunno about 7. &nbsp;I&#8217;m a firefox man myself) does not respond to multiple keys, only the first one. &nbsp;Sorry I wasn&#8217;t more clear in my original post.</p>
<div class=post>[<i>Oh, I thought your comment was another &#8220;Since somebody said &#8216;drop down&#8217; I&#8217;m going to ask an unrelated question about drop downs&#8221; type of comment. Sorry. And since it appears that the original point has been confirmed, I guess I can pull that post which I already wrote. It&#8217;ll go into the &#8220;articles which were written but never posted&#8221; dustbin, like the stories about Bob. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543203">
				<div id="div-comment-543203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543203">
			August 27, 2007 at 1:09 pm</a>		</div>

		<p>Interesting to notice that sigverif only asserts that the file has a digital signature, not that it is valid. How&#8217;s that? Quick test:</p>
<p>Copy comdlg32.ocx (signed) from system32 to temp or somewhere else.</p>
<p>Verify the signature with both sigverif and by clicking properties / digital signatures / details. Both seem ok to this point.</p>
<p>Modify the file by just adding some stuff to the end of it; suggestion:</p>
<p>copy comdlg32.ocx + con comdlg32.ocx [Return]</p>
<p>[type some stuff here][F6][Return]</p>
<p>Verify the signature with both sigverif and by clicking properties / digital signatures / details. The properties page will complain (the digital signature is not valid) while sigverif will just say that it is signed, no complains.</p>
<p>I know validating the signature is expensive, but is this really by default? Seems to me this could be exploited as a way to inject some code into a system file &#8211; getting it to run is something else though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543213">
				<div id="div-comment-543213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543213">
			August 27, 2007 at 1:11 pm</a>		</div>

		<p>I played around with the Zone-Identifier some time ago but I couldn&#8217;t get it working on Windows Server 2003 SP2. Any ideas what could be going wrong?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543263">
				<div id="div-comment-543263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543263">
			August 27, 2007 at 1:48 pm</a>		</div>

		<p>But I&#8217;d like to read stories about Bob&#8230; :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543273">
				<div id="div-comment-543273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543273">
			August 27, 2007 at 2:07 pm</a>		</div>

		<p>&#8220;Windows doesn&#8217;t track the URL the file came from, since there&#8217;s no technical reason to keep it. -Raymond&#8221;</p>
<p>It&#8217;s metadata, and quite useful metadata at that, why should you throw it away ? </p>
<p>If I want to find all the files I got from a certain website, I can do a quick Spotlight search and find out.</p>
<div class=post>[<i>It wasn&#8217;t necessary to achieve the original goal of AES. Perhaps the goals were wrong, in your opinion. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543283">
				<div id="div-comment-543283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.honestillusion.com' rel='external nofollow' class='url'>James Curran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543283">
			August 27, 2007 at 2:18 pm</a>		</div>

		<p>I can confirm that not all Microsoft files are signed. &nbsp;I recall just a couple days ago, downloading a file directly from microsoft.com, and upon installing it, was warned that it was not signed.</p>
<p>I unfortunately don&#8217;t remember exactly what file it was, but I&#8217;ll acknowledge that it was neither a Windows component nor part of any major MS application. &nbsp;It was probably some ancillary tool from MSDN, of approx the PowerToy level.</p>
<div class=post>[<i>I added two parentheticals in the opening sentence to forestall comments like this and I guess it didn&#8217;t work. Don&#8217;t make me bring back the Nitpicker&#8217;s Corner. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543303">
				<div id="div-comment-543303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543303">
			August 27, 2007 at 3:51 pm</a>		</div>

		<p>&quot;I can confirm that not all Microsoft files are signed. &nbsp;I recall just a couple days ago, downloading a file directly from microsoft.com, and upon installing it, was warned that it was not signed.&quot;</p>
<p>Microsoft is a large company. &nbsp;Some files are going to slip by without the signature. &nbsp;I think the &quot;(or should be)&quot; part of the title should have made that clear.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543323">
				<div id="div-comment-543323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Walken</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543323">
			August 27, 2007 at 4:39 pm</a>		</div>

		<p>Along the same lines &#8211; but kind of the reverse, when I run an application I have built with VS6.0 in C++ under Vista and the app is loaded from a different computer &#8211; or server &#8211; Vista always pops up the &quot;The Publisher could not be verified&#8230;&quot; message. How does one make that one go away?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543343">
				<div id="div-comment-543343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543343">
			August 27, 2007 at 4:52 pm</a>		</div>

		<p>Chris: &nbsp;Get a code-signing cert and sign the thing? &nbsp;(Of course then your cert has to be trusted.)</p>
<p>Nah, that would be too obvious&#8230; &nbsp;how about copy the file locally? &nbsp;;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543373">
				<div id="div-comment-543373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Wolf Logan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543373">
			August 27, 2007 at 5:09 pm</a>		</div>

		<p>&quot;Don&#8217;t make me bring back the Nitpicker&#8217;s Corner.&quot; -Raymond</p>
<p>If you kids don&#8217;t settle down I&#8217;ll turn this blog around and we&#8217;ll go RIGHT HOME!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543403">
				<div id="div-comment-543403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543403">
			August 27, 2007 at 6:09 pm</a>		</div>

		<p>&#8220;Oh, I thought your comment was another &#8220;Since somebody said &#8216;drop down&#8217; I&#8217;m going to ask an unrelated question about drop downs&#8221; type of comment.&#8221;</p>
<p>As far as I can see, this was another person commenting, not the same one.</p>
<p>&#8220;Sorry.&#8221;</p>
<p>For what?</p>
<p>&#8220;And since it appears that the original point has been confirmed, I guess I can pull that post which I already wrote. It&#8217;ll go into the &#8220;articles which were written but never posted&#8221; dustbin, like the stories about Bob.&#8221;</p>
<p>So instead of thanking someone for inspiring you to write something usefull, you are going to &#8220;punish&#8221; everyone because you misunderstood one person&#8217;s comment?</p>
<p>What exactly do you think you will accomplish by punishing everyone because you believe someone is a jerk or offtopic? We have even less power over that person than you so your punishment won&#8217;t have any effect other than pissing people off.</p>
<p>That kind of punishment would only work in a jail cell where you have say 10 inmates and one of them does something bad. Then you punish all 10 and next time someone tries to misbehave other 9 kick his ass to avoid being punished because of him.</p>
<p>Note that we are on the Internet, the readers of your blog are not in the same cell and can&#8217;t kick each others ass so it simply doesn&#8217;t work.</p>
<p>You are just irking the others who didn&#8217;t deserve to be punished and provoke them to act bad themselves because being nice obviously doesn&#8217;t make any difference.</p>
<p>You act so childish sometimes. Better get your act together. What you need is thicker skin.</p>
<div class=post>[<i>I didn&#8217;t consider it inspiration to write something useful. I considered a chore to illustrate something that I thought didn&#8217;t need illustrating. So it&#8217;s good that it&#8217;s gone, but it&#8217;s bad that I had to take the time to write it in the first place. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543413">
				<div id="div-comment-543413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.einsteintech.net' rel='external nofollow' class='url'>Josh Einstein</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543413">
			August 27, 2007 at 6:10 pm</a>		</div>

		<p>Hey maybe it&#8217;s just me but I read that comment as saying &quot;If it were a Microsoft file, it would have a signature.&quot; Not as a suggestion to do so. Seems like a silly thing to single someone out for.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-ericlippert odd alt thread-odd thread-alt depth-1" id="comment-543113">
				<div id="div-comment-543113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Eric+Lippert' rel='external nofollow' class='url'>Eric Lippert</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543113">
			August 27, 2007 at 11:58 am</a>		</div>

		<p>&gt; So why does sigverif show all of the .NET dlls as unsigned?</p>
<p>The .NET DLLs are signed with the Microsoft Strong Name, not with a verisign certificate. &nbsp;</p>
<p>Both strong naming and certificate signing provide evidence that a particular chunk of code was produced by a particular organization. &nbsp;However, there are many differences between strong name signing and certificate signing; key differences in my mind are:</p>
<p>* Strong name signatures do not &quot;chain&quot; the way certificate signatures do. With certs you can say &quot;trust anyone that this signing authority trusts&quot;. With strong names, you have to make an individual trust decision for each.</p>
<p>* There is no revocation mechanism for strong names.</p>
<p>* Different certificates have different stated purposes. There is no such mechanism for strong names.</p>
<p>* Strong names and certificates solve related but different problems. Strong names solve the problem &quot;I am trying to load some code and wish to be certain that I am loading the code I think I am loading.&quot; &nbsp;Certificates solve the problem of &quot;I&#8217;m loading code that I don&#8217;t know what it does, so I want to only load code from providers that I have a trust relationship with.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543253">
				<div id="div-comment-543253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543253">
			August 27, 2007 at 1:48 pm</a>		</div>

		<p>&gt;&gt; Yes indeed, all Microsoft files are (or should be) digitally signed (as far as I&#8217;m aware). &lt;&lt;</p>
<p>It is true that they should be signed. &nbsp;Unfortunately, the reality is that not all Microsoft files are signed. &nbsp;Now, I&#8217;m not saying that this is Raymond&#8217;s fault or problem, but that doesn&#8217;t change the fact that MS does not always sign files that they provide for installation on Windows machines.</p>
<p>Some examples on my machine: &nbsp;mdimon.dll, mdm.exe, mscoree.dll, asiserver.exe</p>
<p>Now, these are not *Windows* files, but I still believe that MS should be more strict about whatever policy they have on signing files for public distribution. &nbsp;</p>
<p>It would be nice if I could be reasonably sure that an unsigned file that claims to be from Microsoft was malware. &nbsp;As it stands today that would simply be crying wolf.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-543463">
				<div id="div-comment-543463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543463">
			August 27, 2007 at 10:19 pm</a>		</div>

		<p>Once again I read down the comments to yet another post on the Old New Thing and mostly what I see are people doing their best to piss Raymond off.</p>
<p>This blog is one of the most valuable of all the MS blogs. &nbsp;When are you guys going to get that?</p>
<p>Maybe Raymond should start up a private blog and invite only those who want to learn to be better programmers and will never require a &quot;Nitpicker&#8217;s corner&quot;. &nbsp;Anyone who mouths off gets booted &#8211; forever.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543483">
				<div id="div-comment-543483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">bramster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543483">
			August 27, 2007 at 11:17 pm</a>		</div>

		<p>Had a nice bike ride today. &nbsp;What else is important?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543523">
				<div id="div-comment-543523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.balioglu.com' rel='external nofollow' class='url'>Can</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543523">
			August 28, 2007 at 2:45 am</a>		</div>

		<p>Actually I&#8217;ve always found the Microsoft signing process somewhat limited. The embedded signature ensures the integrity of the file and the company behind it. However what people want to know is whether the file is harmful for their computer (has a serious bug, is malware), whether there are incompatibilites with the software already installed on their system, etc.</p>
<p>I&#8217;m developing a small extension to the Authenticode system, which allows you to embed much richer metadata in your files. The software will also &quot;hook&quot; the verification process and display you this additional metadata in a dialog box. The metadata contains the publisher specific product ID, product name, web site address, description, version, license type, release status, release date, language, category, ESRB rating, system requirements, publisher name and publisher web site address.</p>
<p>The digital signing of files with extensive metadata could be the solution for malware, but Microsoft has never seen the Authenticode technology in this way. Today it&#8217;s just a monopoly of Microsoft and Verisign with an annoying warning dialog box for us.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543473">
				<div id="div-comment-543473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thorsten Engler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543473">
			August 27, 2007 at 11:14 pm</a>		</div>

		<p>Actually Raymond, I read this:</p>
<p>&gt;&gt;&gt;The Microsoft file should have embedded vendor/product information saying it&#8217;s from Microsoft and will be cryptographically signed by Microsoft. Similarly-named malware won&#8217;t be signed by Microsoft, unless Verisign slipped up *again* and issued another bogus certificate.&lt;&lt;&lt;</p>
<p>as a statement of fact. (As in &quot;that&#8217;s what Microsoft is doing, s o if you want to know if a file is legit, look at the signature&quot;).</p>
<p>As for the &quot;Verisign slipped up *again*&quot;, I don&#8217;t have a reference &nbsp;url right now, but sometime in the past it was in the news that Verisign handed out a &quot;Microsoft&quot; certificate to someone without any connections to Microsoft. It naturally was later revoked once that was noticed, but for some time there was a valid signature in the wild which could potentially be used to sign Malware with a &quot;Microsoft&quot; signature. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543533">
				<div id="div-comment-543533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">friscom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543533">
			August 28, 2007 at 6:22 am</a>		</div>

		<p>..the question is: why don&#8217;t we know (from Microsoft) what files of theirs should be signed and what not?</p>
<p>How can I state whether a file is correct if I do not know from the beginning if it has a signature?</p>
<p>To say, in my Win2K3 server the Explorer.exe and Mstsc.exe are unsigned, accordingly to sigverif.</p>
<p>Should I assume it is not the original? How should I know about them (and all others) before I start investigating without a reference?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543543">
				<div id="div-comment-543543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543543">
			August 28, 2007 at 7:29 am</a>		</div>

		<p>&quot;copy comdlg32.ocx + con comdlg32.ocx &#8230; Seems to me this could be exploited as a way to inject some code into a system file &#8211; getting it to run is something else though.&quot;</p>
<p>It rather involved being on the other side of this airtight hatchway&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543583">
				<div id="div-comment-543583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ema</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543583">
			August 28, 2007 at 8:42 am</a>		</div>

		<p>Lol this is the problem with closed source software&#8230;</p>
<p>You don&#8217;t know what cr*p you&#8217;re executing &#8217;till your PC will explode&#8230;</p>
<p>In this case Linux and AppArmor are the best&#8230;</p>
<p>Cheers,</p>
<p>Ema.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543633">
				<div id="div-comment-543633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543633">
			August 28, 2007 at 10:55 am</a>		</div>

		<p>Chris: &quot;It rather involved being on the other side of this airtight hatchway&#8230;&quot;</p>
<p>No, that was Raymond&#8217;s second point: &quot;Before you run such a file, Explorer will prompt you with a warning and show you the digital signature&#8230;&quot;</p>
<p>So, if OS believes the signature stays intact on a modified file, it might have an evil payload but the OS will show you the valid signature and give you confidence about running the file. I have no idea whether a real exploit could come from that though. Let&#8217;s hope not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543643">
				<div id="div-comment-543643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kuwanger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543643">
			August 28, 2007 at 11:05 am</a>		</div>

		<blockquote><p>
  &gt;copy comdlg32.ocx + con comdlg32.ocx &#8230; Seems to me this could be exploited as a way to inject some code into a system file &#8211; getting it to run is something else though.</p>
<p>  It rather involved being on the other side of this airtight hatchway&#8230;
</p></blockquote>
<p>The whole point of the signature is to be able to use an untrusted medium as a carrier for trusted content. &nbsp;If the untrusted medium can modify the trusted content without detection, the trusted content can&#8217;t really be trusted.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543703">
				<div id="div-comment-543703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ema</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543703">
			August 28, 2007 at 11:18 am</a>		</div>

		<p>Btw, you can &quot;easily&quot; recompute the signature (MD5 SHA-1&#8230;). You can do at run time if the OS is a good one (and no, I&#8217;m not referring to Millennium Edition II).</p>
<p>Cheers,</p>
<p>Ema! :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543733">
				<div id="div-comment-543733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Illuminator</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543733">
			August 28, 2007 at 11:21 am</a>		</div>

		<p>Hey Ema, my Eureka moment came when I abandoned SQLite for SQL Server Compact Edition.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543823">
				<div id="div-comment-543823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pretentiousname.com' rel='external nofollow' class='url'>Leo Davidson</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543823">
			August 28, 2007 at 12:11 pm</a>		</div>

		<blockquote><p>
  The more they encounter (I&#8217;m talking to you, Vista UAC) the easier it is to click OK.
</p></blockquote>
<p>IMO you should blame Explorer for that, not UAC itself. I think UAC is absolutely fine as a mechanism, Explorer just uses it really badly (e.g. prompting you four times to create one directory). The excessive prompting isn&#8217;t an inherent part of UAC and there is at least one alternative file manager which will only prompt you once in that example.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-543843">
				<div id="div-comment-543843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Keeron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543843">
			August 28, 2007 at 12:45 pm</a>		</div>

		<p>Leo wrote: &quot;&#8230; Explorer just uses it really badly (e.g. prompting you four times to create one directory)&#8230;&quot;</p>
<p>I&#8217;ve never seen more than 1 prompt on anything I was doing. And I expected the prompt since it wasn&#8217;t a standard user task (like deleting a file off the root, or launching applications like Regedit, etc). That being said, I&#8217;ve never also ran into issues where I had to cancel the prompt (IE is in protected mode, running standard user on Vista)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-543903">
				<div id="div-comment-543903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">orcmid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-543903">
			August 28, 2007 at 1:06 pm</a>		</div>

		<p>I just ran a brand new Vista Home Premium PC through setup for my sister. &nbsp;As part of adding a Microsoft Laser Desktop 6000 R2 keyboard and mouse (ditching the minimalist keyboard that Dell ships at no extra charge), I had to download two updates for Vista. &nbsp;These were from <a rel="nofollow" target="_new" href="http://www.microsoft.com/hardware/downloads" rel="nofollow">http://www.microsoft.com/hardware/downloads</a>.</p>
<p>Neither of them was signed. &nbsp;They had &quot;unknown&quot; suppliers &#8212; so not even version and origin information, apparently.</p>
<p>My sister loves the computer. &nbsp;The Media Center blew her mind, as did the snazzy upgrades to the games. &nbsp;She&#8217;s likely to become addicted to the Mahjong tiles solitaire in a day or two. &nbsp;She&#8217;s ordering broadband today.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-544203">
				<div id="div-comment-544203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-544203">
			August 29, 2007 at 3:04 am</a>		</div>

		<p>Thank you Ema. I would never have known just how great Linux is had you not hijacked this topic.</p>
<p>And now that your work is done, that means you can go somewhere else&#8230; right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-544193">
				<div id="div-comment-544193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ema</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-544193">
			August 29, 2007 at 2:31 am</a>		</div>

		<p>Illuminator wrote: &quot;Hey Ema, my Eureka moment came when I abandoned SQLite for SQL Server Compact Edition.&quot;</p>
<p>Why? What do you mean?</p>
<p>Anyway when you run closed source applications you can only safe with Linux+AppArmor&#8230;In Windows you won&#8217;t never be safe.</p>
<p>You don&#8217;t receive any sources of the OS, so it can&#8217;t be trusted (considering all the cr*p Microsoft guys inserted in new Millenium Edition II &#8211; bad graphics performance, bad network performance and so on &#8211; personally I don&#8217;t know anyone informed about facts that *really* trusts ME II).</p>
<p>Cheers,</p>
<p>Ema.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-544223">
				<div id="div-comment-544223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ema</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-544223">
			August 29, 2007 at 3:51 am</a>		</div>

		<p>Sorry I didn&#8217;t mean to flame.</p>
<p>But to be honest I think that I haven&#8217;t hijacked the thread.</p>
<p>Digital signatures is *simply* about trust.</p>
<p>The root of the problem is when you can&#8217;t trust the verifier (because it can be bugged sometimes or you don&#8217;t have the sources).</p>
<p>Simple as cake.</p>
<p>And staying on topic, with Linux+AppArmor you can take the risk to run unsecure/unverified/closed-source software.</p>
<p>Is it possible in Windows?</p>
<p>I&#8217;m serious, how can you trust an operative systems that, for example, downgrades hardware performances to *try* to better support DRM?</p>
<p>Cheers,</p>
<p>Ema! :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-544483">
				<div id="div-comment-544483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://support.microsoft.com/kb/293818' rel='external nofollow' class='url'>Erroneous Certificates</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-544483">
			August 29, 2007 at 11:27 pm</a>		</div>

		<p>Two &quot;microsoft&quot; certificates from verisign have been revoked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-544493">
				<div id="div-comment-544493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Non-existing os</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-544493">
			August 29, 2007 at 11:39 pm</a>		</div>

		<p>Earlier OSes than vista can not really be called multilingual in the same sense that vista can. Those old OSes where not as easy to install, or even buy for that matter. Had to use several CDs (no dvds), cost tens of thousand $$$, and was not really ready for prime time, and therefore not promoted especially resolute as an product by ms. Comparable to w2k/xp for alpha or itanium.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-544553">
				<div id="div-comment-544553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andrei Muraru</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-544553">
			August 30, 2007 at 4:44 am</a>		</div>

		<p>It&#8217;s there a public API function that would allow me to check that a file was downloaded from the Internet?</p>
<p>Thanks.</p>
<div class="post">[<i><a href="http://blogs.msdn.com/oldnewthing/archive/2007/05/21/2757223.aspx" rel="nofollow">Don&#8217;t be helpless</a>. There is enough information for you to build a useful search query. I didn&#8217;t know the answer either, but after some web searching I got the answer in five minutes. You can do it too. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-546373">
				<div id="div-comment-546373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-546373">
			September 3, 2007 at 3:11 am</a>		</div>

		<p>Hahaha, I just figured out Denial Of Service attack (well sort of) using this &#8220;downloaded from the Internet&#8221; attack vector:</p>
<p>1. Create a text file called nag_user.txt with the following content:</p>
<p>&#8212;snip&#8212;</p>
<p>[ZoneTransfer]</p>
<p>ZoneID=3</p>
<p>&#8212;snip&#8212;</p>
<p>2. Do this:</p>
<p>FOR /R C: %i IN (*.exe) DO type nag_user.txt &gt; &#8220;%i&#8221;:Zone.Identifier</p>
<p>You should be able to do it as a guest too as long as you have write access.</p>
<p>It will leave the user with a ton of .exe files asking for confirmation and no easy way of resetting them all (except by using 3rd party utilities like STREAMS).</p>
<div class="post">[<i>&#8220;As long as you have write access.&#8221; Well, if you have write access, then just <a href="http://blogs.msdn.com/oldnewthing/archive/2007/08/07/4268706.aspx" rel="nofollow">copy pwnz0rd.exe victim.exe</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-546403">
				<div id="div-comment-546403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-546403">
			September 3, 2007 at 3:40 am</a>		</div>

		<p>Eh, in experimenting with this it seems that I managed to find a real bug.</p>
<p>1. I constructed a file identical to the nag_user.txt above but without the CR/LF pair at the end of second line.</p>
<p>2. Then I did this:</p>
<p>type nag_user.txt &gt; test.exe:Zone.Identifier</p>
<p>3. Then I got some random binary data (1291 bytes of it in case it matters) which doesn&#8217;t contain any 0x00 in it and appended it like this:</p>
<p>type random.bin &gt;&gt; test.exe:Zone.Identifier</p>
<p>4. Result is that explorer still shows the file has been downloaded in file properties and offers the unlock button but it runs it without asking!</p>
<div class="post">[<i>If your goal was to make the file run without a warning, then you&#8217;re still trying too hard. Just delete the zone identifier entirely. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-546413">
				<div id="div-comment-546413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-546413">
			September 3, 2007 at 3:54 am</a>		</div>

		<p>Oops&#8230; my mistake, Explorer _does_ prompt to run the file, if you run it from Total Commander then you don&#8217;t get a prompt. I guess it is because TC launches applications using some other method (CreateProcess?).</p>
<p>&#8220;Well, if you have write access&#8230;&#8221;</p>
<p>I agree, but this is harder to notice and harder to remove unless you are prepared to zap all the streams on all the exe files and you are aware that tools which enable you to do so exist.</p>
<p>Frankly I don&#8217;t know exact ACLs for C: (since mine is formatted as FAT32) but newly formatted NTFS partitions have write access for the Users group and I presume that the same group has write access at least for the Program Files.</p>
<div class="post">[<i>You&#8217;re taking my remark out of context. I was referring to file write access, not directory write access. I thought this was obvious since I was talking about how you can modify a file. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-546423">
				<div id="div-comment-546423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.levicki.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-546423">
			September 3, 2007 at 3:58 am</a>		</div>

		<p>&#8220;Just delete the zone identifier entirely&#8221;</p>
<p>I was actually trying to crash Explorer :)</p>
<p>It is most curious why Explorer uses INI file format for that setting? Why parse strings when you can have one byte/word/dword?</p>
<div class="post">[<i>You need a better imagination. Extensibility? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-546453">
				<div id="div-comment-546453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Authenticode</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20070827-00/?p=25403#comment-546453">
			September 3, 2007 at 8:06 am</a>		</div>

		<p>Where can I buy certificates *cheap*? I&#8217;m a hobby programmer and want to get rid of the warning.</p>
<p>If it&#8217;s not possible, all I can think of is that MS doesn&#8217;t want hobby programmers developing &amp; distributing software for their OS.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

