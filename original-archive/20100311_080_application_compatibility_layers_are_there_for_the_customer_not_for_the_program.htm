<html>
<head>
<title>Application compatibility layers are there for the customer, not for the program</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Application compatibility layers are there for the customer, not for the program</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 11, 2010 / year-entry #81</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>39</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Some time ago, a customer asked this curious question (paraphrased, as always): Hi, we have a program that was originally designed for Windows†XP and Windows Server†2003, but we found that it runs into difficulties on Windows†Vista. We've found that if we set the program into Windows†XP compatibility mode, then the program runs fine on Windows†Vista....</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Some time ago, a customer asked this curious question (paraphrased, as always):</p>
<blockquote class="q"><p> Hi, we have a program that was originally designed for Windows&nbsp;XP and Windows Server&nbsp;2003, but we found that it runs into difficulties on Windows&nbsp;Vista. We've found that if we set the program into Windows&nbsp;XP compatibility mode, then the program runs fine on Windows&nbsp;Vista. What changes do we need to make to our installer so that when the user runs it on Windows&nbsp;Vista, it automatically runs in Windows&nbsp;XP compatibility mode? </p>
</blockquote>
<p> Don't touch that knob; the knob is there for the customer, not for the program. And it's there to clean up after your mistakes, not to let you hide behind them. </p>
<p> It's like saying, "I normally toss my garbage on the sidewalk in front of the pet store, and every morning, when they open up, somebody sweeps up the garbage and tosses it into the trash. But the pet store isn't open on Sundays, so on Sundays, the garbage just sits there. How can I get the pet store to open on Sundays, too?" </p>
<p> The correct thing to do is to figure out what your program is doing wrong and fix it. You can use the Application Compatibility Toolkit to see all of the fixes that go into the Windows&nbsp;XP compatibility layer, then apply them one at a time until you find the one that gets your program running again. For example, if you find that your program runs fine once you apply the VersionLie shim, then go and fix your program's operating system version checks. </p>
<p> But don't keep throwing garbage on the street. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (39)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-matteo even thread-even depth-1" id="comment-818693">
				<div id="div-comment-818693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818693">
			March 11, 2010 at 7:37 am</a>		</div>

		<p>&#8230;and the reply was: tl;dr.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818703">
				<div id="div-comment-818703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">blah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818703">
			March 11, 2010 at 9:42 am</a>		</div>

		<p>Ha. I wish Microsoft did the same for web standards, but no, they had to introduce the X-UA header to let sites remain in the dark ages.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818713">
				<div id="div-comment-818713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818713">
			March 11, 2010 at 10:00 am</a>		</div>

		<p>&quot;Don&#8217;t keep throwing garbage on the street&quot;</p>
<p>That would make a great PDC session title&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818723">
				<div id="div-comment-818723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">blahyourself</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818723">
			March 11, 2010 at 10:01 am</a>		</div>

		<p>@blah</p>
<p>X-UA compatibility header == Website admin telling IE8 that the site is not standards compliant hence IE8 should render the site with reduced standards compliance of IE7.</p>
<p>In fact, its analogous to the application compatibility tab.</p>
<p>Though I guess, facts are never an issue when bashing Microsoft.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818743">
				<div id="div-comment-818743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818743">
			March 11, 2010 at 10:10 am</a>		</div>

		<p>&quot;What changes do we need to make to our installer so that when the user runs it on Windows Vista, it automatically runs in Windows XP compatibility mode?&quot;</p>
<p>&lt;sarcasm&gt;</p>
<p>Nothing. Microsoft will figure out what shims your program needs and apply them for you. Tell your customers to wait for a hotfix from Microsoft.</p>
<p>&lt;/sarcasm&gt;</p>
<p>I&#8217;m glad Microsoft publishes the list of shimed applications in the KB articles. Now I know which apps to avoid.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818753">
				<div id="div-comment-818753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818753">
			March 11, 2010 at 10:43 am</a>		</div>

		<p>Don&#8217;t keep throwing Vista on the street.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818763">
				<div id="div-comment-818763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ShellEx</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818763">
			March 11, 2010 at 10:49 am</a>		</div>

		<p>Does Microsoft apply appcompat shims to shell extensions? No apps are broken more than shell extensions in the XP &gt; Vista transition.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818773">
				<div id="div-comment-818773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818773">
			March 11, 2010 at 11:06 am</a>		</div>

		<p>@blahyourself: I think ‚Äúblah‚Äù makes a good point ‚Äì the author of the content/app should not instruct the browser/OS to use the compatibility mode. They should fix their crap. The purpose of the compatibility mode is to run applications that predate the OS (and is activated by the end user). So if the app/website knows about the compatibility mode then it doesn‚Äôt predate the OS/browser, therefore should not use the mode :)</p>
<p>@ShellEx: I‚Äôve come to accept that shell extensions are going to be broken from one Windows version to the next. The coupling between a shell extension and the shell is much tighter than between an arbitrary app and the OS. So to make any progress in the shell department, MS has to sometimes break compatibility. Now if only that progress didn‚Äôt break some of my favorite shell features‚Ä¶ :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818783">
				<div id="div-comment-818783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.jagaimo.com/' rel='external nofollow' class='url'>Jason Truesdell</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818783">
			March 11, 2010 at 11:34 am</a>		</div>

		<p>Redmond, WA, circa 2010. Forced to deal with misbehaving apps that use undocumented methods to force invocation of application compatibility shims, the app compatibility team created a shim to simulate the application compatibility shim mechanism. Shortly thereafter, the universe ceased to exist due to the hitherto-unknown metashim paradox.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818813">
				<div id="div-comment-818813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">f.aa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818813">
			March 11, 2010 at 11:49 am</a>		</div>

		<p>Ivo: The reason shell extentions are more prone to breaking isn&#8217;t because it&#8217;s &quot;tighter&quot; or because Microsoft &quot;break&quot; compatability. It&#8217;s because the people writing them do horrific, undocumented and unsupported things.</p>
<p>Or if you wish; They are throwing garbage on the street.</p>
<p>If someone codes something to use a hard coded window class name, or the 6th memory location on the stack on Tuesdays after 2pm, then of course it&#8217;ll break sooner or later.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818823">
				<div id="div-comment-818823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">f.aa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818823">
			March 11, 2010 at 11:49 am</a>		</div>

		<p>Ivo: The reason shell extentions are more prone to breaking isn&#8217;t because it&#8217;s &quot;tighter&quot; or because Microsoft &quot;break&quot; compatability. It&#8217;s because the people writing them do horrific, undocumented and unsupported things.</p>
<p>Or if you wish; They are throwing garbage on the street.</p>
<p>If someone codes something to use a hard coded window class name, or the 6th memory location on the stack on Tuesdays after 2pm, then of course it&#8217;ll break sooner or later.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818843">
				<div id="div-comment-818843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818843">
			March 11, 2010 at 1:42 pm</a>		</div>

		<p>Not to go too off-topic, but I really miss the IColumnProvider interface. &nbsp;Properties are fine, but there is no way to register a property handler for all file types.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818853">
				<div id="div-comment-818853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Muller</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818853">
			March 11, 2010 at 1:44 pm</a>		</div>

		<p>My &#8216;favorite&#8217; class of compatibility bugs is (I don&#8217;t know if it has a proper name) native integer trucation/wraparound.</p>
<p>That is, there are important numbers, like Handles if I&#8217;m recalling correctly, that are defined as 32 bits, but early versions of Windows only used 16 of them.</p>
<p>So, many applications would get the number from the OS, only keep the low 16 bits, and then hand it back to the OS expecting it to refer to some resource. At that point if you are lucky, only the program fails; unlucky could be crash, data corruption, etc.</p>
<p>Back in the Windows 95 days I was hit by <a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/263044;" rel="nofollow"></a><a href="http://support.microsoft.com/kb/263044" rel="nofollow">http://support.microsoft.com/kb/263044</a>; my new 80GB drive worked fine until I crossed the 64GB boundry&#8230; at which point random data overwrote the boot sector, partition table, root directory&#8230;</p>
<p>I assume that&#8217;s why Microsoft requires signing for 64 bit device drivers. I would guess a lot of poorly converted ones would work fine, as long as they were only reading/writing the lowest 2GB of memory. But as soon as you cross that threshold, it&#8217;ll start writing to the address modulus 2^31. random crashes, corruption, etc. but only under heavy load, never in a simple scenario.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818863">
				<div id="div-comment-818863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dartme18</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818863">
			March 11, 2010 at 1:51 pm</a>		</div>

		<p>So, it says you posted at 7 am. &nbsp;Did you really post it at 7am? &nbsp;What were you doing awake before 7am to write and post this message?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818873">
				<div id="div-comment-818873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818873">
			March 11, 2010 at 2:40 pm</a>		</div>

		<p>@dartme18: Raymond has already explained this before in a different post, but I&#8217;m too lazy to look it up.</p>
<p>Raymond has written more than a year&#8217;s worth of articles in advance and has a script post them automatically each morning at 07:00.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818883">
				<div id="div-comment-818883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818883">
			March 11, 2010 at 2:46 pm</a>		</div>

		<p>@John Muller,</p>
<p>Back in XP gold days, many people hit 138GB (128GiB) boundary, and their data was thrashed&#8230; Someone didn&#8217;t think enough to artificially limit the reported size to avoid that.</p>
<p>@f.aa:</p>
<p>Once, Raymond wrote about a horrific thing they discovered that one column handler for a well known document viewer app was doing. That handler broke when layout of stack variables changed in Explorer.</p>
<p>Oh, I soooo wish Windows had a list of shame, and would flag Known Krappy Applications and Binaries. That would force the IHVs to get their Krap together.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818893">
				<div id="div-comment-818893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818893">
			March 11, 2010 at 3:32 pm</a>		</div>

		<p>That&#8217;s all just dandy I suppose, but what to do if the problem is inside a runtime library that you can&#8217;t fix? Yeah, you could spend hours in WinDbg tracing calls and writing patches, or even more time porting to a different framework or programming language even, or you say ‚Äòsod it, it works fine in compatibility mode &#8211; let&#8217;s get on with it.‚Äô</p>
<div class=post>[<i>You can go have a chat with the &#8220;What Microsoft needs to do is explicitly stop supporting broken apps&#8221; people and see if the two sides can come to some sort of understanding. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818903">
				<div id="div-comment-818903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marquess</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818903">
			March 11, 2010 at 3:50 pm</a>		</div>

		<p>@BCS</p>
<p>That&#8217;s a problem with company culture, which, just like venture capital and technical competence, is one of the things they have to manage to stay in business. If they can&#8217;t, it&#8217;s not Microsoft&#8217;s (or anyone else&#8217;s job) to fix their mess.</p>
<p>To get back on the metaphor: If it&#8217;s you wife who tells you to throw your garbage in front of the pet store, you have to take it up with your wife, not the store.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818913">
				<div id="div-comment-818913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818913">
			March 11, 2010 at 5:18 pm</a>		</div>

		<p>I can imagine that even if the issue can technically be fixed, sometimes they can&#8217;t.</p>
<p>They may have just allocated timeframe for quick fix that enables compatibility mode, so they&#8217;d run seriously behind schedule if they take time to find out all the &quot;gitches&quot; that cause compatibility problem in newer version of Windows.</p>
<p>And management level could be ignorant enough to deny request to extend the deadline, because, afterall, the application runs without significant problem if the compatibility mode enabled. Even assigning something like 2 weeks for checking those &quot;gitches&quot; couldn&#8217;t be justified for the mandays involved.</p>
<p>So as a smallpotato developer, what will you choose? 1) Working overtime unpaid to get the application fixed. 2) Sending such email hoping someone who knows better can tell them how to enable the switch and have their schedule be kept on time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818923">
				<div id="div-comment-818923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818923">
			March 11, 2010 at 5:21 pm</a>		</div>

		<p>Oh for those who doesn&#8217;t agree with my comment above, just remember that back in the day when Microsoft decide to rewrite Vista from scratch, how many people did say that&#8217;s a bad decision.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818933">
				<div id="div-comment-818933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jeremy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818933">
			March 11, 2010 at 5:55 pm</a>		</div>

		<p>Yeah, sometimes when I&#8217;m running late for work I have no choice but to throw the garbage in the street. &nbsp;I mean, I&#8217;d have to walk all the way over to the dumpster, that would take valuable time! &nbsp;Really, what jury could convict me for something I obviously had no other reasonable choice but to do?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818733">
				<div id="div-comment-818733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BCS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818733">
			March 11, 2010 at 10:08 am</a>		</div>

		<p>Good advice, as long as the person asking the question *can* fix the problem (they can still build it, no PHB gets in the way, etc.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818943">
				<div id="div-comment-818943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drakkie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818943">
			March 11, 2010 at 10:38 pm</a>		</div>

		<p>@Ivo</p>
<p>Good luck making a whole suite of web applications written especially for IE(7) standards compatible while also fixing bugs and implementing features being shouted for by customers. Guess which takes precedence?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818963">
				<div id="div-comment-818963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Grumpy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818963">
			March 12, 2010 at 1:16 am</a>		</div>

		<p>@Cheong: 3) Write a mail to $BOSS explaining what the consequences of not fixing this will be. CC someone who actually has to go and show the resulting app to a customer and someone who has to take support calls. Then let things develop as they will.</p>
<p>Of course, this only works if $BOSS is rational and the someones have enough clout to influence scheduling, but either way it&#8217;s SEP.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818973">
				<div id="div-comment-818973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818973">
			March 12, 2010 at 2:35 am</a>		</div>

		<p>[The link detector mangled John Muller&#8217;s KB link by including the trailing semicolon.]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-818983">
				<div id="div-comment-818983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818983">
			March 12, 2010 at 4:54 am</a>		</div>

		<p>You rightly chastise 3rd party developers to clean things up but oh the irony that this should come from a Microsoft employee! The tragic garbage that MS feeds developers has plagued the software development community for years. I hope there is a special place in hell for the guys that came up with UAC, SxS, the registry etc. That and Microsoft&#8217;s cross platform non-story and non-guiding guidance.</p>
<p>What I wouldn&#8217;t do even for a solid installation life cycle management tool under Windows!</p>
<p>Imagine actually being able to install IIS twice. Or install two versions of Word. Or have an uninstall actually uninstalls. Or have all my apps auto update without each one having to write their own updater.</p>
<p>How about supporting VS 2002/2003 on Win7?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818993">
				<div id="div-comment-818993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-818993">
			March 12, 2010 at 5:33 am</a>		</div>

		<blockquote><p>
  I hope there is a special place in hell for the guys that came up with UAC, SxS, the registry etc.
</p></blockquote>
<p>Aren&#8217;t those the poor guys who have to clean up someone else&#8217;s crap?</p>
<p>UAC &#8211; clean up because application developers are too stupid to grasp the concepts (1) &quot;multiuser environment&quot;, (2) &quot;do not run as root&quot;.</p>
<p>SxS &#8211; clean up because application developers are too stupid to grasp the concepts (1) do not update version N with version N-1, (2) keep compatible.</p>
<p>Registry &#8211; clean up because application developers can&#8217;t manage to update a text file (system.ini/win.ini) without borking it.</p>
<p>I wish all those things didn&#8217;t exist too: I like &#8216;simple&#8217;. &nbsp;The alternative, of a large man taking a baseball bat to the kneecaps of infringing application developers, should have been more thoroughly examined.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819063">
				<div id="div-comment-819063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819063">
			March 12, 2010 at 9:04 am</a>		</div>

		<p>Larry, Dave,</p>
<p>I wish the applications were isolated and &quot;compartmentalized&quot;. An application would not be able to load third party DLLs from another compartment. An application would not be able to install anything to Windows. Any application would not be able to write registry around, other than into its dedicated key. And an application would only be able to read/write files that an user explicitly specifies. This would help greatly with security, too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819073">
				<div id="div-comment-819073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819073">
			March 12, 2010 at 9:09 am</a>		</div>

		<p>Registry: &nbsp;The problem isn&#8217;t that people aren&#8217;t smart enough to write code that will update a text file without borking it.</p>
<p>The problem is that people CANNOT POSSIBLY write code to be used in a multithreaded system that can rewrite parts of the middle of a plain text file without the file getting mangled when another application is also trying to rewrite part of a different section of the text file at the same time. &nbsp;Text files are NOT databases and are NOT designed to be multi-write by different applications.</p>
<p>THAT is the problem with INI files. &nbsp;And, as people have said before, if you want to scrap the Registry, then please come up with something to replace it. &nbsp;Call it what you want, but it needs to be a multi-write datafile of some sort. &nbsp;A fairly simple hierarchical format is not a bad first choice for such a thing, although a relational database could be used also.</p>
<p>I never have any trouble with the Registry on the six computers that I use.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819103">
				<div id="div-comment-819103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819103">
			March 12, 2010 at 9:43 am</a>		</div>

		<p>Take for example the registry key for the system path setting. I have a lot of issues with this how setting works distinct from the way the registry works but let&#8217;s put that aside for the moment.</p>
<p>What stops an installer from corrupting the path? Nothing. Not a damn thing.</p>
<p>Now, consider for a moment if installers had no code of their own and were simply manifest driven packages for a system provided install infrastructure. That system service could ensure that the setting was written correctly and safely. It could, in theory, arbitrate between different applications&#8217; needs to edit that setting. Hell, it might be able to rebuild most of the system settings even if it did go south.</p>
<p>This sort of thing has happened before. We used to use databases of files shared over the network. Now we use database servers. In the device driver space, drivers were build by vendors nearly from scratch. The newer model provides considerably more infrastructure automatically (plug and play and power states come to mind as near impossible to get right otherwise).</p>
<p>To make an analogy with a trendy topic, the registry is shared mutable state.</p>
<div class=post>[<i>&#8220;Consider for a moment if installers had no code of their own and were simply manifest driven packages for a system provided install infrastructure.&#8221; Oh, you mean Windows Installer? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819163">
				<div id="div-comment-819163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819163">
			March 12, 2010 at 10:33 am</a>		</div>

		<p>Windows Installer? What stops installers that don&#8217;t use it from messing up applications that do? You need to think like a security guy here. Installers may not actually be hostile apps but they ACT like they&#8217;re hostile apps.</p>
<p>(Sorry this topic is a pet peeve and it&#8217;s getting the better of me.)</p>
<div class=post>[<i>I was responding to the comment &#8220;Microsoft should have a system where&#8230;&#8221; by pointing out that such a system already exists. Naturally programs with admin privs can screw up your system. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819203">
				<div id="div-comment-819203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alexandre Grigoriev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819203">
			March 12, 2010 at 11:47 am</a>		</div>

		<p>&quot;What stops an installer from corrupting the path? Nothing. Not a damn thing.&quot;</p>
<p>Here is an advice for ISVs: NEVER EVER modify PATH. Never. You don&#8217;t need it. Users don&#8217;t need it. You may modify it locally, in a command script, but NEVER MODIFY GLOBAL PATH.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819213">
				<div id="div-comment-819213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819213">
			March 12, 2010 at 12:06 pm</a>		</div>

		<p>@Alexandre Grigoriev</p>
<p>The issue with this is the home users. You install a program and it fails (because of a compartment setting problem). Can you imagine an averate user being able to fix this problem? Whats more this opens up a seperate class of attack. Can you imagine the chaos that this kind of compartmentisation could cause if a virus snuck in and set Explorer to never load kernel32.dll? Or maybe blocked processes accessing their registry keys or files? Whats more, do you think the average user would want to worry about which files get loaded in? No, they just want to use the computer for work or recreation.</p>
<p>If people used the standard Windows security then it would be able to emulate most, if not all of this. But security seems to be an area that people don&#8217;t want to think about. Which is why we have people who run with full admin rights and programmers assuming full access to Windows/Program Files/HKLM and other sensitive locations on the computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819243">
				<div id="div-comment-819243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com' rel='external nofollow' class='url'>Dale</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819243">
			March 12, 2010 at 2:37 pm</a>		</div>

		<p>It&#8217;s the price of keeping up with operating system versions.</p>
<p>Which is to say, if you&#8217;re still marketing an application, it&#8217;s not that difficult to fix your application/installer once per operating system release.</p>
<p>And in an ideal world, with each new release of OS, you could force the user to buy new versions of software. &nbsp;Application vendors, and possibly the OS vendor would love this. &nbsp;Customers would not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819273">
				<div id="div-comment-819273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Larry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819273">
			March 12, 2010 at 4:56 pm</a>		</div>

		<p>@Crescens2k: With respect to standard security, ACLs have their limits. They aren&#8217;t app aware. If an app is compromised, it can mangle the system up to the limits of the current user. On the other hand if an app has declared it can only edit a certain file type and a limited set of registry keys, the damage might be contained or even averted entirely. Yes a virus could make use of this infrastructure &#8211; if it compromised an app that had declared its intent to modify such settings. Which would be an adminstrator mode app and if that&#8217;s compromised without app limits it&#8217;s near a total loss anyway.</p>
<p>#Raymond: I guess I didn&#8217;t explain that well. My thinking leads me towards a view where a logical registry is synthesized from the manifests of the registered applications. Windows Installer doesn&#8217;t do that.</p>
<p>@Alexandre Grigoriev: PATH has many issues and your recommendation is a good one. Though &quot;never&quot; might be too strong given the current lack of alternatives for some uses.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819373">
				<div id="div-comment-819373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819373">
			March 14, 2010 at 6:20 pm</a>		</div>

		<p>@Grumpy: Consider recent entry from Michael Kaplan (See Raymond&#8217;s link of blogrolls) about Windows Installer does not gain full Unicode support as of Windows 7, even Microsoft have to address priority on thing that might seem trival like this. (At least they ought to have a thought on how to add Unicode support if needed. Afterall, UTF-8 had been unofficically supported. Buf to fix Windows compatibility problems, it can take weeks or even months to fix on the tricky parts)</p>
<p>As long as there are workarounds (at the worse case, they may just have to include instruction on the installation guide to enable</p>
<p>AppComp options), they will not allocate time to address it. It&#8217;s all about controlling development cost and will affect the PM&#8217;s performance review.</p>
<p>Except that Microsoft officially announce a deadline to remove related AppComp support, so the application will break horriably in the selling period, I don&#8217;t think most $BOSS will entertain the request to allocate resources to fix it.</p>
<p>[captcha: 443. How secure it is.]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-819393">
				<div id="div-comment-819393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matthew Wills</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819393">
			March 15, 2010 at 2:30 am</a>		</div>

		<p>@blah</p>
<blockquote><p>
  &gt; Ha. I wish Microsoft did the same for web standards, but no, they had to introduce the X-UA header to let sites remain in the dark ages.
</p></blockquote>
<p>Rightly or wrongly &#8211; you likely should be using the X-UA header. Otherwise, your site likely will switch to IE7 mode if your IE8 users add your site to their intranet zone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-819993">
				<div id="div-comment-819993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Legolas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-819993">
			March 16, 2010 at 4:17 pm</a>		</div>

		<p>Isn&#8217;t it strange though that MS has all this code there to make an app work without much changes on the app makers side, but is telling them, no, don&#8217;t use that, rewrite your app to support whatever we changed?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gregm even thread-even depth-1" id="comment-820013">
				<div id="div-comment-820013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/GregM' rel='external nofollow' class='url'>GregM</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20100311-00/?p=14643#comment-820013">
			March 16, 2010 at 6:55 pm</a>		</div>

		<p>&quot;Isn&#8217;t it strange though that MS has all this code there to make an app work without much changes on the app makers side, but is telling them, no, don&#8217;t use that, rewrite your app to support whatever we changed?&quot;</p>
<p>No, it&#8217;s not. &nbsp;The code that is there makes the system behave differently for that one app than for other apps that don&#8217;t use that compatibility setting.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

