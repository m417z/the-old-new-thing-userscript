<html>
<head>
<title>Solving the problem rather than answering the question: Why does somebody want to write an unkillable process?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Solving the problem rather than answering the question: Why does somebody want to write an unkillable process?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 20, 2013 / year-entry #165</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>49</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Via their customer liaison, a customer wanted to know how to create a process that runs with the context of the user, but which the user cannot terminate without elevating to administrator. The customer is engaging in the futile arms race between programs and users (which is more properly a walls and ladders scenario). And...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Via their customer liaison, a customer wanted to know how to create a process that runs with the context of the user, but which the user cannot terminate without elevating to administrator.</p>
<p> The customer is engaging in the futile <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/02/16/73780.aspx"> arms race between programs and users</a> (which is more properly a <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/01/17/10257351.aspx"> walls and ladders scenario</a>). And we saw that Windows has decided to keep users in control of their own programs and data and let them kill any process that belongs to them. (For one thing, allowing a process running in a user's context to protect itself from termination would mean that malware could make itself unkillable without requiring elevation.) </p>
<p> We asked the customer liaison why their program is so important that they don't want the user to terminate it. </p>
<p> The customer liaison explained, "The program is launched when the user logs in, and the customer doesn't want the user to be able to terminate the process from Task Manager." </p>
<p> Observe that the customer (through the liaison) is not answering the question. They keep saying what they want to do (looking for an answer) without describing the problem they are trying to solve (developing a solution). We had to ask them a second time, adding that even if they managed to protect the program from being terminated via Task Manager, that doesn't mean the user can't get the program to <i>crash</i>, which is equivalent to terminating it. Now, the typical user won't use these techniques, but the typical user also won't go to the Processes tab of Task Manager and click <i>End Task</i> and then accept the scary warning dialog. We're talking about a determined user at this point. </p>
<p> Finally, the customer coughed up the actual scenario. They have a service that monitors some central database. Based on the information in the central database, the service may decide that the user needs to log off. (Say, because the user's profile server is going offline, or because the service needs to reconfigure the system. The exact reason isn't important.) The application that launches at login listens for a notification from the service that a forced-logoff is about to occur and displays a balloon notification to the user warning them to save all their work because they are going to be logged off in <i>N</i> minutes. </p>
<p> At this point, I realized that they didn't have a problem in the first place: The "horrible dire consequences" of the user terminating the application is simply that they don't get balloon notifications? <i>Who cares?</i> For one thing, balloon notifications do not have guaranteed timely delivery. For example, Explorer won't show a balloon if the user is <a href="http://technet.microsoft.com/en-us/magazine/ff808316.aspx"> in a fullscreen application</a> or if the user is simply <a href="http://blogs.msdn.com/b/oldnewthing/archive/2005/01/10/349894.aspx"> not at the computer</a>. Furthermore, the user already has a way of not getting balloon notifications: By ignoring them when they appear on the screen! </p>
<p> If the user kills the "Please save your work and log off because the system is shutting down in <i>N</i> minutes for maintenance" notification application, and then they get booted off the computer without warning, well, they get what they deserve. It's like somebody who intentionally pries the safety cover off the emergency power cutoff switch. If they bump into the switch and accidentally kill power to their computer, well, they went out of their way to disable the safety cover&mdash;they deserve what they get. </p>
<p> The customer appears not to have been listening very closely, because they summarized the situation as follows: "Right. There are currently two ways to meet the requirements. First, launch the UI process with service privileges, so that the user does not have permission to kill it. Or launch the UI process with user privileges, but marked as unkillable. It looks like your recommendation is to log off immediately if the user terminates the UI process. This will likely be satisfactory, but how can a process force the user to log off if it is terminated?" </p>
<p> I felt like I was stuck in one of those sitcom tropes where the comically obtuse character refuses to process any new information: </p>
<p> "I brought you the boxes from the storeroom." </p>
<p> &mdash; <i>Thanks. Please put them against the wall.</i> </p>
<p> "Should I put them on the shelf?" </p>
<p> &mdash; <i>No. Please put them against the wall.</i> </p>
<p> "And then move them to the shelf?" </p>
<p> &mdash; <i>No. Just put them against the wall.</i> </p>
<p> "Oh, sorry. I'll take them back to the storeroom." </p>
<p> &mdash; <i>No. Leave them here. Just put them against the wall.</i> </p>
<p> "You want them here?" </p>
<p> &mdash; <i>Yes. Against the wall, please.</i> </p>
<p> "Okay, I'll put them on the shelf." </p>
<p> The customer took my explanation of why the process doesn't need to be unkillable and reinterpreted it as offering one of three options: </p>
<ul>
<li>Launch a UI process with service privileges,     which is     <a href="http://technet.microsoft.com/en-us/library/cc750553.aspx">     a well-known security vulnerability</a>. </li>
<li>Creating a process that cannot be killed by its owner,     which we already noted was not possible.     (Even if you deny <i>Terminate</i> permission,     the user can simply edit the ACL to restore <i>Terminate</i>     permission,     because users always have     <code>WRITE_<wbr>DAC</wbr></code> permission on objects they own.) </li>
<li>Creating a process that logs the user off if it is terminated,     which is possible with the help of the service,     but is not something I ever mentioned at all. </li>
</ul>
<p> I had to issue a clarification to the customer liaison: "My recommendation was not to log the user off immediately if the user kills the UI process. My recommendation is not to worry. Let the users kill the process if they want. They are only harming themselves. By killing the UI process, the users went in and disabled their smoke detector. If they die in a fire, that's their problem." </p>
<p> Unfortunately, this did not settle the issue with the customer, and we had another round of the scene with the comically obtuse character. </p>
<p> "Good news. We found a way to hide the process from the Applications tab, but it still shows up in the Processes tab. We would like to know if there is a way to hide the UI process from the Processes tab as well." </p>
<p> <i>Aaaaarrrrgggghhh.</i> </p>
<p> The customer is totally fixated on putting the boxes on the shelf, no matter how many times we say, "Putting the boxes on the shelf will not solve your problem." </p>
<p> Eventually we settled on some sort of compromise: Have the service monitor the UI process, and if it terminates, log the user off immediately or alternatively relaunch the UI process. </p>
<p> <b>Extra wrinkle</b>: Actually, the original design of the system was that the UI process would show the balloon, then wait <i>N</i> minutes, and then call <code>Exit&shy;Windows&shy;Ex</code> to log the user off. That's why they didn't want the user to be able to kill the process: If they killed the process, then nobody was going to perform the logoff. The solution to this was to move the forced logoff into the service. Note that preventing the user from terminating the UI process wouldn't solve their problem anyway, because the user could simply patch out the <code>Exit&shy;Windows&shy;Ex</code> call or suspend the process so it never got a chance to call <code>Exit&shy;Windows&shy;Ex</code> in the first place. As with Web programming, you need to design on the assumption that the client has been completely compromised. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (49)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-dwalker-wk even thread-even depth-1" id="comment-1062123">
				<div id="div-comment-1062123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062123">
			June 20, 2013 at 7:33 am</a>		</div>

		<p>That&#39;s SO weird, that the customer is being so obtuse and won&#39;t listen to reason. &nbsp;They seem to be blinded by their own assumptions&#8230; Often, when we get something in our head, it&#39;s hard to be talked out of it. &nbsp;Human nature, I suppose, but they are wasting their time and Microsoft&#39;s time, which could be put to better use!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062133">
				<div id="div-comment-1062133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ajgelado_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>ajgelado@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062133">
			June 20, 2013 at 7:34 am</a>		</div>

		<p>I admire your perseverance and quality of service. But maybe you went a bit too far with this customer. It&#39;s fair to ask for the reason the customer wanted an unkillable process, and it&#39;s fair to try to solve what may be a misconception or even a problem of communication. But when the customer, after being said twice how to do things right, insists in doing them the wrong part, I don&#39;t think Microsoft customer service is to blame. As you said, if they want to disable the smoke detector, all you can do is recommend them not to do that. The smoke detector is theirs, and they can do whatever they want with it, no matter how bad it would be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062143">
				<div id="div-comment-1062143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MazeGen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062143">
			June 20, 2013 at 7:42 am</a>		</div>

		<p>Well, if the boss wants the process unkillable, make it unkillable by whatever means and don&#39;t try to change the viewpoint!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062153">
				<div id="div-comment-1062153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mordachai</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062153">
			June 20, 2013 at 7:49 am</a>		</div>

		<p>There are a lot of people in the world who take it upon themselves to decide that they know better than the end-user, and do all sorts of things to force boundaries around that end-user, curtailing the user&#39;s ability to control their world.</p>
<p>We&#39;re all living in a world full of people trying to control one another&#39;s actions.</p>
<p>Personally, I wish Microsoft would do less controlling, and give more control over my computer to me and other end-users. &nbsp;It&#39;s my machine, and if I want to disable my smoke detectors, I should be allowed to do so. &nbsp;However, this culture war between those who want to control you and those who want to set you free is fundamental to our species behavior mechanisms, and I don&#39;t see it ending any eon soon.</p>
<p>Nor is it as simple as all that&#8230; children do need to be protected &#8211; so it is a bit of a tight-rope walk to strike a good balance between giving users freedom while not making it too easy for the novices to blow their own legs off by accident.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062163">
				<div id="div-comment-1062163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062163">
			June 20, 2013 at 8:01 am</a>		</div>

		<p>@Antonio</p>
<p>Microsoft takes the blame for every single one of these customers, though. That&#39;s why they released reliability data demonstrating that the number of crashes attributable to Microsoft software are statistically insignificant. Yet people continue to blame Microsoft for instability, rather than third-party driver and software vendors.</p>
<p>When the end-user in this scenario can&#39;t kill this process and is automatically logged off, they&#39;re going to blame Microsoft for it. They&#39;re going to go to all of their friends and talk about how horrible Windows is. Then they&#39;re going to go buy an iFruit, where FruitCo&#39;s response to this customer would be &quot;You can&#39;t do this, and we&#39;re going to blacklist your software if we catch you trying.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062173">
				<div id="div-comment-1062173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062173">
			June 20, 2013 at 8:04 am</a>		</div>

		<p>@MazeGen</p>
<p>The problem is that if Raymond could actually say &quot;Here is how you make an unkillable application,&quot; he&#39;s liable to end up with another customer liaison next week demanding to know why there are a bunch of unkillable applications running.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-davebacher even thread-even depth-1" id="comment-1062183">
				<div id="div-comment-1062183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dave+Bacher' rel='external nofollow' class='url'>Dave Bacher</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062183">
			June 20, 2013 at 8:12 am</a>		</div>

		<p>What&#39;s really funny is there&#39;s an app built into Windows NT 3.51 and later named shutdown.exe, that can be used on remote machines with a simple command line switch. &nbsp;It already displays a balloon notification &quot;you will be logged of in 10 minutes&quot; &#8212; or on some platforms it pops up a dialog box with a count down.</p>
<p>It seems like that fits their use case perfectly, and so why write something at all?</p>
<p>It&#39;s similar to here they have the policy set to block cmd.exe, but not to block .cmd files or other scripts &#8212; nor PowerShell. &nbsp;I&#39;m pretty sure there&#39;s nothing that I can do with cmd.exe that I cannot do with PowerShell. &nbsp;(blocked for non-admin users, I can use my admin credentials but that takes typing my PIN again on my smart card which is a pain).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062203">
				<div id="div-comment-1062203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062203">
			June 20, 2013 at 8:28 am</a>		</div>

		<p>@Dave</p>
<p>But shutdown.exe was NMH, so someone got the idea into their head that maybe Microsoft might one day eliminate it.</p>
<p>An equally likely explanation is that the &quot;admin&quot; is actually a developer, not an administrator, and thus doesn&#39;t actually know/hasn&#39;t taken the time to learn anything about system administration.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062213">
				<div id="div-comment-1062213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062213">
			June 20, 2013 at 8:32 am</a>		</div>

		<p>[alternatively relaunch the UI process]</p>
<p>I occasionally have to kill &nbsp;wmiprvse.exe because it won&#39;t let go of some .exe file. It relaunches automatically, but is no longer holding the .exe file long enough for me to delete &amp; replace it. This only happens on customer machines, never dev or test machines, so I haven&#39;t been able to get to the bottom of the problem.</p>
<p>Auto-relaunch comes in handy sometimes.</p>
<p>The &quot;Extra wrinkle&quot; puts the request out of insane and back to semi-sane territory. Have the service auto-launch the desktop process, and set the service to auto-launch 1 minute after termination.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062223">
				<div id="div-comment-1062223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Philip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062223">
			June 20, 2013 at 8:40 am</a>		</div>

		<p> my guess is that this was being written by the network &amp; &nbsp;infrastructure group, &nbsp;not a dev group. &nbsp; I&#39;ve seen that before, anyway. &nbsp; The IT department wants something secure so they write out themselves in VB6 or whatever that one guy knows. &nbsp; Then it gets pushed out via group policy, &nbsp;without going through a normal QA process, &nbsp;and causes all sorts of problems. &nbsp;But your stuck with it because it&#39;s required for &quot;security reasons&quot;. &nbsp; This being the same group not letting you install any tools because it&#39;s &quot;non standard software&quot; </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062233">
				<div id="div-comment-1062233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062233">
			June 20, 2013 at 9:08 am</a>		</div>

		<p>did the customer insist on balloon notification? &nbsp;If not they could have used InitiateSystemShutdown and let Windows give the users a warning and a count-down.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062243">
				<div id="div-comment-1062243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062243">
			June 20, 2013 at 9:53 am</a>		</div>

		<p>@MazeGen, You got the point. This is the typical Corp behavior. Just do what your boss says, stop thinking&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062253">
				<div id="div-comment-1062253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Brown</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062253">
			June 20, 2013 at 10:12 am</a>		</div>

		<p>This is a great article. &nbsp;I was just reviewing an IM monitoring app, and I recommended this exact architecture to reach the goal of an &quot;always on&quot; app. &nbsp;The problem still exists for members of Administrators (since they own all objects, right?); you&#39;d have to implement a [separate] watchdog service that is in constant communication with [a server (for instance)], and [have the server] keep an eye on the actions of those damn pesky, annoying human brains.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1062263">
				<div id="div-comment-1062263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062263">
			June 20, 2013 at 10:22 am</a>		</div>

		<p>You can make a process that runs under user&#39;s account, but cannot be killed by the user. The process&#39; token owner (which is different from the process user context) needs to be the service account (LOCAL_SERVICE), and the ACL needs to only allow &quot;read&quot; privileges on the process for the logged on user.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062273">
				<div id="div-comment-1062273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062273">
			June 20, 2013 at 10:25 am</a>		</div>

		<p>&quot;There are a lot of people in the world who take it upon themselves to decide that they know better than the end-user, and do all sorts of things to force boundaries around that end-user, curtailing the user&#39;s ability to control their world.&quot;</p>
<p>Typical users have no more understanding of the world inside the computer, than a 3 year old has about the world around them, and will as happily run around with scissors and shove them into electric sockets without any second thought.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1062283">
				<div id="div-comment-1062283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062283">
			June 20, 2013 at 10:29 am</a>		</div>

		<p>&gt; will as happily run around with scissors and shove them into electric sockets without any second thought.</p>
<p>And install anything that proclaims itself useful and needed (giving it all keys to the kingdom), and click on everything clickable, and run everything runnable. You can only hope Windows is designed to limit the damage. It&#39;s NOT, and the home (and many domain) users still have unlimited privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062293">
				<div id="div-comment-1062293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062293">
			June 20, 2013 at 10:30 am</a>		</div>

		<p>&gt;That&#39;s SO weird, that the customer is being so obtuse and won&#39;t listen to reason.</p>
<p>No, it&#39;s business as usual. Weird it would be only if the customer saw the light and righted their way.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062303">
				<div id="div-comment-1062303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062303">
			June 20, 2013 at 12:02 pm</a>		</div>

		<p>How do you even become &quot;a customer&quot; who can ask such development questions to Windows developers? &nbsp;I&#39;ve run into some really exotic Windows issues at my employer. &nbsp;Is there some sort of developer-level support contract?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062313">
				<div id="div-comment-1062313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062313">
			June 20, 2013 at 12:17 pm</a>		</div>

		<p>@alegr1:</p>
<p>&quot;You can make a process that runs under user&#39;s account, but cannot be killed by the user.&quot;</p>
<p>Oh no, the process has just gone into an infinite loop and I can&#39;t kill it. What is Microsoft doing creating such a bad operating system that stops me from terminating processes which have hung.</p>
<p>Also, while it is true a limited user would have issues with it, if the user is determined, they would still be able to kill it anyway. If they try hard enough, they probably could find an exploit or some other issue to cause the application to crash. As was said, it is an arms race, and if you take one step forward, so will other people.</p>
<p>In general though, even if you manage to create this super process that is so awesome, you still couldn&#39;t get past the administrator. SE_TAKE_OWNERSHIP privilege and all that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062323">
				<div id="div-comment-1062323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">12BitSlab</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062323">
			June 20, 2013 at 12:58 pm</a>		</div>

		<p>This is an age-old problem not necessarily related to Windows. &nbsp;I have seen repeatedly where someone has a management problem, but somehow that someone thinks that the management problem at hand needs to turn it into a technology problem. &nbsp;Fundamentally, if a business has rules that must be followed, then it is up to the managers and supervisors to make sure that the rules are indeed followed. &nbsp;If there are a substantial number of managers who think the rule is wrong or that the infraction is simply not worth their time to enforce, then the business has a different problem; i.e., who are the senior managers who are too far out of touch that they make up stupid rules? &nbsp;In this case, the right answer is, do not write a single line of code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062333">
				<div id="div-comment-1062333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob Hir</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062333">
			June 20, 2013 at 1:28 pm</a>		</div>

		<p>&quot;How do you even become &quot;a customer&quot; who can ask such development questions to Windows developers? &nbsp;I&#39;ve run into some really exotic Windows issues at my employer. &nbsp;Is there some sort of developer-level support contract?&quot;</p>
<p>Be a big enterprise with alot of seats, have a paid support agreement and a TAM assigned to you, and you can open all kinds of requests and have them escalated with Microsoft in all kinds of ways.</p>
<p>I once opened an issue with MS about something through our TAM, and it made it&#39;s way through Microsoft all the way to Michael Kaplan for a response (had something to do with language packs or language something or other). I was suprised when the response I got tracked back to him..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062343">
				<div id="div-comment-1062343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt Brown</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062343">
			June 20, 2013 at 1:38 pm</a>		</div>

		<p>@Myself from earlier:</p>
<p>Also, allowing interaction in the user session would be granted by some separate UI process that can be run by the user, and use some inter-process communication.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062353">
				<div id="div-comment-1062353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">wombat</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062353">
			June 20, 2013 at 2:21 pm</a>		</div>

		<p>I suppose Raymond could simply say &quot;You can&#39;t make such a process unkillable&quot;. That would be a less helpful approach, but might save him from a few ulcers. The big problem is that Raymond wants to help the customer solve their REAL problem. </p>
<p>It&#39;s always possible that the customer liaison person is &quot;translating&quot; the questions and answers. I have come across such a situation in the past. When the customer and the developer finally met it turned out that the &quot;problem&quot; wasn&#39;t what had been reported, and the solution was an existing API call. They didn&#39;t end up lynching the liaison person, but they did request a change :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-aaron-margosis odd alt thread-odd thread-alt depth-1" id="comment-1062363">
				<div id="div-comment-1062363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Aaron+Margosis' rel='external nofollow' class='url'>Aaron Margosis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062363">
			June 20, 2013 at 3:08 pm</a>		</div>

		<p>One simple solution: &nbsp;monitor for &quot;need to log off&quot; from the service. &nbsp;When that happens, THEN start the process in the user&#39;s session that displays the warning (or just call WTSSendMessage). &nbsp;Five minutes later (or whenever), then the service calls WTSLogoffSession function to end the user&#39;s session.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062383">
				<div id="div-comment-1062383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062383">
			June 20, 2013 at 4:04 pm</a>		</div>

		<p>&gt;That&#39;s the main reason why FruitCo, selling higher quality hardware than the average PC maker, has a worldwide market quota of less than 5%</p>
<p>&#8230;while enjoying more profits than the rest of the industry combined&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1062393">
				<div id="div-comment-1062393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062393">
			June 20, 2013 at 5:27 pm</a>		</div>

		<p>&gt;In the end, it&#39;s the end user who can say &quot;no software of this firm will run on my computer&quot; when the case arrives.</p>
<p>Of course, every end user has enough qualification and expertise to know that &quot;software of this firm&quot; is full of hacks and security holes and/or installs a rootkit/spam server/keylogger, too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062413">
				<div id="div-comment-1062413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062413">
			June 20, 2013 at 7:17 pm</a>		</div>

		<p>They are just being passive aggressive.</p>
<p>I have empathy for them, while it is an amusing anecdote here they will likely have anecdotes of their own about their users.</p>
<p>Employee: &quot;I am not using that computer again because it doesn&#39;t work, it logged me out without telling me.&quot;</p>
<p>Your customer: &quot;It will have showed you a message before shutting down&quot;</p>
<p>Employee: &quot;No it didn&#39;t&quot;</p>
<p>Your customer: &quot;We know you&#39;ve been killing the process&quot;</p>
<p>Employee: &quot;So? I&#39;m not using your broken computer anymore, but you have to keep paying me or I&#39;ll file a grievance with the union&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062423">
				<div id="div-comment-1062423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gechurch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062423">
			June 20, 2013 at 7:24 pm</a>		</div>

		<p>@Steve Wolf</p>
<p>&quot;Personally, I wish Microsoft would do less controlling, and give more control over my computer to me and other end-users.&quot;</p>
<p>That&#39;s exactly what&#39;s going on here. The programmer in this case wanted to create an app that the end-user couldn&#39;t kill. But Windows does not allow this because that would be taking control out of the hands of the user. Microsoft are championing the rights of the end-user here.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1062433">
				<div id="div-comment-1062433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062433">
			June 20, 2013 at 7:52 pm</a>		</div>

		<p>This sounds so familar&#8230; seems someone has asked the question in MSDN forum, and we told him we&#39;re not going to assist something that can be used for malware development.</p>
<p>Maybe he took it as a hint that this can somehow be done.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062373">
				<div id="div-comment-1062373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/ajgelado_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>ajgelado@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062373">
			June 20, 2013 at 3:55 pm</a>		</div>

		<p>@Anon: yes, I know Microsoft gets the blame of everything, from overclocked CPUs/GPUs and cheap/faulty hardware to badly written drivers or software. But there is little Microsoft can do about it, if they want Windows to continue being an open platform.</p>
<p>That&#39;s the main reason why FruitCo, selling higher quality hardware than the average PC maker, has a worldwide market quota of less than 5%, where the PC, even with all its &quot;bad press&quot;, holds a 95% &#8211; *nineteen* times greater. People isn&#39;t as silly as those pundits would like us to believe.</p>
<p>Of course, opening the platform so the end user can do whatever wants to do, also allows third party developers to do what the end user doesn&#39;t want. In the end, it&#39;s the end user who can say &quot;no software of this firm will run on my computer&quot; when the case arrives. That&#39;s exactly what Windows offers to users: actual choice.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062463">
				<div id="div-comment-1062463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062463">
			June 21, 2013 at 2:50 am</a>		</div>

		<p>The customer wasn&#39;t ‘comically obtuse’, you were. They probably have some users with clout that insist on terminating processes and complain when they lose data. The customer told you exactly what they needed but you behaved throughout as if you didn&#39;t understand the question. Even though perfectly good solutions to the problem exist.</p>
<p>What is this article even supposed to accomplish? Trying to convince yourself that you were right by presenting us a coloured version of the story?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fredericmagnyf odd alt thread-odd thread-alt depth-1" id="comment-1062473">
				<div id="div-comment-1062473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Medinoc' rel='external nofollow' class='url'>Medinoc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062473">
			June 21, 2013 at 6:12 am</a>		</div>

		<p>Ah, the &quot;interactive service&quot; solution. I remember one which both worked as LocalSystem and had a &quot;Browse&#8230;&quot; button with a file dialog&#8230; Hello, cmd.exe!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062493">
				<div id="div-comment-1062493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Non sequitor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062493">
			June 21, 2013 at 6:39 am</a>		</div>

		<p>@Anonymous Coward. Interesting inference based on the information presented. Anyways, I think a comically obtuse way of solving their problem would be to present a solution whereby the monitoring service deployed hooks and snooped on taskmgr.exe and moved the task manager window out of the way anytime the mouse neared its client area (same idea for keyboard events).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062503">
				<div id="div-comment-1062503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062503">
			June 21, 2013 at 8:04 am</a>		</div>

		<p>@Steve Wolf</p>
<p>&gt;It&#39;s my machine, and if I want to disable my smoke detectors, I should be allowed to do so. &nbsp;</p>
<p>And indeed you can do so. &nbsp;On the other hand, demanding that someone else helps you to design a foolproof smoke-detector-tampering-tool seems a bit much.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062523">
				<div id="div-comment-1062523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062523">
			June 21, 2013 at 3:16 pm</a>		</div>

		<p>&quot;Windows has decided to keep users in control of their own programs and data and let them kill any process that belongs to them&quot;</p>
<p>This is a lie.</p>
<p>taskmgr stops an administrator to kill some processes, even when a kill command/api allows it. Thus, taskmgr has support for preventing killing some processes, and does NOT put the user in control.</p>
<div class="post">[<em>That hasn&#39;t been true <a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/10/14/8998849.aspx">for quite some time</a>. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1062553">
				<div id="div-comment-1062553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062553">
			June 21, 2013 at 5:13 pm</a>		</div>

		<p>So you&#39;re saying I can kill winlogon from Task Manager? Cool, let&#39;s see if this wo#$(@#*&amp;NO CARRIER</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062583">
				<div id="div-comment-1062583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062583">
			June 21, 2013 at 7:46 pm</a>		</div>

		<p>Whoa whoa whoa..what happened here? I saw it with my own eyes, she hit it! (sorry, just saw Despicable Me and this got stuck in my head). Anyway, here is a real life scenario, which, funny enough, I encountered on one of my clients and it&#39;s close enough to what your customer wanted. So, definition:</p>
<p>&#8211; customer is running an Internet Cafee kind of business. All the PC are his, none are of the actual user who just rents time on running programs on them. Any program. Including games, heavy audio/video editors, all flavors of servers (IIS, Apache, MSSQL, MySQL, PostgreSQL, you name it it&#39;s installed on those machines), all flavors of programming languages (should I do here what I did for servers?), all browsers (yes, IE too :D), all everything, you name it, it&#39;s there!!!</p>
<p>&#8211; customer wants everything automated, his goal is no need of human supervision. His clients swipe a credit card at the booth door and pushes one button from an array of buttons, each determining how much time he wants (10 minutes, 30 minutes, 1 hour, 2 hours, 5 hours &#8211; let&#39;s take an example), door opens, client sit down, PC automatically logs in and in upper right corner a counter display how much time he has left. When counter reaches zero, screen goes to log off. At any given time, including after the counter is zero, the client can swipe the credit card and push the desired button adding time in this way to his counter.</p>
<p>Let&#39;s assume the clients using this type of service would be in a secured area so no bad human behavior would arise (like cutting the mouse cord). Now, if someone with such an idea would come to you (you being the uber super informed programmer who understand Ray&#39;s hidden question at the end of his article even before reading half of it) and get asked:</p>
<p>&quot;- look dude, I need a program who runs in the admin privileges but I don&#39;t want to be killed and I want to do the log off after a period of time&quot; &#8211; what your response would be? Reading this article it springed in my mind that the customer who got so obtuse was the programmer who got this task. He could not go past of Ray answer simply because he got asked to implement a program that would do exactly that &#8211; survive the kill! Except the dude never got a chance to understand what was the initial vision of his employer (the automated PC booth). So, how you would implement such a program?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062603">
				<div id="div-comment-1062603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/arcangelpip_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>arcangelpip@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062603">
			June 21, 2013 at 9:10 pm</a>		</div>

		<p>@640k:</p>
<p>These days you get a message along the lines of:</p>
<p>&quot;Are you sure you really want to do something so stupid?&quot;</p>
<p>If you click yes then you can experience the awesomeness of weird things happening, from weird things happening to your account being forced logged off to some really great bug checks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062613">
				<div id="div-comment-1062613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062613">
			June 21, 2013 at 10:00 pm</a>		</div>

		<p>@Danny:</p>
<p>It normally done by means other than &quot;unkillable program&quot;. You can log off the user session by a service request, for example. You can display a dialog box by WTS* API call. The policies can limit the user to be able to only launch a set of applications, and even if he manages to start Task Manager, he won&#39;t be able to do anything destructive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062643">
				<div id="div-comment-1062643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062643">
			June 22, 2013 at 6:17 am</a>		</div>

		<p>@alegr1 &#8211; I am logged as admin, so i can kill your service. I can mess around with policies as well, change them, remember, I am logged as Admin. Why? Because some programs that my clients use are most profitable, they rent my PC booth specifically for that and those programs requires Admin privileges in order to properly run.</p>
<div class="post">[<em>With admin privileges, they can just reformat the hard drive and install Linux. No software enforcement will stop that. You will have to go to another level, like having a hardware timer that physically kills power to the computer when time runs out. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062653">
				<div id="div-comment-1062653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062653">
			June 22, 2013 at 8:36 am</a>		</div>

		<p>@alegr1:</p>
<p>Given enough privileges, users can download and run process explorer or process hacker.</p>
<p>If they can&#39;t do that, they can put the certificate used to sign your software into utrusted certificate store and software won&#39;t be run on next reboot if UAC is enabled.</p>
<p>Finally, if that is somehow blocked they can reboot computer from USB or DVD (or if those are disabled off the network/TFTP), run some live Linux distro, mount system partition and simply delete your program.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1062663">
				<div id="div-comment-1062663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062663">
			June 22, 2013 at 9:14 am</a>		</div>

		<p>@Danny:</p>
<p>I don&#39;t think you understand what PC booth is. If your clients run some very profitable program, they/you can afford to exclusively use a dedicated computer. Or rent a virtual machine.</p>
<p>@Igor Levicki:</p>
<p>A PC booth/kiosk doesn&#39;t give users &quot;enough&quot; privileges. It might even not allow file download. It might as well just run a disposable virtual machine which is rolled back after each client session. It won&#39;t even allow DVD/USB flash boot without BIOS password. And you can&#39;t open the box to reset the password.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062673">
				<div id="div-comment-1062673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062673">
			June 22, 2013 at 9:21 am</a>		</div>

		<p>I&#39;m so frustrated that too many times the question boils down to: &quot;We&#39;re going (or we insist) to do the things the wrong way. How to make it as if we&#39;re doing it the right way? And please don&#39;t tell us to do the things the right way&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062693">
				<div id="div-comment-1062693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062693">
			June 22, 2013 at 4:25 pm</a>		</div>

		<p>@Ray &#8211; yes, they can &quot;attempt&quot; to do that. How do you let them believe they did it only to find out at reboot that windows is still there? If they want to burn their time trying to install Linux, trust me, the booth in question would aloow that as well. And you&#39;re right, there is a hardware involved that would simply reset the PC at the end of the rented time.</p>
<p>@alegr1 &#8211; well, since the scenario was laid out from the beginning I believe that what I understand with &quot;PC booth&quot; and what you think I understand could be 2 different things. Anyway, the scenario is real and working.</p>
<p>How I solve it? Deep Freeze. DF and the very simple electronic board with a CI and a 512 bytes EEPROM. Sometime, in order to succeed at software, hardware knowledge is required.</p>
<p>However, this article was about a possible programmer who could not see the whole idea and got stuck with &quot;unkillable&quot; process. My real life project, that ended quite quick after I told him to go buy Deep Freeze licenses and gave him the electronic schematic, did that to me too &#8211; I started to wonder how to make an &quot;unkillable&quot; process. I promise Ray, it wasn&#39;t me the customer you&#39;re talking about in here :)</p>
<div class="post">[<em>If you have a hardware device to cut power, then why do you care about writing an unkillable process? The hardware device is unkillable. Use that. If the user kills the warning balloon, then they deserve what they get. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062703">
				<div id="div-comment-1062703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062703">
			June 23, 2013 at 7:25 am</a>		</div>

		<p>&gt; If they can&#39;t do that, they can put the certificate used to sign your software into utrusted certificate store and software won&#39;t be run on next reboot if UAC is enabled.</p>
<p>And there we have it, a good reason to not sign software. Figures the very thing that UAC encourages turns out to have a nasty wrinkle, that of giving MS or some upstream certificate provider a bloody kill switch for your software.</p>
<p>@Danny: I have a Deep Freeze killer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062713">
				<div id="div-comment-1062713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062713">
			June 23, 2013 at 8:09 am</a>		</div>

		<p>@Joshua</p>
<p>Good luck using it at my customer PC booths</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062723">
				<div id="div-comment-1062723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062723">
			June 23, 2013 at 8:59 am</a>		</div>

		<p>Guys, I don&#39;t understand. Do you want your booth to give the user access to World Wide Web, or to Wild Wild West?</p>
<p>Why you&#39;re even talking about the user adding a rogue certificate? An user should not be able to do that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1062753">
				<div id="div-comment-1062753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">j b</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062753">
			June 23, 2013 at 11:49 pm</a>		</div>

		<p>@alegr1,</p>
<p>&gt; the question boils down to: &quot;We&#39;re going (or we insist) to do the things the wrong way.</p>
<p>Sure. However, most professionals do a very poor or mediocre job of explaining to the layman the rationale behind the RIGHT way (or even what IS the right way) in a way that makes sense to the nonprofessional, and that relates to his situation. We say &quot;Do so-and-so, and be happy when it works!&quot;</p>
<p>To keep people from doing it the WRONG way, we must explain to them WHY it is wrong. Generally, we fail miserably; we are even worse at explaining the wrongs than the rights. The user may understand that the right way is a viable alternative, maybe even a good one, but &quot;if it works, don&#39;t fix it&quot;. As long as the user&#39;s approach ALSO seems like a viable alternative, why not stick to that? </p>
<p>The answer to &quot;But why can&#39;t I do it the way I planned to?&quot; is NOT &quot;Because it is the wrong way&quot;. If the user has to ask, again and again, &quot;But WHY is it wrong?&quot;, you have failed to explain it well enough. You haven&#39;t grasped the user&#39;s way of thinking any more than he has grasped yours; the lack of understanding is certainly not only on the user&#39;s side. And don&#39;t forget: This is NOT a symmetrical situation, the user&#39;s alternative vs. yours. YOU are the one claiming that solution A is wrong, solution B is right; YOU must defend both claims. Not for yourself to be convinced, but for the user to be convinced.</p>
<p>A few people are good at explaining both sides; Raymond stands out as one of those. (I suspect that in many of the cases he reports, he did not handle the customer himself &#8211; he would have done better&#8230; :-).) But far too often, when I come in after someone else have tried to help the user, it ends up in some &quot;So THAT&#39;S why it fails? Then I understand why it should be done the way Joe insisted on doing it.&quot; Amd it comes out right.</p>
<p>Finally, I&#39;d like to remark that in a couple cases, I have myself been one of those argumentative users, insisting on my own approach, asking repeatedly &quot;But why not?&quot;, and ended up with a reply &quot;Well, I guess your argument makes sense&#8230;&quot;, and the software has indeed been updated to fit my approach. Obviously, my arguments have been at a professional level; yet we should carefully avoid seeing our established approach as the single viable one, now and forever.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1062873">
				<div id="div-comment-1062873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20130620-00/?p=4033#comment-1062873">
			June 24, 2013 at 10:44 am</a>		</div>

		<p>&gt;To keep people from doing it the WRONG way, we must explain to them WHY it is wrong.</p>
<p>Or at least do not make the wrong way the Windows default. The single most damaging thing to Windows security reputation has been that it was making the new users Administrators by default. It&#39;s still a default. And there are enterprise deployments where all domain users are also local administrators, because of that.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

