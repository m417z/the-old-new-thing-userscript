<html>
<head>
<title>The StartRunNoHOMEPATH policy affects whether the user's HOME path is the current directory when you use Start.Run, but make sure you read that carefully</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>The StartRunNoHOMEPATH policy affects whether the user&#8217;s HOME path is the current directory when you use Start.Run, but make sure you read that carefully</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>April 30, 2014 / year-entry #109</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>15</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer (via the customer liaison) discovered that even though they had set the Start­Run­No­HOME­PATH policy, they found "if the user creates a Notepad file, the file is searched in the user's HOME directory, in contradiction of Start­Run­No­HOME­PATH policy," I asked the liaison to confirm: "The steps you describe are rather vague. Are you saying...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer (via the customer liaison) discovered that even though they had set <a href="http://support.microsoft.com/kb/264061"> the <code>Start&shy;Run&shy;No&shy;HOME&shy;PATH</code> policy</a>, they found "if the user creates a Notepad file, the file is searched in the user's HOME directory, in contradiction of <code>Start&shy;Run&shy;No&shy;HOME&shy;PATH</code> policy,"</p>
<p> I asked the liaison to confirm: "The steps you describe are rather vague. Are you saying that the problem occurs when the user opens the Run dialog and types <code>Notepad filename.txt</code>?" </p>
<p> The customer liaison replied, "I believe the scenario is close to what you describe. The user opens the Run dialog, types <code>Notepad</code>, then types some text into Notepad and then does a <i>Save As</i>. I will confirm with the customer." </p>
<p> A few days later (the customer was on leave), the customer liaison provided the exact steps: </p>
<ul>
<li>Open the Start menu (Windows 7) </li>
<li>Type <code>Notepad</code> to search the Start menu. </li>
<li>When the Notepad program is found, click on it. </li>
<li>Type some text. </li>
<li>Perform a <i>Save As</i>.     This operation is slow.     Network traces show many accesses to the user's HOME directory. </li>
</ul>
<p> Okay, well, now that the steps are all carefully spelled out, it is clear what is going on. Or more accurately, it is clear what is <i>not</i> going on. </p>
<p> The <code>Start&shy;Run&shy;No&shy;HOME&shy;PATH</code> policy controls the working directory when a program is run from the Start.Run dialog. <a href="http://support.microsoft.com/kb/264061"> Like it says in the KB article</a>: </p>
<blockquote class="q"><p>  <b>Symptoms</b> </p>
<p> If you have a home folder set and you try to run a program by clicking <b>Start</b> and then clicking <b>Run</b>, Windows searches your home folder for the program before searching the path. </p>
</blockquote>
<p> The article then goes on to describe how you can solve the problem if those are the symptoms you are trying to relieve. </p>
<p> But those symptoms do not match the customer's problem. </p>
<p> The customer ran the program directly from the Start menu, not by going through the Start.Run dialog. Therefore, the KB article and the <code>Start&shy;Run&shy;No&shy;HOME&shy;PATH</code> policy do not apply. </p>
<p> Policies do what they are documented to do, not what you wish they did. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1122343">
				<div id="div-comment-1122343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Murkel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122343">
			April 30, 2014 at 7:35 am</a>		</div>

		<p>@laonianren</p>
<p>Is that always the case?</p>
<p>If so the customer had this happen once and directly reported it and went surfing instead..</p>
<p>If he had browsed to the folder he wanted and saved then problem would have disappeared.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1122373">
				<div id="div-comment-1122373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122373">
			April 30, 2014 at 8:09 am</a>		</div>

		<p>Everybody regards that box as the equivalent of start/run. Seriously what did you expect?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1122383">
				<div id="div-comment-1122383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122383">
			April 30, 2014 at 8:21 am</a>		</div>

		<p>&quot;Policies do what they are documented to do, not what you wish they did&quot; &#8211; Another Raymond Chen classic!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1122393">
				<div id="div-comment-1122393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122393">
			April 30, 2014 at 8:23 am</a>		</div>

		<p>@dwalker shortcuts in the start menu can have a specific &quot;Start in&quot; folder location set on them.</p>
<p>Notepad&#39;s (at least on Windows 7) is explicitly set to &quot;%HOMEDRIVE%%HOMEPATH%&quot; so that is where it will start.</p>
<p>In any case, Start Run is hidden by default on Vista and up, the idea being the user can search the start menu now (and thus they will launch the Start menu shortcut instead, at least in this case, which has &quot;Start in&quot; folder configured etc).</p>
<p>for an Open/Save dialog the application can point it to a specific directory to use. &nbsp;If not done, it will default to either the application folder or the working directory (I forget which), which will be determined by &quot;Start in&quot; or whatever. &nbsp;If the app keeps using the same dialog object it can remember the last used folder all by itself, although if it wants to have it happen cross-session then it needs to store the path somewhere and set it back on the object next time it runs.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1122403">
				<div id="div-comment-1122403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122403">
			April 30, 2014 at 8:48 am</a>		</div>

		<p>&gt; Policies do what they are documented to do</p>
<p>Usually.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1122413">
				<div id="div-comment-1122413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">confused</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122413">
			April 30, 2014 at 9:41 am</a>		</div>

		<p>And even with Start, Run, I imagine it would happily enough save in the user&#39;s home directory. There seems to be a deeper confusion between &quot;path&quot; and &quot;working directory&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1122433">
				<div id="div-comment-1122433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">morlamweb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122433">
			April 30, 2014 at 1:04 pm</a>		</div>

		<p>@Joshua: I&#39;d expect someone who reads a policy named &quot;StartRunNoHomePath&quot; to infer that the policy affects, um, Start &gt; Run and nothing else. &nbsp;Especially if they&#39;ve read any of Raymond&#39;s past posts on policies.</p>
<p>Followup question: is there an equivalent policy for programs started via the search box on the Start menu? &nbsp;&quot;StartSearchNoHomePath&quot;, perhaps? &nbsp;How about a policy for the search charm in Windows 8 Metro?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1122443">
				<div id="div-comment-1122443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122443">
			April 30, 2014 at 1:24 pm</a>		</div>

		<p>&quot;confused&quot;, ironically enough, seems to have hit the larger issue&#8230; Notepad isn&#39;t being found in the user&#39;s home directory, so I don&#39;t see why that policy would apply even if it, uh, did apply.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1122453">
				<div id="div-comment-1122453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mc</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122453">
			April 30, 2014 at 2:13 pm</a>		</div>

		<p>Almost related bonus tip. &nbsp; &nbsp;Do &quot;Start/Run&quot; &nbsp;or Windows+R &nbsp; and type &nbsp;. &nbsp;&lt;enter&gt; (just the period/fullstop) &nbsp; and you&#39;ll open explorer at your profile (c:users&lt;username&gt;) . &nbsp; It&#39;s quick and easy. &nbsp; </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1122333">
				<div id="div-comment-1122333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122333">
			April 30, 2014 at 7:18 am</a>		</div>

		<p>Even if this policy had done what the customer wanted, it still wouldn&#39;t have helped.</p>
<p>The file open/save dialog in notepad doesn&#39;t open in the current directory*. &nbsp;It opens in the directory used last time.</p>
<p>* Except maybe the first time notepad is used.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1122463">
				<div id="div-comment-1122463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122463">
			April 30, 2014 at 2:25 pm</a>		</div>

		<p>@Mc</p>
<p>If you aren&#39;t trying to get to your profile folder the Windows Logo Key + E will open explorer to &quot;My Computer/Computer/Local PC&quot; which I find more useful, its been there since XP I believe? (maybe only Vista+ ?).</p>
<p>Lots of useful Windows Logo Key shortcuts that people don&#39;t seem to know about (Aero Snap is my favorite, a must for multiple monitors)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-1122353">
				<div id="div-comment-1122353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122353">
			April 30, 2014 at 7:39 am</a>		</div>

		<p>From the user&#39;s perspective, running a program directly from Start might not be much different than going through Start/Run. &nbsp;I wonder why the behavior is actually different for Start vs. Start/Run.</p>
<p>And the documentation talks about &quot;searching (your home folder) for the *program*&quot;, not about where the default SaveAs will point, once the program is running (the working directory). &nbsp;Although those are likely related, they might not be the same. &nbsp;Many programs default SaveAs to the Documents directory. &nbsp;There are many options that are intertwingled here&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1122483">
				<div id="div-comment-1122483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122483">
			April 30, 2014 at 5:44 pm</a>		</div>

		<p>@John: &quot;the Windows Logo Key + E will open explorer to &quot;My Computer/Computer/Local PC&quot; which I find more useful, its been there since XP I believe? (maybe only Vista+ ?).&quot;</p>
<p>Since XP?</p>
<p>I can&#39;t vouch for the starting location, but Win-E started explorer in Windows 95.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1122503">
				<div id="div-comment-1122503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122503">
			April 30, 2014 at 10:34 pm</a>		</div>

		<p>@Joshua: No they don&#39;t. You can&#39;t possibly know that. You&#39;re wrong (because I don&#39;t, so already, you&#39;re wrong). </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1122513">
				<div id="div-comment-1122513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140430-00/?p=1113#comment-1122513">
			May 1, 2014 at 3:48 am</a>		</div>

		<p>@Evan Seems to open at My Computer, but then I don&#39;t have the Active Desktop update, which would probably have changed it to My Documents.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

