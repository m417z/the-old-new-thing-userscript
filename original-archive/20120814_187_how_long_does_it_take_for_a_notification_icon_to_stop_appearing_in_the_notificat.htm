<html>
<head>
<title>How long does it take for a notification icon to stop appearing in the Notification Area Icons control panel?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How long does it take for a notification icon to stop appearing in the Notification Area Icons control panel?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>August 14, 2012 / year-entry #188</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>31</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer reported that even after uninstalling their application, the notification icon entry remains in the Notification Area Icons control panel. Yup, that's right. Explorer remembers the icon, even after the underlying program has been uninstalled, because you might have uninstalled it with the intention of immediately reinstalling it, so Explorer remembers the icon in...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer reported that even after uninstalling their application, the notification icon entry remains in the Notification Area Icons control panel.</p>
<p> Yup, that's right. Explorer remembers the icon, even after the underlying program has been uninstalled, because you might have uninstalled it with the intention of immediately reinstalling it, so Explorer remembers the icon in case it comes back. But after one week, Explorer gives up and finally forgets about the icon. "It's been a week, and the user hasn't reinstalled the application. I'm going to give up waiting for it." </p>
<p> The customer wanted to know how they could remove their icon immediately upon uninstall. They reported that having the icon remain in the Notification Area Icons control panel made it appear that the uninstall was unsuccessful. </p>
<p> There is no documented mechanism for removing the icon (and the undocumented mechanisms destroy <i>all</i> the icon history, not just the icon history for your icon, so don't do that either). You'll just have to wait seven days for the icon to go away. </p>
<p> (One possibility that was considered was to have the Notification Area Icons control panel check if the application is still installed before showing it on the list. This runs into problems, though, if the application resides on the network or removable media. It means that opening the Notification Area Icons control panel can stall on network I/O, generate security audits if you lost access to the network share, and spin up external media. Remember how much people hated it when Windows&nbsp;95 spun up your CD-ROM drive the first time you clicked on the address bar?) </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (31)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1004883">
				<div id="div-comment-1004883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004883">
			August 14, 2012 at 7:17 am</a>		</div>

		<blockquote><p>
  You&#39;ll just have to wait seven days for the icon to go away.
</p></blockquote>
<p>But if you turn away for a moment, a girl will crawl out of the monitor and kill you.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1004893">
				<div id="div-comment-1004893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004893">
			August 14, 2012 at 7:20 am</a>		</div>

		<p>I hate it when my DVD drive spins up whenever something opens My Computer as part of a folder/file selection dialog operation, why don&#39;t they just stop that? 99% of the time i don&#39;t want to open the disk, and when i do it typically takes a few seconds to open anyway.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004903">
				<div id="div-comment-1004903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004903">
			August 14, 2012 at 7:24 am</a>		</div>

		<p>You could ask users to set their clocks ahead by a week, wait a little bit to let it sink in, and then them back to the correct time. &nbsp;But I wouldn&#39;t do this automatically, since as well know well by now, using a global solution to solve a local problem is fraught with peril.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1004913">
				<div id="div-comment-1004913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004913">
			August 14, 2012 at 7:37 am</a>		</div>

		<blockquote><p>
  I hate it when my DVD drive spins up whenever something opens My Computer as part of a folder/file selection dialog operation,
</p></blockquote>
<p>That&#39;s because AUTORUN.INI sets an icon for that DVD, and the icon is in an application linked with /SWAPRUN:CD</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004923">
				<div id="div-comment-1004923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004923">
			August 14, 2012 at 8:14 am</a>		</div>

		<p>The uninstall-some-software case seems common enough that it should have been catered for, surely? &nbsp;Leaving the icon around after uninstallation violates the principle of least astonishment in a fairly major way. &nbsp;</p>
<p>And for what? Some weird optimization to &quot;benefit&quot; someone doing an uninstall-install sequence. Why would someone do that in any case? I can think of: (a) upgrading software that can&#39;t do upgrades properly, (b) fixing something that&#39;s broken.</p>
<p>In case (a) why assume that the previous icon is still valid?</p>
<p>In case (b) why assume that the icon behaviour/state isn&#39;t the thing that&#39;s broken?</p>
<p>Perhaps I&#39;m missing something, but I&#39;m at a loss to determine why this was ever considered a good idea.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jader3rd odd alt thread-odd thread-alt depth-1" id="comment-1004943">
				<div id="div-comment-1004943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/jader3rd' rel='external nofollow' class='url'>jader3rd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004943">
			August 14, 2012 at 8:30 am</a>		</div>

		<p>If the application which caused the notification to be removed resides on the network, or removable media, it doesn&#39;t seem unreasonable to check the respective location to see if that single item still exists.</p>
<div class="post">[<i>And then you have the bug &quot;How come Explorer keeps forgetting my notification icon settings?&quot; (Answer: Because the network share was unavailable for 30 minutes last Sunday / the removable drive was removed, so Explorer thought the app was uninstalled.) -Raymond</i>]</p>
<div></div>
</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004953">
				<div id="div-comment-1004953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mschaef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004953">
			August 14, 2012 at 8:31 am</a>		</div>

		<p>For a while, I had a CD changer installed on my Windows 95 PC. It was built like an audio CD changer: one physical drive, several slots for disks, and a mechanism for automatically switching between disks under software control. &nbsp; One of the modes for the changer was to present each loaded disk as a separate drive letter. This was nice in theory, until Windows decided to scan the drives for volume labels. It was slow, noisy, and blocked the UI for something like 10-15 seconds. I never really did use the drive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1004963">
				<div id="div-comment-1004963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004963">
			August 14, 2012 at 8:32 am</a>		</div>

		<p>@dave: Why would this be a bad idea? I think they did everything right. Application is uninstalled. Explorer remembers your preferences in case it ever comes back. After some time it says &quot;Okay, I guess if you reinstall your app a year later you aren&#39;t going to expect me to remember how to treat it. So I can forget it now&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004973">
				<div id="div-comment-1004973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bob</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004973">
			August 14, 2012 at 8:35 am</a>		</div>

		<p>I remember seeing this once and thinking there was a bug with the uninstaller. I&#39;m with Dave on this one. A nasty program runs through the windows icon directory and adds every icon to the notification area and you&#39;re stuck with it that way for at least a week.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-1004993">
				<div id="div-comment-1004993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004993">
			August 14, 2012 at 11:38 am</a>		</div>

		<blockquote><p>
  You could ask users to set their clocks ahead by a week, wait a little bit to let it sink in, and then them back to the correct time. &nbsp;But I wouldn&#39;t do this automatically, since as well know well by now, using a global solution to solve a local problem is fraught with peril.
</p></blockquote>
<p>A guy goes to the gym&#39;s shower after a workout. When done, he finds that he forgot a towel. He steps out of the shower and sees a notice on the wall: &quot;Please don&#39;t wipe with the window curtains!&quot; He thinks: &quot;Hm, that&#39;s a good idea!&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005003">
				<div id="div-comment-1005003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Raphael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005003">
			August 14, 2012 at 2:00 pm</a>		</div>

		<p>You people must be checking out the Notification Area control panel an awful lot to notice that and be bothered by it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005013">
				<div id="div-comment-1005013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jhoward_4000_affinegy.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jhoward@affinegy.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005013">
			August 14, 2012 at 2:13 pm</a>		</div>

		<p>This is a Windows 95 issue, right? &nbsp;Because my installers remove the notification icons just fine AFAIK in current day Windows.</p>
<p>I suppose a workaround might be for the installer to make the whole icon transparent. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004873">
				<div id="div-comment-1004873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Damien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004873">
			August 14, 2012 at 7:15 am</a>		</div>

		<p>So, the code to remove the icon (from C#) is:</p>
<p> &nbsp; &nbsp;Thread.Sleep(7*24*60*60*1000);</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005023">
				<div id="div-comment-1005023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Not important</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005023">
			August 14, 2012 at 2:49 pm</a>		</div>

		<p>I am with Dave @8:14 am on this one. It seems like a pointless thing to do. Whoever made this decision had to choose between a big dollop of confusion (for one week every time one opens the dialog you get a confusing action) versus an improvement in a narrow case which most people would not even notice. Big confusion versus hard to notice improvement. Is there even a choice to make here? Isn&#39;t the choice already made for you?</p>
<div class="post">[<i>Suppose the code checked if the app was installed. You&#39;ll have a new complaint from users: &quot;How come Explorer sometimes forgets my notification icon settings?&quot; (Because the CD was not in the drive, or the USB drive was unplugged, or the network share was down, or the local folder was unavailable because the app was being updated.) And of course &quot;Why does it take 5 minutes for the control panel to open and why does it spin up my CD-ROM?&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005033">
				<div id="div-comment-1005033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005033">
			August 14, 2012 at 2:52 pm</a>		</div>

		<p>@Dave: &nbsp;I think you are giving them too much credit. &nbsp;The install-after-uninstall scenario is just code for &quot;it was too hard&quot; / &quot;we were too lazy&quot;. &nbsp;I mean really, how would you even implement that? &nbsp;Are you going to poll every 10 minutes? &nbsp;Hook into Windows Installer? &nbsp;What about 3rd party installers? &nbsp;You could do it before you show the icons, but Raymond pointed out the problems with that. &nbsp;There is not a good solution.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hardon odd alt thread-odd thread-alt depth-1" id="comment-1005043">
				<div id="div-comment-1005043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/gdalsnes' rel='external nofollow' class='url'>gdalsnes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005043">
			August 14, 2012 at 3:35 pm</a>		</div>

		<p>Is this related to the &quot;Hide inactive items&quot;  &quot;Past Items&quot; in the &quot;Customize notifications&quot; dialog?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005053">
				<div id="div-comment-1005053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005053">
			August 14, 2012 at 3:37 pm</a>		</div>

		<p>Surely the &quot;good solution&quot; is to just delete the settings during uninstall. If your app performs a reinstall, is it really so hard to reset the notification icon? It&#39;s certainly less confusing to users to see that the notification icon&#39;s settings&#39; removal is tied to the uninstall than to see that the notification icon&#39;s survival is due to a heuristic that runs a week after the uninstall.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005063">
				<div id="div-comment-1005063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Tyrrill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005063">
			August 14, 2012 at 3:39 pm</a>		</div>

		<p>Also, the roaming profiles scenario. You log onto a computer without that application installed. You don&#39;t want Explorer to forget your preference for that application every time.</p>
<p>@dave: This isn&#39;t a weird case. It&#39;s the roaming profiles scenario that you&#39;re missing.</p>
<p>Roaming profiles really hits home the concept of machine/user separation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004983">
				<div id="div-comment-1004983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/jas71_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>jas71@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1004983">
			August 14, 2012 at 10:15 am</a>		</div>

		<p>&quot;But I wouldn&#39;t do this automatically, since as well know well by now, using a global solution to solve a local problem is fraught with peril.&quot;</p>
<p>So, the REAL answer is to patch explorer.exe with a modified GetSystemTime function which adds 7 to wDay in the SYSTEMTIME structure before returning?*</p>
<p>* This is not a serious suggestion. If you are thinking of using it, please give up programming now. Please.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-1005083">
				<div id="div-comment-1005083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005083">
			August 14, 2012 at 5:40 pm</a>		</div>

		<p>Another approach is to keep the settings forever, but hide the icons for uninstalled programs from the UI.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-1005093">
				<div id="div-comment-1005093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005093">
			August 14, 2012 at 5:43 pm</a>		</div>

		<p>Oh, I see, that&#39;s what this was.</p>
<blockquote><p>
  This runs into problems, though, if the application resides on the network or removable media.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005103">
				<div id="div-comment-1005103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tweenie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005103">
			August 14, 2012 at 7:51 pm</a>		</div>

		<p>@Raphael &quot;You people must be checking out the Notification Area control panel an awful lot to notice that and be bothered by it.&quot;</p>
<p>Yep. You&#39;d think some folks in this thread do literally nothing other than tweak notification icon settings.</p>
<div class="post">[<i>Reminds me of the people who apparently spent all their waking moments <a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/01/02/9265754.aspx" rel="nofollow">formatting floppy disks</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005073">
				<div id="div-comment-1005073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Tyrrill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005073">
			August 14, 2012 at 3:41 pm</a>		</div>

		<p>@Matt: Settings are per-user. Uninstalling a program is per-machine. The uninstaller doesn&#39;t even have *access* to the settings.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005113">
				<div id="div-comment-1005113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005113">
			August 15, 2012 at 3:23 am</a>		</div>

		<p>@mschaef I had a drive like that. I used to use it with a non-Windows operating system, but when I upgraded the operating system version it conflicted with the the drive&#39;s native software, and the built-in CD drivers tried to query status every disk, every second, making it spend all of its time mechanically changing the disks&#8230;</p>
<p>P.S. I nearly didn&#39;t see this post. Looks like the Atom/RSS feeds are broken. Oops. Hope the site administrators fix things soon.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005123">
				<div id="div-comment-1005123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005123">
			August 15, 2012 at 7:09 am</a>		</div>

		<p>@Matt: &nbsp;If it were that easy that&#39;s how it would have been done. &nbsp;These settings are managed internally by Explorer. &nbsp;Even if Explorer could hook into the install/uninstall process there are problems with multiple users, 3rd party installers, etc. &nbsp;The feature is exclusively for convenience anyway. &nbsp;Like antispam solutions it only fixes the symptoms (a gazillion icons in your tray) and not the disease (a gazillion pieces of useless shovelware that put an icon in your tray).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005293">
				<div id="div-comment-1005293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005293">
			August 15, 2012 at 8:53 am</a>		</div>

		<p>&quot;Even if you somehow fixed those problems, taking per-user action on app uninstall assumes a one-to-one mapping between computers and users. &#8230;.&quot;</p>
<p>Exactly right. &nbsp;So now Windows would need to maintain a database of uninstalled apps so that the profiles could be altered when the user logs in, or somehow have a system service that that grubs around in all the user profiles when the app is uninstalled. &nbsp;That still doesn&#39;t solve the roaming problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005193">
				<div id="div-comment-1005193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/johnstonj_4000_inn_2D00_soft.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>johnstonj@inn-soft.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005193">
			August 15, 2012 at 7:36 am</a>		</div>

		<p>I&#39;m with Raymond and John &#8211; to all the naysayers who think that the icon should have been immediately removed &#8211; how do you *specifically* propose to do this? &nbsp;The default behavior if you don&#39;t code special cases is the current behavior.</p>
<p>The Shell_NotifyIcon API simply does not provide a way for apps to provide install/uninstall notifications. &nbsp;There would be two ways Microsoft could go about this:</p>
<p>1. &nbsp;Have the shell detect that an app is uninstalled and then remove the icon. &nbsp;But this raises some issues: (1) too many long, blocking I/Os, disturbing slow media like CD-ROM drives, etc. (2) removable and network media may not be available, causing the icon to falsely be removed, (3) some applications might extract a temporary EXE file that shows a notification icon. &nbsp;For #3, our company uses an app like that &#8211; a customer might run our application frequently, but the path to the temporary EXE is constantly changing.</p>
<p>2. &nbsp;Have an API for applications to notify the shell when an application is installed/uninstalled. &nbsp;That means the app can notify the shell when the icon will no longer exist &#8211; since it is the app that best knows when it is uninstalled. &nbsp;But this raises more issues: (1) what about apps that don&#39;t have setup programs &#8211; e.g. simple, single-purpose, single-EXE files? (e.g. the SysInternals tools like Process Explorer) (2) what about misbehaved apps that don&#39;t call the API like they should be? (3) what about legacy apps?</p>
<p>Both options suck. &nbsp;Therefore, the current behavior is preferable.</p>
<div class="post">[<i>Even if you somehow fixed those problems, taking per-user action on app uninstall assumes a one-to-one mapping between computers and users. What do you intend to do about all the other users? Or if a single user roams to multiple computers? (I have two systems both with Program X installed. I uninstall Program X from Computer 1. If this deletes Program X&#39;s settings, then its icon settings are missing from Computer 2!) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt thread-odd thread-alt depth-1" id="comment-1005443">
				<div id="div-comment-1005443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005443">
			August 15, 2012 at 6:47 pm</a>		</div>

		<p>Can there be a function like &quot;cleanup notification icons&quot; invokable by context menu?</p>
<p>Since this type if functions are known to be slow (think about &quot;disk cleanup tool&quot;), even if it&#39;d make user&#39;s machine lower, they should understand.</p>
<p>And I think only the users who &quot;can&#39;t stand having such icon poke in their face&quot; will run them, these are people who will take whatever it needs to get the icons away.</p>
<p>That said, such feature would probably be very low on &quot;wanted feature&quot; list, and probably never make it to become real feature&#8230; :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1005493">
				<div id="div-comment-1005493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Danny</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005493">
			August 16, 2012 at 3:21 am</a>		</div>

		<p>There is no documented mechanism for removing the icon (and the undocumented mechanisms destroy all the icon history, not just the icon history for your icon, so don&#39;t do that either)&lt;/quote&gt;</p>
<p>So, what&#39;s the undocumented mechanism to destroy the icon history all together? Nevermind, you let the cat out of the bag and it will be implemented and you&#39;ll have one more compatibility issue on your hands, so this undocumented mechanism will become a documented one in the future. Thanks for the tip Ray :P:P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005633">
				<div id="div-comment-1005633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1005633">
			August 16, 2012 at 11:15 pm</a>		</div>

		<p>This will be &quot;fixed&quot; in windows8 by removing the systray altogether, and users will be touted the &quot;solution&quot; as a groundbraking innovation. Please prepare for the 20 page article explaning why you can&#39;t use a computer without this upcoming feature.</p>
<p>Meanwhile, other OSes design their APIs and GUIs correctly from version 0.01.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1006033">
				<div id="div-comment-1006033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20120814-00/?p=6873#comment-1006033">
			August 17, 2012 at 8:28 pm</a>		</div>

		<p>Wow 640k is troll today.</p>
<p>It might be possible to cause specific removal by changing system time inappropriately, but the side effects of that make me shudder.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

