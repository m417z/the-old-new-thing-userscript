<html>
<head>
<title>A question about preventing the system from going to the idle state turns out to be misguided</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>A question about preventing the system from going to the idle state turns out to be misguided</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>October 28, 2014 / year-entry #254</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>28</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer asked how they could have their program prevent the system from going to the idle state. Specifically, when the system goes idle, the application gets into a weird state where it starts leaking memory like crazy. The program normally uses around 100MB of memory, but when the system goes idle, something funky happens...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer asked how they could have their program prevent the system from going to the idle state. Specifically, when the system goes idle, the application gets into a weird state where it starts leaking memory like crazy. The program normally uses around 100<a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/06/11/9725386.aspx">MB</a> of memory, but when the system goes idle, something funky happens and the program's memory usage shoots up to 4GB. To avoid this problem, they want to prevent the system from <a href="http://msdn.microsoft.com/library/aa383561"> entering the idle state</a>.</p>
<p> Now, if your application is a special-purpose program running on a dedicated computer, then blocking the entry into the idle state might be acceptable. After all, the user bought the computer specifically to run your program and nothing else. But the description of the program provided by the customer did not suggest that this was the case. It was just some program being developed for a general audience. </p>
<p> Interfering with the functioning of the entire system to hide a bug in your application is a horrible thing to do. It means that when your program is running, idle-time tasks never run, the computer never enters a low-power state, laptop batteries drain ten times faster than normal, and you basically ruin the entire computer. </p>
<p> What you should do is debug your program and fix the memory leak. </p>
<p> This is like saying, "We manufacture car stereo systems, and we found that when the car is coasting, the power from the alternator is not sufficient to drive the speakers. We would like to prevent the car from coasting." </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (28)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1157943">
				<div id="div-comment-1157943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Count Zero</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1157943">
			October 28, 2014 at 7:29 am</a>		</div>

		<p>I understand that this pot is not about the cause of the problem, but it really left me curious about it. May I kindly ask you to share some info on that?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1157953">
				<div id="div-comment-1157953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">12BitSlab</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1157953">
			October 28, 2014 at 7:33 am</a>		</div>

		<p>I probably shouldn&#39;t ask this, but are there developers who are truly that stupid?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1157973">
				<div id="div-comment-1157973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Crowell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1157973">
			October 28, 2014 at 7:35 am</a>		</div>

		<p>12BitSlab,</p>
<p>Yes. &nbsp;Have you poked around on Stack Overflow and seen some of the horrendous questions? &nbsp;Yes, some are students, but many are not.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1157983">
				<div id="div-comment-1157983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kemp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1157983">
			October 28, 2014 at 7:36 am</a>		</div>

		<p>Be glad they didn&#39;t write a Linux app and then try to port it to Windows. &quot;Hmmm&#8230; it doesn&#39;t run in Windows as-is. We&#39;d better package a Linux distro with our app so it can wipe the user&#39;s drive and set up a suitable environment to run in.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1157993">
				<div id="div-comment-1157993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sockatume</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1157993">
			October 28, 2014 at 7:46 am</a>		</div>

		<p>I wonder if people have been conditioned to answer old-shoe-or-glass-bottle type questions because they&#39;re used to them from their undergraduate training. After a few hundred ridiculous hypothetical scenarios meant to drill into you the basic premises of your field (test your general problem-solving ability), a question like &quot;which is the better form of duck, a potato or this bandsaw&quot; starts to lose its shock value.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158013">
				<div id="div-comment-1158013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ZLB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158013">
			October 28, 2014 at 8:40 am</a>		</div>

		<p>Preventing idle in this scenario is clearly silly!</p>
<p>I thought everyone knew that you should use EmptyWorkingSet() to fix memory leaks!!!!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158023">
				<div id="div-comment-1158023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158023">
			October 28, 2014 at 9:27 am</a>		</div>

		<p>Sometimes it&#39;s easier and less painless to gnaw your own leg off than to explain to management that you need time to debug the application to find why it&#39;s leaking memory when going idle, rather than finding out how to sweep it under the carpet by stopping it going idle.</p>
<p>There are very &quot;clever&quot; people in management, they got there by sweeping things under the carpet long enough to get promoted after all.</p>
<p>It may also be caused by a third party component who say it&#39;s definitely something you&#39;re doing wrong, which your management believe as they trust the third party company more than they trust you. Mainly because you didn&#39;t pay for them to go on an all expenses holiday (sorry sales conference) to Bermuda, but the third party company did.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158033">
				<div id="div-comment-1158033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">j b</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158033">
			October 28, 2014 at 10:33 am</a>		</div>

		<p>Kemp,</p>
<p>Actually I would prefer that those who insist on The Linux Look would rather run a TRUE Linux! You wouldn&#39;t believe how many days I&#39;ve spent on ever new variations of Cygwin and Cygwin-style applications who not only introduce Linux style semantics on their own constructs, but enforce them on Windows defined constructs &#8211; like demand of users that the casing of NTFS file names shall match that in the directory information. Or the worst of them all &#8211; environment symbols: Cygwin rewrites SOME of the Windows-defined symbols to all uppercase, and then enforces case sensitivity, both for those it rewrote in all UC and those it left untouched. </p>
<p>When people need my help to clear out such problems, _and they are the same people that keep bitching about Windows users refusing to learn new habits, that&#39;s why Linux never succeeded on the desktop_, that is when I have to mobilize all the self control that I have to keep myself for spitting in their face&#8230; (OK, I do have sufficient self control for that purpose, but I admit that the urge is present.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158043">
				<div id="div-comment-1158043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">j b</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158043">
			October 28, 2014 at 10:53 am</a>		</div>

		<p>I keep thinking of one of the cases Raymond describes in his book&#8230; This web server that just HAD to be available 24/7. But it had a memory leak causing it to crash with an &quot;out of memory&quot; error every now and then. The only way to free memory was a reboot, interrupting the service, which was not tolerable. So, Raymond tells in his book, they set up this load balancer, (temporarily) replacing the server with a cluster of two machines. When one of them was getting close to memory exhaustion, the load balancer was configured to route all requests to the other machine, while the first one was being rebooted. Next time it was the other machine running out of memory, and the first one had to take the full load during the reboot. This kept the service available without interruption while the system was being debugged. The memory leak was found, and the second machine and the load balancer could be removed.</p>
<p>I don&#39;t have the book available right now, so I may remember some details wrong, but the main idea was that this &quot;cure&quot; kept the service up for the time being.</p>
<p>It could very well be that the customer in THIS case was in a similar situation, most definitely wanting to debug the application, and seeking a way to keep the service available while doing that.</p>
<div class="post">[<em>That would fall into the aforementioned &quot;special-purpose program running on a dedicated computer&quot; category, which in this case it did not appear to be. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158053">
				<div id="div-comment-1158053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158053">
			October 28, 2014 at 11:24 am</a>		</div>

		<p>I&#39;d bet it went like this:</p>
<p>Dev: It leaks when the OS goes Idle&#8230;but I haven&#39;t figured out why yet.</p>
<p>Manager: Well then, why not just prevent it from going idle</p>
<p>Dev: Well, that would be a bad idea because &#8211;</p>
<p>Manager: -Will it fix the leak?</p>
<p>Dev: Well, yeah but &#8211; </p>
<p>Manager: Do it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-even depth-1" id="comment-1158063">
				<div id="div-comment-1158063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158063">
			October 28, 2014 at 11:26 am</a>		</div>

		<p>I suspect the application could not handle being detached from the console when a screen-saver was running.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158093">
				<div id="div-comment-1158093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158093">
			October 28, 2014 at 2:19 pm</a>		</div>

		<p>@sh That&#39;s why you say &quot;No, it will only hide the leak, and until I know why it&#39;s happening and I fix it, I can&#39;t guarantee that it won&#39;t happen via other causes.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158103">
				<div id="div-comment-1158103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158103">
			October 28, 2014 at 2:20 pm</a>		</div>

		<p>And to be clear that&#39;s with a &quot;Now if that&#39;s acceptable to you, we can go down that road, but this is my recommendation.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1157963">
				<div id="div-comment-1157963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1157963">
			October 28, 2014 at 7:34 am</a>		</div>

		<p>Wow. An actual example of an &quot;Old Shoe or Glass Bottle&quot; question.[0]</p>
<p>Aside from &quot;You need to stop building things for money until you understand the basics of construction.&quot;, I think that there are two other legitimate possible answers here.</p>
<p>The first is the classic, telling them to put their computer back in its box, take it to wherever they bought it from, and ask the vendor to take it back on the grounds that they are clearly too gorram stupid to even be allowed to own a computer.</p>
<p>The other is to give them exactly what they want. The sooner *their* customers realise how bad the software is, and to stay away from it and the vendor at all costs, the safer those customers will be. This will greatly reduce the time it takes for their customers to figure that out, saving millions of lives^Whours of frustration in the long run.</p>
<p>[0] <a rel="nofollow" target="_new" href="http://weblogs.asp.net/alex_papadimoulis/408925" rel="nofollow">weblogs.asp.net/&#8230;/408925</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158113">
				<div id="div-comment-1158113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kevin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158113">
			October 28, 2014 at 5:02 pm</a>		</div>

		<p>@Anon: At this point, it&#39;s easier to just downvote stupid StackO questions (which I suspect is exactly what Atwood wants us to do).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158123">
				<div id="div-comment-1158123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ican Justify Anything</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158123">
			October 28, 2014 at 5:53 pm</a>		</div>

		<p>Probably they were trying to locate the source of the leak. &nbsp;</p>
<p>A: &quot;Hey, the leak goes away when I touch keys&quot;. </p>
<p>B: &quot;What does touching the keys do?&quot;</p>
<p>A: &quot;They generate window messages for the keyboard.&quot;</p>
<p>B: &quot;So, the leak is connected to window messages for the keyboard.&quot;</p>
<p>A: &quot;Touching the keys also prevents entering the idle state.&quot;</p>
<p>B: &quot;How do we determine if the leak is connected to window messages, or the idle state?&quot;</p>
<p>A: &quot;If we prevent entering the idle state programmatically, without touching the keys&#8230;&quot;</p>
<p>B: &quot;&#8230; yes, if the leak goes away, then the leak is not connected to window messages for the keyboard.&quot;</p>
<p>&quot;We manufacture car stereo systems, and we found that when the car is coasting, there is not enough power to drive the speakers. &nbsp;Either the alternator is not strong enough when coasting, or there is a short-circuit on the acclerator pedal when pressure is removed from it.&quot; </p>
<p>&quot;How can we determine which situation we are in?&quot;</p>
<p>&quot;If we can remove pressure on the accelerator pedal &#8211; but prevent coasting, so alternator voltage drop does not occur &#8211; then, if the speakers still don&#39;t work right, it must be a short-circuit on the accelerator pedal.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong even thread-even depth-1" id="comment-1158143">
				<div id="div-comment-1158143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158143">
			October 28, 2014 at 6:49 pm</a>		</div>

		<p>I&#39;ve seen &quot;Old Shoe or Glass Bottle&quot; type of questions too much time that now I&#39;ll just ignore them and pretend they don&#39;t exist.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158073">
				<div id="div-comment-1158073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158073">
			October 28, 2014 at 11:52 am</a>		</div>

		<p>@Sockatume</p>
<p>People are conditioned into not responding properly to those questions because when you&#39;re blunt about the situation, you typically get banned/ostracised from communities or reprimanded at your job (at best!).</p>
<p>Just look at the new StackO commenting policy, which seeks to ban even the *perception* of being unkind, no matter how idiotic the question (or petitioner) may be.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158083">
				<div id="div-comment-1158083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">On the Flipside</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158083">
			October 28, 2014 at 12:11 pm</a>		</div>

		<p>@Anon and Sockatume</p>
<p>The *real* problem comes when the questioner interprets a polite &quot;How&#39;d you get here?&quot; or other such attempt to draw out more about the background of the situation as you being mean/unhelpful. &nbsp;I have run into this on IRC before, and it&#39;s quite a recipe for frustration.</p>
<p>It gets worse from there, though, because even a kindly &quot;Please use prepared statements instead, here&#39;s how you&#39;d rewrite this to use prepared statements&quot; in response to the classic &quot;My SQL doesn&#39;t work quite right, plz help&quot; when they&#39;re concatenating stuff together to make their SQL statements gets treated as not being kind by this sort of brain-damaged question-asker.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-hikari odd alt thread-odd thread-alt depth-1" id="comment-1158153">
				<div id="div-comment-1158153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Chris+Crowther' rel='external nofollow' class='url'>Chris Crowther</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158153">
			October 28, 2014 at 9:51 pm</a>		</div>

		<p>@Anon: I think the problem with people bluntly replying is they often don&#39;t explain why it&#39;s a stupid idea. &nbsp;Replies that just say &quot;Why on earth would you want to do that, you f**king idiot?&quot; aren&#39;t that helpful.</p>
<p>Personally I favour an answer that explains why it&#39;s a bad idea but also explains how to do it, if they really want to. &nbsp;It&#39;s quite possible they have a sensible reason for doing something seemingly stupid; they just haven&#39;t explained it very well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158303">
				<div id="div-comment-1158303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sockatume</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158303">
			October 29, 2014 at 8:22 am</a>		</div>

		<p>You&#39;re looking at my comment inside-out, everyone:</p>
<p> &quot;Why is it that people don&#39;t to respond with terse explanations of what&#39;s wrong with the puzzle?&quot;</p>
<p>Don&#39;t care.</p>
<p>&quot;Regardless of the above, why is it that people do take the time to come up with a solution to a problem that&#39;s patently absurd?&quot;</p>
<p>This is what puzzles me. And I think it&#39;s because we&#39;re used to absurd hypothetical questions from exams and problem sets.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158433">
				<div id="div-comment-1158433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">j b</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158433">
			October 29, 2014 at 11:47 am</a>		</div>

		<p>@Chris Crowther,</p>
<p>You are probably right in most cases. Sometimes am the &quot;misguided customer&quot;: When the SW developer screams &quot;You can&#39;t do that!&quot;, I ask back: &quot;Why not? From a user pointer of view, that is a perfectly natural thing to do. Look at this scenario: &#8230;&quot;. In at least two cases, I have managed to turn the SW developer around: &quot;Well, maybe that is something we should look into&#8230;.&quot;, and in future releases, my &quot;crazy&quot; way of using the software has been accepted as perfectly normal and fully supported.</p>
<p>There are lots of software dogmas that we programmers live by, without knowing very well why we stick to them &#8211; and sometimes yell &quot;You can&#39;t do that!&quot; for no very good reason. (We may have arguments, but closer analysis may prove them to be far, far weaker than we first did think.) The &quot;haven&#39;t explained it very well&quot; really goes both ways: We SW guys are often poor at explaining the underlaying structure and &quot;philosophy&quot; of the SW, but users are often poor at explaining their real needs so that we can provide the SW they need. Sometimes, &quot;You can&#39;t do that!&quot; is technically justified, but still the user is justified, too. Only that the needs haven&#39;t come through.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158463">
				<div id="div-comment-1158463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158463">
			October 29, 2014 at 12:56 pm</a>		</div>

		<p>@Kevin</p>
<p>There are several provisions which tell you not to downvote questions just because they&#39;re stupid if they break no other rules.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158473">
				<div id="div-comment-1158473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158473">
			October 29, 2014 at 1:59 pm</a>		</div>

		<p>It&#39;s a good thing the programmer asked MS so they could be told that they need to fix their bug. If they had simply searched for something like &quot;windows prevent idle&quot;, they would likely have found a link to SetThreadExecutionState in the first result.</p>
<p>As it turns out, preventing Windows from going idle is actually a very common task. It is required for CD burners, media players, presentation programs, and more.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158543">
				<div id="div-comment-1158543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158543">
			October 29, 2014 at 4:17 pm</a>		</div>

		<p>@Gabe &#8211; Aargh! My first thought was that &quot;that&#39;s not what the idle state is&quot;&#8230; but it turns out I was totally wrong.</p>
<p>I thought from Raymond&#39;s post that the customer&#39;s problem happened whenever all the CPUs were idle, i.e. basically whenever there were no CPU- or IO-bound tasks running. (To prevent this you basically need to start a thread which run an un-optimisable-out busy loop forever, which is a real Old Shoe or Glass Bottle problem.) So I didn&#39;t actually read the linked article. (I should know better by now.)</p>
<p>Your comment made me actually open the article to grab a quote proving you wrong, only to prove that i was. Thanks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158553">
				<div id="div-comment-1158553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Voigt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158553">
			October 29, 2014 at 4:25 pm</a>		</div>

		<p>@Gabe, you&#39;re confusing &quot;becoming idle&quot; with &quot;effects of staying idle until the configured sleep timer elapses&quot;</p>
<p>SetThreadExecutionState won&#39;t prevent all the other effects of becoming idle such as: MFC OnIdle running (or equivalent in other frameworks), idle priority threads running, dynamic CPU clocking, etc. &nbsp;(And according to the docs, whether tasks scheduled to run when idle are inhibited depends on exactly which flags were passed to SetThreadExecutionState)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1158833">
				<div id="div-comment-1158833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158833">
			October 30, 2014 at 9:40 am</a>		</div>

		<p>@The MAZZTer</p>
<p>&quot;And to be clear that&#39;s with a &quot;Now if that&#39;s acceptable to you, we can go down that road, but this is my recommendation.&quot;</p>
<p>Of course it&#39;s acceptable to the manager, he can tell his manager that he was responsible for getting the leak fixed.</p>
<p>When the problem comes back he can tell his manager that the developers didn&#39;t really fix the problem and he is now considering giving you a written warning.</p>
<p>Once you realise you are working with someone like this, your only option is to leave or hope he gets promoted away from you. Anything else you do will just backfire. They hold all the cards, you don&#39;t have any.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1158843">
				<div id="div-comment-1158843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gabe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20141028-00/?p=43753#comment-1158843">
			October 30, 2014 at 9:58 am</a>		</div>

		<p>Ben Voigt: The MFC OnIdle function runs whenever the window&#39;s message queue is empty. Idle priority threads run whenever CPU is less than 100%. Dynamic CPU frequency changes happen constantly. Those items are all so common that there&#39;s no way they could be asking about how to prevent them.</p>
<p>The only reasonable thing they could be asking is how to prevent the system from starting idle tasks (which presumably interfere with the app and cause it to consume memory).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

