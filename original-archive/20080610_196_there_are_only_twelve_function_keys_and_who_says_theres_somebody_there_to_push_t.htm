<html>
<head>
<title>There are only twelve function keys, and who says there's somebody there to push them?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>There are only twelve function keys, and who says there&#8217;s somebody there to push them?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 10, 2008 / year-entry #197</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>39</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">One of the proposals for adding hidden features to Windows Setup is to have a bunch of hidden function keys, one for each hidden option. Well, first of all, there are only twelve function keys and there are way more than twelve possible Setup features. (Yes, there may be a few function keys still active...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>One of the proposals for adding hidden features to Windows Setup is to have <a href="http://blogs.msdn.com/oldnewthing/archive/2006/07/11/662325.aspx#669025"> a bunch of hidden function keys</a>, one for each hidden option. Well, first of all, there are only twelve function keys and there are way more than twelve possible Setup features. (Yes, there may be a few function keys still active during Setup, but they exist only for compatibility purposes. No new Setup features involve function keys as far as I'm aware. And yes, there are keyboard layouts with more than twelve function keys, but think about what you're saying in context: "Yes, Setup should use function keys that are not available on most keyboards.")</p>
<p> Furthermore, there's no guarantee that there's somebody sitting in front of the computer when it's running Setup. Indeed, 90% of the time, there is <i>nobody there at all</i>; Setup is running on a factory floor somewhere churning out computers day and night. </p>
<p> <a href="http://blogs.msdn.com/oldnewthing/archive/2006/07/11/662325.aspx#662650"> Adding a command line option to Setup also</a> runs you into problems: The command line gradually gets bloated with a bajillion options. After taking your several dozen customizations and cramming them onto the command line, you'll find yourself having to type 500 characters onto the command line to get what you want, and woe unto you if you typo one of those 500 characters. Can you imagine if somebody said, "To set up Windows the way I like, I simply type the following command," followed by a command that goes on for six lines? "This is total crap. I'm expected to type this monstrosity?" </p>
<p> Windows Setup for quite a long time has supported so-called <i>unattended installation</i>. You build a so-called <i>unattend file</i> and pass it to the setup program as a single command line parameter, something like <code>setup /unattend:unattendfile</code>. (I forget the command line exactly; you can go look it up yourself.) Now somebody can post their favorite settings onto their Web site, and you can download it and pass it to Setup. </p>
<p> For many years, this unattend file took the form of an INI file, with <code>[Sections]</code> and <code>Key=Value</code> entries. In Windows&nbsp;Vista, the Setup folks threw away the old parser and switched to XML. Because XML is the wave of the future, right? (I can imagine Steve Ballmer jumping up and down shouting "XML! XML! XML!") I don't know whether they've actually done it, but in principle, the switch to XML means that they can write a schema for the unattend file, and then all the standard XML validation tools become available. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (39)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-637363">
				<div id="div-comment-637363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637363">
			June 10, 2008 at 10:15 am</a>		</div>

		<p>&quot;Indeed, 90% of the time, there is nobody there at all; Setup is running on a factory floor somewhere churning out computers day and night.&quot;</p>
<p>Why would anyone have Setup run this way at all? Why not just blindly blit an image straight to the disk?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637373">
				<div id="div-comment-637373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adarsha.mv.googlepages.com' rel='external nofollow' class='url'>mvadu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637373">
			June 10, 2008 at 10:19 am</a>		</div>

		<p><a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/314459" rel="nofollow">http://support.microsoft.com/kb/314459</a></p>
<p>Gives more info about so-called unattended installation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637383">
				<div id="div-comment-637383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Luc Rooijakkers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637383">
			June 10, 2008 at 10:26 am</a>		</div>

		<p>Karellen: Because there are massive issues with image blitting. Can you say device detection, SID generation, customized harware setups, etc? AFAIK Microsoft does not officially support Windows being &quot;blitted&quot; from machine to machine, although it can be made to work in sufficiently controlled circumstances and with the right tools.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637393">
				<div id="div-comment-637393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637393">
			June 10, 2008 at 10:30 am</a>		</div>

		<p>&quot;so-called&quot; implying it needs attention. &nbsp;which it does, on windows 2000. &nbsp;in fact, it does on XP as well: you need to press a key to boot off the CD-ROM ;)</p>
<p>&quot;Why would anyone have Setup run this way at all? Why not just blindly blit an image straight to the disk?&quot;</p>
<p>Factories probably do. &nbsp;We don&#8217;t (I&#8217;m tech support) because there&#8217;s a ludicrously different number of configurations in my work, so going through the whole setup procedure is better. &nbsp;Also, read up on the SP3 fiasco caused by depending on images too much (&quot;Well, I dunno if you could use an Intel image on an AMD computer&#8230; oh look, it appears to have not immediately broke! It must be perfect in every way and have no hidden problems in the future!&quot;</p>
<p>Also, we don&#8217;t quite do full unattend &#8211; we leave in the partitioning questions at the beginning so we have more choice, especially if you&#8217;re reinstalling a machine that has a second drive you don&#8217;t want to accidentally format</p>
<p>Last time I reinstalled windows at home, I forgot to remove my mp3 player / external HDD which I&#8217;d backed up some files to and it offered it as an installation choice ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637403">
				<div id="div-comment-637403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adarsha.mv.googlepages.com' rel='external nofollow' class='url'>mvadu</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637403">
			June 10, 2008 at 10:33 am</a>		</div>

		<p>Karellen: Consider a HP/Dell factory. They have a separate license for each of the machine going out. They can not blit an image from one machine to other.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637413">
				<div id="div-comment-637413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637413">
			June 10, 2008 at 10:34 am</a>		</div>

		<p>(apologies for the double post but I took too long writing the first one)</p>
<p>Luc: it&#8217;s supported, as long as you run sysprep from the &quot;master&quot; before you clone it. &nbsp;That forces SID regeneration on next boot, and I think makes the computer less likely to fall over on extravagantly different hardware. &nbsp;It&#8217;ll ask you the questions you normally get asked during setup about keyboards and timezones again, too. &nbsp;You can use unattend-esque options to customise this, though I don&#8217;t know if the format is the same. &nbsp;Same basic idea though</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637423">
				<div id="div-comment-637423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637423">
			June 10, 2008 at 12:12 pm</a>		</div>

		<blockquote><p>
  Why would anyone have Setup run this way at</p>
<p>  all? Why not just blindly blit an image</p>
<p>  straight to the disk?
</p></blockquote>
<p>A whole crapload of HP laptops broke when Vista SP1 came out because HP did exactly this when setting it up. Not that HP actually gives a crap about the quality of their computers, but still&#8211; for people who do, it can cause huge problems.</p>
<p>I love questions of the general form:</p>
<p>&quot;Why do what a person of authority recommends I do, why not just do my own thing?&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637433">
				<div id="div-comment-637433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">blah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637433">
			June 10, 2008 at 12:18 pm</a>		</div>

		<p>Raymond better hope Ballmer doesn&#8217;t catch wind of this post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637443">
				<div id="div-comment-637443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637443">
			June 10, 2008 at 12:24 pm</a>		</div>

		<p>mvadu: For OEM licenses, the license key is simply a sticker. &nbsp;The images are identical for every PC of the same make/model (obviously, there are still driver differences).</p>
<p>To go back to the function key problem &#8212; many people seem to forget that there are such things as slate Tablet PCs, which have no keyboards. &nbsp;The TIP soft keyboard doesn&#8217;t have any function keys.</p>
<p>Using a Tablet PC will clue you in a little bit to the massive amount of work that Microsoft does to ensure compatibility across different configurations. &nbsp;Java Swing is the worst for Tablet compatibility &#8212; doesn&#8217;t pick up double-clicks.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637463">
				<div id="div-comment-637463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637463">
			June 10, 2008 at 1:02 pm</a>		</div>

		<p>@Frymaster:</p>
<p>zero the MBR of the &quot;first&quot; harddisk (or remove the i386BOOTFIX.BIN file from your CD) and the &quot;Press any key to boot from CD-ROM&quot; is gone!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-637473">
				<div id="div-comment-637473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637473">
			June 10, 2008 at 1:04 pm</a>		</div>

		<p>There are also three modifier keys, which can be pressed (or not) in eight ways&#8230; which gives you 48 combinations.</p>
<p>And 48 combinations ought to be enough for anybody&#8230; right? &nbsp;Right?</p>
<p>There&#8217;s already precedent for this with the Shift-F10 &quot;open a command prompt during Setup&quot; trick:</p>
<p><a rel="nofollow" target="_new" href="http://geekswithblogs.net/lorint/archive/2006/11/22/97794.aspx" rel="nofollow">http://geekswithblogs.net/lorint/archive/2006/11/22/97794.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637483">
				<div id="div-comment-637483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mikkin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637483">
			June 10, 2008 at 1:28 pm</a>		</div>

		<p>Meh, you really only need one key &#8230; and a working knowledge of Morse code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637503">
				<div id="div-comment-637503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://evolvingenglish.blogspot.com' rel='external nofollow' class='url'>mike</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637503">
			June 10, 2008 at 5:11 pm</a>		</div>

		<p>I am very pleased that you are using &quot;typo&quot; as a verb.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637513">
				<div id="div-comment-637513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com' rel='external nofollow' class='url'>Dale</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637513">
			June 10, 2008 at 5:39 pm</a>		</div>

		<p>&quot;Why would anyone have Setup run this way at all? Why not just blindly blit an image straight to the disk?&quot;</p>
<p>Because Imaging straight to disk has never really been supported by Microsoft, because if you do it wrong, you have an unsupported operating system.</p>
<p>(<a rel="nofollow" target="_new" href="http://support.microsoft.com/kb/314828" rel="nofollow">http://support.microsoft.com/kb/314828</a>)</p>
<p>Sure, you can Sysprep the machine, but by that stage, your processor make has been chosen.</p>
<p>The other issue with imaging is that some vendors products have issues with it. &nbsp;Yes, I&#8217;m talking about you Computer Associates, with your eTrust AV &amp; Unicentre Software Delivery products.</p>
<p>An unattended installation file gives us choice, and choice IS a good thing in this case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637523">
				<div id="div-comment-637523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asymtote</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637523">
			June 10, 2008 at 6:13 pm</a>		</div>

		<p>Why is something of the complexity of XML used for a simple config file? Ini files do not need to be more complex than ini files. To use your example, &quot;Why do I have to type all this XML crap when all I want to do is write an ini file&quot;. Jeez.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637533">
				<div id="div-comment-637533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637533">
			June 10, 2008 at 6:13 pm</a>		</div>

		<p>&quot;Can you say device detection&quot;</p>
<p>Uh yeah. Ship all drivers. Kernel detects devices at boot, goes &quot;oh, there&#8217;s a Foomatic video card and a Bartastic sound card, I&#8217;ll load the drivers for those devices and ignore the drivers for which no hardware is present&quot;. What&#8217;s so hard about that? Don&#8217;t you kind of need that anyway for generic device hotplug detection? (&quot;Oh, there&#8217;s a USB mass storage device. Better load the driver for that. Oh, new generic postscript printer. Load the driver for that.&quot; etc&#8230;)</p>
<p>&quot;SID generation&quot;</p>
<p>Blittable image has no Administrator account/SID. On boot, Windows goes &quot;Oh, no Admin account. Better create one including its SID, and change the ownership of all files in $WINDOWSDIR to new Admin SID.&quot; Again, this will help if someone accidentally deletes (or if a disk problem causes to be lost) the Administrator account details.</p>
<p>&quot;customized hardware setups&quot;</p>
<p>Not sure what the problem here is. See &quot;ship all drivers&quot; in point 1. HW manufacturer is going to know all the hardware they ship, so can include all drivers in image.</p>
<p>Yes, if they&#8217;re building a completely custom rig with hardware they&#8217;ve not shipped before, they&#8217;re going to do that one by hand. But they&#8217;d have to create the install file for that computer by hand anyway, and probably part-build it by hand to put the customised stuff in.</p>
<p>&quot;by that stage, your processor make has been chosen&quot;</p>
<p>OK, so you need a different image for each CPU type you ship. Isn&#8217;t that easier than running an unattended Setup on every single system?</p>
<p>Sorry, I still don&#8217;t see why blits shouldn&#8217;t work in this day and age.</p>
<p>(Trying to resist cheap shot about Windows not being ready for the desktop/enterprise(delete as applicable) until this works, but am obviously unable to :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding even thread-even depth-1" id="comment-637543">
				<div id="div-comment-637543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637543">
			June 10, 2008 at 6:54 pm</a>		</div>

		<p>&quot;Sorry, I still don&#8217;t see why blits shouldn&#8217;t work in this day and age.&quot;</p>
<p>What difference does it make if it&#8217;s an image copy or an unattended setup? It might run a bit faster, but nobody is suggesting you run the unattended setup on one computer at a time.</p>
<p>You&#8217;re suggesting that changes be made to the way Windows works in order to accommodate copying images between computers. Those changes obviously have costs involved. What benefit of making those changes outweighs the cost?</p>
<p>&quot;Raymond better hope Ballmer doesn&#8217;t catch wind of this post.&quot;</p>
<p>Yeah because nobody ever got anywhere in life by having a sense of humour.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637613">
				<div id="div-comment-637613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com' rel='external nofollow' class='url'>Dale</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637613">
			June 10, 2008 at 9:19 pm</a>		</div>

		<p>&#8220;OK, so you need a different image for each CPU type you ship.&#8221;</p>
<p>And HAL-type ;-)</p>
<p>(ok, you CAN do some fancy &#8220;not-supported by MS&#8221; footwork)</p>
<p>&#8220;Uh yeah. Ship all drivers. Kernel detects devices at boot&#8221;</p>
<p>One customer I worked with had 30,000 desktops with 900 different hardware models. &nbsp;The driver library was huge :-(</p>
<p>In the end, both techniques (imaging/unattend) have their advantages, and in most cases I use both when crafting images for deployment.</p>
<div class="post">[<i>Holy crap, a balanced perspective. How&#8217;d you get in here? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637633">
				<div id="div-comment-637633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.mrozekma.com' rel='external nofollow' class='url'>Michael Mrozek</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637633">
			June 10, 2008 at 10:40 pm</a>		</div>

		<p>Maurits: &quot;There are also three modifier keys, which can be pressed (or not) in eight ways&#8230; which gives you 48 combinations.&quot;</p>
<p>Math fail?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637653">
				<div id="div-comment-637653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jcs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637653">
			June 10, 2008 at 11:08 pm</a>		</div>

		<p>Karellen: What you suggest was already done in Windows Vista!!</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Management_features_new_to_Windows_Vista" rel="nofollow">http://en.wikipedia.org/wiki/Management_features_new_to_Windows_Vista</a></p>
<p>Oh wait, I forgot, I&#8217;m not allowed to say anything good about Windows Vista on this forum. Never mind&#8230;</p>
<p>&quot;&quot;(Trying to resist cheap shot about Windows not being ready for the desktop/enterprise(delete as applicable) until this works, but am obviously unable to :-)&quot;&quot;</p>
<p>Your cheap shots would be better received if you actually understood the product that you&#8217;re shooting at.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637663">
				<div id="div-comment-637663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637663">
			June 10, 2008 at 11:08 pm</a>		</div>

		<p>All these silly &quot;Why doesn&#8217;t Windows work like this [horrible horrible idea that would make the common case much harder but make a rare case only very slightly easier]&quot; questions to Raymond remind me of this</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Are_You_There_God%3F_It" rel="nofollow">http://en.wikipedia.org/wiki/Are_You_There_God%3F_It</a>&#8216;s_Me%2C_Jesus</p>
<p>Basically God comes back to Earth every 2000 years and will answer one question but Stan wastes the opportunity with asking something anyone could answer and gets beaten up by an angry crowd.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637673">
				<div id="div-comment-637673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeff Tyrrill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637673">
			June 10, 2008 at 11:32 pm</a>		</div>

		<p>Quote: &quot;Why is something of the complexity of XML used for a simple config file? Ini files do not need to be more complex than ini files. To use your example, &quot;Why do I have to type all this XML crap when all I want to do is write an ini file&quot;. Jeez.&quot;</p>
<p>Because XML has formal support for UTF-8, has strict and standardized well-formedness and validation behavior, and has an abundance of tools to manipulate it.</p>
<p>Among other things, these help eliminate unpredictable behavior (in error cases or otherwise), which greatly <em>simplifies</em> use and testing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637683">
				<div id="div-comment-637683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Merus</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637683">
			June 10, 2008 at 11:50 pm</a>		</div>

		<p>I used to do application packaging, and so I&#8217;ve run into a lot of pain with applications that refuse to install silently. <font color="red">Program XYZ</font>&#8216;s easily the worst &#8211; the amount of work you have to do to get it to install silently, with all the little hooks it insists upon installing, is horrid.</p>
<p>And blitting doesn&#8217;t really work because it&#8217;s extremely inflexible if a computer configuration is even slightly different. And if you&#8217;re going to put all this special case stuff to repair a dodgy blit, you&#8217;re not getting much benefit over reusing your manual install code.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637693">
				<div id="div-comment-637693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637693">
			June 11, 2008 at 1:32 am</a>		</div>

		<blockquote><p>
  After taking your several dozen customizations and cramming them onto the command line, you&#8217;ll find yourself having to type 500 characters onto the command line to get what you want, and woe unto you if you typo one of those 500 characters. Can you imagine if somebody said, &quot;To set up Windows the way I like, I simply type the following command,&quot; followed by a command that goes on for six lines? &quot;This is total crap. I&#8217;m expected to type this monstrosity?&quot;
</p></blockquote>
<p>Been there, seen that: <a rel="nofollow" target="_new" href="http://www.bash.org/?464385" rel="nofollow">http://www.bash.org/?464385</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637703">
				<div id="div-comment-637703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637703">
			June 11, 2008 at 1:56 am</a>		</div>

		<p>When I setup up my Sony UX UMPC, I reinstalled the custom version of Vista on it to remove all the junk that Sony shipped, but still have all the drivers and necessary customizations.</p>
<p>An interesting thing was the recovery process (which you interrupt) after restoring Vista, runs and tries to install all the apps on the recovery, then it scripts a Sysprep to &quot;re-seal&quot; Vista. I only found this when following the &quot;how to get a nearly crap-free recovery&quot; installation, which involved ejecting the recovery media during first boot, halting recovery, which then causes sysprep to launch and wait to do something.</p>
<p>Interestingly, too, the first boot took over an hour and ended in a reboot. As if Sony basically made one master image that customizes itself on first boot &#8211; installing drivers, apps, and then running sysprep. So there&#8217;s a way to do one image and support practically any configuration&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637733">
				<div id="div-comment-637733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637733">
			June 11, 2008 at 4:40 am</a>		</div>

		<ol>
<li>Blitting is indeed an option, but you have to sysprep the source drive before blitting, which removes all the machine-specific stuff from it &#8211; SIDs, users, license, hardware, etc. Then, Windows goes through a phase called &quot;mini-setup&quot;, where you&#8217;re asked the same questions like you would with normal setup. You can provide sysprep.inf, which is the same format like unattend.inf.</li>
</ol>
<p>Of course, you could just have an unattended setup with unattend.inf, and forget about the blitting. The blitting option was faster in Windows 2000/XP/2003.</p>
<p>In Vista/2008, the 2 options are actually one: Setup-from-DVD actually asks a few things, blits a &quot;syspreped&quot; image to the HD (from a huge source.wim), puts sysprep.xml (or something) there, and then the image goes through mini-setup. So there&#8217;s little difference between the 2 options anymore.</p>
<ol>
<li>
<p>The are pros and cons to inf vs. XML. IMO, the best thing about XML is that it defines all the little things the inf doesn&#8217;t &#8211; charset, whitespace, etc. It is also easily manipulated programatically from any reasonable programming environment. It is more verbose though.</p>
</li>
<li>
<p>The requirement to have &quot;magic keys&quot; during setup is for installing straight from the CD, where you don&#8217;t have anywhere to put an unattended.inf/xml, or type a commandline. A nicer options would be like the boot-time F8, which shows a menu with options. For example, Vista setup lets you load a mass-storage driver with a GUI &#8211; and you can point to a diskette / USB drive / whatever. This is a definate improvement over the &quot;A: only&quot; XP behavior.</p>
</li>
</ol>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637753">
				<div id="div-comment-637753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pingpong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637753">
			June 11, 2008 at 6:36 am</a>		</div>

		<p>@Calculator:</p>
<p>Care to explain your reasoning?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637773">
				<div id="div-comment-637773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637773">
			June 11, 2008 at 9:36 am</a>		</div>

		<p>The basis of 8 isn&#8217;t right, though. &nbsp;Here&#8217;s the list:</p>
<p>12 function keys on their own (no modifiers)</p>
<p>12 function keys with shift</p>
<p>12 function keys with alt</p>
<p>12 function keys with ctrl</p>
<p>12 function keys with ctrl+alt (no shift)</p>
<p>12 function keys with ctrl+shift (no alt)</p>
<p>12 function keys with alt+shift (no ctrl)</p>
<p>12 function keys with ctrl+alt+shift.</p>
<p>That&#8217;s actually 96, assuming I can multiply.</p>
<p>Of course, whether using these modifiers is actually a good idea or not is another question entirely. &nbsp;I bet it isn&#8217;t&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637813">
				<div id="div-comment-637813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bryan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637813">
			June 11, 2008 at 10:41 am</a>		</div>

		<p>Karellen:</p>
<p>You should also understand the product from which you are basing your cheap shot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637723">
				<div id="div-comment-637723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Aaargh!</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637723">
			June 11, 2008 at 3:54 am</a>		</div>

		<p>&quot;What benefit of making those changes outweighs the cost?&quot;</p>
<p>You can install *all* computers (not just 1 model) from a single image, you don&#8217;t have to reinstall Windows every time you upgrade your hardware, you don&#8217;t have to insert the Windows CD every time you install some hardware just so windows can look for the driver, you can just load the driver instead of nagging the user with prompts for disks, etc. etc.</p>
<p>Modern OSes do this all the time. A certain OS from a certain company named after a certain piece of fruit can even boot the same disk image on PPC and x86 machines.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637743">
				<div id="div-comment-637743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Calculator</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637743">
			June 11, 2008 at 5:44 am</a>		</div>

		<p>@ Michael Mrozek: Math Fail?</p>
<p>try 8 * 3 * 2</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-637923">
				<div id="div-comment-637923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637923">
			June 11, 2008 at 3:01 pm</a>		</div>

		<p>I made a follow-up post immediately after my &quot;48&quot; post with the single line &quot;s/48/96/g&quot;. &nbsp;Apparently it got eaten by a grue.</p>
<p>Anyway, 96 is correct (12 * 2^3).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637763">
				<div id="div-comment-637763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">apz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637763">
			June 11, 2008 at 9:09 am</a>		</div>

		<p>&gt;&gt; @Calculator:</p>
<p>&gt;&gt;</p>
<p>&gt;&gt; Care to explain your reasoning?</p>
<p>8 * 3!</p>
<p>= 8 * 3 * 2 * 1</p>
<p>= 48</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637783">
				<div id="div-comment-637783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637783">
			June 11, 2008 at 9:45 am</a>		</div>

		<p>&quot;Your cheap shots would be better received if you actually understood the product that you&#8217;re shooting at.&quot;</p>
<p>Hey, I was trying to understand the product. That&#8217;s why I *asked* why people didn&#8217;t do the obvious thing $FOO that other modern OSs have no problems with.</p>
<p>If everyone else wasn&#8217;t misinforming me about Windows by telling me it can&#8217;t do $FOO when it can, the bogus cheap shots wouldn&#8217;t present themselves.</p>
<p>Sheesh. :-p</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-637973">
				<div id="div-comment-637973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637973">
			June 11, 2008 at 5:44 pm</a>		</div>

		<p>You mean, jumping up and down like this?</p>
<p><a rel="nofollow" target="_new" href="http://www.egg-attack.com/" rel="nofollow">http://www.egg-attack.com/</a> ;)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-637823">
				<div id="div-comment-637823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-637823">
			June 11, 2008 at 11:23 am</a>		</div>

		<p>Let&#8217;s be fair to the original idea. The problem at hand was pre-existing data on disk during a setup. It doesn&#8217;t matter that 90% of the setups are unattended &#8211; those are first installs of Windows on a new PC. If there was user data on the disk, it&#8217;s perfectly OK to wait for user input. It&#8217;s in fact a bad idea *not* to wait. How many of the other 499 options fall in that category?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-638013">
				<div id="div-comment-638013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.wisefaq.com' rel='external nofollow' class='url'>Dale</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-638013">
			June 11, 2008 at 8:31 pm</a>		</div>

		<p>&quot;[Holy crap, a balanced perspective. How&#8217;d you get in here? -Raymond]&quot;</p>
<p>Well cause I&#8217;ve been there, done it and made lots of mistakes :-)</p>
<p>Some solutions which work perfectly well for 1, 5, or 20 PCs just don&#8217;t scale out. &nbsp;Be it desktop SOE deployment, or software/patch management.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-638893">
				<div id="div-comment-638893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-638893">
			June 14, 2008 at 9:05 pm</a>		</div>

		<p>You should also understand the cheap product from which you are basing your shot.</p>
<p>Is the function keys and there functions documented somewhere?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-639133">
				<div id="div-comment-639133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuhong Bao</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080610-00/?p=22003#comment-639133">
			June 16, 2008 at 11:42 pm</a>		</div>

		<p>&quot;but by that stage, your processor make has been chosen.&quot;</p>
<p>To be more precise, the processor driver has been already chosen. BTW, can you disable all processor drivers before you sysprep?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

