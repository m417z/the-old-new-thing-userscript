<html>
<head>
<title>How do I compress files (via NTFS compression) from the command line?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I compress files (via NTFS compression) from the command line?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>June 22, 2011 / year-entry #149</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>33</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer wanted to know whether there was a way to compress files and directories (in the sense of NTFS compression) from a script or from the command line. They knew about the Properties dialog, but they wanted something scriptable. The command-line tool for this is COMPACT.EXE. Type compact /? for usage information. The customer...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>A customer wanted to know whether there was a way to compress files and directories (in the sense of NTFS compression) from a script or from the command line. They knew about the Properties dialog, but they wanted something scriptable.</p>
<p> The command-line tool for this is <code>COMPACT.EXE</code>. Type <code>compact /?</code> for usage information. </p>
<p> The customer liaison was grateful for this information. </p>
<blockquote class="q"><p> Thanks for the prompt response, and yes, this will meet our customer's need to compress specific files such as *.docx under a particular directory and all its subdirectories. </p>
</blockquote>
<p> Um, *.docx files are already compressed. Compressing them again gains you nothing. </p>
<p> <b>Bonus reading</b>: Functions for manipulating documents which follow the Open Package Conventions are available in both <a href="http://msdn.microsoft.com/system.io.packaging.aspx"> managed</a> and <a href="http://msdn.microsoft.com/dd371623.aspx"> unmanaged</a> versions. Check out the <a href="http://blogs.msdn.com/opc/"> Packaging Team Blog</a> for more information, including <a href="http://blogs.msdn.com/opc/archive/2009/08/05/comparison-between-the-opc-managed-code-and-native-code-apis.aspx"> a comparison of the managed and unmanaged versions</a>. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (33)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-920663">
				<div id="div-comment-920663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam Rosenfield</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920663">
			June 22, 2011 at 7:05 am</a>		</div>

		<p>Yep, .docx files are just zip files in disguise. &nbsp;It always saddens me when I see compressed archives full of other compressed files like JPEGs, MP3s, other zip files, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920673">
				<div id="div-comment-920673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920673">
			June 22, 2011 at 7:14 am</a>		</div>

		<p>Unless they are in there with the store compression setting. Then you know they are using the format to distribute the files in one archive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920683">
				<div id="div-comment-920683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920683">
			June 22, 2011 at 7:17 am</a>		</div>

		<p>@Adam,</p>
<p>Yes and no. &nbsp;Certainly you don&#39;t gain anything (size wise) by trying to compress a bunch of jpegs, people may decide to put them in an archive like a zip file for the benefit of having them all in a single file.</p>
<p>Now you can, of course, tell your compression program not to actually compress the files, but unless you are making a huge archive, the time savings of not compressing doesn&#39;t offset the extra time needed to actually figure out how to tell your compression software not to bother compressing the files.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920703">
				<div id="div-comment-920703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ERock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920703">
			June 22, 2011 at 7:56 am</a>		</div>

		<p>Well, it may not do anything for disk space savings, but it makes them blue in the Explorer window, which means it&#39;ll just make the users happy thinking magic was made. I recall delighting a user group with a pdf writer that was installed so they could use Word to print to PDF, and then use Adobe to print the very same PDF.</p>
<p>Some people like the crusts cut off their sandwiches, after all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920713">
				<div id="div-comment-920713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrkMatter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920713">
			June 22, 2011 at 8:23 am</a>		</div>

		<p>@Adam Rosenfield</p>
<p>On the other hand, can&#39;t you possibly make additional size gains if very similar documents are pooled in the same archive? I know very little about zip compression, so I do not know if compression occurs on a per file basis or on the whole archive.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920733">
				<div id="div-comment-920733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RichB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920733">
			June 22, 2011 at 8:27 am</a>		</div>

		<blockquote><p>
  Um, *.docx files are already compressed. Compressing them again gains you nothing.
</p></blockquote>
<p>In this particular case yes. But as a nitpicker, the statement is not generally true. If you use a compression method which uses solid compression &#8211; such as CAB files or zipped tarballs &#8211; then compressing again may in fact help.</p>
<p><a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/Solid_compression" rel="nofollow">en.wikipedia.org/&#8230;/Solid_compression</a></p>
<p>It&#39;s slightly ironic that Microsoft implemented docx files with .zip compression &#8211; a non solid compression technology versus CAB compression which has been in Windows for&#8230;.oh&#8230;.16 years.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920743">
				<div id="div-comment-920743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920743">
			June 22, 2011 at 8:28 am</a>		</div>

		<p>@Crescens2k, @SimonRev: Most compression programs can detect compressing will gain nothing and automatically store the file uncompressed without you having to do anything.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920753">
				<div id="div-comment-920753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920753">
			June 22, 2011 at 8:31 am</a>		</div>

		<p>@RichB: Solid compression means you have to decompress everything when you are only interested in a single file. You might gain compression but lose performance. The old zip format has a good tradeoff between compression and performance, with the bonus that it is a de facto standard everyone understands.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920763">
				<div id="div-comment-920763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RichB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920763">
			June 22, 2011 at 8:36 am</a>		</div>

		<p>@Cesar Yea, I knew that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920773">
				<div id="div-comment-920773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920773">
			June 22, 2011 at 8:37 am</a>		</div>

		<p>Hard to make any general statements about compression &#8211; after all there are not only dozens of different algorithms, but also lots of different settings. Especially compressing small files into one large archive with a solid block size can reduce size quite nicely even for compressed files.</p>
<p>IE: ~200jpegs compressed with 7z on some higher settings reduces the filesize from 90mb to 71mb. Is a more than 20% compression for files that are backed up or used rarely that bad? Hardly &#8211; and for backups always handy, you get a checksum to see if something goes wrong. So being extremely sad about someone compressing jpegs has no real basis..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920793">
				<div id="div-comment-920793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920793">
			June 22, 2011 at 9:45 am</a>		</div>

		<p>@tsrblke I assume (purely speculation!) why gmail can&#39;t use folders is, that it would basically allow them (and therefore all websites) to traverse the whole filesystem of a user (ie they get the folder and to add everything in there they have to traverse it). While having to compress/archive everything is a bit annoying, I still think that&#39;s preferable to allowing websites access to the filesystem..</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920803">
				<div id="div-comment-920803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ALS</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920803">
			June 22, 2011 at 10:01 am</a>		</div>

		<p>$5 says the user compressed the files, saw little or no space savings, and first complained about compress/ntfs compression not working well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920813">
				<div id="div-comment-920813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nathan Samson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920813">
			June 22, 2011 at 10:04 am</a>		</div>

		<p>@tsrblke</p>
<p>As voo pointed out, this is an issue with browser API&#39;s / security concerns. Flash could maybe help here, but that is not a solution everywhere for everyone.</p>
<p>But actually attaching (multiple) files in gmail is quite easy nowadays</p>
<p>Step 1: Install a decent browser (Firefox 4/5 or Chrome will do, maybe even opera and IE8, but I&#39;m not sure and in IE&#39;s case I highly doubt it).</p>
<p>Step 2: Open windows explorer (or in my case nautilus, the (Linux) Gnome File Browser)</p>
<p>Step 3: Select your files you want to attach</p>
<p>Step 4: Drag them to the attachment &quot;box&quot; (A big dropzone will activate once you hover over it &#8212; including subject line)</p>
<p>Step 5: See your files attached all at once, and being uploaded in the background</p>
<p>One single addition would be worthwile though: Having the multiple=&quot;multiple&quot; attribute on the file input widget, so you can select multiple files at once from within the browser instead of only with drag and drop. But this is even less supported in browsers for now AFAIK.</p>
<p>As fas a I know other (web)mail programs (hotmail, outlook web app, yahoo, &#8230;) are even less advanced</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920823">
				<div id="div-comment-920823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920823">
			June 22, 2011 at 10:26 am</a>		</div>

		<p>Why is the Compression GUI so un-evolved and basic/dumbed down? It&#39;s there since NT 3.51 and so many years later, it&#39;s still a checkbox? We had &quot;Compress old files&quot; option in Disk Cleanup but that was also removed in Vista because it slowed the Disk Cleanup utility even before it showed its options. There is an excellent open source tool called NTFS Compressor (<a href="http://sourceforge.net/projects/ntfscompressor/files/ntfscompressor/NTFSCompressor.v034a.2005/NTFS_Compressor.v034a.exe/download" target="_new" rel="nofollow">sourceforge.net/&#8230;/download</a>) for advanced options. Something like this should be integrated into the compression GUI instead of just a checkbox. It has configurable options for file types to exclude, compress by other attributes, folder paths to exclude, compress by size or % save disk space, skip recompressing already NTFS compressed files. Even compact.exe has plenty of switches. Windows 8 or 9 maybe?</p>
<div class="post">[<i><a href="http://blogs.msdn.com/b/oldnewthing/archive/2008/01/14/7103585.aspx" rel="nofollow">No matter where you put an advanced setting, somebody will tell you that you are an idiot</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920833">
				<div id="div-comment-920833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920833">
			June 22, 2011 at 10:42 am</a>		</div>

		<p>&quot;No matter where you put an advanced setting, somebody will tell you that you are an idiot.&quot;</p>
<p>This would mean there should be no improvement after several versions to the GUI? Probably, that&#39;s why the issue of not being able to set security permissions on multiple files in Vista/7 is &quot;by design&quot; and not being fixed.</p>
<div class="post">[<i><a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/05/31/10017567.aspx" rel="nofollow">That&#39;s a great idea. It&#39;s on the list</a>. (Actually, this probably wouldn&#39;t make the list, since the target audience for this feature would be people comfortable with command line tools in the first place. Like the IT Administrators who update multiple ACLs with icacls.) And the multiple-file permission issue is not by design out of laziness. It&#39;s by design because of <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/04/07/9991494.aspx" rel="nofollow">an actual design issue</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920843">
				<div id="div-comment-920843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920843">
			June 22, 2011 at 10:54 am</a>		</div>

		<p>The multiple-file permission can be fixed by using this dialog for UAC: <a rel="nofollow" target="_new" href="http://img511.imageshack.us/img511/5607/alternateelevationdialo.png" rel="nofollow">img511.imageshack.us/&#8230;/alternateelevationdialo.png</a> (it&#39;s already used for all other attribute related operations) instead of the regular UAC dialog.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920853">
				<div id="div-comment-920853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920853">
			June 22, 2011 at 11:29 am</a>		</div>

		<p>I would tell Troll to shut up but this time Raymond introduced the topic.</p>
<p>Either way, just turn UAC off instead of complain about it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920873">
				<div id="div-comment-920873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920873">
			June 22, 2011 at 11:41 am</a>		</div>

		<p>The real question is where is the command line utility to force the preview image database to be rebuilt in entirety?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920883">
				<div id="div-comment-920883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920883">
			June 22, 2011 at 11:47 am</a>		</div>

		<p>The Packaging Team Blog. 5 posts from 2 years ago. Now there&#39;s a stable technology.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920893">
				<div id="div-comment-920893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920893">
			June 22, 2011 at 11:48 am</a>		</div>

		<p>I would tell Joshua to shut up for topics where he doesn&#39;t know what we are discussing. Turning off UAC doesn&#39;t bring back a removed feature.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920903">
				<div id="div-comment-920903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rangoric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920903">
			June 22, 2011 at 12:46 pm</a>		</div>

		<p>@Troll</p>
<p>That feature was removed for a reason. You didn&#39;t even read the linked post which goes over this very issue.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920913">
				<div id="div-comment-920913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920913">
			June 22, 2011 at 1:12 pm</a>		</div>

		<p>I&#39;m not exactly sure how we even ended up discussing this topic. But to recapitulate: People are complaining because they have to use a command line tool to change ACLs of several files without changing everything in a whole folder?</p>
<p>So people who really should be fine with the CLI (yeah I&#39;m pretty sure my mom has no idea what ACLs are &#8211; and why would she?) doing a rare corner case of something that isn&#39;t done that often to begin with are complaining that it may take half a minute longer to do so?</p>
<p>Well I&#39;m sure after MS has implemented all other less obscure features that profit a larger user base in Windows 30, they&#39;ll look at that again xX</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920923">
				<div id="div-comment-920923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Schend</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920923">
			June 22, 2011 at 3:23 pm</a>		</div>

		<p>Guys, his NAME is TROLL. Do you think he might be trolling you? (It doesn&#39;t help that Raymond got trolled too.) Sheesh, this is Internet Forum 101 stuff here.</p>
<div class="post">[<i>I try not to discriminate based on a person&#39;s name. Maybe I should. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920723">
				<div id="div-comment-920723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cesar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920723">
			June 22, 2011 at 8:25 am</a>		</div>

		<p>&gt; Um, *.docx files are already compressed. Compressing them again gains you nothing.</p>
<p>Do not be so sure. AFAIK, *.docx are compressed using deflate, the same as gzip. Try the following on a Unix system:</p>
<p>$ dd if=/dev/zero of=testfile bs=1024 count=1024</p>
<p>$ ls -l testfile</p>
<p>-rw-r&#8211;r&#8211; 1 cesar cesar 1048576 2011-06-22 12:11 testfile</p>
<p>$ gzip -9v testfile</p>
<p>testfile: 99.9% &#8212; replaced with testfile.gz</p>
<p>$ ls -l testfile.gz</p>
<p>-rw-r&#8211;r&#8211; 1 cesar cesar 1060 2011-06-22 12:11 testfile.gz</p>
<p>$ mv testfile.gz testfile2</p>
<p>$ gzip -9v testfile2</p>
<p>testfile2: 95.6% &#8212; replaced with testfile2.gz</p>
<p>$ ls -l testfile2.gz</p>
<p>-rw-r&#8211;r&#8211; 1 cesar cesar 83 2011-06-22 12:11 testfile2.gz</p>
<p>This creates a 1 megabyte file of zeros, compresses it with gzip to 1060 bytes, and compresses it *again* with gzip to 83 bytes.</p>
<p>While with real files the effects are not as dramatic as with a zero-filled file, they do exist (and I have seen it happen). This is because deflate is limited in the amount of redundancy it can remove &#8211; in particular, it has a very small window size (around 32 KiB). If you have enough redundancy in your file, the deflate output itself will be repetitive and can be compressed again, even by the same algorithm.</p>
<p>(In case some are still doubting this works in real files, I tried with a real file. I randomly chose /lib/libc-2.11.1.so on this machine which has 1572232 bytes. The first gzip pass took it down to 702418 bytes, and the second gzip pass took it down to 700796 bytes.)</p>
<div class="post">[<i>News flash: NTFS compression is not the same as gzip compression. (Think: Random access.) -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920783">
				<div id="div-comment-920783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tsrblke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920783">
			June 22, 2011 at 9:25 am</a>		</div>

		<p>Yeah,I understand that it gains you no size space, but honestly neither would compressing .doc files unless you had thousands of them, relative to average drive space (even 1 year ago when this was written!). &nbsp;But I do parrot the others here, what it gains is reduction to 1 file, which may be what they wanted. &nbsp;If I have 20-30 of these and I need to send them to someone via email, it&#39;s a heck of a lot easier to send them ZIPed then it is to add each of them to the document. &nbsp;I consider that a flaw of most email program though (I&#39;m staring at you Gmail in particular) why can&#39;t I &quot;attach folder?&quot; &nbsp;But I digress.</p>
<div class="post">[<i>The customer was not looking for file consolidation either. They had some *.docx files and wanted to apply NTFS compression to them. Even though applying NTFS compression to *.docx files is basically useless. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920943">
				<div id="div-comment-920943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920943">
			June 22, 2011 at 6:31 pm</a>		</div>

		<p>Roll is a real surname. His first initial may be &quot;T&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920953">
				<div id="div-comment-920953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920953">
			June 22, 2011 at 7:27 pm</a>		</div>

		<p>[I try not to discriminate based on a person&#39;s name. Maybe I should. -Raymond]</p>
<p>The guy admitted he chose the name deliberately a few tens of blog entries back.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-920973">
				<div id="div-comment-920973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920973">
			June 23, 2011 at 4:06 am</a>		</div>

		<p>Novell NetWare used a different compression system (whole-file compression, decompress on use, throw away compressed or uncompressed version depending on heuristics). There were a number of relevant attributes, &quot;please compress now&quot;, &quot;file is currently compressed&quot;, &quot;compression did not reduce file allocation size&quot; (or &quot;can&#39;t compress&quot; for short).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-920983">
				<div id="div-comment-920983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Troll</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-920983">
			June 23, 2011 at 5:01 am</a>		</div>

		<p>@Rangoric, I have read that post a million times. You didn&#39;t read the comments in that post or mine here at all which apply to that post as well or else you wouldn&#39;t have said that. Raymond&#39;s (or Microsoft&#39;s) argument the UAC dialog NEEDS to display the file names on which you are operating is just a silly excuse. No file operations on multiple files done thru properties need to display file names all at once. Either they can show the file name one by one as operating on each file like the Attributes/copying dialogs do or they don&#39;t show any name at all (neither did Windows 2000 or XP showed the file names of files whose permissions you are setting). The alternative security dialog used when applying attributes like Compressed or Encrypted can very well be used when applying security permissions. Problem fixed. Or they can elevate the entire property sheet like certain device manager pages can. Either ways, there are a dozen ways to fix the problem but MS doesn&#39;t care enough because it&#39;s already been 2 releases post XP.</p>
<p>And don&#39;t assume just because my username is troll, I am trolling.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921053">
				<div id="div-comment-921053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">tsrblke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-921053">
			June 23, 2011 at 8:58 am</a>		</div>

		<p>@Raymond,</p>
<p>Well then my assumptions were entirely unwarrented then. &nbsp;That will likely teach me&#8230;who am I kidding it will teach me nothing. Compression is complex and I don&#39;t really fault the end user for not getting it. &nbsp;Plus if you compress enough things you&#39;ll likely gain 1KB space difference in a rounding error at some point I imagine, which the user thinks is compression!</p>
<p>Space is so cheap I often wonder why we bother anymore with it. I remember having a conversation with my wife who was using a commandline to compress stuff for work. &nbsp;It was a bunch of text files (which do compress well) but I remember asking her &quot;Why? They&#39;re like 100kbps each, even if you produce 5/day it&#39;ll take you tens of years to fill up a standard (500 gig) harddrive assuming you never purge anything.&quot; &nbsp;Her response &quot;They told me to!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921153">
				<div id="div-comment-921153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bart</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-921153">
			June 23, 2011 at 8:27 pm</a>		</div>

		<p>Maybe they&#39;re just used to the years of MS claims that Office files were &quot;highly compressed&quot; when in reality they were not. So when .docx came along, with yet another claim that the documents would be &quot;as small as they possible could be&quot;, the customer did what they were getting used to &#8211; ignore that piece of marketing blurb.</p>
<p>As for being sad about packing, say, 200 jpg files in one zip file&#8211;I&#39;m sure that whoever wrote that never had to save those 200 jpegs as single attachments, one by one. I prefer saving a single zip file and then unpacking it. But that&#39;s just me.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-921773">
				<div id="div-comment-921773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-921773">
			June 28, 2011 at 7:32 am</a>		</div>

		<p>I learned the command line to uncompress all files from a drive. &nbsp;On older, slower computers, a few years back, when the disk space had grown faster than the CPU and memory had, it seemed like a logical thing to do.</p>
<p>My Dad&#39;s computer has a 500 GB data drive (and a 500 GB backup drive) but even though the disks contain many of the scientific papers that he wrote or is working on, many stock market data files, and lots of family pictures, he is only using 15 GB. &nbsp;I told him that he would have to do better than that&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-921793">
				<div id="div-comment-921793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20110622-00/?p=10363#comment-921793">
			June 28, 2011 at 7:50 am</a>		</div>

		<p>I know that writing blogs can be unrewarding, but the packaging team blog is a very poor example. &nbsp;5 entries from 2009, and that&#39;s the extent of the blog. &nbsp;That is more than I have blogged, but&#8230; even with the best intentions&#8230;</p>
<p>Kudos to Raymond for doing such a good job!</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

