<html>
<head>
<title>The interaction between AppBars and Windows 10 virtual desktops</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>The interaction between AppBars and Windows 10 virtual desktops</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 4, 2017 / year-entry #108</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>15</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">They apply to all virtual desktops.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer had a question about
the interaction between
<a HREF="https://msdn.microsoft.com/library/windows/desktop/cc144177.aspx">
Application Desktop Toolbars</a>
(commonly known as AppBars)
and Windows 10 virtual desktops.
"When we create our AppBar,
it is shown on all virtual desktops.
Is this expected behavior?
Can I limit it to only one virtual desktop?"
</p>
<p>
Yes, this is expected behavior.
AppBars modify the work area of the monitor they appear on,
and the work area is global across all virtual desktops.
As a result, AppBars are also global across all virtual desktops.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1 parent" id="comment-1295195">
				<div id="div-comment-1295195" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295195">
			May 4, 2017 at 8:30 am</a>		</div>

		<p>I guess most people do not know the existence (or the name) of such feature <strong>since Windows 2000</strong>. As an example, in OneNote 2016 for Windows Desktop, click <em>View &#8211; New Docked Window</em> to see what an AppBar looks like.</p>
<p>Also, the name AppBar is also used for the bar of commands that appears on the top/bottom of the windows of WinRT apps.</p>
<p>Finally, an Application Desktop Toolbar does not show as a thumbnail in Task View.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1295206">
				<div id="div-comment-1295206" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Yuri Khan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295206">
			May 4, 2017 at 10:03 am</a>		</div>

		<p>Appbars existed as far back as Windows 98. Or, more precisely, IE4 shell update.</p>
<p>Dragging a folder from Explorer to the edge of screen would open that folder as a Quick Launchâ€“like appbar.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-geelaw even depth-3" id="comment-1295215">
				<div id="div-comment-1295215" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Gee+Law' rel='external nofollow' class='url'>Gee Law</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295215">
			May 4, 2017 at 10:20 am</a>		</div>

		<p>This reminds me of dragging the Quick Launch or other folders added to the task bar out.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wndsks odd alt depth-3 parent" id="comment-1295226">
				<div id="div-comment-1295226" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/skSdnW' rel='external nofollow' class='url'>skSdnW</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295226">
			May 4, 2017 at 2:22 pm</a>		</div>

		<p>Wrong, SHAppBarMessage exists in Win95. </p>
<p>IE3 added the rebar/coolbar control the taskbar in IE4+ShellUpdate &amp; Win98 uses to divide the taskbar into deskbars that can also float as separate windows.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1295236">
				<div id="div-comment-1295236" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295236">
			May 4, 2017 at 6:06 pm</a>		</div>

		<p>Okay guys&#8230; I should have said that it existed at least since Windows 2000. The reason I use this timeframe is that this is the documented least supported OS. Pre-NT docs have long retired, I believe. Plus, I&#8217;ve never seen an app done this (except <code>explorer.exe</code>) until I met OneNote.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-5" id="comment-1295246">
				<div id="div-comment-1295246" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295246">
			May 4, 2017 at 6:09 pm</a>		</div>

		<p>Well I&#8217;m correcting myself again. The first non-explorer thing I know that does this is actually Magnifier.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-5" id="comment-1295255">
				<div id="div-comment-1295255" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://adamrosenfield.com' rel='external nofollow' class='url'>Adam Rosenfield</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295255">
			May 4, 2017 at 11:13 pm</a>		</div>

		<p>I can&#8217;t seem to find it, but I seem to recall either a post or a comment on this blog from a while back saying that all of the MSDN Win32 documentation has been updated to say that functions are available on Windows 2000 or newer, even if they were actually first available on a much more ancient version of Windows.</p>
<p>I think the rationale was something like they didn&#8217;t want to have to maintain that information (&#8220;was this available in Windows 95 or 98?&#8221;) that was totally irrelevant for modern purposes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-5" id="comment-1295265">
				<div id="div-comment-1295265" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xcomcmdr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295265">
			May 5, 2017 at 2:24 am</a>		</div>

		<p>I&#8217;d love to have all the pre-NT Win32 and DirectX documentation.<br />
Especially development guides.</p>
<p>For people trying to fix old games, it would be a very useful resource.</p>
<p>Most of the time I use MSDN, but sometimes it isn&#8217;t enough at all.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-4" id="comment-1295476">
				<div id="div-comment-1295476" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua A Schaeffer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295476">
			May 8, 2017 at 7:11 am</a>		</div>

		<p>The rebar/coolbar was a brilliant idea. If someone else doesn&#8217;t recreate it as a XAML panel, I will have to. Ribbons are just madness, digging through the tabs makes me forget what I was doing in the first place all the freaking time, and I&#8217;m supposed to be one of the smart ones.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1295205">
				<div id="div-comment-1295205" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295205">
			May 4, 2017 at 8:32 am</a>		</div>

		<p>Q: Is the Taskbar just an Application Desktop Toolbar created by <code>explorer.exe</code>?</p>
<p>I guess so.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1295225">
				<div id="div-comment-1295225" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://english.rejbrand.se/' rel='external nofollow' class='url'>Andreas Rejbrand</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295225">
			May 4, 2017 at 1:25 pm</a>		</div>

		<p>According to <a href="https://www.microsoft.com/msj/archive/S274.aspx" rel="nofollow">https://www.microsoft.com/msj/archive/S274.aspx</a>, &#8220;The shell&#8217;s taskbar window is a well-known example of an appbar.&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1295365">
				<div id="div-comment-1295365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295365">
			May 5, 2017 at 7:51 pm</a>		</div>

		<p>Wait a second&#8230; An app bar window is not necessarily automatically shown on all virtual desktops. Magnifier&#8217;s dock window shows up on all virtual desktops, but OneNote docked window does not. However, the region reserved for that window is kept across all virtual desktops.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1295387">
				<div id="div-comment-1295387" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295387">
			May 6, 2017 at 9:27 am</a>		</div>

		<p>Sounds like a bug. I suspect OneNote registered an invisible window as an AppBar, and is showing a different window in exactly the same place. So the AppBar is indeed on all virtual desktops. Too bad the AppBar is invisible.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1295405">
				<div id="div-comment-1295405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://geelaw.blog/' rel='external nofollow' class='url'>GL</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295405">
			May 6, 2017 at 12:27 pm</a>		</div>

		<p>That could be the reason. I also tried something interesting. Wrote a script to register a Console window (managed by <code>csrss</code>, so the registration is inter-process) as AppBar and the Console window <b>did not</b> show up on all virtual desktops. I&#8217;m by no means any Win32 programmer, perhaps that has something to do with <code>csrss</code> since it&#8217;s a high-integrity process, perhaps that has something to do with <code>uiAccess</code>? No idea at this moment.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kai-schatzl even thread-odd thread-alt depth-1" id="comment-1295505">
				<div id="div-comment-1295505" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Kai+Sch%C3%A4tzl' rel='external nofollow' class='url'>Kai SchÃ¤tzl</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20170504-00/?p=96106#comment-1295505">
			May 8, 2017 at 3:03 pm</a>		</div>

		<p>Of course, you&#8217;re all wrong ;-) Here&#8217;s the &#8220;real&#8221; AppBar: <a href="http://www.cs.cornell.edu/mperham/appbar/" rel="nofollow">http://www.cs.cornell.edu/mperham/appbar/</a><br />
I&#8217;ve been using this great tool since 95.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

