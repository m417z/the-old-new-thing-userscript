<html>
<head>
<title>You'd think that with the name TEMP, people wouldn't expect it to be around for a long time</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>You&#8217;d think that with the name TEMP, people wouldn&#8217;t expect it to be around for a long time</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 16, 2015 / year-entry #265</td></tr>
<tr><td><b>Tags:</b></td><td>code</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>56</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Temp stands for Temporary.</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
A customer had a problem with the
Disk Cleanup wizard.
The customer liaison explained:
</p>
<blockquote CLASS="q"><p>
The customer would like to know what locations the Disk Cleanup
wizard
removes files from.
The custom is running Application Q.
They had a previous incident where they incurred significant downtime
because the Disk Cleanup wizard deleted files from
<code>C:\Windows\Installer</code>
and
<code>C:\Temp</code>
that caused their application to stop working.
When will the Disk Cleanup Wizard
<a HREF="http://support.microsoft.com/kb/2852386">
remove a Windows update</a>?
</p>
</blockquote>
<p>
Okay, we can talk about how the cleanup of outdated
Windows updates works, but <i>holy crap</i> did you say that
Application Q stores critical information in the <code>C:\Temp</code>
directory?
</p>
<p>
You cannot assume that any files in the
Temp directory will exist for any significant length of time.
The name Temp stands for Temporary.
Temporary means <i>not permanent</i>.
If your application puts critical files in the Temp directory,
then it is just asking for trouble.
</p>
<p>
If you need a permanent place to store your critical information,
try a subdirectory of the
<a HREF="http://blogs.msdn.com/b/cjacks/archive/2008/02/05/where-should-i-write-program-data-instead-of-program-files.aspx">
Local Application Data</a>
directory.
</p>
<p>
Okay, going back to the questions about Windows updates:
The Disk Cleanup Wizard removes up a Windows update if it
has been superseded by another update.
For example, there may be a roll-up update that includes the
original update.
</p>
<p>
But I doubt that's what made Application Q stop working.
I bet it's assuming that files in a temporary directory
have permanent storage duration.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (56)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1219241">
				<div id="div-comment-1219241" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Leonardo Herrera</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219241">
			December 16, 2015 at 7:10 am</a>		</div>

		<p>What is &#8220;significant&#8221;? Is there a rule?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1219251">
				<div id="div-comment-1219251" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219251">
			December 16, 2015 at 7:10 am</a>		</div>

		<p>While I don&#8217;t remember the name of it now, I had a very similar experience many years ago. An application I regularly used stored essential files in %TEMP%. Both data and application files were stored there. Like the customer in your story I learned of this after manually deleting the contents of %TEMP%. Be assured I found a replacement for that application immediately, one that didn&#8217;t do something so boneheaded.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-entegygmail-com even thread-even depth-1 parent" id="comment-1219261">
				<div id="div-comment-1219261" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219261">
			December 16, 2015 at 7:14 am</a>		</div>

		<p>I think the worst manifestation of this is leaving behind some MSI in Temp, said MSI gets cleaned, and then that app can&#8217;t update or uninstall because the MSI is now missing.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1219311">
				<div id="div-comment-1219311" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/sentinel.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219311">
			December 16, 2015 at 7:35 am</a>		</div>

		<p>Please get a clue, resp. inform yourself of the modified behaviour of the Windows Installer (in part due to some changes introduced with MS14-049; see <a href="https://technet.microsoft.com/en-us/library/ms14-049.aspx#ID0ESAAG" rel="nofollow">https://technet.microsoft.com/en-us/library/ms14-049.aspx#ID0ESAAG</a>): the full .MSI are cached in %SystemRoot%\Installer</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-3 parent" id="comment-1219461">
				<div id="div-comment-1219461" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219461">
			December 16, 2015 at 12:28 pm</a>		</div>

		<p>Unfortunately, Entegy is actually right. Apparently, InstallShield (or its vendor thereof) hasn&#8217;t got the memo yet, not to mention how strange their treatment of MSI is. The MSI is cached alright but the dumbass installer still looks at the temp position even though it doesn&#8217;t need it.</p>
<p>Also, don&#8217;t restrict yourself to MSI. Back in Windows 98, I had problem installing Internet Explorer because its temp files got deleted after the installation was completed but before I get to restart. I delayed the restart because I needed to finish saving something which was taking long. But how did the temp files go? I don&#8217;t remember.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4 parent" id="comment-1219502">
				<div id="div-comment-1219502" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219502">
			December 16, 2015 at 3:41 pm</a>		</div>

		<p>1. InstallShield as well as other CRAPWARE, which wraps .MSI in self-extractors (see &#8220;Executable installers are vulnerable^WEVIL (case xyz): &#8230;&#8221; on FD or BugTraq) and unpacks them to %TEMP% is the primary part of the problem: the workings of the Microsoft Installer, it&#8217;s cache etc. were known BEFORE they started to build their CRAPWARE.<br />
2. the .MSI copied to %SystemRoot%\Installer before some &#8220;defense in depth&#8221; changes had been stripped from their &#8220;MEDIA&#8221;, ie. the embedded .CAB(s) which include(s) the files to install: the Windows Installer reads the (meta)data of the .MSI ONLY from its cache, never from any of the historical locations of the .MSI recorded in the registry.<br />
This stripping but invalidated the authenticode signatures, and forces Windows Installer to prompt for the location of the ORIGINAL .MSI &#8230; which was long gone if some braindead self-extractor wrote it to %TEMP%.</p>
<p>JFTR: Wintendo is DEAD! It had no automatic purging of %TEMP%. Many users but purged it a (re)boot from AUTOEXEC.BAT &#8230; and forgot to check whether there were pending renames present in WIN.INI.<br />
Windows NT executes pending renames during reboot, before someone can purge %TEMP%.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-entegygmail-com even depth-5" id="comment-1219871">
				<div id="div-comment-1219871" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Entegy' rel='external nofollow' class='url'>Entegy</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219871">
			December 18, 2015 at 8:33 am</a>		</div>

		<p>What are you on?</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1 parent" id="comment-1219273">
				<div id="div-comment-1219273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219273">
			December 16, 2015 at 7:18 am</a>		</div>

		<p>I have gotten yelled at by other people because, while doing them a favor and cleaning up junk on their computers, I have emptied the recycle bin or the &#8220;deleted items&#8221; folder in Outlook.  One colleague used to keep valuable e-mail messages in the Deleted Items folder.  Holy cr@p.   I suggested that this is not a good idea.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1219302">
				<div id="div-comment-1219302" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219302">
			December 16, 2015 at 7:32 am</a>		</div>

		<p>That would not be the same, though. In the case of TEMP, you could reasonably make the argument that they couldn&#8217;t have known when the files would be deleted anyway, so it wouldn&#8217;t matter if it was you who did it, but in the two cases you mention, there are set expectations about the length of time between temporary and permanent deletion.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-dwalker-wk odd alt depth-3 parent" id="comment-1219671">
				<div id="div-comment-1219671" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219671">
			December 17, 2015 at 7:36 am</a>		</div>

		<p>For the e-mails, my colleague kept important e-mails in the Deleted Items folder for a long time.  He COULD have created another folder, but no, he liked to use Delete Items for some reason.  Weird.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4" id="comment-1219831">
				<div id="div-comment-1219831" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.farnz.org.uk/' rel='external nofollow' class='url'>Simon Farnsworth</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219831">
			December 18, 2015 at 2:14 am</a>		</div>

		<p>TBF, there&#8217;s a handy default shortcut for &#8220;move this item to Deleted Items&#8221; in Outlook. If you don&#8217;t know that it&#8217;s possible to set up your own shortcuts, then I can see how it&#8217;d make sense to use Deleted Items as a storage spot. as it&#8217;s just Ctrl-D to move items to &#8220;safety&#8221;.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-even depth-1 parent" id="comment-1219281">
				<div id="div-comment-1219281" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219281">
			December 16, 2015 at 7:23 am</a>		</div>

		<p>The Microsoft Installer being a world&#8217;s worst and slowest Unzip, if you clear C:\Windows\Installer, you will not be able to uninstall (and maybe even repair) applications. What a fragile pile of dung.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-1219321">
				<div id="div-comment-1219321" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219321">
			December 16, 2015 at 7:37 am</a>		</div>

		<p>What a COMPLETELY clueless $&amp;%§!<br />
%SystemRoot%\Installer is the repository of the Windows Installer. A user^Wadministrator stupid enough to mess with the contents of thir directory gets what s/he deserves!</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bboorman odd alt depth-3 parent" id="comment-1219341">
				<div id="div-comment-1219341" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219341">
			December 16, 2015 at 8:05 am</a>		</div>

		<p>Stefan,</p>
<p>I am sure you could make your point without the use of ad hominem attacks, which are expressly against the ground rules for commenting on this blog. <a href="https://blogs.msdn.microsoft.com/oldnewthing/20040221-00/?p=40523/" rel="nofollow">https://blogs.msdn.microsoft.com/oldnewthing/20040221-00/?p=40523/</a></p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-4 parent" id="comment-1219541">
				<div id="div-comment-1219541" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/!execute.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219541">
			December 16, 2015 at 6:13 pm</a>		</div>

		<p>I&#8217;m sure that your interpretation just shows your state of mind!</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 odd alt depth-5" id="comment-1219632">
				<div id="div-comment-1219632" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219632">
			December 17, 2015 at 6:16 am</a>		</div>

		<p>Stefan:<br />
&#8220;I’m sure that your interpretation just shows your state of mind!&#8221;</p>
<p>You mean sane of course. </p>
<p>@Brian_EE is not alone in finding your comments unprofessional.  You seem to have a familiarity and expertise in this area and I&#8217;m sure at least some of us could benefit from your insights.  I doubt, however, that any of us have the time or the desire to wade through the rants to extract them.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even depth-3 parent" id="comment-1219343">
				<div id="div-comment-1219343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219343">
			December 16, 2015 at 8:22 am</a>		</div>

		<p>Cleaning c:\Windows\Update is a troubleshooting step recommended by Microsoft when Windows Update gets hosed. Unfortunately, it also hoses the Windows Installer.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1219372">
				<div id="div-comment-1219372" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219372">
			December 16, 2015 at 9:14 am</a>		</div>

		<p>There is no c:\Windows\Update, and if you mean %WinDir%\SoftwareDistribution, that has never had any effect on the installer in my experience. It&#8217;s valuable for fixing WU (and freeing up space) and benign otherwise, a rare and useful combination.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-4" id="comment-1219421">
				<div id="div-comment-1219421" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219421">
			December 16, 2015 at 10:35 am</a>		</div>

		<p>@alegr1: the Windows update directory is C:\Windows\SoftwareDistribution (more specifically \DataStore and \Downloads), not C:\Windows\Installer. I very much doubt that any official Microsoft material recommends deleting C:\Windows\Installer, since this indeed destroys your ability to uninstall or update just about anything. This is something you only do if you&#8217;re absolutely desperate for space, you&#8217;ve already uninstalled everything you can uninstall and you basically don&#8217;t care about not being able to ever change or update your software anymore. Upgrading your hard drive, as big of a hassle as that can be, is probably still less costly.</p>
<p>Deleting what&#8217;s in \SoftwareDistribution can indeed get a hosed Windows Update working again. This will remove your ability to remove already installed *updates*, but that&#8217;s far less serious since they rarely need to be uninstalled in the first place (and if you do need that, you&#8217;ve hopefully done it before throwing away \SoftwareDistribution).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-4" id="comment-1219511">
				<div id="div-comment-1219511" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219511">
			December 16, 2015 at 3:43 pm</a>		</div>

		<p>OUCH!<br />
C:\Windows\Update  C:\Windows\Installer<br />
BTW: it&#8217;s %SystemRoot%\SoftwareDistribution</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1219373">
				<div id="div-comment-1219373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219373">
			December 16, 2015 at 9:16 am</a>		</div>

		<p>If you delete the uninstaller you can&#8217;t uninstall things anymore? Who&#8217;d have thought it&#8230;.</p>
<p>And there&#8217;s a reason robmen&#8217;s blog name is &#8220;When setup isn&#8217;t just xcopy.&#8221;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-cheong odd alt depth-2 parent" id="comment-1219592">
				<div id="div-comment-1219592" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219592">
			December 17, 2015 at 1:38 am</a>		</div>

		<p>Note that if you delete the database owned by the package manager of system&#8217;s choice from *nix system, it won&#8217;t be able to uninstall too.</p>
<p>Are they also &#8220;a fragile pile of dung&#8221;?</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1219642">
				<div id="div-comment-1219642" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ernie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219642">
			December 17, 2015 at 6:52 am</a>		</div>

		<p>If I was into &#8216;semi-vulgar hyperbolic statements&#8217; I could argue that one was a pile of dung collected from a number of monkeys hitting keys on a keyboard, while the other was a pile of dung resulting from cats resting on keyboards. Of the three (or maybe 4 yum!=apt) primary installers on desktop/server OS&#8217;s, NONE is a clear winner and each has issues when used in ways that are &#8216;against the grain&#8217; of the intent.</p>
<p>Speaking of TEMP, on some systems with large amounts of memory, I&#8217;ve seen temp exist fully in DRAM and at temperatures well over 0K. That makes it &#8216;extra volatile&#8217;.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1219291">
				<div id="div-comment-1219291" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MC</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219291">
			December 16, 2015 at 7:28 am</a>		</div>

		<p>It&#8217;s a shame that %TEMP% isn&#8217;t purged more often.   The PC I&#8217;m using here has files from January in TEMP.  6.3Gb in total </p>
<p>Linux / Unix empties /tmp on each reboot,  but that can be months or more on our production servers too.</p>
<p>We had a database product that was creating unix domain sockets in /tmp   then someone deleted them  (being helpful and clearing out temporary files )  and brought down the database.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1219292">
				<div id="div-comment-1219292" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/sentinel.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219292">
			December 16, 2015 at 7:30 am</a>		</div>

		<p>1. C:\Temp is neither any user&#8217;s %TEMP% nor the system&#8217;s %TEMP%; only CRAPWARE which ignores the 20+ years old &#8220;Designed for Windows&#8221; guidelines still creates C:\Temp!<br />
2. The disk cleanup wizard works on %TEMP% only: see<br />
[HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Temporary Files]<br />
&#8220;Folder&#8221;=expand:&#8221;%TEMP%&#8221;<br />
For the documentation of the registry entries of the &#8220;data driven cleaner&#8221; see <a href="https://msdn.microsoft.com/en-us/bb776782.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/bb776782.aspx</a><br />
3. The disk cleanup wizard also does NOT touch %SystemRoot%\Installer: only the Windows Installer fiddles with this directory.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1219361">
				<div id="div-comment-1219361" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodríguez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219361">
			December 16, 2015 at 8:24 am</a>		</div>

		<p>From reading the article, it&#8217;s evident that the user&#8217;s system is set up so that %TEMP% points to C:\Temp instead of C:\Windows\Temp . It&#8217;s not uncommon, and if the user (or the system&#8217;s owner) does it, it doesn&#8217;t violate any guidelines. I, myself, like to place the Temp folder in a different physical drive than the system partition is in. And, just being at it, I place the swap file there, too. I use to create a small (~8GB) FAT32 partition for that use (FAT32 is slightly faster in writing than NTFS). It makes the system more robust by reducing the chances that the system partition gets full, and also makes it faster when you need to swap out memory while opening a new process.</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1219521">
				<div id="div-comment-1219521" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219521">
			December 16, 2015 at 3:54 pm</a>		</div>

		<p>Is this REALLY evident?<br />
Guess why %USERPROFILE% is NOT accessible for other (unprivileged) users?!<br />
Guess why a shared %TEMP% is a REALLY bad idea in the first place?!<br />
I love to exploit vulnerable contructs like these, they almost always allow an escalation of privilege.-P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-3" id="comment-1219532">
				<div id="div-comment-1219532" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219532">
			December 16, 2015 at 4:01 pm</a>		</div>

		<p>Placing %TEMP% apart from %SystemRoot% broke Windows Updates on Windows NT4 and Wintendo, where these placed the files they could not write to their final destination due to locks etc. in %TEMP%.<br />
See MoveFileEx()<br />
This was first corrected with a Service Pack in Windows 2000.</p>
<p>&#8220;swap partitions&#8221; with FAT are &#8220;cargo cult&#8221;.-P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-3" id="comment-1219583">
				<div id="div-comment-1219583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andreas</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219583">
			December 17, 2015 at 1:29 am</a>		</div>

		<p>Ever heard of SSD? Putting your pagefile on a FAT FS seems like an extremely insecure method of highly questionable merit. How many seconds per year do you think you have saved by making your system extremely insecure? There are all sorts of goodies in your pagefile: passwords, admin processes and other nice things. Since FAT doesn&#8217;t do ACLs it would be trivial to not only read your pagefile as a non-admin user but also modify admin processes in the pagefile to do a hacker&#8217;s bidding.</p>
<p>In 2015 (soon 2016) the power of FAT is not its speed, it&#8217;s the ease of implementation because it has no security measures and no real fail-safe measures. That&#8217;s why it&#8217;s ubiquitous. But that&#8217;s also why you only use FAT for temporal insecure data, e.g. photos from digital cameras and such. Not for (what ought to be one of) the most secure files on your system.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1219362">
				<div id="div-comment-1219362" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219362">
			December 16, 2015 at 9:12 am</a>		</div>

		<p>&#8220;1. C:\Temp is neither any user’s %TEMP% nor the system’s %TEMP%; &#8221;<br />
And as we all know it&#8217;s totally impossible to change an environment variable to point anywhere else! </p>
<p>But more serious, could you try a less confrontational and aggressive tone? It only comes across as unprofessional and childish and devalues any contributions you&#8217;re trying to make.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1219391">
				<div id="div-comment-1219391" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Josh B</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219391">
			December 16, 2015 at 9:20 am</a>		</div>

		<p>C:\Temp is a nice short name for scratch space for command-lines, plus it&#8217;s not already full of %TEMP% junk. Nothing wrong with it for personal use, but I haven&#8217;t seen an application use it in at least a decade.</p>
<p>Can&#8217;t help someone who mangles their environment though.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-fjeldse odd alt thread-odd thread-alt depth-1" id="comment-1219324">
				<div id="div-comment-1219324" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Erik+F' rel='external nofollow' class='url'>Erik F</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219324">
			December 16, 2015 at 7:54 am</a>		</div>

		<p>It&#8217;s a good thing Application Q doesn&#8217;t run in Linux then, because they&#8217;d be in for a bad time writing files to /tmp which is usually a tmpfs partition nowadays (and thus basically a RAM disk!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1219331">
				<div id="div-comment-1219331" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jimmy Queue</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219331">
			December 16, 2015 at 7:58 am</a>		</div>

		<p>Can you confirm, that the maximum amount of time I can expect i file to stay in a temp dir, is for as long as I have a lock from application on the file?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1219351">
				<div id="div-comment-1219351" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219351">
			December 16, 2015 at 8:23 am</a>		</div>

		<p>I see MS finally got around to putting in something in Windows 7 and Windows Server 2008 R2 to deal with superseded updates about two years after I opened a support case due to repeated windows updates on Windows Server 2008 (not R2) causing the OS to exceed minimum disk space. Too bad it never got backported far enough.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-2 parent" id="comment-1219471">
				<div id="div-comment-1219471" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219471">
			December 16, 2015 at 12:45 pm</a>		</div>

		<p>Windows\Installer does not hold Windows updates.</p>
<p>They are placed in Windows\SoftwareDistribution and Windows\WinSxS. There are also some non-standard folders like Windows\CheckSur and Windows\GWX but I am sure you know why.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1219544">
				<div id="div-comment-1219544" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/!execute.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219544">
			December 16, 2015 at 6:24 pm</a>		</div>

		<p>%SystemRoot%\SoftwareDistribution is also volatile; WUAgent uses %SystemRoot%\SoftwareDistribution\Downloads\Install as private temporary storage to unpack downloaded .CAB and runs their payload from there, it is removed after every installation step.<br />
%SystemRoot%\WinSxS\[Install]Temp is used as private temporary storage for WinSxS.<br />
There a numerous other private temporary storages: DriverStore has one, Microsoft.NET another, &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1219381">
				<div id="div-comment-1219381" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219381">
			December 16, 2015 at 9:18 am</a>		</div>

		<p>Sadly today &#8211; just one day after finding it &#8211; Bob can no longer get to \\scratch\temp\bob\xyz.exe</p>
<p>Does anybody have a copy?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-aadsso-1live-com00037ffe8545d1b7 odd alt depth-2" id="comment-1219401">
				<div id="div-comment-1219401" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/David+Totzke' rel='external nofollow' class='url'>David Totzke</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219401">
			December 16, 2015 at 9:41 am</a>		</div>

		<p>mikeb you win ALL THE THINGS :)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev even thread-odd thread-alt depth-1 parent" id="comment-1219411">
				<div id="div-comment-1219411" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219411">
			December 16, 2015 at 10:00 am</a>		</div>

		<p>Worse yet, there are enterprise products that place a DLL they need to run to %TEMP%</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-2 parent" id="comment-1219602">
				<div id="div-comment-1219602" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219602">
			December 17, 2015 at 1:46 am</a>		</div>

		<p>Yup. Notable certain software that is similar to Outlook in a lot of way but runs Java instead of VBA.</p>
<p>And worst, it won&#8217;t restore the DLLs in that location if you cleared the folder.</p>
<p>I had to use their Web version just because I had cleaned up the Local\Temp folder many years ago.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-alegrigoriev even depth-3" id="comment-1219741">
				<div id="div-comment-1219741" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219741">
			December 17, 2015 at 1:08 pm</a>		</div>

		<p>Funnily enough, the DLL in question (some GCC-related library?) was watched by that (enterprise backup and recovery) package. If you rename it, it got quickly recreated. It was kept loaded, so you could not simply delete it. But you could set its ACL to prevent its loading, though.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt depth-2 parent" id="comment-1219731">
				<div id="div-comment-1219731" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/malware.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219731">
			December 17, 2015 at 11:05 am</a>		</div>

		<p>According to your definition &#8220;Windows Embedded POSReady 2009&#8221; must be an enterprise product.-(<br />
<a href="http://seclists.org/fulldisclosure/2012/Mar/17" rel="nofollow">http://seclists.org/fulldisclosure/2012/Mar/17</a><br />
I really love this sort of backdoors!</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3 parent" id="comment-1219811">
				<div id="div-comment-1219811" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219811">
			December 17, 2015 at 11:21 pm</a>		</div>

		<p>Putting dlls into %tmp% isn&#8217;t a backdoor &#8211; stupid yes (Although if they&#8217;re really temporary because say dynamically generated not even that), but perfectly harmless as long as you keep the default ACLs. Only the user herself and administrators should have access to a user&#8217;s temporary folder.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-4" id="comment-1219941">
				<div id="div-comment-1219941" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://home.arcor.de/skanthak/SAFER.html' rel='external nofollow' class='url'>Stefan Kanthak</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219941">
			December 18, 2015 at 1:27 pm</a>		</div>

		<p>As usual: kids who can&#8217;t even write their full name just babble.<br />
User access to files created and executed by an administrator is not harmless!<br />
Run an executable installer (say ROOTSUPD-KB931125.exe) that unpacks its payload to %TEMP%\ixp000.tmp\: the unprivileged user is able to modify the unpacked files between their creation and their use.<br />
See  for a recent example.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1219431">
				<div id="div-comment-1219431" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Evan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219431">
			December 16, 2015 at 10:52 am</a>		</div>

		<p>Clearly Application Q is a weather monitoring program, and the authors thought that c:\temp was where it should store temperature readings. Of course it stopped working!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1219441">
				<div id="div-comment-1219441" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Narr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219441">
			December 16, 2015 at 12:00 pm</a>		</div>

		<p>I can understand having &#8216;critical&#8217; files in temp, temporarily while the program&#8217;s running, and then some scheduled task or OCD admin running disk cleanup, and the app goes to use the files and runs into an error that the developer wouldn&#8217;t expect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1219481">
				<div id="div-comment-1219481" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://harryjohnston.wordpress.com' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219481">
			December 16, 2015 at 2:32 pm</a>		</div>

		<p>Um.  There&#8217;s a group policy setting that causes Local Application Data to be deleted when the user logs out.  This is used, for example, in a computer lab environment (such as you might find at a University, for example) where lots of people are sharing the same machine(s) and keeping all of the profiles isn&#8217;t realistic.</p>
<p>So, depending on context, Local Application Data may not be the best choice either.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2 parent" id="comment-1219622">
				<div id="div-comment-1219622" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">voo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219622">
			December 17, 2015 at 5:21 am</a>		</div>

		<p>The whole point of cleaning up the local application folder of a user is for the application to treat the user the next time just as if she was new on that machine. Data you really need should go into the roaming folder with all that entails.</p>
<p>If the data you&#8217;re trying to store is required for the application to work at all it shouldn&#8217;t be stored in the app folder of a user but with the application itself (e.g. Things like dlls)</p>

		
				</div>
		<ol class="children">
		<li class="comment even depth-3" id="comment-1219781">
				<div id="div-comment-1219781" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://harryjohnston.wordpress.com' rel='external nofollow' class='url'>Harry Johnston</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219781">
			December 17, 2015 at 5:59 pm</a>		</div>

		<p>Or in the ProgramData folder, if it needs to be writable.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1219491">
				<div id="div-comment-1219491" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lol</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219491">
			December 16, 2015 at 3:03 pm</a>		</div>

		<p>Good advice that makes the mistake of assuming enterprise security settings let users write files anywhere else.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rask even thread-even depth-1" id="comment-1219501">
				<div id="div-comment-1219501" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Rask' rel='external nofollow' class='url'>Rask</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219501">
			December 16, 2015 at 3:33 pm</a>		</div>

		<p>I recall an incident back in the DOS days when I needed to free up some space on a friend&#8217;s computer.  I did this by deleting the contents of the C:\Temp folder, and he nearly blew a gasket as he was using that folder for storage.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1219561">
				<div id="div-comment-1219561" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">jeffdav</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219561">
			December 16, 2015 at 8:12 pm</a>		</div>

		<p>c:\windows\installer seems like a bad place to store your files as well.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-1219571">
				<div id="div-comment-1219571" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Robert Tassarone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219571">
			December 16, 2015 at 8:22 pm</a>		</div>

		<p>Three issues with your post:</p>
<p>1. You&#8217;re conflating file criticality and file permanence. Critical does not imply permanent. </p>
<p>2. With respect to data an app might store in a temp folder, it is entirely possible that the data is for example some state information that if deleted by surprise out from underneath the application then there could be data corruption etc. </p>
<p>3. C:\temp is not an operating system folder unless it&#8217;s %temp% which I suspect in this users case it was not. I doubt the user expected the dial cleanup wizard to touch non-OS folders.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-1220083">
				<div id="div-comment-1220083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">EMB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1220083">
			December 22, 2015 at 4:24 am</a>		</div>

		<p>1) Nitpicker is nitpicking&#8230; Also, You are assuming that you have more info on this problem than Raymond have.<br />
2) You are assuming that info that is not delivered in the post was not omitted for simplicity<br />
3) You are assuming that info that is not delivered in the post was not omitted for simplicity and that you have more info on this problem than Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1219612">
				<div id="div-comment-1219612" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219612">
			December 17, 2015 at 1:58 am</a>		</div>

		<p>I think the use case for people moving things to the Recycle Bin/Trash, temporary directory, or Outlook Deleted Items and then expecting them to be there when they look again later is quite common: It is for files/emails that they might want again but probably won&#8217;t, but they most certainly don&#8217;t want to have to clean them up themselves. They take the risk that in the case that they do want them again, the computer won&#8217;t yet have deleted them, but blame it on the computer if they are deleted.</p>
<p>Anyone who can invent an algorithm that can determine which files the user is happy to have deleted permanently without needing to consult the user would be onto a winner.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1219891">
				<div id="div-comment-1219891" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.honestillusion.com' rel='external nofollow' class='url'>James Curran</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20151216-00/?p=92661#comment-1219891">
			December 18, 2015 at 10:29 am</a>		</div>

		<p>I&#8217;ve always said one shouldn&#8217;t have a TEMP folder (particularly on a shared file system), but instead a TEMP72HR and a TEMP2MON folders.  Everything in the Temp72hrs folder that&#8217;s more than 72 hours old can be freely deleted by anyone in need of disk space.  Similarly with the TEMP2MON after 2 months.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

