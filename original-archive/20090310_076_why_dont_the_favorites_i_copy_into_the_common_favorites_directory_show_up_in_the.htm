<html>
<head>
<title>Why don't the favorites I copy into the common Favorites directory show up in the Favorites menu of all users?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why don&#8217;t the favorites I copy into the common Favorites directory show up in the Favorites menu of all users?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 10, 2009 / year-entry #77</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>18</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">The Favorites menu in Internet Explorer shows the user's favorites. And stuff in the %ALLUSERSPROFILE% is visible to all users. Therefore, Internet shortcuts placed into the %ALLUSERSPROFILE%\Favorites directory should show up on the Favorites menu of all users, right? So why doesn't it work? Because features don't exist by default. It's true that there are...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>The Favorites menu in Internet Explorer shows the user's favorites. And stuff in the <code>%ALLUSERSPROFILE%</code> is visible to all users. Therefore, Internet shortcuts placed into the <code>%ALLUSERSPROFILE%\Favorites</code> directory should show up on the Favorites menu of all users, right? So why doesn't it work?</p>
<p> Because <a href="http://web.archive.org/web/20070609020513/blog.ryjones.org/2005/07/12/Product+Development.aspx"> features don't exist by default</a>. </p>
<p> It's true that there are a few highly-visible cases where the items shown to the user are a combination of files from the <code>%USERPROFILE%</code> and the <code>%ALLUSERSPROFILE%</code>, the most commonly encountered ones being the desktop and the Start menu. But that doesn't happy as a result of magic. Somebody had to sit down and hook them up. </p>
<p> Even the highly visible cases show that the behavior is implemented on a case-by-case basis. For example, the <i>Music</i> folder does not show the items in the all-users version of the <i>Music</i> directory; there is just a shortcut that takes you there. Similarly, items in the all-users <i>Documents</i> folder do not show up in every user's <i>Documents</i> folder; instead there is a separate <i>Shared Documents</i> folder. </p>
<p> Each of those cases had to be hooked up separately, and most of them are not hooked up at all. </p>
<p> Now, the common Favorites folder may be a tempting target, seeing as the shell team even defined a <code>CSIDL</code> value for it, but it's just another example of something <a href="http://blogs.msdn.com/oldnewthing/archive/2007/10/25/5658731.aspx"> that never got hooked up but whose vestiges didn't get completely cleaned up either</a>. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (18)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-714813">
				<div id="div-comment-714813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Some dude</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-714813">
			March 10, 2009 at 10:13 am</a>		</div>

		<blockquote><p>
  &gt;But that doesn&#8217;t happy as a result of magic.
</p></blockquote>
<p>Why does it happy then? &nbsp;;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-714823">
				<div id="div-comment-714823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-714823">
			March 10, 2009 at 10:31 am</a>		</div>

		<p>The lesson being &quot;this is why you design robust solutions that don&#8217;t have to reimplemented for each use&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-714883">
				<div id="div-comment-714883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-714883">
			March 10, 2009 at 11:24 am</a>		</div>

		<p>That&#8217;s strange, I could have sworn that this used to work; maybe back in IE 5.0 or 5.5. &nbsp;Or am I just crazy? &nbsp;Now I will have to test out old versions of IE when I get home to satisfy my curiosity. &nbsp;Damn you, Raymond.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-714923">
				<div id="div-comment-714923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-714923">
			March 10, 2009 at 12:31 pm</a>		</div>

		<p>&#8220;somebody had to hook them up&#8221; one by one? &nbsp;Not by making everything that exists in %ALLUSERSPROFILE% visible to all users? &nbsp;I don&#8217;t understand. &nbsp;</p>
<div class=post>[<i>Good luck changing FindFirstFile so it shows files from two directories. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-714973">
				<div id="div-comment-714973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Karellen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-714973">
			March 10, 2009 at 2:25 pm</a>		</div>

		<p>&quot;Good luck changing FindFirstFile so it shows files from two directories.&quot;</p>
<p>I thought Windows could already do that. I&#8217;m /sure/ there was a DOS command, similar to &quot;subst&quot; or &quot;join&quot;, that did what UnionFS[0] does for Linux &#8211; overlay the contents of two directories as one. As with other DOS commands, these would produce visible changes to any Windows app.</p>
<p>Looking through some web pages on DOS though, I can&#8217;t find it. Is it just my imagination that such a capability existed?</p>
<p>[0] <a rel="nofollow" target="_new" href="http://en.wikipedia.org/wiki/UnionFS" rel="nofollow">http://en.wikipedia.org/wiki/UnionFS</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-714983">
				<div id="div-comment-714983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.strawjackal.org' rel='external nofollow' class='url'>Avner Kashtan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-714983">
			March 10, 2009 at 2:32 pm</a>		</div>

		<p>Of course nobody expects it to happen automagically. That&#8217;s a bit of a straw man argument. What people do expect is that if you set a pattern of usage, that pattern will be followed in other, similar scenarios. That&#8217;s why they&#8217;re disappointed when it isn&#8217;t.</p>
<p>I&#8217;m not saying &quot;never add any feature until it&#8217;s totally perfect across the board&quot;, but do realize that you&#8217;re creating an inconsistent user interface here, and adding to the general confusion of users.</p>
<p>If you&#8217;d ask me to make a split-second decision between adding the feature as is or cutting it, I&#8217;d say &quot;add&quot;. But the question is totally legit.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-715033">
				<div id="div-comment-715033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715033">
			March 10, 2009 at 3:56 pm</a>		</div>

		<p>DWalker59:</p>
<p>I think what Raymond meant here is that the &quot;hooking up&quot; is not some filesystem-level feature (Like the later-mentioned &quot;UnionFS&quot;). The start menu &quot;hook up&quot; is implemented at the start menu implementation itself, and the desktop at the shell namespace level. If someone wanted to implemented a &quot;common favorites&quot; feature, he&#8217;d have to write code to do the hook up in the favorites menu code (like the start menu), or at the lowest in the shell namespace provider of Favorites.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-715043">
				<div id="div-comment-715043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715043">
			March 10, 2009 at 4:20 pm</a>		</div>

		<p>&quot;But the question is totally legit.&quot;</p>
<p>Raymond&#8217;s not saying the question isn&#8217;t legit. &nbsp;He&#8217;s saying that it doesn&#8217;t work because nobody implemented it to do that. &nbsp;As far as I can tell, he didn&#8217;t once try to justify that decision. &nbsp;To summarize, the answer to &quot;Why doesn&#8217;t this work?&quot; is &quot;Only because it&#8217;s not implemented, and no other reason.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-715083">
				<div id="div-comment-715083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">laonianren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715083">
			March 10, 2009 at 5:07 pm</a>		</div>

		<p>@Karellen: you&#8217;re probably thinking of &quot;append&quot;. &nbsp;It still exists in XP but I think it only works for 16-bit applications.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-715103">
				<div id="div-comment-715103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.zi255.com' rel='external nofollow' class='url'>Slackmaster K</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715103">
			March 10, 2009 at 7:27 pm</a>		</div>

		<p>Follow-up: Why can&#8217;t I permanently disable Favorites folders (Links, Microsoft Websites, etc)?</p>
<div class=post>[<i>I am so psychic that <a href="http://blogs.msdn.com/oldnewthing/archive/2004/06/30/169757.aspx" rel="nofollow">I answered your follow-up over three years before you asked it</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt even thread-even depth-1" id="comment-715123">
				<div id="div-comment-715123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715123">
			March 10, 2009 at 8:04 pm</a>		</div>

		<p>I don&#8217;t know what&#8217;s more impressive. &nbsp;The fact that Raymond knew the answer or the fact that he REMEMBERED ANSWERING IT IN A BLOG POST THREE YEARS AGO!!</p>
<p>I can barely remember posts I made 3 months ago.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-715163">
				<div id="div-comment-715163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dumbo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715163">
			March 10, 2009 at 9:14 pm</a>		</div>

		<p>[I am so psychic that I answered your follow-up over three years before you asked it. -Raymond]</p>
<p>I don&#8217;t think so. The old post was just a coincidence.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-715213">
				<div id="div-comment-715213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">The Imp</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715213">
			March 10, 2009 at 11:13 pm</a>		</div>

		<p>Of course, if you&#8217;re wanting it to be set up for a new system, and not wanting to change the entry for accounts that have already been created, you can the the Default User profile &#8212; it will be copied to a new user at account creation time.</p>
<p>Not quite the same thing, but maybe good enough, depending on exactly what someone was trying to do.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-715223">
				<div id="div-comment-715223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715223">
			March 11, 2009 at 12:17 am</a>		</div>

		<p>&quot;The fact that Raymond knew the answer or the fact that he REMEMBERED ANSWERING IT IN A BLOG POST THREE YEARS AGO!!&quot;</p>
<p>Perhaps Raymond has learnt how to use a search engine? A search of &quot;site:blogs.msdn.com/oldnewthing why can&#8217;t I delete favorites folders&quot; turns up that post as the first result.</p>
<p>Of course, that could be because of THIS post linking to it; that&#8217;s the trouble with this blog, google re-indexes it so fast, you can&#8217;t tell :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-715233">
				<div id="div-comment-715233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://nytimes.com' rel='external nofollow' class='url'>mpbk</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715233">
			March 11, 2009 at 2:33 am</a>		</div>

		<p>&quot;the Music folder does not show the items in the all-users version of the Music directory; there is just a shortcut that takes you there. Similarly, items in the all-users Documents folder do not show up in every user&#8217;s Documents folder; instead there is a separate Shared Documents folder.&quot;</p>
<p>This problem has possibly been solved by the new Libraries feature in Windows 7.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dwalker-wk odd alt thread-odd thread-alt depth-1" id="comment-715473">
				<div id="div-comment-715473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/DWalker' rel='external nofollow' class='url'>DWalker</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715473">
			March 11, 2009 at 2:37 pm</a>		</div>

		<p>Thanks for the clarification, Raymond. &nbsp;Now I understand.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-715513">
				<div id="div-comment-715513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KenW</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-715513">
			March 11, 2009 at 4:30 pm</a>		</div>

		<p>@Dumbo: &quot;I don&#8217;t think so. The old post was just a coincidence.&quot;</p>
<p>Not so. Raymond has proven his psychic abilities here many times with posts on psychic debugging. Search the archives. :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-717023">
				<div id="div-comment-717023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20090310-00/?p=18883#comment-717023">
			March 14, 2009 at 4:44 am</a>		</div>

		<blockquote><p>
  Follow-up: Why can&#8217;t I permanently disable Favorites folders (Links, Microsoft Websites, etc)?</p>
<p>  [I am so psychic that I answered your follow-up over three years before you asked it. -Raymond]
</p></blockquote>
<p>No, you only discussed the topic. Not explaining why links cannot be disabled.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

