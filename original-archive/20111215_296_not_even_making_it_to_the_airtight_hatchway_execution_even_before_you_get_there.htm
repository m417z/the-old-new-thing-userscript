<html>
<head>
<title>Not even making it to the airtight hatchway: Execution even before you get there</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Not even making it to the airtight hatchway: Execution even before you get there</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 15, 2011 / year-entry #297</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>38</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Today's dubious security vulnerability comes from somebody who reported that the Load­Keyboard­Layout function had a security vulnerability which could lead to arbitrary code execution. This is a serious issue, but reading the report made us wonder if something was missing. // sample program to illustrate the vulnerability. #include <windows.h> #include <stdio.h> #include <stdlib.h> int __cdecl...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
Today's dubious security vulnerability comes from somebody who
reported that the <code>Load&shy;Keyboard&shy;Layout</code> function
had a security vulnerability which could lead to arbitrary code
execution.
This is a serious issue, but reading the report made us wonder
if something was missing.
</p>
<pre>
// sample program to illustrate the vulnerability.
#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int __cdecl main(int argc, char **argv)
{
 LoadKeyboardLayout("whatever", system("notepad.exe"));
 return 0;
}
</pre>
<p>
According to the report, this sample program illustrates that
the <code>Load&shy;Keyboard&shy;Layout</code> function
will execute whatever you pass as its second parameter.
In this case, the program chose to launch Notepad,
but obviously an attacker could change the code to something
more dangerous.
</p>
<p>
We had trouble trying to figure out what the person was trying to say.
After all, it's not the
<code>Load&shy;Keyboard&shy;Layout</code> function
that is executing the second parameter.
It's the sample program that's doing it,
and using the return value as the second parameter to the
<code>Load&shy;Keyboard&shy;Layout</code> function.
I mean, you can use this "technique" on the function
</p>
<pre>
void donothing(int i) { }
</pre>
<p>
to demonstrate that the <code>donothing</code> function has
the same "vulnerability":
</p>
<pre>
donothing(system("notepad.exe"));
</pre>
<p>
Logically, the compiler decomposes the call to
<code>Load&shy;Keyboard&shy;Layout</code> function as
</p>
<pre>
 auto param2 = system("notepad.exe");
 LoadKeyboardLayout("whatever", param2);
</pre>
<p>
and now it's clear that it's not the
<code>Load&shy;Keyboard&shy;Layout</code> function which is
executing its second parameter; it's <i>you</i>.
</p>
<p>
This is like taking a printed picture of your friend into a secured area,
then saying,
"See, I have a picture!
Your security failed to stop me from taking a picture!"
That picture was taken outside the secured area.
What you have is not a security vulnerability because the picture
was taken on the other side of the airtight hatchway.
</p>
<p>
Before contacting the submitter, we want to be sure that we weren't
missing something,
but after looking at it from every angle, we still couldn't see what
the issue was.
We ran the alleged exploit under the kernel debugger and traced
through the entire
<code>Load&shy;Keyboard&shy;Layout</code> function (both the user-mode
part and the kernel-mode part)
to confirm that the function never launched Notepad on its own.
We repeated the investigation on all service packs on all
versions of Windows still under support (and even some that are
no longer supported).
Still nothing.
</p>
<p>
Stumped, we contacted the submitter.
"From what we can tell, the call to <code>system</code> takes place
before you call the
<code>Load&shy;Keyboard&shy;Layout</code> function.
Can you elaborate on how this constitutes a vulnerability in the
<code>Load&shy;Keyboard&shy;Layout</code> function?"
</p>
<p>
Apparently, the submitter didn't quite understand what we were after,
because the response was just more of the same.
"I have discovered that the Visual Basic
<code>MsgBox</code> function
has a similar vulnerability:
</p>
<pre>
Module Program
Sub Main()
 MsgBox(System.Diagnostics.Process.Start("notepad.exe").ToString())
End Sub
End Module
</pre>
<p>
The <code>MsgBox</code> method will execute whatever you
pass as its parameter,
as long as the result is a string.
(You can even pass something that isn't a string, but it'll throw
an exception after executing it.)
The documentation for <code>MsgBox</code> clearly states that
the function displays a message box with the specified text.
It should therefore display a string and not execute a program!"
</p>
<p>
At this point, 
we had to give up.
We couldn't figure out what the person was trying to report,
and our attempt to obtain a clarification was met with another version
of what appeared to be the same nonsense.
As I recall, this entire investigation took five days to complete,
plus another day or two to complete the necessary paperwork.
Each year,
<a HREF="http://www.technologyreview.com/blog/editors/23100/">
200,000 vulnerability reports are received</a>,
and each one is taken seriously,
<a HREF="http://blogs.msdn.com/b/oldnewthing/archive/2008/03/14/8080140.aspx">
even the bogus-looking ones</a>,
because there might be a real issue hiding behind a bogus-looking report.
Sort of how the people in the emergency communication center
have to follow through on every
<a HREF="http://en.wikipedia.org/wiki/Emergency_telephone_number">
911</a>
call, even the ones that they strongly suspect are bogus,
and even though dealing with the suspected-bogus ones
<a HREF="http://www2.newsadvance.com/lna/news/local/article/911_hang-ups_mean_backups_for_dispatchers/12264/">
slows down the overall response time for everyone</a>.
</p>
<p>
These sort-of-but-not-quite reports are among the most frustrating.
There's enough sense in the report that it makes you wonder if there's
a real vulnerability lurking in there, but which remains elusive because
the author is unable (perhaps due to a language barrier)
to articulate it clearly.
They live in the shadowy ground between the reports that are
clearly crackpot
and the reports which are clear enough that you can evaluate them
with confidence.
These middle-ground reports are just plausible enough to be dangerous.
As a result, you close them out with trepidation,
because there's the risk
that there really is something there, but you just aren't seeing it.
Then you have nightmares that the finder has taken the report public,
and the vulnerability report you rejected as bogus is now
headline news all over the technology press.
(Or worse, exploits start showing up taking advantage of the vulnerability
you rejected as bogus two months ago.)
</p>
<p>
<b>Update</b>:
Sure, this looks like something you can reject out of hand.
But maybe there's something there after all.
Perhaps
the <code>system</code> call somehow
"primed the pump" and left the system in just the right state
so that an uninitialized variable resulted in Notepad being
launched a second time or editing its token to have higher
privileges.
In that case,
you rejected a genuine security vulnerability,
and then when hackers start using it to build a botnet,
somebody will go back into the vulnerability investigation logs,
and the only entry will be
"Rejected without investigation by Bob."</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (38)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-953353">
				<div id="div-comment-953353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953353">
			December 15, 2011 at 7:05 am</a>		</div>

		<p>It is a bit unsettling that people like this are out there writing software.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953363">
				<div id="div-comment-953363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953363">
			December 15, 2011 at 7:14 am</a>		</div>

		<p>Maybe the customer comes from a functional-programming background, and thinks that lazy evaluation is working even for parameters to system calls&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953373">
				<div id="div-comment-953373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953373">
			December 15, 2011 at 7:15 am</a>		</div>

		<p>@John</p>
<p>It could always be a kid just learning to program by playing around on his own that doesn&#39;t really understand the basic concepts of how function calls work and how expressions are evaluated. After discovering this &quot;exploit&quot; and not understanding what is really going on, he can tell his friends about all how he is an amazing hacker finding all sorts of flaws in Windows. His exploits are so advanced that the Microsoft employees he reported them to couldn&#39;t even figure out how they work!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953393">
				<div id="div-comment-953393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Diego</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953393">
			December 15, 2011 at 7:39 am</a>		</div>

		<p>How come you can&#39;t see the security flaw? LOL</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953403">
				<div id="div-comment-953403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Mongo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953403">
			December 15, 2011 at 7:44 am</a>		</div>

		<p>No, wait, it&#39;s worst.</p>
<p>Every operator, including comma also has the vulnerability. And even just (). Oh wait even if you don&#39;t write anything at all. It must be a vulnerability due to ending the lines with ;</p>
<p>Maybe the JS guys were right after all.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953413">
				<div id="div-comment-953413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953413">
			December 15, 2011 at 7:46 am</a>		</div>

		<p>The actual vulnerability is apparently that LoadKeyboardLayout() can be called after executing arbitrary code &#8212; and by extension every API function has this problem. The solution is to make LoadKeyboardLayout() return an error if it detects it was executed after arbitrary code. We can&#39;t know what the code was, so we have to be conservative.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953423">
				<div id="div-comment-953423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">No One</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953423">
			December 15, 2011 at 7:52 am</a>		</div>

		<p>@JM: I agree! &nbsp;This &quot;arbitrary code&quot; thing is such a plague. &nbsp;We really just need to stop attackers from being able to use &quot;arbitrary code&quot; and all the security vulnerabilities would go away, amirite? &nbsp;Can we get that implemented in Windows 8 &#8212; a security feature that turns off &quot;arbitrary code execution&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953433">
				<div id="div-comment-953433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stephen Nuchia</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953433">
			December 15, 2011 at 7:53 am</a>		</div>

		<p>Like grading math homework &#8212; the ones that aren&#39;t obviously wrong take more time than everything else combined.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-joshuaganes even thread-even depth-1" id="comment-953443">
				<div id="div-comment-953443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Joshua+Ganes' rel='external nofollow' class='url'>Joshua Ganes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953443">
			December 15, 2011 at 8:51 am</a>		</div>

		<p>I&#39;m glad that Microsoft takes security seriously, but I&#39;m surprised that you allowed this particular incident to consume so many resources. Programmers worth their salt would be able to recognize the flaw in the logic of this report very quickly. At that point, I can understand going back to the original submitter for clarification. After the reply you were given, you can conclude that the submitter is either profoundly confused or so poor of a communicator that it will be nearly impossible to get to the meat of the issue.</p>
<p>This sounds like a very expensive Denial of Service attack. Find a few hundred people to each file a vague but concerning vulnerability report. Now sit back and watch while Microsoft wastes several developer years following false leads.</p>
<div class="post">[<i>Oh, we recognized it immediately. But it was so obviously wrong that we began to fear that we were missing something. And you don&#39;t want to go back to somebody and say &quot;You are an idiot,&quot; if in fact they found something but simply expressed it poorly. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953473">
				<div id="div-comment-953473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953473">
			December 15, 2011 at 9:14 am</a>		</div>

		<p>In the same vane, disabling the signature verifying code in the bootloader (this can only be done by modifying the bootloader) to load a modified kernel is not a security vulnerability.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953493">
				<div id="div-comment-953493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Phil W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953493">
			December 15, 2011 at 11:34 am</a>		</div>

		<p>First, get into somebody&#39;s system by breaking down the door and finding a logged-on a computer. Second, copy this program in from your memory stack and run it. See!!! There&#39;s a vulnerabilty!!!</p>
<p>Duh&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953503">
				<div id="div-comment-953503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953503">
			December 15, 2011 at 11:35 am</a>		</div>

		<blockquote><p>
  &gt; As I recall, this entire investigation took five days to complete, plus another day or two to complete the necessary paperwork. &lt;&lt;
</p></blockquote>
<p>So the real vulnerability that was exposed was a denial-of-service attack on Microsoft&#39;s security vulnerability investigation team. &nbsp;Anybody can send in a knucklehead security defect description and tie up those resources for a whole week!</p>
<p>Watch out for the security defect report about the zero-day backdoor in the &quot;Run&quot; control that can be optionally enabled on the Start button&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953513">
				<div id="div-comment-953513" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skyborne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953513">
			December 15, 2011 at 11:41 am</a>		</div>

		<p>I think I&#39;ve seen all these comments before, but they have today&#39;s date. &nbsp;It appears that Raymond has found a way to DoS his blog readers, by repeating themes from past posts. &nbsp;The theme event triggers a predictable cascade of rants against Microsoft by the readers&#39; installed handlers&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953533">
				<div id="div-comment-953533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953533">
			December 15, 2011 at 12:56 pm</a>		</div>

		<p>@Joshua and Raymound: Maybe it was worth the time to check it out but it wasn&#39;t worth the time to write an article about it. It definitely wasn&#39;t worth our time reading it.</p>
<div class="post">[<i>Your money has been refunded. In the future, you can ignore &quot;airtight hatchway&quot; articles. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953543">
				<div id="div-comment-953543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DOS 101</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953543">
			December 15, 2011 at 1:42 pm</a>		</div>

		<p>while(true)</p>
<p>{</p>
<p>&nbsp;SendVulnerabilityToMs(RandomApi+BogusParams);</p>
<p>&nbsp;Sleep(4days);</p>
<p>}</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953563">
				<div id="div-comment-953563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Me</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953563">
			December 15, 2011 at 2:34 pm</a>		</div>

		<p>&gt;They live in the shadowy ground between the reports that are clearly crackpot and the reports which are clear enough that you can evaluate them with confidence.</p>
<p>&gt;Oh, we recognized it immediately. But it was so obviously wrong that we began to fear that we were missing something.</p>
<p>I don&#39;t see how these two statements fit together. If this report didn&#39;t hit the &quot;crackpot&quot; bar then what does??? Or did you mean it overflowed the scale and came out negative? You said yourself it&#39;s obviously from someone who doesn&#39;t know how computers work.</p>
<p>@AC: Wrong on all accounts, IMO. Not worth wading through with the kernel debugger, but the article was definitely worth a read.</p>
<div class="post">[<i>That is not crackpot. <a href="http://blogs.msdn.com/b/oldnewthing/archive/2010/07/07/10035143.aspx" rel="nofollow">This</a> is crackpot. While the initial reaction is that it&#39;s obviously from somebody who doesn&#39;t know how computers work, it could be that the problem was actually more subtle. (For example, maybe the <code>system</code> call left the system in just the right state that an uninitialized variable in <code>Load&shy;Keyboard&shy;Layout</code> caused a second copy of Notepad to run.) Think of the news articles where somebody finds a real exploit and adds, &quot;I reported this to Microsoft, and they said there was no security vulnerability.&quot; -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953573">
				<div id="div-comment-953573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953573">
			December 15, 2011 at 3:18 pm</a>		</div>

		<p>I like how you take the time to personally contact an anonymous crackpot wasting your time, but you don&#39;t contact paying customers who report non-security bugs that affect their ability to actually use their computers. It&#39;s like you care 100X more about your company&#39;s security reputation than the well-being of customers whose cash eventually becomes your salary.</p>
<div class="post">[<i>When you write &quot;you&quot;, is that the singular or plural? Because I didn&#39;t personally contact the (what we assumed to be) crackpot. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953383">
				<div id="div-comment-953383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mongo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953383">
			December 15, 2011 at 7:29 am</a>		</div>

		<p>It&#39;s even worse than previously thought &#8212; *every* API that takes an INT parameter is vulnerable to the system(&quot;notepad.exe&quot;) attack.</p>
<p>:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953583">
				<div id="div-comment-953583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Kawahee</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953583">
			December 15, 2011 at 3:53 pm</a>		</div>

		<p>You should have gone back to the customer and chastised him for writing such insecure code:</p>
<p>main(system(&quot;notepad.exe&quot;), NULL); // Launches notepad!</p>
<p>Joking aside, although you might fault Microsoft for wasting (in hindsight) 5 days investigating this issue, you can&#39;t fault them for taking security seriously.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953593">
				<div id="div-comment-953593" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Willie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953593">
			December 15, 2011 at 3:54 pm</a>		</div>

		<p>Haters are gonna hate.</p>
<p>Keep up the good work Raymond, I enjoy reading your stories.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953603">
				<div id="div-comment-953603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kme</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953603">
			December 15, 2011 at 4:43 pm</a>		</div>

		<p>Are you sure that this bug reporter wasn&#39;t just trolling you?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953453">
				<div id="div-comment-953453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953453">
			December 15, 2011 at 9:02 am</a>		</div>

		<p>@Joshua: you&#39;re right, that *is* a serious concern. You should file a meta-vulnerability report.</p>
<p>Figuring out why the meta-issue tracker isn&#39;t subject to the same attack and how to modify it to make it work anyway are left as exercises to the reader.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953463">
				<div id="div-comment-953463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">JM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953463">
			December 15, 2011 at 9:13 am</a>		</div>

		<p>@No One: actually, Windows already has a feature like that &#8212; kernel drivers need signing and the same move is being made towards BIOSes. And, of course, console hardware tries its best to prevent arbitrary code from being executed, though most such schemes have been circumvented.</p>
<p>An OS that utilizes &quot;default deny&quot; for all code would be a severe pain to administer, but you could certainly make it more secure than OSes that will run any old executable. Of course, on such an OS a function like &quot;system&quot; probably should not exist &#8212; makes it too hard to keep an overview of what code is calling what, even if both caller and callee are trusted. If it did exist, its use would be regulated so that not just any old application could start Notepad, but only those authorized to do so. And that is *before* checking user permissions.</p>
<p>Now, one problem this leaves is that the security doesn&#39;t really properly percolate to all levels. What if the processor contains malicious microcode? Could have slipped in during an update. Not just any process should be able to add two numbers together, is all I&#39;m saying&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953613">
				<div id="div-comment-953613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">fool [MSFT]</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953613">
			December 15, 2011 at 5:36 pm</a>		</div>

		<p>The bug report was from inside the house. That&#39;s why mr chen spent a week on crackpot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao even thread-even depth-1" id="comment-953623">
				<div id="div-comment-953623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953623">
			December 15, 2011 at 6:22 pm</a>		</div>

		<p>BTW, what is irritating for me is that DoS/BSoD attacks against win32k are not considered security when on a terminal server it can kick hundreds of users off.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953633">
				<div id="div-comment-953633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark S</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953633">
			December 15, 2011 at 7:33 pm</a>		</div>

		<p>&#39;fool&#39; &#8211; I&#39;m not sure that&#39;s a mitigating factor..was that a hire from back in the &quot;how many golf balls fit in a school bus&quot; days?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953653">
				<div id="div-comment-953653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">I don't get it</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953653">
			December 15, 2011 at 9:00 pm</a>		</div>

		<p>Raymond writes an interesting and amusing post, and someone complains that Microsoft cares *too much* about security?</p>
<p>And how on earth is &quot;caring about security&quot; supposed to be the opposite of caring about the well-being of customers who are harmed when people exploit security holes?</p>
<p>Some people just love to complain.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953663">
				<div id="div-comment-953663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953663">
			December 16, 2011 at 6:53 am</a>		</div>

		<p>I don&#39;t think he was complaining about caring too much about security. &nbsp;I think he was complaining about being overly sensitive to the point of wasting a few days on something that is obviously not an issue. &nbsp;If this came across my desk I would not even bother to test it, let alone kernel debug a number of Windows versions. &nbsp;On the flip side, perhaps this report is so dumb that it just shuts your brain down and forces you to validate your very existence.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953673">
				<div id="div-comment-953673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Boyd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953673">
			December 16, 2011 at 7:06 am</a>		</div>

		<p>That might just be crazy enough to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953693">
				<div id="div-comment-953693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul DeCarlo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953693">
			December 16, 2011 at 7:25 am</a>		</div>

		<p>Great read. Good to know Microsoft keeps a good eye out on security and listens to reports. &nbsp;It may not have been the best idea to inform the masses that your time can be abused with frivolous reports, but then again, any bug submission system is susceptible to abuse, it&#39;s not just Microsoft. &nbsp;To criticize Microsoft as being the center of fault for not skipping over the issue is rather short-sighted as some critics are relaying. &nbsp;Some people just want to watch the world burn. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953723">
				<div id="div-comment-953723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CarlD</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953723">
			December 16, 2011 at 7:59 am</a>		</div>

		<p>Maybe all those who would immediately dismiss this as crackpot don&#39;t realize that real bugs that seem as impossible as this do in fact occur. &nbsp;I&#39;ve no doubt that some of those result in security vulnerabilities. &nbsp;Spend some time thinking about Raymond&#39;s example of an uninitialized variable in LoadKeyboardLayout() containg some remnant of the execution of that call to system() and it&#39;s not hard to imagine that bizzare linkages involving calling a particular sequence of otherwise benign APIs could in fact result in a security loophole.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alegrigoriev odd alt thread-odd thread-alt depth-1" id="comment-953743">
				<div id="div-comment-953743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/alegr1' rel='external nofollow' class='url'>alegr1</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953743">
			December 16, 2011 at 8:15 am</a>		</div>

		<p>How about kernel memory exaustion by opening COM port, setting infinite timeouts, queueing a READ request, and then queuing a bunch of IOCTL_SERIAL_SET_QUEUE_SIZE with big buffer size requested (over a page, like 1 MB). Is it bogus or not?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953803">
				<div id="div-comment-953803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953803">
			December 16, 2011 at 11:48 am</a>		</div>

		<p>@algerl: Why bother? Until the system is no longer susceptible to forkbomb-like techniques this is pointless.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-953843">
				<div id="div-comment-953843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953843">
			December 16, 2011 at 5:20 pm</a>		</div>

		<p>This is great: Mike says &quot;It&#39;s like you care 100X more about your company&#39;s security reputation than the well-being of customers whose cash eventually becomes your salary.&quot;</p>
<p>Could this be the first time that Microsoft has been criticized for caring too much about security at the expense of raking in more cash ? &nbsp;I find this heartwarming.</p>
<p>Raymond, your blog (which I love) used to have a clever sub-heading, something along the lines of &quot;enriching our learns etc&quot;. &nbsp;Maybe the new sub-heading should be &quot;haters gonna hate&quot;. &nbsp;Or &quot;they see me codin&#39;, they hatin&#39;&quot;</p>
<p>Also, I&#39;m impressed you&#39;ve kept this blog up in spite of all the pointless knee-jerk criticism and nit-picking.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953853">
				<div id="div-comment-953853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953853">
			December 16, 2011 at 6:27 pm</a>		</div>

		<p>I&#39;m actually fairly impressed at the attention bug reports are paid. Definitely a change in opinion about how serious I think microsoft take security issues. Fair play for investigating this even if you did suspect it was a waste of time.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-953863">
				<div id="div-comment-953863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953863">
			December 16, 2011 at 10:39 pm</a>		</div>

		<p>I remember when this one came in. &nbsp;There was a surprising amount of investigation done on this on &#8211; what Raymond left out was that the investigation was done in parallel on every version of Windows that is supported, even those under a custom support agreement (<a rel="nofollow" target="_new" href="http://download.microsoft.com/download/3/a/5/3a5b342b-2f1b-4ebe-9261-98205902a74f/custom_support_agreement.pdf" rel="nofollow">download.microsoft.com/&#8230;/custom_support_agreement.pdf</a>)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-953893">
				<div id="div-comment-953893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Hensley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953893">
			December 17, 2011 at 1:46 pm</a>		</div>

		<p>&quot;Apparently, the submitter didn&#39;t quite understand what we were after, because the response was just more of the same.&quot;</p>
<p>Attention a-holes: When a support contact asks you a question, before you do anything else, ANSWER THE G**-D*** QUESTION. Or at least acknowledge that there was a question and you&#39;re not sure what it means.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-yuhong-bao odd alt thread-odd thread-alt depth-1" id="comment-953933">
				<div id="div-comment-953933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Yuhong+Bao' rel='external nofollow' class='url'>Yuhong Bao</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20111215-00/?p=8883#comment-953933">
			December 18, 2011 at 12:31 pm</a>		</div>

		<p>Yep, FYI CSAs for Windows cost $50,000 per quarter for the first year after end of support, and increases every year thereafter.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

