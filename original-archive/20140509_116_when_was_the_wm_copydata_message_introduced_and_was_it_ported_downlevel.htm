<html>
<head>
<title>When was the WM_COPYDATA message introduced, and was it ported downlevel?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>When was the WM_COPYDATA message introduced, and was it ported downlevel?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 9, 2014 / year-entry #117</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>9</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Gabe wondered when the WM_COPY­DATA message was introduced. The WM_COPY­DATA message was introduced by Win32. It did not exist in 16-bit Windows. But it was there all along. The The WM_COPY­DATA message was carefully designed so that it worked in 16-bit Windows automatically. In other words, you retained your source code compatibility between 16-bit and...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Gabe wondered <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/10/19/10360980.aspx#10361251"> when the <code>WM_<wbr>COPY&shy;DATA</wbr></code> message was introduced</a>.</p>
<p> The <code>WM_<wbr>COPY&shy;DATA</wbr></code> message was introduced by Win32. It did not exist in 16-bit Windows. </p>
<p> But it was there all along. </p>
<p> The The <code>WM_<wbr>COPY&shy;DATA</wbr></code> message was carefully designed so that it worked in 16-bit Windows automatically. In other words, you retained your source code compatibility between 16-bit and 32-bit Windows without having to do a single thing. Phew, one fewer <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/09/13/10348876.aspx"> breaking change between 16-bit and 32-bit Windows</a>. </p>
<p> As Neil noted, <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/10/19/10360980.aspx#10361367"> there's nothing stopping you from sending message <code>0x004A</code> in 16-bit Windows with a window handle in the <code>wParam</code> and a pointer to a <code>COPY&shy;DATA&shy;STRUCT</code> in the <code>lParam</code></a>. Since all 16-bit applications ran in the same address space, the null marshaller successfully marshals the data between the two processes. </p>
<p> In a sense, support for the <code>WM_<wbr>COPY&shy;DATA</wbr></code> message was ported downlevel even before the message existed! </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (9)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1123683">
				<div id="div-comment-1123683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bert Huijben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123683">
			May 9, 2014 at 7:38 am</a>		</div>

		<p>No time machine necessary this time :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1123703">
				<div id="div-comment-1123703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Smithers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123703">
			May 9, 2014 at 7:53 am</a>		</div>

		<p>They ported a feature from Win32 to Win16 even before it was invented? To think, all this time you&#39;ve been lying to us that Microsoft research haven&#39;t finished their time machine yet.</p>
<p>Although, I suppose with a time machine, it doesn&#39;t really matter when it gets finished, does it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1123753">
				<div id="div-comment-1123753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio &amp;#39;Grijan&amp;#39;</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123753">
			May 9, 2014 at 10:09 am</a>		</div>

		<p>Well, that time machine has to be really buggy&#8230; 21 years after the firs alpha was created, it has yet to be released! On the other hand, as Smithers points, the fact that we haven&#39;t received any visits from the future may prove that we won&#39;t be able to make it work in the future :-( .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1123773">
				<div id="div-comment-1123773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">John Doe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123773">
			May 9, 2014 at 3:51 pm</a>		</div>

		<p>Or rather, we&#39;re stuck in the main universe time branch. &nbsp;A time machine creates a branch at the target time, so some versions of us will see visitors from other times.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1123783">
				<div id="div-comment-1123783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123783">
			May 9, 2014 at 4:09 pm</a>		</div>

		<p>Of course, you could wonder if that may be a good thing. You never know, a universe where there are no compatibility issues in any software because someone came from the future to fix things could have ended up so awesome that the universe imploded due to division by zero.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1123793">
				<div id="div-comment-1123793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Myria</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123793">
			May 9, 2014 at 4:46 pm</a>		</div>

		<p>@Antonio:</p>
<p>&quot;What do we want?&quot;</p>
<p>&quot;Time travel!&quot;</p>
<p>&quot;When do we want it?&quot;</p>
<p>&quot;It&#39;s irrelevant!&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1123803">
				<div id="div-comment-1123803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">smf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1123803">
			May 10, 2014 at 1:38 am</a>		</div>

		<p>Time travel is all around us, we just have no control over the speed or direction of the travel.</p>
<p>Some time travel myths don&#39;t allow time travel before the time machine was created, making when you want it quite relevant.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1124133">
				<div id="div-comment-1124133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1124133">
			May 13, 2014 at 9:57 am</a>		</div>

		<p>I believe the following are now known to be true:</p>
<p>If you send a nonexistent message it will be delivered as is.</p>
<p>If you send a nonexistent message that Windows later uses (let the reader understand) your code will break. Therefore don&#39;t send unallocated messages in the system range (0 .. WM_USER &#8211; 1).</p>
<p>If you send a message that was already allocated in a future version of Windows to a program that knows what to do with it your code will work if the null marshaller does the right thing (which is almost always equal to the message will be delivered as is).</p>
<div class="post">[<em>More accurately, &quot;If you send a nonexistent message <span style="text-decoration:underline;">on 16-bit Windows</span>, it will be delivered as is.&quot; The rules are stricter on 32-bit and 64-bit Windows. That&#39;s because 16-bit Windows didn&#39;t require marshaling for any messages! -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1124163">
				<div id="div-comment-1124163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20140509-00/?p=1033#comment-1124163">
			May 13, 2014 at 1:39 pm</a>		</div>

		<p>Hmm what did I miss? A message not in the table of messages doesn&#39;t get marshaled so WPARAM and LPARAM don&#39;t change when sent across processes (ignoring widening/narrowing when crossing bitness). Perhaps sending messages from future Windows versions is forbidden in 32 bit or 64 bit Windows. Perhaps something else.</p>
<div class="post">[<em>16-bit Windows does not marshal anything, so WPARAM and LPARAM never change when sent across processes. 32-bit Windows does marshaling and rejects invalid messages since it doesn&#39;t know how to marshal them. This trick, therefore, works only with 16-bit Windows. -Raymond</em>]</div>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

