<html>
<head>
<title>Why is the readonly property for folders so strange?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why is the readonly property for folders so strange?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>September 30, 2003 / year-entry #77</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>10</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">It's actually a signal to Explorer to look harder. It doesn't mean that the directory is read-only. If a folder has the Readonly or System flag set, then Explorer will look for a desktop.ini file which describes the folder customizations. For performance reasons, Explorer does this only if the directory has the +R or +S...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>         It's actually a signal to Explorer to look harder.  It doesn't mean that the directory is read-only.     </p>
<p>         If a folder has the Readonly or System flag set, then Explorer will look for a <code>desktop.ini</code> file         which describes the folder customizations. For performance reasons, Explorer does         this only if the directory has the +R or +S flag. (This is enormously important on         slow networks.)      </p>
<p>         There are two KB articles on this subject, and I will defer to them for much of the         discussion. <a href="http://support.microsoft.com/?kbid=326549">This is the version         that applies to Windows XP and Windows Server 2003</a>. There is also <a href="http://support.microsoft.com/?kbid=256614">a         version that applies to older versions of Windows</a>, although the <code>UseSystemForSystemFolders</code> policy         still applies.      </p>
<p>         Coders shold use the function <code>PathMakeSystemFolder</code> to mark a folder as         requiring special attention from Explorer.      </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (10)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-126023">
				<div id="div-comment-126023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126023">
			September 30, 2003 at 12:07 pm</a>		</div>

		<p>I love this site &#8230; so many interesting updates. I&#8217;m learning lots from all of this, please keep it up :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-126033">
				<div id="div-comment-126033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lee Alexander</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126033">
			October 1, 2003 at 4:09 am</a>		</div>

		<p>Carry on with the good work I thoroughly enjoy reading your articles just before I start work :-) BTW are you doing any PDC talks?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-126043">
				<div id="div-comment-126043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Serge Wautier</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126043">
			October 1, 2003 at 11:33 am</a>		</div>

		<p>Speaking of slow networks, I&#8217;ve recently setup a VPN between our headquarters and a foreign subsidiary. My experience is that using Windows Explorer to connect to a shared drive over the VPN is practically impossible : waaaaaaaay too slow, especially when one (single-)clicks a file. I assumed it&#8217;s because Windows collects data about the file (e.g.: title and author displayed in the status bar if it&#8217;s a word doc).<br />
On the other hand, connecting through a console window (net use blah&#8230;) works very well (in terms of performance, not in terms of usability&#8230;)<br />
Is there any &#8216;Use slow connection&#8217; mode for access to network drives by Windows Explorer, a bit like the same option in RAS ?</p>
<p>And of course, it must be written because it&#8217;s just too easy to think it and never say it : Thanks so much for this blog, Raymond ! Keep up with the good work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-126053">
				<div id="div-comment-126053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Israel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126053">
			October 1, 2003 at 2:49 pm</a>		</div>

		<p>That was one of the most perplexing behaviors I had encountered in Windows! Thanks for explaining. I know I&#8217;ll feel like a hotshot next time I&#8217;m explaining it to someone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-126063">
				<div id="div-comment-126063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.johntopley.com' rel='external nofollow' class='url'>John Topley</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126063">
			October 6, 2003 at 11:10 am</a>		</div>

		<p>This seems very strange to me. Why can&#8217;t it do what it says on the tin i.e. if read-only is checked then any existing files within that folder should be made read-only, as should future files added to it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-126073">
				<div id="div-comment-126073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.proggle.com' rel='external nofollow' class='url'>Gleb Dolgich</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126073">
			October 9, 2003 at 8:04 am</a>		</div>

		<p>Can you give any insight on why icon handlers are ignored for folders?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-126083">
				<div id="div-comment-126083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.ozemail.com.au/~markhurd/' rel='external nofollow' class='url'>Mark Hurd</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-126083">
			October 19, 2003 at 11:06 pm</a>		</div>

		<p>Serge: Given what I&#8217;ve seen as a developer, a left click seems to build the whole contect menu you&#8217;d expect to see with a right click, then choose the default menu item. If you have things like WinZip and such that need to review the content of the file to determine what menu items to offer this can be rather slow.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-186243">
				<div id="div-comment-186243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-186243">
			June 22, 2004 at 6:16 pm</a>		</div>

		<p>Mark: that&#8217;s exactly how it works. The shell builds an off-screen context menu and &quot;clicks&quot; the default item. Shell extensions are supposed to make their additions to the context menu quickly, of course. Read about IShellFolder::GetUIObjectOf, IContextMenu::QueryContextMenu and IContextMenu::InvokeCommand</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-186273">
				<div id="div-comment-186273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-186273">
			June 22, 2004 at 8:57 pm</a>		</div>

		<p>Commenting on this entry has been closed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413383">
				<div id="div-comment-413383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/michkap/archive/2006/08/24/712675.aspx' rel='external nofollow' class='url'>Sorting It All Out</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20030930-00/?p=42353#comment-413383">
			August 24, 2006 at 2:28 pm</a>		</div>

		<p>There is an alias at Microsoft that is the front line for the Shell team, the one place where the important&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

