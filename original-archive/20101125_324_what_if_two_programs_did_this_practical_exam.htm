<html>
<head>
<title>What if two programs did this? Practical exam</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>What if two programs did this? Practical exam</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 25, 2010 / year-entry #325</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>41</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer who doesn't read this blog had the following question: The requirement for our application is that it must be on top of all other windows, even in the presence of other windows with the topmost style. In our WM_KILLFOCUS and WM_PAINT messages, we set ourselves to topmost, and then call SetWindowPos to bring...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p> A customer who doesn't read this blog had the following question: </p>
<blockquote class="q">
<p> The requirement for our application is that it must be on top of all other windows, even in the presence of other windows with the topmost style. In our <code>WM_KILLFOCUS</code> and <code>WM_PAINT</code> messages, we set ourselves to topmost, and then call <code>SetWindowPos</code> to bring ourselves to the front, and then we <code>SetForegroundWindow</code> ourselves just to make sure. </p>
<p> The result is that our application and another application end up fighting back and forth because both applications are applying similar logic to remain on top. There are other applications that defeat our logic, and they manage to cover our application. (These other applications are third party applications we have no control over.)  </p>
<p> We are in the process of writing a DLL to hook all messages for all windows and [even crazier things that aren't worth elaborating on], but at the moment this causes the other hooked applciations to crash. We are also considering setting a timer and calling <code>SetWindowPos</code> when the timer fires, but that seems inefficient. </p>
</blockquote>
<p> The customer didn't even have to run through the thought experiment <a href="http://blogs.msdn.com/oldnewthing/archive/2005/06/07/426294.aspx"> What if two programs did this?</a>; they got to run it in real life! And the result was as predicted: The two programs fight with each other to be the one that is on top of the other. Nobody wins; everybody loses, especially the user. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (41)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-876783">
				<div id="div-comment-876783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876783">
			November 25, 2010 at 7:18 am</a>		</div>

		<p>So, what was their &quot;question&quot;? All that&#39;s quoted is the description of their misery :)</p>
<p>I have a feeling that many of these &quot;you cannot be special&quot; cases arise from not distinguishing between program wishing to be special and user wishing that for some program. People might not want their program to be special for everyone, everywhere, but just in their domain where having the app is corporate policy.</p>
<p>In other words, the correct design would be to allow every form of being special, but only if the user (or the group policy) asked for it. Just like with file format handlers, only allowing just one application to succeed.</p>
<p>Well, in the most cases it&#39;s probably not worth the trouble though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876803">
				<div id="div-comment-876803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876803">
			November 25, 2010 at 7:42 am</a>		</div>

		<p>@BrianG sounds like you&#39;re talking about the ISP that comes before NetOne and after NetNegativeOne. &nbsp;Not to name names.</p>
<p>Speaking of VMs, that would have been a novel way to defeat it. &nbsp;Figure out how to get it running inside the VM, share the VM&#39;s internet connection with the host, then simply minmize the VM window.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876813">
				<div id="div-comment-876813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876813">
			November 25, 2010 at 7:43 am</a>		</div>

		<p>PS: Despite there technically being an infinite range of numbers between -1 and 1, if that comment violates the blog rules feel free to snip that part out Raymond. &nbsp;I&#39;m not sure if it does now.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876823">
				<div id="div-comment-876823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">@Dan Bugglin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876823">
			November 25, 2010 at 7:47 am</a>		</div>

		<p>Nope, that wasn&#39;t the ISP at all. &nbsp;If they were providing the service, it was subcontracted to them via a different front, at least.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876833">
				<div id="div-comment-876833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua Ganes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876833">
			November 25, 2010 at 7:48 am</a>		</div>

		<p>@Brian G. &#8211; I used a similar piece of software for my first internet connection. My parents were too frugal to pay for internet services, so we installed the ad-laden software and gained very slow access to the internet. That software made my already-small, 14&quot; monitor display even less working space. I recall that I found a sequence of processes to kill so that the ads went away, but the internet connection stayed alive.</p>
<p>Why do so many people seem to think that their software is so special? It must be the same reason so many of the drivers on the road seem to think the whole road belongs to them.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876843">
				<div id="div-comment-876843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876843">
			November 25, 2010 at 7:48 am</a>		</div>

		<p>@Dan Bugglin: nope that wasn&#39;t the ISP at all. &nbsp;Well, it may have been the company that provided the service, but as a subcontractor for a different front. &nbsp;But I have no evidence that was the case.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876853">
				<div id="div-comment-876853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876853">
			November 25, 2010 at 7:50 am</a>		</div>

		<p>@Dan:</p>
<p>Too late. I&#39;ve already seen you name and shame NetNegativeZeroPointSixFourThreeTwoEightFourNine</p>
<p>TRWTF is that the customer thought their app was that important; they should give the user the choice: Stay on top? True, False, FileNotFound; I have rearranged your z-order, pray I don&#39;t rearrangeit further; and the customer in this story should be banned from their mummy and daddy&#39;s modem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876873">
				<div id="div-comment-876873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Kohne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876873">
			November 25, 2010 at 7:58 am</a>		</div>

		<p>Did you tell them that the right approach was to get out of the business? Obviously this kind of &#39;take over the user&#39;s machine&#39; thinking is only going to lead them to more and more trouble, crashes, and irritated users. And the worst of it is, they&#39;ll probably not see but half of the trouble they cause.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876883">
				<div id="div-comment-876883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Skip</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876883">
			November 25, 2010 at 8:00 am</a>		</div>

		<p>As a related task, I wonder if there&#39;s anything I could do as a user to prevent apps from ever bringing themselves to focus over the app that I, the user, have chosen for focus. &nbsp; Probably not, it most likely runs into the same arms race conditions. &nbsp; But it&#39;s something that I wish the OS would allow/enforce. &nbsp; System messages are one thing, but it used to annoy me to no end back when I was on dialup &#8211; I&#39;d start a web page or four loading, or fire up office, then go back to editing code, to make use of the 3-4 minutes that I&#39;d have before the pages would be loaded. &nbsp; And invariably the browser would decide to bring itself to the front right as I was typing a backspace, causing me to waste another few minutes loading it again.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876893">
				<div id="div-comment-876893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876893">
			November 25, 2010 at 8:18 am</a>		</div>

		<p>Any hint at what type of app they were providing? Afterall special app should be from very special field.</p>
<p>And then they should have fired whoever whrote that requirment&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876903">
				<div id="div-comment-876903" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876903">
			November 25, 2010 at 8:18 am</a>		</div>

		<p>Any hint at what type of app they were providing? Afterall special app should be from very special field.</p>
<p>And then they should have fired whoever wrote that requirment&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876913">
				<div id="div-comment-876913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Antonio Rodr&#237;guez</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876913">
			November 25, 2010 at 8:29 am</a>		</div>

		<p>When I find an application that keeps staying in my face or makes something as annoying as that, I uninstall it. Immediately. I wouldn&#39;t date to make a program that acts that way, because I respect my users.</p>
<p>@Paul:</p>
<p>Remember that, maybe, not everybody here reads The Daily Worse Than Failure. Just maybe ;-) .</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-matteo even thread-even depth-1" id="comment-876923">
				<div id="div-comment-876923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Matteo+Italia' rel='external nofollow' class='url'>Matteo Italia</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876923">
			November 25, 2010 at 9:35 am</a>		</div>

		<p>[useless comment]@Brian G.: I&#39;ve seen that kind of thing done by restricting the working area (SystemParametersInfo w/ SPI_SETWORKAREA) to a smaller rectangle and then positioning the toolbar programmatically in the newly created &quot;forbidden&quot; zone.</p>
<p>This is the same mechanism that allows the Start bar (which is actually a quite normal window) to stay where it stays without having other windows getting over it.[/useless comment]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876933">
				<div id="div-comment-876933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Heffernan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876933">
			November 25, 2010 at 9:51 am</a>		</div>

		<p>You&#39;ve just described a very large portion of the requests for help on Stack Overflow!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876953">
				<div id="div-comment-876953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876953">
			November 25, 2010 at 10:29 am</a>		</div>

		<p>@Matteo Italia: Ah, that makes sense. &nbsp;I wasn&#39;t sufficiently familiar with the vocabulary to know what it&#39;s called, but had an intuitive feel for what it is. &nbsp;What you describe fits exactly with what I recall experiencing.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876963">
				<div id="div-comment-876963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">rs</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876963">
			November 25, 2010 at 11:10 am</a>		</div>

		<p>Even if the customer&#39;s question is paraphrased, it&#39;s hard to believe that there are people who seriously ask for such things.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876973">
				<div id="div-comment-876973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drizzt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876973">
			November 25, 2010 at 11:56 am</a>		</div>

		<p>There are a lot of situations where all this can be necessary, but you can smell the wrong situation by the fact that there are other apps broking the system.</p>
<p>I mean, for my customers it&#39;s perfectly normal to have our apps always on top, or always in background, in one case even replacing shell, sometimes even moving by themeselves accross screens. But, in such situations, it&#39;s MY team that decide what&#39;s on those PC (plannig with the customers, obviously). There is no way another app can do whatever it like, for if it&#39;s doing so, it&#39;s not an app that should be on the machines.</p>
<p>Well, or one of my collegues has gone drunk, but that&#39;s an entire different story.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-876993">
				<div id="div-comment-876993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876993">
			November 25, 2010 at 2:08 pm</a>		</div>

		<p>@Alex: How did you get there? Only fullscreen apps do it for me. (Both XP and Win 7) Or I just don&#39;t have such bloody programm installed&#8230; (what that then would be?)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877013">
				<div id="div-comment-877013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">frymaster</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877013">
			November 25, 2010 at 2:10 pm</a>		</div>

		<p>&quot;In other words, the correct design would be to allow every form of being special, but only if the user (or the group policy) asked for it.&quot;</p>
<p>the issue is that just about anything a user can specify (like &quot;make this window special&quot;), the app can specify on the user&#39;s behalf</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877023">
				<div id="div-comment-877023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877023">
			November 25, 2010 at 2:26 pm</a>		</div>

		<p>Alex: Windows does it by default these days, no setting needed. It is enforced by Windows that any focus related calls will only go through if it is coming from the application with focus.</p>
<p>For the start menu, it is explorer being kind. Because lets face it, if it did that when you were using an application staying in front, it would be annoying. The obvious solution is to just not use the start menu for a few seconds after you have logged in.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876793">
				<div id="div-comment-876793" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876793">
			November 25, 2010 at 7:21 am</a>		</div>

		<p>I once had a program (back in Win95 days) which allowed me to connect to a free ISP. &nbsp;(This was back in the days before I knew anything about GUI software development, so I&#39;m going to try to reverse engineer it from memory). &nbsp;It stayed at the bottom of the screen, moved anything that covered it under it (or perhaps just shoved them back up the screen so there was no layering issues to deal with), and displayed ads to pay for the service I was getting for free. &nbsp;If I closed the app, it killed the network connection. &nbsp;I guess that&#39;s the closest I&#39;ve ever come to seeing an application which has a &quot;legitimate&quot; use for doing evil things to the customer&#39;s desktop. &nbsp;Aside from being hugely annoying (and eating a huge chunk of real estate) while connected to the internet, it seemed to be well-behaved (didn&#39;t leave processes running all the time in the background while not in use, etc.).</p>
<p>Actually, I don&#39;t know that I ever thought to put an always-on-top window over it. &nbsp;*sigh* &nbsp;If only I still had that sort of thing to experiment with (in a Win 98 VM, of course).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877033">
				<div id="div-comment-877033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Oh boy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877033">
			November 25, 2010 at 4:19 pm</a>		</div>

		<p>That reminds me of silverlight and how it every second (500ms i guess) calls SetPriorityClass with ABOVE_NORMAL_PRIORITY_CLASS</p>
<p>I noticed this because it disrupted my other programs and when i tried to manually change the priority back (yes i DID search for a setting to change first, none exists) to normal it instantly changed the priority back to ABOVE_NORMAL_PRIORITY_CLASS.</p>
<p>The funny and sad part is according to microsoft support this is &quot;by design&quot;</p>
<p>Microsoft isn&#39;t even following its own damn rules.</p>
<p>Example:</p>
<p>1. The good citizens rule.</p>
<p>2. Don&#39;t abuse API&#39;s that can/will affect the user and/or other programs on the same computer.</p>
<p>the list goes on but you get my point..</p>
<p>Microsoft as hypocritical as ever..</p>
<p>Tells outsiders (non-microsoft devs) to follow their rules and microsoft doesnt even follow them themselves, &lt;sarcasm&gt; very professional &lt;/sarcasm&gt;</p>
<p>whats next spying on their paying users..oh right they do that already&#8230;hmm..what is lower that that..</p>
<div class="post">[<i>Why are you telling me? <a href="http://blogs.msdn.com/b/oldnewthing/archive/2006/07/13/664448.aspx" rel="nofollow">Glass houses are great places to throw stones</a>. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877043">
				<div id="div-comment-877043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877043">
			November 25, 2010 at 5:14 pm</a>		</div>

		<p>@Oh boy</p>
<p>What is the point in turning this into a bash against Microsoft? The teams are autonimous, so if one team puts out these rules, it doesn&#39;t mean another team has to follow them. Please, coming up with bashes and rants will do nothing but strengthen the case for turning off comments in these blog entries.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877053">
				<div id="div-comment-877053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877053">
			November 25, 2010 at 5:20 pm</a>		</div>

		<p>I&#39;d be grateful if there&#39;s a future version of SetForegroundWindow() can just be modified that, if centain user setting is set, it&#39;ll just blink the taskbar and do not steal focus. Or just like the &quot;hide notification icon&quot; function, the user can surpress even the blinking if the application is annoying enough.</p>
<p>If that&#39;s the case, in this scenario you&#39;ll just have two (or more) blinking button on taskbar. The user is not losing.</p>
<p>And with this feature, if some web browser is tricked to bypass scripting filter and popup infinate window, the user can claimly right click the button on taskbar can close all windows. (Not that they can&#39;t do now, but continuously popping up windows case panic to users, and they may just be stunned and cannot think what they could do)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877073">
				<div id="div-comment-877073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ivo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877073">
			November 25, 2010 at 7:51 pm</a>		</div>

		<p>[Crescens2k &#8211; The teams are autonimous, so if one team puts out these rules, it doesn&#39;t mean another team has to follow them.]</p>
<p>The teams are autonomous, yes. So Raymond&#39;s blog is not the place to bash those other teams. That&#39;s true.</p>
<p>However if the Windows team puts out rules for developing Windows applications, of course the other teams at Microsoft should follow them. Just like any external developer is expected to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877083">
				<div id="div-comment-877083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Crescens2k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877083">
			November 25, 2010 at 8:03 pm</a>		</div>

		<p>@Ivo</p>
<p>Yes it is true, the other teams should be setting an example. But again, this isn&#39;t the place to discuss it. The correct places would be either with the bug reports or via direct communication with those teams. I have no issue with what is being said it is just the whole place of it being said.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876983">
				<div id="div-comment-876983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-876983">
			November 25, 2010 at 12:47 pm</a>		</div>

		<p>@Skip: There is such a thing yes. Dunno about Windows, although I do remember a programs task bar entry flashing to signal that it wants something but not appearing on top. But on Linux I have exactly that setting, &quot;focus stealing prevention&quot;. It has different levels, probably for the different types of calls windows can use to bring themselves on top.</p>
<p>As an aside: One thing that has always driven me crazy in Windows, was the fact that the start menu would not stay on top if something else was doing something. Lets say during windows start up, something is still loading, but I can already use the start menu. Someone does some kind of focus call and my start menu vanishes. *ARGH* Same thing after start up. Some program wants to show me a message while I&#39;m in the start menu and it vanishes. *ARGH*. Doesn&#39;t happen in KDE at least. Love that!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877093">
				<div id="div-comment-877093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877093">
			November 25, 2010 at 10:54 pm</a>		</div>

		<p>The funny thing is that it&#39;s &quot;never right&quot;. Using a certain Microsoft Development Tool, I hate that it steals focus when I load a solution, but I&#39;m glad is steals focus when it pops up for debugging. It wont ever be &quot;right&quot; until they make PCs that can read a user&#39;s mind :P</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877103">
				<div id="div-comment-877103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877103">
			November 25, 2010 at 11:39 pm</a>		</div>

		<p>Hey, why not have a canned message to reply to such developers with say..</p>
<p>&quot;Dear Customer,</p>
<p>If you are such a pompous ass and consider yourself above all mortals, why don&#39;t you go get a Mac already? Seriously, those were BUILT specifically for people like you.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877123">
				<div id="div-comment-877123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877123">
			November 26, 2010 at 1:43 am</a>		</div>

		<p>@Oh boy</p>
<p>Congratulations on making the same tired points that have already been adequately answered in the comments of the linked article from 5 years ago!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877133">
				<div id="div-comment-877133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asdbsd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877133">
			November 26, 2010 at 5:21 am</a>		</div>

		<p>@frymaster: &gt; the issue is that just about anything a user can specify (like &quot;make this window special&quot;), the app can specify on the user&#39;s behalf</p>
<p>Not if you run shell with elevated privileges.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877143">
				<div id="div-comment-877143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877143">
			November 26, 2010 at 6:12 am</a>		</div>

		<p>@Antonio Rodr√≠guez</p>
<p>I know, but a fair few will.</p>
<p>Also, a comment like I made here would probably have been removed from tdwtf. :(</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877113">
				<div id="div-comment-877113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Lawrence</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877113">
			November 25, 2010 at 11:49 pm</a>		</div>

		<p>The scary part, and I don&#39;t think anyone has commented on it yet, is that the customer is describing *three* applications: 1. the one he&#39;s developing, 2. the one he&#39;s fighting with, and 3. 3rd party apps that &#39;defeat&#39; him.</p>
<p>The most likely interpretation is that app #2 was *also* developed by this customer, and is interfering with their development of app #1! So he&#39;s saying &quot;we wrote an application that always stays on top, but now we want to write another one that always stays on top even of that&quot;. </p>
<p>How this person didn&#39;t realize their peril *after developing both applications* is mind boggling!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877203">
				<div id="div-comment-877203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Oh boy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877203">
			November 26, 2010 at 8:05 am</a>		</div>

		<p>@Crescens2k it&#39;s not bashing of any kind, i&#39;m merely stating a fact, an observation (that i have seen over and over again and it have never been corrected)</p>
<p>Don&#39;t make it into what its not.</p>
<p>a bug report or via direct communication, will be ignored, i&#39;ve already tried that.</p>
<p>So i&#39;m taking a page from the security researchers book, official discloser for all to see. To officially ask the questions to microsoft.</p>
<p>Bad PR is the only thing microsoft seem to respond to, another example of bad professionalism (ignoring developers)</p>
<p>&quot;this isn&#39;t the place to discuss it&quot;</p>
<p>Since both outside developers and microsoft employees alike read this blog, it is actually a good place. Its open and read by both sides.</p>
<p>Yes it is a bit off topic, i&#39;m apologize for that.</p>
<p>@Ivo</p>
<p>You&#39;re on the right track.</p>
<p>@Pi</p>
<p>&quot;adequately answered&quot; no, it has not, but an official detailed answer about these practices (their doing and how and when they will correct them) would be nice.</p>
<p>An answered question means people will stop asking the same question because they now have the answer.</p>
<p>You think i&#39;m asking a question that have been &quot;adequately answered&quot; before perhaps you can now see the mistake you did, think before you post, please.</p>
<p>Come on people, these questions deserve to be answered and _corrected_ once and for all.</p>
<p>Sigh why are whistleblower always getting the blame, not logical at all.</p>
<div class="post">[<i>I think you&#39;ve confused the words &quot;effective&quot; and &quot;good.&quot; -Raymond]</i></div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877283">
				<div id="div-comment-877283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gechurch</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877283">
			November 26, 2010 at 4:33 pm</a>		</div>

		<p>@oh boy</p>
<p>You seem to be very confused. On a lot of things.</p>
<p>I&#39;m not sure what makes you thing typing a comment to Raymond&#39;s blog post is &quot;officially ask[ing] the questions&quot;. Particularly when the question is about Silverlight process priority, and the blog post is about apps wanting to be on top &#8211; totally unrelated. I&#39;m also not sure what effect you think posting a comment here &quot;for all to see&quot; will have. The readers of Raymond&#39;s blog would have to be the set of people that are already most intimitely aware of standards and compatibility and best-practice for writing apps. Do you really think anyone here is going to be shocked and outraged that an app puts itself slightly higher in the process priority stakes?</p>
<p>Googling for this issue, I found one blog post and one forum thread. So you are asking Microsoft to create &quot;an official, detailed answer about these practices&quot; for an issue about 10 people in cyberspace have commented on. Imagine if Microsoft did this for every issue a handful of people complained about! What a ridiculous request.</p>
<p>For the record, I dislike the fact Silverlight does this. Presumably it does it because Silverlight gets used to stream high-quality video. People tend to be very fussy about wanting video to play smoothly, so the developers must have decided this was the best way to solve the issue. Other technologies (like Flash) get used for the same purpoe and don&#39;t need to increase priority, so this seems like a solvable problem without resorting to this blanket approach. If you are watching a video in Silverlight, I don&#39;t see this as being a big deal.</p>
<p>Please stop with the cries of matrydom. Your initial post was a Microsoft bash. You were not simply stating fact in an impartial way. You were deliberately being emotive and aggressive. It is not the fact you pointed out an issue with Silverlight people are responding to, it&#39;s the childish way you have gone about it. As examples, see your use of sarcasm, use of language such as &quot;hypocritical&quot; and your unbased comment that Microsoft spies on it&#39;s customers (heck, it was even unexplained &#8211; presumably you are referring to the usage statistics that end-users have to opt-in to, and are completely anonymous). So no, you are not as you claim &quot;taking a leaf out of the &quot;security researchers book&quot;. More like the &quot;Slashdot trolls book&quot;.</p>
<p>Oh, and apologising for being off-topic in your follow-up post that continues to be off-topic is hardly sincere.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877323">
				<div id="div-comment-877323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Oh boy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877323">
			November 26, 2010 at 7:08 pm</a>		</div>

		<p>@Gechurch you&#39;re the one that&#39;s confused, i think you should go to your thinking place and redo it because you&#39;re not getting it.</p>
<p>Did you miss my second post ?</p>
<p>&quot;I&#39;m also not sure what effect you think posting a comment here &quot;for all to see&quot; will have.&quot;</p>
<p>For one, making more people aware of the problems. To increase the pressure on microsoft.</p>
<p>&quot;The readers of Raymond&#39;s blog would have to be the set of people that are already most intimately aware of standards and compatibility and best-practice for writing apps.&quot;</p>
<p>Well i could dream&#8230;</p>
<p>&quot;Presumably it does it because Silverlight gets used to stream high-quality video&quot;</p>
<p>Well in short: They have problems with their decoding efficiency.</p>
<p>And instead of fixing it <em>correctly</em> they were lazy and worked around the issue.</p>
<p>(quite common practice, sadly enough)</p>
<p>Of course if they had done it correct the first time they wouldn&#39;t have to waste time fixing it twice. (Time is money and all that)</p>
<p>I see i got you fired up and flustered for the comment about Microsoft spying on it&#39;s customers.</p>
<p>Yeah sorry i couldn&#39;t resist, i was just having a bit of fun. People was sort of assuming / expecting something like that would come so i&#39;d thought i would give it to them.</p>
<p>I guess you just didn&#39;t see the obvious joke.</p>
<p>No i don&#39;t troll (never), i just want microsoft to follow their own rules and be a good example to others. Is that so bad ?</p>
<p>So can you see now, i actually want to help microsoft become better.</p>
<p>My apology was sincere.</p>
<p>Of course i have to answer people when i get attacked.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877363">
				<div id="div-comment-877363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">640k</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877363">
			November 27, 2010 at 3:48 am</a>		</div>

		<p>This looks like a contest in how to abuse the window system. And the loser asks how to do it more because he got defeated.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877373">
				<div id="div-comment-877373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Alex Cohn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877373">
			November 27, 2010 at 5:44 am</a>		</div>

		<p>Is it only me that is perpetually defeated by Windows Update asking if I want to restart the system every time my half prepared e-mail requires the &quot;R&quot; key?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877533">
				<div id="div-comment-877533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">david.tyler.hunt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877533">
			November 29, 2010 at 10:28 am</a>		</div>

		<p>The foreground window battles are bad enough, but this insane behavior is also sometimes observed in people who are writing privileged services to do heavy lifting on behalf of user programs. The bad part comes in when they don&#39;t decide to design interfaces that are hard to use for evil, and then try fruitlessly to defend their client application from all the other evil processes that are happily trying to inject code into it. It frustrates me that when you tell them this is bad design, they get defensive.</p>
<p>RE: Silverlight, I don&#39;t think &#39;above-normal&#39; is a huge deal if Silverlight isn&#39;t doing any work. &nbsp;But yeah, continually futzing with scheduling after the system has expressed its intent at you is less than cool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-877643">
				<div id="div-comment-877643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Timothy Byrd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877643">
			November 29, 2010 at 3:19 pm</a>		</div>

		<p>Klimax: &quot;And then they should have fired whoever whrote that requirment&#8230;&quot;</p>
<p>No, &quot;I bet somebody got a really nice bonus for that feature&quot;</p>
<p>( <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2006/11/01/922449.aspx" rel="nofollow">blogs.msdn.com/&#8230;/922449.aspx</a> )</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-877703">
				<div id="div-comment-877703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Klimax</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20101125-00/?p=12203#comment-877703">
			November 30, 2010 at 12:41 am</a>		</div>

		<p>Unfortunately I know how Real World operates. That&#39;s why I used &quot;should&quot;. (Heh, and I read linked post at that time.)</p>
<p>Afterall TDWTF is good site to visit everyday&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

