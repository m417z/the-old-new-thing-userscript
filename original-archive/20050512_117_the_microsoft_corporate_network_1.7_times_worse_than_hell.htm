<html>
<head>
<title>The Microsoft corporate network: 1.7 times worse than hell</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>The Microsoft corporate network: 1.7 times worse than hell</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>May 12, 2005 / year-entry #118</td></tr>
<tr><td><b>Tags:</b></td><td>history</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>17</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Today I'm going to tell a story from 1996. Why? Because I can. One of the tests performed by Windows Hardware Quality Labs (WHQL) was the NCT packet stress test which had the nickname "Hell". The purpose of the test was to flood a network card with an insane number of packets, in order to...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>Today I'm going to tell a story from 1996. Why?  Because I can.</p>
<p> One of the tests performed by <a href="http://www.microsoft.com/whdc/whql/"> Windows Hardware Quality Labs (WHQL)</a> was the NCT packet stress test which had the nickname "Hell". The purpose of the test was to flood a network card with an insane number of packets, in order to see how it handled extreme conditions. It uncovered packet-dropping bugs, timing problems, all sorts of great stuff. Network card vendors used it to determine what size internal hardware buffers should be in order to cover "all reasonable network traffic scenarios". </p>
<p> It so happened that at the time this test had currency (1996 era), the traffic on the Microsoft corporate network was approximately <strong>1.7&nbsp;times worse</strong> than the NCT packet stress test. A card could pass the Hell test with flying colors, yet drop 90% of its packets when installed on a computer at Microsoft because the card simply couldn't keep up with the traffic. </p>
<p> The open secret among network card vendors was, "If you want your card to work with Windows, submit one card to WHQL and send another to a developer on the Windows team." </p>
<p> (This rule applied to hardware other than network cards. I was "gifted" a sound card from a major manufacturer and installed it on my main machine. It wasn't long before I found and fixed a crashing bug in their driver.) </p>
<p> [Raymond is currently on vacation; this message was pre-recorded.] </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (17)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-275623">
				<div id="div-comment-275623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.ugidotnet.org/lbarbieri/archive/2005/05/12/16150.aspx' rel='external nofollow' class='url'>Lorenzo Barbieri @ UGIblogs!</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275623">
			May 12, 2005 at 10:17 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275633">
				<div id="div-comment-275633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.csc.calpoly.edu/~bfriesen/' rel='external nofollow' class='url'>Brian Friesen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275633">
			May 12, 2005 at 10:20 am</a>		</div>

		<p>I remember around the NT 3.51 / early NT4 days a lot of video cards had awful drivers, the one exception was ATI which seemed to have rock solid drivers.  Later I read somewhere that pretty much every Windows developer was running an ATI video card which I&#8217;m sure played a role in that.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275643">
				<div id="div-comment-275643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamesatuncw.com/blog' rel='external nofollow' class='url'>James Summerlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275643">
			May 12, 2005 at 11:05 am</a>		</div>

		<p>Of course the real question to ask is did ATI improve their driver or did Raymond and the rest of the Windows Team include code in Windows to account for ATI&#8217;s bad behavior?</p>
<p>James</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-275663">
				<div id="div-comment-275663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275663">
			May 12, 2005 at 12:45 pm</a>		</div>

		<p>Brian, I believe most of us were using S3 cards at the time actually.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275673">
				<div id="div-comment-275673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.lawfulneutral.com/blog/' rel='external nofollow' class='url'>Chris</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275673">
			May 12, 2005 at 12:45 pm</a>		</div>

		<p>In what specific ways was the Microsoft corporate network worse than Hell? Why didn&#8217;t the author of Hell record Microsoft corporate network traffic and simply play it back as his test?</p>
<p>This funny story also shows how hardware manufacturers should offer big discounts to become official suppliers of Microsoft employee workstations! &lt;:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman odd alt thread-odd thread-alt depth-1" id="comment-275683">
				<div id="div-comment-275683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275683">
			May 12, 2005 at 1:53 pm</a>		</div>

		<p>Why was the corporate network hell?</p>
<p>Because there was more traffic going over the corporate network than in any other network that anyone had ever seen.</p>
<p>Vendors would regularly show up at Microsoft to pitch their newest coolest hardware solutions.  And we&#8217;d put them on the corporate network and watch the vendors solution collapse under the traffic.  There were very few vendors who had systems that could handle the load.</p>
<p>A large part of the issue was that at the time, a large part of the network traffic was NetBEUI, which requires broadcasts for name resolution (it&#8217;s a non routable protocol).</p>
<p>As a result, there was a HUGE amount of broadcast traffic going out on the network</p>
<p>We&#8217;ve long since moved away from NetBEUI, but there is STILL an insane amount of traffic on our corporate network.  The Microsoft corporate network is one of the most complicated corporate networks in the world.</p>
<p>And it&#8217;s a remarkable tribute to the IT department that it just works.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275693">
				<div id="div-comment-275693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon for obvious reasons</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275693">
			May 12, 2005 at 2:05 pm</a>		</div>

		<p>I know some people who would say that it&#8217;s not just Microsoft&#8217;s <em>network</em> that&#8217;s 1.7 times worse than hell&#8230;  ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275703">
				<div id="div-comment-275703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">microbe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275703">
			May 12, 2005 at 2:10 pm</a>		</div>

		<p>: And it&#8217;s a remarkable tribute to the IT department that it just works. </p>
<p>I&#8217;m not sure about this. Your IT department might spend more time on lowering the traffic instead of making it &quot;work&quot; under heavy load. Is there still something else as stupid as NetBEUI?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-275713">
				<div id="div-comment-275713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275713">
			May 12, 2005 at 3:06 pm</a>		</div>

		<p>Microbe,<br />
<br />  Microsoft&#8217;s choice of NetBEUI (made in 1984, when DNS hadn&#8217;t been invented and TCP/IP name resolution was done with static host files) was the right decision AT THE TIME.</p>
<p>And it took a long time for that decision to go away.</p>
<p>At the time that the Microsoft network was first rolled out, NONE of the existing networking standards was capable of being deployed on a single network of the size of the Microsoft corporate network.  The only one that had a snowball&#8217;s chance was TCP/IP and it had massive managibility issues (static IP addresses, and hard coded host names).</p>
<p>We couldn&#8217;t deploy TCP/IP on the corporate network without DHCP and WINS (I&#8217;d like to see you try maintaining a network with more than 50,000 computers on it with static IP addresses), and DHCP didn&#8217;t come online until sometime around 1993 (and DHCP happened largely because Microsoft pushed it through the IETF).</p>
<p>It takes time to deploy these technologies, it wasn&#8217;t until NT 4.0 (around 1996, I believe) that we were able to remove NetBEUI as a transport on the network, it took that long to get all the pieces in place.</p>
<p>The Microsoft network&#8217;s still not much quieter &#8211; we&#8217;ve removed most of the stupid traffic, now it&#8217;s just dealing with the sheer size of the network.</p>
<p>There are currently significantly more than a quarter of a million computers on the Microsoft corporate network.</p>
<p>To my knowledge, there isn&#8217;t a larger private network in the world.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275723">
				<div id="div-comment-275723" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://getwired.blogspot.com' rel='external nofollow' class='url'>Wes Miller</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275723">
			May 12, 2005 at 3:43 pm</a>		</div>

		<p>&quot;I&#8217;m not sure about this. Your IT department might spend more time on lowering the traffic instead of making it &quot;work&quot; under heavy load.&quot;</p>
<p>For better or worse, there is no Ctrl+Z for infrastructure. Once you implement a technology in an infrastructure it&#8217;s hard to just &quot;make it go away&quot;. You have to find a viable replacement, implement it, and destroy all vestiges of the old plumbing. And with a company as dedicated to backwards compatibility as Microsoft, &quot;killing off&quot; infrastructure plumbing is &#8211; really &#8211; hard to do.</p>
<p>My $0.02</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275733">
				<div id="div-comment-275733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">andrew queisser</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275733">
			May 12, 2005 at 3:51 pm</a>		</div>

		<p>This seems odd to me too. It doesn&#8217;t seem hard at all to completely saturate an Ethernet network for the purpose of testing. Why didn&#8217;t Hell have a slider from 0-100%? When I was working on network protocol drivers I often caused broadcast storms accidentally and we also had defective network cards that would bring down the network.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275773">
				<div id="div-comment-275773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cheong</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275773">
			May 13, 2005 at 4:22 am</a>		</div>

		<p>Will you name some of the &quot;survivor&quot; network cards? We have one of the server&#8217;s network card in the datacenter becomes quite unstable and we&#8217;re considering replace it. If I can have that namelist of network cards we&#8217;ll seriously consider them for sure.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-larryosterman even thread-even depth-1" id="comment-275803">
				<div id="div-comment-275803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Larry+Osterman+%5BMSFT%5D' rel='external nofollow' class='url'>Larry Osterman [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275803">
			May 13, 2005 at 8:59 am</a>		</div>

		<p>Cheong, the cards that survived 9 years ago aren&#8217;t likely to be the best you can get today.</p>
<p>They were probably either isa or eisa cards back then &#8211; they don&#8217;t even plug into your computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275813">
				<div id="div-comment-275813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tim Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275813">
			May 13, 2005 at 9:01 am</a>		</div>

		<p>It depends on what you mean by saturation.  In an 802.3 network, 35% utilization is high traffic.  You start getting a lot of collisions.  Getting an 802.3 network to 100% utilization would be VERY hard.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-275863">
				<div id="div-comment-275863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/msdnwebcasts/archive/2005/05/13/417309.aspx' rel='external nofollow' class='url'>MSDN Webcasts Weblog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275863">
			May 13, 2005 at 2:49 pm</a>		</div>

		<p>Check out Raymond&#8217;s post on our corporate network here at Microsoft.<br />
<br />The Microsoft corporate network:&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-275923">
				<div id="div-comment-275923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">kbiel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-275923">
			May 13, 2005 at 6:48 pm</a>		</div>

		<p>Given the limited information in the article above, it would seem the diffence b/w the software Hell and the real thing, is one of collisions.  It sounds like Hell was pushing packets through, but putting it on a big network that was made of only routers, bridges and &lt;ugh&gt; hubs, considering it was 1996, brought a whole different stress test as the card(s) had to probably negotiate almost constant collisions.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-276553">
				<div id="div-comment-276553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20050512-48/?p=35653#comment-276553">
			May 17, 2005 at 8:05 pm</a>		</div>

		<p>Thursday, May 12, 2005 3:06 PM by LarryOsterman</p>
<p>&gt; At the time that the Microsoft network was<br />
<br />&gt; first rolled out, NONE of the existing<br />
<br />&gt; networking standards was capable of being<br />
<br />&gt; deployed on a single network of the size of<br />
<br />&gt; the Microsoft corporate network.</p>
<p>When you define DECnet as having been not a standard (just as Microsoft&#8217;s products aren&#8217;t standards) you can indeed say that.</p>
<p>&gt; (I&#8217;d like to see you try maintaining a<br />
<br />&gt; network with more than 50,000 computers on<br />
<br />&gt; it with static IP addresses), </p>
<p>Sort of like maintaining a network with more than 50,000 computers on it with static DECnet addresses?  Guess what, someone did it, and it worked for more than 10 years.  It&#8217;s really not that much different from having a registrar assign ranges of IP addresses (this company gets these 8 addresses, this company gets these 4, this ISP gets these 65536, this US company gets these 16777216 even though they&#8217;re never going to connect them to the internet, etc.).</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

