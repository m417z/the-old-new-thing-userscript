<html>
<head>
<title>How do I find all files with at least one space in their name?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I find all files with at least one space in their name?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>December 5, 2006 / year-entry #402</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>44</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">You already know how to do this, you just don't realize it. How do you find files with an "x" in their name? That's right, you use dir *x*. Now you just have to change that x to a space. And since spaces are command line delimiters, you need to quote the sequence so it...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
You already know how to do this,
you just don't realize it.
</p>
<p>
How do you find files with an "x" in their name?
That's right, you use <code>dir *x*</code>.
</p>
<p>
Now you just have to change that x to a space.
And since spaces are command line delimiters, you need to quote
the sequence so it gets treated as a single parameter
rather than two "*" parameters:
</p>
<pre>
dir "* *"
</pre>
<p>
Stick in a <code>/s</code> if you want to search recursively.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (44)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-449083">
				<div id="div-comment-449083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Reinder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449083">
			December 5, 2006 at 1:08 pm</a>		</div>

		<p>&lt;pedantic&gt;</p>
<p>All files? That only works on one logical volume. I expected something like</p>
<p>&nbsp; &nbsp;<a rel="nofollow" target="_new" href="http://www.google.com/search?q=inurl:%20" rel="nofollow">http://www.google.com/search?q=inurl:%20</a></p>
<p>as the better answer, but I can&#8217;t get that to work.</p>
<p>I also doubt that the answer given will list filenames with non-breaking spaces, Ethiopic wordspaces, etc. For that, Powershell may be your friend.</p>
<p>&lt;/pedantic&gt;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449153">
				<div id="div-comment-449153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sean</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449153">
			December 5, 2006 at 2:02 pm</a>		</div>

		<p>Spaces, schmaces&#8230; &nbsp;this tool is pretty nice:</p>
<p><a rel="nofollow" target="_new" href="http://www.bulkrenameutility.co.uk/Main_Intro.php" rel="nofollow">http://www.bulkrenameutility.co.uk/Main_Intro.php</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449173">
				<div id="div-comment-449173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">MJP</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449173">
			December 5, 2006 at 2:27 pm</a>		</div>

		<blockquote><p>
  What would really be nice is if Windows Explorer would give an option for a command prompt in the selected directory when right clicking a directory name.
</p></blockquote>
<p>If I understand you correctly: Apparently Vista does this if you shift+right click. For XP there&#8217;s a Powertoy at <a rel="nofollow" target="_new" href="http://www.microsoft.com/windowsxp/downloads/powertoys/xppowertoys.mspx" rel="nofollow">http://www.microsoft.com/windowsxp/downloads/powertoys/xppowertoys.mspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449183">
				<div id="div-comment-449183" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Thomas B. Passin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449183">
			December 5, 2006 at 2:40 pm</a>		</div>

		<p>David said</p>
<blockquote><p>
  What would really be nice is if Windows Explorer would give an option for a command prompt in the selected directory when right clicking a directory name.
</p></blockquote>
<p>I&#8217;ve been doing that for years, using the 4NT shell replacement. &nbsp;You might be able to do it with cmd too, but I&#8217;m not sure how. &nbsp;</p>
<p>You go into the registry and find or create &nbsp;the key HKEY_CLASSES_ROOTFoldershell. &nbsp;Add a key and name it, like &quot;Open shell here&quot;. &nbsp;Give this key a new subkey named &quot;command&quot; &nbsp;The contents of the key are to be a string containing the command you want to issue. &nbsp;Use &quot;%1&quot; for the path to the directory.</p>
<p>For 4NT, my command value is</p>
<p>D:4NT3014NT.EXE cdd &quot;%1&quot;</p>
<p>cdd means to change to the drive and directory specified. &nbsp;It&#8217;s something 4NT adds to the st of shell commands.</p>
<p>Even without this registry work, you can easily open a cmd session, then drag the directory from Explorer to the command line windiow. &nbsp;This will drop the full path to the directory into the command line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449333">
				<div id="div-comment-449333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Glenn</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449333">
			December 5, 2006 at 5:46 pm</a>		</div>

		<p>And&#8230; how to find AND rename OR delete files created by Windows when it runs into same named files where the resulting filename looks like:</p>
<p>filename(1).jpg</p>
<p>That one is kicking my butt, even with BRU mentioned above.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449343">
				<div id="div-comment-449343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Bill</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449343">
			December 5, 2006 at 6:01 pm</a>		</div>

		<p>Ahh, I hate that filename(1).jpg renaming task too, mostly because XP uses such a braindead scheme when renaming a group of files. &nbsp;Microsoft finally adds a feature I&#8217;ve been craving and it&#8217;s implemented so dumb as to be worthless.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449383">
				<div id="div-comment-449383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Andy C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449383">
			December 5, 2006 at 7:27 pm</a>		</div>

		<p>The filename(1).jpg thing is easily solved in PowerShell. If you can cope with the deployment and don&#8217;t have to interoperate with legacy scripts (before Raymond points those out) it really does make life a lot easier.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449403">
				<div id="div-comment-449403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">vsz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449403">
			December 5, 2006 at 7:47 pm</a>		</div>

		<p>Another tool which can be very handy is Oscar&#8217;s File Renamer. You can edit a directory like a text editor, search and replace, etc. It&#8217;s also fully free: <a rel="nofollow" target="_new" href="http://www.mediachance.com/free/renamer.htm" rel="nofollow">http://www.mediachance.com/free/renamer.htm</a> (the .exe can be copied anywhere and run standalone)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449023">
				<div id="div-comment-449023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.morganalley.com' rel='external nofollow' class='url'>Dewi Morgan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449023">
			December 5, 2006 at 11:54 am</a>		</div>

		<p>In Windows, you have to quote, since backslashes don&#8217;t escape (unless there&#8217;s some other escape char?). Unix can use * * instead.</p>
<p>But, how do you rename all filenames with spaces to use underscores instead?</p>
<p>In bash, the following works:</p>
<p>for file in * *;do echo mv &#8216;$file&#8217; ${file// /_};done</p>
<p>But I can&#8217;t find an equally elegant way in cmd. Even the normally-rather-cool &quot;ren&quot; command, which makes many things far easier than they&#8217;d be in unix, seems to fail me.</p>
<p>This works to change any files with an initial space (counterintuitively for anyone who is used to unix&#8217; pre-expansion of wildcards): </p>
<p>ren &quot; *.*&quot; _*.*</p>
<p>renames all files like &quot; test.txt&quot; to &quot;_test.txt&quot;.</p>
<p>But the following doesn&#8217;t do what one might na&#239;vely expect from that:</p>
<p> &nbsp;ren &quot;* *.*&quot; *_*.* </p>
<p>This renames &quot;a test.txt&quot; to &quot;a test.txt_&quot;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449053">
				<div id="div-comment-449053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colin Bendell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449053">
			December 5, 2006 at 12:15 pm</a>		</div>

		<p>That&#8217;s what I thought back in Dos 3.3 when I tried to &quot;del *temp.*&quot;. Unfortunately Dos 3.3 wasn&#8217;t that smart and just interpreted the command as &quot;del *.*&quot;! We all know the end of that story.</p>
<p>Ever since then I&#8217;ve been leery of prefixing any &#8216;del&#8217; command with &#8216;*&#8217;!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449063">
				<div id="div-comment-449063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449063">
			December 5, 2006 at 12:35 pm</a>		</div>

		<p>Windows uses smarter wildcards. &nbsp;You can test it by using DIR with wildcards to see what files match:</p>
<p>C:Documents and SettingsThe MAZZTer&gt;dir *scp.*</p>
<p> Volume in drive C is Windows XP</p>
<p> Volume Serial Number is DEAD-BEEF</p>
<p> Directory of C:Documents and SettingsThe MAZZTer</p>
<p>12/04/2006 &nbsp;07:26 PM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 600 winscp.RND</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 File(s) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;600 bytes</p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Dir(s) &nbsp; 7,130,140,672 bytes free</p>
<p>Renaming files using wildcards usually does not give the expected results. &nbsp;I prefer to use this tool:</p>
<p><a rel="nofollow" target="_new" href="http://www.codeproject.com/shell/shswapl.asp" rel="nofollow">http://www.codeproject.com/shell/shswapl.asp</a></p>
<p>Which gives me far greater control, of course you need to know regex to use it&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-ryanbemrose odd alt thread-odd thread-alt depth-1" id="comment-449073">
				<div id="div-comment-449073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ryan+Bemrose' rel='external nofollow' class='url'>Ryan Bemrose</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449073">
			December 5, 2006 at 1:08 pm</a>		</div>

		<p>&gt; But, how do you rename all filenames with spaces to use underscores instead?</p>
<p>for /f &quot;tokens=1,2-99 delims=_&quot; %a in (&#8216;dir /s /b &quot;*_*&quot;&#8217;) do ren &quot;%a_%b&quot; &quot;%a %b&quot;</p>
<p>This only replaces the first underscore in each file, but you can run it several times&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449113">
				<div id="div-comment-449113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">marlinj</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449113">
			December 5, 2006 at 1:54 pm</a>		</div>

		<p>So would it be overly picky to point out that RyanBernrose misinterpretted the problem and ends up changing underscores to spaces instead of vis versa? &nbsp;Or maybe I just shouldn&#8217;t have dawdled so much while coming up with &nbsp;very nearly the same thing.</p>
<p>for /f &quot;tokens=1,2&quot; %a in (&#8216;dir /b &quot;* *&quot;&#8217;) do ren &quot;%a %b&quot; %a_%b</p>
<p>Good for all filenames containing one space in the current directory where the filename doesn&#8217;t start with that one space. &nbsp;Doing all files on a drive or down a directory branch would be a trivial change to the above. &nbsp;Dealing with leading spaces, multiple spaces, and/or multiple drives would be more work and probably be a batch file instead of a single line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449123">
				<div id="div-comment-449123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449123">
			December 5, 2006 at 1:55 pm</a>		</div>

		<p>What would really be nice is if Windows Explorer would give an option for a command prompt in the selected directory when right clicking a directory name.</p>
<p>Option 2 would be for Windows Explorer to have the option to apply a filter like {dir &quot;* *&quot;} and only list those files.</p>
<p>Is there any way to do that already?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449243">
				<div id="div-comment-449243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dan McCarty</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449243">
			December 5, 2006 at 4:15 pm</a>		</div>

		<p>For what it&#8217;s worth</p>
<p> &nbsp; &nbsp; dir *&quot; &quot;*</p>
<p>also seems to work.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449473">
				<div id="div-comment-449473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449473">
			December 6, 2006 at 12:46 am</a>		</div>

		<p>cmd /V:ON /C for %I in (*) do @(set N=&quot;%I&quot;^&amp;ren !N! !N: =_!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449523">
				<div id="div-comment-449523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">untrustworthy computing</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449523">
			December 6, 2006 at 3:29 am</a>		</div>

		<p>dir *.</p>
<p>does list entries without any dots. Don&#8217;t trust this for one second.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449573">
				<div id="div-comment-449573" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449573">
			December 6, 2006 at 7:07 am</a>		</div>

		<p>dir *.</p>
<p>means &quot;no extension&quot;, the part after the dot is empty. Know thy enemy!</p>
<p>@ryan bemrose:</p>
<p>using the output of &quot;dir&quot; in a for statement is NOT good, especially when combined with /s.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449483">
				<div id="div-comment-449483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mark Steward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449483">
			December 6, 2006 at 12:47 am</a>		</div>

		<p>RyanBemrose:</p>
<p>cmd /v:on /c &quot;for %a in (&quot;* *&quot;) do @set a=%a&amp;ren &quot;%a&quot; &quot;!a: =_!&quot;&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449613">
				<div id="div-comment-449613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449613">
			December 6, 2006 at 9:09 am</a>		</div>

		<p>How do you list all files that end in a dot then?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449803">
				<div id="div-comment-449803" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449803">
			December 6, 2006 at 11:27 am</a>		</div>

		<p>Adam: filenames can&#8217;t end with a dot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-449833">
				<div id="div-comment-449833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449833">
			December 6, 2006 at 11:33 am</a>		</div>

		<blockquote><p>
  How do you list all files that end in a dot then?
</p></blockquote>
<p>I should point out that filenames that end in a dot are not legal in Windows.</p>
<p>Try the following:</p>
<p>echo test &gt; test</p>
<p>echo test &gt; test.</p>
<p>echo test &gt; test..</p>
<p>echo test &gt; test&#8230;</p>
<p>etc.</p>
<p>The &quot;change spaces to underscores&quot; problem is interesting. &nbsp;Hadn&#8217;t seen the %var:a=b% trick before. &nbsp;But what do you do if a particular directory contains both &quot;a b.txt&quot; and &quot;a_b.txt&quot;?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449583">
				<div id="div-comment-449583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-449583">
			December 6, 2006 at 7:31 am</a>		</div>

		<p>&gt; dir *.</p>
<p>&gt; does list entries without any dots. Don&#8217;t trust this for one second.</p>
<p>I believe that&#8217;s because files with no extension always have an implied (or hidden?) dot separator as part of their legacy &quot;8dot3&quot; filename.</p>
<p>What dir *. actually gives you is a list of all files that have no file extension.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-450273">
				<div id="div-comment-450273" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://levicki.blogspot.com/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-450273">
			December 6, 2006 at 9:08 pm</a>		</div>

		<p>Everyone craving for filters, renaming and fatures Explorer is missing check out Directory Opus:</p>
<p><a rel="nofollow" target="_new" href="http://www.gpsoft.com.au/" rel="nofollow">http://www.gpsoft.com.au/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-450373">
				<div id="div-comment-450373" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-450373">
			December 7, 2006 at 3:33 am</a>		</div>

		<p>Wednesday, December 06, 2006 11:33 AM by Maurits</p>
<blockquote><p>
  I should point out that filenames that end in</p>
<p>  a dot are not legal in Windows.
</p></blockquote>
<p>I should point out that different parts of Windows have different laws.</p>
<p>echo test &gt; \?C:test.</p>
<p>Then you can delete it using del but you can&#8217;t delete it using Windows Explorer.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-450413">
				<div id="div-comment-450413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-450413">
			December 7, 2006 at 8:14 am</a>		</div>

		<p>Norman:</p>
<p>how do you use &quot;\?&lt;something&gt;&quot; on Windows 9x/ME?-)</p>
<p>I interpret &quot;Windows&quot; on first sight here &quot;as in Win32API&quot;. I&#8217;m quite sure that in the POSIX or the Interix subsystem (SFU) trailing dots are allowed too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-451233">
				<div id="div-comment-451233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-451233">
			December 7, 2006 at 8:45 pm</a>		</div>

		<p>Thursday, December 07, 2006 8:14 AM by Stefan Kanthak</p>
<p>&gt; I&#8217;m quite sure that in the POSIX or the</p>
<p>&gt; Interix subsystem (SFU) trailing dots are</p>
<p>&gt; allowed too.</p>
<p>You&#8217;re right. &nbsp;&#8220;touch d.&#8221; made a file that Windows Explorer couldn&#8217;t delete.</p>
<p>I wonder what happens if a samba client creates such a file in a share on a Windows 98 machine.</p>
<div class=post>[<i>Windows 98 doesn&#8217;t have a POSIX layer. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451533">
				<div id="div-comment-451533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Neil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-451533">
			December 8, 2006 at 10:47 am</a>		</div>

		<p>Stefan Kanthak wrote:</p>
<blockquote><p>
  using the output of &quot;dir&quot; in a for statement is NOT good, especially when combined with /s.
</p></blockquote>
<p>He did in fact also combine it with /b although that depends on none of his directories containing spaces, otherwise you get</p>
<p>ren &quot;Documents and Settings&quot; &quot;Documents_and Settings&quot;</p>
<p>ren &quot;Documents and SettingsAll Users&quot; &quot;Documents_and SettingsAll Users&quot;</p>
<p>etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-451693">
				<div id="div-comment-451693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-451693">
			December 8, 2006 at 3:18 pm</a>		</div>

		<p>Neil:</p>
<p>/S is a typo, I intended to write /B.</p>
<p>In fact the &quot;dir&quot; builtin is weird: when using /B/S together it lists the complete pathname(s), /S without /B but lists directory for directory.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451913">
				<div id="div-comment-451913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">back to VB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-451913">
			December 9, 2006 at 6:28 pm</a>		</div>

		<p>&gt; Windows 98 doesn&#8217;t have a POSIX layer</p>
<p>Vista doesn&#8217;t.</p>
<div class=post>[<i>What I meant was that Windows 98 doesn&#8217;t have a file system that supports Posix semantics. I sort of assumed people would figure that out from context. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452023">
				<div id="div-comment-452023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452023">
			December 10, 2006 at 9:45 pm</a>		</div>

		<p>Thursday, December 07, 2006 8:45 PM by Norman Diamond </p>
<p>&gt; &#8220;touch d.&#8221; made a file that Windows Explorer</p>
<p>&gt; couldn&#8217;t delete.</p>
<p>To clarify, that was executed by Windows Services for Unix on a Windows XP Pro machine.</p>
<p>&gt; I wonder what happens if a samba client</p>
<p>&gt; creates such a file in a share on a Windows</p>
<p>&gt; 98 machine.</p>
<p>To clarify, that would be when a Windows 98 machine serves a file share to the network, and the samba client would be on a Unix machine.</p>
<p>&gt; [Windows 98 doesn&#8217;t have a POSIX layer.</p>
<p>&gt; -Raymond]</p>
<p>Windows 98 doesn&#8217;t need a POSIX layer in order to serve a file share. &nbsp;I was wondering what would happen when the client creates such a file in the share. &nbsp;I would expect that Windows 98 would be completely unable to delete the resulting file.</p>
<p>Similar effects can be accomplished even with a Windows 98 German client creating a file in a share hosted by a Windows 98 Japanese machine. &nbsp;Maybe also by a Japanese client and a US-English host. &nbsp;Sometimes even Windows 98 Scandisk couldn&#8217;t rename a file to a deleteable filename.</p>
<p>(I can&#8217;t bring myself to type &#8220;Windows 98 servvvvvvvvvvvvvvvvvvvvv&#8221;, argh.)</p>
<div class=post>[<i>Windows 98 would create the file without a trailing dot since its file system is FAT, not NTFS. FAT doesn&#8217;t have POSIX support. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-452053">
				<div id="div-comment-452053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452053">
			December 11, 2006 at 5:13 am</a>		</div>

		<p>&gt; Thank you for conveniently ignoring my</p>
<p>&gt; previous response. -Raymond</p>
<p>Do you mean the following, or do you mean something else?</p>
<p>Monday, December 11, 2006 3:03 AM by Norman Diamond</p>
<p>[Raymond Chen:]</p>
<p>&gt;&gt; Windows 98 would create the file without a</p>
<p>&gt;&gt; trailing dot since its file system is FAT,</p>
<p>&gt;&gt; not NTFS.</p>
<p>&gt;</p>
<p>&gt; Then the same thing should happen when</p>
<p>&gt; Windows 2000 tries to create the same file on</p>
<p>&gt; a FAT volume using:</p>
<p>&gt; echo test &gt; \?C:test.</p>
<p>&gt; I have two computers with that configuration</p>
<p>&gt; and now have to remember to test it.</p>
<p>The reason I think of testing it is that Posix semantics aren&#8217;t the<br />
only way to get a trailing dot in a filename. &nbsp;For example if a<br />
samba client uses Windows semantics then it&#8217;s not using Posix semantics<br />
(even if one or both machines might provide Posix semantics to other<br />
users).</p>
<p>For that matter I also ought to try it with an actual Windows 98<br />
host and a samba client. &nbsp;I understand your statement that the<br />
filename would be created without a dot, but I still have a nagging<br />
doubt.</p>
<p>If your complaint means there was some other previous response of yours that I conveniently ignored, please point me to it.</p>
<div class="post">[<i>&#8220;What I meant was that Windows 98 doesn&#8217;t have a<br />
file system that supports Posix semantics.&#8221; Windows 98 can&#8217;t even spell<br />
&#8220;POSIX&#8221;. Its file system driver follows Win32 semantics, not NT<br />
semantics. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452083">
				<div id="div-comment-452083" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452083">
			December 11, 2006 at 9:17 am</a>		</div>

		<p>Trying to use Unicode characters in a folder shared from Windows 98, either silently replaces those characters with similar-looking ANSI characters, or fails completely. Trying to use \?X:dot. trick on a drive mapped from Windows 98 fails.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-452043">
				<div id="div-comment-452043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452043">
			December 11, 2006 at 3:03 am</a>		</div>

		<p>&gt; Windows 98 would create the file without a</p>
<p>&gt; trailing dot since its file system is FAT,</p>
<p>&gt; not NTFS.</p>
<p>Then the same thing should happen when Windows 2000 tries to create the same file on a FAT volume using:</p>
<p>echo test &gt; \?C:test.</p>
<p>I have two computers with that configuration and now have to remember to test it.</p>
<p>Saturday, December 09, 2006 6:28 PM by back to VB</p>
<p>[Raymond Chen:]</p>
<p>&gt;&gt; Windows 98 doesn&#8217;t have a POSIX layer</p>
<p>&gt;</p>
<p>&gt; Vista doesn&#8217;t.</p>
<p>Vista does and doesn&#8217;t.</p>
<p><a href="http://www.microsoft.com/windowsvista/getready/editions/enterprise.mspx" target="_new" rel="nofollow">http://www.microsoft.com/windowsvista/getready/editions/enterprise.mspx</a></p>
<p>* &nbsp;Additionally, Windows Vista Enterprise</p>
<p>* &nbsp;includes Subsystem for UNIX-based</p>
<p>* &nbsp;Applications (SUA), which enables you to run</p>
<p>* &nbsp;UNIX applications unchanged on a Windows</p>
<p>* &nbsp;Vista Enterprise-based PC.</p>
<p>[&#8230;]</p>
<p>* &nbsp;The Windows Vista Enterprise edition is only</p>
<p>* &nbsp;available to Microsoft Volume License</p>
<p>* &nbsp;customers, it is not available for retail</p>
<p>* &nbsp;purchase.</p>
<p><a href="http://www.microsoft.com/downloads/details.aspx?familyid=93FF2201-325E-487F-A398-EFDE5758C47F&amp;displaylang=en" target="_new" rel="nofollow">http://www.microsoft.com/downloads/details.aspx?familyid=93FF2201-325E-487F-A398-EFDE5758C47F&#038;displaylang=en</a></p>
<p>* &nbsp;Utilities and SDK for UNIX-Based</p>
<p>* &nbsp;Applications is an add-on to the Subsystem</p>
<p>* &nbsp;for UNIX-Based Applications (referred to as</p>
<p>* &nbsp;SUA, hence forth) component that shipped in</p>
<p>* &nbsp;Microsoft Windows Vista RC1 / Longhorn</p>
<p>* &nbsp;Server IDS_C release.</p>
<p>By the way the latter page crashes Internet Explorer 7. &nbsp;I tried twice to send myself a link to that page, and both times Internet Explorer closed 4 windows (this window and 3 other victims) and didn&#8217;t offer to send its crash dump to Microsoft. &nbsp;Using the mouse to copy and paste I could send myself a link, but still couldn&#8217;t fix the latest and greatest IE.</p>
<div class="post">[<i>Thank you for conveniently ignoring my previous response. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452163">
				<div id="div-comment-452163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">KJK::Hyperion</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452163">
			December 11, 2006 at 1:40 pm</a>		</div>

		<p>Dewi Morgan: in Windows, the escape character is &quot;^&quot;, altough due to how the command line is parsed, it doesn&#8217;t work perfectly with characters like &quot;%&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-452203">
				<div id="div-comment-452203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452203">
			December 11, 2006 at 8:37 pm</a>		</div>

		<p>&gt; What I meant was that Windows 98 doesn&#8217;t have</p>
<p>&gt; a file system that supports Posix semantics.</p>
<p>OK, I believe that, but I think that is irrelevant.</p>
<p>Back to this:</p>
<p>&gt; Windows 98 would create the file without a</p>
<p>&gt; trailing dot since its file system is FAT,</p>
<p>&gt; not NTFS.</p>
<p>I doubt that for two reasons.</p>
<p>(1) &nbsp;If FAT were incapable of storing a filename that ends with a dot, then on a computer where I tried it this morning, the FAT32 C partition wouldn&#8217;t contain a file named &#8220;a.&#8221; (without the quotes but with the dot, two single-byte Italian characters long). &nbsp;The echo command in Windows 2000 MSDN-English created the file. &nbsp;Windows Explorer in Windows 2000 MSDN-English cannot delete the file.</p>
<p>(As it happens Windows 98 Japanese is installed on C but it wasn&#8217;t running. &nbsp;The running Windows 2000 is installed on K. &nbsp;boot.ini and related stuff are on C.)</p>
<p>(2) &nbsp;If Windows 98 had been running then we already know that disk shares operate at a lower level than Windows 98&#8217;s Win32 semantics. &nbsp;This is exactly how a Windows 98 German client can create a file in a share which the Windows 98 Japanese host can&#8217;t delete (and even Scandisk can&#8217;t rename it to a deletable filename). &nbsp;I haven&#8217;t tested this yet with Windows 98 running on the host and a Windows XP client running an echo command to create the thing in the share, but I see that ender did.</p>
<p>&gt; FAT doesn&#8217;t have POSIX support.</p>
<p>I think it&#8217;s clear by now that that&#8217;s completely irrelevant.</p>
<p>Monday, December 11, 2006 9:17 AM by ender</p>
<p>&gt; Trying to use Unicode characters in a folder</p>
<p>&gt; shared from Windows 98, either silently</p>
<p>&gt; replaces those characters with similar-</p>
<p>&gt; looking ANSI characters, or fails completely.</p>
<p>What OS was your client running? &nbsp;When I had two different language versions of Windows 98, the filename was chosen in ANSI by the client and the host simply obeyed. &nbsp;FAT32 (and FAT16 with long filenames) does store filenames in Unicode in addition to storing short names in ANSI. &nbsp;Characters which were unsupported on the host did not get changed to similar-looking characters in the host&#8217;s ANSI code page, they remained as they were set by the client in the client&#8217;s ANSI code page. &nbsp;Whether or not the host could access files stored on itself, this did not fail for the client, the client could still access the files.</p>
<p>Things got a lot more confused when the host was running Windows 98 Japanese and the client was running Windows 2000 MSDN-English. &nbsp;Windows 2000 MSDN-English properly displayed filenames written in Japanese on its own hard drives but garbaged up filenames written in Japanese on the share on the networked host. &nbsp;The contents of the files were retrieved correctly, only the names were garbaged up and only when viewed on the client. &nbsp;I might have time some weekend to reconstruct and test this networked environment.</p>
<p>&gt; Trying to use \?X:dot. trick on a drive</p>
<p>&gt; mapped from Windows 98 fails.</p>
<p>Thank you for this report. &nbsp;May I ask again what OS your client was running.</p>
<div class=post>[<i>Let me try again. Windows 98 supports only Win32 file names. Your &#8220;a.&#8221; file was created by bypassing the Win32 layer and using the NT layer or POSIX layer. There is no such layer on Win98 so the &#8220;side door&#8221; doesn&#8217;t exist. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452283">
				<div id="div-comment-452283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452283">
			December 11, 2006 at 11:45 pm</a>		</div>

		<p>&gt; Let me try again. Windows 98 supports only</p>
<p>&gt; Win32 file names.</p>
<p>OK, we&#8217;re part way there. &nbsp;There is no longer an assertion about FAT not supporting some part of this. &nbsp;Some layer in Windows 98 supports only Win32 file names. &nbsp;The only remaining doubt now involves which layer that is.</p>
<p>&gt; Your &#8220;a.&#8221; file was created by bypassing the</p>
<p>&gt; Win32 layer and using the NT layer or POSIX</p>
<p>&gt; layer.</p>
<p>Right, it was the NT layer in Windows 2000.</p>
<p>&gt; There is no such layer on Win98 so the &#8220;side</p>
<p>&gt; door&#8221; doesn&#8217;t exist.</p>
<p>There is no NT layer on Win98 so that particular side door doesn&#8217;t exist. &nbsp;However, Win98 does provide other side doors, that is how a Win98 client can create a file in a share on a Win98 host which the host can&#8217;t delete. &nbsp;The host enforces its code page at the Win32 level on programs running locally but it does not enforce its code page on network clients. &nbsp;The client&#8217;s code page rules.</p>
<p>ender tested the Win98 sharing layer and couldn&#8217;t create a filename ending in a dot, but the reason still isn&#8217;t clear.</p>
<p>Hmm, I can test this under Virtual PC, if I can get my keyboard to work long enough in guest PCs&#8230; &nbsp;You&#8217;re right, the filename gets created without the trailing dot. &nbsp;The host can delete the file in this case.</p>
<p>Let&#8217;s try it again with a Windows 98 US host and a Windows XP Japanese client&#8230; &nbsp;Hmm, this looks like something that changed between Windows 98 first edition and second edition. &nbsp;I&#8217;m using Windows Explorer to rename a file in mapped drive Y:. &nbsp;I&#8217;m sure this is the first time I&#8217;ve seen an error message that translates roughly as &#8220;Folder Y: doesn&#8217;t exist. &nbsp;Create?&#8221; and if I answer yes then the same error comes up again.</p>
<div class="post">[<i>Here&#8217;s the diagram I was hoping you could figure out from my hints.</p>
<pre>Windows 98<br /><br />+-----+  +---------+<br />| SMB |  |Win32 app|<br />+-----+  +---------+<br />   |         |<br />   v         v<br />   +-----------+<br />   | FS(Win32) |<br />   +-----------+<br /></pre>
<p>The file system driver on Windows 98 is the one that enforces Win32 semantics.<br />
Whether the file name came in through the SMB redirector or via<br />
an application running on the local machine, the result in<br />
the file system follows Win32 rules.<br />
On the other hand, Windows NT supports multiple file naming conventions, so the semantics are enforced at a higher level:</p>
<pre>Windows NT<br /><br />         +---------+ +---------+<br />         |Win32 app| |POSIX app|<br />         +---------+ +---------+<br />+-----+      |           |<br />| SMB |      v           v<br />+-----+  +---------+ +---------+<br />   |     |Win32    | |POSIX    |<br />   |     |   layer | |   layer |<br />   |     +---------+ +---------+<br />   |         |           |<br />   v         v           v<br />+----------------------------+<br />|            FS(NT)          |<br />+----------------------------+<br /></pre>
<p>The underlying file system uses NT semantics and layers are used to enforce semantics as appropriate to the layer. The trailing dot is stripped off by the Win32 layer. On Windows NT, the Win32 layer is an explicit layer. On Windows 98, the Win32 layer is baked into the file system. I don&#8217;t know why I let you hijack threads like this. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-452303">
				<div id="div-comment-452303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Melvin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452303">
			December 12, 2006 at 1:45 am</a>		</div>

		<blockquote><p>
  What would really be nice is if Windows</p>
<p>  Explorer would give an option for a</p>
<p>  command prompt in the selected directory</p>
<p>  when right clicking a directory name.
</p></blockquote>
<p>The &quot;Command prompt here&quot; power toy gives this capability.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452333">
				<div id="div-comment-452333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452333">
			December 12, 2006 at 3:14 am</a>		</div>

		<p>&gt; Here&#8217;s the diagram I was hoping you could</p>
<p>&gt; figure out from my hints. </p>
<p>Your diagram matches your hints but does not match my experience.</p>
<p>&gt; On Windows 98, the Win32 layer is baked into</p>
<p>&gt; the file system.</p>
<p>It still doesn&#8217;t match my experience.</p>
<p>&gt; I don&#8217;t know why I let you hijack threads</p>
<p>&gt; like this.</p>
<p>From these:</p>
<p>Wednesday, December 06, 2006 11:27 AM by Stefan Kanthak </p>
<p>&gt; Adam: filenames can&#8217;t end with a dot.</p>
<p>Wednesday, December 06, 2006 11:33 AM by Maurits </p>
<p>&gt; I should point out that filenames that end in</p>
<p>&gt; a dot are not legal in Windows.</p>
<p>Evolution isn&#8217;t always intentionally designed.</p>
<div class="post">[<i>I&#8217;ve seen the code. The Win32 normalization is in the filesystem on Windows&nbsp;98. Maybe there&#8217;s a bug in the normalization but that doesn&#8217;t deny the design. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-452343">
				<div id="div-comment-452343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452343">
			December 12, 2006 at 5:33 am</a>		</div>

		<p>Norman: my client was Windows XP sp2, host was Windows 98SE Slovenian running in a VMWare image.</p>
<p>Trying the echo foo &gt; \?M:bar. trick on a FAT32 volume in Windows XP creates a file, but it&#8217;s without the trailing dot.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452383">
				<div id="div-comment-452383" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Stefan Kanthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452383">
			December 12, 2006 at 7:47 am</a>		</div>

		<blockquote><p>
  The &quot;Command prompt here&quot; power toy gives this capability.
</p></blockquote>
<ul>
<li>Try it on a directory you opened with \servershare. Ooops.</li>
<li>
<p>Try it on the root of a drive where you copied say NOTEPAD.EXE as CMD.EXE before (substitute EDIT.COM as COMMAND.COM for Wintendo). Ooops.</p>
</li>
<li>
<p>Try it on a &quot;real&quot; (say: virtual) shell folder. Ooops.</p>
</li>
</ul>
<p>With the last I&#8217;m not completely sure whether the &quot;original&quot; PowerToys only placed an (incorrect) entry beneath HKCRFolder or the two correct entries beneath HKCRDrive and HKCRDirectory.</p>
<p>For the other two: REG_EXPAND_SZ &quot;%ComSpec%&quot; /K PushD &quot;%L&quot; works perfect (except on Wintendo).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits odd alt thread-odd thread-alt depth-1" id="comment-452503">
				<div id="div-comment-452503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452503">
			December 12, 2006 at 3:08 pm</a>		</div>

		<p>This is kind of fun, too&#8230;</p>
<p>With no-one watching:</p>
<p>mkdir C:foo</p>
<p>echo.&gt;\?C:foocon</p>
<p>Now you have a geek test &#8211; bring people to your machine and see if they can delete the &quot;con&quot; file, either from Windows Explorer or from the command line.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-452703">
				<div id="div-comment-452703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-452703">
			December 12, 2006 at 9:28 pm</a>		</div>

		<p>Tuesday, December 12, 2006 7:47 AM by Stefan Kanthak</p>
<blockquote><p>
  substitute EDIT.COM as COMMAND.COM for Wintendo
</p></blockquote>
<p>Hey. &nbsp;Nintendo is a fine manufacturer of plastic playing cards. &nbsp;Nintendo was making plastic playing cards before computers were invented. &nbsp;Their plastic playing cards are a fine quality product and they last a good long time. &nbsp;Sure the company added a few side lines to their business but that&#8217;s no reason for abuse. &nbsp;Wii will not stand for it.</p>
<p>Tuesday, December 12, 2006 5:33 AM by ender</p>
<blockquote><p>
  Norman: my client was Windows XP sp2, host</p>
<p>  was Windows 98SE Slovenian running in a</p>
<p>  VMWare image.
</p></blockquote>
<p>Thank you. &nbsp;Your results match what I got with virtually networked guests under Virtual PC, and match what Mr. Chen said.</p>
<p>Raymond Chen:</p>
<blockquote><p>
  Maybe there&#8217;s a bug in the normalization but</p>
<p>  that doesn&#8217;t deny the design.
</p></blockquote>
<p>I agree.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-578143">
				<div id="div-comment-578143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/oldnewthing/archive/2007/12/17/6785519.aspx' rel='external nofollow' class='url'>MSDN Blog Postings &raquo; How did wildcards work in MS-DOS?</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20061205-00/?p=28833#comment-578143">
			December 17, 2007 at 11:23 am</a>		</div>

		<p>PingBack from <a href="http://blogs.msdn.com/oldnewthing/archive/2007/12/17/6785519.aspx" rel="nofollow">http://blogs.msdn.com/oldnewthing/archive/2007/12/17/6785519.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

