<html>
<head>
<title>The mystery of the stalker dental hygienist</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>The mystery of the stalker dental hygienist</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>March 22, 2018 / year-entry #67</td></tr>
<tr><td><b>Tags:</b></td><td>non-computer</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>17</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">Haven't I seen you before?</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>
Ony of my colleagues remarked that every time he
visits the dentist,
the hygienist seems to have stalker-level
knowledge of his life.
</p>
<p>
"How did your son do at the chess tournament?"
</p>
<p>
"Have you decided to do anything fun with your
brother's family when they come to visit?"
</p>
<p>
"Did your wife's performance go well?"
</p>
<p>
Eventually, he realized why the hygienist knew
so much about his life:
Because his wife's dentist schedule matches his,
but she goes in a month earlier.
</p>
<p>
The hygienist chats with his wife during her
visit,
which means that when he goes in
a few weeks later,
the hygienist asks follow-up questions.</p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (21)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1330295">
				<div id="div-comment-1330295" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330295">
			March 22, 2018 at 3:07 pm</a>		</div>

		<p>And he thought &#8220;oh, that&#8217;s a perfectly harmless explanation&#8221;. But a week later he knocked over a picture frame, and he found the hidden camera !</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-1330305">
				<div id="div-comment-1330305" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Don Reba</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330305">
			March 22, 2018 at 3:09 pm</a>		</div>

		<p>&#8220;Every time he visits&#8221; — I&#8217;m surprised he didn&#8217;t ask the first time it happened. Did he think it was just a good guess?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-2 parent" id="comment-1330385">
				<div id="div-comment-1330385" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330385">
			March 23, 2018 at 1:31 am</a>		</div>

		<p>&#8220;Er&#8230; that seems an awfully private question. May I inquire as to how you have such intimate knowledge of my private life?&#8221;</p>
<p>Or something like that?</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-bboorman odd alt depth-3 parent" id="comment-1330395">
				<div id="div-comment-1330395" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Brian_EE' rel='external nofollow' class='url'>Brian_EE</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330395">
			March 23, 2018 at 5:33 am</a>		</div>

		<p>I find that you don&#8217;t answer the hygienist at all. He/She always talks and ask questions while his/her fingers are shoved into your mouth.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-fleet-command even depth-4" id="comment-1330435">
				<div id="div-comment-1330435" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Fleet+Command' rel='external nofollow' class='url'>Fleet Command</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330435">
			March 23, 2018 at 7:55 am</a>		</div>

		<p>Yet the wife somehow managed to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-4" id="comment-1330445">
				<div id="div-comment-1330445" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330445">
			March 23, 2018 at 8:29 am</a>		</div>

		<p>I usually respond in ASL.</p>
<p>But it turns out most dental hygienists don&#8217;t know sign language&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-3" id="comment-1331115">
				<div id="div-comment-1331115" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Don Reba</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1331115">
			March 28, 2018 at 9:28 am</a>		</div>

		<p>— See, that barely hurt at all. And, by the way, how did your son do at that chess tournament?<br />
— Oh, hey, was your kid competing, too?<br />
— Haha, no, it&#8217;s just that your wife had her checkup here last month. She said little Garry had a shot at winning.</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1330315">
				<div id="div-comment-1330315" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ambarish</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330315">
			March 22, 2018 at 3:19 pm</a>		</div>

		<p>This sounds similar to the unfair subway problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-1330335">
				<div id="div-comment-1330335" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Simon Clarkstone</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330335">
			March 22, 2018 at 4:31 pm</a>		</div>

		<p>No, no, no; we can&#8217;t have non-technical posts on this blog. How about:</p>
<p>&#8212;</p>
<p>A colleague of mine had a long-running puzzle where DentalHygenistEx would pass to its callback function handles that it seems &#8220;impossible&#8221; for DentalHygenistEx to know about.  After some extended debugging, he hypothesised that the handles must be being passed into DentalHygenistEx somewhere else, and after resorting to the kernel debugger captured this stack trace (reconstructed from my best recollections):</p>
<p>  [extract from kernel debugger session]</p>
<p>But this process isn&#8217;t even running as the same user!  Is this a sign of information leaking between users?  What is this program and why is it passing our handles to DentalHygenistEx()?  The clue is in the penultimate stack frame, giving us the image name of WIFE64.EXE. Searching the MSDN documentation for Windows Familial Extensions (x64), we find the following:</p>
<p>  [MSDN excerpt]</p>
<p>Handles being sent between processes of different users under some circumstances is an intended part of Windows Familial Extensions.  But how is this magical information-tunelling performed?  Observe the following heap-layout table captured at the same time (again reconstructed from my best recollections):</p>
<p>  [table of addresses and DLL names]</p>
<p>The fifth item on the list is a shared memory area belonging to MARRIG32.DLL¹, the userland interface to NUPTUAL².  I haven&#8217;t been involved for more recent versions, but in the early days of Windows XP (when this story occured) MARRIG32.DLL used such shared-memory areas for communication within process-pairs and must obviously (from the documentation quoted above) send handles back and forth.</p>
<p>This is another case of a solution to a local problem (WIFE64.EXE needing new handles to send to DentalHygenistEx) being slightly more global than you expect but no more global than it is supposed to be.  As for the apparent security design flaws, they are an illusion: WIFE64.EXE is indeed running under a different user, but it is a user paired/unified with the current one and so is already on the wrong side of the air-tight hatchway.  DentalHygenistEx() understands NUPTUAL in its interpretation of ACLs and will not in general leak information between users.</p>
<p>Footnotes:</p>
<p>¹ According a different colleague, Windows 10 reporting finds that over 80% of processes load MARRIG32.DLL or one of its successors at some point during their lifetime.  I don&#8217;t remember the exact figure or which editions of Windows it applies to because it was from one conversation I had at lunch 2 years ago.  I didn&#8217;t expect it to be on the exam.</p>
<p>² The best explanation I kind find for this name is as a dyslexic acronym for NT User-Pairing And Unification Library.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-cheong odd alt depth-2" id="comment-1330345">
				<div id="div-comment-1330345" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/cheong00' rel='external nofollow' class='url'>cheong00</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330345">
			March 22, 2018 at 6:17 pm</a>		</div>

		<p>Talking about those Non-Computer post on this blog, I do miss &#8220;the wisdom of &#8212; graders&#8221; series.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2 parent" id="comment-1330365">
				<div id="div-comment-1330365" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Matteo Italia</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330365">
			March 23, 2018 at 12:02 am</a>		</div>

		<p>Nitpicker&#8217;s corner: of course NUPTUAL cannot just &#8220;send handles back and forth&#8221; &#8211; NT kernel handles are local to a process; some DuplicateHandle calls are involved. I cannot believe that I have to specify this, but apparently some commenters just aren&#8217;t happy if I don&#8217;t state the obvious each and every time.</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1330475">
				<div id="div-comment-1330475" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Yates</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330475">
			March 23, 2018 at 7:19 pm</a>		</div>

		<p>Cherry on top.<br />
It&#8217;s like we could conceivably train some AI bot to Raymondize a standard story to make it interesting for us interested in the history, with a blend of modern, Windows &amp; other IT</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1330375">
				<div id="div-comment-1330375" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">xtal256</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330375">
			March 23, 2018 at 12:36 am</a>		</div>

		<p>Raymond has frequently posted non-computer things on this blog, but your Windowization of his story was hillarious.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt depth-2" id="comment-1330405">
				<div id="div-comment-1330405" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">D-Coder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330405">
			March 23, 2018 at 6:34 am</a>		</div>

		<p>Bravo!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even depth-2" id="comment-1330465">
				<div id="div-comment-1330465" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330465">
			March 23, 2018 at 11:26 am</a>		</div>

		<p>Genius stuff!</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 parent" id="comment-1330355">
				<div id="div-comment-1330355" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Brian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330355">
			March 22, 2018 at 10:43 pm</a>		</div>

		<p>I&#8217;m reasonably sure the hygienists keep a portfolio of info about clients &#8211; while the specific one I see for a cleaning each six months may rotate, they always seem to recall details about my family and activities.  Either they employ multiple people with photographic memories, or they write down what they learn.</p>

		
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-oldnewthing bypostauthor even depth-2 parent" id="comment-1330495">
				<div id="div-comment-1330495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Raymond+Chen+-+MSFT' rel='external nofollow' class='url'>Raymond Chen - MSFT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330495">
			March 24, 2018 at 7:16 am</a>		</div>

		<p>The staff at my dentist make no secret about the fact that they keep a dossier on my personal life. They&#8217;ll occasionally say things like, &#8220;It says here that you went on a trip to &lt;place&gt;. How&#8217;d that go?&#8221;</p>

		
				</div>
		<ol class="children">
		<li class="comment odd alt depth-3" id="comment-1331175">
				<div id="div-comment-1331175" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">James Sutherland</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1331175">
			March 28, 2018 at 12:21 pm</a>		</div>

		<p>That sounds a bit creepy &#8211; why keep a file like that?! On the other hand, my late rich cousin used to be a regular at the Ritz hotel in London, which apparently did exactly the same, so regular guests could be &#8220;recognised&#8221; and greeted as someone they knew. (My dentist goes to the other extreme; I discovered last checkup, after being a patient there for 20 years, that they have me listed as female with the wrong date of birth. Apparently gender was a field added in a subsequent update, and they never bothered to correct mine from the default value since it doesn&#8217;t generally matter&#8230;)</p>
<p>My equivalent tale is talking to a &#8220;counter terrorism guy&#8221; from the federal government, on my first full day in TX. A few minutes into the conversation, he mentioned that one of the cleaning staff from my (British) high school had died earlier that year. That&#8217;s six time zones away, and *I* didn&#8217;t know that until then &#8211; prompting a few paranoid theories before he revealed that he used to work there himself. Small world.</p>
<p>(Five years later, I got a new job in the UK, in another city &#8211; then discovered a friend from TX had just taken a job in the next building. It really is a very small world in some ways!)</p>

		
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1330425">
				<div id="div-comment-1330425" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330425">
			March 23, 2018 at 7:40 am</a>		</div>

		<p>This exact thing has happened to me!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-1330675">
				<div id="div-comment-1330675" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1330675">
			March 26, 2018 at 10:51 am</a>		</div>

		<p>I guessed (wrongly) that the reveal was going to be that the hygienist followed clients and/or client family on social media sites, and made a point to check in on those connections for the day&#8217;s clients.  In other words, the hygienist *would* turn out to be a stalker of sorts.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-1331055">
				<div id="div-comment-1331055" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">lun</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20180322-01/?p=98305#comment-1331055">
			March 27, 2018 at 3:25 pm</a>		</div>

		<p>Does doctor-patient privilege not apply to dental hygienists?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

