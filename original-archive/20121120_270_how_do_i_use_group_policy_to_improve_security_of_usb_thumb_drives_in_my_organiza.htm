<html>
<head>
<title>How do I use group policy to improve security of USB thumb drives in my organization?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>How do I use group policy to improve security of USB thumb drives in my organization?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 20, 2012 / year-entry #271</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>15</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">A customer wanted to know how they could improve the security of USB thumb drives in their organization. Specifically, they wanted to block access to removable media devices (primarily USB thumb drives), but provide a list of exceptions for specific thumb drives. Fortunately, there's a whitepaper that covers exactly this topic and explains how to...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p> A customer wanted to know how they could improve the security of USB thumb drives in their organization. Specifically, they wanted to block access to removable media devices (primarily USB thumb drives), but provide a list of exceptions for specific thumb drives. Fortunately, there's a whitepaper that covers exactly this topic and explains how to set up your policies to accomplish this. </p>
<p> <a href="http://msdn.microsoft.com/en-us/library/bb530324.aspx"> Step-By-Step Guide to Controlling Device Installation Using Group Policy </a> </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (15)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-1021613">
				<div id="div-comment-1021613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/bombsoft_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>bombsoft@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021613">
			November 20, 2012 at 8:13 am</a>		</div>

		<p>I was at a talk at TVP in the run up to the EVO launch, and the MS guy that was talking about security said that the strongest defence you have against unathorised pen drives on the computer is epoxy resin.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021633">
				<div id="div-comment-1021633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joshua</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021633">
			November 20, 2012 at 8:15 am</a>		</div>

		<p>@Lockwood: Indeed. There was this attack not too long ago that involved scattering what looked like USB thumb drives. They turned out to be USB keyboards with a preset key sequence that boiled down to download and install this virus from the internet.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021643">
				<div id="div-comment-1021643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jeffrey Bosboom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021643">
			November 20, 2012 at 9:06 am</a>		</div>

		<p>Speaking of USB &quot;keyboards&quot; that type in something evil, Raymond&#39;s almost-experience with an external USB hard drive: <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/oldnewthing/archive/2009/11/09/9919504.aspx" rel="nofollow">blogs.msdn.com/&#8230;/9919504.aspx</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021653">
				<div id="div-comment-1021653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Christian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021653">
			November 20, 2012 at 9:37 am</a>		</div>

		<p>You can really buy usb drives that simulate keyboards? Does this really exist?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021663">
				<div id="div-comment-1021663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jake</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021663">
			November 20, 2012 at 9:56 am</a>		</div>

		<p>Christian, I think the implication is that these were custom-made and placed into thumb drive shells.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021673">
				<div id="div-comment-1021673" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">pcooper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021673">
			November 20, 2012 at 10:17 am</a>		</div>

		<p>Not only can you have a USB drive act as a keyboard, you can have a mouse that installs malware from an embedded USB drive:</p>
<p><a rel="nofollow" target="_new" href="http://www.theregister.co.uk/2011/06/27/mission_impossible_mouse_attack/" rel="nofollow">http://www.theregister.co.uk/&#8230;/mission_impossible_mouse_attack</a></p>
<p><a rel="nofollow" target="_new" href="http://pentest.snosoft.com/2011/06/24/netragards-hacker-interface-device-hid/" rel="nofollow">pentest.snosoft.com/&#8230;/netragards-hacker-interface-device-hid</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021683">
				<div id="div-comment-1021683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021683">
			November 20, 2012 at 11:18 am</a>		</div>

		<p>Yep, it&#39;s scary that a piece of hardware that looks like a mouse can actually act like a keyboard/mouse combination, or a flash drive, and something that looks like a flash drive can act like a mouse and/or keyboard.</p>
<p>If a company disallows use of USB flash drives by policy, that doesn&#39;t stop something that looks like a flash drive (or a mouse) but acts like a mouse/keyboard, from doing whatever it wants. &nbsp;It&#39;s as if the user&#39;s brain was taken over and forced to enter some evil commands.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021703">
				<div id="div-comment-1021703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Eric</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021703">
			November 20, 2012 at 1:17 pm</a>		</div>

		<p>Generally this is a waste of time and effort. The driver is to stop company data from leaving the organisation, but what about the DVD burner that they have in the laptop or desktop, or the access to webmail, or ftp sites. My personal experience with companies that tried to do this meant that all of their shiny new 3g USB devices they tried to plug in didn&#39;t work because as well as the 3g capabilities it also advertised itself as a virtual drive where the drivers were stored.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021713">
				<div id="div-comment-1021713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021713">
			November 20, 2012 at 2:16 pm</a>		</div>

		<p>@Eric: &quot;The driver is to stop company data from leaving the organisation&quot; &#8230; That&#39;s not the only reason companies disable flash drives; another important reason is to stop executables or viruses from being carried in on flash drives. &nbsp;The policy of disabling USB flash drives can be very effective for this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021773">
				<div id="div-comment-1021773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Engywuck</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021773">
			November 21, 2012 at 4:36 am</a>		</div>

		<p>@Christian: This year EMC distributed some magnets with EMC logo and USB connector. When used in a USB port it opened the EMC website in default browser.</p>
<p>So yes, these exist. Even as advertising.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021783">
				<div id="div-comment-1021783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/bombsoft_4000_hotmail.com/ProfileUrlRedirect.ashx' rel='external nofollow' class='url'>bombsoft@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021783">
			November 21, 2012 at 5:09 am</a>		</div>

		<p>@Engywuck</p>
<p>Was that just an autorun to the URL, amking it shell out in the default browser? Rather than a clever fake keyboard/mouse?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021983">
				<div id="div-comment-1021983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Asher</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021983">
			November 21, 2012 at 11:23 am</a>		</div>

		<p>I can imagine a company doing a promotion where they give out USB keys at a county fair. &nbsp;The USB keys have their logo on them. &nbsp;But the person giving out the keys doesn&#39;t represent the company and the USB keys do bad things to your computer. &nbsp;Ugh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021993">
				<div id="div-comment-1021993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rick C</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1021993">
			November 21, 2012 at 11:25 am</a>		</div>

		<p>Also, if you glue up the USB ports, you have to either make sure people aren&#39;t using USB peripherals such as real keyboards and mice, or else glue THOSE into the ports so nobody can remove them. &nbsp;Of course, if your glued-in USB keyboard dies you have a whole new problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1022063">
				<div id="div-comment-1022063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SimonRev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1022063">
			November 21, 2012 at 2:30 pm</a>		</div>

		<p>@Rick C: &nbsp;The simple solution to that is instead of gluing the keyboard in you just glue in a USB extension cable instead and plug the keyboard into that. . . (Actually, I bet someone somewhere has blindly followed corporate policy in that way before).</p>
<p>As far as data theft goes, the game of walls and ladders eventually gets ridiculous. &nbsp;Why not dump the data out your serial port. &nbsp;Or even encode the data as sound and shoot it out the line out (hello old school modems anyone?). &nbsp;</p>
<p>Heck, if I am patient enough, I could install a keyboard wedge between the PS/2 keyboard and the PC. &nbsp;The wedge can monitor the caps lock state. &nbsp;I can write a program that then programatically toggles the caps lock to covertly copy the data. (As a bonus it can serve as a nearly undetectible keylogger and I can harvest passwords as well).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022133">
				<div id="div-comment-1022133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ender</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20121120-01/?p=6043#comment-1022133">
			November 22, 2012 at 12:33 am</a>		</div>

		<p>@SimonRev: and what prevents the user from unplugging the keyboard from the extension cable and plugging in an USB hub then?</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

