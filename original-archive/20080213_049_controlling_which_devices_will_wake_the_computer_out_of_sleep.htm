<html>
<head>
<title>Controlling which devices will wake the computer out of sleep</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Controlling which devices will wake the computer out of sleep</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>February 13, 2008 / year-entry #50</td></tr>
<tr><td><b>Tags:</b></td><td>tipssupport</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>62</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">I haven't experienced this problem, but I know of people who have. They'll put their laptop into suspend or standby mode, and after a few seconds, the laptop will spontaneously wake itself up. Someone gave me this tip that might (might) help you figure out what is wrong. Open a command prompt and run the...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>I haven't experienced this problem, but I know of people who have. They'll put their laptop into suspend or standby mode, and after a few seconds, the laptop will spontaneously wake itself up. Someone gave me this tip that might (might) help you figure out what is wrong.</p>
<p> Open a command prompt and run the command </p>
<blockquote class="m"><p> powercfg -devicequery wake_from_any </p>
</blockquote>
<p> This lists all the hardware devices that are capable of waking up the computer from standby. But the operating system typically ignores most of them. To see the ones that are not being ignored, run the command </p>
<blockquote class="m"><p> powercfg -devicequery wake_armed </p>
</blockquote>
<p> This second list is typically much shorter. On my computer, it listed just the keyboard, the mouse, and the modem. (The modem? I never use that thing!) </p>
<p> You can disable each of these devices one by one until you find the one that is waking up the computer. </p>
<blockquote class="m"><p> powercfg -devicedisablewake "device name" </p>
</blockquote>
<p> (How is this different from unchecking <i>Allow this device to wake the computer</i> from the device properties in Device Manager? Beats me.) </p>
<p> Once you find the one that is causing problems, you can re-enable the others. </p>
<blockquote class="m"><p> powercfg -deviceenablewake "device name" </p>
</blockquote>
<p> I would start by disabling wake-up for the keyboard and mouse. Maybe the optical mouse is detecting tiny vibrations in your room. Or the device might simply be "chatty", generating activity even though you aren't touching it. </p>
<p> This may not solve your problem, but at least's something you can try. I've never actually tried it myself, so who knows whether it works. </p>
<p> <b>Exercise</b>: Count how many disclaimers there are in this article, and predict how many people will ignore them. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (62)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-600473">
				<div id="div-comment-600473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600473">
			February 13, 2008 at 10:20 am</a>		</div>

		<p>How about six? &nbsp;Do I get a cookie if I&#8217;m right?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600483">
				<div id="div-comment-600483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Joel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600483">
			February 13, 2008 at 10:20 am</a>		</div>

		<p>Thanks, I will try that out at home.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600493">
				<div id="div-comment-600493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rutger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600493">
			February 13, 2008 at 10:50 am</a>		</div>

		<p>I haven&#8217;t experienced this problem, &lt;- that&#8217;s one</p>
<p>might (might) &lt;- number 2 and 3</p>
<p>typically ignores &lt;- number 4 you might not be typical :)</p>
<p>typically much shoter &lt;- 5, it might even be longer ??? ;)</p>
<p>I would start by &lt;- 6</p>
<p>Maybe the optical &#8230; might simply be &lt;-7&amp;8</p>
<p>This may not solve your problem, but at least&#8217;s something you can try. I&#8217;ve never actually tried it myself, so who knows whether it works. &lt;- 9 (or counting each of them separately 9,10,11 and 12)</p>
<p>oh and for the ignore count I would say</p>
<p>300-(disclamercount*17.5) = :)</p>
<p>(okay I had my fun now prove me wrong :):) )</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600503">
				<div id="div-comment-600503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600503">
			February 13, 2008 at 11:24 am</a>		</div>

		<p>Behold the power of the command line! Your puny device manager check boxes cannot stop me!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600523">
				<div id="div-comment-600523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anonymous</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600523">
			February 13, 2008 at 12:03 pm</a>		</div>

		<p>Hm? This syntax doesn&#8217;t work here on Windows Server 2003, so I presume this is Vista-only (and therefore useless) stuff.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600533">
				<div id="div-comment-600533" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Niels</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600533">
			February 13, 2008 at 12:10 pm</a>		</div>

		<p>anonymous: Nope, it works just fine on my XP Pro SP2, but it might be specific for client systems. (Remember 2003 is really a server system.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-maurits even thread-even depth-1" id="comment-600543">
				<div id="div-comment-600543" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Maurits+%5BMSFT%5D' rel='external nofollow' class='url'>Maurits [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600543">
			February 13, 2008 at 12:22 pm</a>		</div>

		<blockquote><p>
  Vista-only (and therefore useless)
</p></blockquote>
<p>You&#8217;re missing a caveat or two there:</p>
<p>Vista-only (and therefore useless [except on Vista {and maybe future versions of Windows}])</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600553">
				<div id="div-comment-600553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Gordon Smith</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600553">
			February 13, 2008 at 12:28 pm</a>		</div>

		<p>anonymous: &nbsp;Hmmmm turning sleep mode on, on a server &#8211; smart&#8230;.</p>
<p>Make sure you have the screen saver setup with a nice heavy screensaver as well!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600563">
				<div id="div-comment-600563" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">SM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600563">
			February 13, 2008 at 12:32 pm</a>		</div>

		<p>Anonymous: You&#8217;re using a laptop as a server? &nbsp;And interested in the power management functions? &nbsp;Interesting setup.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600603">
				<div id="div-comment-600603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">asd</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600603">
			February 13, 2008 at 1:25 pm</a>		</div>

		<blockquote><p>
  &gt; anonymous: &nbsp;Hmmmm turning sleep mode on, on a server &#8211; smart&#8230;.
</p></blockquote>
<p>We use Win2003 on both laptops and workstation for many needs. No limits on open listening sockets, no stupidities on remote desktops, etc.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600613">
				<div id="div-comment-600613" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ethermal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600613">
			February 13, 2008 at 1:49 pm</a>		</div>

		<p>I&#8217;ve never been able to get a non laptop to wake from sleep using the power button. &nbsp;Is there something you have to do to get an ATX power switch to wake from sleep?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600623">
				<div id="div-comment-600623" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ERock</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600623">
			February 13, 2008 at 1:53 pm</a>		</div>

		<p>In defense of anonymous:</p>
<p>I personally would love to have an auto-sleep server that auto-wakes when I need it. That is, the network card wakes it up when it gets traffic directed to him (something a little less clutsy than &quot;magic packet&quot; in established WOL implementations.)</p>
<p>Microsoft is now pushing a home server product, aren&#8217;t they? I&#8217;d like to share photos and music across computers with a central repository and I wouldn&#8217;t mind waiting the 30 seconds for a computer to come out of standby compared to the power savings of the 22 hours a day of idling in a closet somewhere.</p>
<p>This post has encouraged me to do additional research. Thanks Raymond!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600633">
				<div id="div-comment-600633" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://ebersys.blogspot.com' rel='external nofollow' class='url'>Eber Irigoyen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600633">
			February 13, 2008 at 2:12 pm</a>		</div>

		<p>nice!, thanks for the tip, now I can fix my gf&#8230; eerr&#8230; wife computer =o)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600643">
				<div id="div-comment-600643" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jonathan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600643">
			February 13, 2008 at 3:06 pm</a>		</div>

		<p>These commands seem to work on my XP SP2 laptop. Also, I know many people who use Server 2003 on a laptop, since they need to develop on it (IIS6, etc). It&#8217;s not bad at all actually.</p>
<p>It would be nice if there was an event log saying &#8220;Windows waked up because of device X&#8221;.</p>
<div class=post>[<i>Oh, you mean <a href="http://blogs.technet.com/brad_rutkowski/archive/2007/04/18/what-variations-of-sleep-does-my-computer-support-and-why-did-it-wake-up.aspx" rel="nofollow">powercfg -lastwake</a>? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600653">
				<div id="div-comment-600653" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">CPM</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600653">
			February 13, 2008 at 4:55 pm</a>		</div>

		<p>ERock &#8211; my Dell has an Intel Pro/100 VE for which Intel provides a driver download that adds property pages to the network card configuration dialogs where you can enable &quot;Wake on Directed Packet&quot; in the Power Management tab. (Network Connections|Properties|Configure&#8230;|Power Management).</p>
<p>Confused me when my wife&#8217;s computer used to start up when I opened Windows Explorer and browsed my Network Connections :-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-dean-harding odd alt thread-odd thread-alt depth-1" id="comment-600663">
				<div id="div-comment-600663" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Dean+Harding' rel='external nofollow' class='url'>Dean Harding</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600663">
			February 13, 2008 at 5:07 pm</a>		</div>

		<p>I just tried it, and mine has &quot;High Definition Audio Controller&quot; as one of the wake_armed devices&#8230; does that mean I could actually say &quot;wake, computer!&quot; into the microphone and it&#8217;ll wake up? Man, that&#8217;d be cool!! Too bad I don&#8217;t have a microphone to try it out ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600683">
				<div id="div-comment-600683" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600683">
			February 13, 2008 at 5:23 pm</a>		</div>

		<p>Thank you, thank you! &nbsp;I&#8217;ve been struggling with this forever and couldn&#8217;t find anything like this article. &nbsp;Finally remembering on &quot;Wake On LAN&quot; and disabling it helped immensely, but it&#8217;s not perfect.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600693">
				<div id="div-comment-600693" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chrismcb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600693">
			February 13, 2008 at 6:00 pm</a>		</div>

		<p>anonymous thus spoke: &quot;Hm? This syntax doesn&#8217;t work here on Windows Server 2003, so I presume this is Vista-only (and therefore useless) stuff.&quot;</p>
<p>Neils repsonded with &quot;&#8230;(Remember 2003 is really a server system.)&quot;</p>
<p>So Neils, I&#8217;m just curious what gave it away? it couldn&#8217;t have been the word &quot;Server&quot; in the title could it?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600703">
				<div id="div-comment-600703" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sitdown.org.uk/' rel='external nofollow' class='url'>Marc</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600703">
			February 13, 2008 at 6:01 pm</a>		</div>

		<p>A few issues with Vista I have noticed.</p>
<p>If you put it on standby when its plugged in, and then unplug it, it will use the plugged in settings (and so rather than hibernate after 2 hours, it will be something like 12 hours).</p>
<p>If you have Vista set to go on standby when you shut the lid, and you click shutdown (yes, a real shutdown) but close the lid before it finishes, it will go onto standby and when you open the lid it will resume its shutdown :)</p>
<p>There are some settings that can cause it to wake, the scheduled tasks and media centre program updates. I found the automatic backup tool woke my laptop (not good when its in a bag!).</p>
<p>These may be specific to me, but hopefully if you didn&#8217;t already know, you might find it helpful. I can now pretty much count on my laptop staying on standby when I ask it to.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600713">
				<div id="div-comment-600713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600713">
			February 13, 2008 at 6:52 pm</a>		</div>

		<p>Very handy tip, thanks! &nbsp;It&#8217;s been annoying me for quite a while that my system will auto-wake itself unless I wait several seconds after rolling the keyboard/mouse away before hitting the sleep button. &nbsp;I&#8217;m certain the optical mouse is the culprit (since it&#8217;s about the same amount of delay before it turns its LED off), but I&#8217;ve looked in Device Manager and it doesn&#8217;t have an option to stop the mouse waking the computer.</p>
<p>Hopefully this will do the trick :)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600733">
				<div id="div-comment-600733" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lets.coozi.com.au/' rel='external nofollow' class='url'>silky</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600733">
			February 13, 2008 at 7:01 pm</a>		</div>

		<p>Dean,</p>
<p>That&#8217;s a cool idea &#8230; You must try it &#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600743">
				<div id="div-comment-600743" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Colin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600743">
			February 13, 2008 at 7:11 pm</a>		</div>

		<p>Thanks for that. &nbsp;You&#8217;ve helped at least one person prevent their laptop from waking up unexpectedly :D</p>
<p>That command also allows you to remove options (at least in vista). &nbsp;I used powercfg -H off to remove the hibernate option from my laptop. &nbsp;It was causing me problems and removing the temptation was just what I needed.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600753">
				<div id="div-comment-600753" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">William</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600753">
			February 13, 2008 at 8:01 pm</a>		</div>

		<p>(How is this different from unchecking Allow this device to wake the computer from the device properties in Device Manager? Beats me.)</p>
<p>A cryptic command makes it seem more like you&#8217;re learning the secret handshake from one of the Secret Brotherhood of the Machine instead of being told to actually read an options dialog instead of gloss over it. &nbsp;:)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600763">
				<div id="div-comment-600763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">microbe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600763">
			February 13, 2008 at 8:58 pm</a>		</div>

		<p>Hmm, I only have &quot;High Definition Audio Controller&quot; listed on the second command for my Dell Inspiron laptop. Weird.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600583">
				<div id="div-comment-600583" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Max Lybbert</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600583">
			February 13, 2008 at 1:06 pm</a>		</div>

		<p>/* I would start by disabling wake-up for the keyboard and mouse.</p>
<p>*/</p>
<p>Then how would you wake up the computer once you&#8217;ve determined this is the cause? &nbsp;You&#8217;re going to want at least one of those devices listening for &#8220;wake up events.&#8221;</p>
<div class=post>[<i>Um, the power button? -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600773">
				<div id="div-comment-600773" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Michael Dwyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600773">
			February 13, 2008 at 10:20 pm</a>		</div>

		<p>It seems that the XP Pro x64 version of powercfg is quite a bit different. &nbsp;It is probably similar to the Server 2003 versions. &nbsp;If nothing else, -devicequery doesn&#8217;t seem to be supported.</p>
<p>I&#8217;m bummed, since this has been one of those annoyances that I&#8217;ve never had a chance to knock down. &nbsp;I was so /hopeful/!! &nbsp;</p>
<p>Still, thank you very much for letting us know about this one. &nbsp;I love it where there are powerful tools already on my computer!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600783">
				<div id="div-comment-600783" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600783">
			February 13, 2008 at 11:06 pm</a>		</div>

		<p>I can confirm that powercfg that comes with X64 XP is useless. Raymnod you missed a disclaimer :)</p>
<div class=post>[<i>I get the feeling that you won&#8217;t be satisfied until the article is 90% disclaimer. -Raymond</i>]</div>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-jamesnt odd alt thread-odd thread-alt depth-1" id="comment-600813">
				<div id="div-comment-600813" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/JamesNT' rel='external nofollow' class='url'>JamesNT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600813">
			February 14, 2008 at 12:50 am</a>		</div>

		<p>Igor,</p>
<p>I would appreciate your elaboration on how the powercfg that comes with 64-bit XP is useless. &nbsp;It&#8217;s not enough to just make broad statements that confer no fact or reason &#8211; unless you are just trying to piss of Raymond. &nbsp;I wish you people would stop doing that and recognize this blog for the great resource it is.</p>
<p>JamesNT</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600823">
				<div id="div-comment-600823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600823">
			February 14, 2008 at 1:25 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600833">
				<div id="div-comment-600833" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Worf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600833">
			February 14, 2008 at 1:35 am</a>		</div>

		<p>Funny, on my Sony UMPC, I get practically every peripheral (USB, LAN, touch, fingerprint, WiFi, Bluetooth, etc) except keyboard (thumbboard), which I know wakes it.</p>
<p>Doing it with wake_armed returns zip. Yet I always wake it up via the keyboard (easier target than power switch). Strange.</p>
<p>Oh well &#8211; it only lasts about 20 hours on sleep anyhow &#8211; you really need to hibernate it.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600843">
				<div id="div-comment-600843" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600843">
			February 14, 2008 at 1:40 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-2/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-2/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600853">
				<div id="div-comment-600853" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600853">
			February 14, 2008 at 1:40 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-2/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-2/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600863">
				<div id="div-comment-600863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600863">
			February 14, 2008 at 1:55 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-3/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-3/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600873">
				<div id="div-comment-600873" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Drak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600873">
			February 14, 2008 at 1:58 am</a>		</div>

		<p>Raymond,</p>
<p>on my XP SP2 then -LASTWAKE doesn&#8217;t work (weird syntax also, as powercfg seems to take arguments with / instead of -).</p>
<p>THe /? didn&#8217;t list any optionsremotely sounding like LASTWAKE either :(</p>
<p>powercfg -LASTWAKE</p>
<p>Invalid Parameters &#8212; try &quot;/?&quot; for help</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600883">
				<div id="div-comment-600883" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600883">
			February 14, 2008 at 2:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-4/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-4/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600893">
				<div id="div-comment-600893" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600893">
			February 14, 2008 at 2:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-5/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-5/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600913">
				<div id="div-comment-600913" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lambert.geek.nz/' rel='external nofollow' class='url'>Miral</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600913">
			February 14, 2008 at 2:22 am</a>		</div>

		<p>Nuts. &nbsp;Just got home and tried it, but I&#8217;m on XP64 too, so no joy. &nbsp;POWERCFG here only has options for the same stuff that&#8217;s in the GUI (power schemes, timeouts, etc) &#8212; which doesn&#8217;t include any per-device options. &nbsp;Sigh.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600923">
				<div id="div-comment-600923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600923">
			February 14, 2008 at 2:25 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-6/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-6/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600933">
				<div id="div-comment-600933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600933">
			February 14, 2008 at 2:25 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-6/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-6/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600943">
				<div id="div-comment-600943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600943">
			February 14, 2008 at 2:25 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-7/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-7/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600953">
				<div id="div-comment-600953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600953">
			February 14, 2008 at 2:40 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-8/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-8/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600963">
				<div id="div-comment-600963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600963">
			February 14, 2008 at 2:40 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-9/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-9/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600973">
				<div id="div-comment-600973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600973">
			February 14, 2008 at 2:55 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-10/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-10/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-600983">
				<div id="div-comment-600983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600983">
			February 14, 2008 at 2:56 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-11/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-11/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-600993">
				<div id="div-comment-600993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-600993">
			February 14, 2008 at 2:56 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-11/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-11/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601003">
				<div id="div-comment-601003" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601003">
			February 14, 2008 at 3:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-12/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-12/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601013">
				<div id="div-comment-601013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601013">
			February 14, 2008 at 3:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-13/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-13/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601023">
				<div id="div-comment-601023" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601023">
			February 14, 2008 at 3:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-14/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-14/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601033">
				<div id="div-comment-601033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601033">
			February 14, 2008 at 4:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-15/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-15/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601053">
				<div id="div-comment-601053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Caminews &raquo; Controlling which devices will wake the computer out of sleep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601053">
			February 14, 2008 at 5:10 am</a>		</div>

		<p>PingBack from <a href="http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-16/" rel="nofollow">http://www.caminews.it/controlling-which-devices-will-wake-the-computer-out-of-sleep-16/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601073">
				<div id="div-comment-601073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Austin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601073">
			February 14, 2008 at 6:55 am</a>		</div>

		<p>I&#8217;m sorry that there are people out there that make you have to type these: &quot;I haven&#8217;t experienced this problem&quot;, &quot;might help&quot;, &quot;typically ignores&quot;, &quot;typically much shorter&quot;, &quot;Beats me&quot;, &quot;Maybe the optical mouse&quot;, &quot;might simply be chatty&quot;, &quot;This may not solve your problem&quot;, &quot;I&#8217;ve never actually tried it myself&quot;, &quot;who knows&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601103">
				<div id="div-comment-601103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">BryanK</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601103">
			February 14, 2008 at 8:17 am</a>		</div>

		<p>To everyone using XP x64:</p>
<p>The reason it doesn&#8217;t work on your OS is because your OS is really just Server 2003&#8217;s x64 version, re-branded and with a few extra limitations re-added (like the number of incoming connections allowed). &nbsp;Check out the OS minor and build version numbers, as they get put into AD&#8217;s LDAP tree by the OS itself (in the operatingSystemVersion attribute of the computer object) sometime, and compare them to Server 2003 &#8212; notice how they&#8217;re exactly the same.</p>
<p>(I think you can get the same info from GetOSVersionInfo, but I&#8217;ve never checked that myself.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601113">
				<div id="div-comment-601113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601113">
			February 14, 2008 at 9:37 am</a>		</div>

		<p>Contentfree linkfarms seem to be abusing the pingback facility on this blog.</p>
<p>I was quite impressed when clicking button on my USB mouse took my Vista laptop out of sleep mode. I know USB has had remote wakeup for some time, good to see someone implemented support for it. And good to see you can turn it off if it annoys you.</p>
<p>It reminds me of the cool soft power on button on the Mac keboard when PCs had a big clunky switch. And just like the PC is 2x superior to the Mac because it has two mouse buttons rather than one, now potentially every button is a power on button, which makes it up around 100x better ;-)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601143">
				<div id="div-comment-601143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.pixelbath.com/' rel='external nofollow' class='url'>Michael</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601143">
			February 14, 2008 at 11:04 am</a>		</div>

		<p>Fourteen, if you count soft-action phrases like &quot;you can&quot; and &quot;I would.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601193">
				<div id="div-comment-601193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">David Walker</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601193">
			February 14, 2008 at 2:39 pm</a>		</div>

		<p>Wow&#8230; pingback spam, where the source doesn&#8217;t have any content. &nbsp;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601223">
				<div id="div-comment-601223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Igor Levicki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601223">
			February 14, 2008 at 10:17 pm</a>		</div>

		<p>JamesNT said: &gt;&gt;I would appreciate your elaboration on how the powercfg that comes with 64-bit XP is useless&lt;&lt;</p>
<p>Of course:</p>
<p>&#8211; It doesn&#8217;t have the same command options or syntax.</p>
<p>POWERCFG [/LIST | /QUERY [name] | /CREATE name | /DELETE name |</p>
<p>&nbsp; &nbsp; &nbsp; /SETACTIVE name | /CHANGE name settings |</p>
<p>&nbsp; &nbsp; &nbsp; /HIBERNATE {ON|OFF} | /EXPORT name [/FILE filename] |</p>
<p>&nbsp; &nbsp; &nbsp; /IMPORT name [/FILE filename] | /GLOBALPOWERFLAG {ON|OFF} /OPTION flag |</p>
<p>&nbsp; &nbsp; &nbsp; /BATTERYALARM {LOW|CRITICAL} [settings] | /?]</p>
<p>&#8211; Because of that, it doesn&#8217;t allow the sort of control Raymond described.</p>
<p>Therefore, in the context of this article it is completely useless, because it cannot be used to accompilsh the same task. It is just a lousy duplicate of a Power Options control panel applet.</p>
<p>Finally, I wasn&#8217;t trying to piss off Raymond &#8212; there is a smiley at the end of the sentence in my post meaning it was a joke.</p>
<p>Unfortunately with all those disclaimers he did miss to mention that this post doesn&#8217;t apply to Windows XP x64 users.</p>
<div class=post>[<i>I didn&#8217;t need to mention it because it was covered by the &#8220;this tip that might (might) help you&#8221; disclaimer and the &#8220;This may not solve your problem, but at least&#8217;s something you can try.&#8221; disclaimer. oh, by the way, these tips don&#8217;t work on a Mac either. Sorry I forgot to disclaim that. -Raymond</i>]</div>
<p>Sigh, next time I will write a disclaimer for my post.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601233">
				<div id="div-comment-601233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dmoisan.spaces.live.com/' rel='external nofollow' class='url'>David Moisan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601233">
			February 14, 2008 at 10:34 pm</a>		</div>

		<p>powercfg -lastwake does not give the semantics one expects (on a Vista x86):</p>
<p>PS C:WindowsSystem32&gt; powercfg -lastwake</p>
<p>Wake History Count &#8211; 1</p>
<p>Wake History [0]</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601253">
				<div id="div-comment-601253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">sergeant</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601253">
			February 15, 2008 at 2:30 am</a>		</div>

		<p>My Vista laptop used to wake up because Windows Update check up time by default was set to 3 AM. No power management was involved.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-601263">
				<div id="div-comment-601263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">anon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601263">
			February 15, 2008 at 4:18 am</a>		</div>

		<p>C:&gt;powercfg -lastwake</p>
<p>Invalid Parameters &#8212; try &quot;/?&quot; for help</p>
<p>Running Windows XP Pro SP2 (Build 2600.xpsp.050622-1524). Is there some update I need to make this work?</p>
<p>(/? Doesn&#8217;t list lastwake as a possible parameter either.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-601553">
				<div id="div-comment-601553" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Vlad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-601553">
			February 18, 2008 at 2:35 am</a>		</div>

		<p>&quot;Unfortunately with all those disclaimers he did miss to mention that this post doesn&#8217;t apply to Windows XP x64 users.&quot;</p>
<p>That was funny, except it was delivered without a smilie, so I assume it to be a serious statement.</p>
<p>Why should Raymond have to mention this?</p>
<p>Do you think he would have if he knew?</p>
<p>Do you feel personally slighted that Raymond didn&#8217;t mention something he may or may not have known?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-602353">
				<div id="div-comment-602353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">snark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-602353">
			February 19, 2008 at 4:44 pm</a>		</div>

		<p>Hi,</p>
<p>I tried the powercfg command to find which device was waking my system when I put it in standby.</p>
<p>No luck, it stays in standby when I remove all devices from the wake_armed list. As soon as I add one back, the system doesn&#8217;t stay in standby.</p>
<p>At least, the powerbutton works to wake it up!</p>
<p>Any idea someone?</p>
<p>Thanks!</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-602483">
				<div id="div-comment-602483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.dynamsoft.com/' rel='external nofollow' class='url'>catherine.sea@hotmail.com</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20080213-00/?p=23473#comment-602483">
			February 20, 2008 at 2:09 am</a>		</div>

		<p>Thanks. I will try that on my test computer.</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

