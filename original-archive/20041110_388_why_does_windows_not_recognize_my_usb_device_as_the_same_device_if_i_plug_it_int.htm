<html>
<head>
<title>Why does Windows not recognize my USB device as the same device if I plug it into a different port?</title>
<link rel="stylesheet" href="page.css">
</head><body>
<div class="titlediv"><h2>Why does Windows not recognize my USB device as the same device if I plug it into a different port?</h2></div>
<div class="hdrdiv"><table class="hdrtable" cellspacing="0" cellpadding="0">
<tr><td><b>Date:</b></td><td>November 10, 2004 / year-entry #389</td></tr>
<tr><td><b>Tags:</b></td><td>other</td></tr>
<tr><td><b>Orig Link:</b></td><td>https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343</td></tr>

<tr><td><b>Comments:&nbsp;&nbsp;&nbsp;&nbsp;</b></td><td>66</td></tr>
<tr><td valign="top"><b>Summary:</b></td><td valign="top">You may have noticed that if you take a USB device and plug it into your computer, Windows recognizes it and configures it. Then if you unplug it and replug it into a different USB port, Windows gets a bout of amnesia and thinks that it's a completely different device instead of using the settings...</td></tr>
</table></div>
<hr/>
<table class="contenttable" cellspacing="0" cellpadding="0"><tr><td><div class="contentdiv">
<!-- CONTENT START -->
<p>You may have noticed that if you take a USB device and plug it into your computer, Windows recognizes it and configures it. Then if you unplug it and replug it into a different USB port, Windows gets a bout of amnesia and thinks that it's a completely different device instead of using the settings that applied when you plugged it in last time. Why is that?</p>
<p> The USB device people explained that this happens when the device lacks a USB serial number. </p>
<p> Serial numbers are optional on USB devices. If the device has one, then Windows recognizes the device no matter which USB port you plug it into. But if it doesn't have a serial number, then Windows treats each appearance on a different USB port as if it were a new device. </p>
<p> (I remember that one major manufacturer of USB devices didn't quite understand how serial numbers worked. They gave all of their devices serial numbers, that's great, but they all got the <strong>same</strong> serial number. Exciting things happened if you plugged two of their devices into a computer at the same time.) </p>
<p> But why does Windows treat it as a different device if it lacks a serial number and shows up on a different port? Why can't it just say, "Oh, there you are, over there on another port." </p>
<p> Because that creates random behavior once you plug in <strong>two</strong> such devices. Depending on the order in which the devices get enumerated by Plug and Play, the two sets of settings would get assigned seemingly randomly at each boot. Today the settings match up one way, but tomorrow when the devices are enumerated in the other order, the settings are swapped. (You get similarly baffling behavior if you plug in the devices in different order.) </p>
<p> In other words: Things suck because (1)&nbsp;things were already in bad shape&mdash;this would not have been a problem if the device had a proper serial number&mdash;and (2)&nbsp;once you're in this bad state, the alternative sucks more. The USB stack is just trying to make the best of a bad situation without making it any worse. </p>
<!-- CONTENT END -->
</div></td></tr></table>
<hr/>
<table class="commenttable" cellspacing="0" cellpadding="0"><tr><td><div class="commentdiv"><div class="commentdivhdr">
<!-- COMMENTS START -->
Comments (66)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment even thread-even depth-1" id="comment-223923">
				<div id="div-comment-223923" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Edward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223923">
			November 10, 2004 at 7:13 am</a>		</div>

		<p>But why make it so difficult to clean up the mess?<br />
<br />On Windows 2000 the control panel applet was &quot;Add/Remove hardware&quot;, which allowed you to see all the hardware devices installed so you could remove these redundant entries. On XP it changed to just &quot;Add Hardware&quot; which doesn&#8217;t.<br />
<br />What was the reason for this change?</p>
<p>Device manager hides devices that are no longer connected, even when &quot;Show hidden devices&quot; is on. The workaround is to set an environment variable DEVMGR_SHOW_NONPRESENT_DEVICES but this is one of those tips thats not widely know and it can get frustrating trying to fix problems.<br />
<br />Most people would be surprised at how many entries show up for &quot;HID compliant mouse&quot; or &quot;Generic Volume&quot; when they see all the redundant copies that have been installed, especially on portable computers.</p>
<p>It isn&#8217;t so much of a problem so long as its only unused device registrations, the issues come where some other resource is being allocated.<br />
<br />For example I had a USB-&gt;Serial cable for syncing my mobile phone with my PC. Every time I plugged it into a different port it reinstalled the drivers and allocated itself a new COM port. Eventually the com port number of the cable went outside the range of ports that the phone sync software would accept. I couldn&#8217;t uninstall the devices and reclaim the COM ports because the devices didn&#8217;t show up in device manager</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-223933">
				<div id="div-comment-223933" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">ac</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223933">
			November 10, 2004 at 7:21 am</a>		</div>

		<p>The real question is is it really necessary to launch the Found New Hardware UI in this scenario, or in the scenario that you&#8217;re plugging in a device with a different serial number?</p>
<p>I really don&#8217;t see any user value in notifying them that they&#8217;re either (a) plugging the device into a different port [or even more subtly, changing the topology somehow without touching the device in question]; (b) they&#8217;re plugging in a new serial number device.</p>
<p>After you&#8217;ve installed the driver the first time I would expect it just to work.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-223943">
				<div id="div-comment-223943" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://mo.mckinlay.me.uk' rel='external nofollow' class='url'>Mo</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223943">
			November 10, 2004 at 7:28 am</a>		</div>

		<p>I was about to post exactly what &#8216;ac&#8217; did, but got there too late. I don&#8217;t have a problem with the assumption that it&#8217;s possibly a different device, but the &quot;please feed me the installation disks <em>again</em>&quot; that occurs, especially when you have lots of USB ports.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-223953">
				<div id="div-comment-223953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Mike</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223953">
			November 10, 2004 at 7:34 am</a>		</div>

		<p>This whole reenumeration thing has always bugged me. It takes far too long.</p>
<p>I came across a type of device that had the &quot;same serial number&quot; on every device problem. I learnt three things:</p>
<p>1. There&#8217;s nothing in the USB specs I could find that require the serial number to be unique. It is only common sense that dictates so.</p>
<p>2. Windows doesn&#8217;t mind if you plug two equivalent devices with the same serial number into the machine if you plug them into USB ports that are peers of each other (i.e. they are connected directly to the same hub).</p>
<p>3. It is only Windows that gets upset about this. Other operating systems that have a far less heavyweight &quot;plug and play&quot; mechanism work fine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-223963">
				<div id="div-comment-223963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Pat Thoyts</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223963">
			November 10, 2004 at 7:34 am</a>		</div>

		<p>We have been having an exciting time with USB devices due to exactly this issue of devices having the same serial number. We embed these  third-party devices in equipment that we manufacture and it has been a real headache.</p>
<p>However I recently discovered that Windows has a &#8216;magic&#8217; setting in the registry to help us deal with rogue manufacturers who assign a single serial number to all instances of a particular product. You know that you have such a problem product when you plug two of them into Windows XP and it reboots as soon as the second device is enumerated. To work around this you can create a binary key in HKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlUsbFlags that has the form IgnoreHWSerNumVVVVPPPP. Here VVVV is the 4 hex digits of the vendor id and PPPP is the 4 digits of the product id. Creating this and setting the value to 01 means that windows will ignore the serial number and act as if the device never had one at all. Doing this causes windows to then use the connection number to discriminate between different devices which works fine.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-223983">
				<div id="div-comment-223983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223983">
			November 10, 2004 at 7:51 am</a>		</div>

		<p>Yeah, I guess they thought that calling it a serial number implied the need for uniqueness&#8230;</p>
<p>My gripe: for some reason, my trashy work pc drops and redetects my usb mouse, then demands driver files for it, rather than just using the generic driver, or at least leaving me be.</p>
<p>Sorry Raymond, I know it&#8217;s not your bitch, but you brought it up ;_)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-223993">
				<div id="div-comment-223993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223993">
			November 10, 2004 at 8:07 am</a>		</div>

		<p>What I don&#8217;t understand about the situation where 2 devices on seperate hugs that have the same serial number causes windows XP to throw up and reboot, is why it doesn&#8217;t simply fall back to the situation where it had no serial numbers. As Pat said earlier, there is this magic registry key to make things work, but why doesn&#8217;t windows automatically ignore the serial number if there is a contention, and act like it&#8217;s a new device?</p>
<p>It just seems like all the hard work has been done.</p>
<p>btw, I&#8217;m not going to be as nice and PC as Pat (we work together) The devices we have problems with are Phillips USB webcams.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224013">
				<div id="div-comment-224013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Marcel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224013">
			November 10, 2004 at 8:10 am</a>		</div>

		<p>What annoys me the most is that my normal user does not have the rights to install drivers, therefore I have to either remember which port I&#8217;ve used last time for the device or, as an administrator, plug the device into every port at least once.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224053">
				<div id="div-comment-224053" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224053">
			November 10, 2004 at 8:36 am</a>		</div>

		<p>Raymond, I wasn&#8217;t suggesting that the first device be made track-by-connection automatically, but when the second device is plugged in and windows detects that it appears to have two identical devices, surely it is not beyond the wit of man to say, &quot;uh-oh, we&#8217;ve got a new device which appears to be identical to a previous device, perhaps we should track this one by connection&quot;, unless there is some implementational issue I&#8217;m not aware of which makes this impossible. Surely crashing is a sub-optimal solution to the problem.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224093">
				<div id="div-comment-224093" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224093">
			November 10, 2004 at 9:11 am</a>		</div>

		<p>My guess is that the term came from the OSI model, which traditionally depicts the layers of its protocol stack as boxes stacked on top of each other:</p>
<p><a target="_new" href="http://en.wikipedia.org/wiki/TCP/IP_stack" rel="nofollow">http://en.wikipedia.org/wiki/TCP/IP_stack</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224073">
				<div id="div-comment-224073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://kreiger.linuxgods.com/' rel='external nofollow' class='url'>Christoffer &quot;Kreiger&quot; Hammarstr&#246;m</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224073">
			November 10, 2004 at 9:12 am</a>		</div>

		<p>Rather off-topic:</p>
<p>What is the origin of the word &quot;stack&quot; in phrases like &quot;USB stack&quot; and &quot;TCP/IP stack&quot;? What is stacked on top of what?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224103">
				<div id="div-comment-224103" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">RJ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224103">
			November 10, 2004 at 10:02 am</a>		</div>

		<p>@Marcel:  That was the most anoying part of the story for me also.  But it seems to have been fixed.  Now, windows asks for an admin username/password before opening the add/remove dialog!  I never noticed that before so maybe it was an SP2 feature?  Good work Microsoft.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224113">
				<div id="div-comment-224113" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224113">
			November 10, 2004 at 10:17 am</a>		</div>

		<p>&quot;Bad hardware will always win.&quot;</p>
<p>If necessary, it will even play dirty to win. The installer for the PQI I-Stick USB circumvents the &quot;driver is not signed&quot; dialog by sending it a click on the OK button. Too bad they didn&#8217;t work as hard on the actual driver, it blue-screens XP SP2 because of a bad kernel memory pool header.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224133">
				<div id="div-comment-224133" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224133">
			November 10, 2004 at 10:31 am</a>		</div>

		<p>&quot;&#8230; then reattach both devices using the drivers that you already have&#8230;&quot;</p>
<p>which causes the customizations for the first device to be lost since it was tracked by SN, but that device is no longer being tracked by SN.  Is that acceptable?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-223973">
				<div id="div-comment-223973" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://jamesatuncw.com/blog/archive/2004/11/10/156.aspx' rel='external nofollow' class='url'>James Summerlin's Blog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-223973">
			November 10, 2004 at 10:43 am</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224143">
				<div id="div-comment-224143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224143">
			November 10, 2004 at 10:57 am</a>		</div>

		<p>What I&#8217;d like to know is why does Windows, in this situation, always insist on the original install disks again? It already has the INF file and the drivers. If it comes up complaining that it can&#8217;t find a particular driver file, and you KNOW it&#8217;s already there in System32, you can just point it to that file and it will happily install it over itself. So why can&#8217;t Windows check if the file is already present before asking for it again?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224153">
				<div id="div-comment-224153" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224153">
			November 10, 2004 at 10:59 am</a>		</div>

		<p>I have no idea. That bugs me too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224163">
				<div id="div-comment-224163" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jon Potter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224163">
			November 10, 2004 at 11:20 am</a>		</div>

		<p>Well you work for Microsoft &#8211; ask someone :)<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224193">
				<div id="div-comment-224193" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224193">
			November 10, 2004 at 12:16 pm</a>		</div>

		<p>Hate to join in the USB team bashing, but expecting unique serial numbers in cheap hardware is crazy. Doing it preoperly requires that the device has a E2PROM, or fusible links or some other form of writeable, non volatile memory that is written just after manufacture, and that would add to the cost of the device. </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224213">
				<div id="div-comment-224213" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224213">
			November 10, 2004 at 1:13 pm</a>		</div>

		<blockquote><p>
  which causes the customizations for the first device to be lost since it was tracked by SN, but that device is no longer being tracked by SN. Is that acceptable?</p>
<p>Beats me. That was my off the cuff solution. Now, does windows store this customization in the registry under the SN? If so, then there&#8217;s your answer.<br />
  <br />Does customization work for by-connection USB (I hope so)? Presumably, if the customizations are stored in the registry, moving the device around will lose this stuff too. Is that worse? Is it worth the effort to preserve the settings and risk introducing bugs? I dunno.</p>
<p>If everything fails, then at least stick something in the system log and stuff an error message on the taskbar instead of rebooting.</p>
<p>Tom:<br />
  <br />&gt; expecting unique serial numbers in cheap hardware is crazy.</p>
<p>Fair enough for my $30 mouse, but perhaps it shouldn&#8217;t have a SN at all? Also, how do you explain my $1200 printer not having a proper SN? Actually, I&#8217;d like to have the option of storing only one set of customizations for a particular device class &#8211; basically tell W2K that I only ever have 1 of this thing, so don&#8217;t make more printers (or attach them to the existing queue). If I then add another, that&#8217;s an error.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224203">
				<div id="div-comment-224203" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.accidentalscientist.com' rel='external nofollow' class='url'>Simon Cooke [exMSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224203">
			November 10, 2004 at 1:19 pm</a>		</div>

		<p>Tom &#8211; Dallas/Maxim make a 1-wire chip just for that purpose. </p>
<p><a target="_new" href="http://www.maxim-ic.com/quick_view2.cfm/qv_pk/2903" rel="nofollow">http://www.maxim-ic.com/quick_view2.cfm/qv_pk/2903</a></p>
<p>1000+ of these are $0.61. I&#8217;m sure if you were selling in real volume, you could get a better deal.</p>
<p>If your device uses an FPGA (most do), then you&#8217;ve got even less of an excuse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224223">
				<div id="div-comment-224223" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">mikeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224223">
			November 10, 2004 at 2:20 pm</a>		</div>

		<p>My little story of how this drives me nuts is that I tried to configure my USB flash drive(s) to mount in a directory on an NTFS partition so they wouldn&#8217;t get essentially random drvier letter assignments.</p>
<p>But then when I plugged the drive into another port, it would show up as a new drive letter, effectively rendering my idea useless.</p>
<p>So, I&#8217;d like to sort of second Rowland Shaw&#8217;s question:  is there a way to force a USB device to get identified uniquely via some other mechanism?  In the case of a USB Mass Storage device, I&#8217;d think that the volume serial number might be sufficient (at least for the purpose of determining where it gets mounted into the filesystem). In this case, I don&#8217;t really care if the USB bus drivers think it&#8217;s a completely different device, I just want the volume mounted where I told it to be mounted.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224233">
				<div id="div-comment-224233" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224233">
			November 10, 2004 at 2:25 pm</a>		</div>

		<p>That would be nice wouldn&#8217;t it, but it also creates a chicken-and-egg &#8211; you don&#8217;t know that it&#8217;s a disk drive with a volume serial number until after you&#8217;ve assigned it an identity and handed it up the stack to the block device driver, but you can&#8217;t assign it an identity until you read its volume serial number (which only the block device driver can do)&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224243">
				<div id="div-comment-224243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Nate Silva</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224243">
			November 10, 2004 at 3:02 pm</a>		</div>

		<p>So is this what Microsoft was thinking: &quot;If it worked the way people expect, there would be exceptions to the rule, and that&#8217;s hard to program. So, instead, we&#8217;ll just make it work according to a consistent set of rules that inconvenience almost everybody.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224253">
				<div id="div-comment-224253" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.smackfu.com' rel='external nofollow' class='url'>Scott</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224253">
			November 10, 2004 at 3:05 pm</a>		</div>

		<p>How does Apple deal with this?  I&#8217;ve never heard any complaints from that side of the aisle.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224263">
				<div id="div-comment-224263" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224263">
			November 10, 2004 at 3:12 pm</a>		</div>

		<p>Imagine, you plug in a second device with the same serial number, and the following insane dialog pops up:</p>
<p>&quot;The device you just inserted has the same serial number as a device you already have. How would you like to proceed:</p>
<p>[] Ignore the second device. (Note that due to the unpredictability of USB device enumeration, the device that is ignored may change each time the bus is re-enumerated.)</p>
<p>[] Use both devices, associating settings with the USB port rather than the device serial number. (Previous settings will be lost since the identity of the first device is changing. Make sure no programs are using the first device because it will be removed with its old identity and reinserted with its new identity.)</p>
<p>[] Use both devices, assigning settings to each device in the order it is found. (Note that the order may change each time the bus is re-enumerated.)&quot;</p>
<p>Most people will say, &quot;What do you mean it has the same serial number? I can see the number on the sticker on the outside of the box and they&#8217;re clearly different.&quot;  That&#8217;s assuming those people even read the dialog at all. Which they won&#8217;t.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224283">
				<div id="div-comment-224283" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">chadbee</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224283">
			November 10, 2004 at 3:45 pm</a>		</div>

		<p>Isn&#8217;t it funny that when Raymond makes a post like this, people say &quot;why doesn&#8217;t Windows do a better job of dealing with this buggy hardware?&quot;</p>
<p>Yet, whenever he posts about odd little application compatibility hacks that have been done to make buggy third-party apps work on Windows, there&#8217;s always a bunch of comments saying &quot;Why does Microsoft do hacks to fix other people&#8217;s buggy software? Let &#8217;em rot!&quot;</p>
<p>Just an observation.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224033">
				<div id="div-comment-224033" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224033">
			November 10, 2004 at 8:23 am</a>		</div>

		<p>&quot;there is this magic registry key to make things work, but why doesn&#8217;t windows [do it automatically]?&quot;</p>
<p>I thought this was obvious: Because the Research department has yet to perfect clairevoyance.</p>
<p>When you plug in a device with a serial number, Windows needs to know, &quot;Gosh, is this a device whose serial number I should ignore?  I should ignore it if the user will ever plug in an identically-numbered device in the future.&quot; PnP has to decide at the time you install the *first* device whether it should be a track-by-serial-number device or a track-by-connection device. This requires a degree of predictive power (and negation of free will) that modern science has yet to develop.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224293">
				<div id="div-comment-224293" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">AnObserver</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224293">
			November 10, 2004 at 4:25 pm</a>		</div>

		<p>If Windows was consistent, maybe the responses would be too.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224043">
				<div id="div-comment-224043" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.hulver.com/scoop/' rel='external nofollow' class='url'>hulver</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224043">
			November 10, 2004 at 8:32 am</a>		</div>

		<p>I&#8217;m sorry, I don&#8217;t normally do Windows bashing, but that just sounds like an excuse to me Raymond.</p>
<p>If XP reboots when you insert two devices with the same serial number, it&#8217;s a bug.</p>
<p>Windows does not need to know when you plug the first device in if it needs to ignore the serial number. It needs to know when you plug the *second* device in.</p>
<p>If this is difficult to do with the current code, then it&#8217;s a coding fault. Unforseen yes, but these things happen. Trying to say that the Research department would need clairevoyance is just avoiding the problem.</p>
<p>I&#8217;m not trying to say that they should have anticipated this problem would occur, that&#8217;s impossible. What I&#8217;m saying is that there should be a way to fix it. &quot;It can&#8217;t be done with the current code&quot; is not an excuse.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224063">
				<div id="div-comment-224063" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224063">
			November 10, 2004 at 8:38 am</a>		</div>

		<p>I agree that rebooting is just plain bad. Then again, how hard should software try to protect itself against bad hardware? Bad hardware will always win. </p>
<p>The issue is how hard it is to convert a track-by-serial-number device to a track-by-connection device *on the fly*. I don&#8217;t know the answer.  (You have to convert; you can&#8217;t have one track-by-serial-number device and one track-by-connection device with the same serial number, or you run into exactly the same problem described in this article!)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224303">
				<div id="div-comment-224303" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224303">
			November 10, 2004 at 5:57 pm</a>		</div>

		<p>Simon </p>
<p>I&#8217;m thinking more about $30 devices like USB to Serial cables based on commodity ASICs like this</p>
<p><a target="_new" href="http://www.hitachi-hitec.com/jyouhou/prolific/ds_pl2303x_v11.pdf" rel="nofollow">http://www.hitachi-hitec.com/jyouhou/prolific/ds_pl2303x_v11.pdf</a></p>
<p>This chip does allow you to have a serial number, but only if you have an external e2prom. All the cables I&#8217;ve seen don&#8217;t have a unique ID&#8217;s however, and I get the same symptoms as Edward. </p>
<p>I don&#8217;t think the problem is the cost of the prom (which is probably &lt; $1 as you point out), it&#8217;s more that having it requires that someone program the unique IDs. </p>
<p>On the other hand, you can skip the prom and the manufacture without any programming. 99.99% of the people that buy it won&#8217;t ever notice any difference, except that the promless cable might be a bit cheaper. </p>
<p>Cheap broken hardware tends to drive out the slightly less cheap working stuff unless it&#8217;s completely unusable.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224313">
				<div id="div-comment-224313" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224313">
			November 10, 2004 at 6:09 pm</a>		</div>

		<p>&quot;Hate to join in the USB team bashing, but expecting unique serial numbers in cheap hardware is crazy. Doing it preoperly requires that the device has a E2PROM, or fusible links or some other form of writeable, non volatile memory that is written just after manufacture, and that would add to the cost of the device.&quot;</p>
<p>Sorry, but it is perfectly reasonable to expect this.  Many USB devices already have some kind of EEPROM already built in, which stores the vendor ID and device ID.</p>
<p>Things like ethernet cards have unique MAC addresses, this should be no different.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224323">
				<div id="div-comment-224323" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224323">
			November 10, 2004 at 6:17 pm</a>		</div>

		<p>Raymond, question&#8230;</p>
<p>Can a USB device without a unique serial number get WHQL certified?<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224123">
				<div id="div-comment-224123" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224123">
			November 10, 2004 at 10:18 am</a>		</div>

		<p>&lt;i&gt;I agree that rebooting is just plain bad. Then again, how hard should software try to protect itself against bad hardware? Bad hardware will always win.</p>
<p>The issue is how hard it is to convert a track-by-serial-number device to a track-by-connection device *on the fly*. I don&#8217;t know the answer. (You have to convert; you can&#8217;t have one track-by-serial-number device and one track-by-connection device with the same serial number, or you run into exactly the same problem described in this article!)&lt;/i&gt;</p>
<p>It&#8217;s already been pointed out that the spec doesn&#8217;t require a unique SN, so it&#8217;s not technically bad hardware. You should either deal with the problem or fail safe. Rebooting due to a properly functioning device showing up is unnacceptable.</p>
<p>The fix for duplicate SNs is fairly straightforward &#8211; if a second USB device with an identical SN is added to the system, add the product id to the list of known funky hardware, then reattach both devices using the drivers that you already have.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224333">
				<div id="div-comment-224333" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.foxyshadis.com' rel='external nofollow' class='url'>foxyshadis</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224333">
			November 10, 2004 at 6:57 pm</a>		</div>

		<p>Observer, I&#8217;m sure windows would be infinitely consistent, if you were willing to wait a decade between releases and/or pay thousands of dollars for each copy of XP. Remember, time, money, and completeness, you can often have two but very rarely all three.</p>
<p>Tom, that may well be what happened in cases like this.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224173">
				<div id="div-comment-224173" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Rowland Shaw</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224173">
			November 10, 2004 at 11:22 am</a>		</div>

		<p>&quot;PnP has to decide at the time you install the *first* device whether it should be a track-by-serial-number device or a track-by-connection device.&quot;</p>
<p>Is there anyway to force it the other way around (on a per device basis)? My situation is that XP is convinced I have 3 Canon Eos 300Ds. I wish I did, but as the device (presumeably) doesn&#8217;t have a serial, it&#8217;s a bit of a pain to remmeber which USB port it went in last (giving three different autorun settings and other fun side-effects)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224343">
				<div id="div-comment-224343" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224343">
			November 10, 2004 at 7:35 pm</a>		</div>

		<p>11/10/2004 10:59 AM Raymond Chen</p>
<p>&gt; I have no idea. That bugs me too.</p>
<p>It&#8217;s a relief to see that at least part of Microsoft is aware of this particular issue and is even bugged by it.  But, are you also bugged by the fact that at least 7 years have passed without this being fixed?</p>
<p>Though actually a portion of it has been fixed.  In Windows 95 and/or 98, if the keyboard was plugged into a different USB port than it used to be plugged into, then Windows demanded the driver disk and demanded that the user use the mouse or keyboard to click &quot;OK&quot;, but Windows didn&#8217;t recognize the click on &quot;OK&quot; because the keyboard was plugged into&#8230;..  And it only got that far if the user didn&#8217;t have to input a password and click &quot;OK&quot; or &quot;Escape&quot; to get past a login screen.  (By the way, this is on computers that don&#8217;t have PS/2 ports, except for the keyboard&#8217;s internal PS/2 hub where the mouse plugs into the keyboard.  The advice in some KB articles to use your ordinary keyboard to log in, or whatever, is laughable.)  Anyway, this part of it is fixed in Windows XP and I think maybe in 2000 too, at least Windows gets as far as recognizing a keyboard by itself.</p>
<p>Now for comparison, do you know why PCMCIA drivers don&#8217;t have a similar problem?  A device that used to be plugged into PCMCIA slot 0 can be plugged into slot 1 and its existing drivers will take charge immediately.  Sure PCMCIA is older than USB, but that doesn&#8217;t mean it took more than 7 years to solve.  This much of PCMCIA handling even worked in the original release of Windows 95.  It even worked for hard disks  (reading and writing worked as long as you hadn&#8217;t used Windows 95&#8217;s fdisk command over PCMCIA).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224363">
				<div id="div-comment-224363" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.microsoft.com/whdc/device/storage/usbfaq.mspx' rel='external nofollow' class='url'>Joe</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224363">
			November 10, 2004 at 9:31 pm</a>		</div>

		<p><a target="_new" href="http://www.microsoft.com/whdc/device/storage/usbfaq.mspx" rel="nofollow">http://www.microsoft.com/whdc/device/storage/usbfaq.mspx</a></p>
<p>Q: Must a USB storage device contain a unique serial number?</p>
<p>Yes. To comply with the USB Mass Storage Class Bulk-Only Transport Specification, all USB storage devices must contain a unique (12 digits or longer) serial number, represented as a UNICODE string. Refer to section 4.1.1 of the USB Mass Storage Class (Bulk-Only Transport) specification. (<a target="_new" href="http://www.usb.org/developers/devclass_docs/usbmassbulk_10.pdf" rel="nofollow">http://www.usb.org/developers/devclass_docs/usbmassbulk_10.pdf</a>)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224353">
				<div id="div-comment-224353" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://lazybones.ca/blog/index.php?p=19' rel='external nofollow' class='url'>Anonymous</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224353">
			November 10, 2004 at 11:35 pm</a>		</div>

		<p>lazybones &amp;raquo; USB nuts</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224403">
				<div id="div-comment-224403" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224403">
			November 11, 2004 at 12:04 am</a>		</div>

		<p>Perhaps the reprompting is by design? To make sure that you have the version of the driver that came with the OS, it has to go and check the version that came with the OS to see if they match. I&#8217;m just guessing. (Otherwise you can get into the state where the device is permanently toast because a bad copy of the xyz.sys driver got onto your machine. If PnP tried to short-circuit the driver install, it would say, &quot;Oh, look you have an xyz.sys driver already, I don&#8217;t need to install it.&quot; Even though your xyz.sys driver is a bad one.  Like I said, I&#8217;m just guessing.)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224413">
				<div id="div-comment-224413" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224413">
			November 11, 2004 at 2:33 am</a>		</div>

		<p>Joe &#8211; all the Mass Storage class USB devices I&#8217;ve seen have a serial number.</p>
<p>Mind you if the mass storage class is an ATA bridge it would be easy to generate one from he ATA Identify Device command &#8211; just return a CRC of the data you get back from the device.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224423">
				<div id="div-comment-224423" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ben Hutchings</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224423">
			November 11, 2004 at 4:12 am</a>		</div>

		<p>Myron: Yes, if even a &#163;2 (er, $4) Ethernet card can have a unique MAC it doesn&#8217;t seem unreasonable to expect USB devices to have real serial numbers if they have them at all.</p>
<p>I suspect that the identical serial numbers are being used as a cheap kluge to make Windows use the same settings when the device is moved t another port, and the manufacturers just don&#8217;t care about users with more than one &#8211; though I&#8217;d have thought they&#8217;d be happy to sell several devices to the same user.</p>
<p>Tom/Pat: On this PC running Windows XP SP2 there&#8217;s an ignore-serial-number entry in the registry already for a Philips webcam (PCA645VC according to the ID list at linux-usb.org) even though no such device has ever been near this PC.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224433">
				<div id="div-comment-224433" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224433">
			November 11, 2004 at 5:06 am</a>		</div>

		<blockquote><p>
  but they all got the same serial number. Exciting things happened if you plugged two of their devices into a computer at the same time.) </p>
<p>We do have problem when we manufactured some devices with unique serial number. The final test become really slow because of the repeating driver installtion. You can image how frustrated the QA guys were.</p>
<p>Mass storage device is fine because it is quick. But we never use USB serial number again for the devices needing extra driver.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224443">
				<div id="div-comment-224443" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224443">
			November 11, 2004 at 5:24 am</a>		</div>

		<p>&quot;We do have problem when we manufactured some devices with unique serial number. The final test become really slow because of the repeating driver installtion. You can image how frustrated the QA guys were.&quot;</p>
<p>I&#8217;m not sure I believe you. The companies that make this junky hardware really have QA? :-) BTW, was your driver WHQL certified or did you work around that problem somehow?</p>
<p>In any case I think you have the inconvenience equation wrong. Better to inconvenience a couple of QA guys than a couple of thousand customers.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224453">
				<div id="div-comment-224453" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224453">
			November 11, 2004 at 6:06 am</a>		</div>

		<p>QUOTE<br />
<br />Tom/Pat: On this PC running Windows XP SP2 there&#8217;s an ignore-serial-number entry in the registry already for a Philips webcam (PCA645VC according to the ID list at linux-usb.org) even though no such device has ever been near this PC.<br />
<br />QUOTE</p>
<p>Is that the same as this webcam? There are problems on Linux too:</p>
<p><a target="_new" href="http://www.smcc.demon.nl/webcam/" rel="nofollow">http://www.smcc.demon.nl/webcam/</a></p>
<p>Interestingly, there&#8217;s a common theme. Philips use a light weight compression algorithm to get a decent frame/rate resolution with a cheap microcontroller and USB 1.0. </p>
<p>Not unreasonably they want to keep this proprietary, but allowed someone to write a binary only Linux driver under NDA with the decompression code. This seems to be a violation of the linux equivalent of hardware compatibility guidelines.</p>
<p>From your comment it looks like they skipped the serial number too. </p>
<p>The cameras work though &#8211; Philips can probably live with not having a Linux driver in the kernel, and the ever OEM frendly Microsoft seem to have added a registry entry to handle the bogus serial number. And they sell like hot cakes.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224463">
				<div id="div-comment-224463" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Tom M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224463">
			November 11, 2004 at 6:35 am</a>		</div>

		<p>Tom, we know they sell like hot cakes. Pat has 4 on his desk right now! I think we are currently using the pcvc8xx series (toUCam II).</p>
<p>Raymond, I don&#8217;t think that USB device enumeration is quite as random as you were sugesting, or else, if you were using devices which had no serial numbers and they were randomly reassigned when the bus was re-enumerated (like when the pc rebooted) the driver would be re-installed, when in fact it is not. What we have found is that if you plug a serial-number-less device (either real or forced) into a port on a given hub, then any identical device on that port on that hub will be given the same device ID, regardless of what order devices are plugged in or found. It may not be specced that way but it appears that in fact ports always enumerate in the same order. I guess things might be different if you plug an external hub in somewhere though.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224393">
				<div id="div-comment-224393" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.kernelmustard.com' rel='external nofollow' class='url'>Steve Dispensa</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224393">
			November 10, 2004 at 10:59 pm</a>		</div>

		<p>WHQL certifies *drivers*, not *devices*.  I don&#8217;t know anything about WHQL-certifying USB drivers, having never done one, but I suspect the answer is that WHQL doesn&#8217;t care so much if the hardware behaves poorly, but only if the driver does.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224473">
				<div id="div-comment-224473" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224473">
			November 11, 2004 at 8:04 am</a>		</div>

		<p>Tom M: That&#8217;s because the device (lacking a serial number) is being tracked by port.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224483">
				<div id="div-comment-224483" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224483">
			November 11, 2004 at 8:54 am</a>		</div>

		<p>Raymond, if you had a toasted driver all you had to do is go to Device Manager, show non-present devices (which Microsoft decided to hide for some reason) and uninstall. The next time you plug your device in you will be asked to install new driver since the old one would be gone.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224493">
				<div id="div-comment-224493" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://weblogs.asp.net/oldnewthing/' rel='external nofollow' class='url'>Raymond Chen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224493">
			November 11, 2004 at 9:01 am</a>		</div>

		<p>I thought that just uninstalled the device but left the driver.</p>
<p>At any rate, that&#8217;s not what a typical user is going to do. If they have a problem with a device, they&#8217;re going to unplug it and replug it. They&#8217;re not going to go to this &quot;Device Manager&quot; thing and check some obscure options&#8230;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224503">
				<div id="div-comment-224503" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Jerry Pisk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224503">
			November 11, 2004 at 9:32 am</a>		</div>

		<p>No they&#8217;re not, but if they plug it in back in the same port they won&#8217;t get prompted for a new driver anyways so they won&#8217;t have a chance to fix it anyways. That&#8217;s why I missed the point of your thought on why Windows asks you for the driver even when it already has it.</p>
<p>As for Device Manager not showing drivers &#8211; it does, if you unplug a device (be it from USB or any other bus) it&#8217;s still shown, as &quot;Device is not present&quot; and you can unistall (or update) the driver even when the device is not connected.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224713">
				<div id="div-comment-224713" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anonymous Coward</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224713">
			November 11, 2004 at 3:15 pm</a>		</div>

		<p>Edward,</p>
<p>I have your issues way beat.  I do cell phone software for fun (currently on my desk are 13 cell phones and 17 data connectivity cables).  Some cell phones are composite devices and present two interfaces, and consume two COM port numbers.</p>
<p>On XP you can&#8217;t access com ports above COM9 without using the \?COM99 convention.  Given my plethora of cables, how many phones or usb to serial cables don&#8217;t have serial numbers, and the 10 or so USB ports I use (two on case, two 4 port hubs), I regularly end up with COM numbers in the 30&#8217;s.</p>
<p>Every now and then I have to go into the registry and delete all of them.  That requires wiping out several keys and hierarchies in several places.  It is unbelievable how many different places record what the COM number assigned to a particular device is.</p>
<p>And just to make my life more fun, I have several different device drivers for some phones.  (It would appear to be rocket science to make non-buggy USB modem or serial drivers).</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224763">
				<div id="div-comment-224763" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.semack.net' rel='external nofollow' class='url'>Myron A. Semack</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224763">
			November 11, 2004 at 4:01 pm</a>		</div>

		<p>Joe,</p>
<p>Thanks for the link.  I poked around the WHDC site, but somehow I missed that page.</p>
<p>Use WHQL-approved hardware/drivers, and life is good.  If you install something that isn&#8217;t WHQL-certified, then buyer beware.<br /></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224863">
				<div id="div-comment-224863" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">paul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224863">
			November 11, 2004 at 10:22 pm</a>		</div>

		<blockquote><p>
  I&#8217;m not sure I believe you. The companies that make this junky hardware really have QA? :-) BTW, was your driver WHQL certified or did you work around that problem somehow? </p>
<p>I believe a $200 dual mode camera should be more than junk in 2001. :-( The driver got certified, but it doesn&#8217;t matter. You got to install the driver again and again anyway.</p>
<p>&gt;In any case I think you have the inconvenience equation wrong. Better to inconvenience a couple of QA guys than a couple of thousand customers.</p>
<p>It was problem when we wanted to ramp up the quantity. Of course there is solution: adding more computer. Result: customer though quantity is more important. USB serial number? Forget it.</p>
<p>My point: While Raymond claims that the hardware guys do not follow the rule, MS is probably the reason they don&#8217;t do that.
</p></blockquote>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224823">
				<div id="div-comment-224823" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Norman Diamond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224823">
			November 11, 2004 at 6:08 pm</a>		</div>

		<p>11/10/2004 10:59 PM Steve Dispensa</p>
<p>&gt; WHQL certifies *drivers*, not *devices*.</p>
<p>Ooh.  Then are there any plans to establish a WSQL that will certify devices?</p>
<p>11/11/2004 3:15 PM Anonymous Coward</p>
<p>&gt; On XP you can&#8217;t access com ports above COM9<br />
<br />&gt; without using the \?COM99 convention.</p>
<p>Yikes.  Just yesterday I put together a machine that&#8217;s going to need them, and COM3 through COM12 are showing up properly in Device Manager, and I didn&#8217;t guess I was going to have to play games in the calls to CreateFile().  I noticed that COM10 and above aren&#8217;t reserved device names in MS-DOS commands, but adding a colon still got it recognized as a device name.  I guess there&#8217;s something else getting in the way at a lower level.  Thank you for the warning.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-224963">
				<div id="div-comment-224963" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.schriner.de' rel='external nofollow' class='url'>Patrick Schriner</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224963">
			November 12, 2004 at 3:14 am</a>		</div>

		<p>I think USB is a pain.</p>
<p>One of my most common USB problems is my scanner (A Microtek X12USL), sometimes (without removing the cable) it is converted into an unknown device. Getting it recognized again is a huge task, involves a lot of cursing, several reboots, etc. Same for my Logitech wireless desktop receiver. Of course the scanner allways worked when plugged in via SCSI, and the Logitech receiver works on PS/2. My Printer (a HP 970 Cxi) works fine when plugged via Parallel Port, but is a pain when plugged via USB.</p>
<p>The only devices that work fine (and provide a real advantage) on USB are USB mice ;-) and USB attached storage devices.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224983">
				<div id="div-comment-224983" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">DrPizza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224983">
			November 12, 2004 at 5:00 am</a>		</div>

		<p>&quot;Use WHQL-approved hardware/drivers, and life is good. If you install something that isn&#8217;t WHQL-certified, then buyer beware. &quot;</p>
<p>Unfortunately, that&#8217;s simply not true in practice; WHQL-approved drivers on Designed for Windows (or whatever the badge is) hardware can still shit the bed with alarming regularity.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-225073">
				<div id="div-comment-225073" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Cooney</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-225073">
			November 12, 2004 at 7:06 am</a>		</div>

		<p>One question, and I&#8217;m not sure who should answer: is there ever a situation where you would want two of the same device to have different drivers? </p>
<p>The second thing is a feature request: how about a simple wizard style cpl gadget that allows management of device-driver relations? I&#8217;m sure that stuff is accessible already, but it&#8217;d be easier to reinstall drivers with something like this, especially if windows stopped hammering me with demands for drivers for my mouse (which I roundly ignore)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-224993">
				<div id="div-comment-224993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Chris Becke</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-224993">
			November 12, 2004 at 5:07 am</a>		</div>

		<p>The whole windows driver model is so bizarre. The way that USB and/or PCI devices are enumerated and configured, I could in theory have a different driver for each different device instance.</p>
<p>However, take for example my two nVidia cards. All the nVidia drivers would install &quot;nv4.sys&quot; into system32. So, while I could *try* and use different drivers, I can&#8217;t really.</p>
<p>As regards pauls assertion that its somehow MSs fault. That makes no sense. Or does it. Clearly if you cant afford to manufacture the device with unique serial numbers, there is an option :- use no serial number at all. </p>
<p>The problem with that is the Windows USB stack insists on tracking each device uniquely, either by serial, or by port. Which inconveniences users when they accidentally plug the device into a different port and the OS demands the driver disk *again*. Given that probably 90% of the companies customers are going to own a single device, fudging identical serial numbers gives that 90% a better experience while inconveniencing 10%.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-225523">
				<div id="div-comment-225523" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Ian Argent</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-225523">
			November 12, 2004 at 5:04 pm</a>		</div>

		<p>This touches on my most recent pet peeve with SP2 &#8211; Add New Hardware asking if it can access the internet to get a new driver. I support cell phone data functions, and I&#8217;ve lost track of the number of problesm I&#8217;ve solved by telling people not to cancel that dialog, just select &quot;Have Disk&quot;. These are often people that are instlling the device that will allow them to connect to the internet; so they look at the dialog box that asks them to connect, and press cancel, because they&#8217;re not ready yet. And of course, it borks the entire process (the drivers don&#8217;t get installed, cats and dogs live together, etc)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-233143">
				<div id="div-comment-233143" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn">Anji</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-233143">
			December 7, 2004 at 10:49 am</a>		</div>

		<p>I bought an i-river portable hard disk for music downloading.  After setting up the drivers, I unplugged it, but when I returned the computer would not recognise the device in the same USB port, so I tried the other one which worked.  The next time I tried to connect it niether port recognises it!  I&#8217;m a little lost here I thought XP enabled plug and play.  Can anyone help me?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-238243">
				<div id="div-comment-238243" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blogs.msdn.com/omars/archive/2004/12/28/339109.aspx' rel='external nofollow' class='url'>Omar Shahine's WebLog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-238243">
			December 28, 2004 at 5:25 pm</a>		</div>

		
		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-289013">
				<div id="div-comment-289013" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.bcchinese.net/happyjet/archive/2005/07/06/28085.aspx' rel='external nofollow' class='url'></a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-289013">
			July 6, 2005 at 7:09 am</a>		</div>

		<p>USBUSBWindows</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576603">
				<div id="div-comment-576603" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://tim.cexx.org/?p=422' rel='external nofollow' class='url'>Outguessing the machine &raquo; Why Windows asks you for drivers again whenever you plug a USB device into a new port!</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-576603">
			December 11, 2007 at 6:18 pm</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://tim.cexx.org/?p=422" rel="nofollow">http://tim.cexx.org/?p=422</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-736993">
				<div id="div-comment-736993" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://rtshiva.com/2009/05/19/usb-specification-and-windows-limitation-on-serial-numbers/' rel='external nofollow' class='url'>USB Specification and Windows limitation on Serial Numbers &laquo; Shivonline</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/oldnewthing/20041110-00/?p=37343#comment-736993">
			May 19, 2009 at 4:56 am</a>		</div>

		<p>PingBack from <a rel="nofollow" target="_new" href="http://rtshiva.com/2009/05/19/usb-specification-and-windows-limitation-on-serial-numbers/" rel="nofollow">http://rtshiva.com/2009/05/19/usb-specification-and-windows-limitation-on-serial-numbers/</a></p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
<!-- COMMENTS END -->
</div></td></tr></table>

</body>
</html>
<br/><div class="disclaimer">
*DISCLAIMER: I DO NOT OWN THIS CONTENT. If you are the owner and would like it removed, please
<a target="_blank" href="/contact.htm">contact me</a>.
The content herein is an archived reproduction of entries from
Raymond Chen's "Old New Thing" Blog (most recent link is <a target="_blank" href="https://devblogs.microsoft.com/oldnewthing/">here</a>).
It may have slight formatting modifications for consistency and to improve readability.
<br/><br/>
WHY DID I DUPLICATE THIS CONTENT HERE?
Let me first say this site has never had anything to sell and has never shown ads of any kind. I have nothing monetarily to gain by duplicating content here.
Because I had made my own local copy of this content throughout the years, for ease of using tools like grep, I decided to put it online after I discovered
some of the original content previously and publicly available, had disappeared approximately early to mid 2019.
At the same time, I present the content in an easily accessible theme-agnostic way.
<br/><br/>
The information provided by Raymond's blog is, for all practical purposes, more authoritative on Windows Development than Microsoft's
own MSDN documentation and should be considered supplemental reading to that documentation. The wealth of missing details
provided by this blog that Microsoft could not or did not document about Windows over the years is vital enough, many would agree an online "backup" of these details
is a necessary endeavor. Specifics include:<br/>
<ul>
    <li>
        A "redesign" after 2019 erased thousands of user's comments from previous years. As many have stated, the comments are nearly as important as the postings themselves.
        The archived copies of the postings contained here retain the original comments.
    </li>
    <li>
        The blog has changed domains many times and the urls have otherwise been under constant change since 2003.
        Even when proper redirection has been set up for those links, redirection only works for a limited period of time.
        For example, all of the internal blog links that were valid in early 2019, were broken by 2020 without proper redirection.
    </li>
    <li>
        The blog has been under constant re-design and re-theming since its inception.
        It is downright irritating to deal with a bogged-down site experience as the result of the latest visual themes designed for cell-phone browsers.
        As of this writing, it is cumbersome to navigate titles with only 10 entries per page.
        While it is nice that the official site has a search feature, searching using this index (with all titles on a single page) is much quicker (CTRL-F in most browsers).
    </li>
</ul>
</div><br/>
&lt;-- Back to <a href="index.htm">Old New Thing Archive Index</a>

